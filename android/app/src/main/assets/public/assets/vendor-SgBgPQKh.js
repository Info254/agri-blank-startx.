function VH(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const c=Object.getOwnPropertyDescriptor(r,a);c&&Object.defineProperty(e,a,c.get?c:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function fse(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var WH={exports:{}},ZP={},GH={exports:{}},Vi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS=Symbol.for("react.element"),pse=Symbol.for("react.portal"),mse=Symbol.for("react.fragment"),gse=Symbol.for("react.strict_mode"),_se=Symbol.for("react.profiler"),yse=Symbol.for("react.provider"),vse=Symbol.for("react.context"),xse=Symbol.for("react.forward_ref"),bse=Symbol.for("react.suspense"),wse=Symbol.for("react.memo"),Sse=Symbol.for("react.lazy"),P$=Symbol.iterator;function Tse(e){return e===null||typeof e!="object"?null:(e=P$&&e[P$]||e["@@iterator"],typeof e=="function"?e:null)}var HH={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qH=Object.assign,ZH={};function R0(e,t,n){this.props=e,this.context=t,this.refs=ZH,this.updater=n||HH}R0.prototype.isReactComponent={};R0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};R0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function XH(){}XH.prototype=R0.prototype;function Xz(e,t,n){this.props=e,this.context=t,this.refs=ZH,this.updater=n||HH}var Kz=Xz.prototype=new XH;Kz.constructor=Xz;qH(Kz,R0.prototype);Kz.isPureReactComponent=!0;var C$=Array.isArray,KH=Object.prototype.hasOwnProperty,Yz={current:null},YH={key:!0,ref:!0,__self:!0,__source:!0};function JH(e,t,n){var r,a={},c=null,d=null;if(t!=null)for(r in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(c=""+t.key),t)KH.call(t,r)&&!YH.hasOwnProperty(r)&&(a[r]=t[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var _=Array(i),b=0;b<i;b++)_[b]=arguments[b+2];a.children=_}if(e&&e.defaultProps)for(r in i=e.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:hS,type:e,key:c,ref:d,props:a,_owner:Yz.current}}function Ese(e,t){return{$$typeof:hS,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Jz(e){return typeof e=="object"&&e!==null&&e.$$typeof===hS}function Ase(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var I$=/\/+/g;function FO(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ase(""+e.key):t.toString(36)}function g2(e,t,n,r,a){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case hS:case pse:d=!0}}if(d)return d=e,a=a(d),e=r===""?"."+FO(d,0):r,C$(a)?(n="",e!=null&&(n=e.replace(I$,"$&/")+"/"),g2(a,t,n,"",function(b){return b})):a!=null&&(Jz(a)&&(a=Ese(a,n+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(I$,"$&/")+"/")+e)),t.push(a)),1;if(d=0,r=r===""?".":r+":",C$(e))for(var i=0;i<e.length;i++){c=e[i];var _=r+FO(c,i);d+=g2(c,t,n,_,a)}else if(_=Tse(e),typeof _=="function")for(e=_.call(e),i=0;!(c=e.next()).done;)c=c.value,_=r+FO(c,i++),d+=g2(c,t,n,_,a);else if(c==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function SE(e,t,n){if(e==null)return e;var r=[],a=0;return g2(e,r,"","",function(c){return t.call(n,c,a++)}),r}function Pse(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tl={current:null},_2={transition:null},Cse={ReactCurrentDispatcher:Tl,ReactCurrentBatchConfig:_2,ReactCurrentOwner:Yz};function QH(){throw Error("act(...) is not supported in production builds of React.")}Vi.Children={map:SE,forEach:function(e,t,n){SE(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return SE(e,function(){t++}),t},toArray:function(e){return SE(e,function(t){return t})||[]},only:function(e){if(!Jz(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Vi.Component=R0;Vi.Fragment=mse;Vi.Profiler=_se;Vi.PureComponent=Xz;Vi.StrictMode=gse;Vi.Suspense=bse;Vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cse;Vi.act=QH;Vi.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=qH({},e.props),a=e.key,c=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(c=t.ref,d=Yz.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(_ in t)KH.call(t,_)&&!YH.hasOwnProperty(_)&&(r[_]=t[_]===void 0&&i!==void 0?i[_]:t[_])}var _=arguments.length-2;if(_===1)r.children=n;else if(1<_){i=Array(_);for(var b=0;b<_;b++)i[b]=arguments[b+2];r.children=i}return{$$typeof:hS,type:e.type,key:a,ref:c,props:r,_owner:d}};Vi.createContext=function(e){return e={$$typeof:vse,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:yse,_context:e},e.Consumer=e};Vi.createElement=JH;Vi.createFactory=function(e){var t=JH.bind(null,e);return t.type=e,t};Vi.createRef=function(){return{current:null}};Vi.forwardRef=function(e){return{$$typeof:xse,render:e}};Vi.isValidElement=Jz;Vi.lazy=function(e){return{$$typeof:Sse,_payload:{_status:-1,_result:e},_init:Pse}};Vi.memo=function(e,t){return{$$typeof:wse,type:e,compare:t===void 0?null:t}};Vi.startTransition=function(e){var t=_2.transition;_2.transition={};try{e()}finally{_2.transition=t}};Vi.unstable_act=QH;Vi.useCallback=function(e,t){return Tl.current.useCallback(e,t)};Vi.useContext=function(e){return Tl.current.useContext(e)};Vi.useDebugValue=function(){};Vi.useDeferredValue=function(e){return Tl.current.useDeferredValue(e)};Vi.useEffect=function(e,t){return Tl.current.useEffect(e,t)};Vi.useId=function(){return Tl.current.useId()};Vi.useImperativeHandle=function(e,t,n){return Tl.current.useImperativeHandle(e,t,n)};Vi.useInsertionEffect=function(e,t){return Tl.current.useInsertionEffect(e,t)};Vi.useLayoutEffect=function(e,t){return Tl.current.useLayoutEffect(e,t)};Vi.useMemo=function(e,t){return Tl.current.useMemo(e,t)};Vi.useReducer=function(e,t,n){return Tl.current.useReducer(e,t,n)};Vi.useRef=function(e){return Tl.current.useRef(e)};Vi.useState=function(e){return Tl.current.useState(e)};Vi.useSyncExternalStore=function(e,t,n){return Tl.current.useSyncExternalStore(e,t,n)};Vi.useTransition=function(){return Tl.current.useTransition()};Vi.version="18.3.1";GH.exports=Vi;var X=GH.exports;const Ce=lo(X),Qz=VH({__proto__:null,default:Ce},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ise=X,Mse=Symbol.for("react.element"),Ose=Symbol.for("react.fragment"),kse=Object.prototype.hasOwnProperty,Rse=Ise.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dse={key:!0,ref:!0,__self:!0,__source:!0};function e9(e,t,n){var r,a={},c=null,d=null;n!==void 0&&(c=""+n),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(d=t.ref);for(r in t)kse.call(t,r)&&!Dse.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Mse,type:e,key:c,ref:d,props:a,_owner:Rse.current}}ZP.Fragment=Ose;ZP.jsx=e9;ZP.jsxs=e9;WH.exports=ZP;var _e=WH.exports,t9={exports:{}},zc={},n9={exports:{}},r9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Be,nt){var at=Be.length;Be.push(nt);e:for(;0<at;){var Mt=at-1>>>1,Nt=Be[Mt];if(0<a(Nt,nt))Be[Mt]=nt,Be[at]=Nt,at=Mt;else break e}}function n(Be){return Be.length===0?null:Be[0]}function r(Be){if(Be.length===0)return null;var nt=Be[0],at=Be.pop();if(at!==nt){Be[0]=at;e:for(var Mt=0,Nt=Be.length,rn=Nt>>>1;Mt<rn;){var un=2*(Mt+1)-1,en=Be[un],sn=un+1,Vt=Be[sn];if(0>a(en,at))sn<Nt&&0>a(Vt,en)?(Be[Mt]=Vt,Be[sn]=at,Mt=sn):(Be[Mt]=en,Be[un]=at,Mt=un);else if(sn<Nt&&0>a(Vt,at))Be[Mt]=Vt,Be[sn]=at,Mt=sn;else break e}}return nt}function a(Be,nt){var at=Be.sortIndex-nt.sortIndex;return at!==0?at:Be.id-nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var d=Date,i=d.now();e.unstable_now=function(){return d.now()-i}}var _=[],b=[],T=1,A=null,k=3,R=!1,B=!1,N=!1,V=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(Be){for(var nt=n(b);nt!==null;){if(nt.callback===null)r(b);else if(nt.startTime<=Be)r(b),nt.sortIndex=nt.expirationTime,t(_,nt);else break;nt=n(b)}}function Q(Be){if(N=!1,q(Be),!B)if(n(_)!==null)B=!0,ot(te);else{var nt=n(b);nt!==null&&rt(Q,nt.startTime-Be)}}function te(Be,nt){B=!1,N&&(N=!1,H(ye),ye=-1),R=!0;var at=k;try{for(q(nt),A=n(_);A!==null&&(!(A.expirationTime>nt)||Be&&!Fe());){var Mt=A.callback;if(typeof Mt=="function"){A.callback=null,k=A.priorityLevel;var Nt=Mt(A.expirationTime<=nt);nt=e.unstable_now(),typeof Nt=="function"?A.callback=Nt:A===n(_)&&r(_),q(nt)}else r(_);A=n(_)}if(A!==null)var rn=!0;else{var un=n(b);un!==null&&rt(Q,un.startTime-nt),rn=!1}return rn}finally{A=null,k=at,R=!1}}var ue=!1,fe=null,ye=-1,De=5,Ne=-1;function Fe(){return!(e.unstable_now()-Ne<De)}function Le(){if(fe!==null){var Be=e.unstable_now();Ne=Be;var nt=!0;try{nt=fe(!0,Be)}finally{nt?Ze():(ue=!1,fe=null)}}else ue=!1}var Ze;if(typeof G=="function")Ze=function(){G(Le)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,ct=He.port2;He.port1.onmessage=Le,Ze=function(){ct.postMessage(null)}}else Ze=function(){V(Le,0)};function ot(Be){fe=Be,ue||(ue=!0,Ze())}function rt(Be,nt){ye=V(function(){Be(e.unstable_now())},nt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Be){Be.callback=null},e.unstable_continueExecution=function(){B||R||(B=!0,ot(te))},e.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):De=0<Be?Math.floor(1e3/Be):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return n(_)},e.unstable_next=function(Be){switch(k){case 1:case 2:case 3:var nt=3;break;default:nt=k}var at=k;k=nt;try{return Be()}finally{k=at}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Be,nt){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var at=k;k=Be;try{return nt()}finally{k=at}},e.unstable_scheduleCallback=function(Be,nt,at){var Mt=e.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?Mt+at:Mt):at=Mt,Be){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=at+Nt,Be={id:T++,callback:nt,priorityLevel:Be,startTime:at,expirationTime:Nt,sortIndex:-1},at>Mt?(Be.sortIndex=at,t(b,Be),n(_)===null&&Be===n(b)&&(N?(H(ye),ye=-1):N=!0,rt(Q,at-Mt))):(Be.sortIndex=Nt,t(_,Be),B||R||(B=!0,ot(te))),Be},e.unstable_shouldYield=Fe,e.unstable_wrapCallback=function(Be){var nt=k;return function(){var at=k;k=nt;try{return Be.apply(this,arguments)}finally{k=at}}}})(r9);n9.exports=r9;var Lse=n9.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zse=X,Dc=Lse;function Rn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i9=new Set,Vb={};function y_(e,t){zv(e,t),zv(e+"Capture",t)}function zv(e,t){for(Vb[e]=t,e=0;e<t.length;e++)i9.add(t[e])}var cf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ER=Object.prototype.hasOwnProperty,Nse=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M$={},O$={};function Fse(e){return ER.call(O$,e)?!0:ER.call(M$,e)?!1:Nse.test(e)?O$[e]=!0:(M$[e]=!0,!1)}function Bse(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jse(e,t,n,r){if(t===null||typeof t>"u"||Bse(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function El(e,t,n,r,a,c,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=d}var $s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$s[e]=new El(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$s[t]=new El(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$s[e]=new El(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$s[e]=new El(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$s[e]=new El(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$s[e]=new El(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$s[e]=new El(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$s[e]=new El(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$s[e]=new El(e,5,!1,e.toLowerCase(),null,!1,!1)});var e3=/[\-:]([a-z])/g;function t3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(e3,t3);$s[t]=new El(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(e3,t3);$s[t]=new El(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(e3,t3);$s[t]=new El(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$s[e]=new El(e,1,!1,e.toLowerCase(),null,!1,!1)});$s.xlinkHref=new El("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$s[e]=new El(e,1,!1,e.toLowerCase(),null,!0,!0)});function n3(e,t,n,r){var a=$s.hasOwnProperty(t)?$s[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(jse(t,n,a,r)&&(n=null),r||a===null?Fse(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xf=zse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,TE=Symbol.for("react.element"),rv=Symbol.for("react.portal"),iv=Symbol.for("react.fragment"),r3=Symbol.for("react.strict_mode"),AR=Symbol.for("react.profiler"),o9=Symbol.for("react.provider"),a9=Symbol.for("react.context"),i3=Symbol.for("react.forward_ref"),PR=Symbol.for("react.suspense"),CR=Symbol.for("react.suspense_list"),o3=Symbol.for("react.memo"),Ep=Symbol.for("react.lazy"),s9=Symbol.for("react.offscreen"),k$=Symbol.iterator;function M1(e){return e===null||typeof e!="object"?null:(e=k$&&e[k$]||e["@@iterator"],typeof e=="function"?e:null)}var da=Object.assign,BO;function nb(e){if(BO===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);BO=t&&t[1]||""}return`
`+BO+e}var jO=!1;function $O(e,t){if(!e||jO)return"";jO=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var r=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){r=b}e.call(t.prototype)}else{try{throw Error()}catch(b){r=b}e()}}catch(b){if(b&&r&&typeof b.stack=="string"){for(var a=b.stack.split(`
`),c=r.stack.split(`
`),d=a.length-1,i=c.length-1;1<=d&&0<=i&&a[d]!==c[i];)i--;for(;1<=d&&0<=i;d--,i--)if(a[d]!==c[i]){if(d!==1||i!==1)do if(d--,i--,0>i||a[d]!==c[i]){var _=`
`+a[d].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=d&&0<=i);break}}}finally{jO=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?nb(e):""}function $se(e){switch(e.tag){case 5:return nb(e.type);case 16:return nb("Lazy");case 13:return nb("Suspense");case 19:return nb("SuspenseList");case 0:case 2:case 15:return e=$O(e.type,!1),e;case 11:return e=$O(e.type.render,!1),e;case 1:return e=$O(e.type,!0),e;default:return""}}function IR(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case iv:return"Fragment";case rv:return"Portal";case AR:return"Profiler";case r3:return"StrictMode";case PR:return"Suspense";case CR:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case a9:return(e.displayName||"Context")+".Consumer";case o9:return(e._context.displayName||"Context")+".Provider";case i3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case o3:return t=e.displayName||null,t!==null?t:IR(e.type)||"Memo";case Ep:t=e._payload,e=e._init;try{return IR(e(t))}catch{}}return null}function Use(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return IR(t);case 8:return t===r3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function tm(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function l9(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Vse(e){var t=l9(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(d){r=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(d){r=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function EE(e){e._valueTracker||(e._valueTracker=Vse(e))}function c9(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=l9(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function F2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function MR(e,t){var n=t.checked;return da({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function R$(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=tm(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function u9(e,t){t=t.checked,t!=null&&n3(e,"checked",t,!1)}function OR(e,t){u9(e,t);var n=tm(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?kR(e,t.type,n):t.hasOwnProperty("defaultValue")&&kR(e,t.type,tm(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function D$(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function kR(e,t,n){(t!=="number"||F2(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var rb=Array.isArray;function xv(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+tm(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function RR(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Rn(91));return da({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function L$(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Rn(92));if(rb(n)){if(1<n.length)throw Error(Rn(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:tm(n)}}function h9(e,t){var n=tm(t.value),r=tm(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function z$(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function d9(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function DR(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?d9(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var AE,f9=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(AE=AE||document.createElement("div"),AE.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=AE.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wb(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _b={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wse=["Webkit","ms","Moz","O"];Object.keys(_b).forEach(function(e){Wse.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_b[t]=_b[e]})});function p9(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||_b.hasOwnProperty(e)&&_b[e]?(""+t).trim():t+"px"}function m9(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=p9(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Gse=da({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function LR(e,t){if(t){if(Gse[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Rn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Rn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Rn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Rn(62))}}function zR(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NR=null;function a3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var FR=null,bv=null,wv=null;function N$(e){if(e=pS(e)){if(typeof FR!="function")throw Error(Rn(280));var t=e.stateNode;t&&(t=QP(t),FR(e.stateNode,e.type,t))}}function g9(e){bv?wv?wv.push(e):wv=[e]:bv=e}function _9(){if(bv){var e=bv,t=wv;if(wv=bv=null,N$(e),t)for(e=0;e<t.length;e++)N$(t[e])}}function y9(e,t){return e(t)}function v9(){}var UO=!1;function x9(e,t,n){if(UO)return e(t,n);UO=!0;try{return y9(e,t,n)}finally{UO=!1,(bv!==null||wv!==null)&&(v9(),_9())}}function Gb(e,t){var n=e.stateNode;if(n===null)return null;var r=QP(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Rn(231,t,typeof n));return n}var BR=!1;if(cf)try{var O1={};Object.defineProperty(O1,"passive",{get:function(){BR=!0}}),window.addEventListener("test",O1,O1),window.removeEventListener("test",O1,O1)}catch{BR=!1}function Hse(e,t,n,r,a,c,d,i,_){var b=Array.prototype.slice.call(arguments,3);try{t.apply(n,b)}catch(T){this.onError(T)}}var yb=!1,B2=null,j2=!1,jR=null,qse={onError:function(e){yb=!0,B2=e}};function Zse(e,t,n,r,a,c,d,i,_){yb=!1,B2=null,Hse.apply(qse,arguments)}function Xse(e,t,n,r,a,c,d,i,_){if(Zse.apply(this,arguments),yb){if(yb){var b=B2;yb=!1,B2=null}else throw Error(Rn(198));j2||(j2=!0,jR=b)}}function v_(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function b9(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function F$(e){if(v_(e)!==e)throw Error(Rn(188))}function Kse(e){var t=e.alternate;if(!t){if(t=v_(e),t===null)throw Error(Rn(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var c=a.alternate;if(c===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===n)return F$(a),e;if(c===r)return F$(a),t;c=c.sibling}throw Error(Rn(188))}if(n.return!==r.return)n=a,r=c;else{for(var d=!1,i=a.child;i;){if(i===n){d=!0,n=a,r=c;break}if(i===r){d=!0,r=a,n=c;break}i=i.sibling}if(!d){for(i=c.child;i;){if(i===n){d=!0,n=c,r=a;break}if(i===r){d=!0,r=c,n=a;break}i=i.sibling}if(!d)throw Error(Rn(189))}}if(n.alternate!==r)throw Error(Rn(190))}if(n.tag!==3)throw Error(Rn(188));return n.stateNode.current===n?e:t}function w9(e){return e=Kse(e),e!==null?S9(e):null}function S9(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=S9(e);if(t!==null)return t;e=e.sibling}return null}var T9=Dc.unstable_scheduleCallback,B$=Dc.unstable_cancelCallback,Yse=Dc.unstable_shouldYield,Jse=Dc.unstable_requestPaint,Fa=Dc.unstable_now,Qse=Dc.unstable_getCurrentPriorityLevel,s3=Dc.unstable_ImmediatePriority,E9=Dc.unstable_UserBlockingPriority,$2=Dc.unstable_NormalPriority,ele=Dc.unstable_LowPriority,A9=Dc.unstable_IdlePriority,XP=null,Xh=null;function tle(e){if(Xh&&typeof Xh.onCommitFiberRoot=="function")try{Xh.onCommitFiberRoot(XP,e,void 0,(e.current.flags&128)===128)}catch{}}var eh=Math.clz32?Math.clz32:ile,nle=Math.log,rle=Math.LN2;function ile(e){return e>>>=0,e===0?32:31-(nle(e)/rle|0)|0}var PE=64,CE=4194304;function ib(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function U2(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,c=e.pingedLanes,d=n&268435455;if(d!==0){var i=d&~a;i!==0?r=ib(i):(c&=d,c!==0&&(r=ib(c)))}else d=n&~a,d!==0?r=ib(d):c!==0&&(r=ib(c));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,c=t&-t,a>=c||a===16&&(c&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-eh(t),a=1<<n,r|=e[n],t&=~a;return r}function ole(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ale(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,c=e.pendingLanes;0<c;){var d=31-eh(c),i=1<<d,_=a[d];_===-1?(!(i&n)||i&r)&&(a[d]=ole(i,t)):_<=t&&(e.expiredLanes|=i),c&=~i}}function $R(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function P9(){var e=PE;return PE<<=1,!(PE&4194240)&&(PE=64),e}function VO(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function dS(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-eh(t),e[t]=n}function sle(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-eh(n),c=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~c}}function l3(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-eh(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var _o=0;function C9(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var I9,c3,M9,O9,k9,UR=!1,IE=[],$p=null,Up=null,Vp=null,Hb=new Map,qb=new Map,Ip=[],lle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j$(e,t){switch(e){case"focusin":case"focusout":$p=null;break;case"dragenter":case"dragleave":Up=null;break;case"mouseover":case"mouseout":Vp=null;break;case"pointerover":case"pointerout":Hb.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qb.delete(t.pointerId)}}function k1(e,t,n,r,a,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:c,targetContainers:[a]},t!==null&&(t=pS(t),t!==null&&c3(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function cle(e,t,n,r,a){switch(t){case"focusin":return $p=k1($p,e,t,n,r,a),!0;case"dragenter":return Up=k1(Up,e,t,n,r,a),!0;case"mouseover":return Vp=k1(Vp,e,t,n,r,a),!0;case"pointerover":var c=a.pointerId;return Hb.set(c,k1(Hb.get(c)||null,e,t,n,r,a)),!0;case"gotpointercapture":return c=a.pointerId,qb.set(c,k1(qb.get(c)||null,e,t,n,r,a)),!0}return!1}function R9(e){var t=Fg(e.target);if(t!==null){var n=v_(t);if(n!==null){if(t=n.tag,t===13){if(t=b9(n),t!==null){e.blockedOn=t,k9(e.priority,function(){M9(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function y2(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=VR(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);NR=r,n.target.dispatchEvent(r),NR=null}else return t=pS(n),t!==null&&c3(t),e.blockedOn=n,!1;t.shift()}return!0}function $$(e,t,n){y2(e)&&n.delete(t)}function ule(){UR=!1,$p!==null&&y2($p)&&($p=null),Up!==null&&y2(Up)&&(Up=null),Vp!==null&&y2(Vp)&&(Vp=null),Hb.forEach($$),qb.forEach($$)}function R1(e,t){e.blockedOn===t&&(e.blockedOn=null,UR||(UR=!0,Dc.unstable_scheduleCallback(Dc.unstable_NormalPriority,ule)))}function Zb(e){function t(a){return R1(a,e)}if(0<IE.length){R1(IE[0],e);for(var n=1;n<IE.length;n++){var r=IE[n];r.blockedOn===e&&(r.blockedOn=null)}}for($p!==null&&R1($p,e),Up!==null&&R1(Up,e),Vp!==null&&R1(Vp,e),Hb.forEach(t),qb.forEach(t),n=0;n<Ip.length;n++)r=Ip[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ip.length&&(n=Ip[0],n.blockedOn===null);)R9(n),n.blockedOn===null&&Ip.shift()}var Sv=xf.ReactCurrentBatchConfig,V2=!0;function hle(e,t,n,r){var a=_o,c=Sv.transition;Sv.transition=null;try{_o=1,u3(e,t,n,r)}finally{_o=a,Sv.transition=c}}function dle(e,t,n,r){var a=_o,c=Sv.transition;Sv.transition=null;try{_o=4,u3(e,t,n,r)}finally{_o=a,Sv.transition=c}}function u3(e,t,n,r){if(V2){var a=VR(e,t,n,r);if(a===null)QO(e,t,r,W2,n),j$(e,r);else if(cle(a,e,t,n,r))r.stopPropagation();else if(j$(e,r),t&4&&-1<lle.indexOf(e)){for(;a!==null;){var c=pS(a);if(c!==null&&I9(c),c=VR(e,t,n,r),c===null&&QO(e,t,r,W2,n),c===a)break;a=c}a!==null&&r.stopPropagation()}else QO(e,t,r,null,n)}}var W2=null;function VR(e,t,n,r){if(W2=null,e=a3(r),e=Fg(e),e!==null)if(t=v_(e),t===null)e=null;else if(n=t.tag,n===13){if(e=b9(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return W2=e,null}function D9(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qse()){case s3:return 1;case E9:return 4;case $2:case ele:return 16;case A9:return 536870912;default:return 16}default:return 16}}var Lp=null,h3=null,v2=null;function L9(){if(v2)return v2;var e,t=h3,n=t.length,r,a="value"in Lp?Lp.value:Lp.textContent,c=a.length;for(e=0;e<n&&t[e]===a[e];e++);var d=n-e;for(r=1;r<=d&&t[n-r]===a[c-r];r++);return v2=a.slice(e,1<r?1-r:void 0)}function x2(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ME(){return!0}function U$(){return!1}function Nc(e){function t(n,r,a,c,d){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(c):c[i]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?ME:U$,this.isPropagationStopped=U$,this}return da(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ME)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ME)},persist:function(){},isPersistent:ME}),t}var D0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d3=Nc(D0),fS=da({},D0,{view:0,detail:0}),fle=Nc(fS),WO,GO,D1,KP=da({},fS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:f3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==D1&&(D1&&e.type==="mousemove"?(WO=e.screenX-D1.screenX,GO=e.screenY-D1.screenY):GO=WO=0,D1=e),WO)},movementY:function(e){return"movementY"in e?e.movementY:GO}}),V$=Nc(KP),ple=da({},KP,{dataTransfer:0}),mle=Nc(ple),gle=da({},fS,{relatedTarget:0}),HO=Nc(gle),_le=da({},D0,{animationName:0,elapsedTime:0,pseudoElement:0}),yle=Nc(_le),vle=da({},D0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xle=Nc(vle),ble=da({},D0,{data:0}),W$=Nc(ble),wle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sle={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tle={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ele(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tle[e])?!!t[e]:!1}function f3(){return Ele}var Ale=da({},fS,{key:function(e){if(e.key){var t=wle[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=x2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Sle[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:f3,charCode:function(e){return e.type==="keypress"?x2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?x2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ple=Nc(Ale),Cle=da({},KP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),G$=Nc(Cle),Ile=da({},fS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:f3}),Mle=Nc(Ile),Ole=da({},D0,{propertyName:0,elapsedTime:0,pseudoElement:0}),kle=Nc(Ole),Rle=da({},KP,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dle=Nc(Rle),Lle=[9,13,27,32],p3=cf&&"CompositionEvent"in window,vb=null;cf&&"documentMode"in document&&(vb=document.documentMode);var zle=cf&&"TextEvent"in window&&!vb,z9=cf&&(!p3||vb&&8<vb&&11>=vb),H$=" ",q$=!1;function N9(e,t){switch(e){case"keyup":return Lle.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F9(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ov=!1;function Nle(e,t){switch(e){case"compositionend":return F9(t);case"keypress":return t.which!==32?null:(q$=!0,H$);case"textInput":return e=t.data,e===H$&&q$?null:e;default:return null}}function Fle(e,t){if(ov)return e==="compositionend"||!p3&&N9(e,t)?(e=L9(),v2=h3=Lp=null,ov=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return z9&&t.locale!=="ko"?null:t.data;default:return null}}var Ble={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Z$(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ble[e.type]:t==="textarea"}function B9(e,t,n,r){g9(r),t=G2(t,"onChange"),0<t.length&&(n=new d3("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var xb=null,Xb=null;function jle(e){K9(e,0)}function YP(e){var t=lv(e);if(c9(t))return e}function $le(e,t){if(e==="change")return t}var j9=!1;if(cf){var qO;if(cf){var ZO="oninput"in document;if(!ZO){var X$=document.createElement("div");X$.setAttribute("oninput","return;"),ZO=typeof X$.oninput=="function"}qO=ZO}else qO=!1;j9=qO&&(!document.documentMode||9<document.documentMode)}function K$(){xb&&(xb.detachEvent("onpropertychange",$9),Xb=xb=null)}function $9(e){if(e.propertyName==="value"&&YP(Xb)){var t=[];B9(t,Xb,e,a3(e)),x9(jle,t)}}function Ule(e,t,n){e==="focusin"?(K$(),xb=t,Xb=n,xb.attachEvent("onpropertychange",$9)):e==="focusout"&&K$()}function Vle(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return YP(Xb)}function Wle(e,t){if(e==="click")return YP(t)}function Gle(e,t){if(e==="input"||e==="change")return YP(t)}function Hle(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ah=typeof Object.is=="function"?Object.is:Hle;function Kb(e,t){if(ah(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!ER.call(t,a)||!ah(e[a],t[a]))return!1}return!0}function Y$(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function J$(e,t){var n=Y$(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Y$(n)}}function U9(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?U9(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function V9(){for(var e=window,t=F2();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=F2(e.document)}return t}function m3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qle(e){var t=V9(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&U9(n.ownerDocument.documentElement,n)){if(r!==null&&m3(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,c=Math.min(r.start,a);r=r.end===void 0?c:Math.min(r.end,a),!e.extend&&c>r&&(a=r,r=c,c=a),a=J$(n,c);var d=J$(n,r);a&&d&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),c>r?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Zle=cf&&"documentMode"in document&&11>=document.documentMode,av=null,WR=null,bb=null,GR=!1;function Q$(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;GR||av==null||av!==F2(r)||(r=av,"selectionStart"in r&&m3(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bb&&Kb(bb,r)||(bb=r,r=G2(WR,"onSelect"),0<r.length&&(t=new d3("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=av)))}function OE(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var sv={animationend:OE("Animation","AnimationEnd"),animationiteration:OE("Animation","AnimationIteration"),animationstart:OE("Animation","AnimationStart"),transitionend:OE("Transition","TransitionEnd")},XO={},W9={};cf&&(W9=document.createElement("div").style,"AnimationEvent"in window||(delete sv.animationend.animation,delete sv.animationiteration.animation,delete sv.animationstart.animation),"TransitionEvent"in window||delete sv.transitionend.transition);function JP(e){if(XO[e])return XO[e];if(!sv[e])return e;var t=sv[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in W9)return XO[e]=t[n];return e}var G9=JP("animationend"),H9=JP("animationiteration"),q9=JP("animationstart"),Z9=JP("transitionend"),X9=new Map,eU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mm(e,t){X9.set(e,t),y_(t,[e])}for(var KO=0;KO<eU.length;KO++){var YO=eU[KO],Xle=YO.toLowerCase(),Kle=YO[0].toUpperCase()+YO.slice(1);mm(Xle,"on"+Kle)}mm(G9,"onAnimationEnd");mm(H9,"onAnimationIteration");mm(q9,"onAnimationStart");mm("dblclick","onDoubleClick");mm("focusin","onFocus");mm("focusout","onBlur");mm(Z9,"onTransitionEnd");zv("onMouseEnter",["mouseout","mouseover"]);zv("onMouseLeave",["mouseout","mouseover"]);zv("onPointerEnter",["pointerout","pointerover"]);zv("onPointerLeave",["pointerout","pointerover"]);y_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));y_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));y_("onBeforeInput",["compositionend","keypress","textInput","paste"]);y_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));y_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));y_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ob="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yle=new Set("cancel close invalid load scroll toggle".split(" ").concat(ob));function tU(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Xse(r,t,void 0,e),e.currentTarget=null}function K9(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var c=void 0;if(t)for(var d=r.length-1;0<=d;d--){var i=r[d],_=i.instance,b=i.currentTarget;if(i=i.listener,_!==c&&a.isPropagationStopped())break e;tU(a,i,b),c=_}else for(d=0;d<r.length;d++){if(i=r[d],_=i.instance,b=i.currentTarget,i=i.listener,_!==c&&a.isPropagationStopped())break e;tU(a,i,b),c=_}}}if(j2)throw e=jR,j2=!1,jR=null,e}function Go(e,t){var n=t[KR];n===void 0&&(n=t[KR]=new Set);var r=e+"__bubble";n.has(r)||(Y9(t,e,2,!1),n.add(r))}function JO(e,t,n){var r=0;t&&(r|=4),Y9(n,e,r,t)}var kE="_reactListening"+Math.random().toString(36).slice(2);function Yb(e){if(!e[kE]){e[kE]=!0,i9.forEach(function(n){n!=="selectionchange"&&(Yle.has(n)||JO(n,!1,e),JO(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[kE]||(t[kE]=!0,JO("selectionchange",!1,t))}}function Y9(e,t,n,r){switch(D9(t)){case 1:var a=hle;break;case 4:a=dle;break;default:a=u3}n=a.bind(null,t,n,e),a=void 0,!BR||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function QO(e,t,n,r,a){var c=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var d=r.tag;if(d===3||d===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(d===4)for(d=r.return;d!==null;){var _=d.tag;if((_===3||_===4)&&(_=d.stateNode.containerInfo,_===a||_.nodeType===8&&_.parentNode===a))return;d=d.return}for(;i!==null;){if(d=Fg(i),d===null)return;if(_=d.tag,_===5||_===6){r=c=d;continue e}i=i.parentNode}}r=r.return}x9(function(){var b=c,T=a3(n),A=[];e:{var k=X9.get(e);if(k!==void 0){var R=d3,B=e;switch(e){case"keypress":if(x2(n)===0)break e;case"keydown":case"keyup":R=Ple;break;case"focusin":B="focus",R=HO;break;case"focusout":B="blur",R=HO;break;case"beforeblur":case"afterblur":R=HO;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=V$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=mle;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=Mle;break;case G9:case H9:case q9:R=yle;break;case Z9:R=kle;break;case"scroll":R=fle;break;case"wheel":R=Dle;break;case"copy":case"cut":case"paste":R=xle;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=G$}var N=(t&4)!==0,V=!N&&e==="scroll",H=N?k!==null?k+"Capture":null:k;N=[];for(var G=b,q;G!==null;){q=G;var Q=q.stateNode;if(q.tag===5&&Q!==null&&(q=Q,H!==null&&(Q=Gb(G,H),Q!=null&&N.push(Jb(G,Q,q)))),V)break;G=G.return}0<N.length&&(k=new R(k,B,null,n,T),A.push({event:k,listeners:N}))}}if(!(t&7)){e:{if(k=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",k&&n!==NR&&(B=n.relatedTarget||n.fromElement)&&(Fg(B)||B[uf]))break e;if((R||k)&&(k=T.window===T?T:(k=T.ownerDocument)?k.defaultView||k.parentWindow:window,R?(B=n.relatedTarget||n.toElement,R=b,B=B?Fg(B):null,B!==null&&(V=v_(B),B!==V||B.tag!==5&&B.tag!==6)&&(B=null)):(R=null,B=b),R!==B)){if(N=V$,Q="onMouseLeave",H="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(N=G$,Q="onPointerLeave",H="onPointerEnter",G="pointer"),V=R==null?k:lv(R),q=B==null?k:lv(B),k=new N(Q,G+"leave",R,n,T),k.target=V,k.relatedTarget=q,Q=null,Fg(T)===b&&(N=new N(H,G+"enter",B,n,T),N.target=q,N.relatedTarget=V,Q=N),V=Q,R&&B)t:{for(N=R,H=B,G=0,q=N;q;q=Ny(q))G++;for(q=0,Q=H;Q;Q=Ny(Q))q++;for(;0<G-q;)N=Ny(N),G--;for(;0<q-G;)H=Ny(H),q--;for(;G--;){if(N===H||H!==null&&N===H.alternate)break t;N=Ny(N),H=Ny(H)}N=null}else N=null;R!==null&&nU(A,k,R,N,!1),B!==null&&V!==null&&nU(A,V,B,N,!0)}}e:{if(k=b?lv(b):window,R=k.nodeName&&k.nodeName.toLowerCase(),R==="select"||R==="input"&&k.type==="file")var te=$le;else if(Z$(k))if(j9)te=Gle;else{te=Vle;var ue=Ule}else(R=k.nodeName)&&R.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(te=Wle);if(te&&(te=te(e,b))){B9(A,te,n,T);break e}ue&&ue(e,k,b),e==="focusout"&&(ue=k._wrapperState)&&ue.controlled&&k.type==="number"&&kR(k,"number",k.value)}switch(ue=b?lv(b):window,e){case"focusin":(Z$(ue)||ue.contentEditable==="true")&&(av=ue,WR=b,bb=null);break;case"focusout":bb=WR=av=null;break;case"mousedown":GR=!0;break;case"contextmenu":case"mouseup":case"dragend":GR=!1,Q$(A,n,T);break;case"selectionchange":if(Zle)break;case"keydown":case"keyup":Q$(A,n,T)}var fe;if(p3)e:{switch(e){case"compositionstart":var ye="onCompositionStart";break e;case"compositionend":ye="onCompositionEnd";break e;case"compositionupdate":ye="onCompositionUpdate";break e}ye=void 0}else ov?N9(e,n)&&(ye="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ye="onCompositionStart");ye&&(z9&&n.locale!=="ko"&&(ov||ye!=="onCompositionStart"?ye==="onCompositionEnd"&&ov&&(fe=L9()):(Lp=T,h3="value"in Lp?Lp.value:Lp.textContent,ov=!0)),ue=G2(b,ye),0<ue.length&&(ye=new W$(ye,e,null,n,T),A.push({event:ye,listeners:ue}),fe?ye.data=fe:(fe=F9(n),fe!==null&&(ye.data=fe)))),(fe=zle?Nle(e,n):Fle(e,n))&&(b=G2(b,"onBeforeInput"),0<b.length&&(T=new W$("onBeforeInput","beforeinput",null,n,T),A.push({event:T,listeners:b}),T.data=fe))}K9(A,t)})}function Jb(e,t,n){return{instance:e,listener:t,currentTarget:n}}function G2(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Gb(e,n),c!=null&&r.unshift(Jb(e,c,a)),c=Gb(e,t),c!=null&&r.push(Jb(e,c,a))),e=e.return}return r}function Ny(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function nU(e,t,n,r,a){for(var c=t._reactName,d=[];n!==null&&n!==r;){var i=n,_=i.alternate,b=i.stateNode;if(_!==null&&_===r)break;i.tag===5&&b!==null&&(i=b,a?(_=Gb(n,c),_!=null&&d.unshift(Jb(n,_,i))):a||(_=Gb(n,c),_!=null&&d.push(Jb(n,_,i)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var Jle=/\r\n?/g,Qle=/\u0000|\uFFFD/g;function rU(e){return(typeof e=="string"?e:""+e).replace(Jle,`
`).replace(Qle,"")}function RE(e,t,n){if(t=rU(t),rU(e)!==t&&n)throw Error(Rn(425))}function H2(){}var HR=null,qR=null;function ZR(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var XR=typeof setTimeout=="function"?setTimeout:void 0,ece=typeof clearTimeout=="function"?clearTimeout:void 0,iU=typeof Promise=="function"?Promise:void 0,tce=typeof queueMicrotask=="function"?queueMicrotask:typeof iU<"u"?function(e){return iU.resolve(null).then(e).catch(nce)}:XR;function nce(e){setTimeout(function(){throw e})}function ek(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Zb(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Zb(t)}function Wp(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function oU(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var L0=Math.random().toString(36).slice(2),Wh="__reactFiber$"+L0,Qb="__reactProps$"+L0,uf="__reactContainer$"+L0,KR="__reactEvents$"+L0,rce="__reactListeners$"+L0,ice="__reactHandles$"+L0;function Fg(e){var t=e[Wh];if(t)return t;for(var n=e.parentNode;n;){if(t=n[uf]||n[Wh]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=oU(e);e!==null;){if(n=e[Wh])return n;e=oU(e)}return t}e=n,n=e.parentNode}return null}function pS(e){return e=e[Wh]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Rn(33))}function QP(e){return e[Qb]||null}var YR=[],cv=-1;function gm(e){return{current:e}}function Xo(e){0>cv||(e.current=YR[cv],YR[cv]=null,cv--)}function zo(e,t){cv++,YR[cv]=e.current,e.current=t}var nm={},tl=gm(nm),Yl=gm(!1),Jg=nm;function Nv(e,t){var n=e.type.contextTypes;if(!n)return nm;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in n)a[c]=t[c];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Jl(e){return e=e.childContextTypes,e!=null}function q2(){Xo(Yl),Xo(tl)}function aU(e,t,n){if(tl.current!==nm)throw Error(Rn(168));zo(tl,t),zo(Yl,n)}function J9(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(Rn(108,Use(e)||"Unknown",a));return da({},n,r)}function Z2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||nm,Jg=tl.current,zo(tl,e),zo(Yl,Yl.current),!0}function sU(e,t,n){var r=e.stateNode;if(!r)throw Error(Rn(169));n?(e=J9(e,t,Jg),r.__reactInternalMemoizedMergedChildContext=e,Xo(Yl),Xo(tl),zo(tl,e)):Xo(Yl),zo(Yl,n)}var Jd=null,eC=!1,tk=!1;function Q9(e){Jd===null?Jd=[e]:Jd.push(e)}function oce(e){eC=!0,Q9(e)}function _m(){if(!tk&&Jd!==null){tk=!0;var e=0,t=_o;try{var n=Jd;for(_o=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Jd=null,eC=!1}catch(a){throw Jd!==null&&(Jd=Jd.slice(e+1)),T9(s3,_m),a}finally{_o=t,tk=!1}}return null}var uv=[],hv=0,X2=null,K2=0,Qc=[],eu=0,Qg=null,Qd=1,ef="";function Ig(e,t){uv[hv++]=K2,uv[hv++]=X2,X2=e,K2=t}function e7(e,t,n){Qc[eu++]=Qd,Qc[eu++]=ef,Qc[eu++]=Qg,Qg=e;var r=Qd;e=ef;var a=32-eh(r)-1;r&=~(1<<a),n+=1;var c=32-eh(t)+a;if(30<c){var d=a-a%5;c=(r&(1<<d)-1).toString(32),r>>=d,a-=d,Qd=1<<32-eh(t)+a|n<<a|r,ef=c+e}else Qd=1<<c|n<<a|r,ef=e}function g3(e){e.return!==null&&(Ig(e,1),e7(e,1,0))}function _3(e){for(;e===X2;)X2=uv[--hv],uv[hv]=null,K2=uv[--hv],uv[hv]=null;for(;e===Qg;)Qg=Qc[--eu],Qc[eu]=null,ef=Qc[--eu],Qc[eu]=null,Qd=Qc[--eu],Qc[eu]=null}var Mc=null,Ic=null,ea=!1,Xu=null;function t7(e,t){var n=nu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function lU(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Mc=e,Ic=Wp(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Mc=e,Ic=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Qg!==null?{id:Qd,overflow:ef}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=nu(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Mc=e,Ic=null,!0):!1;default:return!1}}function JR(e){return(e.mode&1)!==0&&(e.flags&128)===0}function QR(e){if(ea){var t=Ic;if(t){var n=t;if(!lU(e,t)){if(JR(e))throw Error(Rn(418));t=Wp(n.nextSibling);var r=Mc;t&&lU(e,t)?t7(r,n):(e.flags=e.flags&-4097|2,ea=!1,Mc=e)}}else{if(JR(e))throw Error(Rn(418));e.flags=e.flags&-4097|2,ea=!1,Mc=e}}}function cU(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Mc=e}function DE(e){if(e!==Mc)return!1;if(!ea)return cU(e),ea=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ZR(e.type,e.memoizedProps)),t&&(t=Ic)){if(JR(e))throw n7(),Error(Rn(418));for(;t;)t7(e,t),t=Wp(t.nextSibling)}if(cU(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Rn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ic=Wp(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ic=null}}else Ic=Mc?Wp(e.stateNode.nextSibling):null;return!0}function n7(){for(var e=Ic;e;)e=Wp(e.nextSibling)}function Fv(){Ic=Mc=null,ea=!1}function y3(e){Xu===null?Xu=[e]:Xu.push(e)}var ace=xf.ReactCurrentBatchConfig;function L1(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Rn(309));var r=n.stateNode}if(!r)throw Error(Rn(147,e));var a=r,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(d){var i=a.refs;d===null?delete i[c]:i[c]=d},t._stringRef=c,t)}if(typeof e!="string")throw Error(Rn(284));if(!n._owner)throw Error(Rn(290,e))}return e}function LE(e,t){throw e=Object.prototype.toString.call(t),Error(Rn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function uU(e){var t=e._init;return t(e._payload)}function r7(e){function t(H,G){if(e){var q=H.deletions;q===null?(H.deletions=[G],H.flags|=16):q.push(G)}}function n(H,G){if(!e)return null;for(;G!==null;)t(H,G),G=G.sibling;return null}function r(H,G){for(H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function a(H,G){return H=Zp(H,G),H.index=0,H.sibling=null,H}function c(H,G,q){return H.index=q,e?(q=H.alternate,q!==null?(q=q.index,q<G?(H.flags|=2,G):q):(H.flags|=2,G)):(H.flags|=1048576,G)}function d(H){return e&&H.alternate===null&&(H.flags|=2),H}function i(H,G,q,Q){return G===null||G.tag!==6?(G=lk(q,H.mode,Q),G.return=H,G):(G=a(G,q),G.return=H,G)}function _(H,G,q,Q){var te=q.type;return te===iv?T(H,G,q.props.children,Q,q.key):G!==null&&(G.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Ep&&uU(te)===G.type)?(Q=a(G,q.props),Q.ref=L1(H,G,q),Q.return=H,Q):(Q=P2(q.type,q.key,q.props,null,H.mode,Q),Q.ref=L1(H,G,q),Q.return=H,Q)}function b(H,G,q,Q){return G===null||G.tag!==4||G.stateNode.containerInfo!==q.containerInfo||G.stateNode.implementation!==q.implementation?(G=ck(q,H.mode,Q),G.return=H,G):(G=a(G,q.children||[]),G.return=H,G)}function T(H,G,q,Q,te){return G===null||G.tag!==7?(G=Zg(q,H.mode,Q,te),G.return=H,G):(G=a(G,q),G.return=H,G)}function A(H,G,q){if(typeof G=="string"&&G!==""||typeof G=="number")return G=lk(""+G,H.mode,q),G.return=H,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case TE:return q=P2(G.type,G.key,G.props,null,H.mode,q),q.ref=L1(H,null,G),q.return=H,q;case rv:return G=ck(G,H.mode,q),G.return=H,G;case Ep:var Q=G._init;return A(H,Q(G._payload),q)}if(rb(G)||M1(G))return G=Zg(G,H.mode,q,null),G.return=H,G;LE(H,G)}return null}function k(H,G,q,Q){var te=G!==null?G.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return te!==null?null:i(H,G,""+q,Q);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case TE:return q.key===te?_(H,G,q,Q):null;case rv:return q.key===te?b(H,G,q,Q):null;case Ep:return te=q._init,k(H,G,te(q._payload),Q)}if(rb(q)||M1(q))return te!==null?null:T(H,G,q,Q,null);LE(H,q)}return null}function R(H,G,q,Q,te){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return H=H.get(q)||null,i(G,H,""+Q,te);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case TE:return H=H.get(Q.key===null?q:Q.key)||null,_(G,H,Q,te);case rv:return H=H.get(Q.key===null?q:Q.key)||null,b(G,H,Q,te);case Ep:var ue=Q._init;return R(H,G,q,ue(Q._payload),te)}if(rb(Q)||M1(Q))return H=H.get(q)||null,T(G,H,Q,te,null);LE(G,Q)}return null}function B(H,G,q,Q){for(var te=null,ue=null,fe=G,ye=G=0,De=null;fe!==null&&ye<q.length;ye++){fe.index>ye?(De=fe,fe=null):De=fe.sibling;var Ne=k(H,fe,q[ye],Q);if(Ne===null){fe===null&&(fe=De);break}e&&fe&&Ne.alternate===null&&t(H,fe),G=c(Ne,G,ye),ue===null?te=Ne:ue.sibling=Ne,ue=Ne,fe=De}if(ye===q.length)return n(H,fe),ea&&Ig(H,ye),te;if(fe===null){for(;ye<q.length;ye++)fe=A(H,q[ye],Q),fe!==null&&(G=c(fe,G,ye),ue===null?te=fe:ue.sibling=fe,ue=fe);return ea&&Ig(H,ye),te}for(fe=r(H,fe);ye<q.length;ye++)De=R(fe,H,ye,q[ye],Q),De!==null&&(e&&De.alternate!==null&&fe.delete(De.key===null?ye:De.key),G=c(De,G,ye),ue===null?te=De:ue.sibling=De,ue=De);return e&&fe.forEach(function(Fe){return t(H,Fe)}),ea&&Ig(H,ye),te}function N(H,G,q,Q){var te=M1(q);if(typeof te!="function")throw Error(Rn(150));if(q=te.call(q),q==null)throw Error(Rn(151));for(var ue=te=null,fe=G,ye=G=0,De=null,Ne=q.next();fe!==null&&!Ne.done;ye++,Ne=q.next()){fe.index>ye?(De=fe,fe=null):De=fe.sibling;var Fe=k(H,fe,Ne.value,Q);if(Fe===null){fe===null&&(fe=De);break}e&&fe&&Fe.alternate===null&&t(H,fe),G=c(Fe,G,ye),ue===null?te=Fe:ue.sibling=Fe,ue=Fe,fe=De}if(Ne.done)return n(H,fe),ea&&Ig(H,ye),te;if(fe===null){for(;!Ne.done;ye++,Ne=q.next())Ne=A(H,Ne.value,Q),Ne!==null&&(G=c(Ne,G,ye),ue===null?te=Ne:ue.sibling=Ne,ue=Ne);return ea&&Ig(H,ye),te}for(fe=r(H,fe);!Ne.done;ye++,Ne=q.next())Ne=R(fe,H,ye,Ne.value,Q),Ne!==null&&(e&&Ne.alternate!==null&&fe.delete(Ne.key===null?ye:Ne.key),G=c(Ne,G,ye),ue===null?te=Ne:ue.sibling=Ne,ue=Ne);return e&&fe.forEach(function(Le){return t(H,Le)}),ea&&Ig(H,ye),te}function V(H,G,q,Q){if(typeof q=="object"&&q!==null&&q.type===iv&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case TE:e:{for(var te=q.key,ue=G;ue!==null;){if(ue.key===te){if(te=q.type,te===iv){if(ue.tag===7){n(H,ue.sibling),G=a(ue,q.props.children),G.return=H,H=G;break e}}else if(ue.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Ep&&uU(te)===ue.type){n(H,ue.sibling),G=a(ue,q.props),G.ref=L1(H,ue,q),G.return=H,H=G;break e}n(H,ue);break}else t(H,ue);ue=ue.sibling}q.type===iv?(G=Zg(q.props.children,H.mode,Q,q.key),G.return=H,H=G):(Q=P2(q.type,q.key,q.props,null,H.mode,Q),Q.ref=L1(H,G,q),Q.return=H,H=Q)}return d(H);case rv:e:{for(ue=q.key;G!==null;){if(G.key===ue)if(G.tag===4&&G.stateNode.containerInfo===q.containerInfo&&G.stateNode.implementation===q.implementation){n(H,G.sibling),G=a(G,q.children||[]),G.return=H,H=G;break e}else{n(H,G);break}else t(H,G);G=G.sibling}G=ck(q,H.mode,Q),G.return=H,H=G}return d(H);case Ep:return ue=q._init,V(H,G,ue(q._payload),Q)}if(rb(q))return B(H,G,q,Q);if(M1(q))return N(H,G,q,Q);LE(H,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,G!==null&&G.tag===6?(n(H,G.sibling),G=a(G,q),G.return=H,H=G):(n(H,G),G=lk(q,H.mode,Q),G.return=H,H=G),d(H)):n(H,G)}return V}var Bv=r7(!0),i7=r7(!1),Y2=gm(null),J2=null,dv=null,v3=null;function x3(){v3=dv=J2=null}function b3(e){var t=Y2.current;Xo(Y2),e._currentValue=t}function eD(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Tv(e,t){J2=e,v3=dv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Zl=!0),e.firstContext=null)}function su(e){var t=e._currentValue;if(v3!==e)if(e={context:e,memoizedValue:t,next:null},dv===null){if(J2===null)throw Error(Rn(308));dv=e,J2.dependencies={lanes:0,firstContext:e}}else dv=dv.next=e;return t}var Bg=null;function w3(e){Bg===null?Bg=[e]:Bg.push(e)}function o7(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,w3(t)):(n.next=a.next,a.next=n),t.interleaved=n,hf(e,r)}function hf(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ap=!1;function S3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function af(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gp(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,eo&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,hf(e,n)}return a=r.interleaved,a===null?(t.next=t,w3(r)):(t.next=a.next,a.next=t),r.interleaved=t,hf(e,n)}function b2(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,l3(e,n)}}function hU(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?a=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?a=c=t:c=c.next=t}else a=c=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Q2(e,t,n,r){var a=e.updateQueue;Ap=!1;var c=a.firstBaseUpdate,d=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var _=i,b=_.next;_.next=null,d===null?c=b:d.next=b,d=_;var T=e.alternate;T!==null&&(T=T.updateQueue,i=T.lastBaseUpdate,i!==d&&(i===null?T.firstBaseUpdate=b:i.next=b,T.lastBaseUpdate=_))}if(c!==null){var A=a.baseState;d=0,T=b=_=null,i=c;do{var k=i.lane,R=i.eventTime;if((r&k)===k){T!==null&&(T=T.next={eventTime:R,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var B=e,N=i;switch(k=t,R=n,N.tag){case 1:if(B=N.payload,typeof B=="function"){A=B.call(R,A,k);break e}A=B;break e;case 3:B.flags=B.flags&-65537|128;case 0:if(B=N.payload,k=typeof B=="function"?B.call(R,A,k):B,k==null)break e;A=da({},A,k);break e;case 2:Ap=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,k=a.effects,k===null?a.effects=[i]:k.push(i))}else R={eventTime:R,lane:k,tag:i.tag,payload:i.payload,callback:i.callback,next:null},T===null?(b=T=R,_=A):T=T.next=R,d|=k;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;k=i,i=k.next,k.next=null,a.lastBaseUpdate=k,a.shared.pending=null}}while(!0);if(T===null&&(_=A),a.baseState=_,a.firstBaseUpdate=b,a.lastBaseUpdate=T,t=a.shared.interleaved,t!==null){a=t;do d|=a.lane,a=a.next;while(a!==t)}else c===null&&(a.shared.lanes=0);t_|=d,e.lanes=d,e.memoizedState=A}}function dU(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Rn(191,a));a.call(r)}}}var mS={},Kh=gm(mS),ew=gm(mS),tw=gm(mS);function jg(e){if(e===mS)throw Error(Rn(174));return e}function T3(e,t){switch(zo(tw,t),zo(ew,e),zo(Kh,mS),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:DR(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=DR(t,e)}Xo(Kh),zo(Kh,t)}function jv(){Xo(Kh),Xo(ew),Xo(tw)}function s7(e){jg(tw.current);var t=jg(Kh.current),n=DR(t,e.type);t!==n&&(zo(ew,e),zo(Kh,n))}function E3(e){ew.current===e&&(Xo(Kh),Xo(ew))}var la=gm(0);function eA(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nk=[];function A3(){for(var e=0;e<nk.length;e++)nk[e]._workInProgressVersionPrimary=null;nk.length=0}var w2=xf.ReactCurrentDispatcher,rk=xf.ReactCurrentBatchConfig,e_=0,ha=null,ls=null,xs=null,tA=!1,wb=!1,nw=0,sce=0;function Hs(){throw Error(Rn(321))}function P3(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ah(e[n],t[n]))return!1;return!0}function C3(e,t,n,r,a,c){if(e_=c,ha=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,w2.current=e===null||e.memoizedState===null?hce:dce,e=n(r,a),wb){c=0;do{if(wb=!1,nw=0,25<=c)throw Error(Rn(301));c+=1,xs=ls=null,t.updateQueue=null,w2.current=fce,e=n(r,a)}while(wb)}if(w2.current=nA,t=ls!==null&&ls.next!==null,e_=0,xs=ls=ha=null,tA=!1,t)throw Error(Rn(300));return e}function I3(){var e=nw!==0;return nw=0,e}function Vh(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xs===null?ha.memoizedState=xs=e:xs=xs.next=e,xs}function lu(){if(ls===null){var e=ha.alternate;e=e!==null?e.memoizedState:null}else e=ls.next;var t=xs===null?ha.memoizedState:xs.next;if(t!==null)xs=t,ls=e;else{if(e===null)throw Error(Rn(310));ls=e,e={memoizedState:ls.memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},xs===null?ha.memoizedState=xs=e:xs=xs.next=e}return xs}function rw(e,t){return typeof t=="function"?t(e):t}function ik(e){var t=lu(),n=t.queue;if(n===null)throw Error(Rn(311));n.lastRenderedReducer=e;var r=ls,a=r.baseQueue,c=n.pending;if(c!==null){if(a!==null){var d=a.next;a.next=c.next,c.next=d}r.baseQueue=a=c,n.pending=null}if(a!==null){c=a.next,r=r.baseState;var i=d=null,_=null,b=c;do{var T=b.lane;if((e_&T)===T)_!==null&&(_=_.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),r=b.hasEagerState?b.eagerState:e(r,b.action);else{var A={lane:T,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};_===null?(i=_=A,d=r):_=_.next=A,ha.lanes|=T,t_|=T}b=b.next}while(b!==null&&b!==c);_===null?d=r:_.next=i,ah(r,t.memoizedState)||(Zl=!0),t.memoizedState=r,t.baseState=d,t.baseQueue=_,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do c=a.lane,ha.lanes|=c,t_|=c,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ok(e){var t=lu(),n=t.queue;if(n===null)throw Error(Rn(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,c=t.memoizedState;if(a!==null){n.pending=null;var d=a=a.next;do c=e(c,d.action),d=d.next;while(d!==a);ah(c,t.memoizedState)||(Zl=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,r]}function l7(){}function c7(e,t){var n=ha,r=lu(),a=t(),c=!ah(r.memoizedState,a);if(c&&(r.memoizedState=a,Zl=!0),r=r.queue,M3(d7.bind(null,n,r,e),[e]),r.getSnapshot!==t||c||xs!==null&&xs.memoizedState.tag&1){if(n.flags|=2048,iw(9,h7.bind(null,n,r,a,t),void 0,null),Ss===null)throw Error(Rn(349));e_&30||u7(n,t,a)}return a}function u7(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ha.updateQueue,t===null?(t={lastEffect:null,stores:null},ha.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function h7(e,t,n,r){t.value=n,t.getSnapshot=r,f7(t)&&p7(e)}function d7(e,t,n){return n(function(){f7(t)&&p7(e)})}function f7(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ah(e,n)}catch{return!0}}function p7(e){var t=hf(e,1);t!==null&&th(t,e,1,-1)}function fU(e){var t=Vh();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rw,lastRenderedState:e},t.queue=e,e=e.dispatch=uce.bind(null,ha,e),[t.memoizedState,e]}function iw(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ha.updateQueue,t===null?(t={lastEffect:null,stores:null},ha.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function m7(){return lu().memoizedState}function S2(e,t,n,r){var a=Vh();ha.flags|=e,a.memoizedState=iw(1|t,n,void 0,r===void 0?null:r)}function tC(e,t,n,r){var a=lu();r=r===void 0?null:r;var c=void 0;if(ls!==null){var d=ls.memoizedState;if(c=d.destroy,r!==null&&P3(r,d.deps)){a.memoizedState=iw(t,n,c,r);return}}ha.flags|=e,a.memoizedState=iw(1|t,n,c,r)}function pU(e,t){return S2(8390656,8,e,t)}function M3(e,t){return tC(2048,8,e,t)}function g7(e,t){return tC(4,2,e,t)}function _7(e,t){return tC(4,4,e,t)}function y7(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function v7(e,t,n){return n=n!=null?n.concat([e]):null,tC(4,4,y7.bind(null,t,e),n)}function O3(){}function x7(e,t){var n=lu();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&P3(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function b7(e,t){var n=lu();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&P3(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function w7(e,t,n){return e_&21?(ah(n,t)||(n=P9(),ha.lanes|=n,t_|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Zl=!0),e.memoizedState=n)}function lce(e,t){var n=_o;_o=n!==0&&4>n?n:4,e(!0);var r=rk.transition;rk.transition={};try{e(!1),t()}finally{_o=n,rk.transition=r}}function S7(){return lu().memoizedState}function cce(e,t,n){var r=qp(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},T7(e))E7(t,n);else if(n=o7(e,t,n,r),n!==null){var a=xl();th(n,e,r,a),A7(n,t,r)}}function uce(e,t,n){var r=qp(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(T7(e))E7(t,a);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,i=c(d,n);if(a.hasEagerState=!0,a.eagerState=i,ah(i,d)){var _=t.interleaved;_===null?(a.next=a,w3(t)):(a.next=_.next,_.next=a),t.interleaved=a;return}}catch{}finally{}n=o7(e,t,a,r),n!==null&&(a=xl(),th(n,e,r,a),A7(n,t,r))}}function T7(e){var t=e.alternate;return e===ha||t!==null&&t===ha}function E7(e,t){wb=tA=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function A7(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,l3(e,n)}}var nA={readContext:su,useCallback:Hs,useContext:Hs,useEffect:Hs,useImperativeHandle:Hs,useInsertionEffect:Hs,useLayoutEffect:Hs,useMemo:Hs,useReducer:Hs,useRef:Hs,useState:Hs,useDebugValue:Hs,useDeferredValue:Hs,useTransition:Hs,useMutableSource:Hs,useSyncExternalStore:Hs,useId:Hs,unstable_isNewReconciler:!1},hce={readContext:su,useCallback:function(e,t){return Vh().memoizedState=[e,t===void 0?null:t],e},useContext:su,useEffect:pU,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,S2(4194308,4,y7.bind(null,t,e),n)},useLayoutEffect:function(e,t){return S2(4194308,4,e,t)},useInsertionEffect:function(e,t){return S2(4,2,e,t)},useMemo:function(e,t){var n=Vh();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Vh();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=cce.bind(null,ha,e),[r.memoizedState,e]},useRef:function(e){var t=Vh();return e={current:e},t.memoizedState=e},useState:fU,useDebugValue:O3,useDeferredValue:function(e){return Vh().memoizedState=e},useTransition:function(){var e=fU(!1),t=e[0];return e=lce.bind(null,e[1]),Vh().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ha,a=Vh();if(ea){if(n===void 0)throw Error(Rn(407));n=n()}else{if(n=t(),Ss===null)throw Error(Rn(349));e_&30||u7(r,t,n)}a.memoizedState=n;var c={value:n,getSnapshot:t};return a.queue=c,pU(d7.bind(null,r,c,e),[e]),r.flags|=2048,iw(9,h7.bind(null,r,c,n,t),void 0,null),n},useId:function(){var e=Vh(),t=Ss.identifierPrefix;if(ea){var n=ef,r=Qd;n=(r&~(1<<32-eh(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=nw++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=sce++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dce={readContext:su,useCallback:x7,useContext:su,useEffect:M3,useImperativeHandle:v7,useInsertionEffect:g7,useLayoutEffect:_7,useMemo:b7,useReducer:ik,useRef:m7,useState:function(){return ik(rw)},useDebugValue:O3,useDeferredValue:function(e){var t=lu();return w7(t,ls.memoizedState,e)},useTransition:function(){var e=ik(rw)[0],t=lu().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:c7,useId:S7,unstable_isNewReconciler:!1},fce={readContext:su,useCallback:x7,useContext:su,useEffect:M3,useImperativeHandle:v7,useInsertionEffect:g7,useLayoutEffect:_7,useMemo:b7,useReducer:ok,useRef:m7,useState:function(){return ok(rw)},useDebugValue:O3,useDeferredValue:function(e){var t=lu();return ls===null?t.memoizedState=e:w7(t,ls.memoizedState,e)},useTransition:function(){var e=ok(rw)[0],t=lu().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:c7,useId:S7,unstable_isNewReconciler:!1};function Wu(e,t){if(e&&e.defaultProps){t=da({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function tD(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:da({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var nC={isMounted:function(e){return(e=e._reactInternals)?v_(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=xl(),a=qp(e),c=af(r,a);c.payload=t,n!=null&&(c.callback=n),t=Gp(e,c,a),t!==null&&(th(t,e,a,r),b2(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=xl(),a=qp(e),c=af(r,a);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=Gp(e,c,a),t!==null&&(th(t,e,a,r),b2(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=xl(),r=qp(e),a=af(n,r);a.tag=2,t!=null&&(a.callback=t),t=Gp(e,a,r),t!==null&&(th(t,e,r,n),b2(t,e,r))}};function mU(e,t,n,r,a,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,c,d):t.prototype&&t.prototype.isPureReactComponent?!Kb(n,r)||!Kb(a,c):!0}function P7(e,t,n){var r=!1,a=nm,c=t.contextType;return typeof c=="object"&&c!==null?c=su(c):(a=Jl(t)?Jg:tl.current,r=t.contextTypes,c=(r=r!=null)?Nv(e,a):nm),t=new t(n,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nC,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=c),t}function gU(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&nC.enqueueReplaceState(t,t.state,null)}function nD(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},S3(e);var c=t.contextType;typeof c=="object"&&c!==null?a.context=su(c):(c=Jl(t)?Jg:tl.current,a.context=Nv(e,c)),a.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(tD(e,t,c,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&nC.enqueueReplaceState(a,a.state,null),Q2(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function $v(e,t){try{var n="",r=t;do n+=$se(r),r=r.return;while(r);var a=n}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:a,digest:null}}function ak(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function rD(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pce=typeof WeakMap=="function"?WeakMap:Map;function C7(e,t,n){n=af(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){iA||(iA=!0,fD=r),rD(e,t)},n}function I7(e,t,n){n=af(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){rD(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){rD(e,t),typeof r!="function"&&(Hp===null?Hp=new Set([this]):Hp.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),n}function _U(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new pce;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cce.bind(null,e,t,n),t.then(e,e))}function yU(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function vU(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=af(-1,1),t.tag=2,Gp(n,t,1))),n.lanes|=1),e)}var mce=xf.ReactCurrentOwner,Zl=!1;function pl(e,t,n,r){t.child=e===null?i7(t,null,n,r):Bv(t,e.child,n,r)}function xU(e,t,n,r,a){n=n.render;var c=t.ref;return Tv(t,a),r=C3(e,t,n,r,c,a),n=I3(),e!==null&&!Zl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,df(e,t,a)):(ea&&n&&g3(t),t.flags|=1,pl(e,t,r,a),t.child)}function bU(e,t,n,r,a){if(e===null){var c=n.type;return typeof c=="function"&&!B3(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=c,M7(e,t,c,r,a)):(e=P2(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!(e.lanes&a)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:Kb,n(d,r)&&e.ref===t.ref)return df(e,t,a)}return t.flags|=1,e=Zp(c,r),e.ref=t.ref,e.return=t,t.child=e}function M7(e,t,n,r,a){if(e!==null){var c=e.memoizedProps;if(Kb(c,r)&&e.ref===t.ref)if(Zl=!1,t.pendingProps=r=c,(e.lanes&a)!==0)e.flags&131072&&(Zl=!0);else return t.lanes=e.lanes,df(e,t,a)}return iD(e,t,n,r,a)}function O7(e,t,n){var r=t.pendingProps,a=r.children,c=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},zo(pv,Ec),Ec|=n;else{if(!(n&1073741824))return e=c!==null?c.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,zo(pv,Ec),Ec|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=c!==null?c.baseLanes:n,zo(pv,Ec),Ec|=r}else c!==null?(r=c.baseLanes|n,t.memoizedState=null):r=n,zo(pv,Ec),Ec|=r;return pl(e,t,a,n),t.child}function k7(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function iD(e,t,n,r,a){var c=Jl(n)?Jg:tl.current;return c=Nv(t,c),Tv(t,a),n=C3(e,t,n,r,c,a),r=I3(),e!==null&&!Zl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,df(e,t,a)):(ea&&r&&g3(t),t.flags|=1,pl(e,t,n,a),t.child)}function wU(e,t,n,r,a){if(Jl(n)){var c=!0;Z2(t)}else c=!1;if(Tv(t,a),t.stateNode===null)T2(e,t),P7(t,n,r),nD(t,n,r,a),r=!0;else if(e===null){var d=t.stateNode,i=t.memoizedProps;d.props=i;var _=d.context,b=n.contextType;typeof b=="object"&&b!==null?b=su(b):(b=Jl(n)?Jg:tl.current,b=Nv(t,b));var T=n.getDerivedStateFromProps,A=typeof T=="function"||typeof d.getSnapshotBeforeUpdate=="function";A||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(i!==r||_!==b)&&gU(t,d,r,b),Ap=!1;var k=t.memoizedState;d.state=k,Q2(t,r,d,a),_=t.memoizedState,i!==r||k!==_||Yl.current||Ap?(typeof T=="function"&&(tD(t,n,T,r),_=t.memoizedState),(i=Ap||mU(t,n,i,r,k,_,b))?(A||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=_),d.props=r,d.state=_,d.context=b,r=i):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{d=t.stateNode,a7(e,t),i=t.memoizedProps,b=t.type===t.elementType?i:Wu(t.type,i),d.props=b,A=t.pendingProps,k=d.context,_=n.contextType,typeof _=="object"&&_!==null?_=su(_):(_=Jl(n)?Jg:tl.current,_=Nv(t,_));var R=n.getDerivedStateFromProps;(T=typeof R=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(i!==A||k!==_)&&gU(t,d,r,_),Ap=!1,k=t.memoizedState,d.state=k,Q2(t,r,d,a);var B=t.memoizedState;i!==A||k!==B||Yl.current||Ap?(typeof R=="function"&&(tD(t,n,R,r),B=t.memoizedState),(b=Ap||mU(t,n,b,r,k,B,_)||!1)?(T||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,B,_),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,B,_)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=B),d.props=r,d.state=B,d.context=_,r=b):(typeof d.componentDidUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),r=!1)}return oD(e,t,n,r,c,a)}function oD(e,t,n,r,a,c){k7(e,t);var d=(t.flags&128)!==0;if(!r&&!d)return a&&sU(t,n,!1),df(e,t,c);r=t.stateNode,mce.current=t;var i=d&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&d?(t.child=Bv(t,e.child,null,c),t.child=Bv(t,null,i,c)):pl(e,t,i,c),t.memoizedState=r.state,a&&sU(t,n,!0),t.child}function R7(e){var t=e.stateNode;t.pendingContext?aU(e,t.pendingContext,t.pendingContext!==t.context):t.context&&aU(e,t.context,!1),T3(e,t.containerInfo)}function SU(e,t,n,r,a){return Fv(),y3(a),t.flags|=256,pl(e,t,n,r),t.child}var aD={dehydrated:null,treeContext:null,retryLane:0};function sD(e){return{baseLanes:e,cachePool:null,transitions:null}}function D7(e,t,n){var r=t.pendingProps,a=la.current,c=!1,d=(t.flags&128)!==0,i;if((i=d)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),zo(la,a&1),e===null)return QR(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=r.children,e=r.fallback,c?(r=t.mode,c=t.child,d={mode:"hidden",children:d},!(r&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=oC(d,r,0,null),e=Zg(e,r,n,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=sD(n),t.memoizedState=aD,e):k3(t,d));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return gce(e,t,d,r,i,a,n);if(c){c=r.fallback,d=t.mode,a=e.child,i=a.sibling;var _={mode:"hidden",children:r.children};return!(d&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=_,t.deletions=null):(r=Zp(a,_),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?c=Zp(i,c):(c=Zg(c,d,n,null),c.flags|=2),c.return=t,r.return=t,r.sibling=c,t.child=r,r=c,c=t.child,d=e.child.memoizedState,d=d===null?sD(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=e.childLanes&~n,t.memoizedState=aD,r}return c=e.child,e=c.sibling,r=Zp(c,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function k3(e,t){return t=oC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function zE(e,t,n,r){return r!==null&&y3(r),Bv(t,e.child,null,n),e=k3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gce(e,t,n,r,a,c,d){if(n)return t.flags&256?(t.flags&=-257,r=ak(Error(Rn(422))),zE(e,t,d,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=r.fallback,a=t.mode,r=oC({mode:"visible",children:r.children},a,0,null),c=Zg(c,a,d,null),c.flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,t.mode&1&&Bv(t,e.child,null,d),t.child.memoizedState=sD(d),t.memoizedState=aD,c);if(!(t.mode&1))return zE(e,t,d,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,c=Error(Rn(419)),r=ak(c,r,void 0),zE(e,t,d,r)}if(i=(d&e.childLanes)!==0,Zl||i){if(r=Ss,r!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|d)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,hf(e,a),th(r,e,a,-1))}return F3(),r=ak(Error(Rn(421))),zE(e,t,d,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ice.bind(null,e),a._reactRetry=t,null):(e=c.treeContext,Ic=Wp(a.nextSibling),Mc=t,ea=!0,Xu=null,e!==null&&(Qc[eu++]=Qd,Qc[eu++]=ef,Qc[eu++]=Qg,Qd=e.id,ef=e.overflow,Qg=t),t=k3(t,r.children),t.flags|=4096,t)}function TU(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),eD(e.return,t,n)}function sk(e,t,n,r,a){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=r,c.tail=n,c.tailMode=a)}function L7(e,t,n){var r=t.pendingProps,a=r.revealOrder,c=r.tail;if(pl(e,t,r.children,n),r=la.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&TU(e,n,t);else if(e.tag===19)TU(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(zo(la,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&eA(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),sk(t,!1,a,n,c);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&eA(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}sk(t,!0,n,null,c);break;case"together":sk(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function T2(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function df(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),t_|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Rn(153));if(t.child!==null){for(e=t.child,n=Zp(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Zp(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function _ce(e,t,n){switch(t.tag){case 3:R7(t),Fv();break;case 5:s7(t);break;case 1:Jl(t.type)&&Z2(t);break;case 4:T3(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;zo(Y2,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(zo(la,la.current&1),t.flags|=128,null):n&t.child.childLanes?D7(e,t,n):(zo(la,la.current&1),e=df(e,t,n),e!==null?e.sibling:null);zo(la,la.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return L7(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),zo(la,la.current),r)break;return null;case 22:case 23:return t.lanes=0,O7(e,t,n)}return df(e,t,n)}var z7,lD,N7,F7;z7=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lD=function(){};N7=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,jg(Kh.current);var c=null;switch(n){case"input":a=MR(e,a),r=MR(e,r),c=[];break;case"select":a=da({},a,{value:void 0}),r=da({},r,{value:void 0}),c=[];break;case"textarea":a=RR(e,a),r=RR(e,r),c=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=H2)}LR(n,r);var d;n=null;for(b in a)if(!r.hasOwnProperty(b)&&a.hasOwnProperty(b)&&a[b]!=null)if(b==="style"){var i=a[b];for(d in i)i.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Vb.hasOwnProperty(b)?c||(c=[]):(c=c||[]).push(b,null));for(b in r){var _=r[b];if(i=a!=null?a[b]:void 0,r.hasOwnProperty(b)&&_!==i&&(_!=null||i!=null))if(b==="style")if(i){for(d in i)!i.hasOwnProperty(d)||_&&_.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in _)_.hasOwnProperty(d)&&i[d]!==_[d]&&(n||(n={}),n[d]=_[d])}else n||(c||(c=[]),c.push(b,n)),n=_;else b==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,i=i?i.__html:void 0,_!=null&&i!==_&&(c=c||[]).push(b,_)):b==="children"?typeof _!="string"&&typeof _!="number"||(c=c||[]).push(b,""+_):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(Vb.hasOwnProperty(b)?(_!=null&&b==="onScroll"&&Go("scroll",e),c||i===_||(c=[])):(c=c||[]).push(b,_))}n&&(c=c||[]).push("style",n);var b=c;(t.updateQueue=b)&&(t.flags|=4)}};F7=function(e,t,n,r){n!==r&&(t.flags|=4)};function z1(e,t){if(!ea)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function yce(e,t,n){var r=t.pendingProps;switch(_3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:return Jl(t.type)&&q2(),qs(t),null;case 3:return r=t.stateNode,jv(),Xo(Yl),Xo(tl),A3(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(DE(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Xu!==null&&(gD(Xu),Xu=null))),lD(e,t),qs(t),null;case 5:E3(t);var a=jg(tw.current);if(n=t.type,e!==null&&t.stateNode!=null)N7(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Rn(166));return qs(t),null}if(e=jg(Kh.current),DE(t)){r=t.stateNode,n=t.type;var c=t.memoizedProps;switch(r[Wh]=t,r[Qb]=c,e=(t.mode&1)!==0,n){case"dialog":Go("cancel",r),Go("close",r);break;case"iframe":case"object":case"embed":Go("load",r);break;case"video":case"audio":for(a=0;a<ob.length;a++)Go(ob[a],r);break;case"source":Go("error",r);break;case"img":case"image":case"link":Go("error",r),Go("load",r);break;case"details":Go("toggle",r);break;case"input":R$(r,c),Go("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!c.multiple},Go("invalid",r);break;case"textarea":L$(r,c),Go("invalid",r)}LR(n,c),a=null;for(var d in c)if(c.hasOwnProperty(d)){var i=c[d];d==="children"?typeof i=="string"?r.textContent!==i&&(c.suppressHydrationWarning!==!0&&RE(r.textContent,i,e),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(c.suppressHydrationWarning!==!0&&RE(r.textContent,i,e),a=["children",""+i]):Vb.hasOwnProperty(d)&&i!=null&&d==="onScroll"&&Go("scroll",r)}switch(n){case"input":EE(r),D$(r,c,!0);break;case"textarea":EE(r),z$(r);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(r.onclick=H2)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=d9(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=d.createElement(n,{is:r.is}):(e=d.createElement(n),n==="select"&&(d=e,r.multiple?d.multiple=!0:r.size&&(d.size=r.size))):e=d.createElementNS(e,n),e[Wh]=t,e[Qb]=r,z7(e,t,!1,!1),t.stateNode=e;e:{switch(d=zR(n,r),n){case"dialog":Go("cancel",e),Go("close",e),a=r;break;case"iframe":case"object":case"embed":Go("load",e),a=r;break;case"video":case"audio":for(a=0;a<ob.length;a++)Go(ob[a],e);a=r;break;case"source":Go("error",e),a=r;break;case"img":case"image":case"link":Go("error",e),Go("load",e),a=r;break;case"details":Go("toggle",e),a=r;break;case"input":R$(e,r),a=MR(e,r),Go("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=da({},r,{value:void 0}),Go("invalid",e);break;case"textarea":L$(e,r),a=RR(e,r),Go("invalid",e);break;default:a=r}LR(n,a),i=a;for(c in i)if(i.hasOwnProperty(c)){var _=i[c];c==="style"?m9(e,_):c==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&f9(e,_)):c==="children"?typeof _=="string"?(n!=="textarea"||_!=="")&&Wb(e,_):typeof _=="number"&&Wb(e,""+_):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Vb.hasOwnProperty(c)?_!=null&&c==="onScroll"&&Go("scroll",e):_!=null&&n3(e,c,_,d))}switch(n){case"input":EE(e),D$(e,r,!1);break;case"textarea":EE(e),z$(e);break;case"option":r.value!=null&&e.setAttribute("value",""+tm(r.value));break;case"select":e.multiple=!!r.multiple,c=r.value,c!=null?xv(e,!!r.multiple,c,!1):r.defaultValue!=null&&xv(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=H2)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&t.stateNode!=null)F7(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Rn(166));if(n=jg(tw.current),jg(Kh.current),DE(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wh]=t,(c=r.nodeValue!==n)&&(e=Mc,e!==null))switch(e.tag){case 3:RE(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&RE(r.nodeValue,n,(e.mode&1)!==0)}c&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wh]=t,t.stateNode=r}return qs(t),null;case 13:if(Xo(la),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ea&&Ic!==null&&t.mode&1&&!(t.flags&128))n7(),Fv(),t.flags|=98560,c=!1;else if(c=DE(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(Rn(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(Rn(317));c[Wh]=t}else Fv(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qs(t),c=!1}else Xu!==null&&(gD(Xu),Xu=null),c=!0;if(!c)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||la.current&1?cs===0&&(cs=3):F3())),t.updateQueue!==null&&(t.flags|=4),qs(t),null);case 4:return jv(),lD(e,t),e===null&&Yb(t.stateNode.containerInfo),qs(t),null;case 10:return b3(t.type._context),qs(t),null;case 17:return Jl(t.type)&&q2(),qs(t),null;case 19:if(Xo(la),c=t.memoizedState,c===null)return qs(t),null;if(r=(t.flags&128)!==0,d=c.rendering,d===null)if(r)z1(c,!1);else{if(cs!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=eA(e),d!==null){for(t.flags|=128,z1(c,!1),r=d.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)c=n,e=r,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,e=d.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return zo(la,la.current&1|2),t.child}e=e.sibling}c.tail!==null&&Fa()>Uv&&(t.flags|=128,r=!0,z1(c,!1),t.lanes=4194304)}else{if(!r)if(e=eA(d),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),z1(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!ea)return qs(t),null}else 2*Fa()-c.renderingStartTime>Uv&&n!==1073741824&&(t.flags|=128,r=!0,z1(c,!1),t.lanes=4194304);c.isBackwards?(d.sibling=t.child,t.child=d):(n=c.last,n!==null?n.sibling=d:t.child=d,c.last=d)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Fa(),t.sibling=null,n=la.current,zo(la,r?n&1|2:n&1),t):(qs(t),null);case 22:case 23:return N3(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ec&1073741824&&(qs(t),t.subtreeFlags&6&&(t.flags|=8192)):qs(t),null;case 24:return null;case 25:return null}throw Error(Rn(156,t.tag))}function vce(e,t){switch(_3(t),t.tag){case 1:return Jl(t.type)&&q2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jv(),Xo(Yl),Xo(tl),A3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return E3(t),null;case 13:if(Xo(la),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Rn(340));Fv()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xo(la),null;case 4:return jv(),null;case 10:return b3(t.type._context),null;case 22:case 23:return N3(),null;case 24:return null;default:return null}}var NE=!1,Ys=!1,xce=typeof WeakSet=="function"?WeakSet:Set,dr=null;function fv(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){wa(e,t,r)}else n.current=null}function cD(e,t,n){try{n()}catch(r){wa(e,t,r)}}var EU=!1;function bce(e,t){if(HR=V2,e=V9(),m3(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,c=r.focusNode;r=r.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,i=-1,_=-1,b=0,T=0,A=e,k=null;t:for(;;){for(var R;A!==n||a!==0&&A.nodeType!==3||(i=d+a),A!==c||r!==0&&A.nodeType!==3||(_=d+r),A.nodeType===3&&(d+=A.nodeValue.length),(R=A.firstChild)!==null;)k=A,A=R;for(;;){if(A===e)break t;if(k===n&&++b===a&&(i=d),k===c&&++T===r&&(_=d),(R=A.nextSibling)!==null)break;A=k,k=A.parentNode}A=R}n=i===-1||_===-1?null:{start:i,end:_}}else n=null}n=n||{start:0,end:0}}else n=null;for(qR={focusedElem:e,selectionRange:n},V2=!1,dr=t;dr!==null;)if(t=dr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dr=e;else for(;dr!==null;){t=dr;try{var B=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var N=B.memoizedProps,V=B.memoizedState,H=t.stateNode,G=H.getSnapshotBeforeUpdate(t.elementType===t.type?N:Wu(t.type,N),V);H.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var q=t.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rn(163))}}catch(Q){wa(t,t.return,Q)}if(e=t.sibling,e!==null){e.return=t.return,dr=e;break}dr=t.return}return B=EU,EU=!1,B}function Sb(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var c=a.destroy;a.destroy=void 0,c!==void 0&&cD(t,n,c)}a=a.next}while(a!==r)}}function rC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function uD(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function B7(e){var t=e.alternate;t!==null&&(e.alternate=null,B7(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wh],delete t[Qb],delete t[KR],delete t[rce],delete t[ice])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function j7(e){return e.tag===5||e.tag===3||e.tag===4}function AU(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||j7(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hD(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=H2));else if(r!==4&&(e=e.child,e!==null))for(hD(e,t,n),e=e.sibling;e!==null;)hD(e,t,n),e=e.sibling}function dD(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(dD(e,t,n),e=e.sibling;e!==null;)dD(e,t,n),e=e.sibling}var Fs=null,Gu=!1;function gp(e,t,n){for(n=n.child;n!==null;)$7(e,t,n),n=n.sibling}function $7(e,t,n){if(Xh&&typeof Xh.onCommitFiberUnmount=="function")try{Xh.onCommitFiberUnmount(XP,n)}catch{}switch(n.tag){case 5:Ys||fv(n,t);case 6:var r=Fs,a=Gu;Fs=null,gp(e,t,n),Fs=r,Gu=a,Fs!==null&&(Gu?(e=Fs,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Fs.removeChild(n.stateNode));break;case 18:Fs!==null&&(Gu?(e=Fs,n=n.stateNode,e.nodeType===8?ek(e.parentNode,n):e.nodeType===1&&ek(e,n),Zb(e)):ek(Fs,n.stateNode));break;case 4:r=Fs,a=Gu,Fs=n.stateNode.containerInfo,Gu=!0,gp(e,t,n),Fs=r,Gu=a;break;case 0:case 11:case 14:case 15:if(!Ys&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var c=a,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&cD(n,t,d),a=a.next}while(a!==r)}gp(e,t,n);break;case 1:if(!Ys&&(fv(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){wa(n,t,i)}gp(e,t,n);break;case 21:gp(e,t,n);break;case 22:n.mode&1?(Ys=(r=Ys)||n.memoizedState!==null,gp(e,t,n),Ys=r):gp(e,t,n);break;default:gp(e,t,n)}}function PU(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new xce),t.forEach(function(r){var a=Mce.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Bu(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var c=e,d=t,i=d;e:for(;i!==null;){switch(i.tag){case 5:Fs=i.stateNode,Gu=!1;break e;case 3:Fs=i.stateNode.containerInfo,Gu=!0;break e;case 4:Fs=i.stateNode.containerInfo,Gu=!0;break e}i=i.return}if(Fs===null)throw Error(Rn(160));$7(c,d,a),Fs=null,Gu=!1;var _=a.alternate;_!==null&&(_.return=null),a.return=null}catch(b){wa(a,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)U7(t,e),t=t.sibling}function U7(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bu(t,e),Uh(e),r&4){try{Sb(3,e,e.return),rC(3,e)}catch(N){wa(e,e.return,N)}try{Sb(5,e,e.return)}catch(N){wa(e,e.return,N)}}break;case 1:Bu(t,e),Uh(e),r&512&&n!==null&&fv(n,n.return);break;case 5:if(Bu(t,e),Uh(e),r&512&&n!==null&&fv(n,n.return),e.flags&32){var a=e.stateNode;try{Wb(a,"")}catch(N){wa(e,e.return,N)}}if(r&4&&(a=e.stateNode,a!=null)){var c=e.memoizedProps,d=n!==null?n.memoizedProps:c,i=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{i==="input"&&c.type==="radio"&&c.name!=null&&u9(a,c),zR(i,d);var b=zR(i,c);for(d=0;d<_.length;d+=2){var T=_[d],A=_[d+1];T==="style"?m9(a,A):T==="dangerouslySetInnerHTML"?f9(a,A):T==="children"?Wb(a,A):n3(a,T,A,b)}switch(i){case"input":OR(a,c);break;case"textarea":h9(a,c);break;case"select":var k=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var R=c.value;R!=null?xv(a,!!c.multiple,R,!1):k!==!!c.multiple&&(c.defaultValue!=null?xv(a,!!c.multiple,c.defaultValue,!0):xv(a,!!c.multiple,c.multiple?[]:"",!1))}a[Qb]=c}catch(N){wa(e,e.return,N)}}break;case 6:if(Bu(t,e),Uh(e),r&4){if(e.stateNode===null)throw Error(Rn(162));a=e.stateNode,c=e.memoizedProps;try{a.nodeValue=c}catch(N){wa(e,e.return,N)}}break;case 3:if(Bu(t,e),Uh(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zb(t.containerInfo)}catch(N){wa(e,e.return,N)}break;case 4:Bu(t,e),Uh(e);break;case 13:Bu(t,e),Uh(e),a=e.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(L3=Fa())),r&4&&PU(e);break;case 22:if(T=n!==null&&n.memoizedState!==null,e.mode&1?(Ys=(b=Ys)||T,Bu(t,e),Ys=b):Bu(t,e),Uh(e),r&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!T&&e.mode&1)for(dr=e,T=e.child;T!==null;){for(A=dr=T;dr!==null;){switch(k=dr,R=k.child,k.tag){case 0:case 11:case 14:case 15:Sb(4,k,k.return);break;case 1:fv(k,k.return);var B=k.stateNode;if(typeof B.componentWillUnmount=="function"){r=k,n=k.return;try{t=r,B.props=t.memoizedProps,B.state=t.memoizedState,B.componentWillUnmount()}catch(N){wa(r,n,N)}}break;case 5:fv(k,k.return);break;case 22:if(k.memoizedState!==null){IU(A);continue}}R!==null?(R.return=k,dr=R):IU(A)}T=T.sibling}e:for(T=null,A=e;;){if(A.tag===5){if(T===null){T=A;try{a=A.stateNode,b?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(i=A.stateNode,_=A.memoizedProps.style,d=_!=null&&_.hasOwnProperty("display")?_.display:null,i.style.display=p9("display",d))}catch(N){wa(e,e.return,N)}}}else if(A.tag===6){if(T===null)try{A.stateNode.nodeValue=b?"":A.memoizedProps}catch(N){wa(e,e.return,N)}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===e)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===e)break e;for(;A.sibling===null;){if(A.return===null||A.return===e)break e;T===A&&(T=null),A=A.return}T===A&&(T=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:Bu(t,e),Uh(e),r&4&&PU(e);break;case 21:break;default:Bu(t,e),Uh(e)}}function Uh(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(j7(n)){var r=n;break e}n=n.return}throw Error(Rn(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Wb(a,""),r.flags&=-33);var c=AU(e);dD(e,c,a);break;case 3:case 4:var d=r.stateNode.containerInfo,i=AU(e);hD(e,i,d);break;default:throw Error(Rn(161))}}catch(_){wa(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wce(e,t,n){dr=e,V7(e)}function V7(e,t,n){for(var r=(e.mode&1)!==0;dr!==null;){var a=dr,c=a.child;if(a.tag===22&&r){var d=a.memoizedState!==null||NE;if(!d){var i=a.alternate,_=i!==null&&i.memoizedState!==null||Ys;i=NE;var b=Ys;if(NE=d,(Ys=_)&&!b)for(dr=a;dr!==null;)d=dr,_=d.child,d.tag===22&&d.memoizedState!==null?MU(a):_!==null?(_.return=d,dr=_):MU(a);for(;c!==null;)dr=c,V7(c),c=c.sibling;dr=a,NE=i,Ys=b}CU(e)}else a.subtreeFlags&8772&&c!==null?(c.return=a,dr=c):CU(e)}}function CU(e){for(;dr!==null;){var t=dr;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ys||rC(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ys)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Wu(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&dU(t,c,r);break;case 3:var d=t.updateQueue;if(d!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}dU(t,d,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var _=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&n.focus();break;case"img":_.src&&(n.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var T=b.memoizedState;if(T!==null){var A=T.dehydrated;A!==null&&Zb(A)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rn(163))}Ys||t.flags&512&&uD(t)}catch(k){wa(t,t.return,k)}}if(t===e){dr=null;break}if(n=t.sibling,n!==null){n.return=t.return,dr=n;break}dr=t.return}}function IU(e){for(;dr!==null;){var t=dr;if(t===e){dr=null;break}var n=t.sibling;if(n!==null){n.return=t.return,dr=n;break}dr=t.return}}function MU(e){for(;dr!==null;){var t=dr;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rC(4,t)}catch(_){wa(t,n,_)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(_){wa(t,a,_)}}var c=t.return;try{uD(t)}catch(_){wa(t,c,_)}break;case 5:var d=t.return;try{uD(t)}catch(_){wa(t,d,_)}}}catch(_){wa(t,t.return,_)}if(t===e){dr=null;break}var i=t.sibling;if(i!==null){i.return=t.return,dr=i;break}dr=t.return}}var Sce=Math.ceil,rA=xf.ReactCurrentDispatcher,R3=xf.ReactCurrentOwner,iu=xf.ReactCurrentBatchConfig,eo=0,Ss=null,Ka=null,js=0,Ec=0,pv=gm(0),cs=0,ow=null,t_=0,iC=0,D3=0,Tb=null,Hl=null,L3=0,Uv=1/0,qd=null,iA=!1,fD=null,Hp=null,FE=!1,zp=null,oA=0,Eb=0,pD=null,E2=-1,A2=0;function xl(){return eo&6?Fa():E2!==-1?E2:E2=Fa()}function qp(e){return e.mode&1?eo&2&&js!==0?js&-js:ace.transition!==null?(A2===0&&(A2=P9()),A2):(e=_o,e!==0||(e=window.event,e=e===void 0?16:D9(e.type)),e):1}function th(e,t,n,r){if(50<Eb)throw Eb=0,pD=null,Error(Rn(185));dS(e,n,r),(!(eo&2)||e!==Ss)&&(e===Ss&&(!(eo&2)&&(iC|=n),cs===4&&Mp(e,js)),Ql(e,r),n===1&&eo===0&&!(t.mode&1)&&(Uv=Fa()+500,eC&&_m()))}function Ql(e,t){var n=e.callbackNode;ale(e,t);var r=U2(e,e===Ss?js:0);if(r===0)n!==null&&B$(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&B$(n),t===1)e.tag===0?oce(OU.bind(null,e)):Q9(OU.bind(null,e)),tce(function(){!(eo&6)&&_m()}),n=null;else{switch(C9(r)){case 1:n=s3;break;case 4:n=E9;break;case 16:n=$2;break;case 536870912:n=A9;break;default:n=$2}n=Y7(n,W7.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function W7(e,t){if(E2=-1,A2=0,eo&6)throw Error(Rn(327));var n=e.callbackNode;if(Ev()&&e.callbackNode!==n)return null;var r=U2(e,e===Ss?js:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=aA(e,r);else{t=r;var a=eo;eo|=2;var c=H7();(Ss!==e||js!==t)&&(qd=null,Uv=Fa()+500,qg(e,t));do try{Ace();break}catch(i){G7(e,i)}while(!0);x3(),rA.current=c,eo=a,Ka!==null?t=0:(Ss=null,js=0,t=cs)}if(t!==0){if(t===2&&(a=$R(e),a!==0&&(r=a,t=mD(e,a))),t===1)throw n=ow,qg(e,0),Mp(e,r),Ql(e,Fa()),n;if(t===6)Mp(e,r);else{if(a=e.current.alternate,!(r&30)&&!Tce(a)&&(t=aA(e,r),t===2&&(c=$R(e),c!==0&&(r=c,t=mD(e,c))),t===1))throw n=ow,qg(e,0),Mp(e,r),Ql(e,Fa()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(Rn(345));case 2:Mg(e,Hl,qd);break;case 3:if(Mp(e,r),(r&130023424)===r&&(t=L3+500-Fa(),10<t)){if(U2(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){xl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=XR(Mg.bind(null,e,Hl,qd),t);break}Mg(e,Hl,qd);break;case 4:if(Mp(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var d=31-eh(r);c=1<<d,d=t[d],d>a&&(a=d),r&=~c}if(r=a,r=Fa()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sce(r/1960))-r,10<r){e.timeoutHandle=XR(Mg.bind(null,e,Hl,qd),r);break}Mg(e,Hl,qd);break;case 5:Mg(e,Hl,qd);break;default:throw Error(Rn(329))}}}return Ql(e,Fa()),e.callbackNode===n?W7.bind(null,e):null}function mD(e,t){var n=Tb;return e.current.memoizedState.isDehydrated&&(qg(e,t).flags|=256),e=aA(e,t),e!==2&&(t=Hl,Hl=n,t!==null&&gD(t)),e}function gD(e){Hl===null?Hl=e:Hl.push.apply(Hl,e)}function Tce(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],c=a.getSnapshot;a=a.value;try{if(!ah(c(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mp(e,t){for(t&=~D3,t&=~iC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-eh(t),r=1<<n;e[n]=-1,t&=~r}}function OU(e){if(eo&6)throw Error(Rn(327));Ev();var t=U2(e,0);if(!(t&1))return Ql(e,Fa()),null;var n=aA(e,t);if(e.tag!==0&&n===2){var r=$R(e);r!==0&&(t=r,n=mD(e,r))}if(n===1)throw n=ow,qg(e,0),Mp(e,t),Ql(e,Fa()),n;if(n===6)throw Error(Rn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Mg(e,Hl,qd),Ql(e,Fa()),null}function z3(e,t){var n=eo;eo|=1;try{return e(t)}finally{eo=n,eo===0&&(Uv=Fa()+500,eC&&_m())}}function n_(e){zp!==null&&zp.tag===0&&!(eo&6)&&Ev();var t=eo;eo|=1;var n=iu.transition,r=_o;try{if(iu.transition=null,_o=1,e)return e()}finally{_o=r,iu.transition=n,eo=t,!(eo&6)&&_m()}}function N3(){Ec=pv.current,Xo(pv)}function qg(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ece(n)),Ka!==null)for(n=Ka.return;n!==null;){var r=n;switch(_3(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&q2();break;case 3:jv(),Xo(Yl),Xo(tl),A3();break;case 5:E3(r);break;case 4:jv();break;case 13:Xo(la);break;case 19:Xo(la);break;case 10:b3(r.type._context);break;case 22:case 23:N3()}n=n.return}if(Ss=e,Ka=e=Zp(e.current,null),js=Ec=t,cs=0,ow=null,D3=iC=t_=0,Hl=Tb=null,Bg!==null){for(t=0;t<Bg.length;t++)if(n=Bg[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,c=n.pending;if(c!==null){var d=c.next;c.next=a,r.next=d}n.pending=r}Bg=null}return e}function G7(e,t){do{var n=Ka;try{if(x3(),w2.current=nA,tA){for(var r=ha.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}tA=!1}if(e_=0,xs=ls=ha=null,wb=!1,nw=0,R3.current=null,n===null||n.return===null){cs=1,ow=t,Ka=null;break}e:{var c=e,d=n.return,i=n,_=t;if(t=js,i.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var b=_,T=i,A=T.tag;if(!(T.mode&1)&&(A===0||A===11||A===15)){var k=T.alternate;k?(T.updateQueue=k.updateQueue,T.memoizedState=k.memoizedState,T.lanes=k.lanes):(T.updateQueue=null,T.memoizedState=null)}var R=yU(d);if(R!==null){R.flags&=-257,vU(R,d,i,c,t),R.mode&1&&_U(c,b,t),t=R,_=b;var B=t.updateQueue;if(B===null){var N=new Set;N.add(_),t.updateQueue=N}else B.add(_);break e}else{if(!(t&1)){_U(c,b,t),F3();break e}_=Error(Rn(426))}}else if(ea&&i.mode&1){var V=yU(d);if(V!==null){!(V.flags&65536)&&(V.flags|=256),vU(V,d,i,c,t),y3($v(_,i));break e}}c=_=$v(_,i),cs!==4&&(cs=2),Tb===null?Tb=[c]:Tb.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var H=C7(c,_,t);hU(c,H);break e;case 1:i=_;var G=c.type,q=c.stateNode;if(!(c.flags&128)&&(typeof G.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Hp===null||!Hp.has(q)))){c.flags|=65536,t&=-t,c.lanes|=t;var Q=I7(c,i,t);hU(c,Q);break e}}c=c.return}while(c!==null)}Z7(n)}catch(te){t=te,Ka===n&&n!==null&&(Ka=n=n.return);continue}break}while(!0)}function H7(){var e=rA.current;return rA.current=nA,e===null?nA:e}function F3(){(cs===0||cs===3||cs===2)&&(cs=4),Ss===null||!(t_&268435455)&&!(iC&268435455)||Mp(Ss,js)}function aA(e,t){var n=eo;eo|=2;var r=H7();(Ss!==e||js!==t)&&(qd=null,qg(e,t));do try{Ece();break}catch(a){G7(e,a)}while(!0);if(x3(),eo=n,rA.current=r,Ka!==null)throw Error(Rn(261));return Ss=null,js=0,cs}function Ece(){for(;Ka!==null;)q7(Ka)}function Ace(){for(;Ka!==null&&!Yse();)q7(Ka)}function q7(e){var t=K7(e.alternate,e,Ec);e.memoizedProps=e.pendingProps,t===null?Z7(e):Ka=t,R3.current=null}function Z7(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=vce(n,t),n!==null){n.flags&=32767,Ka=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cs=6,Ka=null;return}}else if(n=yce(n,t,Ec),n!==null){Ka=n;return}if(t=t.sibling,t!==null){Ka=t;return}Ka=t=e}while(t!==null);cs===0&&(cs=5)}function Mg(e,t,n){var r=_o,a=iu.transition;try{iu.transition=null,_o=1,Pce(e,t,n,r)}finally{iu.transition=a,_o=r}return null}function Pce(e,t,n,r){do Ev();while(zp!==null);if(eo&6)throw Error(Rn(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Rn(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(sle(e,c),e===Ss&&(Ka=Ss=null,js=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||FE||(FE=!0,Y7($2,function(){return Ev(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=iu.transition,iu.transition=null;var d=_o;_o=1;var i=eo;eo|=4,R3.current=null,bce(e,n),U7(n,e),qle(qR),V2=!!HR,qR=HR=null,e.current=n,wce(n),Jse(),eo=i,_o=d,iu.transition=c}else e.current=n;if(FE&&(FE=!1,zp=e,oA=a),c=e.pendingLanes,c===0&&(Hp=null),tle(n.stateNode),Ql(e,Fa()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(iA)throw iA=!1,e=fD,fD=null,e;return oA&1&&e.tag!==0&&Ev(),c=e.pendingLanes,c&1?e===pD?Eb++:(Eb=0,pD=e):Eb=0,_m(),null}function Ev(){if(zp!==null){var e=C9(oA),t=iu.transition,n=_o;try{if(iu.transition=null,_o=16>e?16:e,zp===null)var r=!1;else{if(e=zp,zp=null,oA=0,eo&6)throw Error(Rn(331));var a=eo;for(eo|=4,dr=e.current;dr!==null;){var c=dr,d=c.child;if(dr.flags&16){var i=c.deletions;if(i!==null){for(var _=0;_<i.length;_++){var b=i[_];for(dr=b;dr!==null;){var T=dr;switch(T.tag){case 0:case 11:case 15:Sb(8,T,c)}var A=T.child;if(A!==null)A.return=T,dr=A;else for(;dr!==null;){T=dr;var k=T.sibling,R=T.return;if(B7(T),T===b){dr=null;break}if(k!==null){k.return=R,dr=k;break}dr=R}}}var B=c.alternate;if(B!==null){var N=B.child;if(N!==null){B.child=null;do{var V=N.sibling;N.sibling=null,N=V}while(N!==null)}}dr=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,dr=d;else e:for(;dr!==null;){if(c=dr,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Sb(9,c,c.return)}var H=c.sibling;if(H!==null){H.return=c.return,dr=H;break e}dr=c.return}}var G=e.current;for(dr=G;dr!==null;){d=dr;var q=d.child;if(d.subtreeFlags&2064&&q!==null)q.return=d,dr=q;else e:for(d=G;dr!==null;){if(i=dr,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:rC(9,i)}}catch(te){wa(i,i.return,te)}if(i===d){dr=null;break e}var Q=i.sibling;if(Q!==null){Q.return=i.return,dr=Q;break e}dr=i.return}}if(eo=a,_m(),Xh&&typeof Xh.onPostCommitFiberRoot=="function")try{Xh.onPostCommitFiberRoot(XP,e)}catch{}r=!0}return r}finally{_o=n,iu.transition=t}}return!1}function kU(e,t,n){t=$v(n,t),t=C7(e,t,1),e=Gp(e,t,1),t=xl(),e!==null&&(dS(e,1,t),Ql(e,t))}function wa(e,t,n){if(e.tag===3)kU(e,e,n);else for(;t!==null;){if(t.tag===3){kU(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hp===null||!Hp.has(r))){e=$v(n,e),e=I7(t,e,1),t=Gp(t,e,1),e=xl(),t!==null&&(dS(t,1,e),Ql(t,e));break}}t=t.return}}function Cce(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=xl(),e.pingedLanes|=e.suspendedLanes&n,Ss===e&&(js&n)===n&&(cs===4||cs===3&&(js&130023424)===js&&500>Fa()-L3?qg(e,0):D3|=n),Ql(e,t)}function X7(e,t){t===0&&(e.mode&1?(t=CE,CE<<=1,!(CE&130023424)&&(CE=4194304)):t=1);var n=xl();e=hf(e,t),e!==null&&(dS(e,t,n),Ql(e,n))}function Ice(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),X7(e,n)}function Mce(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Rn(314))}r!==null&&r.delete(t),X7(e,n)}var K7;K7=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yl.current)Zl=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Zl=!1,_ce(e,t,n);Zl=!!(e.flags&131072)}else Zl=!1,ea&&t.flags&1048576&&e7(t,K2,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;T2(e,t),e=t.pendingProps;var a=Nv(t,tl.current);Tv(t,n),a=C3(null,t,r,e,a,n);var c=I3();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Jl(r)?(c=!0,Z2(t)):c=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,S3(t),a.updater=nC,t.stateNode=a,a._reactInternals=t,nD(t,r,e,n),t=oD(null,t,r,!0,c,n)):(t.tag=0,ea&&c&&g3(t),pl(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(T2(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=kce(r),e=Wu(r,e),a){case 0:t=iD(null,t,r,e,n);break e;case 1:t=wU(null,t,r,e,n);break e;case 11:t=xU(null,t,r,e,n);break e;case 14:t=bU(null,t,r,Wu(r.type,e),n);break e}throw Error(Rn(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Wu(r,a),iD(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Wu(r,a),wU(e,t,r,a,n);case 3:e:{if(R7(t),e===null)throw Error(Rn(387));r=t.pendingProps,c=t.memoizedState,a=c.element,a7(e,t),Q2(t,r,null,n);var d=t.memoizedState;if(r=d.element,c.isDehydrated)if(c={element:r,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){a=$v(Error(Rn(423)),t),t=SU(e,t,r,n,a);break e}else if(r!==a){a=$v(Error(Rn(424)),t),t=SU(e,t,r,n,a);break e}else for(Ic=Wp(t.stateNode.containerInfo.firstChild),Mc=t,ea=!0,Xu=null,n=i7(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fv(),r===a){t=df(e,t,n);break e}pl(e,t,r,n)}t=t.child}return t;case 5:return s7(t),e===null&&QR(t),r=t.type,a=t.pendingProps,c=e!==null?e.memoizedProps:null,d=a.children,ZR(r,a)?d=null:c!==null&&ZR(r,c)&&(t.flags|=32),k7(e,t),pl(e,t,d,n),t.child;case 6:return e===null&&QR(t),null;case 13:return D7(e,t,n);case 4:return T3(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Bv(t,null,r,n):pl(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Wu(r,a),xU(e,t,r,a,n);case 7:return pl(e,t,t.pendingProps,n),t.child;case 8:return pl(e,t,t.pendingProps.children,n),t.child;case 12:return pl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,c=t.memoizedProps,d=a.value,zo(Y2,r._currentValue),r._currentValue=d,c!==null)if(ah(c.value,d)){if(c.children===a.children&&!Yl.current){t=df(e,t,n);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var i=c.dependencies;if(i!==null){d=c.child;for(var _=i.firstContext;_!==null;){if(_.context===r){if(c.tag===1){_=af(-1,n&-n),_.tag=2;var b=c.updateQueue;if(b!==null){b=b.shared;var T=b.pending;T===null?_.next=_:(_.next=T.next,T.next=_),b.pending=_}}c.lanes|=n,_=c.alternate,_!==null&&(_.lanes|=n),eD(c.return,n,t),i.lanes|=n;break}_=_.next}}else if(c.tag===10)d=c.type===t.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(Rn(341));d.lanes|=n,i=d.alternate,i!==null&&(i.lanes|=n),eD(d,n,t),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===t){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}pl(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Tv(t,n),a=su(a),r=r(a),t.flags|=1,pl(e,t,r,n),t.child;case 14:return r=t.type,a=Wu(r,t.pendingProps),a=Wu(r.type,a),bU(e,t,r,a,n);case 15:return M7(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Wu(r,a),T2(e,t),t.tag=1,Jl(r)?(e=!0,Z2(t)):e=!1,Tv(t,n),P7(t,r,a),nD(t,r,a,n),oD(null,t,r,!0,e,n);case 19:return L7(e,t,n);case 22:return O7(e,t,n)}throw Error(Rn(156,t.tag))};function Y7(e,t){return T9(e,t)}function Oce(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nu(e,t,n,r){return new Oce(e,t,n,r)}function B3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kce(e){if(typeof e=="function")return B3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===i3)return 11;if(e===o3)return 14}return 2}function Zp(e,t){var n=e.alternate;return n===null?(n=nu(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function P2(e,t,n,r,a,c){var d=2;if(r=e,typeof e=="function")B3(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case iv:return Zg(n.children,a,c,t);case r3:d=8,a|=8;break;case AR:return e=nu(12,n,t,a|2),e.elementType=AR,e.lanes=c,e;case PR:return e=nu(13,n,t,a),e.elementType=PR,e.lanes=c,e;case CR:return e=nu(19,n,t,a),e.elementType=CR,e.lanes=c,e;case s9:return oC(n,a,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case o9:d=10;break e;case a9:d=9;break e;case i3:d=11;break e;case o3:d=14;break e;case Ep:d=16,r=null;break e}throw Error(Rn(130,e==null?e:typeof e,""))}return t=nu(d,n,t,a),t.elementType=e,t.type=r,t.lanes=c,t}function Zg(e,t,n,r){return e=nu(7,e,r,t),e.lanes=n,e}function oC(e,t,n,r){return e=nu(22,e,r,t),e.elementType=s9,e.lanes=n,e.stateNode={isHidden:!1},e}function lk(e,t,n){return e=nu(6,e,null,t),e.lanes=n,e}function ck(e,t,n){return t=nu(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Rce(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=VO(0),this.expirationTimes=VO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=VO(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function j3(e,t,n,r,a,c,d,i,_){return e=new Rce(e,t,n,i,_),t===1?(t=1,c===!0&&(t|=8)):t=0,c=nu(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},S3(c),e}function Dce(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rv,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function J7(e){if(!e)return nm;e=e._reactInternals;e:{if(v_(e)!==e||e.tag!==1)throw Error(Rn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Jl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Rn(171))}if(e.tag===1){var n=e.type;if(Jl(n))return J9(e,n,t)}return t}function Q7(e,t,n,r,a,c,d,i,_){return e=j3(n,r,!0,e,a,c,d,i,_),e.context=J7(null),n=e.current,r=xl(),a=qp(n),c=af(r,a),c.callback=t??null,Gp(n,c,a),e.current.lanes=a,dS(e,a,r),Ql(e,r),e}function aC(e,t,n,r){var a=t.current,c=xl(),d=qp(a);return n=J7(n),t.context===null?t.context=n:t.pendingContext=n,t=af(c,d),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Gp(a,t,d),e!==null&&(th(e,a,d,c),b2(e,a,d)),d}function sA(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function RU(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function $3(e,t){RU(e,t),(e=e.alternate)&&RU(e,t)}function Lce(){return null}var eq=typeof reportError=="function"?reportError:function(e){console.error(e)};function U3(e){this._internalRoot=e}sC.prototype.render=U3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Rn(409));aC(e,t,null,null)};sC.prototype.unmount=U3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;n_(function(){aC(null,e,null,null)}),t[uf]=null}};function sC(e){this._internalRoot=e}sC.prototype.unstable_scheduleHydration=function(e){if(e){var t=O9();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ip.length&&t!==0&&t<Ip[n].priority;n++);Ip.splice(n,0,e),n===0&&R9(e)}};function V3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function lC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function DU(){}function zce(e,t,n,r,a){if(a){if(typeof r=="function"){var c=r;r=function(){var b=sA(d);c.call(b)}}var d=Q7(t,r,e,0,null,!1,!1,"",DU);return e._reactRootContainer=d,e[uf]=d.current,Yb(e.nodeType===8?e.parentNode:e),n_(),d}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var b=sA(_);i.call(b)}}var _=j3(e,0,!1,null,null,!1,!1,"",DU);return e._reactRootContainer=_,e[uf]=_.current,Yb(e.nodeType===8?e.parentNode:e),n_(function(){aC(t,_,n,r)}),_}function cC(e,t,n,r,a){var c=n._reactRootContainer;if(c){var d=c;if(typeof a=="function"){var i=a;a=function(){var _=sA(d);i.call(_)}}aC(t,d,e,a)}else d=zce(n,t,e,a,r);return sA(d)}I9=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ib(t.pendingLanes);n!==0&&(l3(t,n|1),Ql(t,Fa()),!(eo&6)&&(Uv=Fa()+500,_m()))}break;case 13:n_(function(){var r=hf(e,1);if(r!==null){var a=xl();th(r,e,1,a)}}),$3(e,1)}};c3=function(e){if(e.tag===13){var t=hf(e,134217728);if(t!==null){var n=xl();th(t,e,134217728,n)}$3(e,134217728)}};M9=function(e){if(e.tag===13){var t=qp(e),n=hf(e,t);if(n!==null){var r=xl();th(n,e,t,r)}$3(e,t)}};O9=function(){return _o};k9=function(e,t){var n=_o;try{return _o=e,t()}finally{_o=n}};FR=function(e,t,n){switch(t){case"input":if(OR(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=QP(r);if(!a)throw Error(Rn(90));c9(r),OR(r,a)}}}break;case"textarea":h9(e,n);break;case"select":t=n.value,t!=null&&xv(e,!!n.multiple,t,!1)}};y9=z3;v9=n_;var Nce={usingClientEntryPoint:!1,Events:[pS,lv,QP,g9,_9,z3]},N1={findFiberByHostInstance:Fg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fce={bundleType:N1.bundleType,version:N1.version,rendererPackageName:N1.rendererPackageName,rendererConfig:N1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=w9(e),e===null?null:e.stateNode},findFiberByHostInstance:N1.findFiberByHostInstance||Lce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var BE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!BE.isDisabled&&BE.supportsFiber)try{XP=BE.inject(Fce),Xh=BE}catch{}}zc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nce;zc.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V3(t))throw Error(Rn(200));return Dce(e,t,null,n)};zc.createRoot=function(e,t){if(!V3(e))throw Error(Rn(299));var n=!1,r="",a=eq;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=j3(e,1,!1,null,null,n,!1,r,a),e[uf]=t.current,Yb(e.nodeType===8?e.parentNode:e),new U3(t)};zc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Rn(188)):(e=Object.keys(e).join(","),Error(Rn(268,e)));return e=w9(t),e=e===null?null:e.stateNode,e};zc.flushSync=function(e){return n_(e)};zc.hydrate=function(e,t,n){if(!lC(t))throw Error(Rn(200));return cC(null,e,t,!0,n)};zc.hydrateRoot=function(e,t,n){if(!V3(e))throw Error(Rn(405));var r=n!=null&&n.hydratedSources||null,a=!1,c="",d=eq;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),t=Q7(t,null,e,1,n??null,a,!1,c,d),e[uf]=t.current,Yb(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new sC(t)};zc.render=function(e,t,n){if(!lC(t))throw Error(Rn(200));return cC(null,e,t,!1,n)};zc.unmountComponentAtNode=function(e){if(!lC(e))throw Error(Rn(40));return e._reactRootContainer?(n_(function(){cC(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};zc.unstable_batchedUpdates=z3;zc.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!lC(n))throw Error(Rn(200));if(e==null||e._reactInternals===void 0)throw Error(Rn(38));return cC(e,t,n,!1,r)};zc.version="18.3.1-next-f1338f8080-20240426";function tq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tq)}catch(e){console.error(e)}}tq(),t9.exports=zc;var ym=t9.exports;const uC=lo(ym);var Bce,LU=ym;Bce=LU.createRoot,LU.hydrateRoot;const jce="modulepreload",$ce=function(e){return"/"+e},zU={},z0=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),i=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=Promise.allSettled(n.map(_=>{if(_=$ce(_),_ in zU)return;zU[_]=!0;const b=_.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${T}`))return;const A=document.createElement("link");if(A.rel=b?"stylesheet":jce,b||(A.as="script"),A.crossOrigin="",A.href=_,i&&A.setAttribute("nonce",i),document.head.appendChild(A),b)return new Promise((k,R)=>{A.addEventListener("load",k),A.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(d){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=d,window.dispatchEvent(i),!i.defaultPrevented)throw d}return a.then(d=>{for(const i of d||[])i.status==="rejected"&&c(i.reason);return t().catch(c)})};/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aw.apply(this,arguments)}var Np;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Np||(Np={}));const NU="popstate";function Uce(e){e===void 0&&(e={});function t(r,a){let{pathname:c,search:d,hash:i}=r.location;return _D("",{pathname:c,search:d,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:lA(a)}return Wce(t,n,null,e)}function Ya(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nq(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Vce(){return Math.random().toString(36).substr(2,8)}function FU(e,t){return{usr:e.state,key:e.key,idx:t}}function _D(e,t,n,r){return n===void 0&&(n=null),aw({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?N0(t):t,{state:n,key:t&&t.key||r||Vce()})}function lA(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function N0(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Wce(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:c=!1}=r,d=a.history,i=Np.Pop,_=null,b=T();b==null&&(b=0,d.replaceState(aw({},d.state,{idx:b}),""));function T(){return(d.state||{idx:null}).idx}function A(){i=Np.Pop;let V=T(),H=V==null?null:V-b;b=V,_&&_({action:i,location:N.location,delta:H})}function k(V,H){i=Np.Push;let G=_D(N.location,V,H);b=T()+1;let q=FU(G,b),Q=N.createHref(G);try{d.pushState(q,"",Q)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;a.location.assign(Q)}c&&_&&_({action:i,location:N.location,delta:1})}function R(V,H){i=Np.Replace;let G=_D(N.location,V,H);b=T();let q=FU(G,b),Q=N.createHref(G);d.replaceState(q,"",Q),c&&_&&_({action:i,location:N.location,delta:0})}function B(V){let H=a.location.origin!=="null"?a.location.origin:a.location.href,G=typeof V=="string"?V:lA(V);return G=G.replace(/ $/,"%20"),Ya(H,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,H)}let N={get action(){return i},get location(){return e(a,d)},listen(V){if(_)throw new Error("A history only accepts one active listener");return a.addEventListener(NU,A),_=V,()=>{a.removeEventListener(NU,A),_=null}},createHref(V){return t(a,V)},createURL:B,encodeLocation(V){let H=B(V);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:k,replace:R,go(V){return d.go(V)}};return N}var BU;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(BU||(BU={}));function Gce(e,t,n){return n===void 0&&(n="/"),Hce(e,t,n,!1)}function Hce(e,t,n,r){let a=typeof t=="string"?N0(t):t,c=W3(a.pathname||"/",n);if(c==null)return null;let d=rq(e);qce(d);let i=null;for(let _=0;i==null&&_<d.length;++_){let b=iue(c);i=nue(d[_],b,r)}return i}function rq(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(c,d,i)=>{let _={relativePath:i===void 0?c.path||"":i,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};_.relativePath.startsWith("/")&&(Ya(_.relativePath.startsWith(r),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(r.length));let b=Xp([r,_.relativePath]),T=n.concat(_);c.children&&c.children.length>0&&(Ya(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),rq(c.children,t,T,b)),!(c.path==null&&!c.index)&&t.push({path:b,score:eue(b,c.index),routesMeta:T})};return e.forEach((c,d)=>{var i;if(c.path===""||!((i=c.path)!=null&&i.includes("?")))a(c,d);else for(let _ of iq(c.path))a(c,d,_)}),t}function iq(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),c=n.replace(/\?$/,"");if(r.length===0)return a?[c,""]:[c];let d=iq(r.join("/")),i=[];return i.push(...d.map(_=>_===""?c:[c,_].join("/"))),a&&i.push(...d),i.map(_=>e.startsWith("/")&&_===""?"/":_)}function qce(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:tue(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Zce=/^:[\w-]+$/,Xce=3,Kce=2,Yce=1,Jce=10,Qce=-2,jU=e=>e==="*";function eue(e,t){let n=e.split("/"),r=n.length;return n.some(jU)&&(r+=Qce),t&&(r+=Kce),n.filter(a=>!jU(a)).reduce((a,c)=>a+(Zce.test(c)?Xce:c===""?Yce:Jce),r)}function tue(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function nue(e,t,n){let{routesMeta:r}=e,a={},c="/",d=[];for(let i=0;i<r.length;++i){let _=r[i],b=i===r.length-1,T=c==="/"?t:t.slice(c.length)||"/",A=$U({path:_.relativePath,caseSensitive:_.caseSensitive,end:b},T),k=_.route;if(!A&&b&&n&&!r[r.length-1].route.index&&(A=$U({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},T)),!A)return null;Object.assign(a,A.params),d.push({params:a,pathname:Xp([c,A.pathname]),pathnameBase:lue(Xp([c,A.pathnameBase])),route:k}),A.pathnameBase!=="/"&&(c=Xp([c,A.pathnameBase]))}return d}function $U(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=rue(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((b,T,A)=>{let{paramName:k,isOptional:R}=T;if(k==="*"){let N=i[A]||"";d=c.slice(0,c.length-N.length).replace(/(.)\/+$/,"$1")}const B=i[A];return R&&!B?b[k]=void 0:b[k]=(B||"").replace(/%2F/g,"/"),b},{}),pathname:c,pathnameBase:d,pattern:e}}function rue(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),nq(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,i,_)=>(r.push({paramName:i,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function iue(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nq(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function W3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function oue(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?N0(e):e;return{pathname:n?n.startsWith("/")?n:aue(n,t):t,search:cue(r),hash:uue(a)}}function aue(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function uk(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sue(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function oq(e,t){let n=sue(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function aq(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=N0(e):(a=aw({},e),Ya(!a.pathname||!a.pathname.includes("?"),uk("?","pathname","search",a)),Ya(!a.pathname||!a.pathname.includes("#"),uk("#","pathname","hash",a)),Ya(!a.search||!a.search.includes("#"),uk("#","search","hash",a)));let c=e===""||a.pathname==="",d=c?"/":a.pathname,i;if(d==null)i=n;else{let A=t.length-1;if(!r&&d.startsWith("..")){let k=d.split("/");for(;k[0]==="..";)k.shift(),A-=1;a.pathname=k.join("/")}i=A>=0?t[A]:"/"}let _=oue(a,i),b=d&&d!=="/"&&d.endsWith("/"),T=(c||d===".")&&n.endsWith("/");return!_.pathname.endsWith("/")&&(b||T)&&(_.pathname+="/"),_}const Xp=e=>e.join("/").replace(/\/\/+/g,"/"),lue=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),cue=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,uue=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function hue(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sq=["post","put","patch","delete"];new Set(sq);const due=["get",...sq];new Set(due);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sw(){return sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sw.apply(this,arguments)}const G3=X.createContext(null),fue=X.createContext(null),x_=X.createContext(null),hC=X.createContext(null),b_=X.createContext({outlet:null,matches:[],isDataRoute:!1}),lq=X.createContext(null);function pue(e,t){let{relative:n}=t===void 0?{}:t;gS()||Ya(!1);let{basename:r,navigator:a}=X.useContext(x_),{hash:c,pathname:d,search:i}=hq(e,{relative:n}),_=d;return r!=="/"&&(_=d==="/"?r:Xp([r,d])),a.createHref({pathname:_,search:i,hash:c})}function gS(){return X.useContext(hC)!=null}function _S(){return gS()||Ya(!1),X.useContext(hC).location}function cq(e){X.useContext(x_).static||X.useLayoutEffect(e)}function uq(){let{isDataRoute:e}=X.useContext(b_);return e?Pue():mue()}function mue(){gS()||Ya(!1);let e=X.useContext(G3),{basename:t,future:n,navigator:r}=X.useContext(x_),{matches:a}=X.useContext(b_),{pathname:c}=_S(),d=JSON.stringify(oq(a,n.v7_relativeSplatPath)),i=X.useRef(!1);return cq(()=>{i.current=!0}),X.useCallback(function(b,T){if(T===void 0&&(T={}),!i.current)return;if(typeof b=="number"){r.go(b);return}let A=aq(b,JSON.parse(d),c,T.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:Xp([t,A.pathname])),(T.replace?r.replace:r.push)(A,T.state,T)},[t,r,d,c,e])}function hq(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=X.useContext(x_),{matches:a}=X.useContext(b_),{pathname:c}=_S(),d=JSON.stringify(oq(a,r.v7_relativeSplatPath));return X.useMemo(()=>aq(e,JSON.parse(d),c,n==="path"),[e,d,c,n])}function gue(e,t){return _ue(e,t)}function _ue(e,t,n,r){gS()||Ya(!1);let{navigator:a}=X.useContext(x_),{matches:c}=X.useContext(b_),d=c[c.length-1],i=d?d.params:{};d&&d.pathname;let _=d?d.pathnameBase:"/";d&&d.route;let b=_S(),T;if(t){var A;let V=typeof t=="string"?N0(t):t;_==="/"||(A=V.pathname)!=null&&A.startsWith(_)||Ya(!1),T=V}else T=b;let k=T.pathname||"/",R=k;if(_!=="/"){let V=_.replace(/^\//,"").split("/");R="/"+k.replace(/^\//,"").split("/").slice(V.length).join("/")}let B=Gce(e,{pathname:R}),N=wue(B&&B.map(V=>Object.assign({},V,{params:Object.assign({},i,V.params),pathname:Xp([_,a.encodeLocation?a.encodeLocation(V.pathname).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?_:Xp([_,a.encodeLocation?a.encodeLocation(V.pathnameBase).pathname:V.pathnameBase])})),c,n,r);return t&&N?X.createElement(hC.Provider,{value:{location:sw({pathname:"/",search:"",hash:"",state:null,key:"default"},T),navigationType:Np.Pop}},N):N}function yue(){let e=Aue(),t=hue(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),n?X.createElement("pre",{style:a},n):null,null)}const vue=X.createElement(yue,null);class xue extends X.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?X.createElement(b_.Provider,{value:this.props.routeContext},X.createElement(lq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bue(e){let{routeContext:t,match:n,children:r}=e,a=X.useContext(G3);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),X.createElement(b_.Provider,{value:t},r)}function wue(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var c;if(!n)return null;if(n.errors)e=n.matches;else if((c=r)!=null&&c.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let d=e,i=(a=n)==null?void 0:a.errors;if(i!=null){let T=d.findIndex(A=>A.route.id&&(i==null?void 0:i[A.route.id])!==void 0);T>=0||Ya(!1),d=d.slice(0,Math.min(d.length,T+1))}let _=!1,b=-1;if(n&&r&&r.v7_partialHydration)for(let T=0;T<d.length;T++){let A=d[T];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(b=T),A.route.id){let{loaderData:k,errors:R}=n,B=A.route.loader&&k[A.route.id]===void 0&&(!R||R[A.route.id]===void 0);if(A.route.lazy||B){_=!0,b>=0?d=d.slice(0,b+1):d=[d[0]];break}}}return d.reduceRight((T,A,k)=>{let R,B=!1,N=null,V=null;n&&(R=i&&A.route.id?i[A.route.id]:void 0,N=A.route.errorElement||vue,_&&(b<0&&k===0?(B=!0,V=null):b===k&&(B=!0,V=A.route.hydrateFallbackElement||null)));let H=t.concat(d.slice(0,k+1)),G=()=>{let q;return R?q=N:B?q=V:A.route.Component?q=X.createElement(A.route.Component,null):A.route.element?q=A.route.element:q=T,X.createElement(bue,{match:A,routeContext:{outlet:T,matches:H,isDataRoute:n!=null},children:q})};return n&&(A.route.ErrorBoundary||A.route.errorElement||k===0)?X.createElement(xue,{location:n.location,revalidation:n.revalidation,component:N,error:R,children:G(),routeContext:{outlet:null,matches:H,isDataRoute:!0}}):G()},null)}var dq=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(dq||{}),cA=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(cA||{});function Sue(e){let t=X.useContext(G3);return t||Ya(!1),t}function Tue(e){let t=X.useContext(fue);return t||Ya(!1),t}function Eue(e){let t=X.useContext(b_);return t||Ya(!1),t}function fq(e){let t=Eue(),n=t.matches[t.matches.length-1];return n.route.id||Ya(!1),n.route.id}function Aue(){var e;let t=X.useContext(lq),n=Tue(cA.UseRouteError),r=fq(cA.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Pue(){let{router:e}=Sue(dq.UseNavigateStable),t=fq(cA.UseNavigateStable),n=X.useRef(!1);return cq(()=>{n.current=!0}),X.useCallback(function(a,c){c===void 0&&(c={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,sw({fromRouteId:t},c)))},[e,t])}function Cue(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Iue(e){Ya(!1)}function Mue(e){let{basename:t="/",children:n=null,location:r,navigationType:a=Np.Pop,navigator:c,static:d=!1,future:i}=e;gS()&&Ya(!1);let _=t.replace(/^\/*/,"/"),b=X.useMemo(()=>({basename:_,navigator:c,static:d,future:sw({v7_relativeSplatPath:!1},i)}),[_,i,c,d]);typeof r=="string"&&(r=N0(r));let{pathname:T="/",search:A="",hash:k="",state:R=null,key:B="default"}=r,N=X.useMemo(()=>{let V=W3(T,_);return V==null?null:{location:{pathname:V,search:A,hash:k,state:R,key:B},navigationType:a}},[_,T,A,k,R,B,a]);return N==null?null:X.createElement(x_.Provider,{value:b},X.createElement(hC.Provider,{children:n,value:N}))}function QZe(e){let{children:t,location:n}=e;return gue(yD(t),n)}new Promise(()=>{});function yD(e,t){t===void 0&&(t=[]);let n=[];return X.Children.forEach(e,(r,a)=>{if(!X.isValidElement(r))return;let c=[...t,a];if(r.type===X.Fragment){n.push.apply(n,yD(r.props.children,c));return}r.type!==Iue&&Ya(!1),!r.props.index||!r.props.children||Ya(!1);let d={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=yD(r.props.children,c)),n.push(d)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vD(){return vD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vD.apply(this,arguments)}function Oue(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,c;for(c=0;c<r.length;c++)a=r[c],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function kue(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Rue(e,t){return e.button===0&&(!t||t==="_self")&&!kue(e)}function xD(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function Due(e,t){let n=xD(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(c=>{n.append(a,c)})}),n}const Lue=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zue="6";try{window.__reactRouterVersion=zue}catch{}const Nue="startTransition",UU=Qz[Nue];function eXe(e){let{basename:t,children:n,future:r,window:a}=e,c=X.useRef();c.current==null&&(c.current=Uce({window:a,v5Compat:!0}));let d=c.current,[i,_]=X.useState({action:d.action,location:d.location}),{v7_startTransition:b}=r||{},T=X.useCallback(A=>{b&&UU?UU(()=>_(A)):_(A)},[_,b]);return X.useLayoutEffect(()=>d.listen(T),[d,T]),X.useEffect(()=>Cue(r),[r]),X.createElement(Mue,{basename:t,children:n,location:i.location,navigationType:i.action,navigator:d,future:r})}const Fue=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Bue=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tXe=X.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:c,replace:d,state:i,target:_,to:b,preventScrollReset:T,viewTransition:A}=t,k=Oue(t,Lue),{basename:R}=X.useContext(x_),B,N=!1;if(typeof b=="string"&&Bue.test(b)&&(B=b,Fue))try{let q=new URL(window.location.href),Q=b.startsWith("//")?new URL(q.protocol+b):new URL(b),te=W3(Q.pathname,R);Q.origin===q.origin&&te!=null?b=te+Q.search+Q.hash:N=!0}catch{}let V=pue(b,{relative:a}),H=jue(b,{replace:d,state:i,target:_,preventScrollReset:T,relative:a,viewTransition:A});function G(q){r&&r(q),q.defaultPrevented||H(q)}return X.createElement("a",vD({},k,{href:B||V,onClick:N||c?r:G,ref:n,target:_}))});var VU;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(VU||(VU={}));var WU;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(WU||(WU={}));function jue(e,t){let{target:n,replace:r,state:a,preventScrollReset:c,relative:d,viewTransition:i}=t===void 0?{}:t,_=uq(),b=_S(),T=hq(e,{relative:d});return X.useCallback(A=>{if(Rue(A,n)){A.preventDefault();let k=r!==void 0?r:lA(b)===lA(T);_(e,{replace:k,state:a,preventScrollReset:c,relative:d,viewTransition:i})}},[b,_,T,r,a,n,e,c,d,i])}function nXe(e){let t=X.useRef(xD(e)),n=X.useRef(!1),r=_S(),a=X.useMemo(()=>Due(r.search,n.current?null:t.current),[r.search]),c=uq(),d=X.useCallback((i,_)=>{const b=xD(typeof i=="function"?i(a):i);n.current=!0,c("?"+b,_)},[c,a]);return[a,d]}function $ue(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function yS(...e){return t=>e.forEach(n=>$ue(n,t))}function Xr(...e){return X.useCallback(yS(...e),e)}var rm=X.forwardRef((e,t)=>{const{children:n,...r}=e,a=X.Children.toArray(n),c=a.find(Uue);if(c){const d=c.props.children,i=a.map(_=>_===c?X.Children.count(d)>1?X.Children.only(null):X.isValidElement(d)?d.props.children:null:_);return _e.jsx(bD,{...r,ref:t,children:X.isValidElement(d)?X.cloneElement(d,void 0,i):null})}return _e.jsx(bD,{...r,ref:t,children:n})});rm.displayName="Slot";var bD=X.forwardRef((e,t)=>{const{children:n,...r}=e;if(X.isValidElement(n)){const a=Wue(n);return X.cloneElement(n,{...Vue(r,n.props),ref:t?yS(t,a):a})}return X.Children.count(n)>1?X.Children.only(null):null});bD.displayName="SlotClone";var H3=({children:e})=>_e.jsx(_e.Fragment,{children:e});function Uue(e){return X.isValidElement(e)&&e.type===H3}function Vue(e,t){const n={...t};for(const r in t){const a=e[r],c=t[r];/^on[A-Z]/.test(r)?a&&c?n[r]=(...i)=>{c(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...c}:r==="className"&&(n[r]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}function Wue(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function pq(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=pq(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function li(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=pq(e))&&(r&&(r+=" "),r+=t);return r}const GU=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,HU=li,rXe=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return HU(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:c}=t,d=Object.keys(a).map(b=>{const T=n==null?void 0:n[b],A=c==null?void 0:c[b];if(T===null)return null;const k=GU(T)||GU(A);return a[b][k]}),i=n&&Object.entries(n).reduce((b,T)=>{let[A,k]=T;return k===void 0||(b[A]=k),b},{}),_=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((b,T)=>{let{class:A,className:k,...R}=T;return Object.entries(R).every(B=>{let[N,V]=B;return Array.isArray(V)?V.includes({...c,...i}[N]):{...c,...i}[N]===V})?[...b,A,k]:b},[]);return HU(e,d,_,n==null?void 0:n.class,n==null?void 0:n.className)},q3="-",Gue=e=>{const t=que(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:d=>{const i=d.split(q3);return i[0]===""&&i.length!==1&&i.shift(),mq(i,t)||Hue(d)},getConflictingClassGroupIds:(d,i)=>{const _=n[d]||[];return i&&r[d]?[..._,...r[d]]:_}}},mq=(e,t)=>{var d;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?mq(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const c=e.join(q3);return(d=t.validators.find(({validator:i})=>i(c)))==null?void 0:d.classGroupId},qU=/^\[(.+)\]$/,Hue=e=>{if(qU.test(e)){const t=qU.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},que=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Xue(Object.entries(e.classGroups),n).forEach(([c,d])=>{wD(d,r,c,t)}),r},wD=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const c=a===""?t:ZU(t,a);c.classGroupId=n;return}if(typeof a=="function"){if(Zue(a)){wD(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([c,d])=>{wD(d,ZU(t,c),n,r)})})},ZU=(e,t)=>{let n=e;return t.split(q3).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Zue=e=>e.isThemeGetter,Xue=(e,t)=>t?e.map(([n,r])=>{const a=r.map(c=>typeof c=="string"?t+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([d,i])=>[t+d,i])):c);return[n,a]}):e,Kue=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(c,d)=>{n.set(c,d),t++,t>e&&(t=0,r=n,n=new Map)};return{get(c){let d=n.get(c);if(d!==void 0)return d;if((d=r.get(c))!==void 0)return a(c,d),d},set(c,d){n.has(c)?n.set(c,d):a(c,d)}}},gq="!",Yue=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,a=t[0],c=t.length,d=i=>{const _=[];let b=0,T=0,A;for(let V=0;V<i.length;V++){let H=i[V];if(b===0){if(H===a&&(r||i.slice(V,V+c)===t)){_.push(i.slice(T,V)),T=V+c;continue}if(H==="/"){A=V;continue}}H==="["?b++:H==="]"&&b--}const k=_.length===0?i:i.substring(T),R=k.startsWith(gq),B=R?k.substring(1):k,N=A&&A>T?A-T:void 0;return{modifiers:_,hasImportantModifier:R,baseClassName:B,maybePostfixModifierPosition:N}};return n?i=>n({className:i,parseClassName:d}):d},Jue=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},Que=e=>({cache:Kue(e.cacheSize),parseClassName:Yue(e),...Gue(e)}),ehe=/\s+/,the=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,c=[],d=e.trim().split(ehe);let i="";for(let _=d.length-1;_>=0;_-=1){const b=d[_],{modifiers:T,hasImportantModifier:A,baseClassName:k,maybePostfixModifierPosition:R}=n(b);let B=!!R,N=r(B?k.substring(0,R):k);if(!N){if(!B){i=b+(i.length>0?" "+i:i);continue}if(N=r(k),!N){i=b+(i.length>0?" "+i:i);continue}B=!1}const V=Jue(T).join(":"),H=A?V+gq:V,G=H+N;if(c.includes(G))continue;c.push(G);const q=a(N,B);for(let Q=0;Q<q.length;++Q){const te=q[Q];c.push(H+te)}i=b+(i.length>0?" "+i:i)}return i};function nhe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=_q(t))&&(r&&(r+=" "),r+=n);return r}const _q=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=_q(e[r]))&&(n&&(n+=" "),n+=t);return n};function rhe(e,...t){let n,r,a,c=d;function d(_){const b=t.reduce((T,A)=>A(T),e());return n=Que(b),r=n.cache.get,a=n.cache.set,c=i,i(_)}function i(_){const b=r(_);if(b)return b;const T=the(_,n);return a(_,T),T}return function(){return c(nhe.apply(null,arguments))}}const Wo=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},yq=/^\[(?:([a-z-]+):)?(.+)\]$/i,ihe=/^\d+\/\d+$/,ohe=new Set(["px","full","screen"]),ahe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,she=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,lhe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,che=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,uhe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jd=e=>Av(e)||ohe.has(e)||ihe.test(e),_p=e=>F0(e,"length",yhe),Av=e=>!!e&&!Number.isNaN(Number(e)),hk=e=>F0(e,"number",Av),F1=e=>!!e&&Number.isInteger(Number(e)),hhe=e=>e.endsWith("%")&&Av(e.slice(0,-1)),wi=e=>yq.test(e),yp=e=>ahe.test(e),dhe=new Set(["length","size","percentage"]),fhe=e=>F0(e,dhe,vq),phe=e=>F0(e,"position",vq),mhe=new Set(["image","url"]),ghe=e=>F0(e,mhe,xhe),_he=e=>F0(e,"",vhe),B1=()=>!0,F0=(e,t,n)=>{const r=yq.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},yhe=e=>she.test(e)&&!lhe.test(e),vq=()=>!1,vhe=e=>che.test(e),xhe=e=>uhe.test(e),bhe=()=>{const e=Wo("colors"),t=Wo("spacing"),n=Wo("blur"),r=Wo("brightness"),a=Wo("borderColor"),c=Wo("borderRadius"),d=Wo("borderSpacing"),i=Wo("borderWidth"),_=Wo("contrast"),b=Wo("grayscale"),T=Wo("hueRotate"),A=Wo("invert"),k=Wo("gap"),R=Wo("gradientColorStops"),B=Wo("gradientColorStopPositions"),N=Wo("inset"),V=Wo("margin"),H=Wo("opacity"),G=Wo("padding"),q=Wo("saturate"),Q=Wo("scale"),te=Wo("sepia"),ue=Wo("skew"),fe=Wo("space"),ye=Wo("translate"),De=()=>["auto","contain","none"],Ne=()=>["auto","hidden","clip","visible","scroll"],Fe=()=>["auto",wi,t],Le=()=>[wi,t],Ze=()=>["",jd,_p],He=()=>["auto",Av,wi],ct=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ot=()=>["solid","dashed","dotted","double","none"],rt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Be=()=>["start","end","center","between","around","evenly","stretch"],nt=()=>["","0",wi],at=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Mt=()=>[Av,wi];return{cacheSize:500,separator:":",theme:{colors:[B1],spacing:[jd,_p],blur:["none","",yp,wi],brightness:Mt(),borderColor:[e],borderRadius:["none","","full",yp,wi],borderSpacing:Le(),borderWidth:Ze(),contrast:Mt(),grayscale:nt(),hueRotate:Mt(),invert:nt(),gap:Le(),gradientColorStops:[e],gradientColorStopPositions:[hhe,_p],inset:Fe(),margin:Fe(),opacity:Mt(),padding:Le(),saturate:Mt(),scale:Mt(),sepia:nt(),skew:Mt(),space:Le(),translate:Le()},classGroups:{aspect:[{aspect:["auto","square","video",wi]}],container:["container"],columns:[{columns:[yp]}],"break-after":[{"break-after":at()}],"break-before":[{"break-before":at()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ct(),wi]}],overflow:[{overflow:Ne()}],"overflow-x":[{"overflow-x":Ne()}],"overflow-y":[{"overflow-y":Ne()}],overscroll:[{overscroll:De()}],"overscroll-x":[{"overscroll-x":De()}],"overscroll-y":[{"overscroll-y":De()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",F1,wi]}],basis:[{basis:Fe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",wi]}],grow:[{grow:nt()}],shrink:[{shrink:nt()}],order:[{order:["first","last","none",F1,wi]}],"grid-cols":[{"grid-cols":[B1]}],"col-start-end":[{col:["auto",{span:["full",F1,wi]},wi]}],"col-start":[{"col-start":He()}],"col-end":[{"col-end":He()}],"grid-rows":[{"grid-rows":[B1]}],"row-start-end":[{row:["auto",{span:[F1,wi]},wi]}],"row-start":[{"row-start":He()}],"row-end":[{"row-end":He()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",wi]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",wi]}],gap:[{gap:[k]}],"gap-x":[{"gap-x":[k]}],"gap-y":[{"gap-y":[k]}],"justify-content":[{justify:["normal",...Be()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Be(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Be(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[G]}],px:[{px:[G]}],py:[{py:[G]}],ps:[{ps:[G]}],pe:[{pe:[G]}],pt:[{pt:[G]}],pr:[{pr:[G]}],pb:[{pb:[G]}],pl:[{pl:[G]}],m:[{m:[V]}],mx:[{mx:[V]}],my:[{my:[V]}],ms:[{ms:[V]}],me:[{me:[V]}],mt:[{mt:[V]}],mr:[{mr:[V]}],mb:[{mb:[V]}],ml:[{ml:[V]}],"space-x":[{"space-x":[fe]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[fe]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",wi,t]}],"min-w":[{"min-w":[wi,t,"min","max","fit"]}],"max-w":[{"max-w":[wi,t,"none","full","min","max","fit","prose",{screen:[yp]},yp]}],h:[{h:[wi,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[wi,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[wi,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[wi,t,"auto","min","max","fit"]}],"font-size":[{text:["base",yp,_p]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",hk]}],"font-family":[{font:[B1]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",wi]}],"line-clamp":[{"line-clamp":["none",Av,hk]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jd,wi]}],"list-image":[{"list-image":["none",wi]}],"list-style-type":[{list:["none","disc","decimal",wi]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[H]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[H]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ot(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jd,_p]}],"underline-offset":[{"underline-offset":["auto",jd,wi]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Le()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",wi]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",wi]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[H]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ct(),phe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",fhe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ghe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[B]}],"gradient-via-pos":[{via:[B]}],"gradient-to-pos":[{to:[B]}],"gradient-from":[{from:[R]}],"gradient-via":[{via:[R]}],"gradient-to":[{to:[R]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[H]}],"border-style":[{border:[...ot(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[H]}],"divide-style":[{divide:ot()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ot()]}],"outline-offset":[{"outline-offset":[jd,wi]}],"outline-w":[{outline:[jd,_p]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ze()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[H]}],"ring-offset-w":[{"ring-offset":[jd,_p]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",yp,_he]}],"shadow-color":[{shadow:[B1]}],opacity:[{opacity:[H]}],"mix-blend":[{"mix-blend":[...rt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":rt()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[_]}],"drop-shadow":[{"drop-shadow":["","none",yp,wi]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[T]}],invert:[{invert:[A]}],saturate:[{saturate:[q]}],sepia:[{sepia:[te]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[_]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[T]}],"backdrop-invert":[{"backdrop-invert":[A]}],"backdrop-opacity":[{"backdrop-opacity":[H]}],"backdrop-saturate":[{"backdrop-saturate":[q]}],"backdrop-sepia":[{"backdrop-sepia":[te]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",wi]}],duration:[{duration:Mt()}],ease:[{ease:["linear","in","out","in-out",wi]}],delay:[{delay:Mt()}],animate:[{animate:["none","spin","ping","pulse","bounce",wi]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Q]}],"scale-x":[{"scale-x":[Q]}],"scale-y":[{"scale-y":[Q]}],rotate:[{rotate:[F1,wi]}],"translate-x":[{"translate-x":[ye]}],"translate-y":[{"translate-y":[ye]}],"skew-x":[{"skew-x":[ue]}],"skew-y":[{"skew-y":[ue]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",wi]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",wi]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Le()}],"scroll-mx":[{"scroll-mx":Le()}],"scroll-my":[{"scroll-my":Le()}],"scroll-ms":[{"scroll-ms":Le()}],"scroll-me":[{"scroll-me":Le()}],"scroll-mt":[{"scroll-mt":Le()}],"scroll-mr":[{"scroll-mr":Le()}],"scroll-mb":[{"scroll-mb":Le()}],"scroll-ml":[{"scroll-ml":Le()}],"scroll-p":[{"scroll-p":Le()}],"scroll-px":[{"scroll-px":Le()}],"scroll-py":[{"scroll-py":Le()}],"scroll-ps":[{"scroll-ps":Le()}],"scroll-pe":[{"scroll-pe":Le()}],"scroll-pt":[{"scroll-pt":Le()}],"scroll-pr":[{"scroll-pr":Le()}],"scroll-pb":[{"scroll-pb":Le()}],"scroll-pl":[{"scroll-pl":Le()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",wi]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[jd,_p,hk]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},iXe=rhe(bhe),whe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>z0(async()=>{const{default:r}=await Promise.resolve().then(()=>B0);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class Z3 extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class She extends Z3{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class XU extends Z3{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class KU extends Z3{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var SD;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(SD||(SD={}));var The=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};class Ehe{constructor(t,{headers:n={},customFetch:r,region:a=SD.Any}={}){this.url=t,this.headers=n,this.region=a,this.fetch=whe(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return The(this,void 0,void 0,function*(){try{const{headers:a,method:c,body:d}=n;let i={},{region:_}=n;_||(_=this.region);const b=new URL(`${this.url}/${t}`);_&&_!=="any"&&(i["x-region"]=_,b.searchParams.set("forceFunctionRegion",_));let T;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",T=d):typeof d=="string"?(i["Content-Type"]="text/plain",T=d):typeof FormData<"u"&&d instanceof FormData?T=d:(i["Content-Type"]="application/json",T=JSON.stringify(d)));const A=yield this.fetch(b.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),a),body:T}).catch(N=>{throw new She(N)}),k=A.headers.get("x-relay-error");if(k&&k==="true")throw new XU(A);if(!A.ok)throw new KU(A);let R=((r=A.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),B;return R==="application/json"?B=yield A.json():R==="application/octet-stream"?B=yield A.blob():R==="text/event-stream"?B=A:R==="multipart/form-data"?B=yield A.formData():B=yield A.text(),{data:B,error:null,response:A}}catch(a){return{data:null,error:a,response:a instanceof KU||a instanceof XU?a.context:void 0}}})}}var ql={},X3={},dC={},vS={},fC={},pC={},Ahe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Vv=Ahe();const Phe=Vv.fetch,xq=Vv.fetch.bind(Vv),bq=Vv.Headers,Che=Vv.Request,Ihe=Vv.Response,B0=Object.freeze(Object.defineProperty({__proto__:null,Headers:bq,Request:Che,Response:Ihe,default:xq,fetch:Phe},Symbol.toStringTag,{value:"Module"})),Mhe=fse(B0);var mC={};Object.defineProperty(mC,"__esModule",{value:!0});let Ohe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};mC.default=Ohe;var wq=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pC,"__esModule",{value:!0});const khe=wq(Mhe),Rhe=wq(mC);let Dhe=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=khe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,i,_;let b=null,T=null,A=null,k=c.status,R=c.statusText;if(c.ok){if(this.method!=="HEAD"){const H=await c.text();H===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?T=H:T=JSON.parse(H))}const N=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),V=(i=c.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");N&&V&&V.length>1&&(A=parseInt(V[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(T)&&(T.length>1?(b={code:"PGRST116",details:`Results contain ${T.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},T=null,A=null,k=406,R="Not Acceptable"):T.length===1?T=T[0]:T=null)}else{const N=await c.text();try{b=JSON.parse(N),Array.isArray(b)&&c.status===404&&(T=[],b=null,k=200,R="OK")}catch{c.status===404&&N===""?(k=204,R="No Content"):b={message:N}}if(b&&this.isMaybeSingle&&(!((_=b==null?void 0:b.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,k=200,R="OK"),b&&this.shouldThrowOnError)throw new Rhe.default(b)}return{error:b,data:T,count:A,status:k,statusText:R}});return this.shouldThrowOnError||(a=a.catch(c=>{var d,i,_;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(i=c==null?void 0:c.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(_=c==null?void 0:c.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,n)}returns(){return this}overrideTypes(){return this}};pC.default=Dhe;var Lhe=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fC,"__esModule",{value:!0});const zhe=Lhe(pC);let Nhe=class extends zhe.default{select(t){let n=!1;const r=(t??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:c=a}={}){const d=c?`${c}.order`:"order",i=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${i?`${i},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:a=r}={}){const c=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${t}`),this.url.searchParams.set(d,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:c=!1,format:d="text"}={}){var i;const _=[t?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),b=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${b}"; options=${_};`,d==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};fC.default=Nhe;var Fhe=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vS,"__esModule",{value:!0});const Bhe=Fhe(fC);let jhe=class extends Bhe.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const d=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${c}fts${d}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};vS.default=jhe;var $he=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dC,"__esModule",{value:!0});const j1=$he(vS);let Uhe=class{constructor(t,{headers:n={},schema:r,fetch:a}){this.url=t,this.headers=n,this.schema=r,this.fetch=a}select(t,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let c=!1;const d=(t??"*").split("").map(i=>/\s/.test(i)&&!c?"":(i==='"'&&(c=!c),i)).join("");return this.url.searchParams.set("select",d),r&&(this.headers.Prefer=`count=${r}`),new j1.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const a="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),n&&c.push(`count=${n}`),r||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(t)){const d=t.reduce((i,_)=>i.concat(Object.keys(_)),[]);if(d.length>0){const i=[...new Set(d)].map(_=>`"${_}"`);this.url.searchParams.set("columns",i.join(","))}}return new j1.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:c=!0}={}){const d="POST",i=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),c||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const _=t.reduce((b,T)=>b.concat(Object.keys(T)),[]);if(_.length>0){const b=[...new Set(_)].map(T=>`"${T}"`);this.url.searchParams.set("columns",b.join(","))}}return new j1.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new j1.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new j1.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};dC.default=Uhe;var gC={},_C={};Object.defineProperty(_C,"__esModule",{value:!0});_C.version=void 0;_C.version="0.0.0-automated";Object.defineProperty(gC,"__esModule",{value:!0});gC.DEFAULT_HEADERS=void 0;const Vhe=_C;gC.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Vhe.version}`};var Sq=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(X3,"__esModule",{value:!0});const Whe=Sq(dC),Ghe=Sq(vS),Hhe=gC;let qhe=class Tq{constructor(t,{headers:n={},schema:r,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},Hhe.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(t){const n=new URL(`${this.url}/${t}`);return new Whe.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Tq(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:a=!1,count:c}={}){let d;const i=new URL(`${this.url}/rpc/${t}`);let _;r||a?(d=r?"HEAD":"GET",Object.entries(n).filter(([T,A])=>A!==void 0).map(([T,A])=>[T,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([T,A])=>{i.searchParams.append(T,A)})):(d="POST",_=n);const b=Object.assign({},this.headers);return c&&(b.Prefer=`count=${c}`),new Ghe.default({method:d,url:i,headers:b,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}};X3.default=qhe;var j0=ws&&ws.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ql,"__esModule",{value:!0});ql.PostgrestError=ql.PostgrestBuilder=ql.PostgrestTransformBuilder=ql.PostgrestFilterBuilder=ql.PostgrestQueryBuilder=ql.PostgrestClient=void 0;const Eq=j0(X3);ql.PostgrestClient=Eq.default;const Aq=j0(dC);ql.PostgrestQueryBuilder=Aq.default;const Pq=j0(vS);ql.PostgrestFilterBuilder=Pq.default;const Cq=j0(fC);ql.PostgrestTransformBuilder=Cq.default;const Iq=j0(pC);ql.PostgrestBuilder=Iq.default;const Mq=j0(mC);ql.PostgrestError=Mq.default;var Zhe=ql.default={PostgrestClient:Eq.default,PostgrestQueryBuilder:Aq.default,PostgrestFilterBuilder:Pq.default,PostgrestTransformBuilder:Cq.default,PostgrestBuilder:Iq.default,PostgrestError:Mq.default};const{PostgrestClient:Xhe,PostgrestQueryBuilder:uXe,PostgrestFilterBuilder:hXe,PostgrestTransformBuilder:dXe,PostgrestBuilder:fXe,PostgrestError:pXe}=Zhe;function Khe(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Yhe=Khe(),Jhe="2.11.15",Qhe=`realtime-js/${Jhe}`,ede="1.0.0",Oq=1e4,tde=1e3;var Ab;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ab||(Ab={}));var Xs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xs||(Xs={}));var Hu;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Hu||(Hu={}));var TD;(function(e){e.websocket="websocket"})(TD||(TD={}));var zg;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(zg||(zg={}));class nde{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const a=n.getUint8(1),c=n.getUint8(2);let d=this.HEADER_LENGTH+2;const i=r.decode(t.slice(d,d+a));d=d+a;const _=r.decode(t.slice(d,d+c));d=d+c;const b=JSON.parse(r.decode(t.slice(d,t.byteLength)));return{ref:null,topic:i,event:_,payload:b}}}let kq=class{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Do;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Do||(Do={}));const YU=(e,t,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((c,d)=>(c[d]=rde(d,e,t,a),c),{})},rde=(e,t,n,r)=>{const a=t.find(i=>i.name===e),c=a==null?void 0:a.type,d=n[e];return c&&!r.includes(c)?Rq(c,d):ED(d)},Rq=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return sde(t,n)}switch(e){case Do.bool:return ide(t);case Do.float4:case Do.float8:case Do.int2:case Do.int4:case Do.int8:case Do.numeric:case Do.oid:return ode(t);case Do.json:case Do.jsonb:return ade(t);case Do.timestamp:return lde(t);case Do.abstime:case Do.date:case Do.daterange:case Do.int4range:case Do.int8range:case Do.money:case Do.reltime:case Do.text:case Do.time:case Do.timestamptz:case Do.timetz:case Do.tsrange:case Do.tstzrange:return ED(t);default:return ED(t)}},ED=e=>e,ide=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},ode=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},ade=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},sde=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let c;const d=e.slice(1,n);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(i=>Rq(t,i))}return e},lde=e=>typeof e=="string"?e.replace(" ","T"):e,Dq=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class dk{constructor(t,n,r={},a=Oq){this.channel=t,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var JU;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(JU||(JU={}));class Pb{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:c,onLeave:d,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pb.syncState(this.state,a,c,d),this.pendingDiffs.forEach(_=>{this.state=Pb.syncDiff(this.state,_,c,d)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},a=>{const{onJoin:c,onLeave:d,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Pb.syncDiff(this.state,a,c,d),i())}),this.onJoin((a,c,d)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:c,newPresences:d})}),this.onLeave((a,c,d)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,a){const c=this.cloneDeep(t),d=this.transformState(n),i={},_={};return this.map(c,(b,T)=>{d[b]||(_[b]=T)}),this.map(d,(b,T)=>{const A=c[b];if(A){const k=T.map(V=>V.presence_ref),R=A.map(V=>V.presence_ref),B=T.filter(V=>R.indexOf(V.presence_ref)<0),N=A.filter(V=>k.indexOf(V.presence_ref)<0);B.length>0&&(i[b]=B),N.length>0&&(_[b]=N)}else i[b]=T}),this.syncDiff(c,{joins:i,leaves:_},r,a)}static syncDiff(t,n,r,a){const{joins:c,leaves:d}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(c,(i,_)=>{var b;const T=(b=t[i])!==null&&b!==void 0?b:[];if(t[i]=this.cloneDeep(_),T.length>0){const A=t[i].map(R=>R.presence_ref),k=T.filter(R=>A.indexOf(R.presence_ref)<0);t[i].unshift(...k)}r(i,T,_)}),this.map(d,(i,_)=>{let b=t[i];if(!b)return;const T=_.map(A=>A.presence_ref);b=b.filter(A=>T.indexOf(A.presence_ref)<0),t[i]=b,a(i,b,_),b.length===0&&delete t[i]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const a=t[r];return"metas"in a?n[r]=a.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):n[r]=a,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var QU;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(QU||(QU={}));var eV;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(eV||(eV={}));var Zd;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Zd||(Zd={}));class K3{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=Xs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new dk(this,Hu.join,this.params,this.timeout),this.rejoinTimer=new kq(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xs.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Xs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hu.reply,{},(a,c)=>{this._trigger(this._replyEventName(c),a)}),this.presence=new Pb(this),this.broadcastEndpointURL=Dq(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Xs.closed){const{config:{broadcast:c,presence:d,private:i}}=this.params;this._onError(T=>t==null?void 0:t(Zd.CHANNEL_ERROR,T)),this._onClose(()=>t==null?void 0:t(Zd.CLOSED));const _={},b={broadcast:c,presence:d,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(T=>T.filter))!==null&&a!==void 0?a:[],private:i};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:b},_)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:T})=>{var A;if(this.socket.setAuth(),T===void 0){t==null||t(Zd.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,R=(A=k==null?void 0:k.length)!==null&&A!==void 0?A:0,B=[];for(let N=0;N<R;N++){const V=k[N],{filter:{event:H,schema:G,table:q,filter:Q}}=V,te=T&&T[N];if(te&&te.event===H&&te.schema===G&&te.table===q&&te.filter===Q)B.push(Object.assign(Object.assign({},V),{id:te.id}));else{this.unsubscribe(),this.state=Xs.errored,t==null||t(Zd.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=B,t&&t(Zd.SUBSCRIBED);return}}).receive("error",T=>{this.state=Xs.errored,t==null||t(Zd.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Zd.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,a;if(!this._canPush()&&t.type==="broadcast"){const{event:c,payload:d}=t,_={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,_,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=b.body)===null||a===void 0?void 0:a.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,i,_;const b=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((_=(i=(d=this.params)===null||d===void 0?void 0:d.config)===null||i===void 0?void 0:i.broadcast)===null||_===void 0)&&_.ack)&&c("ok"),b.receive("ok",()=>c("ok")),b.receive("error",()=>c("error")),b.receive("timeout",()=>c("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xs.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hu.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new dk(this,Hu.leave,{},t),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,n,r){const a=new AbortController,c=setTimeout(()=>a.abort(),r),d=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(c),d}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new dk(this,t,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var a,c;const d=t.toLocaleLowerCase(),{close:i,error:_,leave:b,join:T}=Hu;if(r&&[i,_,b,T].indexOf(d)>=0&&r!==this._joinRef())return;let k=this._onMessage(d,n,r);if(n&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(R=>{var B,N,V;return((B=R.filter)===null||B===void 0?void 0:B.event)==="*"||((V=(N=R.filter)===null||N===void 0?void 0:N.event)===null||V===void 0?void 0:V.toLocaleLowerCase())===d}).map(R=>R.callback(k,r)):(c=this.bindings[d])===null||c===void 0||c.filter(R=>{var B,N,V,H,G,q;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in R){const Q=R.id,te=(B=R.filter)===null||B===void 0?void 0:B.event;return Q&&((N=n.ids)===null||N===void 0?void 0:N.includes(Q))&&(te==="*"||(te==null?void 0:te.toLocaleLowerCase())===((V=n.data)===null||V===void 0?void 0:V.type.toLocaleLowerCase()))}else{const Q=(G=(H=R==null?void 0:R.filter)===null||H===void 0?void 0:H.event)===null||G===void 0?void 0:G.toLocaleLowerCase();return Q==="*"||Q===((q=n==null?void 0:n.event)===null||q===void 0?void 0:q.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===d}).map(R=>{if(typeof k=="object"&&"ids"in k){const B=k.data,{schema:N,table:V,commit_timestamp:H,type:G,errors:q}=B;k=Object.assign(Object.assign({},{schema:N,table:V,commit_timestamp:H,eventType:G,new:{},old:{},errors:q}),this._getPayloadRecords(B))}R.callback(k,r)})}_isClosed(){return this.state===Xs.closed}_isJoined(){return this.state===Xs.joined}_isJoining(){return this.state===Xs.joining}_isLeaving(){return this.state===Xs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const a=t.toLocaleLowerCase(),c={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(c):this.bindings[a]=[c],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var c;return!(((c=a.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===r&&K3.isEqual(a.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Hu.close,{},t)}_onError(t){this._on(Hu.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=YU(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=YU(t.columns,t.old_record)),n}}const tV=()=>{},cde=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ude{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Oq,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tV,this.ref=0,this.logger=tV,this.conn=null,this.sendBuffer=[],this.serializer=new nde,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=c=>{let d;return c?d=c:typeof fetch>"u"?d=(...i)=>z0(async()=>{const{default:_}=await Promise.resolve().then(()=>B0);return{default:_}},void 0).then(({default:_})=>_(...i)):d=fetch,(...i)=>d(...i)},this.endPoint=`${t}/${TD.websocket}`,this.httpEndpoint=Dq(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:c=>[1e3,2e3,5e3,1e4][c-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(c,d)=>d(JSON.stringify(c)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new kq(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Yhe),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ede}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ab.connecting:return zg.Connecting;case Ab.open:return zg.Open;case Ab.closing:return zg.Closing;default:return zg.Closed}}isConnected(){return this.connectionState()===zg.Open}channel(t,n={config:{}}){const r=`realtime:${t}`,a=this.getChannels().find(c=>c.topic===r);if(a)return a;{const c=new K3(`realtime:${t}`,n,this);return this.channels.push(c),c}}push(t){const{topic:n,event:r,payload:a,ref:c}=t,d=()=>{this.encode(t,i=>{var _;(_=this.conn)===null||_===void 0||_.send(i)})};this.log("push",`${n} ${r} (${c})`,a),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:Qhe};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Hu.access_token,{access_token:n})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(tde,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:a,payload:c,ref:d}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),d&&d===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${c.status||""} ${r} ${a} ${d&&"("+d+")"||""}`,c),Array.from(this.channels).filter(i=>i._isMember(r)).forEach(i=>i._trigger(a,c,d)),this.stateChangeCallbacks.message.forEach(i=>i(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Hu.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${t}${r}${a}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([cde],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Y3 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ys(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class hde extends Y3{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class AD extends Y3{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var dde=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};const Lq=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>z0(async()=>{const{default:r}=await Promise.resolve().then(()=>B0);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},fde=()=>dde(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield z0(()=>Promise.resolve().then(()=>B0),void 0)).Response:Response}),PD=e=>{if(Array.isArray(e))return e.map(n=>PD(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));t[a]=PD(r)}),t};var w_=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};const fk=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pde=(e,t,n)=>w_(void 0,void 0,void 0,function*(){const r=yield fde();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(a=>{t(new hde(fk(a),e.status||500))}).catch(a=>{t(new AD(fk(a),a))}):t(new AD(fk(e),e))}),mde=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function xS(e,t,n,r,a,c){return w_(this,void 0,void 0,function*(){return new Promise((d,i)=>{e(n,mde(t,r,a,c)).then(_=>{if(!_.ok)throw _;return r!=null&&r.noResolveJson?_:_.json()}).then(_=>d(_)).catch(_=>pde(_,i,r))})})}function uA(e,t,n,r){return w_(this,void 0,void 0,function*(){return xS(e,"GET",t,n,r)})}function Pp(e,t,n,r,a){return w_(this,void 0,void 0,function*(){return xS(e,"POST",t,r,a,n)})}function gde(e,t,n,r,a){return w_(this,void 0,void 0,function*(){return xS(e,"PUT",t,r,a,n)})}function _de(e,t,n,r){return w_(this,void 0,void 0,function*(){return xS(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function zq(e,t,n,r,a){return w_(this,void 0,void 0,function*(){return xS(e,"DELETE",t,r,a,n)})}var jl=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};const yde={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nV={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class vde{constructor(t,n={},r,a){this.url=t,this.headers=n,this.bucketId=r,this.fetch=Lq(a)}uploadOrUpdate(t,n,r,a){return jl(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},nV),a);let i=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(d.upsert)});const _=d.metadata;typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),_&&c.append("metadata",this.encodeMetadata(_)),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl),_&&c.append("metadata",this.encodeMetadata(_))):(c=r,i["cache-control"]=`max-age=${d.cacheControl}`,i["content-type"]=d.contentType,_&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(_)))),a!=null&&a.headers&&(i=Object.assign(Object.assign({},i),a.headers));const b=this._removeEmptyFolders(n),T=this._getFinalPath(b),A=yield this.fetch(`${this.url}/object/${T}`,Object.assign({method:t,body:c,headers:i},d!=null&&d.duplex?{duplex:d.duplex}:{})),k=yield A.json();return A.ok?{data:{path:b,id:k.Id,fullPath:k.Key},error:null}:{data:null,error:k}}catch(c){if(ys(c))return{data:null,error:c};throw c}})}upload(t,n,r){return jl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,a){return jl(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(t),d=this._getFinalPath(c),i=new URL(this.url+`/object/upload/sign/${d}`);i.searchParams.set("token",n);try{let _;const b=Object.assign({upsert:nV.upsert},a),T=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});typeof Blob<"u"&&r instanceof Blob?(_=new FormData,_.append("cacheControl",b.cacheControl),_.append("",r)):typeof FormData<"u"&&r instanceof FormData?(_=r,_.append("cacheControl",b.cacheControl)):(_=r,T["cache-control"]=`max-age=${b.cacheControl}`,T["content-type"]=b.contentType);const A=yield this.fetch(i.toString(),{method:"PUT",body:_,headers:T}),k=yield A.json();return A.ok?{data:{path:c,fullPath:k.Key},error:null}:{data:null,error:k}}catch(_){if(ys(_))return{data:null,error:_};throw _}})}createSignedUploadUrl(t,n){return jl(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const c=yield Pp(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),d=new URL(this.url+c.url),i=d.searchParams.get("token");if(!i)throw new Y3("No token returned by API");return{data:{signedUrl:d.toString(),path:t,token:i},error:null}}catch(r){if(ys(r))return{data:null,error:r};throw r}})}update(t,n,r){return jl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return jl(this,void 0,void 0,function*(){try{return{data:yield Pp(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ys(a))return{data:null,error:a};throw a}})}copy(t,n,r){return jl(this,void 0,void 0,function*(){try{return{data:{path:(yield Pp(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ys(a))return{data:null,error:a};throw a}})}createSignedUrl(t,n,r){return jl(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),c=yield Pp(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const d=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(a){if(ys(a))return{data:null,error:a};throw a}})}createSignedUrls(t,n,r){return jl(this,void 0,void 0,function*(){try{const a=yield Pp(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(a){if(ys(a))return{data:null,error:a};throw a}})}download(t,n){return jl(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),d=c?`?${c}`:"";try{const i=this._getFinalPath(t);return{data:yield(yield uA(this.fetch,`${this.url}/${a}/${i}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(ys(i))return{data:null,error:i};throw i}})}info(t){return jl(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield uA(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:PD(r),error:null}}catch(r){if(ys(r))return{data:null,error:r};throw r}})}exists(t){return jl(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield _de(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ys(r)&&r instanceof AD){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),a=[],c=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";c!==""&&a.push(c);const i=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",_=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});_!==""&&a.push(_);let b=a.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${b}`)}}}remove(t){return jl(this,void 0,void 0,function*(){try{return{data:yield zq(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(ys(n))return{data:null,error:n};throw n}})}list(t,n,r){return jl(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},yde),n),{prefix:t||""});return{data:yield Pp(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(ys(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const xde="2.7.1",bde={"X-Client-Info":`storage-js/${xde}`};var Fy=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};class wde{constructor(t,n={},r){this.url=t,this.headers=Object.assign(Object.assign({},bde),n),this.fetch=Lq(r)}listBuckets(){return Fy(this,void 0,void 0,function*(){try{return{data:yield uA(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ys(t))return{data:null,error:t};throw t}})}getBucket(t){return Fy(this,void 0,void 0,function*(){try{return{data:yield uA(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(ys(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Fy(this,void 0,void 0,function*(){try{return{data:yield Pp(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ys(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Fy(this,void 0,void 0,function*(){try{return{data:yield gde(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ys(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Fy(this,void 0,void 0,function*(){try{return{data:yield Pp(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ys(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Fy(this,void 0,void 0,function*(){try{return{data:yield zq(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(ys(n))return{data:null,error:n};throw n}})}}class Sde extends wde{constructor(t,n={},r){super(t,n,r)}from(t){return new vde(this.url,this.headers,t,this.fetch)}}const Tde="2.52.0";let ab="";typeof Deno<"u"?ab="deno":typeof document<"u"?ab="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ab="react-native":ab="node";const Ede={"X-Client-Info":`supabase-js-${ab}/${Tde}`},Ade={headers:Ede},Pde={schema:"public"},Cde={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ide={};var Mde=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};const Ode=e=>{let t;return e?t=e:typeof fetch>"u"?t=xq:t=fetch,(...n)=>t(...n)},kde=()=>typeof Headers>"u"?bq:Headers,Rde=(e,t,n)=>{const r=Ode(n),a=kde();return(c,d)=>Mde(void 0,void 0,void 0,function*(){var i;const _=(i=yield t())!==null&&i!==void 0?i:e;let b=new a(d==null?void 0:d.headers);return b.has("apikey")||b.set("apikey",e),b.has("Authorization")||b.set("Authorization",`Bearer ${_}`),r(c,Object.assign(Object.assign({},d),{headers:b}))})};var Dde=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};function Lde(e){return e.endsWith("/")?e:e+"/"}function zde(e,t){var n,r;const{db:a,auth:c,realtime:d,global:i}=e,{db:_,auth:b,realtime:T,global:A}=t,k={db:Object.assign(Object.assign({},_),a),auth:Object.assign(Object.assign({},b),c),realtime:Object.assign(Object.assign({},T),d),global:Object.assign(Object.assign(Object.assign({},A),i),{headers:Object.assign(Object.assign({},(n=A==null?void 0:A.headers)!==null&&n!==void 0?n:{}),(r=i==null?void 0:i.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Dde(this,void 0,void 0,function*(){return""})};return e.accessToken?k.accessToken=e.accessToken:delete k.accessToken,k}const Nq="2.71.1",ev=30*1e3,CD=3,pk=CD*ev,Nde="http://localhost:9999",Fde="supabase.auth.token",Bde={"X-Client-Info":`gotrue-js/${Nq}`},ID="X-Supabase-Api-Version",Fq={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jde=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$de=10*60*1e3;class J3 extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function gi(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ude extends J3{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Vde(e){return gi(e)&&e.name==="AuthApiError"}class Bq extends J3{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class vm extends J3{constructor(t,n,r,a){super(t,r,a),this.name=n,this.status=r}}class bp extends vm{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Wde(e){return gi(e)&&e.name==="AuthSessionMissingError"}class jE extends vm{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $E extends vm{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class UE extends vm{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Gde(e){return gi(e)&&e.name==="AuthImplicitGrantRedirectError"}class rV extends vm{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class MD extends vm{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function mk(e){return gi(e)&&e.name==="AuthRetryableFetchError"}class iV extends vm{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class OD extends vm{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const hA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),oV=` 	
\r=`.split(""),Hde=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<oV.length;t+=1)e[oV[t].charCodeAt(0)]=-2;for(let t=0;t<hA.length;t+=1)e[hA[t].charCodeAt(0)]=t;return e})();function aV(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(hA[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(hA[r]),t.queuedBits-=6}}function jq(e,t,n){const r=Hde[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function sV(e){const t=[],n=d=>{t.push(String.fromCodePoint(d))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},c=d=>{Xde(d,r,n)};for(let d=0;d<e.length;d+=1)jq(e.charCodeAt(d),a,c);return t.join("")}function qde(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Zde(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}qde(r,t)}}function Xde(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function Kde(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)jq(e.charCodeAt(a),n,r);return new Uint8Array(t)}function Yde(e){const t=[];return Zde(e,n=>t.push(n)),new Uint8Array(t)}function Jde(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};return e.forEach(a=>aV(a,n,r)),aV(null,n,r),t.join("")}function Qde(e){return Math.round(Date.now()/1e3)+e}function efe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Uu=()=>typeof window<"u"&&typeof document<"u",Tg={tested:!1,writable:!1},$q=()=>{if(!Uu())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tg.tested)return Tg.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Tg.tested=!0,Tg.writable=!0}catch{Tg.tested=!0,Tg.writable=!1}return Tg.writable};function tfe(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,c)=>{t[c]=a})}catch{}return n.searchParams.forEach((r,a)=>{t[a]=r}),t}const Uq=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>z0(async()=>{const{default:r}=await Promise.resolve().then(()=>B0);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},nfe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",tv=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Eg=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},vp=async(e,t)=>{await e.removeItem(t)};class yC{constructor(){this.promise=new yC.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}yC.promiseConstructor=Promise;function gk(e){const t=e.split(".");if(t.length!==3)throw new OD("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!jde.test(t[r]))throw new OD("JWT not in base64url format");return{header:JSON.parse(sV(t[0])),payload:JSON.parse(sV(t[1])),signature:Kde(t[2]),raw:{header:t[0],payload:t[1]}}}async function rfe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ife(e,t){return new Promise((r,a)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await e(c);if(!t(c,null,d)){r(d);return}}catch(d){if(!t(c,d)){a(d);return}}})()})}function ofe(e){return("0"+e.toString(16)).substr(-2)}function afe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let c=0;c<56;c++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(t),Array.from(t,ofe).join("")}async function sfe(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(c=>String.fromCharCode(c)).join("")}async function lfe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await sfe(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function By(e,t,n=!1){const r=afe();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await tv(e,`${t}-code-verifier`,a);const c=await lfe(r);return[c,r===c?"plain":"s256"]}const cfe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ufe(e){const t=e.headers.get(ID);if(!t||!t.match(cfe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function hfe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function dfe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ffe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jy(e){if(!ffe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _k(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function lV(e){return JSON.parse(JSON.stringify(e))}var pfe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};const Og=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),mfe=[502,503,504];async function cV(e){var t;if(!nfe(e))throw new MD(Og(e),0);if(mfe.includes(e.status))throw new MD(Og(e),e.status);let n;try{n=await e.json()}catch(c){throw new Bq(Og(c),c)}let r;const a=ufe(e);if(a&&a.getTime()>=Fq["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new iV(Og(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new bp}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new iV(Og(n),e.status,n.weak_password.reasons);throw new Ude(Og(n),e.status||500,r)}const gfe=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Ui(e,t,n,r){var a;const c=Object.assign({},r==null?void 0:r.headers);c[ID]||(c[ID]=Fq["2024-01-01"].name),r!=null&&r.jwt&&(c.Authorization=`Bearer ${r.jwt}`);const d=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(d.redirect_to=r.redirectTo);const i=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",_=await _fe(e,t,n+i,{headers:c,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(_):{data:Object.assign({},_),error:null}}async function _fe(e,t,n,r,a,c){const d=gfe(t,r,a,c);let i;try{i=await e(n,Object.assign({},d))}catch(_){throw console.error(_),new MD(Og(_),0)}if(i.ok||await cV(i),r!=null&&r.noResolveJson)return i;try{return await i.json()}catch(_){await cV(_)}}function Gd(e){var t;let n=null;bfe(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=Qde(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function uV(e){const t=Gd(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Op(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function yfe(e){return{data:e,error:null}}function vfe(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:c}=e,d=pfe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:c},_=Object.assign({},d);return{data:{properties:i,user:_},error:null}}function xfe(e){return e}function bfe(e){return e.access_token&&e.refresh_token&&e.expires_in}const yk=["global","local","others"];var wfe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};class Sfe{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=Uq(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=yk[0]){if(yk.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yk.join(", ")}`);try{return await Ui(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(gi(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Ui(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Op})}catch(r){if(gi(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=wfe(t,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Ui(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:vfe,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(gi(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Ui(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Op})}catch(n){if(gi(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,a,c,d,i,_;try{const b={nextPage:null,lastPage:0,total:0},T=await Ui(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(c=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&c!==void 0?c:""},xform:xfe});if(T.error)throw T.error;const A=await T.json(),k=(d=T.headers.get("x-total-count"))!==null&&d!==void 0?d:0,R=(_=(i=T.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&_!==void 0?_:[];return R.length>0&&(R.forEach(B=>{const N=parseInt(B.split(";")[0].split("=")[1].substring(0,1)),V=JSON.parse(B.split(";")[1].split("=")[1]);b[`${V}Page`]=N}),b.total=parseInt(k)),{data:Object.assign(Object.assign({},A),b),error:null}}catch(b){if(gi(b))return{data:{users:[]},error:b};throw b}}async getUserById(t){jy(t);try{return await Ui(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Op})}catch(n){if(gi(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){jy(t);try{return await Ui(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Op})}catch(r){if(gi(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){jy(t);try{return await Ui(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Op})}catch(r){if(gi(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){jy(t.userId);try{const{data:n,error:r}=await Ui(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(gi(n))return{data:null,error:n};throw n}}async _deleteFactor(t){jy(t.userId),jy(t.id);try{return{data:await Ui(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(gi(n))return{data:null,error:n};throw n}}}function hV(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function Tfe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $y={debug:!!(globalThis&&$q()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Vq extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Efe extends Vq{}async function Afe(e,t,n){$y.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),$y.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){$y.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{$y.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw $y.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Efe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if($y.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Tfe();const Pfe={url:Nde,storageKey:Fde,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Bde,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function dV(e,t,n){return await n()}const Uy={};class lw{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lw.nextInstanceID,lw.nextInstanceID+=1,this.instanceID>0&&Uu()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Pfe),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Sfe({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Uq(a.fetch),this.lock=a.lock||dV,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Uu()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Afe:this.lock=dV,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:$q()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hV(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=hV(this.memoryStorage)),Uu()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=Uy[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Uy[this.storageKey]=Object.assign(Object.assign({},Uy[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Uy[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Uy[this.storageKey]=Object.assign(Object.assign({},Uy[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Nq}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=tfe(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Uu()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:c}=await this._getSessionFromURL(n,r);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),Gde(c)){const _=(t=c.details)===null||t===void 0?void 0:t.code;if(_==="identity_already_exists"||_==="identity_not_found"||_==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",d,"redirect type",i),await this._saveSession(d),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return gi(n)?{error:n}:{error:new Bq("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,a;try{const c=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Gd}),{data:d,error:i}=c;if(i||!d)return{data:{user:null,session:null},error:i};const _=d.session,b=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(c){if(gi(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(t){var n,r,a;try{let c;if("email"in t){const{email:T,password:A,options:k}=t;let R=null,B=null;this.flowType==="pkce"&&([R,B]=await By(this.storage,this.storageKey)),c=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:k==null?void 0:k.emailRedirectTo,body:{email:T,password:A,data:(n=k==null?void 0:k.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:k==null?void 0:k.captchaToken},code_challenge:R,code_challenge_method:B},xform:Gd})}else if("phone"in t){const{phone:T,password:A,options:k}=t;c=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:T,password:A,data:(r=k==null?void 0:k.data)!==null&&r!==void 0?r:{},channel:(a=k==null?void 0:k.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:k==null?void 0:k.captchaToken}},xform:Gd})}else throw new $E("You must provide either an email or phone number and a password");const{data:d,error:i}=c;if(i||!d)return{data:{user:null,session:null},error:i};const _=d.session,b=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(c){if(gi(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(t){try{let n;if("email"in t){const{email:c,password:d,options:i}=t;n=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:uV})}else if("phone"in t){const{phone:c,password:d,options:i}=t;n=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:uV})}else throw new $E("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new jE}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(gi(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,a,c;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(c=t.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,a,c,d,i,_,b,T,A,k,R;let B,N;if("message"in t)B=t.message,N=t.signature;else{const{chain:V,wallet:H,statement:G,options:q}=t;let Q;if(Uu())if(typeof H=="object")Q=H;else{const ue=window;if("solana"in ue&&typeof ue.solana=="object"&&("signIn"in ue.solana&&typeof ue.solana.signIn=="function"||"signMessage"in ue.solana&&typeof ue.solana.signMessage=="function"))Q=ue.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof H!="object"||!(q!=null&&q.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Q=H}const te=new URL((n=q==null?void 0:q.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in Q&&Q.signIn){const ue=await Q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},q==null?void 0:q.signInWithSolana),{version:"1",domain:te.host,uri:te.href}),G?{statement:G}:null));let fe;if(Array.isArray(ue)&&ue[0]&&typeof ue[0]=="object")fe=ue[0];else if(ue&&typeof ue=="object"&&"signedMessage"in ue&&"signature"in ue)fe=ue;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in fe&&"signature"in fe&&(typeof fe.signedMessage=="string"||fe.signedMessage instanceof Uint8Array)&&fe.signature instanceof Uint8Array)B=typeof fe.signedMessage=="string"?fe.signedMessage:new TextDecoder().decode(fe.signedMessage),N=fe.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Q)||typeof Q.signMessage!="function"||!("publicKey"in Q)||typeof Q!="object"||!Q.publicKey||!("toBase58"in Q.publicKey)||typeof Q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");B=[`${te.host} wants you to sign in with your Solana account:`,Q.publicKey.toBase58(),...G?["",G,""]:[""],"Version: 1",`URI: ${te.href}`,`Issued At: ${(a=(r=q==null?void 0:q.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((c=q==null?void 0:q.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${q.signInWithSolana.notBefore}`]:[],...!((d=q==null?void 0:q.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${q.signInWithSolana.expirationTime}`]:[],...!((i=q==null?void 0:q.signInWithSolana)===null||i===void 0)&&i.chainId?[`Chain ID: ${q.signInWithSolana.chainId}`]:[],...!((_=q==null?void 0:q.signInWithSolana)===null||_===void 0)&&_.nonce?[`Nonce: ${q.signInWithSolana.nonce}`]:[],...!((b=q==null?void 0:q.signInWithSolana)===null||b===void 0)&&b.requestId?[`Request ID: ${q.signInWithSolana.requestId}`]:[],...!((A=(T=q==null?void 0:q.signInWithSolana)===null||T===void 0?void 0:T.resources)===null||A===void 0)&&A.length?["Resources",...q.signInWithSolana.resources.map(fe=>`- ${fe}`)]:[]].join(`
`);const ue=await Q.signMessage(new TextEncoder().encode(B),"utf8");if(!ue||!(ue instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=ue}}try{const{data:V,error:H}=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:B,signature:Jde(N)},!((k=t.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:Gd});if(H)throw H;return!V||!V.session||!V.user?{data:{user:null,session:null},error:new jE}:(V.session&&(await this._saveSession(V.session),await this._notifyAllSubscribers("SIGNED_IN",V.session)),{data:Object.assign({},V),error:H})}catch(V){if(gi(V))return{data:{user:null,session:null},error:V};throw V}}async _exchangeCodeForSession(t){const n=await Eg(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:c,error:d}=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Gd});if(await vp(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new jE}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:a??null}),error:d})}catch(c){if(gi(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(t){try{const{options:n,provider:r,token:a,access_token:c,nonce:d}=t,i=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Gd}),{data:_,error:b}=i;return b?{data:{user:null,session:null},error:b}:!_||!_.session||!_.user?{data:{user:null,session:null},error:new jE}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:_,error:b})}catch(n){if(gi(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,a,c,d;try{if("email"in t){const{email:i,options:_}=t;let b=null,T=null;this.flowType==="pkce"&&([b,T]=await By(this.storage,this.storageKey));const{error:A}=await Ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},create_user:(r=_==null?void 0:_.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:b,code_challenge_method:T},redirectTo:_==null?void 0:_.emailRedirectTo});return{data:{user:null,session:null},error:A}}if("phone"in t){const{phone:i,options:_}=t,{data:b,error:T}=await Ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(a=_==null?void 0:_.data)!==null&&a!==void 0?a:{},create_user:(c=_==null?void 0:_.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},channel:(d=_==null?void 0:_.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:b==null?void 0:b.message_id},error:T}}throw new $E("You must provide either an email or phone number.")}catch(i){if(gi(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(t){var n,r;try{let a,c;"options"in t&&(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo,c=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:d,error:i}=await Ui(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:c}}),redirectTo:a,xform:Gd});if(i)throw i;if(!d)throw new Error("An error occurred on token verification.");const _=d.session,b=d.user;return _!=null&&_.access_token&&(await this._saveSession(_),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(a){if(gi(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var n,r,a;try{let c=null,d=null;return this.flowType==="pkce"&&([c,d]=await By(this.storage,this.storageKey)),await Ui(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:yfe})}catch(c){if(gi(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new bp;const{error:a}=await Ui(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(gi(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:a,options:c}=t,{error:d}=await Ui(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in t){const{phone:r,type:a,options:c}=t,{data:d,error:i}=await Ui(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:i}}throw new $E("You must provide either an email or phone number and a type")}catch(n){if(gi(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Eg(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<pk:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const d=await Eg(this.userStorage,this.storageKey+"-user");d!=null&&d.user?t.user=d.user:t.user=_k()}if(this.storage.isServer&&t.user){let d=this.suppressGetSessionWarning;t=new Proxy(t,{get:(_,b,T)=>(!d&&b==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(_,b,T))})}return{data:{session:t},error:null}}const{session:a,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{session:null},error:c}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Op}):await this._useSession(async n=>{var r,a,c;const{data:d,error:i}=n;if(i)throw i;return!(!((r=d.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new bp}:await Ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&c!==void 0?c:void 0,xform:Op})})}catch(n){if(gi(n))return Wde(n)&&(await this._removeSession(),await vp(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:a,error:c}=r;if(c)throw c;if(!a.session)throw new bp;const d=a.session;let i=null,_=null;this.flowType==="pkce"&&t.email!=null&&([i,_]=await By(this.storage,this.storageKey));const{data:b,error:T}=await Ui(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:i,code_challenge_method:_}),jwt:d.access_token,xform:Op});if(T)throw T;return d.user=b.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(r){if(gi(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new bp;const n=Date.now()/1e3;let r=n,a=!0,c=null;const{payload:d}=gk(t.access_token);if(d.exp&&(r=d.exp,a=r<=n),a){const{session:i,error:_}=await this._callRefreshToken(t.refresh_token);if(_)return{data:{user:null,session:null},error:_};if(!i)return{data:{user:null,session:null},error:null};c=i}else{const{data:i,error:_}=await this._getUser(t.access_token);if(_)throw _;c={access_token:t.access_token,refresh_token:t.refresh_token,user:i.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(n){if(gi(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:d,error:i}=n;if(i)throw i;t=(r=d.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new bp;const{session:a,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{user:null,session:null},error:c}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(gi(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Uu())throw new UE("No browser detected.");if(t.error||t.error_description||t.error_code)throw new UE(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new rV("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new UE("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new rV("No code detected.");const{data:G,error:q}=await this._exchangeCodeForSession(t.code);if(q)throw q;const Q=new URL(window.location.href);return Q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Q.toString()),{data:{session:G.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:c,refresh_token:d,expires_in:i,expires_at:_,token_type:b}=t;if(!c||!i||!d||!b)throw new UE("No session defined in URL");const T=Math.round(Date.now()/1e3),A=parseInt(i);let k=T+A;_&&(k=parseInt(_));const R=k-T;R*1e3<=ev&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${A}s`);const B=k-A;T-B>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",B,k,T):T-B<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",B,k,T);const{data:N,error:V}=await this._getUser(c);if(V)throw V;const H={provider_token:r,provider_refresh_token:a,access_token:c,expires_in:A,expires_at:k,refresh_token:d,token_type:b,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:H,redirectType:t.type},error:null}}catch(r){if(gi(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Eg(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:c}=n;if(c)return{error:c};const d=(r=a.session)===null||r===void 0?void 0:r.access_token;if(d){const{error:i}=await this.admin.signOut(d,t);if(i&&!(Vde(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return t!=="others"&&(await this._removeSession(),await vp(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=efe(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,a;try{const{data:{session:c},error:d}=n;if(d)throw d;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",t,"session",c)}catch(c){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",c),console.error(c)}})}async resetPasswordForEmail(t,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await By(this.storage,this.storageKey,!0));try{return await Ui(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(c){if(gi(c))return{data:null,error:c};throw c}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(gi(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:a}=await this._useSession(async c=>{var d,i,_,b,T;const{data:A,error:k}=c;if(k)throw k;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(_=t.options)===null||_===void 0?void 0:_.queryParams,skipBrowserRedirect:!0});return await Ui(this.fetch,"GET",R,{headers:this.headers,jwt:(T=(b=A.session)===null||b===void 0?void 0:b.access_token)!==null&&T!==void 0?T:void 0})});if(a)throw a;return Uu()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(gi(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,a;const{data:c,error:d}=n;if(d)throw d;return await Ui(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(gi(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await ife(async a=>(a>0&&await rfe(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Ui(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Gd})),(a,c)=>{const d=200*Math.pow(2,a);return c&&mk(c)&&Date.now()+d-r<ev})}catch(r){if(this._debug(n,"error",r),gi(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),Uu()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await Eg(this.storage,this.storageKey);if(a&&this.userStorage){let d=await Eg(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:a.user},await tv(this.userStorage,this.storageKey+"-user",d)),a.user=(t=d==null?void 0:d.user)!==null&&t!==void 0?t:_k()}else if(a&&!a.user&&!a.user){const d=await Eg(this.storage,this.storageKey+"-user");d&&(d!=null&&d.user)?(a.user=d.user,await vp(this.storage,this.storageKey+"-user"),await tv(this.storage,this.storageKey,a)):a.user=_k()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const c=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<pk;if(this._debug(r,`session has${c?"":" not"} expired with margin of ${pk}s`),c){if(this.autoRefreshToken&&a.refresh_token){const{error:d}=await this._callRefreshToken(a.refresh_token);d&&(console.error(d),mk(d)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:i}=await this._getUser(a.access_token);!i&&(d!=null&&d.user)?(a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(r,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new bp;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new yC;const{data:c,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!c.session)throw new bp;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const i={session:c.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(c){if(this._debug(a,"error",c),gi(c)){const d={session:null,error:c};return mk(c)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(d),d}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(c),c}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,n,r=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,n)}catch(_){c.push(_)}});if(await Promise.all(d),c.length>0){for(let i=0;i<c.length;i+=1)console.error(c[i]);throw c[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await tv(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const c=lV(a);await tv(this.storage,this.storageKey,c)}else{const a=lV(n);await tv(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await vp(this.storage,this.storageKey),await vp(this.storage,this.storageKey+"-code-verifier"),await vp(this.storage,this.storageKey+"-user"),this.userStorage&&await vp(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Uu()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ev);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-t)/ev);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ev}ms, refresh threshold is ${CD} ticks`),a<=CD&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Vq)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Uu()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[c,d]=await By(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});a.push(i.toString())}if(r!=null&&r.queryParams){const c=new URLSearchParams(r.queryParams);a.push(c.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;return c?{data:null,error:c}:await Ui(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(gi(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,a;const{data:c,error:d}=n;if(d)return{data:null,error:d};const i=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:_,error:b}=await Ui(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(r=c==null?void 0:c.session)===null||r===void 0?void 0:r.access_token});return b?{data:null,error:b}:(t.factorType==="totp"&&(!((a=_==null?void 0:_.totp)===null||a===void 0)&&a.qr_code)&&(_.totp.qr_code=`data:image/svg+xml;utf-8,${_.totp.qr_code}`),{data:_,error:null})})}catch(n){if(gi(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;if(c)return{data:null,error:c};const{data:d,error:i}=await Ui(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:i})})}catch(n){if(gi(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;return c?{data:null,error:c}:await Ui(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(gi(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],a=r.filter(d=>d.factor_type==="totp"&&d.status==="verified"),c=r.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:r,totp:a,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:a},error:c}=t;if(c)return{data:null,error:c};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=gk(a.access_token);let i=null;d.aal&&(i=d.aal);let _=i;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(A=>A.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(_="aal2");const T=d.amr||[];return{data:{currentLevel:i,nextLevel:_,currentAuthenticationMethods:T},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(i=>i.kid===t);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(i=>i.kid===t),r&&this.jwks_cached_at+$de>a)return r;const{data:c,error:d}=await Ui(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=a,r=c.keys.find(i=>i.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:R,error:B}=await this.getSession();if(B||!R.session)return{data:null,error:B};r=R.session.access_token}const{header:a,payload:c,signature:d,raw:{header:i,payload:_}}=gk(r);n!=null&&n.allowExpired||hfe(c.exp);const b=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!b){const{error:R}=await this.getUser(r);if(R)throw R;return{data:{claims:c,header:a,signature:d},error:null}}const T=dfe(a.alg),A=await crypto.subtle.importKey("jwk",b,T,!0,["verify"]);if(!await crypto.subtle.verify(T,A,d,Yde(`${i}.${_}`)))throw new OD("Invalid JWT signature");return{data:{claims:c,header:a,signature:d},error:null}}catch(r){if(gi(r))return{data:null,error:r};throw r}}}lw.nextInstanceID=0;const Cfe=lw;class Ife extends Cfe{constructor(t){super(t)}}var Mfe=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function i(T){try{b(r.next(T))}catch(A){d(A)}}function _(T){try{b(r.throw(T))}catch(A){d(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,_)}b((r=r.apply(e,t||[])).next())})};class Ofe{constructor(t,n,r){var a,c,d;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const i=Lde(t),_=new URL(i);this.realtimeUrl=new URL("realtime/v1",_),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",_),this.storageUrl=new URL("storage/v1",_),this.functionsUrl=new URL("functions/v1",_);const b=`sb-${_.hostname.split(".")[0]}-auth-token`,T={db:Pde,realtime:Ide,auth:Object.assign(Object.assign({},Cde),{storageKey:b}),global:Ade},A=zde(r??{},T);this.storageKey=(a=A.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=A.global.headers)!==null&&c!==void 0?c:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(k,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=A.auth)!==null&&d!==void 0?d:{},this.headers,A.global.fetch),this.fetch=Rde(n,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.rest=new Xhe(new URL("rest/v1",_).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),A.accessToken||this._listenForAuthEvents()}get functions(){return new Ehe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Sde(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return Mfe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:c,flowType:d,lock:i,debug:_},b,T){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ife({url:this.authUrl.href,headers:Object.assign(Object.assign({},A),b),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,flowType:d,lock:i,debug:_,fetch:T,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new ude(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const gXe=(e,t,n)=>new Ofe(e,t,n);var kfe=e=>{switch(e){case"success":return Lfe;case"info":return Nfe;case"warning":return zfe;case"error":return Ffe;default:return null}},Rfe=Array(12).fill(0),Dfe=({visible:e,className:t})=>Ce.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ce.createElement("div",{className:"sonner-spinner"},Rfe.map((n,r)=>Ce.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Lfe=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),zfe=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Nfe=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ffe=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Bfe=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ce.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ce.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),jfe=()=>{let[e,t]=Ce.useState(document.hidden);return Ce.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},kD=1,$fe=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:kD++,c=this.toasts.find(i=>i.id===a),d=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),c?this.toasts=this.toasts.map(i=>i.id===a?(this.publish({...i,...e,id:a,title:n}),{...i,...e,id:a,dismissible:d,title:n}):i):this.addToast({title:n,...r,dismissible:d,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),a=n!==void 0,c,d=r.then(async _=>{if(c=["resolve",_],Ce.isValidElement(_))a=!1,this.create({id:n,type:"default",message:_});else if(Vfe(_)&&!_.ok){a=!1;let b=typeof t.error=="function"?await t.error(`HTTP error! status: ${_.status}`):t.error,T=typeof t.description=="function"?await t.description(`HTTP error! status: ${_.status}`):t.description;this.create({id:n,type:"error",message:b,description:T})}else if(t.success!==void 0){a=!1;let b=typeof t.success=="function"?await t.success(_):t.success,T=typeof t.description=="function"?await t.description(_):t.description;this.create({id:n,type:"success",message:b,description:T})}}).catch(async _=>{if(c=["reject",_],t.error!==void 0){a=!1;let b=typeof t.error=="function"?await t.error(_):t.error,T=typeof t.description=="function"?await t.description(_):t.description;this.create({id:n,type:"error",message:b,description:T})}}).finally(()=>{var _;a&&(this.dismiss(n),n=void 0),(_=t.finally)==null||_.call(t)}),i=()=>new Promise((_,b)=>d.then(()=>c[0]==="reject"?b(c[1]):_(c[1])).catch(b));return typeof n!="string"&&typeof n!="number"?{unwrap:i}:Object.assign(n,{unwrap:i})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||kD++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Gl=new $fe,Ufe=(e,t)=>{let n=(t==null?void 0:t.id)||kD++;return Gl.addToast({title:e,...t,id:n}),n},Vfe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Wfe=Ufe,Gfe=()=>Gl.toasts,Hfe=()=>Gl.getActiveToasts(),_Xe=Object.assign(Wfe,{success:Gl.success,info:Gl.info,warning:Gl.warning,error:Gl.error,custom:Gl.custom,message:Gl.message,promise:Gl.promise,dismiss:Gl.dismiss,loading:Gl.loading},{getHistory:Gfe,getToasts:Hfe});function qfe(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}qfe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function VE(e){return e.label!==void 0}var Zfe=3,Xfe="32px",Kfe="16px",fV=4e3,Yfe=356,Jfe=14,Qfe=20,epe=200;function ju(...e){return e.filter(Boolean).join(" ")}function tpe(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var npe=e=>{var t,n,r,a,c,d,i,_,b,T,A;let{invert:k,toast:R,unstyled:B,interacting:N,setHeights:V,visibleToasts:H,heights:G,index:q,toasts:Q,expanded:te,removeToast:ue,defaultRichColors:fe,closeButton:ye,style:De,cancelButtonStyle:Ne,actionButtonStyle:Fe,className:Le="",descriptionClassName:Ze="",duration:He,position:ct,gap:ot,loadingIcon:rt,expandByDefault:Be,classNames:nt,icons:at,closeButtonAriaLabel:Mt="Close toast",pauseWhenPageIsHidden:Nt}=e,[rn,un]=Ce.useState(null),[en,sn]=Ce.useState(null),[Vt,$n]=Ce.useState(!1),[Gt,Tn]=Ce.useState(!1),[hn,yt]=Ce.useState(!1),[In,Kn]=Ce.useState(!1),[Ar,_r]=Ce.useState(!1),[Vr,it]=Ce.useState(0),[Pt,jt]=Ce.useState(0),Cn=Ce.useRef(R.duration||He||fV),Mn=Ce.useRef(null),_n=Ce.useRef(null),Gn=q===0,vr=q+1<=H,ni=R.type,vi=R.dismissible!==!1,na=R.className||"",fa=R.descriptionClassName||"",to=Ce.useMemo(()=>G.findIndex(Tt=>Tt.toastId===R.id)||0,[G,R.id]),uo=Ce.useMemo(()=>{var Tt;return(Tt=R.closeButton)!=null?Tt:ye},[R.closeButton,ye]),ja=Ce.useMemo(()=>R.duration||He||fV,[R.duration,He]),Bo=Ce.useRef(0),fo=Ce.useRef(0),$a=Ce.useRef(0),Ua=Ce.useRef(null),[Es,ci]=ct.split("-"),Qa=Ce.useMemo(()=>G.reduce((Tt,pi,Yi)=>Yi>=to?Tt:Tt+pi.height,0),[G,to]),As=jfe(),pa=R.invert||k,Ps=ni==="loading";fo.current=Ce.useMemo(()=>to*ot+Qa,[to,Qa]),Ce.useEffect(()=>{Cn.current=ja},[ja]),Ce.useEffect(()=>{$n(!0)},[]),Ce.useEffect(()=>{let Tt=_n.current;if(Tt){let pi=Tt.getBoundingClientRect().height;return jt(pi),V(Yi=>[{toastId:R.id,height:pi,position:R.position},...Yi]),()=>V(Yi=>Yi.filter(mt=>mt.toastId!==R.id))}},[V,R.id]),Ce.useLayoutEffect(()=>{if(!Vt)return;let Tt=_n.current,pi=Tt.style.height;Tt.style.height="auto";let Yi=Tt.getBoundingClientRect().height;Tt.style.height=pi,jt(Yi),V(mt=>mt.find(ae=>ae.toastId===R.id)?mt.map(ae=>ae.toastId===R.id?{...ae,height:Yi}:ae):[{toastId:R.id,height:Yi,position:R.position},...mt])},[Vt,R.title,R.description,V,R.id]);let es=Ce.useCallback(()=>{Tn(!0),it(fo.current),V(Tt=>Tt.filter(pi=>pi.toastId!==R.id)),setTimeout(()=>{ue(R)},epe)},[R,ue,V,fo]);Ce.useEffect(()=>{if(R.promise&&ni==="loading"||R.duration===1/0||R.type==="loading")return;let Tt;return te||N||Nt&&As?(()=>{if($a.current<Bo.current){let pi=new Date().getTime()-Bo.current;Cn.current=Cn.current-pi}$a.current=new Date().getTime()})():Cn.current!==1/0&&(Bo.current=new Date().getTime(),Tt=setTimeout(()=>{var pi;(pi=R.onAutoClose)==null||pi.call(R,R),es()},Cn.current)),()=>clearTimeout(Tt)},[te,N,R,ni,Nt,As,es]),Ce.useEffect(()=>{R.delete&&es()},[es,R.delete]);function Cl(){var Tt,pi,Yi;return at!=null&&at.loading?Ce.createElement("div",{className:ju(nt==null?void 0:nt.loader,(Tt=R==null?void 0:R.classNames)==null?void 0:Tt.loader,"sonner-loader"),"data-visible":ni==="loading"},at.loading):rt?Ce.createElement("div",{className:ju(nt==null?void 0:nt.loader,(pi=R==null?void 0:R.classNames)==null?void 0:pi.loader,"sonner-loader"),"data-visible":ni==="loading"},rt):Ce.createElement(Dfe,{className:ju(nt==null?void 0:nt.loader,(Yi=R==null?void 0:R.classNames)==null?void 0:Yi.loader),visible:ni==="loading"})}return Ce.createElement("li",{tabIndex:0,ref:_n,className:ju(Le,na,nt==null?void 0:nt.toast,(t=R==null?void 0:R.classNames)==null?void 0:t.toast,nt==null?void 0:nt.default,nt==null?void 0:nt[ni],(n=R==null?void 0:R.classNames)==null?void 0:n[ni]),"data-sonner-toast":"","data-rich-colors":(r=R.richColors)!=null?r:fe,"data-styled":!(R.jsx||R.unstyled||B),"data-mounted":Vt,"data-promise":!!R.promise,"data-swiped":Ar,"data-removed":Gt,"data-visible":vr,"data-y-position":Es,"data-x-position":ci,"data-index":q,"data-front":Gn,"data-swiping":hn,"data-dismissible":vi,"data-type":ni,"data-invert":pa,"data-swipe-out":In,"data-swipe-direction":en,"data-expanded":!!(te||Be&&Vt),style:{"--index":q,"--toasts-before":q,"--z-index":Q.length-q,"--offset":`${Gt?Vr:fo.current}px`,"--initial-height":Be?"auto":`${Pt}px`,...De,...R.style},onDragEnd:()=>{yt(!1),un(null),Ua.current=null},onPointerDown:Tt=>{Ps||!vi||(Mn.current=new Date,it(fo.current),Tt.target.setPointerCapture(Tt.pointerId),Tt.target.tagName!=="BUTTON"&&(yt(!0),Ua.current={x:Tt.clientX,y:Tt.clientY}))},onPointerUp:()=>{var Tt,pi,Yi,mt;if(In||!vi)return;Ua.current=null;let ae=Number(((Tt=_n.current)==null?void 0:Tt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),me=Number(((pi=_n.current)==null?void 0:pi.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Me=new Date().getTime()-((Yi=Mn.current)==null?void 0:Yi.getTime()),We=rn==="x"?ae:me,je=Math.abs(We)/Me;if(Math.abs(We)>=Qfe||je>.11){it(fo.current),(mt=R.onDismiss)==null||mt.call(R,R),sn(rn==="x"?ae>0?"right":"left":me>0?"down":"up"),es(),Kn(!0),_r(!1);return}yt(!1),un(null)},onPointerMove:Tt=>{var pi,Yi,mt,ae;if(!Ua.current||!vi||((pi=window.getSelection())==null?void 0:pi.toString().length)>0)return;let me=Tt.clientY-Ua.current.y,Me=Tt.clientX-Ua.current.x,We=(Yi=e.swipeDirections)!=null?Yi:tpe(ct);!rn&&(Math.abs(Me)>1||Math.abs(me)>1)&&un(Math.abs(Me)>Math.abs(me)?"x":"y");let je={x:0,y:0};rn==="y"?(We.includes("top")||We.includes("bottom"))&&(We.includes("top")&&me<0||We.includes("bottom")&&me>0)&&(je.y=me):rn==="x"&&(We.includes("left")||We.includes("right"))&&(We.includes("left")&&Me<0||We.includes("right")&&Me>0)&&(je.x=Me),(Math.abs(je.x)>0||Math.abs(je.y)>0)&&_r(!0),(mt=_n.current)==null||mt.style.setProperty("--swipe-amount-x",`${je.x}px`),(ae=_n.current)==null||ae.style.setProperty("--swipe-amount-y",`${je.y}px`)}},uo&&!R.jsx?Ce.createElement("button",{"aria-label":Mt,"data-disabled":Ps,"data-close-button":!0,onClick:Ps||!vi?()=>{}:()=>{var Tt;es(),(Tt=R.onDismiss)==null||Tt.call(R,R)},className:ju(nt==null?void 0:nt.closeButton,(a=R==null?void 0:R.classNames)==null?void 0:a.closeButton)},(c=at==null?void 0:at.close)!=null?c:Bfe):null,R.jsx||X.isValidElement(R.title)?R.jsx?R.jsx:typeof R.title=="function"?R.title():R.title:Ce.createElement(Ce.Fragment,null,ni||R.icon||R.promise?Ce.createElement("div",{"data-icon":"",className:ju(nt==null?void 0:nt.icon,(d=R==null?void 0:R.classNames)==null?void 0:d.icon)},R.promise||R.type==="loading"&&!R.icon?R.icon||Cl():null,R.type!=="loading"?R.icon||(at==null?void 0:at[ni])||kfe(ni):null):null,Ce.createElement("div",{"data-content":"",className:ju(nt==null?void 0:nt.content,(i=R==null?void 0:R.classNames)==null?void 0:i.content)},Ce.createElement("div",{"data-title":"",className:ju(nt==null?void 0:nt.title,(_=R==null?void 0:R.classNames)==null?void 0:_.title)},typeof R.title=="function"?R.title():R.title),R.description?Ce.createElement("div",{"data-description":"",className:ju(Ze,fa,nt==null?void 0:nt.description,(b=R==null?void 0:R.classNames)==null?void 0:b.description)},typeof R.description=="function"?R.description():R.description):null),X.isValidElement(R.cancel)?R.cancel:R.cancel&&VE(R.cancel)?Ce.createElement("button",{"data-button":!0,"data-cancel":!0,style:R.cancelButtonStyle||Ne,onClick:Tt=>{var pi,Yi;VE(R.cancel)&&vi&&((Yi=(pi=R.cancel).onClick)==null||Yi.call(pi,Tt),es())},className:ju(nt==null?void 0:nt.cancelButton,(T=R==null?void 0:R.classNames)==null?void 0:T.cancelButton)},R.cancel.label):null,X.isValidElement(R.action)?R.action:R.action&&VE(R.action)?Ce.createElement("button",{"data-button":!0,"data-action":!0,style:R.actionButtonStyle||Fe,onClick:Tt=>{var pi,Yi;VE(R.action)&&((Yi=(pi=R.action).onClick)==null||Yi.call(pi,Tt),!Tt.defaultPrevented&&es())},className:ju(nt==null?void 0:nt.actionButton,(A=R==null?void 0:R.classNames)==null?void 0:A.actionButton)},R.action.label):null))};function pV(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function rpe(e,t){let n={};return[e,t].forEach((r,a)=>{let c=a===1,d=c?"--mobile-offset":"--offset",i=c?Kfe:Xfe;function _(b){["top","right","bottom","left"].forEach(T=>{n[`${d}-${T}`]=typeof b=="number"?`${b}px`:b})}typeof r=="number"||typeof r=="string"?_(r):typeof r=="object"?["top","right","bottom","left"].forEach(b=>{r[b]===void 0?n[`${d}-${b}`]=i:n[`${d}-${b}`]=typeof r[b]=="number"?`${r[b]}px`:r[b]}):_(i)}),n}var yXe=X.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:c,closeButton:d,className:i,offset:_,mobileOffset:b,theme:T="light",richColors:A,duration:k,style:R,visibleToasts:B=Zfe,toastOptions:N,dir:V=pV(),gap:H=Jfe,loadingIcon:G,icons:q,containerAriaLabel:Q="Notifications",pauseWhenPageIsHidden:te}=e,[ue,fe]=Ce.useState([]),ye=Ce.useMemo(()=>Array.from(new Set([r].concat(ue.filter(Nt=>Nt.position).map(Nt=>Nt.position)))),[ue,r]),[De,Ne]=Ce.useState([]),[Fe,Le]=Ce.useState(!1),[Ze,He]=Ce.useState(!1),[ct,ot]=Ce.useState(T!=="system"?T:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),rt=Ce.useRef(null),Be=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),nt=Ce.useRef(null),at=Ce.useRef(!1),Mt=Ce.useCallback(Nt=>{fe(rn=>{var un;return(un=rn.find(en=>en.id===Nt.id))!=null&&un.delete||Gl.dismiss(Nt.id),rn.filter(({id:en})=>en!==Nt.id)})},[]);return Ce.useEffect(()=>Gl.subscribe(Nt=>{if(Nt.dismiss){fe(rn=>rn.map(un=>un.id===Nt.id?{...un,delete:!0}:un));return}setTimeout(()=>{uC.flushSync(()=>{fe(rn=>{let un=rn.findIndex(en=>en.id===Nt.id);return un!==-1?[...rn.slice(0,un),{...rn[un],...Nt},...rn.slice(un+1)]:[Nt,...rn]})})})}),[]),Ce.useEffect(()=>{if(T!=="system"){ot(T);return}if(T==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ot("dark"):ot("light")),typeof window>"u")return;let Nt=window.matchMedia("(prefers-color-scheme: dark)");try{Nt.addEventListener("change",({matches:rn})=>{ot(rn?"dark":"light")})}catch{Nt.addListener(({matches:un})=>{try{ot(un?"dark":"light")}catch(en){console.error(en)}})}},[T]),Ce.useEffect(()=>{ue.length<=1&&Le(!1)},[ue]),Ce.useEffect(()=>{let Nt=rn=>{var un,en;a.every(sn=>rn[sn]||rn.code===sn)&&(Le(!0),(un=rt.current)==null||un.focus()),rn.code==="Escape"&&(document.activeElement===rt.current||(en=rt.current)!=null&&en.contains(document.activeElement))&&Le(!1)};return document.addEventListener("keydown",Nt),()=>document.removeEventListener("keydown",Nt)},[a]),Ce.useEffect(()=>{if(rt.current)return()=>{nt.current&&(nt.current.focus({preventScroll:!0}),nt.current=null,at.current=!1)}},[rt.current]),Ce.createElement("section",{ref:t,"aria-label":`${Q} ${Be}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ye.map((Nt,rn)=>{var un;let[en,sn]=Nt.split("-");return ue.length?Ce.createElement("ol",{key:Nt,dir:V==="auto"?pV():V,tabIndex:-1,ref:rt,className:i,"data-sonner-toaster":!0,"data-theme":ct,"data-y-position":en,"data-lifted":Fe&&ue.length>1&&!c,"data-x-position":sn,style:{"--front-toast-height":`${((un=De[0])==null?void 0:un.height)||0}px`,"--width":`${Yfe}px`,"--gap":`${H}px`,...R,...rpe(_,b)},onBlur:Vt=>{at.current&&!Vt.currentTarget.contains(Vt.relatedTarget)&&(at.current=!1,nt.current&&(nt.current.focus({preventScroll:!0}),nt.current=null))},onFocus:Vt=>{Vt.target instanceof HTMLElement&&Vt.target.dataset.dismissible==="false"||at.current||(at.current=!0,nt.current=Vt.relatedTarget)},onMouseEnter:()=>Le(!0),onMouseMove:()=>Le(!0),onMouseLeave:()=>{Ze||Le(!1)},onDragEnd:()=>Le(!1),onPointerDown:Vt=>{Vt.target instanceof HTMLElement&&Vt.target.dataset.dismissible==="false"||He(!0)},onPointerUp:()=>He(!1)},ue.filter(Vt=>!Vt.position&&rn===0||Vt.position===Nt).map((Vt,$n)=>{var Gt,Tn;return Ce.createElement(npe,{key:Vt.id,icons:q,index:$n,toast:Vt,defaultRichColors:A,duration:(Gt=N==null?void 0:N.duration)!=null?Gt:k,className:N==null?void 0:N.className,descriptionClassName:N==null?void 0:N.descriptionClassName,invert:n,visibleToasts:B,closeButton:(Tn=N==null?void 0:N.closeButton)!=null?Tn:d,interacting:Ze,position:Nt,style:N==null?void 0:N.style,unstyled:N==null?void 0:N.unstyled,classNames:N==null?void 0:N.classNames,cancelButtonStyle:N==null?void 0:N.cancelButtonStyle,actionButtonStyle:N==null?void 0:N.actionButtonStyle,removeToast:Mt,toasts:ue.filter(hn=>hn.position==Vt.position),heights:De.filter(hn=>hn.position==Vt.position),setHeights:Ne,expandByDefault:c,gap:H,loadingIcon:G,expanded:Fe,pauseWhenPageIsHidden:te,swipeDirections:e.swipeDirections})})):null}))}),Ki;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const c={};for(const d of a)c[d]=d;return c},e.getValidEnumValues=a=>{const c=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),d={};for(const i of c)d[i]=a[i];return e.objectValues(d)},e.objectValues=a=>e.objectKeys(a).map(function(c){return a[c]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const c=[];for(const d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(d);return c},e.find=(a,c)=>{for(const d of a)if(c(d))return d},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,c=" | "){return a.map(d=>typeof d=="string"?`'${d}'`:d).join(c)}e.joinValues=r,e.jsonStringifyReplacer=(a,c)=>typeof c=="bigint"?c.toString():c})(Ki||(Ki={}));var RD;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(RD||(RD={}));const ir=Ki.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),kp=e=>{switch(typeof e){case"undefined":return ir.undefined;case"string":return ir.string;case"number":return isNaN(e)?ir.nan:ir.number;case"boolean":return ir.boolean;case"function":return ir.function;case"bigint":return ir.bigint;case"symbol":return ir.symbol;case"object":return Array.isArray(e)?ir.array:e===null?ir.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ir.promise:typeof Map<"u"&&e instanceof Map?ir.map:typeof Set<"u"&&e instanceof Set?ir.set:typeof Date<"u"&&e instanceof Date?ir.date:ir.object;default:return ir.unknown}},Dn=Ki.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ipe=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Oc extends Error{constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const n=t||function(c){return c.message},r={_errors:[]},a=c=>{for(const d of c.issues)if(d.code==="invalid_union")d.unionErrors.map(a);else if(d.code==="invalid_return_type")a(d.returnTypeError);else if(d.code==="invalid_arguments")a(d.argumentsError);else if(d.path.length===0)r._errors.push(n(d));else{let i=r,_=0;for(;_<d.path.length;){const b=d.path[_];_===d.path.length-1?(i[b]=i[b]||{_errors:[]},i[b]._errors.push(n(d))):i[b]=i[b]||{_errors:[]},i=i[b],_++}}};return a(this),r}static assert(t){if(!(t instanceof Oc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ki.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(t(a))):r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Oc.create=e=>new Oc(e);const Wv=(e,t)=>{let n;switch(e.code){case Dn.invalid_type:e.received===ir.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Dn.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ki.jsonStringifyReplacer)}`;break;case Dn.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ki.joinValues(e.keys,", ")}`;break;case Dn.invalid_union:n="Invalid input";break;case Dn.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ki.joinValues(e.options)}`;break;case Dn.invalid_enum_value:n=`Invalid enum value. Expected ${Ki.joinValues(e.options)}, received '${e.received}'`;break;case Dn.invalid_arguments:n="Invalid function arguments";break;case Dn.invalid_return_type:n="Invalid function return type";break;case Dn.invalid_date:n="Invalid date";break;case Dn.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ki.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Dn.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Dn.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Dn.custom:n="Invalid input";break;case Dn.invalid_intersection_types:n="Intersection results could not be merged";break;case Dn.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Dn.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ki.assertNever(e)}return{message:n}};let Wq=Wv;function ope(e){Wq=e}function dA(){return Wq}const fA=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,c=[...n,...a.path||[]],d={...a,path:c};if(a.message!==void 0)return{...a,path:c,message:a.message};let i="";const _=r.filter(b=>!!b).slice().reverse();for(const b of _)i=b(d,{data:t,defaultError:i}).message;return{...a,path:c,message:i}},ape=[];function Jn(e,t){const n=dA(),r=fA({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Wv?void 0:Wv].filter(a=>!!a)});e.common.issues.push(r)}class nl{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return Zr;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const c=await a.key,d=await a.value;r.push({key:c,value:d})}return nl.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:c,value:d}=a;if(c.status==="aborted"||d.status==="aborted")return Zr;c.status==="dirty"&&t.dirty(),d.status==="dirty"&&t.dirty(),c.value!=="__proto__"&&(typeof d.value<"u"||a.alwaysSet)&&(r[c.value]=d.value)}return{status:t.value,value:r}}}const Zr=Object.freeze({status:"aborted"}),mv=e=>({status:"dirty",value:e}),wl=e=>({status:"valid",value:e}),DD=e=>e.status==="aborted",LD=e=>e.status==="dirty",cw=e=>e.status==="valid",uw=e=>typeof Promise<"u"&&e instanceof Promise;function pA(e,t,n,r){if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Gq(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var Pr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Pr||(Pr={}));var sb,lb;class ed{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const mV=(e,t)=>{if(cw(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Oc(e.common.issues);return this._error=n,this._error}}};function yi(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(d,i)=>{var _,b;const{message:T}=e;return d.code==="invalid_enum_value"?{message:T??i.defaultError}:typeof i.data>"u"?{message:(_=T??r)!==null&&_!==void 0?_:i.defaultError}:d.code!=="invalid_type"?{message:i.defaultError}:{message:(b=T??n)!==null&&b!==void 0?b:i.defaultError}},description:a}}class Mi{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return kp(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:kp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new nl,ctx:{common:t.parent.common,data:t.data,parsedType:kp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(uw(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:kp(t)},c=this._parseSync({data:t,path:a.path,parent:a});return mV(a,c)}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:kp(t)},a=this._parse({data:t,path:r.path,parent:r}),c=await(uw(a)?a:Promise.resolve(a));return mV(r,c)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,c)=>{const d=t(a),i=()=>c.addIssue({code:Dn.custom,...r(a)});return typeof Promise<"u"&&d instanceof Promise?d.then(_=>_?!0:(i(),!1)):d?!0:(i(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new sh({schema:this,typeName:Ur.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return Yh.create(this,this._def)}nullable(){return sm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nh.create(this,this._def)}promise(){return Hv.create(this,this._def)}or(t){return pw.create([this,t],this._def)}and(t){return mw.create(this,t,this._def)}transform(t){return new sh({...yi(this._def),schema:this,typeName:Ur.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new xw({...yi(this._def),innerType:this,defaultValue:n,typeName:Ur.ZodDefault})}brand(){return new Q3({typeName:Ur.ZodBranded,type:this,...yi(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new bw({...yi(this._def),innerType:this,catchValue:n,typeName:Ur.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return bS.create(this,t)}readonly(){return ww.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const spe=/^c[^\s-]{8,}$/i,lpe=/^[0-9a-z]+$/,cpe=/^[0-9A-HJKMNP-TV-Z]{26}$/,upe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,hpe=/^[a-z0-9_-]{21}$/i,dpe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,fpe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ppe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vk;const mpe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,gpe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,_pe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Hq="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ype=new RegExp(`^${Hq}$`);function qq(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function vpe(e){return new RegExp(`^${qq(e)}$`)}function Zq(e){let t=`${Hq}T${qq(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function xpe(e,t){return!!((t==="v4"||!t)&&mpe.test(e)||(t==="v6"||!t)&&gpe.test(e))}class Qu extends Mi{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ir.string){const c=this._getOrReturnCtx(t);return Jn(c,{code:Dn.invalid_type,expected:ir.string,received:c.parsedType}),Zr}const r=new nl;let a;for(const c of this._def.checks)if(c.kind==="min")t.data.length<c.value&&(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),r.dirty());else if(c.kind==="max")t.data.length>c.value&&(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),r.dirty());else if(c.kind==="length"){const d=t.data.length>c.value,i=t.data.length<c.value;(d||i)&&(a=this._getOrReturnCtx(t,a),d?Jn(a,{code:Dn.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):i&&Jn(a,{code:Dn.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),r.dirty())}else if(c.kind==="email")fpe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"email",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="emoji")vk||(vk=new RegExp(ppe,"u")),vk.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"emoji",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="uuid")upe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"uuid",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="nanoid")hpe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"nanoid",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="cuid")spe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"cuid",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="cuid2")lpe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"cuid2",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="ulid")cpe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"ulid",code:Dn.invalid_string,message:c.message}),r.dirty());else if(c.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Jn(a,{validation:"url",code:Dn.invalid_string,message:c.message}),r.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"regex",code:Dn.invalid_string,message:c.message}),r.dirty())):c.kind==="trim"?t.data=t.data.trim():c.kind==="includes"?t.data.includes(c.value,c.position)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),r.dirty()):c.kind==="toLowerCase"?t.data=t.data.toLowerCase():c.kind==="toUpperCase"?t.data=t.data.toUpperCase():c.kind==="startsWith"?t.data.startsWith(c.value)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:{startsWith:c.value},message:c.message}),r.dirty()):c.kind==="endsWith"?t.data.endsWith(c.value)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:{endsWith:c.value},message:c.message}),r.dirty()):c.kind==="datetime"?Zq(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:"datetime",message:c.message}),r.dirty()):c.kind==="date"?ype.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:"date",message:c.message}),r.dirty()):c.kind==="time"?vpe(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.invalid_string,validation:"time",message:c.message}),r.dirty()):c.kind==="duration"?dpe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"duration",code:Dn.invalid_string,message:c.message}),r.dirty()):c.kind==="ip"?xpe(t.data,c.version)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"ip",code:Dn.invalid_string,message:c.message}),r.dirty()):c.kind==="base64"?_pe.test(t.data)||(a=this._getOrReturnCtx(t,a),Jn(a,{validation:"base64",code:Dn.invalid_string,message:c.message}),r.dirty()):Ki.assertNever(c);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:Dn.invalid_string,...Pr.errToObj(r)})}_addCheck(t){return new Qu({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Pr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Pr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Pr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Pr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Pr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Pr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Pr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Pr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Pr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Pr.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,...Pr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Pr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Pr.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Pr.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Pr.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Pr.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Pr.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Pr.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Pr.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Pr.errToObj(n)})}nonempty(t){return this.min(1,Pr.errToObj(t))}trim(){return new Qu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Qu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Qu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Qu.create=e=>{var t;return new Qu({checks:[],typeName:Ur.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...yi(e)})};function bpe(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,c=parseInt(e.toFixed(a).replace(".","")),d=parseInt(t.toFixed(a).replace(".",""));return c%d/Math.pow(10,a)}class im extends Mi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ir.number){const c=this._getOrReturnCtx(t);return Jn(c,{code:Dn.invalid_type,expected:ir.number,received:c.parsedType}),Zr}let r;const a=new nl;for(const c of this._def.checks)c.kind==="int"?Ki.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.invalid_type,expected:"integer",received:"float",message:c.message}),a.dirty()):c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="multipleOf"?bpe(t.data,c.value)!==0&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):c.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.not_finite,message:c.message}),a.dirty()):Ki.assertNever(c);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Pr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Pr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Pr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Pr.toString(n))}setLimit(t,n,r,a){return new im({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Pr.toString(a)}]})}_addCheck(t){return new im({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Pr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Pr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Pr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Pr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Pr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Pr.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Pr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Pr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Pr.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ki.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}im.create=e=>new im({checks:[],typeName:Ur.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...yi(e)});class om extends Mi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==ir.bigint){const c=this._getOrReturnCtx(t);return Jn(c,{code:Dn.invalid_type,expected:ir.bigint,received:c.parsedType}),Zr}let r;const a=new nl;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="multipleOf"?t.data%c.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Jn(r,{code:Dn.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):Ki.assertNever(c);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Pr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Pr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Pr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Pr.toString(n))}setLimit(t,n,r,a){return new om({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Pr.toString(a)}]})}_addCheck(t){return new om({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Pr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Pr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Pr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Pr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Pr.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}om.create=e=>{var t;return new om({checks:[],typeName:Ur.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...yi(e)})};class hw extends Mi{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ir.boolean){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.boolean,received:r.parsedType}),Zr}return wl(t.data)}}hw.create=e=>new hw({typeName:Ur.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...yi(e)});class r_ extends Mi{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ir.date){const c=this._getOrReturnCtx(t);return Jn(c,{code:Dn.invalid_type,expected:ir.date,received:c.parsedType}),Zr}if(isNaN(t.data.getTime())){const c=this._getOrReturnCtx(t);return Jn(c,{code:Dn.invalid_date}),Zr}const r=new nl;let a;for(const c of this._def.checks)c.kind==="min"?t.data.getTime()<c.value&&(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),r.dirty()):c.kind==="max"?t.data.getTime()>c.value&&(a=this._getOrReturnCtx(t,a),Jn(a,{code:Dn.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),r.dirty()):Ki.assertNever(c);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new r_({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Pr.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Pr.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}r_.create=e=>new r_({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Ur.ZodDate,...yi(e)});class mA extends Mi{_parse(t){if(this._getType(t)!==ir.symbol){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.symbol,received:r.parsedType}),Zr}return wl(t.data)}}mA.create=e=>new mA({typeName:Ur.ZodSymbol,...yi(e)});class dw extends Mi{_parse(t){if(this._getType(t)!==ir.undefined){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.undefined,received:r.parsedType}),Zr}return wl(t.data)}}dw.create=e=>new dw({typeName:Ur.ZodUndefined,...yi(e)});class fw extends Mi{_parse(t){if(this._getType(t)!==ir.null){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.null,received:r.parsedType}),Zr}return wl(t.data)}}fw.create=e=>new fw({typeName:Ur.ZodNull,...yi(e)});class Gv extends Mi{constructor(){super(...arguments),this._any=!0}_parse(t){return wl(t.data)}}Gv.create=e=>new Gv({typeName:Ur.ZodAny,...yi(e)});class Xg extends Mi{constructor(){super(...arguments),this._unknown=!0}_parse(t){return wl(t.data)}}Xg.create=e=>new Xg({typeName:Ur.ZodUnknown,...yi(e)});class ff extends Mi{_parse(t){const n=this._getOrReturnCtx(t);return Jn(n,{code:Dn.invalid_type,expected:ir.never,received:n.parsedType}),Zr}}ff.create=e=>new ff({typeName:Ur.ZodNever,...yi(e)});class gA extends Mi{_parse(t){if(this._getType(t)!==ir.undefined){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.void,received:r.parsedType}),Zr}return wl(t.data)}}gA.create=e=>new gA({typeName:Ur.ZodVoid,...yi(e)});class nh extends Mi{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==ir.array)return Jn(n,{code:Dn.invalid_type,expected:ir.array,received:n.parsedType}),Zr;if(a.exactLength!==null){const d=n.data.length>a.exactLength.value,i=n.data.length<a.exactLength.value;(d||i)&&(Jn(n,{code:d?Dn.too_big:Dn.too_small,minimum:i?a.exactLength.value:void 0,maximum:d?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Jn(n,{code:Dn.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Jn(n,{code:Dn.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((d,i)=>a.type._parseAsync(new ed(n,d,n.path,i)))).then(d=>nl.mergeArray(r,d));const c=[...n.data].map((d,i)=>a.type._parseSync(new ed(n,d,n.path,i)));return nl.mergeArray(r,c)}get element(){return this._def.type}min(t,n){return new nh({...this._def,minLength:{value:t,message:Pr.toString(n)}})}max(t,n){return new nh({...this._def,maxLength:{value:t,message:Pr.toString(n)}})}length(t,n){return new nh({...this._def,exactLength:{value:t,message:Pr.toString(n)}})}nonempty(t){return this.min(1,t)}}nh.create=(e,t)=>new nh({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Ur.ZodArray,...yi(t)});function nv(e){if(e instanceof sa){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Yh.create(nv(r))}return new sa({...e._def,shape:()=>t})}else return e instanceof nh?new nh({...e._def,type:nv(e.element)}):e instanceof Yh?Yh.create(nv(e.unwrap())):e instanceof sm?sm.create(nv(e.unwrap())):e instanceof td?td.create(e.items.map(t=>nv(t))):e}class sa extends Mi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Ki.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==ir.object){const b=this._getOrReturnCtx(t);return Jn(b,{code:Dn.invalid_type,expected:ir.object,received:b.parsedType}),Zr}const{status:r,ctx:a}=this._processInputParams(t),{shape:c,keys:d}=this._getCached(),i=[];if(!(this._def.catchall instanceof ff&&this._def.unknownKeys==="strip"))for(const b in a.data)d.includes(b)||i.push(b);const _=[];for(const b of d){const T=c[b],A=a.data[b];_.push({key:{status:"valid",value:b},value:T._parse(new ed(a,A,a.path,b)),alwaysSet:b in a.data})}if(this._def.catchall instanceof ff){const b=this._def.unknownKeys;if(b==="passthrough")for(const T of i)_.push({key:{status:"valid",value:T},value:{status:"valid",value:a.data[T]}});else if(b==="strict")i.length>0&&(Jn(a,{code:Dn.unrecognized_keys,keys:i}),r.dirty());else if(b!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const b=this._def.catchall;for(const T of i){const A=a.data[T];_.push({key:{status:"valid",value:T},value:b._parse(new ed(a,A,a.path,T)),alwaysSet:T in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const b=[];for(const T of _){const A=await T.key,k=await T.value;b.push({key:A,value:k,alwaysSet:T.alwaysSet})}return b}).then(b=>nl.mergeObjectSync(r,b)):nl.mergeObjectSync(r,_)}get shape(){return this._def.shape()}strict(t){return Pr.errToObj,new sa({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var a,c,d,i;const _=(d=(c=(a=this._def).errorMap)===null||c===void 0?void 0:c.call(a,n,r).message)!==null&&d!==void 0?d:r.defaultError;return n.code==="unrecognized_keys"?{message:(i=Pr.errToObj(t).message)!==null&&i!==void 0?i:_}:{message:_}}}:{}})}strip(){return new sa({...this._def,unknownKeys:"strip"})}passthrough(){return new sa({...this._def,unknownKeys:"passthrough"})}extend(t){return new sa({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new sa({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Ur.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new sa({...this._def,catchall:t})}pick(t){const n={};return Ki.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new sa({...this._def,shape:()=>n})}omit(t){const n={};return Ki.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new sa({...this._def,shape:()=>n})}deepPartial(){return nv(this)}partial(t){const n={};return Ki.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}),new sa({...this._def,shape:()=>n})}required(t){const n={};return Ki.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let c=this.shape[r];for(;c instanceof Yh;)c=c._def.innerType;n[r]=c}}),new sa({...this._def,shape:()=>n})}keyof(){return Xq(Ki.objectKeys(this.shape))}}sa.create=(e,t)=>new sa({shape:()=>e,unknownKeys:"strip",catchall:ff.create(),typeName:Ur.ZodObject,...yi(t)});sa.strictCreate=(e,t)=>new sa({shape:()=>e,unknownKeys:"strict",catchall:ff.create(),typeName:Ur.ZodObject,...yi(t)});sa.lazycreate=(e,t)=>new sa({shape:e,unknownKeys:"strip",catchall:ff.create(),typeName:Ur.ZodObject,...yi(t)});class pw extends Mi{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(c){for(const i of c)if(i.result.status==="valid")return i.result;for(const i of c)if(i.result.status==="dirty")return n.common.issues.push(...i.ctx.common.issues),i.result;const d=c.map(i=>new Oc(i.ctx.common.issues));return Jn(n,{code:Dn.invalid_union,unionErrors:d}),Zr}if(n.common.async)return Promise.all(r.map(async c=>{const d={...n,common:{...n.common,issues:[]},parent:null};return{result:await c._parseAsync({data:n.data,path:n.path,parent:d}),ctx:d}})).then(a);{let c;const d=[];for(const _ of r){const b={...n,common:{...n.common,issues:[]},parent:null},T=_._parseSync({data:n.data,path:n.path,parent:b});if(T.status==="valid")return T;T.status==="dirty"&&!c&&(c={result:T,ctx:b}),b.common.issues.length&&d.push(b.common.issues)}if(c)return n.common.issues.push(...c.ctx.common.issues),c.result;const i=d.map(_=>new Oc(_));return Jn(n,{code:Dn.invalid_union,unionErrors:i}),Zr}}get options(){return this._def.options}}pw.create=(e,t)=>new pw({options:e,typeName:Ur.ZodUnion,...yi(t)});const Hd=e=>e instanceof _w?Hd(e.schema):e instanceof sh?Hd(e.innerType()):e instanceof yw?[e.value]:e instanceof am?e.options:e instanceof vw?Ki.objectValues(e.enum):e instanceof xw?Hd(e._def.innerType):e instanceof dw?[void 0]:e instanceof fw?[null]:e instanceof Yh?[void 0,...Hd(e.unwrap())]:e instanceof sm?[null,...Hd(e.unwrap())]:e instanceof Q3||e instanceof ww?Hd(e.unwrap()):e instanceof bw?Hd(e._def.innerType):[];class vC extends Mi{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ir.object)return Jn(n,{code:Dn.invalid_type,expected:ir.object,received:n.parsedType}),Zr;const r=this.discriminator,a=n.data[r],c=this.optionsMap.get(a);return c?n.common.async?c._parseAsync({data:n.data,path:n.path,parent:n}):c._parseSync({data:n.data,path:n.path,parent:n}):(Jn(n,{code:Dn.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Zr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const a=new Map;for(const c of n){const d=Hd(c.shape[t]);if(!d.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of d){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,c)}}return new vC({typeName:Ur.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:a,...yi(r)})}}function zD(e,t){const n=kp(e),r=kp(t);if(e===t)return{valid:!0,data:e};if(n===ir.object&&r===ir.object){const a=Ki.objectKeys(t),c=Ki.objectKeys(e).filter(i=>a.indexOf(i)!==-1),d={...e,...t};for(const i of c){const _=zD(e[i],t[i]);if(!_.valid)return{valid:!1};d[i]=_.data}return{valid:!0,data:d}}else if(n===ir.array&&r===ir.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let c=0;c<e.length;c++){const d=e[c],i=t[c],_=zD(d,i);if(!_.valid)return{valid:!1};a.push(_.data)}return{valid:!0,data:a}}else return n===ir.date&&r===ir.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class mw extends Mi{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(c,d)=>{if(DD(c)||DD(d))return Zr;const i=zD(c.value,d.value);return i.valid?((LD(c)||LD(d))&&n.dirty(),{status:n.value,value:i.data}):(Jn(r,{code:Dn.invalid_intersection_types}),Zr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([c,d])=>a(c,d)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}mw.create=(e,t,n)=>new mw({left:e,right:t,typeName:Ur.ZodIntersection,...yi(n)});class td extends Mi{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ir.array)return Jn(r,{code:Dn.invalid_type,expected:ir.array,received:r.parsedType}),Zr;if(r.data.length<this._def.items.length)return Jn(r,{code:Dn.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Zr;!this._def.rest&&r.data.length>this._def.items.length&&(Jn(r,{code:Dn.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const c=[...r.data].map((d,i)=>{const _=this._def.items[i]||this._def.rest;return _?_._parse(new ed(r,d,r.path,i)):null}).filter(d=>!!d);return r.common.async?Promise.all(c).then(d=>nl.mergeArray(n,d)):nl.mergeArray(n,c)}get items(){return this._def.items}rest(t){return new td({...this._def,rest:t})}}td.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new td({items:e,typeName:Ur.ZodTuple,rest:null,...yi(t)})};class gw extends Mi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ir.object)return Jn(r,{code:Dn.invalid_type,expected:ir.object,received:r.parsedType}),Zr;const a=[],c=this._def.keyType,d=this._def.valueType;for(const i in r.data)a.push({key:c._parse(new ed(r,i,r.path,i)),value:d._parse(new ed(r,r.data[i],r.path,i)),alwaysSet:i in r.data});return r.common.async?nl.mergeObjectAsync(n,a):nl.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Mi?new gw({keyType:t,valueType:n,typeName:Ur.ZodRecord,...yi(r)}):new gw({keyType:Qu.create(),valueType:t,typeName:Ur.ZodRecord,...yi(n)})}}class _A extends Mi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ir.map)return Jn(r,{code:Dn.invalid_type,expected:ir.map,received:r.parsedType}),Zr;const a=this._def.keyType,c=this._def.valueType,d=[...r.data.entries()].map(([i,_],b)=>({key:a._parse(new ed(r,i,r.path,[b,"key"])),value:c._parse(new ed(r,_,r.path,[b,"value"]))}));if(r.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const _ of d){const b=await _.key,T=await _.value;if(b.status==="aborted"||T.status==="aborted")return Zr;(b.status==="dirty"||T.status==="dirty")&&n.dirty(),i.set(b.value,T.value)}return{status:n.value,value:i}})}else{const i=new Map;for(const _ of d){const b=_.key,T=_.value;if(b.status==="aborted"||T.status==="aborted")return Zr;(b.status==="dirty"||T.status==="dirty")&&n.dirty(),i.set(b.value,T.value)}return{status:n.value,value:i}}}}_A.create=(e,t,n)=>new _A({valueType:t,keyType:e,typeName:Ur.ZodMap,...yi(n)});class i_ extends Mi{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ir.set)return Jn(r,{code:Dn.invalid_type,expected:ir.set,received:r.parsedType}),Zr;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Jn(r,{code:Dn.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Jn(r,{code:Dn.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const c=this._def.valueType;function d(_){const b=new Set;for(const T of _){if(T.status==="aborted")return Zr;T.status==="dirty"&&n.dirty(),b.add(T.value)}return{status:n.value,value:b}}const i=[...r.data.values()].map((_,b)=>c._parse(new ed(r,_,r.path,b)));return r.common.async?Promise.all(i).then(_=>d(_)):d(i)}min(t,n){return new i_({...this._def,minSize:{value:t,message:Pr.toString(n)}})}max(t,n){return new i_({...this._def,maxSize:{value:t,message:Pr.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}i_.create=(e,t)=>new i_({valueType:e,minSize:null,maxSize:null,typeName:Ur.ZodSet,...yi(t)});class Pv extends Mi{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ir.function)return Jn(n,{code:Dn.invalid_type,expected:ir.function,received:n.parsedType}),Zr;function r(i,_){return fA({data:i,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,dA(),Wv].filter(b=>!!b),issueData:{code:Dn.invalid_arguments,argumentsError:_}})}function a(i,_){return fA({data:i,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,dA(),Wv].filter(b=>!!b),issueData:{code:Dn.invalid_return_type,returnTypeError:_}})}const c={errorMap:n.common.contextualErrorMap},d=n.data;if(this._def.returns instanceof Hv){const i=this;return wl(async function(..._){const b=new Oc([]),T=await i._def.args.parseAsync(_,c).catch(R=>{throw b.addIssue(r(_,R)),b}),A=await Reflect.apply(d,this,T);return await i._def.returns._def.type.parseAsync(A,c).catch(R=>{throw b.addIssue(a(A,R)),b})})}else{const i=this;return wl(function(..._){const b=i._def.args.safeParse(_,c);if(!b.success)throw new Oc([r(_,b.error)]);const T=Reflect.apply(d,this,b.data),A=i._def.returns.safeParse(T,c);if(!A.success)throw new Oc([a(T,A.error)]);return A.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Pv({...this._def,args:td.create(t).rest(Xg.create())})}returns(t){return new Pv({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new Pv({args:t||td.create([]).rest(Xg.create()),returns:n||Xg.create(),typeName:Ur.ZodFunction,...yi(r)})}}class _w extends Mi{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}_w.create=(e,t)=>new _w({getter:e,typeName:Ur.ZodLazy,...yi(t)});class yw extends Mi{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Jn(n,{received:n.data,code:Dn.invalid_literal,expected:this._def.value}),Zr}return{status:"valid",value:t.data}}get value(){return this._def.value}}yw.create=(e,t)=>new yw({value:e,typeName:Ur.ZodLiteral,...yi(t)});function Xq(e,t){return new am({values:e,typeName:Ur.ZodEnum,...yi(t)})}class am extends Mi{constructor(){super(...arguments),sb.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Jn(n,{expected:Ki.joinValues(r),received:n.parsedType,code:Dn.invalid_type}),Zr}if(pA(this,sb)||Gq(this,sb,new Set(this._def.values)),!pA(this,sb).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Jn(n,{received:n.data,code:Dn.invalid_enum_value,options:r}),Zr}return wl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return am.create(t,{...this._def,...n})}exclude(t,n=this._def){return am.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}sb=new WeakMap;am.create=Xq;class vw extends Mi{constructor(){super(...arguments),lb.set(this,void 0)}_parse(t){const n=Ki.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==ir.string&&r.parsedType!==ir.number){const a=Ki.objectValues(n);return Jn(r,{expected:Ki.joinValues(a),received:r.parsedType,code:Dn.invalid_type}),Zr}if(pA(this,lb)||Gq(this,lb,new Set(Ki.getValidEnumValues(this._def.values))),!pA(this,lb).has(t.data)){const a=Ki.objectValues(n);return Jn(r,{received:r.data,code:Dn.invalid_enum_value,options:a}),Zr}return wl(t.data)}get enum(){return this._def.values}}lb=new WeakMap;vw.create=(e,t)=>new vw({values:e,typeName:Ur.ZodNativeEnum,...yi(t)});class Hv extends Mi{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ir.promise&&n.common.async===!1)return Jn(n,{code:Dn.invalid_type,expected:ir.promise,received:n.parsedType}),Zr;const r=n.parsedType===ir.promise?n.data:Promise.resolve(n.data);return wl(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Hv.create=(e,t)=>new Hv({type:e,typeName:Ur.ZodPromise,...yi(t)});class sh extends Mi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ur.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,c={addIssue:d=>{Jn(r,d),d.fatal?n.abort():n.dirty()},get path(){return r.path}};if(c.addIssue=c.addIssue.bind(c),a.type==="preprocess"){const d=a.transform(r.data,c);if(r.common.async)return Promise.resolve(d).then(async i=>{if(n.value==="aborted")return Zr;const _=await this._def.schema._parseAsync({data:i,path:r.path,parent:r});return _.status==="aborted"?Zr:_.status==="dirty"||n.value==="dirty"?mv(_.value):_});{if(n.value==="aborted")return Zr;const i=this._def.schema._parseSync({data:d,path:r.path,parent:r});return i.status==="aborted"?Zr:i.status==="dirty"||n.value==="dirty"?mv(i.value):i}}if(a.type==="refinement"){const d=i=>{const _=a.refinement(i,c);if(r.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Zr:(i.status==="dirty"&&n.dirty(),d(i.value),{status:n.value,value:i.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>i.status==="aborted"?Zr:(i.status==="dirty"&&n.dirty(),d(i.value).then(()=>({status:n.value,value:i.value}))))}if(a.type==="transform")if(r.common.async===!1){const d=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!cw(d))return d;const i=a.transform(d.value,c);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:i}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(d=>cw(d)?Promise.resolve(a.transform(d.value,c)).then(i=>({status:n.value,value:i})):d);Ki.assertNever(a)}}sh.create=(e,t,n)=>new sh({schema:e,typeName:Ur.ZodEffects,effect:t,...yi(n)});sh.createWithPreprocess=(e,t,n)=>new sh({schema:t,effect:{type:"preprocess",transform:e},typeName:Ur.ZodEffects,...yi(n)});class Yh extends Mi{_parse(t){return this._getType(t)===ir.undefined?wl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Yh.create=(e,t)=>new Yh({innerType:e,typeName:Ur.ZodOptional,...yi(t)});class sm extends Mi{_parse(t){return this._getType(t)===ir.null?wl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}sm.create=(e,t)=>new sm({innerType:e,typeName:Ur.ZodNullable,...yi(t)});class xw extends Mi{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===ir.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}xw.create=(e,t)=>new xw({innerType:e,typeName:Ur.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...yi(t)});class bw extends Mi{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return uw(a)?a.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}bw.create=(e,t)=>new bw({innerType:e,typeName:Ur.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...yi(t)});class yA extends Mi{_parse(t){if(this._getType(t)!==ir.nan){const r=this._getOrReturnCtx(t);return Jn(r,{code:Dn.invalid_type,expected:ir.nan,received:r.parsedType}),Zr}return{status:"valid",value:t.data}}}yA.create=e=>new yA({typeName:Ur.ZodNaN,...yi(e)});const wpe=Symbol("zod_brand");class Q3 extends Mi{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class bS extends Mi{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Zr:c.status==="dirty"?(n.dirty(),mv(c.value)):this._def.out._parseAsync({data:c.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Zr:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new bS({in:t,out:n,typeName:Ur.ZodPipeline})}}class ww extends Mi{_parse(t){const n=this._def.innerType._parse(t),r=a=>(cw(a)&&(a.value=Object.freeze(a.value)),a);return uw(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}ww.create=(e,t)=>new ww({innerType:e,typeName:Ur.ZodReadonly,...yi(t)});function Kq(e,t={},n){return e?Gv.create().superRefine((r,a)=>{var c,d;if(!e(r)){const i=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,_=(d=(c=i.fatal)!==null&&c!==void 0?c:n)!==null&&d!==void 0?d:!0,b=typeof i=="string"?{message:i}:i;a.addIssue({code:"custom",...b,fatal:_})}}):Gv.create()}const Spe={object:sa.lazycreate};var Ur;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Ur||(Ur={}));const Tpe=(e,t={message:`Input not instance of ${e.name}`})=>Kq(n=>n instanceof e,t),Yq=Qu.create,Jq=im.create,Epe=yA.create,Ape=om.create,Qq=hw.create,Ppe=r_.create,Cpe=mA.create,Ipe=dw.create,Mpe=fw.create,Ope=Gv.create,kpe=Xg.create,Rpe=ff.create,Dpe=gA.create,Lpe=nh.create,zpe=sa.create,Npe=sa.strictCreate,Fpe=pw.create,Bpe=vC.create,jpe=mw.create,$pe=td.create,Upe=gw.create,Vpe=_A.create,Wpe=i_.create,Gpe=Pv.create,Hpe=_w.create,qpe=yw.create,Zpe=am.create,Xpe=vw.create,Kpe=Hv.create,gV=sh.create,Ype=Yh.create,Jpe=sm.create,Qpe=sh.createWithPreprocess,eme=bS.create,tme=()=>Yq().optional(),nme=()=>Jq().optional(),rme=()=>Qq().optional(),ime={string:e=>Qu.create({...e,coerce:!0}),number:e=>im.create({...e,coerce:!0}),boolean:e=>hw.create({...e,coerce:!0}),bigint:e=>om.create({...e,coerce:!0}),date:e=>r_.create({...e,coerce:!0})},ome=Zr;var vXe=Object.freeze({__proto__:null,defaultErrorMap:Wv,setErrorMap:ope,getErrorMap:dA,makeIssue:fA,EMPTY_PATH:ape,addIssueToContext:Jn,ParseStatus:nl,INVALID:Zr,DIRTY:mv,OK:wl,isAborted:DD,isDirty:LD,isValid:cw,isAsync:uw,get util(){return Ki},get objectUtil(){return RD},ZodParsedType:ir,getParsedType:kp,ZodType:Mi,datetimeRegex:Zq,ZodString:Qu,ZodNumber:im,ZodBigInt:om,ZodBoolean:hw,ZodDate:r_,ZodSymbol:mA,ZodUndefined:dw,ZodNull:fw,ZodAny:Gv,ZodUnknown:Xg,ZodNever:ff,ZodVoid:gA,ZodArray:nh,ZodObject:sa,ZodUnion:pw,ZodDiscriminatedUnion:vC,ZodIntersection:mw,ZodTuple:td,ZodRecord:gw,ZodMap:_A,ZodSet:i_,ZodFunction:Pv,ZodLazy:_w,ZodLiteral:yw,ZodEnum:am,ZodNativeEnum:vw,ZodPromise:Hv,ZodEffects:sh,ZodTransformer:sh,ZodOptional:Yh,ZodNullable:sm,ZodDefault:xw,ZodCatch:bw,ZodNaN:yA,BRAND:wpe,ZodBranded:Q3,ZodPipeline:bS,ZodReadonly:ww,custom:Kq,Schema:Mi,ZodSchema:Mi,late:Spe,get ZodFirstPartyTypeKind(){return Ur},coerce:ime,any:Ope,array:Lpe,bigint:Ape,boolean:Qq,date:Ppe,discriminatedUnion:Bpe,effect:gV,enum:Zpe,function:Gpe,instanceof:Tpe,intersection:jpe,lazy:Hpe,literal:qpe,map:Vpe,nan:Epe,nativeEnum:Xpe,never:Rpe,null:Mpe,nullable:Jpe,number:Jq,object:zpe,oboolean:rme,onumber:nme,optional:Ype,ostring:tme,pipeline:eme,preprocess:Qpe,promise:Kpe,record:Upe,set:Wpe,strictObject:Npe,string:Yq,symbol:Cpe,transformer:gV,tuple:$pe,undefined:Ipe,union:Fpe,unknown:kpe,void:Dpe,NEVER:ome,ZodIssueCode:Dn,quotelessJson:ipe,ZodError:Oc});function ame(e,t){const n=X.createContext(t),r=c=>{const{children:d,...i}=c,_=X.useMemo(()=>i,Object.values(i));return _e.jsx(n.Provider,{value:_,children:d})};r.displayName=e+"Provider";function a(c){const d=X.useContext(n);if(d)return d;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[r,a]}function Al(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];const b=A=>{var H;const{scope:k,children:R,...B}=A,N=((H=k==null?void 0:k[e])==null?void 0:H[_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})};b.displayName=c+"Provider";function T(A,k){var N;const R=((N=k==null?void 0:k[e])==null?void 0:N[_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,sme(a,...t)]}function sme(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}function Co(e){const t=X.useRef(e);return X.useEffect(()=>{t.current=e}),X.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}var Ea=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},lme=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Qn=lme.reduce((e,t)=>{const n=X.forwardRef((r,a)=>{const{asChild:c,...d}=r,i=c?rm:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_e.jsx(i,{...d,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function vA(e,t){e&&ym.flushSync(()=>e.dispatchEvent(t))}var eN="Avatar",[cme,xXe]=Al(eN),[ume,eZ]=cme(eN),tZ=X.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,c]=X.useState("idle");return _e.jsx(ume,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:c,children:_e.jsx(Qn.span,{...r,ref:t})})});tZ.displayName=eN;var nZ="AvatarImage",rZ=X.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...c}=e,d=eZ(nZ,n),i=hme(r,c.referrerPolicy),_=Co(b=>{a(b),d.onImageLoadingStatusChange(b)});return Ea(()=>{i!=="idle"&&_(i)},[i,_]),i==="loaded"?_e.jsx(Qn.img,{...c,ref:t,src:r}):null});rZ.displayName=nZ;var iZ="AvatarFallback",oZ=X.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,c=eZ(iZ,n),[d,i]=X.useState(r===void 0);return X.useEffect(()=>{if(r!==void 0){const _=window.setTimeout(()=>i(!0),r);return()=>window.clearTimeout(_)}},[r]),d&&c.imageLoadingStatus!=="loaded"?_e.jsx(Qn.span,{...a,ref:t}):null});oZ.displayName=iZ;function hme(e,t){const[n,r]=X.useState("idle");return Ea(()=>{if(!e){r("error");return}let a=!0;const c=new window.Image,d=i=>()=>{a&&r(i)};return r("loading"),c.onload=d("loaded"),c.onerror=d("error"),c.src=e,t&&(c.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var bXe=tZ,wXe=rZ,SXe=oZ;function On(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Sl({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,a]=dme({defaultProp:t,onChange:n}),c=e!==void 0,d=c?e:r,i=Co(n),_=X.useCallback(b=>{if(c){const A=typeof b=="function"?b(e):b;A!==e&&i(A)}else a(b)},[c,e,a,i]);return[d,_]}function dme({defaultProp:e,onChange:t}){const n=X.useState(e),[r]=n,a=X.useRef(r),c=Co(t);return X.useEffect(()=>{a.current!==r&&(c(r),a.current=r)},[r,a,c]),n}function fme(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];function b(A){const{scope:k,children:R,...B}=A,N=(k==null?void 0:k[e][_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})}function T(A,k){const R=(k==null?void 0:k[e][_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,pme(a,...t)]}function pme(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}function $0(e){const t=e+"CollectionProvider",[n,r]=fme(t),[a,c]=n(t,{collectionRef:{current:null},itemMap:new Map}),d=R=>{const{scope:B,children:N}=R,V=Ce.useRef(null),H=Ce.useRef(new Map).current;return _e.jsx(a,{scope:B,itemMap:H,collectionRef:V,children:N})};d.displayName=t;const i=e+"CollectionSlot",_=Ce.forwardRef((R,B)=>{const{scope:N,children:V}=R,H=c(i,N),G=Xr(B,H.collectionRef);return _e.jsx(rm,{ref:G,children:V})});_.displayName=i;const b=e+"CollectionItemSlot",T="data-radix-collection-item",A=Ce.forwardRef((R,B)=>{const{scope:N,children:V,...H}=R,G=Ce.useRef(null),q=Xr(B,G),Q=c(b,N);return Ce.useEffect(()=>(Q.itemMap.set(G,{ref:G,...H}),()=>void Q.itemMap.delete(G))),_e.jsx(rm,{[T]:"",ref:q,children:V})});A.displayName=b;function k(R){const B=c(e+"CollectionConsumer",R);return Ce.useCallback(()=>{const V=B.collectionRef.current;if(!V)return[];const H=Array.from(V.querySelectorAll(`[${T}]`));return Array.from(B.itemMap.values()).sort((Q,te)=>H.indexOf(Q.ref.current)-H.indexOf(te.ref.current))},[B.collectionRef,B.itemMap])}return[{Provider:d,Slot:_,ItemSlot:A},k,r]}var mme=X.createContext(void 0);function S_(e){const t=X.useContext(mme);return e||t||"ltr"}function gme(e,t=globalThis==null?void 0:globalThis.document){const n=Co(e);X.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var _me="DismissableLayer",ND="dismissableLayer.update",yme="dismissableLayer.pointerDownOutside",vme="dismissableLayer.focusOutside",_V,aZ=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),T_=X.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:d,onDismiss:i,..._}=e,b=X.useContext(aZ),[T,A]=X.useState(null),k=(T==null?void 0:T.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,R]=X.useState({}),B=Xr(t,fe=>A(fe)),N=Array.from(b.layers),[V]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),H=N.indexOf(V),G=T?N.indexOf(T):-1,q=b.layersWithOutsidePointerEventsDisabled.size>0,Q=G>=H,te=wme(fe=>{const ye=fe.target,De=[...b.branches].some(Ne=>Ne.contains(ye));!Q||De||(a==null||a(fe),d==null||d(fe),fe.defaultPrevented||i==null||i())},k),ue=Sme(fe=>{const ye=fe.target;[...b.branches].some(Ne=>Ne.contains(ye))||(c==null||c(fe),d==null||d(fe),fe.defaultPrevented||i==null||i())},k);return gme(fe=>{G===b.layers.size-1&&(r==null||r(fe),!fe.defaultPrevented&&i&&(fe.preventDefault(),i()))},k),X.useEffect(()=>{if(T)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(_V=k.body.style.pointerEvents,k.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(T)),b.layers.add(T),yV(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(k.body.style.pointerEvents=_V)}},[T,k,n,b]),X.useEffect(()=>()=>{T&&(b.layers.delete(T),b.layersWithOutsidePointerEventsDisabled.delete(T),yV())},[T,b]),X.useEffect(()=>{const fe=()=>R({});return document.addEventListener(ND,fe),()=>document.removeEventListener(ND,fe)},[]),_e.jsx(Qn.div,{..._,ref:B,style:{pointerEvents:q?Q?"auto":"none":void 0,...e.style},onFocusCapture:On(e.onFocusCapture,ue.onFocusCapture),onBlurCapture:On(e.onBlurCapture,ue.onBlurCapture),onPointerDownCapture:On(e.onPointerDownCapture,te.onPointerDownCapture)})});T_.displayName=_me;var xme="DismissableLayerBranch",bme=X.forwardRef((e,t)=>{const n=X.useContext(aZ),r=X.useRef(null),a=Xr(t,r);return X.useEffect(()=>{const c=r.current;if(c)return n.branches.add(c),()=>{n.branches.delete(c)}},[n.branches]),_e.jsx(Qn.div,{...e,ref:a})});bme.displayName=xme;function wme(e,t=globalThis==null?void 0:globalThis.document){const n=Co(e),r=X.useRef(!1),a=X.useRef(()=>{});return X.useEffect(()=>{const c=i=>{if(i.target&&!r.current){let _=function(){sZ(yme,n,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);r.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Sme(e,t=globalThis==null?void 0:globalThis.document){const n=Co(e),r=X.useRef(!1);return X.useEffect(()=>{const a=c=>{c.target&&!r.current&&sZ(vme,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function yV(){const e=new CustomEvent(ND);document.dispatchEvent(e)}function sZ(e,t,n,{discrete:r}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?vA(a,c):a.dispatchEvent(c)}var xk=0;function xC(){X.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??vV()),document.body.insertAdjacentElement("beforeend",e[1]??vV()),xk++,()=>{xk===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),xk--}},[])}function vV(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var bk="focusScope.autoFocusOnMount",wk="focusScope.autoFocusOnUnmount",xV={bubbles:!1,cancelable:!0},Tme="FocusScope",wS=X.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...d}=e,[i,_]=X.useState(null),b=Co(a),T=Co(c),A=X.useRef(null),k=Xr(t,N=>_(N)),R=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(r){let N=function(q){if(R.paused||!i)return;const Q=q.target;i.contains(Q)?A.current=Q:wp(A.current,{select:!0})},V=function(q){if(R.paused||!i)return;const Q=q.relatedTarget;Q!==null&&(i.contains(Q)||wp(A.current,{select:!0}))},H=function(q){if(document.activeElement===document.body)for(const te of q)te.removedNodes.length>0&&wp(i)};document.addEventListener("focusin",N),document.addEventListener("focusout",V);const G=new MutationObserver(H);return i&&G.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",V),G.disconnect()}}},[r,i,R.paused]),X.useEffect(()=>{if(i){wV.add(R);const N=document.activeElement;if(!i.contains(N)){const H=new CustomEvent(bk,xV);i.addEventListener(bk,b),i.dispatchEvent(H),H.defaultPrevented||(Eme(Mme(lZ(i)),{select:!0}),document.activeElement===N&&wp(i))}return()=>{i.removeEventListener(bk,b),setTimeout(()=>{const H=new CustomEvent(wk,xV);i.addEventListener(wk,T),i.dispatchEvent(H),H.defaultPrevented||wp(N??document.body,{select:!0}),i.removeEventListener(wk,T),wV.remove(R)},0)}}},[i,b,T,R]);const B=X.useCallback(N=>{if(!n&&!r||R.paused)return;const V=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,H=document.activeElement;if(V&&H){const G=N.currentTarget,[q,Q]=Ame(G);q&&Q?!N.shiftKey&&H===Q?(N.preventDefault(),n&&wp(q,{select:!0})):N.shiftKey&&H===q&&(N.preventDefault(),n&&wp(Q,{select:!0})):H===G&&N.preventDefault()}},[n,r,R.paused]);return _e.jsx(Qn.div,{tabIndex:-1,...d,ref:k,onKeyDown:B})});wS.displayName=Tme;function Eme(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(wp(r,{select:t}),document.activeElement!==n)return}function Ame(e){const t=lZ(e),n=bV(t,e),r=bV(t.reverse(),e);return[n,r]}function lZ(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bV(e,t){for(const n of e)if(!Pme(n,{upTo:t}))return n}function Pme(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Cme(e){return e instanceof HTMLInputElement&&"select"in e}function wp(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Cme(e)&&t&&e.select()}}var wV=Ime();function Ime(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=SV(e,t),e.unshift(t)},remove(t){var n;e=SV(e,t),(n=e[0])==null||n.resume()}}}function SV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Mme(e){return e.filter(t=>t.tagName!=="A")}var Ome=Qz.useId||(()=>{}),kme=0;function el(e){const[t,n]=X.useState(Ome());return Ea(()=>{e||n(r=>r??String(kme++))},[e]),e||(t?`radix-${t}`:"")}const Rme=["top","right","bottom","left"],lm=Math.min,Pc=Math.max,xA=Math.round,WE=Math.floor,cm=e=>({x:e,y:e}),Dme={left:"right",right:"left",bottom:"top",top:"bottom"},Lme={start:"end",end:"start"};function FD(e,t,n){return Pc(e,lm(t,n))}function pf(e,t){return typeof e=="function"?e(t):e}function mf(e){return e.split("-")[0]}function U0(e){return e.split("-")[1]}function tN(e){return e==="x"?"y":"x"}function nN(e){return e==="y"?"height":"width"}function um(e){return["top","bottom"].includes(mf(e))?"y":"x"}function rN(e){return tN(um(e))}function zme(e,t,n){n===void 0&&(n=!1);const r=U0(e),a=rN(e),c=nN(a);let d=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[c]>t.floating[c]&&(d=bA(d)),[d,bA(d)]}function Nme(e){const t=bA(e);return[BD(e),t,BD(t)]}function BD(e){return e.replace(/start|end/g,t=>Lme[t])}function Fme(e,t,n){const r=["left","right"],a=["right","left"],c=["top","bottom"],d=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?c:d;default:return[]}}function Bme(e,t,n,r){const a=U0(e);let c=Fme(mf(e),n==="start",r);return a&&(c=c.map(d=>d+"-"+a),t&&(c=c.concat(c.map(BD)))),c}function bA(e){return e.replace(/left|right|bottom|top/g,t=>Dme[t])}function jme(e){return{top:0,right:0,bottom:0,left:0,...e}}function cZ(e){return typeof e!="number"?jme(e):{top:e,right:e,bottom:e,left:e}}function wA(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function TV(e,t,n){let{reference:r,floating:a}=e;const c=um(t),d=rN(t),i=nN(d),_=mf(t),b=c==="y",T=r.x+r.width/2-a.width/2,A=r.y+r.height/2-a.height/2,k=r[i]/2-a[i]/2;let R;switch(_){case"top":R={x:T,y:r.y-a.height};break;case"bottom":R={x:T,y:r.y+r.height};break;case"right":R={x:r.x+r.width,y:A};break;case"left":R={x:r.x-a.width,y:A};break;default:R={x:r.x,y:r.y}}switch(U0(t)){case"start":R[d]-=k*(n&&b?-1:1);break;case"end":R[d]+=k*(n&&b?-1:1);break}return R}const $me=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:c=[],platform:d}=n,i=c.filter(Boolean),_=await(d.isRTL==null?void 0:d.isRTL(t));let b=await d.getElementRects({reference:e,floating:t,strategy:a}),{x:T,y:A}=TV(b,r,_),k=r,R={},B=0;for(let N=0;N<i.length;N++){const{name:V,fn:H}=i[N],{x:G,y:q,data:Q,reset:te}=await H({x:T,y:A,initialPlacement:r,placement:k,strategy:a,middlewareData:R,rects:b,platform:d,elements:{reference:e,floating:t}});T=G??T,A=q??A,R={...R,[V]:{...R[V],...Q}},te&&B<=50&&(B++,typeof te=="object"&&(te.placement&&(k=te.placement),te.rects&&(b=te.rects===!0?await d.getElementRects({reference:e,floating:t,strategy:a}):te.rects),{x:T,y:A}=TV(b,k,_)),N=-1)}return{x:T,y:A,placement:k,strategy:a,middlewareData:R}};async function Sw(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:c,rects:d,elements:i,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:T="viewport",elementContext:A="floating",altBoundary:k=!1,padding:R=0}=pf(t,e),B=cZ(R),V=i[k?A==="floating"?"reference":"floating":A],H=wA(await c.getClippingRect({element:(n=await(c.isElement==null?void 0:c.isElement(V)))==null||n?V:V.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(i.floating)),boundary:b,rootBoundary:T,strategy:_})),G=A==="floating"?{x:r,y:a,width:d.floating.width,height:d.floating.height}:d.reference,q=await(c.getOffsetParent==null?void 0:c.getOffsetParent(i.floating)),Q=await(c.isElement==null?void 0:c.isElement(q))?await(c.getScale==null?void 0:c.getScale(q))||{x:1,y:1}:{x:1,y:1},te=wA(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:G,offsetParent:q,strategy:_}):G);return{top:(H.top-te.top+B.top)/Q.y,bottom:(te.bottom-H.bottom+B.bottom)/Q.y,left:(H.left-te.left+B.left)/Q.x,right:(te.right-H.right+B.right)/Q.x}}const Ume=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:c,platform:d,elements:i,middlewareData:_}=t,{element:b,padding:T=0}=pf(e,t)||{};if(b==null)return{};const A=cZ(T),k={x:n,y:r},R=rN(a),B=nN(R),N=await d.getDimensions(b),V=R==="y",H=V?"top":"left",G=V?"bottom":"right",q=V?"clientHeight":"clientWidth",Q=c.reference[B]+c.reference[R]-k[R]-c.floating[B],te=k[R]-c.reference[R],ue=await(d.getOffsetParent==null?void 0:d.getOffsetParent(b));let fe=ue?ue[q]:0;(!fe||!await(d.isElement==null?void 0:d.isElement(ue)))&&(fe=i.floating[q]||c.floating[B]);const ye=Q/2-te/2,De=fe/2-N[B]/2-1,Ne=lm(A[H],De),Fe=lm(A[G],De),Le=Ne,Ze=fe-N[B]-Fe,He=fe/2-N[B]/2+ye,ct=FD(Le,He,Ze),ot=!_.arrow&&U0(a)!=null&&He!==ct&&c.reference[B]/2-(He<Le?Ne:Fe)-N[B]/2<0,rt=ot?He<Le?He-Le:He-Ze:0;return{[R]:k[R]+rt,data:{[R]:ct,centerOffset:He-ct-rt,...ot&&{alignmentOffset:rt}},reset:ot}}}),Vme=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:c,rects:d,initialPlacement:i,platform:_,elements:b}=t,{mainAxis:T=!0,crossAxis:A=!0,fallbackPlacements:k,fallbackStrategy:R="bestFit",fallbackAxisSideDirection:B="none",flipAlignment:N=!0,...V}=pf(e,t);if((n=c.arrow)!=null&&n.alignmentOffset)return{};const H=mf(a),G=um(i),q=mf(i)===i,Q=await(_.isRTL==null?void 0:_.isRTL(b.floating)),te=k||(q||!N?[bA(i)]:Nme(i)),ue=B!=="none";!k&&ue&&te.push(...Bme(i,N,B,Q));const fe=[i,...te],ye=await Sw(t,V),De=[];let Ne=((r=c.flip)==null?void 0:r.overflows)||[];if(T&&De.push(ye[H]),A){const He=zme(a,d,Q);De.push(ye[He[0]],ye[He[1]])}if(Ne=[...Ne,{placement:a,overflows:De}],!De.every(He=>He<=0)){var Fe,Le;const He=(((Fe=c.flip)==null?void 0:Fe.index)||0)+1,ct=fe[He];if(ct)return{data:{index:He,overflows:Ne},reset:{placement:ct}};let ot=(Le=Ne.filter(rt=>rt.overflows[0]<=0).sort((rt,Be)=>rt.overflows[1]-Be.overflows[1])[0])==null?void 0:Le.placement;if(!ot)switch(R){case"bestFit":{var Ze;const rt=(Ze=Ne.filter(Be=>{if(ue){const nt=um(Be.placement);return nt===G||nt==="y"}return!0}).map(Be=>[Be.placement,Be.overflows.filter(nt=>nt>0).reduce((nt,at)=>nt+at,0)]).sort((Be,nt)=>Be[1]-nt[1])[0])==null?void 0:Ze[0];rt&&(ot=rt);break}case"initialPlacement":ot=i;break}if(a!==ot)return{reset:{placement:ot}}}return{}}}};function EV(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function AV(e){return Rme.some(t=>e[t]>=0)}const Wme=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=pf(e,t);switch(r){case"referenceHidden":{const c=await Sw(t,{...a,elementContext:"reference"}),d=EV(c,n.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:AV(d)}}}case"escaped":{const c=await Sw(t,{...a,altBoundary:!0}),d=EV(c,n.floating);return{data:{escapedOffsets:d,escaped:AV(d)}}}default:return{}}}}};async function Gme(e,t){const{placement:n,platform:r,elements:a}=e,c=await(r.isRTL==null?void 0:r.isRTL(a.floating)),d=mf(n),i=U0(n),_=um(n)==="y",b=["left","top"].includes(d)?-1:1,T=c&&_?-1:1,A=pf(t,e);let{mainAxis:k,crossAxis:R,alignmentAxis:B}=typeof A=="number"?{mainAxis:A,crossAxis:0,alignmentAxis:null}:{mainAxis:A.mainAxis||0,crossAxis:A.crossAxis||0,alignmentAxis:A.alignmentAxis};return i&&typeof B=="number"&&(R=i==="end"?B*-1:B),_?{x:R*T,y:k*b}:{x:k*b,y:R*T}}const Hme=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:c,placement:d,middlewareData:i}=t,_=await Gme(t,e);return d===((n=i.offset)==null?void 0:n.placement)&&(r=i.arrow)!=null&&r.alignmentOffset?{}:{x:a+_.x,y:c+_.y,data:{..._,placement:d}}}}},qme=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:c=!0,crossAxis:d=!1,limiter:i={fn:V=>{let{x:H,y:G}=V;return{x:H,y:G}}},..._}=pf(e,t),b={x:n,y:r},T=await Sw(t,_),A=um(mf(a)),k=tN(A);let R=b[k],B=b[A];if(c){const V=k==="y"?"top":"left",H=k==="y"?"bottom":"right",G=R+T[V],q=R-T[H];R=FD(G,R,q)}if(d){const V=A==="y"?"top":"left",H=A==="y"?"bottom":"right",G=B+T[V],q=B-T[H];B=FD(G,B,q)}const N=i.fn({...t,[k]:R,[A]:B});return{...N,data:{x:N.x-n,y:N.y-r,enabled:{[k]:c,[A]:d}}}}}},Zme=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:c,middlewareData:d}=t,{offset:i=0,mainAxis:_=!0,crossAxis:b=!0}=pf(e,t),T={x:n,y:r},A=um(a),k=tN(A);let R=T[k],B=T[A];const N=pf(i,t),V=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(_){const q=k==="y"?"height":"width",Q=c.reference[k]-c.floating[q]+V.mainAxis,te=c.reference[k]+c.reference[q]-V.mainAxis;R<Q?R=Q:R>te&&(R=te)}if(b){var H,G;const q=k==="y"?"width":"height",Q=["top","left"].includes(mf(a)),te=c.reference[A]-c.floating[q]+(Q&&((H=d.offset)==null?void 0:H[A])||0)+(Q?0:V.crossAxis),ue=c.reference[A]+c.reference[q]+(Q?0:((G=d.offset)==null?void 0:G[A])||0)-(Q?V.crossAxis:0);B<te?B=te:B>ue&&(B=ue)}return{[k]:R,[A]:B}}}},Xme=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:c,platform:d,elements:i}=t,{apply:_=()=>{},...b}=pf(e,t),T=await Sw(t,b),A=mf(a),k=U0(a),R=um(a)==="y",{width:B,height:N}=c.floating;let V,H;A==="top"||A==="bottom"?(V=A,H=k===(await(d.isRTL==null?void 0:d.isRTL(i.floating))?"start":"end")?"left":"right"):(H=A,V=k==="end"?"top":"bottom");const G=N-T.top-T.bottom,q=B-T.left-T.right,Q=lm(N-T[V],G),te=lm(B-T[H],q),ue=!t.middlewareData.shift;let fe=Q,ye=te;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(ye=q),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(fe=G),ue&&!k){const Ne=Pc(T.left,0),Fe=Pc(T.right,0),Le=Pc(T.top,0),Ze=Pc(T.bottom,0);R?ye=B-2*(Ne!==0||Fe!==0?Ne+Fe:Pc(T.left,T.right)):fe=N-2*(Le!==0||Ze!==0?Le+Ze:Pc(T.top,T.bottom))}await _({...t,availableWidth:ye,availableHeight:fe});const De=await d.getDimensions(i.floating);return B!==De.width||N!==De.height?{reset:{rects:!0}}:{}}}};function bC(){return typeof window<"u"}function V0(e){return uZ(e)?(e.nodeName||"").toLowerCase():"#document"}function kc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function od(e){var t;return(t=(uZ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function uZ(e){return bC()?e instanceof Node||e instanceof kc(e).Node:!1}function lh(e){return bC()?e instanceof Element||e instanceof kc(e).Element:!1}function nd(e){return bC()?e instanceof HTMLElement||e instanceof kc(e).HTMLElement:!1}function PV(e){return!bC()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof kc(e).ShadowRoot}function SS(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=ch(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function Kme(e){return["table","td","th"].includes(V0(e))}function wC(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function iN(e){const t=oN(),n=lh(e)?ch(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Yme(e){let t=hm(e);for(;nd(t)&&!qv(t);){if(iN(t))return t;if(wC(t))return null;t=hm(t)}return null}function oN(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function qv(e){return["html","body","#document"].includes(V0(e))}function ch(e){return kc(e).getComputedStyle(e)}function SC(e){return lh(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function hm(e){if(V0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||PV(e)&&e.host||od(e);return PV(t)?t.host:t}function hZ(e){const t=hm(e);return qv(t)?e.ownerDocument?e.ownerDocument.body:e.body:nd(t)&&SS(t)?t:hZ(t)}function Tw(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=hZ(e),c=a===((r=e.ownerDocument)==null?void 0:r.body),d=kc(a);if(c){const i=jD(d);return t.concat(d,d.visualViewport||[],SS(a)?a:[],i&&n?Tw(i):[])}return t.concat(a,Tw(a,[],n))}function jD(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function dZ(e){const t=ch(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=nd(e),c=a?e.offsetWidth:n,d=a?e.offsetHeight:r,i=xA(n)!==c||xA(r)!==d;return i&&(n=c,r=d),{width:n,height:r,$:i}}function aN(e){return lh(e)?e:e.contextElement}function Cv(e){const t=aN(e);if(!nd(t))return cm(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:c}=dZ(t);let d=(c?xA(n.width):n.width)/r,i=(c?xA(n.height):n.height)/a;return(!d||!Number.isFinite(d))&&(d=1),(!i||!Number.isFinite(i))&&(i=1),{x:d,y:i}}const Jme=cm(0);function fZ(e){const t=kc(e);return!oN()||!t.visualViewport?Jme:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Qme(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==kc(e)?!1:t}function o_(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),c=aN(e);let d=cm(1);t&&(r?lh(r)&&(d=Cv(r)):d=Cv(e));const i=Qme(c,n,r)?fZ(c):cm(0);let _=(a.left+i.x)/d.x,b=(a.top+i.y)/d.y,T=a.width/d.x,A=a.height/d.y;if(c){const k=kc(c),R=r&&lh(r)?kc(r):r;let B=k,N=jD(B);for(;N&&r&&R!==B;){const V=Cv(N),H=N.getBoundingClientRect(),G=ch(N),q=H.left+(N.clientLeft+parseFloat(G.paddingLeft))*V.x,Q=H.top+(N.clientTop+parseFloat(G.paddingTop))*V.y;_*=V.x,b*=V.y,T*=V.x,A*=V.y,_+=q,b+=Q,B=kc(N),N=jD(B)}}return wA({width:T,height:A,x:_,y:b})}function ege(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const c=a==="fixed",d=od(r),i=t?wC(t.floating):!1;if(r===d||i&&c)return n;let _={scrollLeft:0,scrollTop:0},b=cm(1);const T=cm(0),A=nd(r);if((A||!A&&!c)&&((V0(r)!=="body"||SS(d))&&(_=SC(r)),nd(r))){const k=o_(r);b=Cv(r),T.x=k.x+r.clientLeft,T.y=k.y+r.clientTop}return{width:n.width*b.x,height:n.height*b.y,x:n.x*b.x-_.scrollLeft*b.x+T.x,y:n.y*b.y-_.scrollTop*b.y+T.y}}function tge(e){return Array.from(e.getClientRects())}function $D(e,t){const n=SC(e).scrollLeft;return t?t.left+n:o_(od(e)).left+n}function nge(e){const t=od(e),n=SC(e),r=e.ownerDocument.body,a=Pc(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),c=Pc(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let d=-n.scrollLeft+$D(e);const i=-n.scrollTop;return ch(r).direction==="rtl"&&(d+=Pc(t.clientWidth,r.clientWidth)-a),{width:a,height:c,x:d,y:i}}function rge(e,t){const n=kc(e),r=od(e),a=n.visualViewport;let c=r.clientWidth,d=r.clientHeight,i=0,_=0;if(a){c=a.width,d=a.height;const b=oN();(!b||b&&t==="fixed")&&(i=a.offsetLeft,_=a.offsetTop)}return{width:c,height:d,x:i,y:_}}function ige(e,t){const n=o_(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,c=nd(e)?Cv(e):cm(1),d=e.clientWidth*c.x,i=e.clientHeight*c.y,_=a*c.x,b=r*c.y;return{width:d,height:i,x:_,y:b}}function CV(e,t,n){let r;if(t==="viewport")r=rge(e,n);else if(t==="document")r=nge(od(e));else if(lh(t))r=ige(t,n);else{const a=fZ(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return wA(r)}function pZ(e,t){const n=hm(e);return n===t||!lh(n)||qv(n)?!1:ch(n).position==="fixed"||pZ(n,t)}function oge(e,t){const n=t.get(e);if(n)return n;let r=Tw(e,[],!1).filter(i=>lh(i)&&V0(i)!=="body"),a=null;const c=ch(e).position==="fixed";let d=c?hm(e):e;for(;lh(d)&&!qv(d);){const i=ch(d),_=iN(d);!_&&i.position==="fixed"&&(a=null),(c?!_&&!a:!_&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||SS(d)&&!_&&pZ(e,d))?r=r.filter(T=>T!==d):a=i,d=hm(d)}return t.set(e,r),r}function age(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const d=[...n==="clippingAncestors"?wC(t)?[]:oge(t,this._c):[].concat(n),r],i=d[0],_=d.reduce((b,T)=>{const A=CV(t,T,a);return b.top=Pc(A.top,b.top),b.right=lm(A.right,b.right),b.bottom=lm(A.bottom,b.bottom),b.left=Pc(A.left,b.left),b},CV(t,i,a));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function sge(e){const{width:t,height:n}=dZ(e);return{width:t,height:n}}function lge(e,t,n){const r=nd(t),a=od(t),c=n==="fixed",d=o_(e,!0,c,t);let i={scrollLeft:0,scrollTop:0};const _=cm(0);if(r||!r&&!c)if((V0(t)!=="body"||SS(a))&&(i=SC(t)),r){const R=o_(t,!0,c,t);_.x=R.x+t.clientLeft,_.y=R.y+t.clientTop}else a&&(_.x=$D(a));let b=0,T=0;if(a&&!r&&!c){const R=a.getBoundingClientRect();T=R.top+i.scrollTop,b=R.left+i.scrollLeft-$D(a,R)}const A=d.left+i.scrollLeft-_.x-b,k=d.top+i.scrollTop-_.y-T;return{x:A,y:k,width:d.width,height:d.height}}function Sk(e){return ch(e).position==="static"}function IV(e,t){if(!nd(e)||ch(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return od(e)===n&&(n=n.ownerDocument.body),n}function mZ(e,t){const n=kc(e);if(wC(e))return n;if(!nd(e)){let a=hm(e);for(;a&&!qv(a);){if(lh(a)&&!Sk(a))return a;a=hm(a)}return n}let r=IV(e,t);for(;r&&Kme(r)&&Sk(r);)r=IV(r,t);return r&&qv(r)&&Sk(r)&&!iN(r)?n:r||Yme(e)||n}const cge=async function(e){const t=this.getOffsetParent||mZ,n=this.getDimensions,r=await n(e.floating);return{reference:lge(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function uge(e){return ch(e).direction==="rtl"}const hge={convertOffsetParentRelativeRectToViewportRelativeRect:ege,getDocumentElement:od,getClippingRect:age,getOffsetParent:mZ,getElementRects:cge,getClientRects:tge,getDimensions:sge,getScale:Cv,isElement:lh,isRTL:uge};function dge(e,t){let n=null,r;const a=od(e);function c(){var i;clearTimeout(r),(i=n)==null||i.disconnect(),n=null}function d(i,_){i===void 0&&(i=!1),_===void 0&&(_=1),c();const{left:b,top:T,width:A,height:k}=e.getBoundingClientRect();if(i||t(),!A||!k)return;const R=WE(T),B=WE(a.clientWidth-(b+A)),N=WE(a.clientHeight-(T+k)),V=WE(b),G={rootMargin:-R+"px "+-B+"px "+-N+"px "+-V+"px",threshold:Pc(0,lm(1,_))||1};let q=!0;function Q(te){const ue=te[0].intersectionRatio;if(ue!==_){if(!q)return d();ue?d(!1,ue):r=setTimeout(()=>{d(!1,1e-7)},1e3)}q=!1}try{n=new IntersectionObserver(Q,{...G,root:a.ownerDocument})}catch{n=new IntersectionObserver(Q,G)}n.observe(e)}return d(!0),c}function fge(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:_=!1}=r,b=aN(e),T=a||c?[...b?Tw(b):[],...Tw(t)]:[];T.forEach(H=>{a&&H.addEventListener("scroll",n,{passive:!0}),c&&H.addEventListener("resize",n)});const A=b&&i?dge(b,n):null;let k=-1,R=null;d&&(R=new ResizeObserver(H=>{let[G]=H;G&&G.target===b&&R&&(R.unobserve(t),cancelAnimationFrame(k),k=requestAnimationFrame(()=>{var q;(q=R)==null||q.observe(t)})),n()}),b&&!_&&R.observe(b),R.observe(t));let B,N=_?o_(e):null;_&&V();function V(){const H=o_(e);N&&(H.x!==N.x||H.y!==N.y||H.width!==N.width||H.height!==N.height)&&n(),N=H,B=requestAnimationFrame(V)}return n(),()=>{var H;T.forEach(G=>{a&&G.removeEventListener("scroll",n),c&&G.removeEventListener("resize",n)}),A==null||A(),(H=R)==null||H.disconnect(),R=null,_&&cancelAnimationFrame(B)}}const pge=Hme,mge=qme,gge=Vme,_ge=Xme,yge=Wme,MV=Ume,vge=Zme,xge=(e,t,n)=>{const r=new Map,a={platform:hge,...n},c={...a.platform,_c:r};return $me(e,t,{...a,platform:c})};var C2=typeof document<"u"?X.useLayoutEffect:X.useEffect;function SA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!SA(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const c=a[r];if(!(c==="_owner"&&e.$$typeof)&&!SA(e[c],t[c]))return!1}return!0}return e!==e&&t!==t}function gZ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function OV(e,t){const n=gZ(e);return Math.round(t*n)/n}function Tk(e){const t=X.useRef(e);return C2(()=>{t.current=e}),t}function bge(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:c,floating:d}={},transform:i=!0,whileElementsMounted:_,open:b}=e,[T,A]=X.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[k,R]=X.useState(r);SA(k,r)||R(r);const[B,N]=X.useState(null),[V,H]=X.useState(null),G=X.useCallback(Be=>{Be!==ue.current&&(ue.current=Be,N(Be))},[]),q=X.useCallback(Be=>{Be!==fe.current&&(fe.current=Be,H(Be))},[]),Q=c||B,te=d||V,ue=X.useRef(null),fe=X.useRef(null),ye=X.useRef(T),De=_!=null,Ne=Tk(_),Fe=Tk(a),Le=Tk(b),Ze=X.useCallback(()=>{if(!ue.current||!fe.current)return;const Be={placement:t,strategy:n,middleware:k};Fe.current&&(Be.platform=Fe.current),xge(ue.current,fe.current,Be).then(nt=>{const at={...nt,isPositioned:Le.current!==!1};He.current&&!SA(ye.current,at)&&(ye.current=at,ym.flushSync(()=>{A(at)}))})},[k,t,n,Fe,Le]);C2(()=>{b===!1&&ye.current.isPositioned&&(ye.current.isPositioned=!1,A(Be=>({...Be,isPositioned:!1})))},[b]);const He=X.useRef(!1);C2(()=>(He.current=!0,()=>{He.current=!1}),[]),C2(()=>{if(Q&&(ue.current=Q),te&&(fe.current=te),Q&&te){if(Ne.current)return Ne.current(Q,te,Ze);Ze()}},[Q,te,Ze,Ne,De]);const ct=X.useMemo(()=>({reference:ue,floating:fe,setReference:G,setFloating:q}),[G,q]),ot=X.useMemo(()=>({reference:Q,floating:te}),[Q,te]),rt=X.useMemo(()=>{const Be={position:n,left:0,top:0};if(!ot.floating)return Be;const nt=OV(ot.floating,T.x),at=OV(ot.floating,T.y);return i?{...Be,transform:"translate("+nt+"px, "+at+"px)",...gZ(ot.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:nt,top:at}},[n,i,ot.floating,T.x,T.y]);return X.useMemo(()=>({...T,update:Ze,refs:ct,elements:ot,floatingStyles:rt}),[T,Ze,ct,ot,rt])}const wge=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?MV({element:r.current,padding:a}).fn(n):{}:r?MV({element:r,padding:a}).fn(n):{}}}},Sge=(e,t)=>({...pge(e),options:[e,t]}),Tge=(e,t)=>({...mge(e),options:[e,t]}),Ege=(e,t)=>({...vge(e),options:[e,t]}),Age=(e,t)=>({...gge(e),options:[e,t]}),Pge=(e,t)=>({..._ge(e),options:[e,t]}),Cge=(e,t)=>({...yge(e),options:[e,t]}),Ige=(e,t)=>({...wge(e),options:[e,t]});var Mge="Arrow",_Z=X.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...c}=e;return _e.jsx(Qn.svg,{...c,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:_e.jsx("polygon",{points:"0,0 30,0 15,10"})})});_Z.displayName=Mge;var Oge=_Z;function kge(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];function b(A){const{scope:k,children:R,...B}=A,N=(k==null?void 0:k[e][_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})}function T(A,k){const R=(k==null?void 0:k[e][_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,Rge(a,...t)]}function Rge(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}function sN(e){const[t,n]=X.useState(void 0);return Ea(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let d,i;if("borderBoxSize"in c){const _=c.borderBoxSize,b=Array.isArray(_)?_[0]:_;d=b.inlineSize,i=b.blockSize}else d=e.offsetWidth,i=e.offsetHeight;n({width:d,height:i})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var lN="Popper",[yZ,xm]=kge(lN),[Dge,vZ]=yZ(lN),xZ=e=>{const{__scopePopper:t,children:n}=e,[r,a]=X.useState(null);return _e.jsx(Dge,{scope:t,anchor:r,onAnchorChange:a,children:n})};xZ.displayName=lN;var bZ="PopperAnchor",wZ=X.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,c=vZ(bZ,n),d=X.useRef(null),i=Xr(t,d);return X.useEffect(()=>{c.onAnchorChange((r==null?void 0:r.current)||d.current)}),r?null:_e.jsx(Qn.div,{...a,ref:i})});wZ.displayName=bZ;var cN="PopperContent",[Lge,zge]=yZ(cN),SZ=X.forwardRef((e,t)=>{var Vt,$n,Gt,Tn,hn,yt;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:c="center",alignOffset:d=0,arrowPadding:i=0,avoidCollisions:_=!0,collisionBoundary:b=[],collisionPadding:T=0,sticky:A="partial",hideWhenDetached:k=!1,updatePositionStrategy:R="optimized",onPlaced:B,...N}=e,V=vZ(cN,n),[H,G]=X.useState(null),q=Xr(t,In=>G(In)),[Q,te]=X.useState(null),ue=sN(Q),fe=(ue==null?void 0:ue.width)??0,ye=(ue==null?void 0:ue.height)??0,De=r+(c!=="center"?"-"+c:""),Ne=typeof T=="number"?T:{top:0,right:0,bottom:0,left:0,...T},Fe=Array.isArray(b)?b:[b],Le=Fe.length>0,Ze={padding:Ne,boundary:Fe.filter(Fge),altBoundary:Le},{refs:He,floatingStyles:ct,placement:ot,isPositioned:rt,middlewareData:Be}=bge({strategy:"fixed",placement:De,whileElementsMounted:(...In)=>fge(...In,{animationFrame:R==="always"}),elements:{reference:V.anchor},middleware:[Sge({mainAxis:a+ye,alignmentAxis:d}),_&&Tge({mainAxis:!0,crossAxis:!1,limiter:A==="partial"?Ege():void 0,...Ze}),_&&Age({...Ze}),Pge({...Ze,apply:({elements:In,rects:Kn,availableWidth:Ar,availableHeight:_r})=>{const{width:Vr,height:it}=Kn.reference,Pt=In.floating.style;Pt.setProperty("--radix-popper-available-width",`${Ar}px`),Pt.setProperty("--radix-popper-available-height",`${_r}px`),Pt.setProperty("--radix-popper-anchor-width",`${Vr}px`),Pt.setProperty("--radix-popper-anchor-height",`${it}px`)}}),Q&&Ige({element:Q,padding:i}),Bge({arrowWidth:fe,arrowHeight:ye}),k&&Cge({strategy:"referenceHidden",...Ze})]}),[nt,at]=AZ(ot),Mt=Co(B);Ea(()=>{rt&&(Mt==null||Mt())},[rt,Mt]);const Nt=(Vt=Be.arrow)==null?void 0:Vt.x,rn=($n=Be.arrow)==null?void 0:$n.y,un=((Gt=Be.arrow)==null?void 0:Gt.centerOffset)!==0,[en,sn]=X.useState();return Ea(()=>{H&&sn(window.getComputedStyle(H).zIndex)},[H]),_e.jsx("div",{ref:He.setFloating,"data-radix-popper-content-wrapper":"",style:{...ct,transform:rt?ct.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:en,"--radix-popper-transform-origin":[(Tn=Be.transformOrigin)==null?void 0:Tn.x,(hn=Be.transformOrigin)==null?void 0:hn.y].join(" "),...((yt=Be.hide)==null?void 0:yt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:_e.jsx(Lge,{scope:n,placedSide:nt,onArrowChange:te,arrowX:Nt,arrowY:rn,shouldHideArrow:un,children:_e.jsx(Qn.div,{"data-side":nt,"data-align":at,...N,ref:q,style:{...N.style,animation:rt?void 0:"none"}})})})});SZ.displayName=cN;var TZ="PopperArrow",Nge={top:"bottom",right:"left",bottom:"top",left:"right"},EZ=X.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,c=zge(TZ,r),d=Nge[c.placedSide];return _e.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:_e.jsx(Oge,{...a,ref:n,style:{...a.style,display:"block"}})})});EZ.displayName=TZ;function Fge(e){return e!==null}var Bge=e=>({name:"transformOrigin",options:e,fn(t){var V,H,G;const{placement:n,rects:r,middlewareData:a}=t,d=((V=a.arrow)==null?void 0:V.centerOffset)!==0,i=d?0:e.arrowWidth,_=d?0:e.arrowHeight,[b,T]=AZ(n),A={start:"0%",center:"50%",end:"100%"}[T],k=(((H=a.arrow)==null?void 0:H.x)??0)+i/2,R=(((G=a.arrow)==null?void 0:G.y)??0)+_/2;let B="",N="";return b==="bottom"?(B=d?A:`${k}px`,N=`${-_}px`):b==="top"?(B=d?A:`${k}px`,N=`${r.floating.height+_}px`):b==="right"?(B=`${-_}px`,N=d?A:`${R}px`):b==="left"&&(B=`${r.floating.width+_}px`,N=d?A:`${R}px`),{data:{x:B,y:N}}}});function AZ(e){const[t,n="center"]=e.split("-");return[t,n]}var TC=xZ,TS=wZ,EC=SZ,AC=EZ,jge="Portal",ES=X.forwardRef((e,t)=>{var i;const{container:n,...r}=e,[a,c]=X.useState(!1);Ea(()=>c(!0),[]);const d=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return d?uC.createPortal(_e.jsx(Qn.div,{...r,ref:t}),d):null});ES.displayName=jge;function $ge(e,t){return X.useReducer((n,r)=>t[n][r]??n,e)}var Aa=e=>{const{present:t,children:n}=e,r=Uge(t),a=typeof n=="function"?n({present:r.isPresent}):X.Children.only(n),c=Xr(r.ref,Vge(a));return typeof n=="function"||r.isPresent?X.cloneElement(a,{ref:c}):null};Aa.displayName="Presence";function Uge(e){const[t,n]=X.useState(),r=X.useRef({}),a=X.useRef(e),c=X.useRef("none"),d=e?"mounted":"unmounted",[i,_]=$ge(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const b=GE(r.current);c.current=i==="mounted"?b:"none"},[i]),Ea(()=>{const b=r.current,T=a.current;if(T!==e){const k=c.current,R=GE(b);e?_("MOUNT"):R==="none"||(b==null?void 0:b.display)==="none"?_("UNMOUNT"):_(T&&k!==R?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),Ea(()=>{if(t){let b;const T=t.ownerDocument.defaultView??window,A=R=>{const N=GE(r.current).includes(R.animationName);if(R.target===t&&N&&(_("ANIMATION_END"),!a.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",b=T.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},k=R=>{R.target===t&&(c.current=GE(r.current))};return t.addEventListener("animationstart",k),t.addEventListener("animationcancel",A),t.addEventListener("animationend",A),()=>{T.clearTimeout(b),t.removeEventListener("animationstart",k),t.removeEventListener("animationcancel",A),t.removeEventListener("animationend",A)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:X.useCallback(b=>{b&&(r.current=getComputedStyle(b)),n(b)},[])}}function GE(e){return(e==null?void 0:e.animationName)||"none"}function Vge(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Wge(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];function b(A){const{scope:k,children:R,...B}=A,N=(k==null?void 0:k[e][_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})}function T(A,k){const R=(k==null?void 0:k[e][_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,Gge(a,...t)]}function Gge(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}var Ek="rovingFocusGroup.onEntryFocus",Hge={bubbles:!1,cancelable:!0},PC="RovingFocusGroup",[UD,PZ,qge]=$0(PC),[Zge,CC]=Wge(PC,[qge]),[Xge,Kge]=Zge(PC),CZ=X.forwardRef((e,t)=>_e.jsx(UD.Provider,{scope:e.__scopeRovingFocusGroup,children:_e.jsx(UD.Slot,{scope:e.__scopeRovingFocusGroup,children:_e.jsx(Yge,{...e,ref:t})})}));CZ.displayName=PC;var Yge=X.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:c,currentTabStopId:d,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:_,onEntryFocus:b,preventScrollOnEntryFocus:T=!1,...A}=e,k=X.useRef(null),R=Xr(t,k),B=S_(c),[N=null,V]=Sl({prop:d,defaultProp:i,onChange:_}),[H,G]=X.useState(!1),q=Co(b),Q=PZ(n),te=X.useRef(!1),[ue,fe]=X.useState(0);return X.useEffect(()=>{const ye=k.current;if(ye)return ye.addEventListener(Ek,q),()=>ye.removeEventListener(Ek,q)},[q]),_e.jsx(Xge,{scope:n,orientation:r,dir:B,loop:a,currentTabStopId:N,onItemFocus:X.useCallback(ye=>V(ye),[V]),onItemShiftTab:X.useCallback(()=>G(!0),[]),onFocusableItemAdd:X.useCallback(()=>fe(ye=>ye+1),[]),onFocusableItemRemove:X.useCallback(()=>fe(ye=>ye-1),[]),children:_e.jsx(Qn.div,{tabIndex:H||ue===0?-1:0,"data-orientation":r,...A,ref:R,style:{outline:"none",...e.style},onMouseDown:On(e.onMouseDown,()=>{te.current=!0}),onFocus:On(e.onFocus,ye=>{const De=!te.current;if(ye.target===ye.currentTarget&&De&&!H){const Ne=new CustomEvent(Ek,Hge);if(ye.currentTarget.dispatchEvent(Ne),!Ne.defaultPrevented){const Fe=Q().filter(ot=>ot.focusable),Le=Fe.find(ot=>ot.active),Ze=Fe.find(ot=>ot.id===N),ct=[Le,Ze,...Fe].filter(Boolean).map(ot=>ot.ref.current);OZ(ct,T)}}te.current=!1}),onBlur:On(e.onBlur,()=>G(!1))})})}),IZ="RovingFocusGroupItem",MZ=X.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:c,...d}=e,i=el(),_=c||i,b=Kge(IZ,n),T=b.currentTabStopId===_,A=PZ(n),{onFocusableItemAdd:k,onFocusableItemRemove:R}=b;return X.useEffect(()=>{if(r)return k(),()=>R()},[r,k,R]),_e.jsx(UD.ItemSlot,{scope:n,id:_,focusable:r,active:a,children:_e.jsx(Qn.span,{tabIndex:T?0:-1,"data-orientation":b.orientation,...d,ref:t,onMouseDown:On(e.onMouseDown,B=>{r?b.onItemFocus(_):B.preventDefault()}),onFocus:On(e.onFocus,()=>b.onItemFocus(_)),onKeyDown:On(e.onKeyDown,B=>{if(B.key==="Tab"&&B.shiftKey){b.onItemShiftTab();return}if(B.target!==B.currentTarget)return;const N=e_e(B,b.orientation,b.dir);if(N!==void 0){if(B.metaKey||B.ctrlKey||B.altKey||B.shiftKey)return;B.preventDefault();let H=A().filter(G=>G.focusable).map(G=>G.ref.current);if(N==="last")H.reverse();else if(N==="prev"||N==="next"){N==="prev"&&H.reverse();const G=H.indexOf(B.currentTarget);H=b.loop?t_e(H,G+1):H.slice(G+1)}setTimeout(()=>OZ(H))}})})})});MZ.displayName=IZ;var Jge={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Qge(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function e_e(e,t,n){const r=Qge(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Jge[r]}function OZ(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function t_e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var kZ=CZ,RZ=MZ,n_e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Vy=new WeakMap,HE=new WeakMap,qE={},Ak=0,DZ=function(e){return e&&(e.host||DZ(e.parentNode))},r_e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=DZ(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},i_e=function(e,t,n,r){var a=r_e(t,Array.isArray(e)?e:[e]);qE[n]||(qE[n]=new WeakMap);var c=qE[n],d=[],i=new Set,_=new Set(a),b=function(A){!A||i.has(A)||(i.add(A),b(A.parentNode))};a.forEach(b);var T=function(A){!A||_.has(A)||Array.prototype.forEach.call(A.children,function(k){if(i.has(k))T(k);else try{var R=k.getAttribute(r),B=R!==null&&R!=="false",N=(Vy.get(k)||0)+1,V=(c.get(k)||0)+1;Vy.set(k,N),c.set(k,V),d.push(k),N===1&&B&&HE.set(k,!0),V===1&&k.setAttribute(n,"true"),B||k.setAttribute(r,"true")}catch(H){console.error("aria-hidden: cannot operate on ",k,H)}})};return T(t),i.clear(),Ak++,function(){d.forEach(function(A){var k=Vy.get(A)-1,R=c.get(A)-1;Vy.set(A,k),c.set(A,R),k||(HE.has(A)||A.removeAttribute(r),HE.delete(A)),R||A.removeAttribute(n)}),Ak--,Ak||(Vy=new WeakMap,Vy=new WeakMap,HE=new WeakMap,qE={})}},AS=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=n_e(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),i_e(r,a,n,"aria-hidden")):function(){return null}},Qs=function(){return Qs=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},Qs.apply(this,arguments)};function uN(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function LZ(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,c;r<a;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))}var Cb="right-scroll-bar-position",Ib="width-before-scroll-bar",o_e="with-scroll-bars-hidden",a_e="--removed-body-scroll-bar-size";function Pk(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function s_e(e,t){var n=X.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var l_e=typeof window<"u"?X.useLayoutEffect:X.useEffect,kV=new WeakMap;function zZ(e,t){var n=s_e(null,function(r){return e.forEach(function(a){return Pk(a,r)})});return l_e(function(){var r=kV.get(n);if(r){var a=new Set(r),c=new Set(e),d=n.current;a.forEach(function(i){c.has(i)||Pk(i,null)}),c.forEach(function(i){a.has(i)||Pk(i,d)})}kV.set(n,e)},[e]),n}function c_e(e){return e}function u_e(e,t){t===void 0&&(t=c_e);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(c){var d=t(c,r);return n.push(d),function(){n=n.filter(function(i){return i!==d})}},assignSyncMedium:function(c){for(r=!0;n.length;){var d=n;n=[],d.forEach(c)}n={push:function(i){return c(i)},filter:function(){return n}}},assignMedium:function(c){r=!0;var d=[];if(n.length){var i=n;n=[],i.forEach(c),d=n}var _=function(){var T=d;d=[],T.forEach(c)},b=function(){return Promise.resolve().then(_)};b(),n={push:function(T){d.push(T),b()},filter:function(T){return d=d.filter(T),n}}}};return a}function NZ(e){e===void 0&&(e={});var t=u_e(null);return t.options=Qs({async:!0,ssr:!1},e),t}var FZ=function(e){var t=e.sideCar,n=uN(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return X.createElement(r,Qs({},n))};FZ.isSideCarExport=!0;function BZ(e,t){return e.useMedium(t),FZ}var jZ=NZ(),Ck=function(){},IC=X.forwardRef(function(e,t){var n=X.useRef(null),r=X.useState({onScrollCapture:Ck,onWheelCapture:Ck,onTouchMoveCapture:Ck}),a=r[0],c=r[1],d=e.forwardProps,i=e.children,_=e.className,b=e.removeScrollBar,T=e.enabled,A=e.shards,k=e.sideCar,R=e.noIsolation,B=e.inert,N=e.allowPinchZoom,V=e.as,H=V===void 0?"div":V,G=e.gapMode,q=uN(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Q=k,te=zZ([n,t]),ue=Qs(Qs({},q),a);return X.createElement(X.Fragment,null,T&&X.createElement(Q,{sideCar:jZ,removeScrollBar:b,shards:A,noIsolation:R,inert:B,setCallbacks:c,allowPinchZoom:!!N,lockRef:n,gapMode:G}),d?X.cloneElement(X.Children.only(i),Qs(Qs({},ue),{ref:te})):X.createElement(H,Qs({},ue,{className:_,ref:te}),i))});IC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};IC.classNames={fullWidth:Ib,zeroRight:Cb};var h_e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function d_e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=h_e();return t&&e.setAttribute("nonce",t),e}function f_e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function p_e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var m_e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=d_e())&&(f_e(t,n),p_e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},g_e=function(){var e=m_e();return function(t,n){X.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},hN=function(){var e=g_e(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},__e={left:0,top:0,right:0,gap:0},Ik=function(e){return parseInt(e||"",10)||0},y_e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Ik(n),Ik(r),Ik(a)]},v_e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return __e;var t=y_e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},x_e=hN(),Iv="data-scroll-locked",b_e=function(e,t,n,r){var a=e.left,c=e.top,d=e.right,i=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(o_e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(i,"px ").concat(r,`;
  }
  body[`).concat(Iv,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(i,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Cb,` {
    right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(Ib,` {
    margin-right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(Cb," .").concat(Cb,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Ib," .").concat(Ib,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Iv,`] {
    `).concat(a_e,": ").concat(i,`px;
  }
`)},RV=function(){var e=parseInt(document.body.getAttribute(Iv)||"0",10);return isFinite(e)?e:0},w_e=function(){X.useEffect(function(){return document.body.setAttribute(Iv,(RV()+1).toString()),function(){var e=RV()-1;e<=0?document.body.removeAttribute(Iv):document.body.setAttribute(Iv,e.toString())}},[])},$Z=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;w_e();var c=X.useMemo(function(){return v_e(a)},[a]);return X.createElement(x_e,{styles:b_e(c,!t,a,n?"":"!important")})},VD=!1;if(typeof window<"u")try{var ZE=Object.defineProperty({},"passive",{get:function(){return VD=!0,!0}});window.addEventListener("test",ZE,ZE),window.removeEventListener("test",ZE,ZE)}catch{VD=!1}var Wy=VD?{passive:!1}:!1,S_e=function(e){return e.tagName==="TEXTAREA"},UZ=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!S_e(e)&&n[t]==="visible")},T_e=function(e){return UZ(e,"overflowY")},E_e=function(e){return UZ(e,"overflowX")},DV=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=VZ(e,r);if(a){var c=WZ(e,r),d=c[1],i=c[2];if(d>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},A_e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},P_e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},VZ=function(e,t){return e==="v"?T_e(t):E_e(t)},WZ=function(e,t){return e==="v"?A_e(t):P_e(t)},C_e=function(e,t){return e==="h"&&t==="rtl"?-1:1},I_e=function(e,t,n,r,a){var c=C_e(e,window.getComputedStyle(t).direction),d=c*r,i=n.target,_=t.contains(i),b=!1,T=d>0,A=0,k=0;do{var R=WZ(e,i),B=R[0],N=R[1],V=R[2],H=N-V-c*B;(B||H)&&VZ(e,i)&&(A+=H,k+=B),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(T&&(Math.abs(A)<1||!a)||!T&&(Math.abs(k)<1||!a))&&(b=!0),b},XE=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},LV=function(e){return[e.deltaX,e.deltaY]},zV=function(e){return e&&"current"in e?e.current:e},M_e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},O_e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},k_e=0,Gy=[];function R_e(e){var t=X.useRef([]),n=X.useRef([0,0]),r=X.useRef(),a=X.useState(k_e++)[0],c=X.useState(hN)[0],d=X.useRef(e);X.useEffect(function(){d.current=e},[e]),X.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var N=LZ([e.lockRef.current],(e.shards||[]).map(zV),!0).filter(Boolean);return N.forEach(function(V){return V.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),N.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=X.useCallback(function(N,V){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!d.current.allowPinchZoom;var H=XE(N),G=n.current,q="deltaX"in N?N.deltaX:G[0]-H[0],Q="deltaY"in N?N.deltaY:G[1]-H[1],te,ue=N.target,fe=Math.abs(q)>Math.abs(Q)?"h":"v";if("touches"in N&&fe==="h"&&ue.type==="range")return!1;var ye=DV(fe,ue);if(!ye)return!0;if(ye?te=fe:(te=fe==="v"?"h":"v",ye=DV(fe,ue)),!ye)return!1;if(!r.current&&"changedTouches"in N&&(q||Q)&&(r.current=te),!te)return!0;var De=r.current||te;return I_e(De,V,N,De==="h"?q:Q,!0)},[]),_=X.useCallback(function(N){var V=N;if(!(!Gy.length||Gy[Gy.length-1]!==c)){var H="deltaY"in V?LV(V):XE(V),G=t.current.filter(function(te){return te.name===V.type&&(te.target===V.target||V.target===te.shadowParent)&&M_e(te.delta,H)})[0];if(G&&G.should){V.cancelable&&V.preventDefault();return}if(!G){var q=(d.current.shards||[]).map(zV).filter(Boolean).filter(function(te){return te.contains(V.target)}),Q=q.length>0?i(V,q[0]):!d.current.noIsolation;Q&&V.cancelable&&V.preventDefault()}}},[]),b=X.useCallback(function(N,V,H,G){var q={name:N,delta:V,target:H,should:G,shadowParent:D_e(H)};t.current.push(q),setTimeout(function(){t.current=t.current.filter(function(Q){return Q!==q})},1)},[]),T=X.useCallback(function(N){n.current=XE(N),r.current=void 0},[]),A=X.useCallback(function(N){b(N.type,LV(N),N.target,i(N,e.lockRef.current))},[]),k=X.useCallback(function(N){b(N.type,XE(N),N.target,i(N,e.lockRef.current))},[]);X.useEffect(function(){return Gy.push(c),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:k}),document.addEventListener("wheel",_,Wy),document.addEventListener("touchmove",_,Wy),document.addEventListener("touchstart",T,Wy),function(){Gy=Gy.filter(function(N){return N!==c}),document.removeEventListener("wheel",_,Wy),document.removeEventListener("touchmove",_,Wy),document.removeEventListener("touchstart",T,Wy)}},[]);var R=e.removeScrollBar,B=e.inert;return X.createElement(X.Fragment,null,B?X.createElement(c,{styles:O_e(a)}):null,R?X.createElement($Z,{gapMode:e.gapMode}):null)}function D_e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const L_e=BZ(jZ,R_e);var PS=X.forwardRef(function(e,t){return X.createElement(IC,Qs({},e,{ref:t,sideCar:L_e}))});PS.classNames=IC.classNames;var WD=["Enter"," "],z_e=["ArrowDown","PageUp","Home"],GZ=["ArrowUp","PageDown","End"],N_e=[...z_e,...GZ],F_e={ltr:[...WD,"ArrowRight"],rtl:[...WD,"ArrowLeft"]},B_e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},CS="Menu",[Ew,j_e,$_e]=$0(CS),[E_,HZ]=Al(CS,[$_e,xm,CC]),MC=xm(),qZ=CC(),[U_e,A_]=E_(CS),[V_e,IS]=E_(CS),ZZ=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:c,modal:d=!0}=e,i=MC(t),[_,b]=X.useState(null),T=X.useRef(!1),A=Co(c),k=S_(a);return X.useEffect(()=>{const R=()=>{T.current=!0,document.addEventListener("pointerdown",B,{capture:!0,once:!0}),document.addEventListener("pointermove",B,{capture:!0,once:!0})},B=()=>T.current=!1;return document.addEventListener("keydown",R,{capture:!0}),()=>{document.removeEventListener("keydown",R,{capture:!0}),document.removeEventListener("pointerdown",B,{capture:!0}),document.removeEventListener("pointermove",B,{capture:!0})}},[]),_e.jsx(TC,{...i,children:_e.jsx(U_e,{scope:t,open:n,onOpenChange:A,content:_,onContentChange:b,children:_e.jsx(V_e,{scope:t,onClose:X.useCallback(()=>A(!1),[A]),isUsingKeyboardRef:T,dir:k,modal:d,children:r})})})};ZZ.displayName=CS;var W_e="MenuAnchor",dN=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=MC(n);return _e.jsx(TS,{...a,...r,ref:t})});dN.displayName=W_e;var fN="MenuPortal",[G_e,XZ]=E_(fN,{forceMount:void 0}),KZ=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,c=A_(fN,t);return _e.jsx(G_e,{scope:t,forceMount:n,children:_e.jsx(Aa,{present:n||c.open,children:_e.jsx(ES,{asChild:!0,container:a,children:r})})})};KZ.displayName=fN;var ou="MenuContent",[H_e,pN]=E_(ou),YZ=X.forwardRef((e,t)=>{const n=XZ(ou,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,c=A_(ou,e.__scopeMenu),d=IS(ou,e.__scopeMenu);return _e.jsx(Ew.Provider,{scope:e.__scopeMenu,children:_e.jsx(Aa,{present:r||c.open,children:_e.jsx(Ew.Slot,{scope:e.__scopeMenu,children:d.modal?_e.jsx(q_e,{...a,ref:t}):_e.jsx(Z_e,{...a,ref:t})})})})}),q_e=X.forwardRef((e,t)=>{const n=A_(ou,e.__scopeMenu),r=X.useRef(null),a=Xr(t,r);return X.useEffect(()=>{const c=r.current;if(c)return AS(c)},[]),_e.jsx(mN,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:On(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Z_e=X.forwardRef((e,t)=>{const n=A_(ou,e.__scopeMenu);return _e.jsx(mN,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),mN=X.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:c,onCloseAutoFocus:d,disableOutsidePointerEvents:i,onEntryFocus:_,onEscapeKeyDown:b,onPointerDownOutside:T,onFocusOutside:A,onInteractOutside:k,onDismiss:R,disableOutsideScroll:B,...N}=e,V=A_(ou,n),H=IS(ou,n),G=MC(n),q=qZ(n),Q=j_e(n),[te,ue]=X.useState(null),fe=X.useRef(null),ye=Xr(t,fe,V.onContentChange),De=X.useRef(0),Ne=X.useRef(""),Fe=X.useRef(0),Le=X.useRef(null),Ze=X.useRef("right"),He=X.useRef(0),ct=B?PS:X.Fragment,ot=B?{as:rm,allowPinchZoom:!0}:void 0,rt=nt=>{var Vt,$n;const at=Ne.current+nt,Mt=Q().filter(Gt=>!Gt.disabled),Nt=document.activeElement,rn=(Vt=Mt.find(Gt=>Gt.ref.current===Nt))==null?void 0:Vt.textValue,un=Mt.map(Gt=>Gt.textValue),en=aye(un,at,rn),sn=($n=Mt.find(Gt=>Gt.textValue===en))==null?void 0:$n.ref.current;(function Gt(Tn){Ne.current=Tn,window.clearTimeout(De.current),Tn!==""&&(De.current=window.setTimeout(()=>Gt(""),1e3))})(at),sn&&setTimeout(()=>sn.focus())};X.useEffect(()=>()=>window.clearTimeout(De.current),[]),xC();const Be=X.useCallback(nt=>{var Mt,Nt;return Ze.current===((Mt=Le.current)==null?void 0:Mt.side)&&lye(nt,(Nt=Le.current)==null?void 0:Nt.area)},[]);return _e.jsx(H_e,{scope:n,searchRef:Ne,onItemEnter:X.useCallback(nt=>{Be(nt)&&nt.preventDefault()},[Be]),onItemLeave:X.useCallback(nt=>{var at;Be(nt)||((at=fe.current)==null||at.focus(),ue(null))},[Be]),onTriggerLeave:X.useCallback(nt=>{Be(nt)&&nt.preventDefault()},[Be]),pointerGraceTimerRef:Fe,onPointerGraceIntentChange:X.useCallback(nt=>{Le.current=nt},[]),children:_e.jsx(ct,{...ot,children:_e.jsx(wS,{asChild:!0,trapped:a,onMountAutoFocus:On(c,nt=>{var at;nt.preventDefault(),(at=fe.current)==null||at.focus({preventScroll:!0})}),onUnmountAutoFocus:d,children:_e.jsx(T_,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:b,onPointerDownOutside:T,onFocusOutside:A,onInteractOutside:k,onDismiss:R,children:_e.jsx(kZ,{asChild:!0,...q,dir:H.dir,orientation:"vertical",loop:r,currentTabStopId:te,onCurrentTabStopIdChange:ue,onEntryFocus:On(_,nt=>{H.isUsingKeyboardRef.current||nt.preventDefault()}),preventScrollOnEntryFocus:!0,children:_e.jsx(EC,{role:"menu","aria-orientation":"vertical","data-state":fX(V.open),"data-radix-menu-content":"",dir:H.dir,...G,...N,ref:ye,style:{outline:"none",...N.style},onKeyDown:On(N.onKeyDown,nt=>{const Mt=nt.target.closest("[data-radix-menu-content]")===nt.currentTarget,Nt=nt.ctrlKey||nt.altKey||nt.metaKey,rn=nt.key.length===1;Mt&&(nt.key==="Tab"&&nt.preventDefault(),!Nt&&rn&&rt(nt.key));const un=fe.current;if(nt.target!==un||!N_e.includes(nt.key))return;nt.preventDefault();const sn=Q().filter(Vt=>!Vt.disabled).map(Vt=>Vt.ref.current);GZ.includes(nt.key)&&sn.reverse(),iye(sn)}),onBlur:On(e.onBlur,nt=>{nt.currentTarget.contains(nt.target)||(window.clearTimeout(De.current),Ne.current="")}),onPointerMove:On(e.onPointerMove,Aw(nt=>{const at=nt.target,Mt=He.current!==nt.clientX;if(nt.currentTarget.contains(at)&&Mt){const Nt=nt.clientX>He.current?"right":"left";Ze.current=Nt,He.current=nt.clientX}}))})})})})})})});YZ.displayName=ou;var X_e="MenuGroup",gN=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return _e.jsx(Qn.div,{role:"group",...r,ref:t})});gN.displayName=X_e;var K_e="MenuLabel",JZ=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return _e.jsx(Qn.div,{...r,ref:t})});JZ.displayName=K_e;var TA="MenuItem",NV="menu.itemSelect",OC=X.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,c=X.useRef(null),d=IS(TA,e.__scopeMenu),i=pN(TA,e.__scopeMenu),_=Xr(t,c),b=X.useRef(!1),T=()=>{const A=c.current;if(!n&&A){const k=new CustomEvent(NV,{bubbles:!0,cancelable:!0});A.addEventListener(NV,R=>r==null?void 0:r(R),{once:!0}),vA(A,k),k.defaultPrevented?b.current=!1:d.onClose()}};return _e.jsx(QZ,{...a,ref:_,disabled:n,onClick:On(e.onClick,T),onPointerDown:A=>{var k;(k=e.onPointerDown)==null||k.call(e,A),b.current=!0},onPointerUp:On(e.onPointerUp,A=>{var k;b.current||(k=A.currentTarget)==null||k.click()}),onKeyDown:On(e.onKeyDown,A=>{const k=i.searchRef.current!=="";n||k&&A.key===" "||WD.includes(A.key)&&(A.currentTarget.click(),A.preventDefault())})})});OC.displayName=TA;var QZ=X.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...c}=e,d=pN(TA,n),i=qZ(n),_=X.useRef(null),b=Xr(t,_),[T,A]=X.useState(!1),[k,R]=X.useState("");return X.useEffect(()=>{const B=_.current;B&&R((B.textContent??"").trim())},[c.children]),_e.jsx(Ew.ItemSlot,{scope:n,disabled:r,textValue:a??k,children:_e.jsx(RZ,{asChild:!0,...i,focusable:!r,children:_e.jsx(Qn.div,{role:"menuitem","data-highlighted":T?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...c,ref:b,onPointerMove:On(e.onPointerMove,Aw(B=>{r?d.onItemLeave(B):(d.onItemEnter(B),B.defaultPrevented||B.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:On(e.onPointerLeave,Aw(B=>d.onItemLeave(B))),onFocus:On(e.onFocus,()=>A(!0)),onBlur:On(e.onBlur,()=>A(!1))})})})}),Y_e="MenuCheckboxItem",eX=X.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return _e.jsx(oX,{scope:e.__scopeMenu,checked:n,children:_e.jsx(OC,{role:"menuitemcheckbox","aria-checked":EA(n)?"mixed":n,...a,ref:t,"data-state":yN(n),onSelect:On(a.onSelect,()=>r==null?void 0:r(EA(n)?!0:!n),{checkForDefaultPrevented:!1})})})});eX.displayName=Y_e;var tX="MenuRadioGroup",[J_e,Q_e]=E_(tX,{value:void 0,onValueChange:()=>{}}),nX=X.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,c=Co(r);return _e.jsx(J_e,{scope:e.__scopeMenu,value:n,onValueChange:c,children:_e.jsx(gN,{...a,ref:t})})});nX.displayName=tX;var rX="MenuRadioItem",iX=X.forwardRef((e,t)=>{const{value:n,...r}=e,a=Q_e(rX,e.__scopeMenu),c=n===a.value;return _e.jsx(oX,{scope:e.__scopeMenu,checked:c,children:_e.jsx(OC,{role:"menuitemradio","aria-checked":c,...r,ref:t,"data-state":yN(c),onSelect:On(r.onSelect,()=>{var d;return(d=a.onValueChange)==null?void 0:d.call(a,n)},{checkForDefaultPrevented:!1})})})});iX.displayName=rX;var _N="MenuItemIndicator",[oX,eye]=E_(_N,{checked:!1}),aX=X.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,c=eye(_N,n);return _e.jsx(Aa,{present:r||EA(c.checked)||c.checked===!0,children:_e.jsx(Qn.span,{...a,ref:t,"data-state":yN(c.checked)})})});aX.displayName=_N;var tye="MenuSeparator",sX=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return _e.jsx(Qn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});sX.displayName=tye;var nye="MenuArrow",lX=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=MC(n);return _e.jsx(AC,{...a,...r,ref:t})});lX.displayName=nye;var rye="MenuSub",[TXe,cX]=E_(rye),cb="MenuSubTrigger",uX=X.forwardRef((e,t)=>{const n=A_(cb,e.__scopeMenu),r=IS(cb,e.__scopeMenu),a=cX(cb,e.__scopeMenu),c=pN(cb,e.__scopeMenu),d=X.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:_}=c,b={__scopeMenu:e.__scopeMenu},T=X.useCallback(()=>{d.current&&window.clearTimeout(d.current),d.current=null},[]);return X.useEffect(()=>T,[T]),X.useEffect(()=>{const A=i.current;return()=>{window.clearTimeout(A),_(null)}},[i,_]),_e.jsx(dN,{asChild:!0,...b,children:_e.jsx(QZ,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":fX(n.open),...e,ref:yS(t,a.onTriggerChange),onClick:A=>{var k;(k=e.onClick)==null||k.call(e,A),!(e.disabled||A.defaultPrevented)&&(A.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:On(e.onPointerMove,Aw(A=>{c.onItemEnter(A),!A.defaultPrevented&&!e.disabled&&!n.open&&!d.current&&(c.onPointerGraceIntentChange(null),d.current=window.setTimeout(()=>{n.onOpenChange(!0),T()},100))})),onPointerLeave:On(e.onPointerLeave,Aw(A=>{var R,B;T();const k=(R=n.content)==null?void 0:R.getBoundingClientRect();if(k){const N=(B=n.content)==null?void 0:B.dataset.side,V=N==="right",H=V?-5:5,G=k[V?"left":"right"],q=k[V?"right":"left"];c.onPointerGraceIntentChange({area:[{x:A.clientX+H,y:A.clientY},{x:G,y:k.top},{x:q,y:k.top},{x:q,y:k.bottom},{x:G,y:k.bottom}],side:N}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(A),A.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:On(e.onKeyDown,A=>{var R;const k=c.searchRef.current!=="";e.disabled||k&&A.key===" "||F_e[r.dir].includes(A.key)&&(n.onOpenChange(!0),(R=n.content)==null||R.focus(),A.preventDefault())})})})});uX.displayName=cb;var hX="MenuSubContent",dX=X.forwardRef((e,t)=>{const n=XZ(ou,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,c=A_(ou,e.__scopeMenu),d=IS(ou,e.__scopeMenu),i=cX(hX,e.__scopeMenu),_=X.useRef(null),b=Xr(t,_);return _e.jsx(Ew.Provider,{scope:e.__scopeMenu,children:_e.jsx(Aa,{present:r||c.open,children:_e.jsx(Ew.Slot,{scope:e.__scopeMenu,children:_e.jsx(mN,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:b,align:"start",side:d.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:T=>{var A;d.isUsingKeyboardRef.current&&((A=_.current)==null||A.focus()),T.preventDefault()},onCloseAutoFocus:T=>T.preventDefault(),onFocusOutside:On(e.onFocusOutside,T=>{T.target!==i.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:On(e.onEscapeKeyDown,T=>{d.onClose(),T.preventDefault()}),onKeyDown:On(e.onKeyDown,T=>{var R;const A=T.currentTarget.contains(T.target),k=B_e[d.dir].includes(T.key);A&&k&&(c.onOpenChange(!1),(R=i.trigger)==null||R.focus(),T.preventDefault())})})})})})});dX.displayName=hX;function fX(e){return e?"open":"closed"}function EA(e){return e==="indeterminate"}function yN(e){return EA(e)?"indeterminate":e?"checked":"unchecked"}function iye(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function oye(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function aye(e,t,n){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let d=oye(e,Math.max(c,0));a.length===1&&(d=d.filter(b=>b!==n));const _=d.find(b=>b.toLowerCase().startsWith(a.toLowerCase()));return _!==n?_:void 0}function sye(e,t){const{x:n,y:r}=e;let a=!1;for(let c=0,d=t.length-1;c<t.length;d=c++){const i=t[c].x,_=t[c].y,b=t[d].x,T=t[d].y;_>r!=T>r&&n<(b-i)*(r-_)/(T-_)+i&&(a=!a)}return a}function lye(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return sye(n,t)}function Aw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var cye=ZZ,uye=dN,hye=KZ,dye=YZ,fye=gN,pye=JZ,mye=OC,gye=eX,_ye=nX,yye=iX,vye=aX,xye=sX,bye=lX,wye=uX,Sye=dX,vN="DropdownMenu",[Tye,EXe]=Al(vN,[HZ]),Pl=HZ(),[Eye,pX]=Tye(vN),mX=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:c,onOpenChange:d,modal:i=!0}=e,_=Pl(t),b=X.useRef(null),[T=!1,A]=Sl({prop:a,defaultProp:c,onChange:d});return _e.jsx(Eye,{scope:t,triggerId:el(),triggerRef:b,contentId:el(),open:T,onOpenChange:A,onOpenToggle:X.useCallback(()=>A(k=>!k),[A]),modal:i,children:_e.jsx(cye,{..._,open:T,onOpenChange:A,dir:r,modal:i,children:n})})};mX.displayName=vN;var gX="DropdownMenuTrigger",_X=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,c=pX(gX,n),d=Pl(n);return _e.jsx(uye,{asChild:!0,...d,children:_e.jsx(Qn.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:yS(t,c.triggerRef),onPointerDown:On(e.onPointerDown,i=>{!r&&i.button===0&&i.ctrlKey===!1&&(c.onOpenToggle(),c.open||i.preventDefault())}),onKeyDown:On(e.onKeyDown,i=>{r||(["Enter"," "].includes(i.key)&&c.onOpenToggle(),i.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});_X.displayName=gX;var Aye="DropdownMenuPortal",yX=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Pl(t);return _e.jsx(hye,{...r,...n})};yX.displayName=Aye;var vX="DropdownMenuContent",xX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=pX(vX,n),c=Pl(n),d=X.useRef(!1);return _e.jsx(dye,{id:a.contentId,"aria-labelledby":a.triggerId,...c,...r,ref:t,onCloseAutoFocus:On(e.onCloseAutoFocus,i=>{var _;d.current||(_=a.triggerRef.current)==null||_.focus(),d.current=!1,i.preventDefault()}),onInteractOutside:On(e.onInteractOutside,i=>{const _=i.detail.originalEvent,b=_.button===0&&_.ctrlKey===!0,T=_.button===2||b;(!a.modal||T)&&(d.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xX.displayName=vX;var Pye="DropdownMenuGroup",Cye=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(fye,{...a,...r,ref:t})});Cye.displayName=Pye;var Iye="DropdownMenuLabel",bX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(pye,{...a,...r,ref:t})});bX.displayName=Iye;var Mye="DropdownMenuItem",wX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(mye,{...a,...r,ref:t})});wX.displayName=Mye;var Oye="DropdownMenuCheckboxItem",SX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(gye,{...a,...r,ref:t})});SX.displayName=Oye;var kye="DropdownMenuRadioGroup",Rye=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(_ye,{...a,...r,ref:t})});Rye.displayName=kye;var Dye="DropdownMenuRadioItem",TX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(yye,{...a,...r,ref:t})});TX.displayName=Dye;var Lye="DropdownMenuItemIndicator",EX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(vye,{...a,...r,ref:t})});EX.displayName=Lye;var zye="DropdownMenuSeparator",AX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(xye,{...a,...r,ref:t})});AX.displayName=zye;var Nye="DropdownMenuArrow",Fye=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(bye,{...a,...r,ref:t})});Fye.displayName=Nye;var Bye="DropdownMenuSubTrigger",PX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(wye,{...a,...r,ref:t})});PX.displayName=Bye;var jye="DropdownMenuSubContent",CX=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pl(n);return _e.jsx(Sye,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});CX.displayName=jye;var AXe=mX,PXe=_X,CXe=yX,IXe=xX,MXe=bX,OXe=wX,kXe=SX,RXe=TX,DXe=EX,LXe=AX,zXe=PX,NXe=CX;/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ye=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IX=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Uye={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vye=X.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:c,iconNode:d,...i},_)=>X.createElement("svg",{ref:_,...Uye,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:IX("lucide",a),...i},[...d.map(([b,T])=>X.createElement(b,T)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=(e,t)=>{const n=X.forwardRef(({className:r,...a},c)=>X.createElement(Vye,{ref:c,iconNode:t,className:IX(`lucide-${$ye(e)}`,r),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FXe=ln("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BXe=ln("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jXe=ln("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Xe=ln("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UXe=ln("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VXe=ln("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WXe=ln("BluetoothConnected",[["path",{d:"m7 7 10 10-5 5V2l5 5L7 17",key:"1q5490"}],["line",{x1:"18",x2:"21",y1:"12",y2:"12",key:"1rsjjs"}],["line",{x1:"3",x2:"6",y1:"12",y2:"12",key:"11yl8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GXe=ln("Bluetooth",[["path",{d:"m7 7 10 10-5 5V2l5 5L7 17",key:"1q5490"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HXe=ln("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qXe=ln("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZXe=ln("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XXe=ln("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KXe=ln("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YXe=ln("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JXe=ln("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QXe=ln("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eKe=ln("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tKe=ln("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nKe=ln("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rKe=ln("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iKe=ln("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oKe=ln("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aKe=ln("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sKe=ln("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lKe=ln("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cKe=ln("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uKe=ln("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hKe=ln("CloudSnow",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dKe=ln("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fKe=ln("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pKe=ln("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mKe=ln("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gKe=ln("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Ke=ln("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yKe=ln("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vKe=ln("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xKe=ln("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bKe=ln("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wKe=ln("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SKe=ln("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TKe=ln("FileCog",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3.2 12.9-.9-.4",key:"1i3dj5"}],["path",{d:"m3.2 15.1-.9.4",key:"1fvgj0"}],["path",{d:"M4.677 21.5a2 2 0 0 0 1.313.5H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2.5",key:"1yo3oz"}],["path",{d:"m4.9 11.2-.4-.9",key:"otmhb9"}],["path",{d:"m4.9 16.8-.4.9",key:"1b8z07"}],["path",{d:"m7.5 10.3-.4.9",key:"11k65u"}],["path",{d:"m7.5 17.7-.4-.9",key:"431x55"}],["path",{d:"m9.7 12.5-.9.4",key:"87sjan"}],["path",{d:"m9.7 15.5-.9-.4",key:"khqm91"}],["circle",{cx:"6",cy:"14",r:"3",key:"a1xfv6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EKe=ln("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AKe=ln("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PKe=ln("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CKe=ln("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IKe=ln("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MKe=ln("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OKe=ln("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kKe=ln("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RKe=ln("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DKe=ln("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LKe=ln("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zKe=ln("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NKe=ln("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FKe=ln("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BKe=ln("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jKe=ln("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ke=ln("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UKe=ln("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VKe=ln("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WKe=ln("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GKe=ln("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HKe=ln("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qKe=ln("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZKe=ln("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XKe=ln("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KKe=ln("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YKe=ln("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JKe=ln("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QKe=ln("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eYe=ln("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tYe=ln("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nYe=ln("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rYe=ln("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iYe=ln("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oYe=ln("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aYe=ln("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sYe=ln("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lYe=ln("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cYe=ln("Repeat2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uYe=ln("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hYe=ln("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dYe=ln("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fYe=ln("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pYe=ln("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mYe=ln("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gYe=ln("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Ye=ln("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yYe=ln("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vYe=ln("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xYe=ln("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bYe=ln("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wYe=ln("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SYe=ln("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TYe=ln("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EYe=ln("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AYe=ln("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PYe=ln("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CYe=ln("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IYe=ln("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MYe=ln("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OYe=ln("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kYe=ln("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RYe=ln("Tractor",[["path",{d:"m10 11 11 .9a1 1 0 0 1 .8 1.1l-.665 4.158a1 1 0 0 1-.988.842H20",key:"she1j9"}],["path",{d:"M16 18h-5",key:"bq60fd"}],["path",{d:"M18 5a1 1 0 0 0-1 1v5.573",key:"1kv8ia"}],["path",{d:"M3 4h8.129a1 1 0 0 1 .99.863L13 11.246",key:"1q1ert"}],["path",{d:"M4 11V4",key:"9ft8pt"}],["path",{d:"M7 15h.01",key:"k5ht0j"}],["path",{d:"M8 10.1V4",key:"1jgyzo"}],["circle",{cx:"18",cy:"18",r:"2",key:"1emm8v"}],["circle",{cx:"7",cy:"15",r:"5",key:"ddtuc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DYe=ln("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LYe=ln("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zYe=ln("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NYe=ln("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FYe=ln("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BYe=ln("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jYe=ln("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ye=ln("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UYe=ln("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VYe=ln("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WYe=ln("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GYe=ln("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HYe=ln("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qYe=ln("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZYe=ln("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XYe=ln("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KYe=ln("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function kC(e){const t=X.useRef({value:e,previous:e});return X.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Wye="VisuallyHidden",xN=X.forwardRef((e,t)=>_e.jsx(Qn.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));xN.displayName=Wye;var MX=xN,W0="NavigationMenu",[bN,OX,Gye]=$0(W0),[GD,Hye,qye]=$0(W0),[wN,YYe]=Al(W0,[Gye,qye]),[Zye,hu]=wN(W0),[Xye,Kye]=wN(W0),kX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,onValueChange:a,defaultValue:c,delayDuration:d=200,skipDelayDuration:i=300,orientation:_="horizontal",dir:b,...T}=e,[A,k]=X.useState(null),R=Xr(t,De=>k(De)),B=S_(b),N=X.useRef(0),V=X.useRef(0),H=X.useRef(0),[G,q]=X.useState(!0),[Q="",te]=Sl({prop:r,onChange:De=>{const Ne=De!=="",Fe=i>0;Ne?(window.clearTimeout(H.current),Fe&&q(!1)):(window.clearTimeout(H.current),H.current=window.setTimeout(()=>q(!0),i)),a==null||a(De)},defaultProp:c}),ue=X.useCallback(()=>{window.clearTimeout(V.current),V.current=window.setTimeout(()=>te(""),150)},[te]),fe=X.useCallback(De=>{window.clearTimeout(V.current),te(De)},[te]),ye=X.useCallback(De=>{Q===De?window.clearTimeout(V.current):N.current=window.setTimeout(()=>{window.clearTimeout(V.current),te(De)},d)},[Q,te,d]);return X.useEffect(()=>()=>{window.clearTimeout(N.current),window.clearTimeout(V.current),window.clearTimeout(H.current)},[]),_e.jsx(DX,{scope:n,isRootMenu:!0,value:Q,dir:B,orientation:_,rootNavigationMenu:A,onTriggerEnter:De=>{window.clearTimeout(N.current),G?ye(De):fe(De)},onTriggerLeave:()=>{window.clearTimeout(N.current),ue()},onContentEnter:()=>window.clearTimeout(V.current),onContentLeave:ue,onItemSelect:De=>{te(Ne=>Ne===De?"":De)},onItemDismiss:()=>te(""),children:_e.jsx(Qn.nav,{"aria-label":"Main","data-orientation":_,dir:B,...T,ref:R})})});kX.displayName=W0;var RX="NavigationMenuSub",Yye=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,onValueChange:a,defaultValue:c,orientation:d="horizontal",...i}=e,_=hu(RX,n),[b="",T]=Sl({prop:r,onChange:a,defaultProp:c});return _e.jsx(DX,{scope:n,isRootMenu:!1,value:b,dir:_.dir,orientation:d,rootNavigationMenu:_.rootNavigationMenu,onTriggerEnter:A=>T(A),onItemSelect:A=>T(A),onItemDismiss:()=>T(""),children:_e.jsx(Qn.div,{"data-orientation":d,...i,ref:t})})});Yye.displayName=RX;var DX=e=>{const{scope:t,isRootMenu:n,rootNavigationMenu:r,dir:a,orientation:c,children:d,value:i,onItemSelect:_,onItemDismiss:b,onTriggerEnter:T,onTriggerLeave:A,onContentEnter:k,onContentLeave:R}=e,[B,N]=X.useState(null),[V,H]=X.useState(new Map),[G,q]=X.useState(null);return _e.jsx(Zye,{scope:t,isRootMenu:n,rootNavigationMenu:r,value:i,previousValue:kC(i),baseId:el(),dir:a,orientation:c,viewport:B,onViewportChange:N,indicatorTrack:G,onIndicatorTrackChange:q,onTriggerEnter:Co(T),onTriggerLeave:Co(A),onContentEnter:Co(k),onContentLeave:Co(R),onItemSelect:Co(_),onItemDismiss:Co(b),onViewportContentChange:X.useCallback((Q,te)=>{H(ue=>(ue.set(Q,te),new Map(ue)))},[]),onViewportContentRemove:X.useCallback(Q=>{H(te=>te.has(Q)?(te.delete(Q),new Map(te)):te)},[]),children:_e.jsx(bN.Provider,{scope:t,children:_e.jsx(Xye,{scope:t,items:V,children:d})})})},LX="NavigationMenuList",zX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=hu(LX,n),c=_e.jsx(Qn.ul,{"data-orientation":a.orientation,...r,ref:t});return _e.jsx(Qn.div,{style:{position:"relative"},ref:a.onIndicatorTrackChange,children:_e.jsx(bN.Slot,{scope:n,children:a.isRootMenu?_e.jsx(HX,{asChild:!0,children:c}):c})})});zX.displayName=LX;var NX="NavigationMenuItem",[Jye,FX]=wN(NX),BX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,...a}=e,c=el(),d=r||c||"LEGACY_REACT_AUTO_VALUE",i=X.useRef(null),_=X.useRef(null),b=X.useRef(null),T=X.useRef(()=>{}),A=X.useRef(!1),k=X.useCallback((B="start")=>{if(i.current){T.current();const N=qD(i.current);N.length&&EN(B==="start"?N:N.reverse())}},[]),R=X.useCallback(()=>{if(i.current){const B=qD(i.current);B.length&&(T.current=ove(B))}},[]);return _e.jsx(Jye,{scope:n,value:d,triggerRef:_,contentRef:i,focusProxyRef:b,wasEscapeCloseRef:A,onEntryKeyDown:k,onFocusProxyEnter:k,onRootContentClose:R,onContentFocusOutside:R,children:_e.jsx(Qn.li,{...a,ref:t})})});BX.displayName=NX;var HD="NavigationMenuTrigger",jX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,disabled:r,...a}=e,c=hu(HD,e.__scopeNavigationMenu),d=FX(HD,e.__scopeNavigationMenu),i=X.useRef(null),_=Xr(i,d.triggerRef,t),b=ZX(c.baseId,d.value),T=XX(c.baseId,d.value),A=X.useRef(!1),k=X.useRef(!1),R=d.value===c.value;return _e.jsxs(_e.Fragment,{children:[_e.jsx(bN.ItemSlot,{scope:n,value:d.value,children:_e.jsx(qX,{asChild:!0,children:_e.jsx(Qn.button,{id:b,disabled:r,"data-disabled":r?"":void 0,"data-state":AN(R),"aria-expanded":R,"aria-controls":T,...a,ref:_,onPointerEnter:On(e.onPointerEnter,()=>{k.current=!1,d.wasEscapeCloseRef.current=!1}),onPointerMove:On(e.onPointerMove,AA(()=>{r||k.current||d.wasEscapeCloseRef.current||A.current||(c.onTriggerEnter(d.value),A.current=!0)})),onPointerLeave:On(e.onPointerLeave,AA(()=>{r||(c.onTriggerLeave(),A.current=!1)})),onClick:On(e.onClick,()=>{c.onItemSelect(d.value),k.current=R}),onKeyDown:On(e.onKeyDown,B=>{const V={horizontal:"ArrowDown",vertical:c.dir==="rtl"?"ArrowLeft":"ArrowRight"}[c.orientation];R&&B.key===V&&(d.onEntryKeyDown(),B.preventDefault())})})})}),R&&_e.jsxs(_e.Fragment,{children:[_e.jsx(MX,{"aria-hidden":!0,tabIndex:0,ref:d.focusProxyRef,onFocus:B=>{const N=d.contentRef.current,V=B.relatedTarget,H=V===i.current,G=N==null?void 0:N.contains(V);(H||!G)&&d.onFocusProxyEnter(H?"start":"end")}}),c.viewport&&_e.jsx("span",{"aria-owns":T})]})]})});jX.displayName=HD;var Qye="NavigationMenuLink",FV="navigationMenu.linkSelect",$X=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,active:r,onSelect:a,...c}=e;return _e.jsx(qX,{asChild:!0,children:_e.jsx(Qn.a,{"data-active":r?"":void 0,"aria-current":r?"page":void 0,...c,ref:t,onClick:On(e.onClick,d=>{const i=d.target,_=new CustomEvent(FV,{bubbles:!0,cancelable:!0});if(i.addEventListener(FV,b=>a==null?void 0:a(b),{once:!0}),vA(i,_),!_.defaultPrevented&&!d.metaKey){const b=new CustomEvent(I2,{bubbles:!0,cancelable:!0});vA(i,b)}},{checkForDefaultPrevented:!1})})})});$X.displayName=Qye;var SN="NavigationMenuIndicator",UX=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=hu(SN,e.__scopeNavigationMenu),c=!!a.value;return a.indicatorTrack?uC.createPortal(_e.jsx(Aa,{present:n||c,children:_e.jsx(eve,{...r,ref:t})}),a.indicatorTrack):null});UX.displayName=SN;var eve=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=hu(SN,n),c=OX(n),[d,i]=X.useState(null),[_,b]=X.useState(null),T=a.orientation==="horizontal",A=!!a.value;X.useEffect(()=>{var N;const B=(N=c().find(V=>V.value===a.value))==null?void 0:N.ref.current;B&&i(B)},[c,a.value]);const k=()=>{d&&b({size:T?d.offsetWidth:d.offsetHeight,offset:T?d.offsetLeft:d.offsetTop})};return ZD(d,k),ZD(a.indicatorTrack,k),_?_e.jsx(Qn.div,{"aria-hidden":!0,"data-state":A?"visible":"hidden","data-orientation":a.orientation,...r,ref:t,style:{position:"absolute",...T?{left:0,width:_.size+"px",transform:`translateX(${_.offset}px)`}:{top:0,height:_.size+"px",transform:`translateY(${_.offset}px)`},...r.style}}):null}),Zv="NavigationMenuContent",VX=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=hu(Zv,e.__scopeNavigationMenu),c=FX(Zv,e.__scopeNavigationMenu),d=Xr(c.contentRef,t),i=c.value===a.value,_={value:c.value,triggerRef:c.triggerRef,focusProxyRef:c.focusProxyRef,wasEscapeCloseRef:c.wasEscapeCloseRef,onContentFocusOutside:c.onContentFocusOutside,onRootContentClose:c.onRootContentClose,...r};return a.viewport?_e.jsx(tve,{forceMount:n,..._,ref:d}):_e.jsx(Aa,{present:n||i,children:_e.jsx(WX,{"data-state":AN(i),..._,ref:d,onPointerEnter:On(e.onPointerEnter,a.onContentEnter),onPointerLeave:On(e.onPointerLeave,AA(a.onContentLeave)),style:{pointerEvents:!i&&a.isRootMenu?"none":void 0,..._.style}})})});VX.displayName=Zv;var tve=X.forwardRef((e,t)=>{const n=hu(Zv,e.__scopeNavigationMenu),{onViewportContentChange:r,onViewportContentRemove:a}=n;return Ea(()=>{r(e.value,{ref:t,...e})},[e,t,r]),Ea(()=>()=>a(e.value),[e.value,a]),null}),I2="navigationMenu.rootContentDismiss",WX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,triggerRef:a,focusProxyRef:c,wasEscapeCloseRef:d,onRootContentClose:i,onContentFocusOutside:_,...b}=e,T=hu(Zv,n),A=X.useRef(null),k=Xr(A,t),R=ZX(T.baseId,r),B=XX(T.baseId,r),N=OX(n),V=X.useRef(null),{onItemDismiss:H}=T;X.useEffect(()=>{const q=A.current;if(T.isRootMenu&&q){const Q=()=>{var te;H(),i(),q.contains(document.activeElement)&&((te=a.current)==null||te.focus())};return q.addEventListener(I2,Q),()=>q.removeEventListener(I2,Q)}},[T.isRootMenu,e.value,a,H,i]);const G=X.useMemo(()=>{const Q=N().map(Ne=>Ne.value);T.dir==="rtl"&&Q.reverse();const te=Q.indexOf(T.value),ue=Q.indexOf(T.previousValue),fe=r===T.value,ye=ue===Q.indexOf(r);if(!fe&&!ye)return V.current;const De=(()=>{if(te!==ue){if(fe&&ue!==-1)return te>ue?"from-end":"from-start";if(ye&&te!==-1)return te>ue?"to-start":"to-end"}return null})();return V.current=De,De},[T.previousValue,T.value,T.dir,N,r]);return _e.jsx(HX,{asChild:!0,children:_e.jsx(T_,{id:B,"aria-labelledby":R,"data-motion":G,"data-orientation":T.orientation,...b,ref:k,disableOutsidePointerEvents:!1,onDismiss:()=>{var Q;const q=new Event(I2,{bubbles:!0,cancelable:!0});(Q=A.current)==null||Q.dispatchEvent(q)},onFocusOutside:On(e.onFocusOutside,q=>{var te;_();const Q=q.target;(te=T.rootNavigationMenu)!=null&&te.contains(Q)&&q.preventDefault()}),onPointerDownOutside:On(e.onPointerDownOutside,q=>{var fe;const Q=q.target,te=N().some(ye=>{var De;return(De=ye.ref.current)==null?void 0:De.contains(Q)}),ue=T.isRootMenu&&((fe=T.viewport)==null?void 0:fe.contains(Q));(te||ue||!T.isRootMenu)&&q.preventDefault()}),onKeyDown:On(e.onKeyDown,q=>{var ue;const Q=q.altKey||q.ctrlKey||q.metaKey;if(q.key==="Tab"&&!Q){const fe=qD(q.currentTarget),ye=document.activeElement,De=fe.findIndex(Le=>Le===ye),Fe=q.shiftKey?fe.slice(0,De).reverse():fe.slice(De+1,fe.length);EN(Fe)?q.preventDefault():(ue=c.current)==null||ue.focus()}}),onEscapeKeyDown:On(e.onEscapeKeyDown,q=>{d.current=!0})})})}),TN="NavigationMenuViewport",GX=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,c=!!hu(TN,e.__scopeNavigationMenu).value;return _e.jsx(Aa,{present:n||c,children:_e.jsx(nve,{...r,ref:t})})});GX.displayName=TN;var nve=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,children:r,...a}=e,c=hu(TN,n),d=Xr(t,c.onViewportChange),i=Kye(Zv,e.__scopeNavigationMenu),[_,b]=X.useState(null),[T,A]=X.useState(null),k=_?(_==null?void 0:_.width)+"px":void 0,R=_?(_==null?void 0:_.height)+"px":void 0,B=!!c.value,N=B?c.value:c.previousValue;return ZD(T,()=>{T&&b({width:T.offsetWidth,height:T.offsetHeight})}),_e.jsx(Qn.div,{"data-state":AN(B),"data-orientation":c.orientation,...a,ref:d,style:{pointerEvents:!B&&c.isRootMenu?"none":void 0,"--radix-navigation-menu-viewport-width":k,"--radix-navigation-menu-viewport-height":R,...a.style},onPointerEnter:On(e.onPointerEnter,c.onContentEnter),onPointerLeave:On(e.onPointerLeave,AA(c.onContentLeave)),children:Array.from(i.items).map(([H,{ref:G,forceMount:q,...Q}])=>{const te=N===H;return _e.jsx(Aa,{present:q||te,children:_e.jsx(WX,{...Q,ref:yS(G,ue=>{te&&ue&&A(ue)})})},H)})})}),rve="FocusGroup",HX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=hu(rve,n);return _e.jsx(GD.Provider,{scope:n,children:_e.jsx(GD.Slot,{scope:n,children:_e.jsx(Qn.div,{dir:a.dir,...r,ref:t})})})}),BV=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],ive="FocusGroupItem",qX=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=Hye(n),c=hu(ive,n);return _e.jsx(GD.ItemSlot,{scope:n,children:_e.jsx(Qn.button,{...r,ref:t,onKeyDown:On(e.onKeyDown,d=>{if(["Home","End",...BV].includes(d.key)){let _=a().map(A=>A.ref.current);if([c.dir==="rtl"?"ArrowRight":"ArrowLeft","ArrowUp","End"].includes(d.key)&&_.reverse(),BV.includes(d.key)){const A=_.indexOf(d.currentTarget);_=_.slice(A+1)}setTimeout(()=>EN(_)),d.preventDefault()}})})})});function qD(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function EN(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}function ove(e){return e.forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")}),()=>{e.forEach(t=>{const n=t.dataset.tabindex;t.setAttribute("tabindex",n)})}}function ZD(e,t){const n=Co(t);Ea(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}function AN(e){return e?"open":"closed"}function ZX(e,t){return`${e}-trigger-${t}`}function XX(e,t){return`${e}-content-${t}`}function AA(e){return t=>t.pointerType==="mouse"?e(t):void 0}var JYe=kX,QYe=zX,eJe=BX,tJe=jX,nJe=$X,rJe=UX,iJe=VX,oJe=GX,PN="Tabs",[ave,aJe]=Al(PN,[CC]),KX=CC(),[sve,CN]=ave(PN),YX=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:c,orientation:d="horizontal",dir:i,activationMode:_="automatic",...b}=e,T=S_(i),[A,k]=Sl({prop:r,onChange:a,defaultProp:c});return _e.jsx(sve,{scope:n,baseId:el(),value:A,onValueChange:k,orientation:d,dir:T,activationMode:_,children:_e.jsx(Qn.div,{dir:T,"data-orientation":d,...b,ref:t})})});YX.displayName=PN;var JX="TabsList",QX=X.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,c=CN(JX,n),d=KX(n);return _e.jsx(kZ,{asChild:!0,...d,orientation:c.orientation,dir:c.dir,loop:r,children:_e.jsx(Qn.div,{role:"tablist","aria-orientation":c.orientation,...a,ref:t})})});QX.displayName=JX;var eK="TabsTrigger",tK=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...c}=e,d=CN(eK,n),i=KX(n),_=iK(d.baseId,r),b=oK(d.baseId,r),T=r===d.value;return _e.jsx(RZ,{asChild:!0,...i,focusable:!a,active:T,children:_e.jsx(Qn.button,{type:"button",role:"tab","aria-selected":T,"aria-controls":b,"data-state":T?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:_,...c,ref:t,onMouseDown:On(e.onMouseDown,A=>{!a&&A.button===0&&A.ctrlKey===!1?d.onValueChange(r):A.preventDefault()}),onKeyDown:On(e.onKeyDown,A=>{[" ","Enter"].includes(A.key)&&d.onValueChange(r)}),onFocus:On(e.onFocus,()=>{const A=d.activationMode!=="manual";!T&&!a&&A&&d.onValueChange(r)})})})});tK.displayName=eK;var nK="TabsContent",rK=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:c,...d}=e,i=CN(nK,n),_=iK(i.baseId,r),b=oK(i.baseId,r),T=r===i.value,A=X.useRef(T);return X.useEffect(()=>{const k=requestAnimationFrame(()=>A.current=!1);return()=>cancelAnimationFrame(k)},[]),_e.jsx(Aa,{present:a||T,children:({present:k})=>_e.jsx(Qn.div,{"data-state":T?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":_,hidden:!k,id:b,tabIndex:0,...d,ref:t,style:{...e.style,animationDuration:A.current?"0s":void 0},children:k&&c})})});rK.displayName=nK;function iK(e,t){return`${e}-trigger-${t}`}function oK(e,t){return`${e}-content-${t}`}var sJe=YX,lJe=QX,cJe=tK,uJe=rK;function Kp(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function jV(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function aK(...e){return t=>{let n=!1;const r=e.map(a=>{const c=jV(a,t);return!n&&typeof c=="function"&&(n=!0),c});if(n)return()=>{for(let a=0;a<r.length;a++){const c=r[a];typeof c=="function"?c():jV(e[a],null)}}}}function P_(...e){return X.useCallback(aK(...e),e)}function lve(e,t){const n=X.createContext(t),r=c=>{const{children:d,...i}=c,_=X.useMemo(()=>i,Object.values(i));return _e.jsx(n.Provider,{value:_,children:d})};r.displayName=e+"Provider";function a(c){const d=X.useContext(n);if(d)return d;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[r,a]}function cve(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];const b=A=>{var H;const{scope:k,children:R,...B}=A,N=((H=k==null?void 0:k[e])==null?void 0:H[_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})};b.displayName=c+"Provider";function T(A,k){var N;const R=((N=k==null?void 0:k[e])==null?void 0:N[_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,uve(a,...t)]}function uve(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}var PA=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},hve=Qz[" useId ".trim().toString()]||(()=>{}),dve=0;function Mk(e){const[t,n]=X.useState(hve());return PA(()=>{e||n(r=>r??String(dve++))},[e]),e||(t?`radix-${t}`:"")}function a_(e){const t=X.useRef(e);return X.useEffect(()=>{t.current=e}),X.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function fve({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,a]=pve({defaultProp:t,onChange:n}),c=e!==void 0,d=c?e:r,i=a_(n),_=X.useCallback(b=>{if(c){const A=typeof b=="function"?b(e):b;A!==e&&i(A)}else a(b)},[c,e,a,i]);return[d,_]}function pve({defaultProp:e,onChange:t}){const n=X.useState(e),[r]=n,a=X.useRef(r),c=a_(t);return X.useEffect(()=>{a.current!==r&&(c(r),a.current=r)},[r,a,c]),n}function sK(e){const t=mve(e),n=X.forwardRef((r,a)=>{const{children:c,...d}=r,i=X.Children.toArray(c),_=i.find(_ve);if(_){const b=_.props.children,T=i.map(A=>A===_?X.Children.count(b)>1?X.Children.only(null):X.isValidElement(b)?b.props.children:null:A);return _e.jsx(t,{...d,ref:a,children:X.isValidElement(b)?X.cloneElement(b,void 0,T):null})}return _e.jsx(t,{...d,ref:a,children:c})});return n.displayName=`${e}.Slot`,n}function mve(e){const t=X.forwardRef((n,r)=>{const{children:a,...c}=n;if(X.isValidElement(a)){const d=vve(a),i=yve(c,a.props);return a.type!==X.Fragment&&(i.ref=r?aK(r,d):d),X.cloneElement(a,i)}return X.Children.count(a)>1?X.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var gve=Symbol("radix.slottable");function _ve(e){return X.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===gve}function yve(e,t){const n={...t};for(const r in t){const a=e[r],c=t[r];/^on[A-Z]/.test(r)?a&&c?n[r]=(...i)=>{c(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...c}:r==="className"&&(n[r]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}function vve(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var xve=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],bf=xve.reduce((e,t)=>{const n=sK(`Primitive.${t}`),r=X.forwardRef((a,c)=>{const{asChild:d,...i}=a,_=d?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_e.jsx(_,{...i,ref:c})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function bve(e,t){e&&ym.flushSync(()=>e.dispatchEvent(t))}function wve(e,t=globalThis==null?void 0:globalThis.document){const n=a_(e);X.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Sve="DismissableLayer",XD="dismissableLayer.update",Tve="dismissableLayer.pointerDownOutside",Eve="dismissableLayer.focusOutside",$V,lK=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cK=X.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:d,onDismiss:i,..._}=e,b=X.useContext(lK),[T,A]=X.useState(null),k=(T==null?void 0:T.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,R]=X.useState({}),B=P_(t,fe=>A(fe)),N=Array.from(b.layers),[V]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),H=N.indexOf(V),G=T?N.indexOf(T):-1,q=b.layersWithOutsidePointerEventsDisabled.size>0,Q=G>=H,te=Cve(fe=>{const ye=fe.target,De=[...b.branches].some(Ne=>Ne.contains(ye));!Q||De||(a==null||a(fe),d==null||d(fe),fe.defaultPrevented||i==null||i())},k),ue=Ive(fe=>{const ye=fe.target;[...b.branches].some(Ne=>Ne.contains(ye))||(c==null||c(fe),d==null||d(fe),fe.defaultPrevented||i==null||i())},k);return wve(fe=>{G===b.layers.size-1&&(r==null||r(fe),!fe.defaultPrevented&&i&&(fe.preventDefault(),i()))},k),X.useEffect(()=>{if(T)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&($V=k.body.style.pointerEvents,k.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(T)),b.layers.add(T),UV(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(k.body.style.pointerEvents=$V)}},[T,k,n,b]),X.useEffect(()=>()=>{T&&(b.layers.delete(T),b.layersWithOutsidePointerEventsDisabled.delete(T),UV())},[T,b]),X.useEffect(()=>{const fe=()=>R({});return document.addEventListener(XD,fe),()=>document.removeEventListener(XD,fe)},[]),_e.jsx(bf.div,{..._,ref:B,style:{pointerEvents:q?Q?"auto":"none":void 0,...e.style},onFocusCapture:Kp(e.onFocusCapture,ue.onFocusCapture),onBlurCapture:Kp(e.onBlurCapture,ue.onBlurCapture),onPointerDownCapture:Kp(e.onPointerDownCapture,te.onPointerDownCapture)})});cK.displayName=Sve;var Ave="DismissableLayerBranch",Pve=X.forwardRef((e,t)=>{const n=X.useContext(lK),r=X.useRef(null),a=P_(t,r);return X.useEffect(()=>{const c=r.current;if(c)return n.branches.add(c),()=>{n.branches.delete(c)}},[n.branches]),_e.jsx(bf.div,{...e,ref:a})});Pve.displayName=Ave;function Cve(e,t=globalThis==null?void 0:globalThis.document){const n=a_(e),r=X.useRef(!1),a=X.useRef(()=>{});return X.useEffect(()=>{const c=i=>{if(i.target&&!r.current){let _=function(){uK(Tve,n,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);r.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Ive(e,t=globalThis==null?void 0:globalThis.document){const n=a_(e),r=X.useRef(!1);return X.useEffect(()=>{const a=c=>{c.target&&!r.current&&uK(Eve,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function UV(){const e=new CustomEvent(XD);document.dispatchEvent(e)}function uK(e,t,n,{discrete:r}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?bve(a,c):a.dispatchEvent(c)}var Ok="focusScope.autoFocusOnMount",kk="focusScope.autoFocusOnUnmount",VV={bubbles:!1,cancelable:!0},Mve="FocusScope",hK=X.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...d}=e,[i,_]=X.useState(null),b=a_(a),T=a_(c),A=X.useRef(null),k=P_(t,N=>_(N)),R=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(r){let N=function(q){if(R.paused||!i)return;const Q=q.target;i.contains(Q)?A.current=Q:Sp(A.current,{select:!0})},V=function(q){if(R.paused||!i)return;const Q=q.relatedTarget;Q!==null&&(i.contains(Q)||Sp(A.current,{select:!0}))},H=function(q){if(document.activeElement===document.body)for(const te of q)te.removedNodes.length>0&&Sp(i)};document.addEventListener("focusin",N),document.addEventListener("focusout",V);const G=new MutationObserver(H);return i&&G.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",V),G.disconnect()}}},[r,i,R.paused]),X.useEffect(()=>{if(i){GV.add(R);const N=document.activeElement;if(!i.contains(N)){const H=new CustomEvent(Ok,VV);i.addEventListener(Ok,b),i.dispatchEvent(H),H.defaultPrevented||(Ove(zve(dK(i)),{select:!0}),document.activeElement===N&&Sp(i))}return()=>{i.removeEventListener(Ok,b),setTimeout(()=>{const H=new CustomEvent(kk,VV);i.addEventListener(kk,T),i.dispatchEvent(H),H.defaultPrevented||Sp(N??document.body,{select:!0}),i.removeEventListener(kk,T),GV.remove(R)},0)}}},[i,b,T,R]);const B=X.useCallback(N=>{if(!n&&!r||R.paused)return;const V=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,H=document.activeElement;if(V&&H){const G=N.currentTarget,[q,Q]=kve(G);q&&Q?!N.shiftKey&&H===Q?(N.preventDefault(),n&&Sp(q,{select:!0})):N.shiftKey&&H===q&&(N.preventDefault(),n&&Sp(Q,{select:!0})):H===G&&N.preventDefault()}},[n,r,R.paused]);return _e.jsx(bf.div,{tabIndex:-1,...d,ref:k,onKeyDown:B})});hK.displayName=Mve;function Ove(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Sp(r,{select:t}),document.activeElement!==n)return}function kve(e){const t=dK(e),n=WV(t,e),r=WV(t.reverse(),e);return[n,r]}function dK(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function WV(e,t){for(const n of e)if(!Rve(n,{upTo:t}))return n}function Rve(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Dve(e){return e instanceof HTMLInputElement&&"select"in e}function Sp(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Dve(e)&&t&&e.select()}}var GV=Lve();function Lve(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=HV(e,t),e.unshift(t)},remove(t){var n;e=HV(e,t),(n=e[0])==null||n.resume()}}}function HV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function zve(e){return e.filter(t=>t.tagName!=="A")}var Nve="Portal",fK=X.forwardRef((e,t)=>{var i;const{container:n,...r}=e,[a,c]=X.useState(!1);PA(()=>c(!0),[]);const d=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return d?uC.createPortal(_e.jsx(bf.div,{...r,ref:t}),d):null});fK.displayName=Nve;function Fve(e,t){return X.useReducer((n,r)=>t[n][r]??n,e)}var RC=e=>{const{present:t,children:n}=e,r=Bve(t),a=typeof n=="function"?n({present:r.isPresent}):X.Children.only(n),c=P_(r.ref,jve(a));return typeof n=="function"||r.isPresent?X.cloneElement(a,{ref:c}):null};RC.displayName="Presence";function Bve(e){const[t,n]=X.useState(),r=X.useRef({}),a=X.useRef(e),c=X.useRef("none"),d=e?"mounted":"unmounted",[i,_]=Fve(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const b=KE(r.current);c.current=i==="mounted"?b:"none"},[i]),PA(()=>{const b=r.current,T=a.current;if(T!==e){const k=c.current,R=KE(b);e?_("MOUNT"):R==="none"||(b==null?void 0:b.display)==="none"?_("UNMOUNT"):_(T&&k!==R?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),PA(()=>{if(t){let b;const T=t.ownerDocument.defaultView??window,A=R=>{const N=KE(r.current).includes(R.animationName);if(R.target===t&&N&&(_("ANIMATION_END"),!a.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",b=T.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},k=R=>{R.target===t&&(c.current=KE(r.current))};return t.addEventListener("animationstart",k),t.addEventListener("animationcancel",A),t.addEventListener("animationend",A),()=>{T.clearTimeout(b),t.removeEventListener("animationstart",k),t.removeEventListener("animationcancel",A),t.removeEventListener("animationend",A)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:X.useCallback(b=>{b&&(r.current=getComputedStyle(b)),n(b)},[])}}function KE(e){return(e==null?void 0:e.animationName)||"none"}function jve(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Rk=0;function $ve(){X.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??qV()),document.body.insertAdjacentElement("beforeend",e[1]??qV()),Rk++,()=>{Rk===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Rk--}},[])}function qV(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var pK=NZ(),Dk=function(){},DC=X.forwardRef(function(e,t){var n=X.useRef(null),r=X.useState({onScrollCapture:Dk,onWheelCapture:Dk,onTouchMoveCapture:Dk}),a=r[0],c=r[1],d=e.forwardProps,i=e.children,_=e.className,b=e.removeScrollBar,T=e.enabled,A=e.shards,k=e.sideCar,R=e.noIsolation,B=e.inert,N=e.allowPinchZoom,V=e.as,H=V===void 0?"div":V,G=e.gapMode,q=uN(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Q=k,te=zZ([n,t]),ue=Qs(Qs({},q),a);return X.createElement(X.Fragment,null,T&&X.createElement(Q,{sideCar:pK,removeScrollBar:b,shards:A,noIsolation:R,inert:B,setCallbacks:c,allowPinchZoom:!!N,lockRef:n,gapMode:G}),d?X.cloneElement(X.Children.only(i),Qs(Qs({},ue),{ref:te})):X.createElement(H,Qs({},ue,{className:_,ref:te}),i))});DC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};DC.classNames={fullWidth:Ib,zeroRight:Cb};var KD=!1;if(typeof window<"u")try{var YE=Object.defineProperty({},"passive",{get:function(){return KD=!0,!0}});window.addEventListener("test",YE,YE),window.removeEventListener("test",YE,YE)}catch{KD=!1}var Hy=KD?{passive:!1}:!1,Uve=function(e){return e.tagName==="TEXTAREA"},mK=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Uve(e)&&n[t]==="visible")},Vve=function(e){return mK(e,"overflowY")},Wve=function(e){return mK(e,"overflowX")},ZV=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=gK(e,r);if(a){var c=_K(e,r),d=c[1],i=c[2];if(d>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Gve=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Hve=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},gK=function(e,t){return e==="v"?Vve(t):Wve(t)},_K=function(e,t){return e==="v"?Gve(t):Hve(t)},qve=function(e,t){return e==="h"&&t==="rtl"?-1:1},Zve=function(e,t,n,r,a){var c=qve(e,window.getComputedStyle(t).direction),d=c*r,i=n.target,_=t.contains(i),b=!1,T=d>0,A=0,k=0;do{var R=_K(e,i),B=R[0],N=R[1],V=R[2],H=N-V-c*B;(B||H)&&gK(e,i)&&(A+=H,k+=B),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(T&&(Math.abs(A)<1||!a)||!T&&(Math.abs(k)<1||!a))&&(b=!0),b},JE=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},XV=function(e){return[e.deltaX,e.deltaY]},KV=function(e){return e&&"current"in e?e.current:e},Xve=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Kve=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Yve=0,qy=[];function Jve(e){var t=X.useRef([]),n=X.useRef([0,0]),r=X.useRef(),a=X.useState(Yve++)[0],c=X.useState(hN)[0],d=X.useRef(e);X.useEffect(function(){d.current=e},[e]),X.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var N=LZ([e.lockRef.current],(e.shards||[]).map(KV),!0).filter(Boolean);return N.forEach(function(V){return V.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),N.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=X.useCallback(function(N,V){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!d.current.allowPinchZoom;var H=JE(N),G=n.current,q="deltaX"in N?N.deltaX:G[0]-H[0],Q="deltaY"in N?N.deltaY:G[1]-H[1],te,ue=N.target,fe=Math.abs(q)>Math.abs(Q)?"h":"v";if("touches"in N&&fe==="h"&&ue.type==="range")return!1;var ye=ZV(fe,ue);if(!ye)return!0;if(ye?te=fe:(te=fe==="v"?"h":"v",ye=ZV(fe,ue)),!ye)return!1;if(!r.current&&"changedTouches"in N&&(q||Q)&&(r.current=te),!te)return!0;var De=r.current||te;return Zve(De,V,N,De==="h"?q:Q,!0)},[]),_=X.useCallback(function(N){var V=N;if(!(!qy.length||qy[qy.length-1]!==c)){var H="deltaY"in V?XV(V):JE(V),G=t.current.filter(function(te){return te.name===V.type&&(te.target===V.target||V.target===te.shadowParent)&&Xve(te.delta,H)})[0];if(G&&G.should){V.cancelable&&V.preventDefault();return}if(!G){var q=(d.current.shards||[]).map(KV).filter(Boolean).filter(function(te){return te.contains(V.target)}),Q=q.length>0?i(V,q[0]):!d.current.noIsolation;Q&&V.cancelable&&V.preventDefault()}}},[]),b=X.useCallback(function(N,V,H,G){var q={name:N,delta:V,target:H,should:G,shadowParent:Qve(H)};t.current.push(q),setTimeout(function(){t.current=t.current.filter(function(Q){return Q!==q})},1)},[]),T=X.useCallback(function(N){n.current=JE(N),r.current=void 0},[]),A=X.useCallback(function(N){b(N.type,XV(N),N.target,i(N,e.lockRef.current))},[]),k=X.useCallback(function(N){b(N.type,JE(N),N.target,i(N,e.lockRef.current))},[]);X.useEffect(function(){return qy.push(c),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:k}),document.addEventListener("wheel",_,Hy),document.addEventListener("touchmove",_,Hy),document.addEventListener("touchstart",T,Hy),function(){qy=qy.filter(function(N){return N!==c}),document.removeEventListener("wheel",_,Hy),document.removeEventListener("touchmove",_,Hy),document.removeEventListener("touchstart",T,Hy)}},[]);var R=e.removeScrollBar,B=e.inert;return X.createElement(X.Fragment,null,B?X.createElement(c,{styles:Kve(a)}):null,R?X.createElement($Z,{gapMode:e.gapMode}):null)}function Qve(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const e0e=BZ(pK,Jve);var yK=X.forwardRef(function(e,t){return X.createElement(DC,Qs({},e,{ref:t,sideCar:e0e}))});yK.classNames=DC.classNames;var IN="Dialog",[vK,hJe]=cve(IN),[t0e,dh]=vK(IN),xK=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:d=!0}=e,i=X.useRef(null),_=X.useRef(null),[b=!1,T]=fve({prop:r,defaultProp:a,onChange:c});return _e.jsx(t0e,{scope:t,triggerRef:i,contentRef:_,contentId:Mk(),titleId:Mk(),descriptionId:Mk(),open:b,onOpenChange:T,onOpenToggle:X.useCallback(()=>T(A=>!A),[T]),modal:d,children:n})};xK.displayName=IN;var bK="DialogTrigger",wK=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=dh(bK,n),c=P_(t,a.triggerRef);return _e.jsx(bf.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":kN(a.open),...r,ref:c,onClick:Kp(e.onClick,a.onOpenToggle)})});wK.displayName=bK;var MN="DialogPortal",[n0e,SK]=vK(MN,{forceMount:void 0}),TK=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,c=dh(MN,t);return _e.jsx(n0e,{scope:t,forceMount:n,children:X.Children.map(r,d=>_e.jsx(RC,{present:n||c.open,children:_e.jsx(fK,{asChild:!0,container:a,children:d})}))})};TK.displayName=MN;var CA="DialogOverlay",EK=X.forwardRef((e,t)=>{const n=SK(CA,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=dh(CA,e.__scopeDialog);return c.modal?_e.jsx(RC,{present:r||c.open,children:_e.jsx(i0e,{...a,ref:t})}):null});EK.displayName=CA;var r0e=sK("DialogOverlay.RemoveScroll"),i0e=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=dh(CA,n);return _e.jsx(yK,{as:r0e,allowPinchZoom:!0,shards:[a.contentRef],children:_e.jsx(bf.div,{"data-state":kN(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),s_="DialogContent",AK=X.forwardRef((e,t)=>{const n=SK(s_,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=dh(s_,e.__scopeDialog);return _e.jsx(RC,{present:r||c.open,children:c.modal?_e.jsx(o0e,{...a,ref:t}):_e.jsx(a0e,{...a,ref:t})})});AK.displayName=s_;var o0e=X.forwardRef((e,t)=>{const n=dh(s_,e.__scopeDialog),r=X.useRef(null),a=P_(t,n.contentRef,r);return X.useEffect(()=>{const c=r.current;if(c)return AS(c)},[]),_e.jsx(PK,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kp(e.onCloseAutoFocus,c=>{var d;c.preventDefault(),(d=n.triggerRef.current)==null||d.focus()}),onPointerDownOutside:Kp(e.onPointerDownOutside,c=>{const d=c.detail.originalEvent,i=d.button===0&&d.ctrlKey===!0;(d.button===2||i)&&c.preventDefault()}),onFocusOutside:Kp(e.onFocusOutside,c=>c.preventDefault())})}),a0e=X.forwardRef((e,t)=>{const n=dh(s_,e.__scopeDialog),r=X.useRef(!1),a=X.useRef(!1);return _e.jsx(PK,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d,i;(d=e.onCloseAutoFocus)==null||d.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(d))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),PK=X.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,...d}=e,i=dh(s_,n),_=X.useRef(null),b=P_(t,_);return $ve(),_e.jsxs(_e.Fragment,{children:[_e.jsx(hK,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:_e.jsx(cK,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":kN(i.open),...d,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),_e.jsxs(_e.Fragment,{children:[_e.jsx(s0e,{titleId:i.titleId}),_e.jsx(c0e,{contentRef:_,descriptionId:i.descriptionId})]})]})}),ON="DialogTitle",CK=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=dh(ON,n);return _e.jsx(bf.h2,{id:a.titleId,...r,ref:t})});CK.displayName=ON;var IK="DialogDescription",MK=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=dh(IK,n);return _e.jsx(bf.p,{id:a.descriptionId,...r,ref:t})});MK.displayName=IK;var OK="DialogClose",kK=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=dh(OK,n);return _e.jsx(bf.button,{type:"button",...r,ref:t,onClick:Kp(e.onClick,()=>a.onOpenChange(!1))})});kK.displayName=OK;function kN(e){return e?"open":"closed"}var RK="DialogTitleWarning",[dJe,DK]=lve(RK,{contentName:s_,titleName:ON,docsSlug:"dialog"}),s0e=({titleId:e})=>{const t=DK(RK),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return X.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},l0e="DialogDescriptionWarning",c0e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${DK(l0e).contentName}}.`;return X.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},fJe=xK,pJe=wK,mJe=TK,gJe=EK,_Je=AK,yJe=CK,vJe=MK,xJe=kK,u0e="Label",LK=X.forwardRef((e,t)=>_e.jsx(Qn.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));LK.displayName=u0e;var bJe=LK,h0e="Separator",YV="horizontal",d0e=["horizontal","vertical"],zK=X.forwardRef((e,t)=>{const{decorative:n,orientation:r=YV,...a}=e,c=f0e(r)?r:YV,i=n?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return _e.jsx(Qn.div,{"data-orientation":c,...i,...a,ref:t})});zK.displayName=h0e;function f0e(e){return d0e.includes(e)}var wJe=zK,RN="Popover",[NK,SJe]=Al(RN,[xm]),MS=xm(),[p0e,bm]=NK(RN),FK=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:d=!1}=e,i=MS(t),_=X.useRef(null),[b,T]=X.useState(!1),[A=!1,k]=Sl({prop:r,defaultProp:a,onChange:c});return _e.jsx(TC,{...i,children:_e.jsx(p0e,{scope:t,contentId:el(),triggerRef:_,open:A,onOpenChange:k,onOpenToggle:X.useCallback(()=>k(R=>!R),[k]),hasCustomAnchor:b,onCustomAnchorAdd:X.useCallback(()=>T(!0),[]),onCustomAnchorRemove:X.useCallback(()=>T(!1),[]),modal:d,children:n})})};FK.displayName=RN;var BK="PopoverAnchor",m0e=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=bm(BK,n),c=MS(n),{onCustomAnchorAdd:d,onCustomAnchorRemove:i}=a;return X.useEffect(()=>(d(),()=>i()),[d,i]),_e.jsx(TS,{...c,...r,ref:t})});m0e.displayName=BK;var jK="PopoverTrigger",$K=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=bm(jK,n),c=MS(n),d=Xr(t,a.triggerRef),i=_e.jsx(Qn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":HK(a.open),...r,ref:d,onClick:On(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:_e.jsx(TS,{asChild:!0,...c,children:i})});$K.displayName=jK;var DN="PopoverPortal",[g0e,_0e]=NK(DN,{forceMount:void 0}),UK=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,c=bm(DN,t);return _e.jsx(g0e,{scope:t,forceMount:n,children:_e.jsx(Aa,{present:n||c.open,children:_e.jsx(ES,{asChild:!0,container:a,children:r})})})};UK.displayName=DN;var Xv="PopoverContent",VK=X.forwardRef((e,t)=>{const n=_0e(Xv,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,c=bm(Xv,e.__scopePopover);return _e.jsx(Aa,{present:r||c.open,children:c.modal?_e.jsx(y0e,{...a,ref:t}):_e.jsx(v0e,{...a,ref:t})})});VK.displayName=Xv;var y0e=X.forwardRef((e,t)=>{const n=bm(Xv,e.__scopePopover),r=X.useRef(null),a=Xr(t,r),c=X.useRef(!1);return X.useEffect(()=>{const d=r.current;if(d)return AS(d)},[]),_e.jsx(PS,{as:rm,allowPinchZoom:!0,children:_e.jsx(WK,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:On(e.onCloseAutoFocus,d=>{var i;d.preventDefault(),c.current||(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:On(e.onPointerDownOutside,d=>{const i=d.detail.originalEvent,_=i.button===0&&i.ctrlKey===!0,b=i.button===2||_;c.current=b},{checkForDefaultPrevented:!1}),onFocusOutside:On(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),v0e=X.forwardRef((e,t)=>{const n=bm(Xv,e.__scopePopover),r=X.useRef(!1),a=X.useRef(!1);return _e.jsx(WK,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d,i;(d=e.onCloseAutoFocus)==null||d.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(d))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),WK=X.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onInteractOutside:T,...A}=e,k=bm(Xv,n),R=MS(n);return xC(),_e.jsx(wS,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:_e.jsx(T_,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:T,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onDismiss:()=>k.onOpenChange(!1),children:_e.jsx(EC,{"data-state":HK(k.open),role:"dialog",id:k.contentId,...R,...A,ref:t,style:{...A.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),GK="PopoverClose",x0e=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=bm(GK,n);return _e.jsx(Qn.button,{type:"button",...r,ref:t,onClick:On(e.onClick,()=>a.onOpenChange(!1))})});x0e.displayName=GK;var b0e="PopoverArrow",w0e=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=MS(n);return _e.jsx(AC,{...a,...r,ref:t})});w0e.displayName=b0e;function HK(e){return e?"open":"closed"}var TJe=FK,EJe=$K,AJe=UK,PJe=VK;function ti(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function tc(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ml(e,t){const n=ti(e);return isNaN(t)?tc(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function uh(e,t){const n=ti(e);if(isNaN(t))return tc(e,NaN);if(!t)return n;const r=n.getDate(),a=tc(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const c=a.getDate();return r>=c?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}const LN=6048e5,S0e=864e5,QE=43200,JV=1440;let T0e={};function G0(){return T0e}function rd(e,t){var i,_,b,T;const n=G0(),r=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.weekStartsOn)??0,a=ti(e),c=a.getDay(),d=(c<r?7:0)+c-r;return a.setDate(a.getDate()-d),a.setHours(0,0,0,0),a}function l_(e){return rd(e,{weekStartsOn:1})}function qK(e){const t=ti(e),n=t.getFullYear(),r=tc(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const a=l_(r),c=tc(e,0);c.setFullYear(n,0,4),c.setHours(0,0,0,0);const d=l_(c);return t.getTime()>=a.getTime()?n+1:t.getTime()>=d.getTime()?n:n-1}function Kv(e){const t=ti(e);return t.setHours(0,0,0,0),t}function Yv(e){const t=ti(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Gh(e,t){const n=Kv(e),r=Kv(t),a=+n-Yv(n),c=+r-Yv(r);return Math.round((a-c)/S0e)}function E0e(e){const t=qK(e),n=tc(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),l_(n)}function YD(e,t){const n=t*7;return ml(e,n)}function A0e(e,t){return uh(e,t*12)}function P0e(e){let t;return e.forEach(function(n){const r=ti(n);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function C0e(e){let t;return e.forEach(n=>{const r=ti(n);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function M2(e,t){const n=ti(e),r=ti(t),a=n.getTime()-r.getTime();return a<0?-1:a>0?1:a}function I0e(e){return tc(e,Date.now())}function Xl(e,t){const n=Kv(e),r=Kv(t);return+n==+r}function zN(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function M0e(e){if(!zN(e)&&typeof e!="number")return!1;const t=ti(e);return!isNaN(Number(t))}function Jv(e,t){const n=ti(e),r=ti(t),a=n.getFullYear()-r.getFullYear(),c=n.getMonth()-r.getMonth();return a*12+c}function O0e(e,t,n){const r=rd(e,n),a=rd(t,n),c=+r-Yv(r),d=+a-Yv(a);return Math.round((c-d)/LN)}function k0e(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function R0e(e,t){return+ti(e)-+ti(t)}function D0e(e){const t=ti(e);return t.setHours(23,59,59,999),t}function LC(e){const t=ti(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function L0e(e){const t=ti(e);return+D0e(t)==+LC(t)}function z0e(e,t){const n=ti(e),r=ti(t),a=M2(n,r),c=Math.abs(Jv(n,r));let d;if(c<1)d=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*c);let i=M2(n,r)===-a;L0e(ti(e))&&c===1&&M2(e,r)===1&&(i=!1),d=a*(c-Number(i))}return d===0?0:d}function N0e(e,t,n){const r=R0e(e,t)/1e3;return k0e(n==null?void 0:n.roundingMethod)(r)}function ec(e){const t=ti(e);return t.setDate(1),t.setHours(0,0,0,0),t}function ZK(e){const t=ti(e),n=tc(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function NN(e,t){var i,_,b,T;const n=G0(),r=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.weekStartsOn)??0,a=ti(e),c=a.getDay(),d=(c<r?-7:0)+6-(c-r);return a.setDate(a.getDate()+d),a.setHours(23,59,59,999),a}function XK(e){return NN(e,{weekStartsOn:1})}const F0e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},B0e=(e,t,n)=>{let r;const a=F0e[e];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Lk(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const j0e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$0e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},U0e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},V0e={date:Lk({formats:j0e,defaultWidth:"full"}),time:Lk({formats:$0e,defaultWidth:"full"}),dateTime:Lk({formats:U0e,defaultWidth:"full"})},W0e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},G0e=(e,t,n,r)=>W0e[e];function $1(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,i=n!=null&&n.width?String(n.width):d;a=e.formattingValues[i]||e.formattingValues[d]}else{const d=e.defaultWidth,i=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[i]||e.values[d]}const c=e.argumentCallback?e.argumentCallback(t):t;return a[c]}}const H0e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},q0e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Z0e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},X0e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},K0e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Y0e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},J0e=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Q0e={ordinalNumber:J0e,era:$1({values:H0e,defaultWidth:"wide"}),quarter:$1({values:q0e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:$1({values:Z0e,defaultWidth:"wide"}),day:$1({values:X0e,defaultWidth:"wide"}),dayPeriod:$1({values:K0e,defaultWidth:"wide",formattingValues:Y0e,defaultFormattingWidth:"wide"})};function U1(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],c=t.match(a);if(!c)return null;const d=c[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],_=Array.isArray(i)?txe(i,A=>A.test(d)):exe(i,A=>A.test(d));let b;b=e.valueCallback?e.valueCallback(_):_,b=n.valueCallback?n.valueCallback(b):b;const T=t.slice(d.length);return{value:b,rest:T}}}function exe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function txe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function nxe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],c=t.match(e.parsePattern);if(!c)return null;let d=e.valueCallback?e.valueCallback(c[0]):c[0];d=n.valueCallback?n.valueCallback(d):d;const i=t.slice(a.length);return{value:d,rest:i}}}const rxe=/^(\d+)(th|st|nd|rd)?/i,ixe=/\d+/i,oxe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},axe={any:[/^b/i,/^(a|c)/i]},sxe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},lxe={any:[/1/i,/2/i,/3/i,/4/i]},cxe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uxe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hxe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},dxe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fxe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},pxe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mxe={ordinalNumber:nxe({matchPattern:rxe,parsePattern:ixe,valueCallback:e=>parseInt(e,10)}),era:U1({matchPatterns:oxe,defaultMatchWidth:"wide",parsePatterns:axe,defaultParseWidth:"any"}),quarter:U1({matchPatterns:sxe,defaultMatchWidth:"wide",parsePatterns:lxe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:U1({matchPatterns:cxe,defaultMatchWidth:"wide",parsePatterns:uxe,defaultParseWidth:"any"}),day:U1({matchPatterns:hxe,defaultMatchWidth:"wide",parsePatterns:dxe,defaultParseWidth:"any"}),dayPeriod:U1({matchPatterns:fxe,defaultMatchWidth:"any",parsePatterns:pxe,defaultParseWidth:"any"})},FN={code:"en-US",formatDistance:B0e,formatLong:V0e,formatRelative:G0e,localize:Q0e,match:mxe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function gxe(e){const t=ti(e);return Gh(t,ZK(t))+1}function KK(e){const t=ti(e),n=+l_(t)-+E0e(t);return Math.round(n/LN)+1}function YK(e,t){var T,A,k,R;const n=ti(e),r=n.getFullYear(),a=G0(),c=(t==null?void 0:t.firstWeekContainsDate)??((A=(T=t==null?void 0:t.locale)==null?void 0:T.options)==null?void 0:A.firstWeekContainsDate)??a.firstWeekContainsDate??((R=(k=a.locale)==null?void 0:k.options)==null?void 0:R.firstWeekContainsDate)??1,d=tc(e,0);d.setFullYear(r+1,0,c),d.setHours(0,0,0,0);const i=rd(d,t),_=tc(e,0);_.setFullYear(r,0,c),_.setHours(0,0,0,0);const b=rd(_,t);return n.getTime()>=i.getTime()?r+1:n.getTime()>=b.getTime()?r:r-1}function _xe(e,t){var i,_,b,T;const n=G0(),r=(t==null?void 0:t.firstWeekContainsDate)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.firstWeekContainsDate)??n.firstWeekContainsDate??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.firstWeekContainsDate)??1,a=YK(e,t),c=tc(e,0);return c.setFullYear(a,0,r),c.setHours(0,0,0,0),rd(c,t)}function JK(e,t){const n=ti(e),r=+rd(n,t)-+_xe(n,t);return Math.round(r/LN)+1}function go(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const xp={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return go(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):go(n+1,2)},d(e,t){return go(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return go(e.getHours()%12||12,t.length)},H(e,t){return go(e.getHours(),t.length)},m(e,t){return go(e.getMinutes(),t.length)},s(e,t){return go(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return go(a,t.length)}},Zy={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},QV={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return xp.y(e,t)},Y:function(e,t,n,r){const a=YK(e,r),c=a>0?a:1-a;if(t==="YY"){const d=c%100;return go(d,2)}return t==="Yo"?n.ordinalNumber(c,{unit:"year"}):go(c,t.length)},R:function(e,t){const n=qK(e);return go(n,t.length)},u:function(e,t){const n=e.getFullYear();return go(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return go(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return go(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return xp.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return go(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=JK(e,r);return t==="wo"?n.ordinalNumber(a,{unit:"week"}):go(a,t.length)},I:function(e,t,n){const r=KK(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):go(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):xp.d(e,t)},D:function(e,t,n){const r=gxe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):go(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),c=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return go(c,2);case"eo":return n.ordinalNumber(c,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),c=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return go(c,t.length);case"co":return n.ordinalNumber(c,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=r===0?7:r;switch(t){case"i":return String(a);case"ii":return go(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(r===12?a=Zy.noon:r===0?a=Zy.midnight:a=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(r>=17?a=Zy.evening:r>=12?a=Zy.afternoon:r>=4?a=Zy.morning:a=Zy.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return xp.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):xp.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):go(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):go(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):xp.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):xp.s(e,t)},S:function(e,t){return xp.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return t6(r);case"XXXX":case"XX":return kg(r);case"XXXXX":case"XXX":default:return kg(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return t6(r);case"xxxx":case"xx":return kg(r);case"xxxxx":case"xxx":default:return kg(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+e6(r,":");case"OOOO":default:return"GMT"+kg(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+e6(r,":");case"zzzz":default:return"GMT"+kg(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return go(r,t.length)},T:function(e,t,n){const r=e.getTime();return go(r,t.length)}};function e6(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),c=r%60;return c===0?n+String(a):n+String(a)+t+go(c,2)}function t6(e,t){return e%60===0?(e>0?"-":"+")+go(Math.abs(e)/60,2):kg(e,t)}function kg(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=go(Math.trunc(r/60),2),c=go(r%60,2);return n+a+t+c}const n6=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},QK=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},yxe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return n6(e,t);let c;switch(r){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",n6(r,t)).replace("{{time}}",QK(a,t))},vxe={p:QK,P:yxe},xxe=/^D+$/,bxe=/^Y+$/,wxe=["D","DD","YY","YYYY"];function Sxe(e){return xxe.test(e)}function Txe(e){return bxe.test(e)}function Exe(e,t,n){const r=Axe(e,t,n);if(console.warn(r),wxe.includes(e))throw new RangeError(r)}function Axe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Pxe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Cxe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ixe=/^'([^]*?)'?$/,Mxe=/''/g,Oxe=/[a-zA-Z]/;function C_(e,t,n){var T,A,k,R,B,N,V,H;const r=G0(),a=(n==null?void 0:n.locale)??r.locale??FN,c=(n==null?void 0:n.firstWeekContainsDate)??((A=(T=n==null?void 0:n.locale)==null?void 0:T.options)==null?void 0:A.firstWeekContainsDate)??r.firstWeekContainsDate??((R=(k=r.locale)==null?void 0:k.options)==null?void 0:R.firstWeekContainsDate)??1,d=(n==null?void 0:n.weekStartsOn)??((N=(B=n==null?void 0:n.locale)==null?void 0:B.options)==null?void 0:N.weekStartsOn)??r.weekStartsOn??((H=(V=r.locale)==null?void 0:V.options)==null?void 0:H.weekStartsOn)??0,i=ti(e);if(!M0e(i))throw new RangeError("Invalid time value");let _=t.match(Cxe).map(G=>{const q=G[0];if(q==="p"||q==="P"){const Q=vxe[q];return Q(G,a.formatLong)}return G}).join("").match(Pxe).map(G=>{if(G==="''")return{isToken:!1,value:"'"};const q=G[0];if(q==="'")return{isToken:!1,value:kxe(G)};if(QV[q])return{isToken:!0,value:G};if(q.match(Oxe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+q+"`");return{isToken:!1,value:G}});a.localize.preprocessor&&(_=a.localize.preprocessor(i,_));const b={firstWeekContainsDate:c,weekStartsOn:d,locale:a};return _.map(G=>{if(!G.isToken)return G.value;const q=G.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&Txe(q)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&Sxe(q))&&Exe(q,t,String(e));const Q=QV[q[0]];return Q(i,q,a.localize,b)}).join("")}function kxe(e){const t=e.match(Ixe);return t?t[1].replace(Mxe,"'"):e}function Rxe(e,t,n){const r=G0(),a=(n==null?void 0:n.locale)??r.locale??FN,c=2520,d=M2(e,t);if(isNaN(d))throw new RangeError("Invalid time value");const i=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:d});let _,b;d>0?(_=ti(t),b=ti(e)):(_=ti(e),b=ti(t));const T=N0e(b,_),A=(Yv(b)-Yv(_))/1e3,k=Math.round((T-A)/60);let R;if(k<2)return n!=null&&n.includeSeconds?T<5?a.formatDistance("lessThanXSeconds",5,i):T<10?a.formatDistance("lessThanXSeconds",10,i):T<20?a.formatDistance("lessThanXSeconds",20,i):T<40?a.formatDistance("halfAMinute",0,i):T<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):k===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",k,i);if(k<45)return a.formatDistance("xMinutes",k,i);if(k<90)return a.formatDistance("aboutXHours",1,i);if(k<JV){const B=Math.round(k/60);return a.formatDistance("aboutXHours",B,i)}else{if(k<c)return a.formatDistance("xDays",1,i);if(k<QE){const B=Math.round(k/JV);return a.formatDistance("xDays",B,i)}else if(k<QE*2)return R=Math.round(k/QE),a.formatDistance("aboutXMonths",R,i)}if(R=z0e(b,_),R<12){const B=Math.round(k/QE);return a.formatDistance("xMonths",B,i)}else{const B=R%12,N=Math.trunc(R/12);return B<3?a.formatDistance("aboutXYears",N,i):B<9?a.formatDistance("overXYears",N,i):a.formatDistance("almostXYears",N+1,i)}}function CJe(e,t){return Rxe(e,I0e(e),t)}function Dxe(e){const t=ti(e),n=t.getFullYear(),r=t.getMonth(),a=tc(e,0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}function Lxe(e){return Math.trunc(+ti(e)/1e3)}function zxe(e){const t=ti(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function Nxe(e,t){return O0e(zxe(e),ec(e),t)+1}function JD(e,t){const n=ti(e),r=ti(t);return n.getTime()>r.getTime()}function eY(e,t){const n=ti(e),r=ti(t);return+n<+r}function BN(e,t){const n=ti(e),r=ti(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function Fxe(e,t){const n=ti(e),r=ti(t);return n.getFullYear()===r.getFullYear()}function zk(e,t){return ml(e,-t)}function Nk(e,t){const n=ti(e),r=n.getFullYear(),a=n.getDate(),c=tc(e,0);c.setFullYear(r,t,15),c.setHours(0,0,0,0);const d=Dxe(c);return n.setMonth(t,Math.min(a,d)),n}function r6(e,t){const n=ti(e);return isNaN(+n)?tc(e,NaN):(n.setFullYear(t),n)}var qr=function(){return qr=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},qr.apply(this,arguments)};function Bxe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function tY(e,t,n){for(var r=0,a=t.length,c;r<a;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))}function OS(e){return e.mode==="multiple"}function kS(e){return e.mode==="range"}function zC(e){return e.mode==="single"}var jxe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function $xe(e,t){return C_(e,"LLLL y",t)}function Uxe(e,t){return C_(e,"d",t)}function Vxe(e,t){return C_(e,"LLLL",t)}function Wxe(e){return"".concat(e)}function Gxe(e,t){return C_(e,"cccccc",t)}function Hxe(e,t){return C_(e,"yyyy",t)}var qxe=Object.freeze({__proto__:null,formatCaption:$xe,formatDay:Uxe,formatMonthCaption:Vxe,formatWeekNumber:Wxe,formatWeekdayName:Gxe,formatYearCaption:Hxe}),Zxe=function(e,t,n){return C_(e,"do MMMM (EEEE)",n)},Xxe=function(){return"Month: "},Kxe=function(){return"Go to next month"},Yxe=function(){return"Go to previous month"},Jxe=function(e,t){return C_(e,"cccc",t)},Qxe=function(e){return"Week n. ".concat(e)},e1e=function(){return"Year: "},t1e=Object.freeze({__proto__:null,labelDay:Zxe,labelMonthDropdown:Xxe,labelNext:Kxe,labelPrevious:Yxe,labelWeekNumber:Qxe,labelWeekday:Jxe,labelYearDropdown:e1e});function n1e(){var e="buttons",t=jxe,n=FN,r={},a={},c=1,d={},i=new Date;return{captionLayout:e,classNames:t,formatters:qxe,labels:t1e,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:c,styles:d,today:i,mode:"default"}}function r1e(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,a=e.toMonth,c=e.fromDate,d=e.toDate;return r?c=ec(r):t&&(c=new Date(t,0,1)),a?d=LC(a):n&&(d=new Date(n,11,31)),{fromDate:c?Kv(c):void 0,toDate:d?Kv(d):void 0}}var nY=X.createContext(void 0);function i1e(e){var t,n=e.initialProps,r=n1e(),a=r1e(n),c=a.fromDate,d=a.toDate,i=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;i!=="buttons"&&(!c||!d)&&(i="buttons");var _;(zC(n)||OS(n)||kS(n))&&(_=n.onSelect);var b=qr(qr(qr({},r),n),{captionLayout:i,classNames:qr(qr({},r.classNames),n.classNames),components:qr({},n.components),formatters:qr(qr({},r.formatters),n.formatters),fromDate:c,labels:qr(qr({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:qr(qr({},r.modifiers),n.modifiers),modifiersClassNames:qr(qr({},r.modifiersClassNames),n.modifiersClassNames),onSelect:_,styles:qr(qr({},r.styles),n.styles),toDate:d});return _e.jsx(nY.Provider,{value:b,children:e.children})}function Fo(){var e=X.useContext(nY);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function rY(e){var t=Fo(),n=t.locale,r=t.classNames,a=t.styles,c=t.formatters.formatCaption;return _e.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:c(e.displayMonth,{locale:n})})}function o1e(e){return _e.jsx("svg",qr({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:_e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function iY(e){var t,n,r=e.onChange,a=e.value,c=e.children,d=e.caption,i=e.className,_=e.style,b=Fo(),T=(n=(t=b.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:o1e;return _e.jsxs("div",{className:i,style:_,children:[_e.jsx("span",{className:b.classNames.vhidden,children:e["aria-label"]}),_e.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:b.classNames.dropdown,style:b.styles.dropdown,value:a,onChange:r,children:c}),_e.jsxs("div",{className:b.classNames.caption_label,style:b.styles.caption_label,"aria-hidden":"true",children:[d,_e.jsx(T,{className:b.classNames.dropdown_icon,style:b.styles.dropdown_icon})]})]})}function a1e(e){var t,n=Fo(),r=n.fromDate,a=n.toDate,c=n.styles,d=n.locale,i=n.formatters.formatMonthCaption,_=n.classNames,b=n.components,T=n.labels.labelMonthDropdown;if(!r)return _e.jsx(_e.Fragment,{});if(!a)return _e.jsx(_e.Fragment,{});var A=[];if(Fxe(r,a))for(var k=ec(r),R=r.getMonth();R<=a.getMonth();R++)A.push(Nk(k,R));else for(var k=ec(new Date),R=0;R<=11;R++)A.push(Nk(k,R));var B=function(V){var H=Number(V.target.value),G=Nk(ec(e.displayMonth),H);e.onChange(G)},N=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:iY;return _e.jsx(N,{name:"months","aria-label":T(),className:_.dropdown_month,style:c.dropdown_month,onChange:B,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:d}),children:A.map(function(V){return _e.jsx("option",{value:V.getMonth(),children:i(V,{locale:d})},V.getMonth())})})}function s1e(e){var t,n=e.displayMonth,r=Fo(),a=r.fromDate,c=r.toDate,d=r.locale,i=r.styles,_=r.classNames,b=r.components,T=r.formatters.formatYearCaption,A=r.labels.labelYearDropdown,k=[];if(!a)return _e.jsx(_e.Fragment,{});if(!c)return _e.jsx(_e.Fragment,{});for(var R=a.getFullYear(),B=c.getFullYear(),N=R;N<=B;N++)k.push(r6(ZK(new Date),N));var V=function(G){var q=r6(ec(n),Number(G.target.value));e.onChange(q)},H=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:iY;return _e.jsx(H,{name:"years","aria-label":A(),className:_.dropdown_year,style:i.dropdown_year,onChange:V,value:n.getFullYear(),caption:T(n,{locale:d}),children:k.map(function(G){return _e.jsx("option",{value:G.getFullYear(),children:T(G,{locale:d})},G.getFullYear())})})}function l1e(e,t){var n=X.useState(e),r=n[0],a=n[1],c=t===void 0?r:t;return[c,a]}function c1e(e){var t=e.month,n=e.defaultMonth,r=e.today,a=t||n||r||new Date,c=e.toDate,d=e.fromDate,i=e.numberOfMonths,_=i===void 0?1:i;if(c&&Jv(c,a)<0){var b=-1*(_-1);a=uh(c,b)}return d&&Jv(a,d)<0&&(a=d),ec(a)}function u1e(){var e=Fo(),t=c1e(e),n=l1e(t,e.month),r=n[0],a=n[1],c=function(d){var i;if(!e.disableNavigation){var _=ec(d);a(_),(i=e.onMonthChange)===null||i===void 0||i.call(e,_)}};return[r,c]}function h1e(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,a=ec(e),c=ec(uh(a,r)),d=Jv(c,a),i=[],_=0;_<d;_++){var b=uh(a,_);i.push(b)}return n&&(i=i.reverse()),i}function d1e(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,d=r?c:1,i=ec(e);if(!n)return uh(i,d);var _=Jv(n,e);if(!(_<c))return uh(i,d)}}function f1e(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,d=r?c:1,i=ec(e);if(!n)return uh(i,-d);var _=Jv(i,n);if(!(_<=0))return uh(i,-d)}}var oY=X.createContext(void 0);function p1e(e){var t=Fo(),n=u1e(),r=n[0],a=n[1],c=h1e(r,t),d=d1e(r,t),i=f1e(r,t),_=function(A){return c.some(function(k){return BN(A,k)})},b=function(A,k){_(A)||(k&&eY(A,k)?a(uh(A,1+t.numberOfMonths*-1)):a(A))},T={currentMonth:r,displayMonths:c,goToMonth:a,goToDate:b,previousMonth:i,nextMonth:d,isDateDisplayed:_};return _e.jsx(oY.Provider,{value:T,children:e.children})}function RS(){var e=X.useContext(oY);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function i6(e){var t,n=Fo(),r=n.classNames,a=n.styles,c=n.components,d=RS().goToMonth,i=function(T){d(uh(T,e.displayIndex?-e.displayIndex:0))},_=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:rY,b=_e.jsx(_,{id:e.id,displayMonth:e.displayMonth});return _e.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[_e.jsx("div",{className:r.vhidden,children:b}),_e.jsx(a1e,{onChange:i,displayMonth:e.displayMonth}),_e.jsx(s1e,{onChange:i,displayMonth:e.displayMonth})]})}function m1e(e){return _e.jsx("svg",qr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:_e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function g1e(e){return _e.jsx("svg",qr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:_e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var IA=X.forwardRef(function(e,t){var n=Fo(),r=n.classNames,a=n.styles,c=[r.button_reset,r.button];e.className&&c.push(e.className);var d=c.join(" "),i=qr(qr({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),_e.jsx("button",qr({},e,{ref:t,type:"button",className:d,style:i}))});function _1e(e){var t,n,r=Fo(),a=r.dir,c=r.locale,d=r.classNames,i=r.styles,_=r.labels,b=_.labelPrevious,T=_.labelNext,A=r.components;if(!e.nextMonth&&!e.previousMonth)return _e.jsx(_e.Fragment,{});var k=b(e.previousMonth,{locale:c}),R=[d.nav_button,d.nav_button_previous].join(" "),B=T(e.nextMonth,{locale:c}),N=[d.nav_button,d.nav_button_next].join(" "),V=(t=A==null?void 0:A.IconRight)!==null&&t!==void 0?t:g1e,H=(n=A==null?void 0:A.IconLeft)!==null&&n!==void 0?n:m1e;return _e.jsxs("div",{className:d.nav,style:i.nav,children:[!e.hidePrevious&&_e.jsx(IA,{name:"previous-month","aria-label":k,className:R,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?_e.jsx(V,{className:d.nav_icon,style:i.nav_icon}):_e.jsx(H,{className:d.nav_icon,style:i.nav_icon})}),!e.hideNext&&_e.jsx(IA,{name:"next-month","aria-label":B,className:N,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?_e.jsx(H,{className:d.nav_icon,style:i.nav_icon}):_e.jsx(V,{className:d.nav_icon,style:i.nav_icon})})]})}function o6(e){var t=Fo().numberOfMonths,n=RS(),r=n.previousMonth,a=n.nextMonth,c=n.goToMonth,d=n.displayMonths,i=d.findIndex(function(B){return BN(e.displayMonth,B)}),_=i===0,b=i===d.length-1,T=t>1&&(_||!b),A=t>1&&(b||!_),k=function(){r&&c(r)},R=function(){a&&c(a)};return _e.jsx(_1e,{displayMonth:e.displayMonth,hideNext:T,hidePrevious:A,nextMonth:a,previousMonth:r,onPreviousClick:k,onNextClick:R})}function y1e(e){var t,n=Fo(),r=n.classNames,a=n.disableNavigation,c=n.styles,d=n.captionLayout,i=n.components,_=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:rY,b;return a?b=_e.jsx(_,{id:e.id,displayMonth:e.displayMonth}):d==="dropdown"?b=_e.jsx(i6,{displayMonth:e.displayMonth,id:e.id}):d==="dropdown-buttons"?b=_e.jsxs(_e.Fragment,{children:[_e.jsx(i6,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),_e.jsx(o6,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):b=_e.jsxs(_e.Fragment,{children:[_e.jsx(_,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),_e.jsx(o6,{displayMonth:e.displayMonth,id:e.id})]}),_e.jsx("div",{className:r.caption,style:c.caption,children:b})}function v1e(e){var t=Fo(),n=t.footer,r=t.styles,a=t.classNames.tfoot;return n?_e.jsx("tfoot",{className:a,style:r.tfoot,children:_e.jsx("tr",{children:_e.jsx("td",{colSpan:8,children:n})})}):_e.jsx(_e.Fragment,{})}function x1e(e,t,n){for(var r=n?l_(new Date):rd(new Date,{locale:e,weekStartsOn:t}),a=[],c=0;c<7;c++){var d=ml(r,c);a.push(d)}return a}function b1e(){var e=Fo(),t=e.classNames,n=e.styles,r=e.showWeekNumber,a=e.locale,c=e.weekStartsOn,d=e.ISOWeek,i=e.formatters.formatWeekdayName,_=e.labels.labelWeekday,b=x1e(a,c,d);return _e.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&_e.jsx("td",{style:n.head_cell,className:t.head_cell}),b.map(function(T,A){return _e.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":_(T,{locale:a}),children:i(T,{locale:a})},A)})]})}function w1e(){var e,t=Fo(),n=t.classNames,r=t.styles,a=t.components,c=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:b1e;return _e.jsx("thead",{style:r.head,className:n.head,children:_e.jsx(c,{})})}function S1e(e){var t=Fo(),n=t.locale,r=t.formatters.formatDay;return _e.jsx(_e.Fragment,{children:r(e.date,{locale:n})})}var jN=X.createContext(void 0);function T1e(e){if(!OS(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return _e.jsx(jN.Provider,{value:t,children:e.children})}return _e.jsx(E1e,{initialProps:e.initialProps,children:e.children})}function E1e(e){var t=e.initialProps,n=e.children,r=t.selected,a=t.min,c=t.max,d=function(b,T,A){var k,R;(k=t.onDayClick)===null||k===void 0||k.call(t,b,T,A);var B=!!(T.selected&&a&&(r==null?void 0:r.length)===a);if(!B){var N=!!(!T.selected&&c&&(r==null?void 0:r.length)===c);if(!N){var V=r?tY([],r):[];if(T.selected){var H=V.findIndex(function(G){return Xl(b,G)});V.splice(H,1)}else V.push(b);(R=t.onSelect)===null||R===void 0||R.call(t,V,b,T,A)}}},i={disabled:[]};r&&i.disabled.push(function(b){var T=c&&r.length>c-1,A=r.some(function(k){return Xl(k,b)});return!!(T&&!A)});var _={selected:r,onDayClick:d,modifiers:i};return _e.jsx(jN.Provider,{value:_,children:n})}function $N(){var e=X.useContext(jN);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function A1e(e,t){var n=t||{},r=n.from,a=n.to;return r&&a?Xl(a,e)&&Xl(r,e)?void 0:Xl(a,e)?{from:a,to:void 0}:Xl(r,e)?void 0:JD(r,e)?{from:e,to:a}:{from:r,to:e}:a?JD(e,a)?{from:a,to:e}:{from:e,to:a}:r?eY(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var UN=X.createContext(void 0);function P1e(e){if(!kS(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return _e.jsx(UN.Provider,{value:t,children:e.children})}return _e.jsx(C1e,{initialProps:e.initialProps,children:e.children})}function C1e(e){var t=e.initialProps,n=e.children,r=t.selected,a=r||{},c=a.from,d=a.to,i=t.min,_=t.max,b=function(R,B,N){var V,H;(V=t.onDayClick)===null||V===void 0||V.call(t,R,B,N);var G=A1e(R,r);(H=t.onSelect)===null||H===void 0||H.call(t,G,R,B,N)},T={range_start:[],range_end:[],range_middle:[],disabled:[]};if(c?(T.range_start=[c],d?(T.range_end=[d],Xl(c,d)||(T.range_middle=[{after:c,before:d}])):T.range_end=[c]):d&&(T.range_start=[d],T.range_end=[d]),i&&(c&&!d&&T.disabled.push({after:zk(c,i-1),before:ml(c,i-1)}),c&&d&&T.disabled.push({after:c,before:ml(c,i-1)}),!c&&d&&T.disabled.push({after:zk(d,i-1),before:ml(d,i-1)})),_){if(c&&!d&&(T.disabled.push({before:ml(c,-_+1)}),T.disabled.push({after:ml(c,_-1)})),c&&d){var A=Gh(d,c)+1,k=_-A;T.disabled.push({before:zk(c,k)}),T.disabled.push({after:ml(d,k)})}!c&&d&&(T.disabled.push({before:ml(d,-_+1)}),T.disabled.push({after:ml(d,_-1)}))}return _e.jsx(UN.Provider,{value:{selected:r,onDayClick:b,modifiers:T},children:n})}function VN(){var e=X.useContext(UN);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function O2(e){return Array.isArray(e)?tY([],e):e!==void 0?[e]:[]}function I1e(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],a=n[1];t[r]=O2(a)}),t}var hh;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(hh||(hh={}));var M1e=hh.Selected,$d=hh.Disabled,O1e=hh.Hidden,k1e=hh.Today,Fk=hh.RangeEnd,Bk=hh.RangeMiddle,jk=hh.RangeStart,R1e=hh.Outside;function D1e(e,t,n){var r,a=(r={},r[M1e]=O2(e.selected),r[$d]=O2(e.disabled),r[O1e]=O2(e.hidden),r[k1e]=[e.today],r[Fk]=[],r[Bk]=[],r[jk]=[],r[R1e]=[],r);return e.fromDate&&a[$d].push({before:e.fromDate}),e.toDate&&a[$d].push({after:e.toDate}),OS(e)?a[$d]=a[$d].concat(t.modifiers[$d]):kS(e)&&(a[$d]=a[$d].concat(n.modifiers[$d]),a[jk]=n.modifiers[jk],a[Bk]=n.modifiers[Bk],a[Fk]=n.modifiers[Fk]),a}var aY=X.createContext(void 0);function L1e(e){var t=Fo(),n=$N(),r=VN(),a=D1e(t,n,r),c=I1e(t.modifiers),d=qr(qr({},a),c);return _e.jsx(aY.Provider,{value:d,children:e.children})}function sY(){var e=X.useContext(aY);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function z1e(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function N1e(e){return!!(e&&typeof e=="object"&&"from"in e)}function F1e(e){return!!(e&&typeof e=="object"&&"after"in e)}function B1e(e){return!!(e&&typeof e=="object"&&"before"in e)}function j1e(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function $1e(e,t){var n,r=t.from,a=t.to;if(r&&a){var c=Gh(a,r)<0;c&&(n=[a,r],r=n[0],a=n[1]);var d=Gh(e,r)>=0&&Gh(a,e)>=0;return d}return a?Xl(a,e):r?Xl(r,e):!1}function U1e(e){return zN(e)}function V1e(e){return Array.isArray(e)&&e.every(zN)}function W1e(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(U1e(n))return Xl(e,n);if(V1e(n))return n.includes(e);if(N1e(n))return $1e(e,n);if(j1e(n))return n.dayOfWeek.includes(e.getDay());if(z1e(n)){var r=Gh(n.before,e),a=Gh(n.after,e),c=r>0,d=a<0,i=JD(n.before,n.after);return i?d&&c:c||d}return F1e(n)?Gh(e,n.after)>0:B1e(n)?Gh(n.before,e)>0:typeof n=="function"?n(e):!1})}function WN(e,t,n){var r=Object.keys(t).reduce(function(c,d){var i=t[d];return W1e(e,i)&&c.push(d),c},[]),a={};return r.forEach(function(c){return a[c]=!0}),n&&!BN(e,n)&&(a.outside=!0),a}function G1e(e,t){for(var n=ec(e[0]),r=LC(e[e.length-1]),a,c,d=n;d<=r;){var i=WN(d,t),_=!i.disabled&&!i.hidden;if(!_){d=ml(d,1);continue}if(i.selected)return d;i.today&&!c&&(c=d),a||(a=d),d=ml(d,1)}return c||a}var H1e=365;function lY(e,t){var n=t.moveBy,r=t.direction,a=t.context,c=t.modifiers,d=t.retry,i=d===void 0?{count:0,lastFocused:e}:d,_=a.weekStartsOn,b=a.fromDate,T=a.toDate,A=a.locale,k={day:ml,week:YD,month:uh,year:A0e,startOfWeek:function(V){return a.ISOWeek?l_(V):rd(V,{locale:A,weekStartsOn:_})},endOfWeek:function(V){return a.ISOWeek?XK(V):NN(V,{locale:A,weekStartsOn:_})}},R=k[n](e,r==="after"?1:-1);r==="before"&&b?R=P0e([b,R]):r==="after"&&T&&(R=C0e([T,R]));var B=!0;if(c){var N=WN(R,c);B=!N.disabled&&!N.hidden}return B?R:i.count>H1e?i.lastFocused:lY(R,{moveBy:n,direction:r,context:a,modifiers:c,retry:qr(qr({},i),{count:i.count+1})})}var cY=X.createContext(void 0);function q1e(e){var t=RS(),n=sY(),r=X.useState(),a=r[0],c=r[1],d=X.useState(),i=d[0],_=d[1],b=G1e(t.displayMonths,n),T=a??(i&&t.isDateDisplayed(i))?i:b,A=function(){_(a),c(void 0)},k=function(V){c(V)},R=Fo(),B=function(V,H){if(a){var G=lY(a,{moveBy:V,direction:H,context:R,modifiers:n});Xl(a,G)||(t.goToDate(G,a),k(G))}},N={focusedDay:a,focusTarget:T,blur:A,focus:k,focusDayAfter:function(){return B("day","after")},focusDayBefore:function(){return B("day","before")},focusWeekAfter:function(){return B("week","after")},focusWeekBefore:function(){return B("week","before")},focusMonthBefore:function(){return B("month","before")},focusMonthAfter:function(){return B("month","after")},focusYearBefore:function(){return B("year","before")},focusYearAfter:function(){return B("year","after")},focusStartOfWeek:function(){return B("startOfWeek","before")},focusEndOfWeek:function(){return B("endOfWeek","after")}};return _e.jsx(cY.Provider,{value:N,children:e.children})}function GN(){var e=X.useContext(cY);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Z1e(e,t){var n=sY(),r=WN(e,n,t);return r}var HN=X.createContext(void 0);function X1e(e){if(!zC(e.initialProps)){var t={selected:void 0};return _e.jsx(HN.Provider,{value:t,children:e.children})}return _e.jsx(K1e,{initialProps:e.initialProps,children:e.children})}function K1e(e){var t=e.initialProps,n=e.children,r=function(c,d,i){var _,b,T;if((_=t.onDayClick)===null||_===void 0||_.call(t,c,d,i),d.selected&&!t.required){(b=t.onSelect)===null||b===void 0||b.call(t,void 0,c,d,i);return}(T=t.onSelect)===null||T===void 0||T.call(t,c,c,d,i)},a={selected:t.selected,onDayClick:r};return _e.jsx(HN.Provider,{value:a,children:n})}function uY(){var e=X.useContext(HN);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Y1e(e,t){var n=Fo(),r=uY(),a=$N(),c=VN(),d=GN(),i=d.focusDayAfter,_=d.focusDayBefore,b=d.focusWeekAfter,T=d.focusWeekBefore,A=d.blur,k=d.focus,R=d.focusMonthBefore,B=d.focusMonthAfter,N=d.focusYearBefore,V=d.focusYearAfter,H=d.focusStartOfWeek,G=d.focusEndOfWeek,q=function(rt){var Be,nt,at,Mt;zC(n)?(Be=r.onDayClick)===null||Be===void 0||Be.call(r,e,t,rt):OS(n)?(nt=a.onDayClick)===null||nt===void 0||nt.call(a,e,t,rt):kS(n)?(at=c.onDayClick)===null||at===void 0||at.call(c,e,t,rt):(Mt=n.onDayClick)===null||Mt===void 0||Mt.call(n,e,t,rt)},Q=function(rt){var Be;k(e),(Be=n.onDayFocus)===null||Be===void 0||Be.call(n,e,t,rt)},te=function(rt){var Be;A(),(Be=n.onDayBlur)===null||Be===void 0||Be.call(n,e,t,rt)},ue=function(rt){var Be;(Be=n.onDayMouseEnter)===null||Be===void 0||Be.call(n,e,t,rt)},fe=function(rt){var Be;(Be=n.onDayMouseLeave)===null||Be===void 0||Be.call(n,e,t,rt)},ye=function(rt){var Be;(Be=n.onDayPointerEnter)===null||Be===void 0||Be.call(n,e,t,rt)},De=function(rt){var Be;(Be=n.onDayPointerLeave)===null||Be===void 0||Be.call(n,e,t,rt)},Ne=function(rt){var Be;(Be=n.onDayTouchCancel)===null||Be===void 0||Be.call(n,e,t,rt)},Fe=function(rt){var Be;(Be=n.onDayTouchEnd)===null||Be===void 0||Be.call(n,e,t,rt)},Le=function(rt){var Be;(Be=n.onDayTouchMove)===null||Be===void 0||Be.call(n,e,t,rt)},Ze=function(rt){var Be;(Be=n.onDayTouchStart)===null||Be===void 0||Be.call(n,e,t,rt)},He=function(rt){var Be;(Be=n.onDayKeyUp)===null||Be===void 0||Be.call(n,e,t,rt)},ct=function(rt){var Be;switch(rt.key){case"ArrowLeft":rt.preventDefault(),rt.stopPropagation(),n.dir==="rtl"?i():_();break;case"ArrowRight":rt.preventDefault(),rt.stopPropagation(),n.dir==="rtl"?_():i();break;case"ArrowDown":rt.preventDefault(),rt.stopPropagation(),b();break;case"ArrowUp":rt.preventDefault(),rt.stopPropagation(),T();break;case"PageUp":rt.preventDefault(),rt.stopPropagation(),rt.shiftKey?N():R();break;case"PageDown":rt.preventDefault(),rt.stopPropagation(),rt.shiftKey?V():B();break;case"Home":rt.preventDefault(),rt.stopPropagation(),H();break;case"End":rt.preventDefault(),rt.stopPropagation(),G();break}(Be=n.onDayKeyDown)===null||Be===void 0||Be.call(n,e,t,rt)},ot={onClick:q,onFocus:Q,onBlur:te,onKeyDown:ct,onKeyUp:He,onMouseEnter:ue,onMouseLeave:fe,onPointerEnter:ye,onPointerLeave:De,onTouchCancel:Ne,onTouchEnd:Fe,onTouchMove:Le,onTouchStart:Ze};return ot}function J1e(){var e=Fo(),t=uY(),n=$N(),r=VN(),a=zC(e)?t.selected:OS(e)?n.selected:kS(e)?r.selected:void 0;return a}function Q1e(e){return Object.values(hh).includes(e)}function ebe(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var a=e.modifiersClassNames[r];if(a)n.push(a);else if(Q1e(r)){var c=e.classNames["day_".concat(r)];c&&n.push(c)}}),n}function tbe(e,t){var n=qr({},e.styles.day);return Object.keys(t).forEach(function(r){var a;n=qr(qr({},n),(a=e.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function nbe(e,t,n){var r,a,c,d=Fo(),i=GN(),_=Z1e(e,t),b=Y1e(e,_),T=J1e(),A=!!(d.onDayClick||d.mode!=="default");X.useEffect(function(){var ue;_.outside||i.focusedDay&&A&&Xl(i.focusedDay,e)&&((ue=n.current)===null||ue===void 0||ue.focus())},[i.focusedDay,e,n,A,_.outside]);var k=ebe(d,_).join(" "),R=tbe(d,_),B=!!(_.outside&&!d.showOutsideDays||_.hidden),N=(c=(a=d.components)===null||a===void 0?void 0:a.DayContent)!==null&&c!==void 0?c:S1e,V=_e.jsx(N,{date:e,displayMonth:t,activeModifiers:_}),H={style:R,className:k,children:V,role:"gridcell"},G=i.focusTarget&&Xl(i.focusTarget,e)&&!_.outside,q=i.focusedDay&&Xl(i.focusedDay,e),Q=qr(qr(qr({},H),(r={disabled:_.disabled,role:"gridcell"},r["aria-selected"]=_.selected,r.tabIndex=q||G?0:-1,r)),b),te={isButton:A,isHidden:B,activeModifiers:_,selectedDays:T,buttonProps:Q,divProps:H};return te}function rbe(e){var t=X.useRef(null),n=nbe(e.date,e.displayMonth,t);return n.isHidden?_e.jsx("div",{role:"gridcell"}):n.isButton?_e.jsx(IA,qr({name:"day",ref:t},n.buttonProps)):_e.jsx("div",qr({},n.divProps))}function ibe(e){var t=e.number,n=e.dates,r=Fo(),a=r.onWeekNumberClick,c=r.styles,d=r.classNames,i=r.locale,_=r.labels.labelWeekNumber,b=r.formatters.formatWeekNumber,T=b(Number(t),{locale:i});if(!a)return _e.jsx("span",{className:d.weeknumber,style:c.weeknumber,children:T});var A=_(Number(t),{locale:i}),k=function(R){a(t,n,R)};return _e.jsx(IA,{name:"week-number","aria-label":A,className:d.weeknumber,style:c.weeknumber,onClick:k,children:T})}function obe(e){var t,n,r=Fo(),a=r.styles,c=r.classNames,d=r.showWeekNumber,i=r.components,_=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:rbe,b=(n=i==null?void 0:i.WeekNumber)!==null&&n!==void 0?n:ibe,T;return d&&(T=_e.jsx("td",{className:c.cell,style:a.cell,children:_e.jsx(b,{number:e.weekNumber,dates:e.dates})})),_e.jsxs("tr",{className:c.row,style:a.row,children:[T,e.dates.map(function(A){return _e.jsx("td",{className:c.cell,style:a.cell,role:"presentation",children:_e.jsx(_,{displayMonth:e.displayMonth,date:A})},Lxe(A))})]})}function a6(e,t,n){for(var r=n!=null&&n.ISOWeek?XK(t):NN(t,n),a=n!=null&&n.ISOWeek?l_(e):rd(e,n),c=Gh(r,a),d=[],i=0;i<=c;i++)d.push(ml(a,i));var _=d.reduce(function(b,T){var A=n!=null&&n.ISOWeek?KK(T):JK(T,n),k=b.find(function(R){return R.weekNumber===A});return k?(k.dates.push(T),b):(b.push({weekNumber:A,dates:[T]}),b)},[]);return _}function abe(e,t){var n=a6(ec(e),LC(e),t);if(t!=null&&t.useFixedWeeks){var r=Nxe(e,t);if(r<6){var a=n[n.length-1],c=a.dates[a.dates.length-1],d=YD(c,6-r),i=a6(YD(c,1),d,t);n.push.apply(n,i)}}return n}function sbe(e){var t,n,r,a=Fo(),c=a.locale,d=a.classNames,i=a.styles,_=a.hideHead,b=a.fixedWeeks,T=a.components,A=a.weekStartsOn,k=a.firstWeekContainsDate,R=a.ISOWeek,B=abe(e.displayMonth,{useFixedWeeks:!!b,ISOWeek:R,locale:c,weekStartsOn:A,firstWeekContainsDate:k}),N=(t=T==null?void 0:T.Head)!==null&&t!==void 0?t:w1e,V=(n=T==null?void 0:T.Row)!==null&&n!==void 0?n:obe,H=(r=T==null?void 0:T.Footer)!==null&&r!==void 0?r:v1e;return _e.jsxs("table",{id:e.id,className:d.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!_&&_e.jsx(N,{}),_e.jsx("tbody",{className:d.tbody,style:i.tbody,children:B.map(function(G){return _e.jsx(V,{displayMonth:e.displayMonth,dates:G.dates,weekNumber:G.weekNumber},G.weekNumber)})}),_e.jsx(H,{displayMonth:e.displayMonth})]})}function lbe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var cbe=lbe()?X.useLayoutEffect:X.useEffect,$k=!1,ube=0;function s6(){return"react-day-picker-".concat(++ube)}function hbe(e){var t,n=e??($k?s6():null),r=X.useState(n),a=r[0],c=r[1];return cbe(function(){a===null&&c(s6())},[]),X.useEffect(function(){$k===!1&&($k=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function dbe(e){var t,n,r=Fo(),a=r.dir,c=r.classNames,d=r.styles,i=r.components,_=RS().displayMonths,b=hbe(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),T=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,A=[c.month],k=d.month,R=e.displayIndex===0,B=e.displayIndex===_.length-1,N=!R&&!B;a==="rtl"&&(t=[R,B],B=t[0],R=t[1]),R&&(A.push(c.caption_start),k=qr(qr({},k),d.caption_start)),B&&(A.push(c.caption_end),k=qr(qr({},k),d.caption_end)),N&&(A.push(c.caption_between),k=qr(qr({},k),d.caption_between));var V=(n=i==null?void 0:i.Caption)!==null&&n!==void 0?n:y1e;return _e.jsxs("div",{className:A.join(" "),style:k,children:[_e.jsx(V,{id:b,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),_e.jsx(sbe,{id:T,"aria-labelledby":b,displayMonth:e.displayMonth})]},e.displayIndex)}function fbe(e){var t=Fo(),n=t.classNames,r=t.styles;return _e.jsx("div",{className:n.months,style:r.months,children:e.children})}function pbe(e){var t,n,r=e.initialProps,a=Fo(),c=GN(),d=RS(),i=X.useState(!1),_=i[0],b=i[1];X.useEffect(function(){a.initialFocus&&c.focusTarget&&(_||(c.focus(c.focusTarget),b(!0)))},[a.initialFocus,_,c.focus,c.focusTarget,c]);var T=[a.classNames.root,a.className];a.numberOfMonths>1&&T.push(a.classNames.multiple_months),a.showWeekNumber&&T.push(a.classNames.with_weeknumber);var A=qr(qr({},a.styles.root),a.style),k=Object.keys(r).filter(function(B){return B.startsWith("data-")}).reduce(function(B,N){var V;return qr(qr({},B),(V={},V[N]=r[N],V))},{}),R=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:fbe;return _e.jsx("div",qr({className:T.join(" "),style:A,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},k,{children:_e.jsx(R,{children:d.displayMonths.map(function(B,N){return _e.jsx(dbe,{displayIndex:N,displayMonth:B},N)})})}))}function mbe(e){var t=e.children,n=Bxe(e,["children"]);return _e.jsx(i1e,{initialProps:n,children:_e.jsx(p1e,{children:_e.jsx(X1e,{initialProps:n,children:_e.jsx(T1e,{initialProps:n,children:_e.jsx(P1e,{initialProps:n,children:_e.jsx(L1e,{children:_e.jsx(q1e,{children:t})})})})})})})}function IJe(e){return _e.jsx(mbe,qr({},e,{children:_e.jsx(pbe,{initialProps:e})}))}function gbe(e,t=[]){let n=[];function r(c,d){const i=X.createContext(d),_=n.length;n=[...n,d];function b(A){const{scope:k,children:R,...B}=A,N=(k==null?void 0:k[e][_])||i,V=X.useMemo(()=>B,Object.values(B));return _e.jsx(N.Provider,{value:V,children:R})}function T(A,k){const R=(k==null?void 0:k[e][_])||i,B=X.useContext(R);if(B)return B;if(d!==void 0)return d;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(d=>X.createContext(d));return function(i){const _=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[r,_be(a,...t)]}function _be(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const d=r.reduce((i,{useScope:_,scopeName:b})=>{const A=_(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}var qN="Progress",ZN=100,[ybe,MJe]=gbe(qN),[vbe,xbe]=ybe(qN),hY=X.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:c=bbe,...d}=e;(a||a===0)&&!l6(a)&&console.error(wbe(`${a}`,"Progress"));const i=l6(a)?a:ZN;r!==null&&!c6(r,i)&&console.error(Sbe(`${r}`,"Progress"));const _=c6(r,i)?r:null,b=MA(_)?c(_,i):void 0;return _e.jsx(vbe,{scope:n,value:_,max:i,children:_e.jsx(Qn.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":MA(_)?_:void 0,"aria-valuetext":b,role:"progressbar","data-state":pY(_,i),"data-value":_??void 0,"data-max":i,...d,ref:t})})});hY.displayName=qN;var dY="ProgressIndicator",fY=X.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,a=xbe(dY,n);return _e.jsx(Qn.div,{"data-state":pY(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});fY.displayName=dY;function bbe(e,t){return`${Math.round(e/t*100)}%`}function pY(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function MA(e){return typeof e=="number"}function l6(e){return MA(e)&&!isNaN(e)&&e>0}function c6(e,t){return MA(e)&&!isNaN(e)&&e<=t&&e>=0}function wbe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ZN}\`.`}function Sbe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ZN} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var OJe=hY,kJe=fY;function QD(e,[t,n]){return Math.min(n,Math.max(t,e))}function Tbe(e,t){return X.useReducer((n,r)=>t[n][r]??n,e)}var XN="ScrollArea",[mY,RJe]=Al(XN),[Ebe,du]=mY(XN),gY=X.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:c=600,...d}=e,[i,_]=X.useState(null),[b,T]=X.useState(null),[A,k]=X.useState(null),[R,B]=X.useState(null),[N,V]=X.useState(null),[H,G]=X.useState(0),[q,Q]=X.useState(0),[te,ue]=X.useState(!1),[fe,ye]=X.useState(!1),De=Xr(t,Fe=>_(Fe)),Ne=S_(a);return _e.jsx(Ebe,{scope:n,type:r,dir:Ne,scrollHideDelay:c,scrollArea:i,viewport:b,onViewportChange:T,content:A,onContentChange:k,scrollbarX:R,onScrollbarXChange:B,scrollbarXEnabled:te,onScrollbarXEnabledChange:ue,scrollbarY:N,onScrollbarYChange:V,scrollbarYEnabled:fe,onScrollbarYEnabledChange:ye,onCornerWidthChange:G,onCornerHeightChange:Q,children:_e.jsx(Qn.div,{dir:Ne,...d,ref:De,style:{position:"relative","--radix-scroll-area-corner-width":H+"px","--radix-scroll-area-corner-height":q+"px",...e.style}})})});gY.displayName=XN;var _Y="ScrollAreaViewport",yY=X.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,asChild:a,nonce:c,...d}=e,i=du(_Y,n),_=X.useRef(null),b=Xr(t,_,i.onViewportChange);return _e.jsxs(_e.Fragment,{children:[_e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:c}),_e.jsx(Qn.div,{"data-radix-scroll-area-viewport":"",...d,asChild:a,ref:b,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:Nbe({asChild:a,children:r},T=>_e.jsx("div",{"data-radix-scroll-area-content":"",ref:i.onContentChange,style:{minWidth:i.scrollbarXEnabled?"fit-content":void 0},children:T}))})]})});yY.displayName=_Y;var ad="ScrollAreaScrollbar",Abe=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=du(ad,e.__scopeScrollArea),{onScrollbarXEnabledChange:c,onScrollbarYEnabledChange:d}=a,i=e.orientation==="horizontal";return X.useEffect(()=>(i?c(!0):d(!0),()=>{i?c(!1):d(!1)}),[i,c,d]),a.type==="hover"?_e.jsx(Pbe,{...r,ref:t,forceMount:n}):a.type==="scroll"?_e.jsx(Cbe,{...r,ref:t,forceMount:n}):a.type==="auto"?_e.jsx(vY,{...r,ref:t,forceMount:n}):a.type==="always"?_e.jsx(KN,{...r,ref:t}):null});Abe.displayName=ad;var Pbe=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=du(ad,e.__scopeScrollArea),[c,d]=X.useState(!1);return X.useEffect(()=>{const i=a.scrollArea;let _=0;if(i){const b=()=>{window.clearTimeout(_),d(!0)},T=()=>{_=window.setTimeout(()=>d(!1),a.scrollHideDelay)};return i.addEventListener("pointerenter",b),i.addEventListener("pointerleave",T),()=>{window.clearTimeout(_),i.removeEventListener("pointerenter",b),i.removeEventListener("pointerleave",T)}}},[a.scrollArea,a.scrollHideDelay]),_e.jsx(Aa,{present:n||c,children:_e.jsx(vY,{"data-state":c?"visible":"hidden",...r,ref:t})})}),Cbe=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=du(ad,e.__scopeScrollArea),c=e.orientation==="horizontal",d=FC(()=>_("SCROLL_END"),100),[i,_]=Tbe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return X.useEffect(()=>{if(i==="idle"){const b=window.setTimeout(()=>_("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(b)}},[i,a.scrollHideDelay,_]),X.useEffect(()=>{const b=a.viewport,T=c?"scrollLeft":"scrollTop";if(b){let A=b[T];const k=()=>{const R=b[T];A!==R&&(_("SCROLL"),d()),A=R};return b.addEventListener("scroll",k),()=>b.removeEventListener("scroll",k)}},[a.viewport,c,_,d]),_e.jsx(Aa,{present:n||i!=="hidden",children:_e.jsx(KN,{"data-state":i==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:On(e.onPointerEnter,()=>_("POINTER_ENTER")),onPointerLeave:On(e.onPointerLeave,()=>_("POINTER_LEAVE"))})})}),vY=X.forwardRef((e,t)=>{const n=du(ad,e.__scopeScrollArea),{forceMount:r,...a}=e,[c,d]=X.useState(!1),i=e.orientation==="horizontal",_=FC(()=>{if(n.viewport){const b=n.viewport.offsetWidth<n.viewport.scrollWidth,T=n.viewport.offsetHeight<n.viewport.scrollHeight;d(i?b:T)}},10);return Qv(n.viewport,_),Qv(n.content,_),_e.jsx(Aa,{present:r||c,children:_e.jsx(KN,{"data-state":c?"visible":"hidden",...a,ref:t})})}),KN=X.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,a=du(ad,e.__scopeScrollArea),c=X.useRef(null),d=X.useRef(0),[i,_]=X.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),b=SY(i.viewport,i.content),T={...r,sizes:i,onSizesChange:_,hasThumb:b>0&&b<1,onThumbChange:k=>c.current=k,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:k=>d.current=k};function A(k,R){return Lbe(k,d.current,i,R)}return n==="horizontal"?_e.jsx(Ibe,{...T,ref:t,onThumbPositionChange:()=>{if(a.viewport&&c.current){const k=a.viewport.scrollLeft,R=u6(k,i,a.dir);c.current.style.transform=`translate3d(${R}px, 0, 0)`}},onWheelScroll:k=>{a.viewport&&(a.viewport.scrollLeft=k)},onDragScroll:k=>{a.viewport&&(a.viewport.scrollLeft=A(k,a.dir))}}):n==="vertical"?_e.jsx(Mbe,{...T,ref:t,onThumbPositionChange:()=>{if(a.viewport&&c.current){const k=a.viewport.scrollTop,R=u6(k,i);c.current.style.transform=`translate3d(0, ${R}px, 0)`}},onWheelScroll:k=>{a.viewport&&(a.viewport.scrollTop=k)},onDragScroll:k=>{a.viewport&&(a.viewport.scrollTop=A(k))}}):null}),Ibe=X.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,c=du(ad,e.__scopeScrollArea),[d,i]=X.useState(),_=X.useRef(null),b=Xr(t,_,c.onScrollbarXChange);return X.useEffect(()=>{_.current&&i(getComputedStyle(_.current))},[_]),_e.jsx(bY,{"data-orientation":"horizontal",...a,ref:b,sizes:n,style:{bottom:0,left:c.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:c.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":NC(n)+"px",...e.style},onThumbPointerDown:T=>e.onThumbPointerDown(T.x),onDragScroll:T=>e.onDragScroll(T.x),onWheelScroll:(T,A)=>{if(c.viewport){const k=c.viewport.scrollLeft+T.deltaX;e.onWheelScroll(k),EY(k,A)&&T.preventDefault()}},onResize:()=>{_.current&&c.viewport&&d&&r({content:c.viewport.scrollWidth,viewport:c.viewport.offsetWidth,scrollbar:{size:_.current.clientWidth,paddingStart:kA(d.paddingLeft),paddingEnd:kA(d.paddingRight)}})}})}),Mbe=X.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,c=du(ad,e.__scopeScrollArea),[d,i]=X.useState(),_=X.useRef(null),b=Xr(t,_,c.onScrollbarYChange);return X.useEffect(()=>{_.current&&i(getComputedStyle(_.current))},[_]),_e.jsx(bY,{"data-orientation":"vertical",...a,ref:b,sizes:n,style:{top:0,right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":NC(n)+"px",...e.style},onThumbPointerDown:T=>e.onThumbPointerDown(T.y),onDragScroll:T=>e.onDragScroll(T.y),onWheelScroll:(T,A)=>{if(c.viewport){const k=c.viewport.scrollTop+T.deltaY;e.onWheelScroll(k),EY(k,A)&&T.preventDefault()}},onResize:()=>{_.current&&c.viewport&&d&&r({content:c.viewport.scrollHeight,viewport:c.viewport.offsetHeight,scrollbar:{size:_.current.clientHeight,paddingStart:kA(d.paddingTop),paddingEnd:kA(d.paddingBottom)}})}})}),[Obe,xY]=mY(ad),bY=X.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:c,onThumbPointerUp:d,onThumbPointerDown:i,onThumbPositionChange:_,onDragScroll:b,onWheelScroll:T,onResize:A,...k}=e,R=du(ad,n),[B,N]=X.useState(null),V=Xr(t,De=>N(De)),H=X.useRef(null),G=X.useRef(""),q=R.viewport,Q=r.content-r.viewport,te=Co(T),ue=Co(_),fe=FC(A,10);function ye(De){if(H.current){const Ne=De.clientX-H.current.left,Fe=De.clientY-H.current.top;b({x:Ne,y:Fe})}}return X.useEffect(()=>{const De=Ne=>{const Fe=Ne.target;(B==null?void 0:B.contains(Fe))&&te(Ne,Q)};return document.addEventListener("wheel",De,{passive:!1}),()=>document.removeEventListener("wheel",De,{passive:!1})},[q,B,Q,te]),X.useEffect(ue,[r,ue]),Qv(B,fe),Qv(R.content,fe),_e.jsx(Obe,{scope:n,scrollbar:B,hasThumb:a,onThumbChange:Co(c),onThumbPointerUp:Co(d),onThumbPositionChange:ue,onThumbPointerDown:Co(i),children:_e.jsx(Qn.div,{...k,ref:V,style:{position:"absolute",...k.style},onPointerDown:On(e.onPointerDown,De=>{De.button===0&&(De.target.setPointerCapture(De.pointerId),H.current=B.getBoundingClientRect(),G.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",R.viewport&&(R.viewport.style.scrollBehavior="auto"),ye(De))}),onPointerMove:On(e.onPointerMove,ye),onPointerUp:On(e.onPointerUp,De=>{const Ne=De.target;Ne.hasPointerCapture(De.pointerId)&&Ne.releasePointerCapture(De.pointerId),document.body.style.webkitUserSelect=G.current,R.viewport&&(R.viewport.style.scrollBehavior=""),H.current=null})})})}),OA="ScrollAreaThumb",kbe=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=xY(OA,e.__scopeScrollArea);return _e.jsx(Aa,{present:n||a.hasThumb,children:_e.jsx(Rbe,{ref:t,...r})})}),Rbe=X.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...a}=e,c=du(OA,n),d=xY(OA,n),{onThumbPositionChange:i}=d,_=Xr(t,A=>d.onThumbChange(A)),b=X.useRef(),T=FC(()=>{b.current&&(b.current(),b.current=void 0)},100);return X.useEffect(()=>{const A=c.viewport;if(A){const k=()=>{if(T(),!b.current){const R=zbe(A,i);b.current=R,i()}};return i(),A.addEventListener("scroll",k),()=>A.removeEventListener("scroll",k)}},[c.viewport,T,i]),_e.jsx(Qn.div,{"data-state":d.hasThumb?"visible":"hidden",...a,ref:_,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:On(e.onPointerDownCapture,A=>{const R=A.target.getBoundingClientRect(),B=A.clientX-R.left,N=A.clientY-R.top;d.onThumbPointerDown({x:B,y:N})}),onPointerUp:On(e.onPointerUp,d.onThumbPointerUp)})});kbe.displayName=OA;var YN="ScrollAreaCorner",wY=X.forwardRef((e,t)=>{const n=du(YN,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?_e.jsx(Dbe,{...e,ref:t}):null});wY.displayName=YN;var Dbe=X.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,a=du(YN,n),[c,d]=X.useState(0),[i,_]=X.useState(0),b=!!(c&&i);return Qv(a.scrollbarX,()=>{var A;const T=((A=a.scrollbarX)==null?void 0:A.offsetHeight)||0;a.onCornerHeightChange(T),_(T)}),Qv(a.scrollbarY,()=>{var A;const T=((A=a.scrollbarY)==null?void 0:A.offsetWidth)||0;a.onCornerWidthChange(T),d(T)}),b?_e.jsx(Qn.div,{...r,ref:t,style:{width:c,height:i,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function kA(e){return e?parseInt(e,10):0}function SY(e,t){const n=e/t;return isNaN(n)?0:n}function NC(e){const t=SY(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function Lbe(e,t,n,r="ltr"){const a=NC(n),c=a/2,d=t||c,i=a-d,_=n.scrollbar.paddingStart+d,b=n.scrollbar.size-n.scrollbar.paddingEnd-i,T=n.content-n.viewport,A=r==="ltr"?[0,T]:[T*-1,0];return TY([_,b],A)(e)}function u6(e,t,n="ltr"){const r=NC(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,c=t.scrollbar.size-a,d=t.content-t.viewport,i=c-r,_=n==="ltr"?[0,d]:[d*-1,0],b=QD(e,_);return TY([0,d],[0,i])(b)}function TY(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function EY(e,t){return e>0&&e<t}var zbe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function a(){const c={left:e.scrollLeft,top:e.scrollTop},d=n.left!==c.left,i=n.top!==c.top;(d||i)&&t(),n=c,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function FC(e,t){const n=Co(e),r=X.useRef(0);return X.useEffect(()=>()=>window.clearTimeout(r.current),[]),X.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Qv(e,t){const n=Co(t);Ea(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}function Nbe(e,t){const{asChild:n,children:r}=e;if(!n)return typeof t=="function"?t(r):t;const a=X.Children.only(r);return X.cloneElement(a,{children:typeof t=="function"?t(a.props.children):t})}var DJe=gY,LJe=yY,zJe=wY,Fbe=[" ","Enter","ArrowUp","ArrowDown"],Bbe=[" ","Enter"],DS="Select",[BC,jC,jbe]=$0(DS),[H0,NJe]=Al(DS,[jbe,xm]),$C=xm(),[$be,wm]=H0(DS),[Ube,Vbe]=H0(DS),AY=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:c,value:d,defaultValue:i,onValueChange:_,dir:b,name:T,autoComplete:A,disabled:k,required:R,form:B}=e,N=$C(t),[V,H]=X.useState(null),[G,q]=X.useState(null),[Q,te]=X.useState(!1),ue=S_(b),[fe=!1,ye]=Sl({prop:r,defaultProp:a,onChange:c}),[De,Ne]=Sl({prop:d,defaultProp:i,onChange:_}),Fe=X.useRef(null),Le=V?B||!!V.closest("form"):!0,[Ze,He]=X.useState(new Set),ct=Array.from(Ze).map(ot=>ot.props.value).join(";");return _e.jsx(TC,{...N,children:_e.jsxs($be,{required:R,scope:t,trigger:V,onTriggerChange:H,valueNode:G,onValueNodeChange:q,valueNodeHasChildren:Q,onValueNodeHasChildrenChange:te,contentId:el(),value:De,onValueChange:Ne,open:fe,onOpenChange:ye,dir:ue,triggerPointerDownPosRef:Fe,disabled:k,children:[_e.jsx(BC.Provider,{scope:t,children:_e.jsx(Ube,{scope:e.__scopeSelect,onNativeOptionAdd:X.useCallback(ot=>{He(rt=>new Set(rt).add(ot))},[]),onNativeOptionRemove:X.useCallback(ot=>{He(rt=>{const Be=new Set(rt);return Be.delete(ot),Be})},[]),children:n})}),Le?_e.jsxs(YY,{"aria-hidden":!0,required:R,tabIndex:-1,name:T,autoComplete:A,value:De,onChange:ot=>Ne(ot.target.value),disabled:k,form:B,children:[De===void 0?_e.jsx("option",{value:""}):null,Array.from(Ze)]},ct):null]})})};AY.displayName=DS;var PY="SelectTrigger",CY=X.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,c=$C(n),d=wm(PY,n),i=d.disabled||r,_=Xr(t,d.onTriggerChange),b=jC(n),T=X.useRef("touch"),[A,k,R]=JY(N=>{const V=b().filter(q=>!q.disabled),H=V.find(q=>q.value===d.value),G=QY(V,N,H);G!==void 0&&d.onValueChange(G.value)}),B=N=>{i||(d.onOpenChange(!0),R()),N&&(d.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return _e.jsx(TS,{asChild:!0,...c,children:_e.jsx(Qn.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":KY(d.value)?"":void 0,...a,ref:_,onClick:On(a.onClick,N=>{N.currentTarget.focus(),T.current!=="mouse"&&B(N)}),onPointerDown:On(a.onPointerDown,N=>{T.current=N.pointerType;const V=N.target;V.hasPointerCapture(N.pointerId)&&V.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(B(N),N.preventDefault())}),onKeyDown:On(a.onKeyDown,N=>{const V=A.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&k(N.key),!(V&&N.key===" ")&&Fbe.includes(N.key)&&(B(),N.preventDefault())})})})});CY.displayName=PY;var IY="SelectValue",MY=X.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:c,placeholder:d="",...i}=e,_=wm(IY,n),{onValueNodeHasChildrenChange:b}=_,T=c!==void 0,A=Xr(t,_.onValueNodeChange);return Ea(()=>{b(T)},[b,T]),_e.jsx(Qn.span,{...i,ref:A,style:{pointerEvents:"none"},children:KY(_.value)?_e.jsx(_e.Fragment,{children:d}):c})});MY.displayName=IY;var Wbe="SelectIcon",OY=X.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return _e.jsx(Qn.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});OY.displayName=Wbe;var Gbe="SelectPortal",kY=e=>_e.jsx(ES,{asChild:!0,...e});kY.displayName=Gbe;var c_="SelectContent",RY=X.forwardRef((e,t)=>{const n=wm(c_,e.__scopeSelect),[r,a]=X.useState();if(Ea(()=>{a(new DocumentFragment)},[]),!n.open){const c=r;return c?ym.createPortal(_e.jsx(DY,{scope:e.__scopeSelect,children:_e.jsx(BC.Slot,{scope:e.__scopeSelect,children:_e.jsx("div",{children:e.children})})}),c):null}return _e.jsx(LY,{...e,ref:t})});RY.displayName=c_;var Vu=10,[DY,Sm]=H0(c_),Hbe="SelectContentImpl",LY=X.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:c,onPointerDownOutside:d,side:i,sideOffset:_,align:b,alignOffset:T,arrowPadding:A,collisionBoundary:k,collisionPadding:R,sticky:B,hideWhenDetached:N,avoidCollisions:V,...H}=e,G=wm(c_,n),[q,Q]=X.useState(null),[te,ue]=X.useState(null),fe=Xr(t,Vt=>Q(Vt)),[ye,De]=X.useState(null),[Ne,Fe]=X.useState(null),Le=jC(n),[Ze,He]=X.useState(!1),ct=X.useRef(!1);X.useEffect(()=>{if(q)return AS(q)},[q]),xC();const ot=X.useCallback(Vt=>{const[$n,...Gt]=Le().map(yt=>yt.ref.current),[Tn]=Gt.slice(-1),hn=document.activeElement;for(const yt of Vt)if(yt===hn||(yt==null||yt.scrollIntoView({block:"nearest"}),yt===$n&&te&&(te.scrollTop=0),yt===Tn&&te&&(te.scrollTop=te.scrollHeight),yt==null||yt.focus(),document.activeElement!==hn))return},[Le,te]),rt=X.useCallback(()=>ot([ye,q]),[ot,ye,q]);X.useEffect(()=>{Ze&&rt()},[Ze,rt]);const{onOpenChange:Be,triggerPointerDownPosRef:nt}=G;X.useEffect(()=>{if(q){let Vt={x:0,y:0};const $n=Tn=>{var hn,yt;Vt={x:Math.abs(Math.round(Tn.pageX)-(((hn=nt.current)==null?void 0:hn.x)??0)),y:Math.abs(Math.round(Tn.pageY)-(((yt=nt.current)==null?void 0:yt.y)??0))}},Gt=Tn=>{Vt.x<=10&&Vt.y<=10?Tn.preventDefault():q.contains(Tn.target)||Be(!1),document.removeEventListener("pointermove",$n),nt.current=null};return nt.current!==null&&(document.addEventListener("pointermove",$n),document.addEventListener("pointerup",Gt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",$n),document.removeEventListener("pointerup",Gt,{capture:!0})}}},[q,Be,nt]),X.useEffect(()=>{const Vt=()=>Be(!1);return window.addEventListener("blur",Vt),window.addEventListener("resize",Vt),()=>{window.removeEventListener("blur",Vt),window.removeEventListener("resize",Vt)}},[Be]);const[at,Mt]=JY(Vt=>{const $n=Le().filter(hn=>!hn.disabled),Gt=$n.find(hn=>hn.ref.current===document.activeElement),Tn=QY($n,Vt,Gt);Tn&&setTimeout(()=>Tn.ref.current.focus())}),Nt=X.useCallback((Vt,$n,Gt)=>{const Tn=!ct.current&&!Gt;(G.value!==void 0&&G.value===$n||Tn)&&(De(Vt),Tn&&(ct.current=!0))},[G.value]),rn=X.useCallback(()=>q==null?void 0:q.focus(),[q]),un=X.useCallback((Vt,$n,Gt)=>{const Tn=!ct.current&&!Gt;(G.value!==void 0&&G.value===$n||Tn)&&Fe(Vt)},[G.value]),en=r==="popper"?eL:zY,sn=en===eL?{side:i,sideOffset:_,align:b,alignOffset:T,arrowPadding:A,collisionBoundary:k,collisionPadding:R,sticky:B,hideWhenDetached:N,avoidCollisions:V}:{};return _e.jsx(DY,{scope:n,content:q,viewport:te,onViewportChange:ue,itemRefCallback:Nt,selectedItem:ye,onItemLeave:rn,itemTextRefCallback:un,focusSelectedItem:rt,selectedItemText:Ne,position:r,isPositioned:Ze,searchRef:at,children:_e.jsx(PS,{as:rm,allowPinchZoom:!0,children:_e.jsx(wS,{asChild:!0,trapped:G.open,onMountAutoFocus:Vt=>{Vt.preventDefault()},onUnmountAutoFocus:On(a,Vt=>{var $n;($n=G.trigger)==null||$n.focus({preventScroll:!0}),Vt.preventDefault()}),children:_e.jsx(T_,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:Vt=>Vt.preventDefault(),onDismiss:()=>G.onOpenChange(!1),children:_e.jsx(en,{role:"listbox",id:G.contentId,"data-state":G.open?"open":"closed",dir:G.dir,onContextMenu:Vt=>Vt.preventDefault(),...H,...sn,onPlaced:()=>He(!0),ref:fe,style:{display:"flex",flexDirection:"column",outline:"none",...H.style},onKeyDown:On(H.onKeyDown,Vt=>{const $n=Vt.ctrlKey||Vt.altKey||Vt.metaKey;if(Vt.key==="Tab"&&Vt.preventDefault(),!$n&&Vt.key.length===1&&Mt(Vt.key),["ArrowUp","ArrowDown","Home","End"].includes(Vt.key)){let Tn=Le().filter(hn=>!hn.disabled).map(hn=>hn.ref.current);if(["ArrowUp","End"].includes(Vt.key)&&(Tn=Tn.slice().reverse()),["ArrowUp","ArrowDown"].includes(Vt.key)){const hn=Vt.target,yt=Tn.indexOf(hn);Tn=Tn.slice(yt+1)}setTimeout(()=>ot(Tn)),Vt.preventDefault()}})})})})})})});LY.displayName=Hbe;var qbe="SelectItemAlignedPosition",zY=X.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,c=wm(c_,n),d=Sm(c_,n),[i,_]=X.useState(null),[b,T]=X.useState(null),A=Xr(t,fe=>T(fe)),k=jC(n),R=X.useRef(!1),B=X.useRef(!0),{viewport:N,selectedItem:V,selectedItemText:H,focusSelectedItem:G}=d,q=X.useCallback(()=>{if(c.trigger&&c.valueNode&&i&&b&&N&&V&&H){const fe=c.trigger.getBoundingClientRect(),ye=b.getBoundingClientRect(),De=c.valueNode.getBoundingClientRect(),Ne=H.getBoundingClientRect();if(c.dir!=="rtl"){const hn=Ne.left-ye.left,yt=De.left-hn,In=fe.left-yt,Kn=fe.width+In,Ar=Math.max(Kn,ye.width),_r=window.innerWidth-Vu,Vr=QD(yt,[Vu,Math.max(Vu,_r-Ar)]);i.style.minWidth=Kn+"px",i.style.left=Vr+"px"}else{const hn=ye.right-Ne.right,yt=window.innerWidth-De.right-hn,In=window.innerWidth-fe.right-yt,Kn=fe.width+In,Ar=Math.max(Kn,ye.width),_r=window.innerWidth-Vu,Vr=QD(yt,[Vu,Math.max(Vu,_r-Ar)]);i.style.minWidth=Kn+"px",i.style.right=Vr+"px"}const Fe=k(),Le=window.innerHeight-Vu*2,Ze=N.scrollHeight,He=window.getComputedStyle(b),ct=parseInt(He.borderTopWidth,10),ot=parseInt(He.paddingTop,10),rt=parseInt(He.borderBottomWidth,10),Be=parseInt(He.paddingBottom,10),nt=ct+ot+Ze+Be+rt,at=Math.min(V.offsetHeight*5,nt),Mt=window.getComputedStyle(N),Nt=parseInt(Mt.paddingTop,10),rn=parseInt(Mt.paddingBottom,10),un=fe.top+fe.height/2-Vu,en=Le-un,sn=V.offsetHeight/2,Vt=V.offsetTop+sn,$n=ct+ot+Vt,Gt=nt-$n;if($n<=un){const hn=Fe.length>0&&V===Fe[Fe.length-1].ref.current;i.style.bottom="0px";const yt=b.clientHeight-N.offsetTop-N.offsetHeight,In=Math.max(en,sn+(hn?rn:0)+yt+rt),Kn=$n+In;i.style.height=Kn+"px"}else{const hn=Fe.length>0&&V===Fe[0].ref.current;i.style.top="0px";const In=Math.max(un,ct+N.offsetTop+(hn?Nt:0)+sn)+Gt;i.style.height=In+"px",N.scrollTop=$n-un+N.offsetTop}i.style.margin=`${Vu}px 0`,i.style.minHeight=at+"px",i.style.maxHeight=Le+"px",r==null||r(),requestAnimationFrame(()=>R.current=!0)}},[k,c.trigger,c.valueNode,i,b,N,V,H,c.dir,r]);Ea(()=>q(),[q]);const[Q,te]=X.useState();Ea(()=>{b&&te(window.getComputedStyle(b).zIndex)},[b]);const ue=X.useCallback(fe=>{fe&&B.current===!0&&(q(),G==null||G(),B.current=!1)},[q,G]);return _e.jsx(Xbe,{scope:n,contentWrapper:i,shouldExpandOnScrollRef:R,onScrollButtonChange:ue,children:_e.jsx("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:Q},children:_e.jsx(Qn.div,{...a,ref:A,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});zY.displayName=qbe;var Zbe="SelectPopperPosition",eL=X.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=Vu,...c}=e,d=$C(n);return _e.jsx(EC,{...d,...c,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});eL.displayName=Zbe;var[Xbe,JN]=H0(c_,{}),tL="SelectViewport",NY=X.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,c=Sm(tL,n),d=JN(tL,n),i=Xr(t,c.onViewportChange),_=X.useRef(0);return _e.jsxs(_e.Fragment,{children:[_e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),_e.jsx(BC.Slot,{scope:n,children:_e.jsx(Qn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:On(a.onScroll,b=>{const T=b.currentTarget,{contentWrapper:A,shouldExpandOnScrollRef:k}=d;if(k!=null&&k.current&&A){const R=Math.abs(_.current-T.scrollTop);if(R>0){const B=window.innerHeight-Vu*2,N=parseFloat(A.style.minHeight),V=parseFloat(A.style.height),H=Math.max(N,V);if(H<B){const G=H+R,q=Math.min(B,G),Q=G-q;A.style.height=q+"px",A.style.bottom==="0px"&&(T.scrollTop=Q>0?Q:0,A.style.justifyContent="flex-end")}}}_.current=T.scrollTop})})})]})});NY.displayName=tL;var FY="SelectGroup",[Kbe,Ybe]=H0(FY),Jbe=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=el();return _e.jsx(Kbe,{scope:n,id:a,children:_e.jsx(Qn.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Jbe.displayName=FY;var BY="SelectLabel",jY=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ybe(BY,n);return _e.jsx(Qn.div,{id:a.id,...r,ref:t})});jY.displayName=BY;var RA="SelectItem",[Qbe,$Y]=H0(RA),UY=X.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:c,...d}=e,i=wm(RA,n),_=Sm(RA,n),b=i.value===r,[T,A]=X.useState(c??""),[k,R]=X.useState(!1),B=Xr(t,G=>{var q;return(q=_.itemRefCallback)==null?void 0:q.call(_,G,r,a)}),N=el(),V=X.useRef("touch"),H=()=>{a||(i.onValueChange(r),i.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return _e.jsx(Qbe,{scope:n,value:r,disabled:a,textId:N,isSelected:b,onItemTextChange:X.useCallback(G=>{A(q=>q||((G==null?void 0:G.textContent)??"").trim())},[]),children:_e.jsx(BC.ItemSlot,{scope:n,value:r,disabled:a,textValue:T,children:_e.jsx(Qn.div,{role:"option","aria-labelledby":N,"data-highlighted":k?"":void 0,"aria-selected":b&&k,"data-state":b?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...d,ref:B,onFocus:On(d.onFocus,()=>R(!0)),onBlur:On(d.onBlur,()=>R(!1)),onClick:On(d.onClick,()=>{V.current!=="mouse"&&H()}),onPointerUp:On(d.onPointerUp,()=>{V.current==="mouse"&&H()}),onPointerDown:On(d.onPointerDown,G=>{V.current=G.pointerType}),onPointerMove:On(d.onPointerMove,G=>{var q;V.current=G.pointerType,a?(q=_.onItemLeave)==null||q.call(_):V.current==="mouse"&&G.currentTarget.focus({preventScroll:!0})}),onPointerLeave:On(d.onPointerLeave,G=>{var q;G.currentTarget===document.activeElement&&((q=_.onItemLeave)==null||q.call(_))}),onKeyDown:On(d.onKeyDown,G=>{var Q;((Q=_.searchRef)==null?void 0:Q.current)!==""&&G.key===" "||(Bbe.includes(G.key)&&H(),G.key===" "&&G.preventDefault())})})})})});UY.displayName=RA;var ub="SelectItemText",VY=X.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...c}=e,d=wm(ub,n),i=Sm(ub,n),_=$Y(ub,n),b=Vbe(ub,n),[T,A]=X.useState(null),k=Xr(t,H=>A(H),_.onItemTextChange,H=>{var G;return(G=i.itemTextRefCallback)==null?void 0:G.call(i,H,_.value,_.disabled)}),R=T==null?void 0:T.textContent,B=X.useMemo(()=>_e.jsx("option",{value:_.value,disabled:_.disabled,children:R},_.value),[_.disabled,_.value,R]),{onNativeOptionAdd:N,onNativeOptionRemove:V}=b;return Ea(()=>(N(B),()=>V(B)),[N,V,B]),_e.jsxs(_e.Fragment,{children:[_e.jsx(Qn.span,{id:_.textId,...c,ref:k}),_.isSelected&&d.valueNode&&!d.valueNodeHasChildren?ym.createPortal(c.children,d.valueNode):null]})});VY.displayName=ub;var WY="SelectItemIndicator",GY=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return $Y(WY,n).isSelected?_e.jsx(Qn.span,{"aria-hidden":!0,...r,ref:t}):null});GY.displayName=WY;var nL="SelectScrollUpButton",HY=X.forwardRef((e,t)=>{const n=Sm(nL,e.__scopeSelect),r=JN(nL,e.__scopeSelect),[a,c]=X.useState(!1),d=Xr(t,r.onScrollButtonChange);return Ea(()=>{if(n.viewport&&n.isPositioned){let i=function(){const b=_.scrollTop>0;c(b)};const _=n.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?_e.jsx(ZY,{...e,ref:d,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=n;i&&_&&(i.scrollTop=i.scrollTop-_.offsetHeight)}}):null});HY.displayName=nL;var rL="SelectScrollDownButton",qY=X.forwardRef((e,t)=>{const n=Sm(rL,e.__scopeSelect),r=JN(rL,e.__scopeSelect),[a,c]=X.useState(!1),d=Xr(t,r.onScrollButtonChange);return Ea(()=>{if(n.viewport&&n.isPositioned){let i=function(){const b=_.scrollHeight-_.clientHeight,T=Math.ceil(_.scrollTop)<b;c(T)};const _=n.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?_e.jsx(ZY,{...e,ref:d,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=n;i&&_&&(i.scrollTop=i.scrollTop+_.offsetHeight)}}):null});qY.displayName=rL;var ZY=X.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,c=Sm("SelectScrollButton",n),d=X.useRef(null),i=jC(n),_=X.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return X.useEffect(()=>()=>_(),[_]),Ea(()=>{var T;const b=i().find(A=>A.ref.current===document.activeElement);(T=b==null?void 0:b.ref.current)==null||T.scrollIntoView({block:"nearest"})},[i]),_e.jsx(Qn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:On(a.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(r,50))}),onPointerMove:On(a.onPointerMove,()=>{var b;(b=c.onItemLeave)==null||b.call(c),d.current===null&&(d.current=window.setInterval(r,50))}),onPointerLeave:On(a.onPointerLeave,()=>{_()})})}),ewe="SelectSeparator",XY=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return _e.jsx(Qn.div,{"aria-hidden":!0,...r,ref:t})});XY.displayName=ewe;var iL="SelectArrow",twe=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=$C(n),c=wm(iL,n),d=Sm(iL,n);return c.open&&d.position==="popper"?_e.jsx(AC,{...a,...r,ref:t}):null});twe.displayName=iL;function KY(e){return e===""||e===void 0}var YY=X.forwardRef((e,t)=>{const{value:n,...r}=e,a=X.useRef(null),c=Xr(t,a),d=kC(n);return X.useEffect(()=>{const i=a.current,_=window.HTMLSelectElement.prototype,T=Object.getOwnPropertyDescriptor(_,"value").set;if(d!==n&&T){const A=new Event("change",{bubbles:!0});T.call(i,n),i.dispatchEvent(A)}},[d,n]),_e.jsx(xN,{asChild:!0,children:_e.jsx("select",{...r,ref:c,defaultValue:n})})});YY.displayName="BubbleSelect";function JY(e){const t=Co(e),n=X.useRef(""),r=X.useRef(0),a=X.useCallback(d=>{const i=n.current+d;t(i),function _(b){n.current=b,window.clearTimeout(r.current),b!==""&&(r.current=window.setTimeout(()=>_(""),1e3))}(i)},[t]),c=X.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return X.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,c]}function QY(e,t,n){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let d=nwe(e,Math.max(c,0));a.length===1&&(d=d.filter(b=>b!==n));const _=d.find(b=>b.textValue.toLowerCase().startsWith(a.toLowerCase()));return _!==n?_:void 0}function nwe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var FJe=AY,BJe=CY,jJe=MY,$Je=OY,UJe=kY,VJe=RY,WJe=NY,GJe=jY,HJe=UY,qJe=VY,ZJe=GY,XJe=HY,KJe=qY,YJe=XY,LS=e=>e.type==="checkbox",$g=e=>e instanceof Date,gl=e=>e==null;const eJ=e=>typeof e=="object";var Ba=e=>!gl(e)&&!Array.isArray(e)&&eJ(e)&&!$g(e),tJ=e=>Ba(e)&&e.target?LS(e.target)?e.target.checked:e.target.value:e,rwe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,nJ=(e,t)=>e.has(rwe(t)),iwe=e=>{const t=e.constructor&&e.constructor.prototype;return Ba(t)&&t.hasOwnProperty("isPrototypeOf")},QN=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ul(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(QN&&(e instanceof Blob||e instanceof FileList))&&(n||Ba(e)))if(t=n?[]:{},!n&&!iwe(e))t=e;else for(const r in e)e.hasOwnProperty(r)&&(t[r]=Ul(e[r]));else return e;return t}var UC=e=>Array.isArray(e)?e.filter(Boolean):[],Sa=e=>e===void 0,Wn=(e,t,n)=>{if(!t||!Ba(e))return n;const r=UC(t.split(/[,[\].]+?/)).reduce((a,c)=>gl(a)?a:a[c],e);return Sa(r)||r===e?Sa(e[t])?n:e[t]:r},Jc=e=>typeof e=="boolean",eF=e=>/^\w*$/.test(e),rJ=e=>UC(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ho=(e,t,n)=>{let r=-1;const a=eF(t)?[t]:rJ(t),c=a.length,d=c-1;for(;++r<c;){const i=a[r];let _=n;if(r!==d){const b=e[i];_=Ba(b)||Array.isArray(b)?b:isNaN(+a[r+1])?{}:[]}if(i==="__proto__")return;e[i]=_,e=e[i]}return e};const DA={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Yu={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ud={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},iJ=Ce.createContext(null),tF=()=>Ce.useContext(iJ),JJe=e=>{const{children:t,...n}=e;return Ce.createElement(iJ.Provider,{value:n},t)};var oJ=(e,t,n,r=!0)=>{const a={defaultValues:t._defaultValues};for(const c in e)Object.defineProperty(a,c,{get:()=>{const d=c;return t._proxyFormState[d]!==Yu.all&&(t._proxyFormState[d]=!r||Yu.all),n&&(n[d]=!0),e[d]}});return a},Vl=e=>Ba(e)&&!Object.keys(e).length,aJ=(e,t,n,r)=>{n(e);const{name:a,...c}=e;return Vl(c)||Object.keys(c).length>=Object.keys(t).length||Object.keys(c).find(d=>t[d]===(!r||Yu.all))},Mb=e=>Array.isArray(e)?e:[e],sJ=(e,t,n)=>!e||!t||e===t||Mb(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r)));function nF(e){const t=Ce.useRef(e);t.current=e,Ce.useEffect(()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function owe(e){const t=tF(),{control:n=t.control,disabled:r,name:a,exact:c}=e||{},[d,i]=Ce.useState(n._formState),_=Ce.useRef(!0),b=Ce.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),T=Ce.useRef(a);return T.current=a,nF({disabled:r,next:A=>_.current&&sJ(T.current,A.name,c)&&aJ(A,b.current,n._updateFormState)&&i({...n._formState,...A}),subject:n._subjects.state}),Ce.useEffect(()=>(_.current=!0,b.current.isValid&&n._updateValid(!0),()=>{_.current=!1}),[n]),oJ(d,n,b.current,!1)}var Hh=e=>typeof e=="string",lJ=(e,t,n,r,a)=>Hh(e)?(r&&t.watch.add(e),Wn(n,e,a)):Array.isArray(e)?e.map(c=>(r&&t.watch.add(c),Wn(n,c))):(r&&(t.watchAll=!0),n);function awe(e){const t=tF(),{control:n=t.control,name:r,defaultValue:a,disabled:c,exact:d}=e||{},i=Ce.useRef(r);i.current=r,nF({disabled:c,subject:n._subjects.values,next:T=>{sJ(i.current,T.name,d)&&b(Ul(lJ(i.current,n._names,T.values||n._formValues,!1,a)))}});const[_,b]=Ce.useState(n._getWatch(r,a));return Ce.useEffect(()=>n._removeUnmounted()),_}function swe(e){const t=tF(),{name:n,disabled:r,control:a=t.control,shouldUnregister:c}=e,d=nJ(a._names.array,n),i=awe({control:a,name:n,defaultValue:Wn(a._formValues,n,Wn(a._defaultValues,n,e.defaultValue)),exact:!0}),_=owe({control:a,name:n,exact:!0}),b=Ce.useRef(a.register(n,{...e.rules,value:i,...Jc(e.disabled)?{disabled:e.disabled}:{}}));return Ce.useEffect(()=>{const T=a._options.shouldUnregister||c,A=(k,R)=>{const B=Wn(a._fields,k);B&&B._f&&(B._f.mount=R)};if(A(n,!0),T){const k=Ul(Wn(a._options.defaultValues,n));ho(a._defaultValues,n,k),Sa(Wn(a._formValues,n))&&ho(a._formValues,n,k)}return()=>{(d?T&&!a._state.action:T)?a.unregister(n):A(n,!1)}},[n,a,d,c]),Ce.useEffect(()=>{Wn(a._fields,n)&&a._updateDisabledField({disabled:r,fields:a._fields,name:n,value:Wn(a._fields,n)._f.value})},[r,n,a]),{field:{name:n,value:i,...Jc(r)||_.disabled?{disabled:_.disabled||r}:{},onChange:Ce.useCallback(T=>b.current.onChange({target:{value:tJ(T),name:n},type:DA.CHANGE}),[n]),onBlur:Ce.useCallback(()=>b.current.onBlur({target:{value:Wn(a._formValues,n),name:n},type:DA.BLUR}),[n,a]),ref:Ce.useCallback(T=>{const A=Wn(a._fields,n);A&&T&&(A._f.ref={focus:()=>T.focus(),select:()=>T.select(),setCustomValidity:k=>T.setCustomValidity(k),reportValidity:()=>T.reportValidity()})},[a._fields,n])},formState:_,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Wn(_.errors,n)},isDirty:{enumerable:!0,get:()=>!!Wn(_.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Wn(_.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Wn(_.validatingFields,n)},error:{enumerable:!0,get:()=>Wn(_.errors,n)}})}}const QJe=e=>e.render(swe(e));var cJ=(e,t,n,r,a)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:a||!0}}:{},h6=e=>({isOnSubmit:!e||e===Yu.onSubmit,isOnBlur:e===Yu.onBlur,isOnChange:e===Yu.onChange,isOnAll:e===Yu.all,isOnTouch:e===Yu.onTouched}),d6=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const Ob=(e,t,n,r)=>{for(const a of n||Object.keys(e)){const c=Wn(e,a);if(c){const{_f:d,...i}=c;if(d){if(d.refs&&d.refs[0]&&t(d.refs[0],a)&&!r)return!0;if(d.ref&&t(d.ref,d.name)&&!r)return!0;if(Ob(i,t))break}else if(Ba(i)&&Ob(i,t))break}}};var lwe=(e,t,n)=>{const r=Mb(Wn(e,n));return ho(r,"root",t[n]),ho(e,n,r),e},rF=e=>e.type==="file",tf=e=>typeof e=="function",LA=e=>{if(!QN)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},k2=e=>Hh(e),iF=e=>e.type==="radio",zA=e=>e instanceof RegExp;const f6={value:!1,isValid:!1},p6={value:!0,isValid:!0};var uJ=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Sa(e[0].attributes.value)?Sa(e[0].value)||e[0].value===""?p6:{value:e[0].value,isValid:!0}:p6:f6}return f6};const m6={isValid:!1,value:null};var hJ=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,m6):m6;function g6(e,t,n="validate"){if(k2(e)||Array.isArray(e)&&e.every(k2)||Jc(e)&&!e)return{type:n,message:k2(e)?e:"",ref:t}}var Xy=e=>Ba(e)&&!zA(e)?e:{value:e,message:""},_6=async(e,t,n,r,a)=>{const{ref:c,refs:d,required:i,maxLength:_,minLength:b,min:T,max:A,pattern:k,validate:R,name:B,valueAsNumber:N,mount:V,disabled:H}=e._f,G=Wn(t,B);if(!V||H)return{};const q=d?d[0]:c,Q=Le=>{r&&q.reportValidity&&(q.setCustomValidity(Jc(Le)?"":Le||""),q.reportValidity())},te={},ue=iF(c),fe=LS(c),ye=ue||fe,De=(N||rF(c))&&Sa(c.value)&&Sa(G)||LA(c)&&c.value===""||G===""||Array.isArray(G)&&!G.length,Ne=cJ.bind(null,B,n,te),Fe=(Le,Ze,He,ct=Ud.maxLength,ot=Ud.minLength)=>{const rt=Le?Ze:He;te[B]={type:Le?ct:ot,message:rt,ref:c,...Ne(Le?ct:ot,rt)}};if(a?!Array.isArray(G)||!G.length:i&&(!ye&&(De||gl(G))||Jc(G)&&!G||fe&&!uJ(d).isValid||ue&&!hJ(d).isValid)){const{value:Le,message:Ze}=k2(i)?{value:!!i,message:i}:Xy(i);if(Le&&(te[B]={type:Ud.required,message:Ze,ref:q,...Ne(Ud.required,Ze)},!n))return Q(Ze),te}if(!De&&(!gl(T)||!gl(A))){let Le,Ze;const He=Xy(A),ct=Xy(T);if(!gl(G)&&!isNaN(G)){const ot=c.valueAsNumber||G&&+G;gl(He.value)||(Le=ot>He.value),gl(ct.value)||(Ze=ot<ct.value)}else{const ot=c.valueAsDate||new Date(G),rt=at=>new Date(new Date().toDateString()+" "+at),Be=c.type=="time",nt=c.type=="week";Hh(He.value)&&G&&(Le=Be?rt(G)>rt(He.value):nt?G>He.value:ot>new Date(He.value)),Hh(ct.value)&&G&&(Ze=Be?rt(G)<rt(ct.value):nt?G<ct.value:ot<new Date(ct.value))}if((Le||Ze)&&(Fe(!!Le,He.message,ct.message,Ud.max,Ud.min),!n))return Q(te[B].message),te}if((_||b)&&!De&&(Hh(G)||a&&Array.isArray(G))){const Le=Xy(_),Ze=Xy(b),He=!gl(Le.value)&&G.length>+Le.value,ct=!gl(Ze.value)&&G.length<+Ze.value;if((He||ct)&&(Fe(He,Le.message,Ze.message),!n))return Q(te[B].message),te}if(k&&!De&&Hh(G)){const{value:Le,message:Ze}=Xy(k);if(zA(Le)&&!G.match(Le)&&(te[B]={type:Ud.pattern,message:Ze,ref:c,...Ne(Ud.pattern,Ze)},!n))return Q(Ze),te}if(R){if(tf(R)){const Le=await R(G,t),Ze=g6(Le,q);if(Ze&&(te[B]={...Ze,...Ne(Ud.validate,Ze.message)},!n))return Q(Ze.message),te}else if(Ba(R)){let Le={};for(const Ze in R){if(!Vl(Le)&&!n)break;const He=g6(await R[Ze](G,t),q,Ze);He&&(Le={...He,...Ne(Ze,He.message)},Q(He.message),n&&(te[B]=Le))}if(!Vl(Le)&&(te[B]={ref:q,...Le},!n))return te}}return Q(!0),te};function cwe(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=Sa(e)?r++:e[t[r++]];return e}function uwe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Sa(e[t]))return!1;return!0}function ss(e,t){const n=Array.isArray(t)?t:eF(t)?[t]:rJ(t),r=n.length===1?e:cwe(e,n),a=n.length-1,c=n[a];return r&&delete r[c],a!==0&&(Ba(r)&&Vl(r)||Array.isArray(r)&&uwe(r))&&ss(e,n.slice(0,-1)),e}var Uk=()=>{let e=[];return{get observers(){return e},next:a=>{for(const c of e)c.next&&c.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(c=>c!==a)}}),unsubscribe:()=>{e=[]}}},oL=e=>gl(e)||!eJ(e);function Rp(e,t){if(oL(e)||oL(t))return e===t;if($g(e)&&$g(t))return e.getTime()===t.getTime();const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const a of n){const c=e[a];if(!r.includes(a))return!1;if(a!=="ref"){const d=t[a];if($g(c)&&$g(d)||Ba(c)&&Ba(d)||Array.isArray(c)&&Array.isArray(d)?!Rp(c,d):c!==d)return!1}}return!0}var dJ=e=>e.type==="select-multiple",hwe=e=>iF(e)||LS(e),Vk=e=>LA(e)&&e.isConnected,fJ=e=>{for(const t in e)if(tf(e[t]))return!0;return!1};function NA(e,t={}){const n=Array.isArray(e);if(Ba(e)||n)for(const r in e)Array.isArray(e[r])||Ba(e[r])&&!fJ(e[r])?(t[r]=Array.isArray(e[r])?[]:{},NA(e[r],t[r])):gl(e[r])||(t[r]=!0);return t}function pJ(e,t,n){const r=Array.isArray(e);if(Ba(e)||r)for(const a in e)Array.isArray(e[a])||Ba(e[a])&&!fJ(e[a])?Sa(t)||oL(n[a])?n[a]=Array.isArray(e[a])?NA(e[a],[]):{...NA(e[a])}:pJ(e[a],gl(t)?{}:t[a],n[a]):n[a]=!Rp(e[a],t[a]);return n}var V1=(e,t)=>pJ(e,t,NA(t)),mJ=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Sa(e)?e:t?e===""?NaN:e&&+e:n&&Hh(e)?new Date(e):r?r(e):e;function Wk(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return rF(t)?t.files:iF(t)?hJ(e.refs).value:dJ(t)?[...t.selectedOptions].map(({value:n})=>n):LS(t)?uJ(e.refs).value:mJ(Sa(t.value)?e.ref.value:t.value,e)}var dwe=(e,t,n,r)=>{const a={};for(const c of e){const d=Wn(t,c);d&&ho(a,c,d._f)}return{criteriaMode:n,names:[...e],fields:a,shouldUseNativeValidation:r}},W1=e=>Sa(e)?e:zA(e)?e.source:Ba(e)?zA(e.value)?e.value.source:e.value:e;const y6="AsyncFunction";var fwe=e=>(!e||!e.validate)&&!!(tf(e.validate)&&e.validate.constructor.name===y6||Ba(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===y6)),pwe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function v6(e,t,n){const r=Wn(e,n);if(r||eF(n))return{error:r,name:n};const a=n.split(".");for(;a.length;){const c=a.join("."),d=Wn(t,c),i=Wn(e,c);if(d&&!Array.isArray(d)&&n!==c)return{name:n};if(i&&i.type)return{name:c,error:i};a.pop()}return{name:n}}var mwe=(e,t,n,r,a)=>a.isOnAll?!1:!n&&a.isOnTouch?!(t||e):(n?r.isOnBlur:a.isOnBlur)?!e:(n?r.isOnChange:a.isOnChange)?e:!0,gwe=(e,t)=>!UC(Wn(e,t)).length&&ss(e,t);const _we={mode:Yu.onSubmit,reValidateMode:Yu.onChange,shouldFocusError:!0};function ywe(e={}){let t={..._we,...e},n={submitCount:0,isDirty:!1,isLoading:tf(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},a=Ba(t.defaultValues)||Ba(t.values)?Ul(t.defaultValues||t.values)||{}:{},c=t.shouldUnregister?{}:Ul(a),d={action:!1,mount:!1,watch:!1},i={mount:new Set,unMount:new Set,array:new Set,watch:new Set},_,b=0;const T={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},A={values:Uk(),array:Uk(),state:Uk()},k=h6(t.mode),R=h6(t.reValidateMode),B=t.criteriaMode===Yu.all,N=it=>Pt=>{clearTimeout(b),b=setTimeout(it,Pt)},V=async it=>{if(!e.disabled&&(T.isValid||it)){const Pt=t.resolver?Vl((await ye()).errors):await Ne(r,!0);Pt!==n.isValid&&A.state.next({isValid:Pt})}},H=(it,Pt)=>{!e.disabled&&(T.isValidating||T.validatingFields)&&((it||Array.from(i.mount)).forEach(jt=>{jt&&(Pt?ho(n.validatingFields,jt,Pt):ss(n.validatingFields,jt))}),A.state.next({validatingFields:n.validatingFields,isValidating:!Vl(n.validatingFields)}))},G=(it,Pt=[],jt,Cn,Mn=!0,_n=!0)=>{if(Cn&&jt&&!e.disabled){if(d.action=!0,_n&&Array.isArray(Wn(r,it))){const Gn=jt(Wn(r,it),Cn.argA,Cn.argB);Mn&&ho(r,it,Gn)}if(_n&&Array.isArray(Wn(n.errors,it))){const Gn=jt(Wn(n.errors,it),Cn.argA,Cn.argB);Mn&&ho(n.errors,it,Gn),gwe(n.errors,it)}if(T.touchedFields&&_n&&Array.isArray(Wn(n.touchedFields,it))){const Gn=jt(Wn(n.touchedFields,it),Cn.argA,Cn.argB);Mn&&ho(n.touchedFields,it,Gn)}T.dirtyFields&&(n.dirtyFields=V1(a,c)),A.state.next({name:it,isDirty:Le(it,Pt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else ho(c,it,Pt)},q=(it,Pt)=>{ho(n.errors,it,Pt),A.state.next({errors:n.errors})},Q=it=>{n.errors=it,A.state.next({errors:n.errors,isValid:!1})},te=(it,Pt,jt,Cn)=>{const Mn=Wn(r,it);if(Mn){const _n=Wn(c,it,Sa(jt)?Wn(a,it):jt);Sa(_n)||Cn&&Cn.defaultChecked||Pt?ho(c,it,Pt?_n:Wk(Mn._f)):ct(it,_n),d.mount&&V()}},ue=(it,Pt,jt,Cn,Mn)=>{let _n=!1,Gn=!1;const vr={name:it};if(!e.disabled){const ni=!!(Wn(r,it)&&Wn(r,it)._f&&Wn(r,it)._f.disabled);if(!jt||Cn){T.isDirty&&(Gn=n.isDirty,n.isDirty=vr.isDirty=Le(),_n=Gn!==vr.isDirty);const vi=ni||Rp(Wn(a,it),Pt);Gn=!!(!ni&&Wn(n.dirtyFields,it)),vi||ni?ss(n.dirtyFields,it):ho(n.dirtyFields,it,!0),vr.dirtyFields=n.dirtyFields,_n=_n||T.dirtyFields&&Gn!==!vi}if(jt){const vi=Wn(n.touchedFields,it);vi||(ho(n.touchedFields,it,jt),vr.touchedFields=n.touchedFields,_n=_n||T.touchedFields&&vi!==jt)}_n&&Mn&&A.state.next(vr)}return _n?vr:{}},fe=(it,Pt,jt,Cn)=>{const Mn=Wn(n.errors,it),_n=T.isValid&&Jc(Pt)&&n.isValid!==Pt;if(e.delayError&&jt?(_=N(()=>q(it,jt)),_(e.delayError)):(clearTimeout(b),_=null,jt?ho(n.errors,it,jt):ss(n.errors,it)),(jt?!Rp(Mn,jt):Mn)||!Vl(Cn)||_n){const Gn={...Cn,..._n&&Jc(Pt)?{isValid:Pt}:{},errors:n.errors,name:it};n={...n,...Gn},A.state.next(Gn)}},ye=async it=>{H(it,!0);const Pt=await t.resolver(c,t.context,dwe(it||i.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return H(it),Pt},De=async it=>{const{errors:Pt}=await ye(it);if(it)for(const jt of it){const Cn=Wn(Pt,jt);Cn?ho(n.errors,jt,Cn):ss(n.errors,jt)}else n.errors=Pt;return Pt},Ne=async(it,Pt,jt={valid:!0})=>{for(const Cn in it){const Mn=it[Cn];if(Mn){const{_f:_n,...Gn}=Mn;if(_n){const vr=i.array.has(_n.name),ni=Mn._f&&fwe(Mn._f);ni&&T.validatingFields&&H([Cn],!0);const vi=await _6(Mn,c,B,t.shouldUseNativeValidation&&!Pt,vr);if(ni&&T.validatingFields&&H([Cn]),vi[_n.name]&&(jt.valid=!1,Pt))break;!Pt&&(Wn(vi,_n.name)?vr?lwe(n.errors,vi,_n.name):ho(n.errors,_n.name,vi[_n.name]):ss(n.errors,_n.name))}!Vl(Gn)&&await Ne(Gn,Pt,jt)}}return jt.valid},Fe=()=>{for(const it of i.unMount){const Pt=Wn(r,it);Pt&&(Pt._f.refs?Pt._f.refs.every(jt=>!Vk(jt)):!Vk(Pt._f.ref))&&sn(it)}i.unMount=new Set},Le=(it,Pt)=>!e.disabled&&(it&&Pt&&ho(c,it,Pt),!Rp(Mt(),a)),Ze=(it,Pt,jt)=>lJ(it,i,{...d.mount?c:Sa(Pt)?a:Hh(it)?{[it]:Pt}:Pt},jt,Pt),He=it=>UC(Wn(d.mount?c:a,it,e.shouldUnregister?Wn(a,it,[]):[])),ct=(it,Pt,jt={})=>{const Cn=Wn(r,it);let Mn=Pt;if(Cn){const _n=Cn._f;_n&&(!_n.disabled&&ho(c,it,mJ(Pt,_n)),Mn=LA(_n.ref)&&gl(Pt)?"":Pt,dJ(_n.ref)?[..._n.ref.options].forEach(Gn=>Gn.selected=Mn.includes(Gn.value)):_n.refs?LS(_n.ref)?_n.refs.length>1?_n.refs.forEach(Gn=>(!Gn.defaultChecked||!Gn.disabled)&&(Gn.checked=Array.isArray(Mn)?!!Mn.find(vr=>vr===Gn.value):Mn===Gn.value)):_n.refs[0]&&(_n.refs[0].checked=!!Mn):_n.refs.forEach(Gn=>Gn.checked=Gn.value===Mn):rF(_n.ref)?_n.ref.value="":(_n.ref.value=Mn,_n.ref.type||A.values.next({name:it,values:{...c}})))}(jt.shouldDirty||jt.shouldTouch)&&ue(it,Mn,jt.shouldTouch,jt.shouldDirty,!0),jt.shouldValidate&&at(it)},ot=(it,Pt,jt)=>{for(const Cn in Pt){const Mn=Pt[Cn],_n=`${it}.${Cn}`,Gn=Wn(r,_n);(i.array.has(it)||Ba(Mn)||Gn&&!Gn._f)&&!$g(Mn)?ot(_n,Mn,jt):ct(_n,Mn,jt)}},rt=(it,Pt,jt={})=>{const Cn=Wn(r,it),Mn=i.array.has(it),_n=Ul(Pt);ho(c,it,_n),Mn?(A.array.next({name:it,values:{...c}}),(T.isDirty||T.dirtyFields)&&jt.shouldDirty&&A.state.next({name:it,dirtyFields:V1(a,c),isDirty:Le(it,_n)})):Cn&&!Cn._f&&!gl(_n)?ot(it,_n,jt):ct(it,_n,jt),d6(it,i)&&A.state.next({...n}),A.values.next({name:d.mount?it:void 0,values:{...c}})},Be=async it=>{d.mount=!0;const Pt=it.target;let jt=Pt.name,Cn=!0;const Mn=Wn(r,jt),_n=()=>Pt.type?Wk(Mn._f):tJ(it),Gn=vr=>{Cn=Number.isNaN(vr)||$g(vr)&&isNaN(vr.getTime())||Rp(vr,Wn(c,jt,vr))};if(Mn){let vr,ni;const vi=_n(),na=it.type===DA.BLUR||it.type===DA.FOCUS_OUT,fa=!pwe(Mn._f)&&!t.resolver&&!Wn(n.errors,jt)&&!Mn._f.deps||mwe(na,Wn(n.touchedFields,jt),n.isSubmitted,R,k),to=d6(jt,i,na);ho(c,jt,vi),na?(Mn._f.onBlur&&Mn._f.onBlur(it),_&&_(0)):Mn._f.onChange&&Mn._f.onChange(it);const uo=ue(jt,vi,na,!1),ja=!Vl(uo)||to;if(!na&&A.values.next({name:jt,type:it.type,values:{...c}}),fa)return T.isValid&&(e.mode==="onBlur"?na&&V():V()),ja&&A.state.next({name:jt,...to?{}:uo});if(!na&&to&&A.state.next({...n}),t.resolver){const{errors:Bo}=await ye([jt]);if(Gn(vi),Cn){const fo=v6(n.errors,r,jt),$a=v6(Bo,r,fo.name||jt);vr=$a.error,jt=$a.name,ni=Vl(Bo)}}else H([jt],!0),vr=(await _6(Mn,c,B,t.shouldUseNativeValidation))[jt],H([jt]),Gn(vi),Cn&&(vr?ni=!1:T.isValid&&(ni=await Ne(r,!0)));Cn&&(Mn._f.deps&&at(Mn._f.deps),fe(jt,ni,vr,uo))}},nt=(it,Pt)=>{if(Wn(n.errors,Pt)&&it.focus)return it.focus(),1},at=async(it,Pt={})=>{let jt,Cn;const Mn=Mb(it);if(t.resolver){const _n=await De(Sa(it)?it:Mn);jt=Vl(_n),Cn=it?!Mn.some(Gn=>Wn(_n,Gn)):jt}else it?(Cn=(await Promise.all(Mn.map(async _n=>{const Gn=Wn(r,_n);return await Ne(Gn&&Gn._f?{[_n]:Gn}:Gn)}))).every(Boolean),!(!Cn&&!n.isValid)&&V()):Cn=jt=await Ne(r);return A.state.next({...!Hh(it)||T.isValid&&jt!==n.isValid?{}:{name:it},...t.resolver||!it?{isValid:jt}:{},errors:n.errors}),Pt.shouldFocus&&!Cn&&Ob(r,nt,it?Mn:i.mount),Cn},Mt=it=>{const Pt={...d.mount?c:a};return Sa(it)?Pt:Hh(it)?Wn(Pt,it):it.map(jt=>Wn(Pt,jt))},Nt=(it,Pt)=>({invalid:!!Wn((Pt||n).errors,it),isDirty:!!Wn((Pt||n).dirtyFields,it),error:Wn((Pt||n).errors,it),isValidating:!!Wn(n.validatingFields,it),isTouched:!!Wn((Pt||n).touchedFields,it)}),rn=it=>{it&&Mb(it).forEach(Pt=>ss(n.errors,Pt)),A.state.next({errors:it?n.errors:{}})},un=(it,Pt,jt)=>{const Cn=(Wn(r,it,{_f:{}})._f||{}).ref,Mn=Wn(n.errors,it)||{},{ref:_n,message:Gn,type:vr,...ni}=Mn;ho(n.errors,it,{...ni,...Pt,ref:Cn}),A.state.next({name:it,errors:n.errors,isValid:!1}),jt&&jt.shouldFocus&&Cn&&Cn.focus&&Cn.focus()},en=(it,Pt)=>tf(it)?A.values.subscribe({next:jt=>it(Ze(void 0,Pt),jt)}):Ze(it,Pt,!0),sn=(it,Pt={})=>{for(const jt of it?Mb(it):i.mount)i.mount.delete(jt),i.array.delete(jt),Pt.keepValue||(ss(r,jt),ss(c,jt)),!Pt.keepError&&ss(n.errors,jt),!Pt.keepDirty&&ss(n.dirtyFields,jt),!Pt.keepTouched&&ss(n.touchedFields,jt),!Pt.keepIsValidating&&ss(n.validatingFields,jt),!t.shouldUnregister&&!Pt.keepDefaultValue&&ss(a,jt);A.values.next({values:{...c}}),A.state.next({...n,...Pt.keepDirty?{isDirty:Le()}:{}}),!Pt.keepIsValid&&V()},Vt=({disabled:it,name:Pt,field:jt,fields:Cn,value:Mn})=>{if(Jc(it)&&d.mount||it){const _n=it?void 0:Sa(Mn)?Wk(jt?jt._f:Wn(Cn,Pt)._f):Mn;ho(c,Pt,_n),ue(Pt,_n,!1,!1,!0)}},$n=(it,Pt={})=>{let jt=Wn(r,it);const Cn=Jc(Pt.disabled)||Jc(e.disabled);return ho(r,it,{...jt||{},_f:{...jt&&jt._f?jt._f:{ref:{name:it}},name:it,mount:!0,...Pt}}),i.mount.add(it),jt?Vt({field:jt,disabled:Jc(Pt.disabled)?Pt.disabled:e.disabled,name:it,value:Pt.value}):te(it,!0,Pt.value),{...Cn?{disabled:Pt.disabled||e.disabled}:{},...t.progressive?{required:!!Pt.required,min:W1(Pt.min),max:W1(Pt.max),minLength:W1(Pt.minLength),maxLength:W1(Pt.maxLength),pattern:W1(Pt.pattern)}:{},name:it,onChange:Be,onBlur:Be,ref:Mn=>{if(Mn){$n(it,Pt),jt=Wn(r,it);const _n=Sa(Mn.value)&&Mn.querySelectorAll&&Mn.querySelectorAll("input,select,textarea")[0]||Mn,Gn=hwe(_n),vr=jt._f.refs||[];if(Gn?vr.find(ni=>ni===_n):_n===jt._f.ref)return;ho(r,it,{_f:{...jt._f,...Gn?{refs:[...vr.filter(Vk),_n,...Array.isArray(Wn(a,it))?[{}]:[]],ref:{type:_n.type,name:it}}:{ref:_n}}}),te(it,!1,void 0,_n)}else jt=Wn(r,it,{}),jt._f&&(jt._f.mount=!1),(t.shouldUnregister||Pt.shouldUnregister)&&!(nJ(i.array,it)&&d.action)&&i.unMount.add(it)}}},Gt=()=>t.shouldFocusError&&Ob(r,nt,i.mount),Tn=it=>{Jc(it)&&(A.state.next({disabled:it}),Ob(r,(Pt,jt)=>{const Cn=Wn(r,jt);Cn&&(Pt.disabled=Cn._f.disabled||it,Array.isArray(Cn._f.refs)&&Cn._f.refs.forEach(Mn=>{Mn.disabled=Cn._f.disabled||it}))},0,!1))},hn=(it,Pt)=>async jt=>{let Cn;jt&&(jt.preventDefault&&jt.preventDefault(),jt.persist&&jt.persist());let Mn=Ul(c);if(A.state.next({isSubmitting:!0}),t.resolver){const{errors:_n,values:Gn}=await ye();n.errors=_n,Mn=Gn}else await Ne(r);if(ss(n.errors,"root"),Vl(n.errors)){A.state.next({errors:{}});try{await it(Mn,jt)}catch(_n){Cn=_n}}else Pt&&await Pt({...n.errors},jt),Gt(),setTimeout(Gt);if(A.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Vl(n.errors)&&!Cn,submitCount:n.submitCount+1,errors:n.errors}),Cn)throw Cn},yt=(it,Pt={})=>{Wn(r,it)&&(Sa(Pt.defaultValue)?rt(it,Ul(Wn(a,it))):(rt(it,Pt.defaultValue),ho(a,it,Ul(Pt.defaultValue))),Pt.keepTouched||ss(n.touchedFields,it),Pt.keepDirty||(ss(n.dirtyFields,it),n.isDirty=Pt.defaultValue?Le(it,Ul(Wn(a,it))):Le()),Pt.keepError||(ss(n.errors,it),T.isValid&&V()),A.state.next({...n}))},In=(it,Pt={})=>{const jt=it?Ul(it):a,Cn=Ul(jt),Mn=Vl(it),_n=Mn?a:Cn;if(Pt.keepDefaultValues||(a=jt),!Pt.keepValues){if(Pt.keepDirtyValues){const Gn=new Set([...i.mount,...Object.keys(V1(a,c))]);for(const vr of Array.from(Gn))Wn(n.dirtyFields,vr)?ho(_n,vr,Wn(c,vr)):rt(vr,Wn(_n,vr))}else{if(QN&&Sa(it))for(const Gn of i.mount){const vr=Wn(r,Gn);if(vr&&vr._f){const ni=Array.isArray(vr._f.refs)?vr._f.refs[0]:vr._f.ref;if(LA(ni)){const vi=ni.closest("form");if(vi){vi.reset();break}}}}r={}}c=e.shouldUnregister?Pt.keepDefaultValues?Ul(a):{}:Ul(_n),A.array.next({values:{..._n}}),A.values.next({values:{..._n}})}i={mount:Pt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},d.mount=!T.isValid||!!Pt.keepIsValid||!!Pt.keepDirtyValues,d.watch=!!e.shouldUnregister,A.state.next({submitCount:Pt.keepSubmitCount?n.submitCount:0,isDirty:Mn?!1:Pt.keepDirty?n.isDirty:!!(Pt.keepDefaultValues&&!Rp(it,a)),isSubmitted:Pt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Mn?{}:Pt.keepDirtyValues?Pt.keepDefaultValues&&c?V1(a,c):n.dirtyFields:Pt.keepDefaultValues&&it?V1(a,it):Pt.keepDirty?n.dirtyFields:{},touchedFields:Pt.keepTouched?n.touchedFields:{},errors:Pt.keepErrors?n.errors:{},isSubmitSuccessful:Pt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},Kn=(it,Pt)=>In(tf(it)?it(c):it,Pt);return{control:{register:$n,unregister:sn,getFieldState:Nt,handleSubmit:hn,setError:un,_executeSchema:ye,_getWatch:Ze,_getDirty:Le,_updateValid:V,_removeUnmounted:Fe,_updateFieldArray:G,_updateDisabledField:Vt,_getFieldArray:He,_reset:In,_resetDefaultValues:()=>tf(t.defaultValues)&&t.defaultValues().then(it=>{Kn(it,t.resetOptions),A.state.next({isLoading:!1})}),_updateFormState:it=>{n={...n,...it}},_disableForm:Tn,_subjects:A,_proxyFormState:T,_setErrors:Q,get _fields(){return r},get _formValues(){return c},get _state(){return d},set _state(it){d=it},get _defaultValues(){return a},get _names(){return i},set _names(it){i=it},get _formState(){return n},set _formState(it){n=it},get _options(){return t},set _options(it){t={...t,...it}}},trigger:at,register:$n,handleSubmit:hn,watch:en,setValue:rt,getValues:Mt,reset:Kn,resetField:yt,clearErrors:rn,unregister:sn,setError:un,setFocus:(it,Pt={})=>{const jt=Wn(r,it),Cn=jt&&jt._f;if(Cn){const Mn=Cn.refs?Cn.refs[0]:Cn.ref;Mn.focus&&(Mn.focus(),Pt.shouldSelect&&Mn.select())}},getFieldState:Nt}}function eQe(e={}){const t=Ce.useRef(),n=Ce.useRef(),[r,a]=Ce.useState({isDirty:!1,isValidating:!1,isLoading:tf(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:tf(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...ywe(e),formState:r});const c=t.current.control;return c._options=e,nF({subject:c._subjects.state,next:d=>{aJ(d,c._proxyFormState,c._updateFormState,!0)&&a({...c._formState})}}),Ce.useEffect(()=>c._disableForm(e.disabled),[c,e.disabled]),Ce.useEffect(()=>{if(c._proxyFormState.isDirty){const d=c._getDirty();d!==r.isDirty&&c._subjects.state.next({isDirty:d})}},[c,r.isDirty]),Ce.useEffect(()=>{e.values&&!Rp(e.values,n.current)?(c._reset(e.values,c._options.resetOptions),n.current=e.values,a(d=>({...d}))):c._resetDefaultValues()},[e.values,c]),Ce.useEffect(()=>{e.errors&&c._setErrors(e.errors)},[e.errors,c]),Ce.useEffect(()=>{c._state.mount||(c._updateValid(),c._state.mount=!0),c._state.watch&&(c._state.watch=!1,c._subjects.state.next({...c._formState})),c._removeUnmounted()}),Ce.useEffect(()=>{e.shouldUnregister&&c._subjects.values.next({values:c._getWatch()})},[e.shouldUnregister,c]),Ce.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[r]),t.current.formState=oJ(r,c),t.current}const x6=(e,t,n)=>{if(e&&"reportValidity"in e){const r=Wn(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},gJ=(e,t)=>{for(const n in t.fields){const r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?x6(r.ref,n,e):r.refs&&r.refs.forEach(a=>x6(a,n,e))}},vwe=(e,t)=>{t.shouldUseNativeValidation&&gJ(e,t);const n={};for(const r in e){const a=Wn(t.fields,r),c=Object.assign(e[r]||{},{ref:a&&a.ref});if(xwe(t.names||Object.keys(e),r)){const d=Object.assign({},Wn(n,r));ho(d,"root",c),ho(n,r,d)}else ho(n,r,c)}return n},xwe=(e,t)=>e.some(n=>n.startsWith(t+"."));var bwe=function(e,t){for(var n={};e.length;){var r=e[0],a=r.code,c=r.message,d=r.path.join(".");if(!n[d])if("unionErrors"in r){var i=r.unionErrors[0].errors[0];n[d]={message:i.message,type:i.code}}else n[d]={message:c,type:a};if("unionErrors"in r&&r.unionErrors.forEach(function(T){return T.errors.forEach(function(A){return e.push(A)})}),t){var _=n[d].types,b=_&&_[r.code];n[d]=cJ(d,t,n,a,b?[].concat(b,r.message):r.message)}e.shift()}return n},tQe=function(e,t,n){return n===void 0&&(n={}),function(r,a,c){try{return Promise.resolve(function(d,i){try{var _=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(b){return c.shouldUseNativeValidation&&gJ({},c),{errors:{},values:n.raw?r:b}})}catch(b){return i(b)}return _&&_.then?_.then(void 0,i):_}(0,function(d){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(d))return{values:{},errors:vwe(bwe(d.errors,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw d}))}catch(d){return Promise.reject(d)}}},oF="Checkbox",[wwe,nQe]=Al(oF),[Swe,Twe]=wwe(oF),_J=X.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:c,required:d,disabled:i,value:_="on",onCheckedChange:b,form:T,...A}=e,[k,R]=X.useState(null),B=Xr(t,Q=>R(Q)),N=X.useRef(!1),V=k?T||!!k.closest("form"):!0,[H=!1,G]=Sl({prop:a,defaultProp:c,onChange:b}),q=X.useRef(H);return X.useEffect(()=>{const Q=k==null?void 0:k.form;if(Q){const te=()=>G(q.current);return Q.addEventListener("reset",te),()=>Q.removeEventListener("reset",te)}},[k,G]),_e.jsxs(Swe,{scope:n,state:H,disabled:i,children:[_e.jsx(Qn.button,{type:"button",role:"checkbox","aria-checked":Yp(H)?"mixed":H,"aria-required":d,"data-state":xJ(H),"data-disabled":i?"":void 0,disabled:i,value:_,...A,ref:B,onKeyDown:On(e.onKeyDown,Q=>{Q.key==="Enter"&&Q.preventDefault()}),onClick:On(e.onClick,Q=>{G(te=>Yp(te)?!0:!te),V&&(N.current=Q.isPropagationStopped(),N.current||Q.stopPropagation())})}),V&&_e.jsx(Ewe,{control:k,bubbles:!N.current,name:r,value:_,checked:H,required:d,disabled:i,form:T,style:{transform:"translateX(-100%)"},defaultChecked:Yp(c)?!1:c})]})});_J.displayName=oF;var yJ="CheckboxIndicator",vJ=X.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,c=Twe(yJ,n);return _e.jsx(Aa,{present:r||Yp(c.state)||c.state===!0,children:_e.jsx(Qn.span,{"data-state":xJ(c.state),"data-disabled":c.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});vJ.displayName=yJ;var Ewe=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...c}=e,d=X.useRef(null),i=kC(n),_=sN(t);X.useEffect(()=>{const T=d.current,A=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(A,"checked").set;if(i!==n&&R){const B=new Event("click",{bubbles:r});T.indeterminate=Yp(n),R.call(T,Yp(n)?!1:n),T.dispatchEvent(B)}},[i,n,r]);const b=X.useRef(Yp(n)?!1:n);return _e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??b.current,...c,tabIndex:-1,ref:d,style:{...e.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Yp(e){return e==="indeterminate"}function xJ(e){return Yp(e)?"indeterminate":e?"checked":"unchecked"}var rQe=_J,iQe=vJ,Awe=Array.isArray,nc=Awe,Pwe=typeof ws=="object"&&ws&&ws.Object===Object&&ws,bJ=Pwe,Cwe=bJ,Iwe=typeof self=="object"&&self&&self.Object===Object&&self,Mwe=Cwe||Iwe||Function("return this")(),sd=Mwe,Owe=sd,kwe=Owe.Symbol,zS=kwe,b6=zS,wJ=Object.prototype,Rwe=wJ.hasOwnProperty,Dwe=wJ.toString,G1=b6?b6.toStringTag:void 0;function Lwe(e){var t=Rwe.call(e,G1),n=e[G1];try{e[G1]=void 0;var r=!0}catch{}var a=Dwe.call(e);return r&&(t?e[G1]=n:delete e[G1]),a}var zwe=Lwe,Nwe=Object.prototype,Fwe=Nwe.toString;function Bwe(e){return Fwe.call(e)}var jwe=Bwe,w6=zS,$we=zwe,Uwe=jwe,Vwe="[object Null]",Wwe="[object Undefined]",S6=w6?w6.toStringTag:void 0;function Gwe(e){return e==null?e===void 0?Wwe:Vwe:S6&&S6 in Object(e)?$we(e):Uwe(e)}var wf=Gwe;function Hwe(e){return e!=null&&typeof e=="object"}var Sf=Hwe,qwe=wf,Zwe=Sf,Xwe="[object Symbol]";function Kwe(e){return typeof e=="symbol"||Zwe(e)&&qwe(e)==Xwe}var q0=Kwe,Ywe=nc,Jwe=q0,Qwe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eSe=/^\w*$/;function tSe(e,t){if(Ywe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Jwe(e)?!0:eSe.test(e)||!Qwe.test(e)||t!=null&&e in Object(t)}var aF=tSe;function nSe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Tm=nSe;const Z0=lo(Tm);var rSe=wf,iSe=Tm,oSe="[object AsyncFunction]",aSe="[object Function]",sSe="[object GeneratorFunction]",lSe="[object Proxy]";function cSe(e){if(!iSe(e))return!1;var t=rSe(e);return t==aSe||t==sSe||t==oSe||t==lSe}var sF=cSe;const $r=lo(sF);var uSe=sd,hSe=uSe["__core-js_shared__"],dSe=hSe,Gk=dSe,T6=function(){var e=/[^.]+$/.exec(Gk&&Gk.keys&&Gk.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fSe(e){return!!T6&&T6 in e}var pSe=fSe,mSe=Function.prototype,gSe=mSe.toString;function _Se(e){if(e!=null){try{return gSe.call(e)}catch{}try{return e+""}catch{}}return""}var SJ=_Se,ySe=sF,vSe=pSe,xSe=Tm,bSe=SJ,wSe=/[\\^$.*+?()[\]{}|]/g,SSe=/^\[object .+?Constructor\]$/,TSe=Function.prototype,ESe=Object.prototype,ASe=TSe.toString,PSe=ESe.hasOwnProperty,CSe=RegExp("^"+ASe.call(PSe).replace(wSe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ISe(e){if(!xSe(e)||vSe(e))return!1;var t=ySe(e)?CSe:SSe;return t.test(bSe(e))}var MSe=ISe;function OSe(e,t){return e==null?void 0:e[t]}var kSe=OSe,RSe=MSe,DSe=kSe;function LSe(e,t){var n=DSe(e,t);return RSe(n)?n:void 0}var I_=LSe,zSe=I_,NSe=zSe(Object,"create"),VC=NSe,E6=VC;function FSe(){this.__data__=E6?E6(null):{},this.size=0}var BSe=FSe;function jSe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var $Se=jSe,USe=VC,VSe="__lodash_hash_undefined__",WSe=Object.prototype,GSe=WSe.hasOwnProperty;function HSe(e){var t=this.__data__;if(USe){var n=t[e];return n===VSe?void 0:n}return GSe.call(t,e)?t[e]:void 0}var qSe=HSe,ZSe=VC,XSe=Object.prototype,KSe=XSe.hasOwnProperty;function YSe(e){var t=this.__data__;return ZSe?t[e]!==void 0:KSe.call(t,e)}var JSe=YSe,QSe=VC,eTe="__lodash_hash_undefined__";function tTe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=QSe&&t===void 0?eTe:t,this}var nTe=tTe,rTe=BSe,iTe=$Se,oTe=qSe,aTe=JSe,sTe=nTe;function X0(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}X0.prototype.clear=rTe;X0.prototype.delete=iTe;X0.prototype.get=oTe;X0.prototype.has=aTe;X0.prototype.set=sTe;var lTe=X0;function cTe(){this.__data__=[],this.size=0}var uTe=cTe;function hTe(e,t){return e===t||e!==e&&t!==t}var lF=hTe,dTe=lF;function fTe(e,t){for(var n=e.length;n--;)if(dTe(e[n][0],t))return n;return-1}var WC=fTe,pTe=WC,mTe=Array.prototype,gTe=mTe.splice;function _Te(e){var t=this.__data__,n=pTe(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():gTe.call(t,n,1),--this.size,!0}var yTe=_Te,vTe=WC;function xTe(e){var t=this.__data__,n=vTe(t,e);return n<0?void 0:t[n][1]}var bTe=xTe,wTe=WC;function STe(e){return wTe(this.__data__,e)>-1}var TTe=STe,ETe=WC;function ATe(e,t){var n=this.__data__,r=ETe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var PTe=ATe,CTe=uTe,ITe=yTe,MTe=bTe,OTe=TTe,kTe=PTe;function K0(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}K0.prototype.clear=CTe;K0.prototype.delete=ITe;K0.prototype.get=MTe;K0.prototype.has=OTe;K0.prototype.set=kTe;var GC=K0,RTe=I_,DTe=sd,LTe=RTe(DTe,"Map"),cF=LTe,A6=lTe,zTe=GC,NTe=cF;function FTe(){this.size=0,this.__data__={hash:new A6,map:new(NTe||zTe),string:new A6}}var BTe=FTe;function jTe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var $Te=jTe,UTe=$Te;function VTe(e,t){var n=e.__data__;return UTe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var HC=VTe,WTe=HC;function GTe(e){var t=WTe(this,e).delete(e);return this.size-=t?1:0,t}var HTe=GTe,qTe=HC;function ZTe(e){return qTe(this,e).get(e)}var XTe=ZTe,KTe=HC;function YTe(e){return KTe(this,e).has(e)}var JTe=YTe,QTe=HC;function eEe(e,t){var n=QTe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var tEe=eEe,nEe=BTe,rEe=HTe,iEe=XTe,oEe=JTe,aEe=tEe;function Y0(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Y0.prototype.clear=nEe;Y0.prototype.delete=rEe;Y0.prototype.get=iEe;Y0.prototype.has=oEe;Y0.prototype.set=aEe;var uF=Y0,TJ=uF,sEe="Expected a function";function hF(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(sEe);var n=function(){var r=arguments,a=t?t.apply(this,r):r[0],c=n.cache;if(c.has(a))return c.get(a);var d=e.apply(this,r);return n.cache=c.set(a,d)||c,d};return n.cache=new(hF.Cache||TJ),n}hF.Cache=TJ;var EJ=hF;const lEe=lo(EJ);var cEe=EJ,uEe=500;function hEe(e){var t=cEe(e,function(r){return n.size===uEe&&n.clear(),r}),n=t.cache;return t}var dEe=hEe,fEe=dEe,pEe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mEe=/\\(\\)?/g,gEe=fEe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(pEe,function(n,r,a,c){t.push(a?c.replace(mEe,"$1"):r||n)}),t}),_Ee=gEe;function yEe(e,t){for(var n=-1,r=e==null?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}var dF=yEe,P6=zS,vEe=dF,xEe=nc,bEe=q0,wEe=1/0,C6=P6?P6.prototype:void 0,I6=C6?C6.toString:void 0;function AJ(e){if(typeof e=="string")return e;if(xEe(e))return vEe(e,AJ)+"";if(bEe(e))return I6?I6.call(e):"";var t=e+"";return t=="0"&&1/e==-wEe?"-0":t}var SEe=AJ,TEe=SEe;function EEe(e){return e==null?"":TEe(e)}var PJ=EEe,AEe=nc,PEe=aF,CEe=_Ee,IEe=PJ;function MEe(e,t){return AEe(e)?e:PEe(e,t)?[e]:CEe(IEe(e))}var CJ=MEe,OEe=q0,kEe=1/0;function REe(e){if(typeof e=="string"||OEe(e))return e;var t=e+"";return t=="0"&&1/e==-kEe?"-0":t}var qC=REe,DEe=CJ,LEe=qC;function zEe(e,t){t=DEe(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[LEe(t[n++])];return n&&n==r?e:void 0}var fF=zEe,NEe=fF;function FEe(e,t,n){var r=e==null?void 0:NEe(e,t);return r===void 0?n:r}var IJ=FEe;const Rc=lo(IJ);function BEe(e){return e==null}var jEe=BEe;const Nr=lo(jEe);var $Ee=wf,UEe=nc,VEe=Sf,WEe="[object String]";function GEe(e){return typeof e=="string"||!UEe(e)&&VEe(e)&&$Ee(e)==WEe}var HEe=GEe;const NS=lo(HEe);var MJ={exports:{}},yo={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pF=Symbol.for("react.element"),mF=Symbol.for("react.portal"),ZC=Symbol.for("react.fragment"),XC=Symbol.for("react.strict_mode"),KC=Symbol.for("react.profiler"),YC=Symbol.for("react.provider"),JC=Symbol.for("react.context"),qEe=Symbol.for("react.server_context"),QC=Symbol.for("react.forward_ref"),eI=Symbol.for("react.suspense"),tI=Symbol.for("react.suspense_list"),nI=Symbol.for("react.memo"),rI=Symbol.for("react.lazy"),ZEe=Symbol.for("react.offscreen"),OJ;OJ=Symbol.for("react.module.reference");function fu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case pF:switch(e=e.type,e){case ZC:case KC:case XC:case eI:case tI:return e;default:switch(e=e&&e.$$typeof,e){case qEe:case JC:case QC:case rI:case nI:case YC:return e;default:return t}}case mF:return t}}}yo.ContextConsumer=JC;yo.ContextProvider=YC;yo.Element=pF;yo.ForwardRef=QC;yo.Fragment=ZC;yo.Lazy=rI;yo.Memo=nI;yo.Portal=mF;yo.Profiler=KC;yo.StrictMode=XC;yo.Suspense=eI;yo.SuspenseList=tI;yo.isAsyncMode=function(){return!1};yo.isConcurrentMode=function(){return!1};yo.isContextConsumer=function(e){return fu(e)===JC};yo.isContextProvider=function(e){return fu(e)===YC};yo.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===pF};yo.isForwardRef=function(e){return fu(e)===QC};yo.isFragment=function(e){return fu(e)===ZC};yo.isLazy=function(e){return fu(e)===rI};yo.isMemo=function(e){return fu(e)===nI};yo.isPortal=function(e){return fu(e)===mF};yo.isProfiler=function(e){return fu(e)===KC};yo.isStrictMode=function(e){return fu(e)===XC};yo.isSuspense=function(e){return fu(e)===eI};yo.isSuspenseList=function(e){return fu(e)===tI};yo.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===ZC||e===KC||e===XC||e===eI||e===tI||e===ZEe||typeof e=="object"&&e!==null&&(e.$$typeof===rI||e.$$typeof===nI||e.$$typeof===YC||e.$$typeof===JC||e.$$typeof===QC||e.$$typeof===OJ||e.getModuleId!==void 0)};yo.typeOf=fu;MJ.exports=yo;var kJ=MJ.exports,XEe=wf,KEe=Sf,YEe="[object Number]";function JEe(e){return typeof e=="number"||KEe(e)&&XEe(e)==YEe}var RJ=JEe;const QEe=lo(RJ);var e2e=RJ;function t2e(e){return e2e(e)&&e!=+e}var n2e=t2e;const J0=lo(n2e);var _l=function(t){return t===0?0:t>0?1:-1},Ug=function(t){return NS(t)&&t.indexOf("%")===t.length-1},zn=function(t){return QEe(t)&&!J0(t)},us=function(t){return zn(t)||NS(t)},r2e=0,Em=function(t){var n=++r2e;return"".concat(t||"").concat(n)},yl=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!zn(t)&&!NS(t))return r;var c;if(Ug(t)){var d=t.indexOf("%");c=n*parseFloat(t.slice(0,d))/100}else c=+t;return J0(c)&&(c=r),a&&c>n&&(c=n),c},Dp=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},i2e=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,r={},a=0;a<n;a++)if(!r[t[a]])r[t[a]]=!0;else return!0;return!1},ca=function(t,n){return zn(t)&&zn(n)?function(r){return t+r*(n-t)}:function(){return n}};function FA(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Rc(r,t))===n})}var o2e=function(t){if(!t||!t.length)return null;for(var n=t.length,r=0,a=0,c=0,d=0,i=1/0,_=-1/0,b=0,T=0,A=0;A<n;A++)b=t[A].cx||0,T=t[A].cy||0,r+=b,a+=T,c+=b*T,d+=b*b,i=Math.min(i,b),_=Math.max(_,b);var k=n*d!==r*r?(n*c-r*a)/(n*d-r*r):0;return{xmin:i,xmax:_,a:k,b:(a-k*r)/n}};function Mv(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function aL(e){"@babel/helpers - typeof";return aL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aL(e)}var a2e=["viewBox","children"],s2e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],M6=["points","pathLength"],Hk={svg:a2e,polygon:M6,polyline:M6},gF=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],BA=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(X.isValidElement(t)&&(r=t.props),!Z0(r))return null;var a={};return Object.keys(r).forEach(function(c){gF.includes(c)&&(a[c]=n||function(d){return r[c](r,d)})}),a},l2e=function(t,n,r){return function(a){return t(n,r,a),null}},dm=function(t,n,r){if(!Z0(t)||aL(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(c){var d=t[c];gF.includes(c)&&typeof d=="function"&&(a||(a={}),a[c]=l2e(d,n,r))}),a},c2e=["children"],u2e=["children"];function O6(e,t){if(e==null)return{};var n=h2e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function h2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function sL(e){"@babel/helpers - typeof";return sL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sL(e)}var k6={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},sf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},R6=null,qk=null,_F=function e(t){if(t===R6&&Array.isArray(qk))return qk;var n=[];return X.Children.forEach(t,function(r){Nr(r)||(kJ.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),qk=n,R6=t,n};function bl(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return sf(a)}):r=[sf(t)],_F(e).forEach(function(a){var c=Rc(a,"type.displayName")||Rc(a,"type.name");r.indexOf(c)!==-1&&n.push(a)}),n}function Ac(e,t){var n=bl(e,t);return n&&n[0]}var D6=function(t){if(!t||!t.props)return!1;var n=t.props,r=n.width,a=n.height;return!(!zn(r)||r<=0||!zn(a)||a<=0)},d2e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],f2e=function(t){return t&&t.type&&NS(t.type)&&d2e.indexOf(t.type)>=0},DJ=function(t){return t&&sL(t)==="object"&&"clipDot"in t},p2e=function(t,n,r,a){var c,d=(c=Hk==null?void 0:Hk[a])!==null&&c!==void 0?c:[];return!$r(t)&&(a&&d.includes(n)||s2e.includes(n))||r&&gF.includes(n)},wr=function(t,n,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(X.isValidElement(t)&&(a=t.props),!Z0(a))return null;var c={};return Object.keys(a).forEach(function(d){var i;p2e((i=a)===null||i===void 0?void 0:i[d],d,n,r)&&(c[d]=a[d])}),c},lL=function e(t,n){if(t===n)return!0;var r=X.Children.count(t);if(r!==X.Children.count(n))return!1;if(r===0)return!0;if(r===1)return L6(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var c=t[a],d=n[a];if(Array.isArray(c)||Array.isArray(d)){if(!e(c,d))return!1}else if(!L6(c,d))return!1}return!0},L6=function(t,n){if(Nr(t)&&Nr(n))return!0;if(!Nr(t)&&!Nr(n)){var r=t.props||{},a=r.children,c=O6(r,c2e),d=n.props||{},i=d.children,_=O6(d,u2e);return a&&i?Mv(c,_)&&lL(a,i):!a&&!i?Mv(c,_):!1}return!1},z6=function(t,n){var r=[],a={};return _F(t).forEach(function(c,d){if(f2e(c))r.push(c);else if(c){var i=sf(c.type),_=n[i]||{},b=_.handler,T=_.once;if(b&&(!T||!a[i])){var A=b(c,i,d);r.push(A),a[i]=!0}}}),r},m2e=function(t){var n=t&&t.type;return n&&k6[n]?k6[n]:null},g2e=function(t,n){return _F(n).indexOf(t)},_2e=["children","width","height","viewBox","className","style","title","desc"];function cL(){return cL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cL.apply(this,arguments)}function y2e(e,t){if(e==null)return{};var n=v2e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function v2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function uL(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,c=e.className,d=e.style,i=e.title,_=e.desc,b=y2e(e,_2e),T=a||{width:n,height:r,x:0,y:0},A=li("recharts-surface",c);return Ce.createElement("svg",cL({},wr(b,!0,"svg"),{className:A,width:n,height:r,style:d,viewBox:"".concat(T.x," ").concat(T.y," ").concat(T.width," ").concat(T.height)}),Ce.createElement("title",null,i),Ce.createElement("desc",null,_),t)}var x2e=["children","className"];function hL(){return hL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hL.apply(this,arguments)}function b2e(e,t){if(e==null)return{};var n=w2e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var _i=Ce.forwardRef(function(e,t){var n=e.children,r=e.className,a=b2e(e,x2e),c=li("recharts-layer",r);return Ce.createElement("g",hL({className:c},wr(a,!0),{ref:t}),n)}),rh=function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),c=2;c<r;c++)a[c-2]=arguments[c]};function S2e(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),n=n>a?a:n,n<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var c=Array(a);++r<a;)c[r]=e[r+t];return c}var T2e=S2e,E2e=T2e;function A2e(e,t,n){var r=e.length;return n=n===void 0?r:n,!t&&n>=r?e:E2e(e,t,n)}var P2e=A2e,C2e="\\ud800-\\udfff",I2e="\\u0300-\\u036f",M2e="\\ufe20-\\ufe2f",O2e="\\u20d0-\\u20ff",k2e=I2e+M2e+O2e,R2e="\\ufe0e\\ufe0f",D2e="\\u200d",L2e=RegExp("["+D2e+C2e+k2e+R2e+"]");function z2e(e){return L2e.test(e)}var LJ=z2e;function N2e(e){return e.split("")}var F2e=N2e,zJ="\\ud800-\\udfff",B2e="\\u0300-\\u036f",j2e="\\ufe20-\\ufe2f",$2e="\\u20d0-\\u20ff",U2e=B2e+j2e+$2e,V2e="\\ufe0e\\ufe0f",W2e="["+zJ+"]",dL="["+U2e+"]",fL="\\ud83c[\\udffb-\\udfff]",G2e="(?:"+dL+"|"+fL+")",NJ="[^"+zJ+"]",FJ="(?:\\ud83c[\\udde6-\\uddff]){2}",BJ="[\\ud800-\\udbff][\\udc00-\\udfff]",H2e="\\u200d",jJ=G2e+"?",$J="["+V2e+"]?",q2e="(?:"+H2e+"(?:"+[NJ,FJ,BJ].join("|")+")"+$J+jJ+")*",Z2e=$J+jJ+q2e,X2e="(?:"+[NJ+dL+"?",dL,FJ,BJ,W2e].join("|")+")",K2e=RegExp(fL+"(?="+fL+")|"+X2e+Z2e,"g");function Y2e(e){return e.match(K2e)||[]}var J2e=Y2e,Q2e=F2e,eAe=LJ,tAe=J2e;function nAe(e){return eAe(e)?tAe(e):Q2e(e)}var rAe=nAe,iAe=P2e,oAe=LJ,aAe=rAe,sAe=PJ;function lAe(e){return function(t){t=sAe(t);var n=oAe(t)?aAe(t):void 0,r=n?n[0]:t.charAt(0),a=n?iAe(n,1).join(""):t.slice(1);return r[e]()+a}}var cAe=lAe,uAe=cAe,hAe=uAe("toUpperCase"),dAe=hAe;const iI=lo(dAe);function Ti(e){return function(){return e}}const N6=Math.abs,Zs=Math.atan2,Xd=Math.cos,fAe=Math.max,Zk=Math.min,Wl=Math.sin,Bs=Math.sqrt,$l=1e-12,fm=Math.PI,jA=fm/2,Jp=2*fm;function pAe(e){return e>1?0:e<-1?fm:Math.acos(e)}function F6(e){return e>=1?jA:e<=-1?-jA:Math.asin(e)}const pL=Math.PI,mL=2*pL,Rg=1e-6,mAe=mL-Rg;function UJ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function gAe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return UJ;const n=10**t;return function(r){this._+=r[0];for(let a=1,c=r.length;a<c;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class _Ae{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?UJ:gAe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,c,d){this._append`C${+t},${+n},${+r},${+a},${this._x1=+c},${this._y1=+d}`}arcTo(t,n,r,a,c){if(t=+t,n=+n,r=+r,a=+a,c=+c,c<0)throw new Error(`negative radius: ${c}`);let d=this._x1,i=this._y1,_=r-t,b=a-n,T=d-t,A=i-n,k=T*T+A*A;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(k>Rg)if(!(Math.abs(A*_-b*T)>Rg)||!c)this._append`L${this._x1=t},${this._y1=n}`;else{let R=r-d,B=a-i,N=_*_+b*b,V=R*R+B*B,H=Math.sqrt(N),G=Math.sqrt(k),q=c*Math.tan((pL-Math.acos((N+k-V)/(2*H*G)))/2),Q=q/G,te=q/H;Math.abs(Q-1)>Rg&&this._append`L${t+Q*T},${n+Q*A}`,this._append`A${c},${c},0,0,${+(A*R>T*B)},${this._x1=t+te*_},${this._y1=n+te*b}`}}arc(t,n,r,a,c,d){if(t=+t,n=+n,r=+r,d=!!d,r<0)throw new Error(`negative radius: ${r}`);let i=r*Math.cos(a),_=r*Math.sin(a),b=t+i,T=n+_,A=1^d,k=d?a-c:c-a;this._x1===null?this._append`M${b},${T}`:(Math.abs(this._x1-b)>Rg||Math.abs(this._y1-T)>Rg)&&this._append`L${b},${T}`,r&&(k<0&&(k=k%mL+mL),k>mAe?this._append`A${r},${r},0,1,${A},${t-i},${n-_}A${r},${r},0,1,${A},${this._x1=b},${this._y1=T}`:k>Rg&&this._append`A${r},${r},0,${+(k>=pL)},${A},${this._x1=t+r*Math.cos(c)},${this._y1=n+r*Math.sin(c)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function oI(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new _Ae(t)}function yAe(e){return e.innerRadius}function vAe(e){return e.outerRadius}function xAe(e){return e.startAngle}function bAe(e){return e.endAngle}function wAe(e){return e&&e.padAngle}function SAe(e,t,n,r,a,c,d,i){var _=n-e,b=r-t,T=d-a,A=i-c,k=A*_-T*b;if(!(k*k<$l))return k=(T*(t-c)-A*(e-a))/k,[e+k*_,t+k*b]}function e2(e,t,n,r,a,c,d){var i=e-n,_=t-r,b=(d?c:-c)/Bs(i*i+_*_),T=b*_,A=-b*i,k=e+T,R=t+A,B=n+T,N=r+A,V=(k+B)/2,H=(R+N)/2,G=B-k,q=N-R,Q=G*G+q*q,te=a-c,ue=k*N-B*R,fe=(q<0?-1:1)*Bs(fAe(0,te*te*Q-ue*ue)),ye=(ue*q-G*fe)/Q,De=(-ue*G-q*fe)/Q,Ne=(ue*q+G*fe)/Q,Fe=(-ue*G+q*fe)/Q,Le=ye-V,Ze=De-H,He=Ne-V,ct=Fe-H;return Le*Le+Ze*Ze>He*He+ct*ct&&(ye=Ne,De=Fe),{cx:ye,cy:De,x01:-T,y01:-A,x11:ye*(a/te-1),y11:De*(a/te-1)}}function oQe(){var e=yAe,t=vAe,n=Ti(0),r=null,a=xAe,c=bAe,d=wAe,i=null,_=oI(b);function b(){var T,A,k=+e.apply(this,arguments),R=+t.apply(this,arguments),B=a.apply(this,arguments)-jA,N=c.apply(this,arguments)-jA,V=N6(N-B),H=N>B;if(i||(i=T=_()),R<k&&(A=R,R=k,k=A),!(R>$l))i.moveTo(0,0);else if(V>Jp-$l)i.moveTo(R*Xd(B),R*Wl(B)),i.arc(0,0,R,B,N,!H),k>$l&&(i.moveTo(k*Xd(N),k*Wl(N)),i.arc(0,0,k,N,B,H));else{var G=B,q=N,Q=B,te=N,ue=V,fe=V,ye=d.apply(this,arguments)/2,De=ye>$l&&(r?+r.apply(this,arguments):Bs(k*k+R*R)),Ne=Zk(N6(R-k)/2,+n.apply(this,arguments)),Fe=Ne,Le=Ne,Ze,He;if(De>$l){var ct=F6(De/k*Wl(ye)),ot=F6(De/R*Wl(ye));(ue-=ct*2)>$l?(ct*=H?1:-1,Q+=ct,te-=ct):(ue=0,Q=te=(B+N)/2),(fe-=ot*2)>$l?(ot*=H?1:-1,G+=ot,q-=ot):(fe=0,G=q=(B+N)/2)}var rt=R*Xd(G),Be=R*Wl(G),nt=k*Xd(te),at=k*Wl(te);if(Ne>$l){var Mt=R*Xd(q),Nt=R*Wl(q),rn=k*Xd(Q),un=k*Wl(Q),en;if(V<fm)if(en=SAe(rt,Be,rn,un,Mt,Nt,nt,at)){var sn=rt-en[0],Vt=Be-en[1],$n=Mt-en[0],Gt=Nt-en[1],Tn=1/Wl(pAe((sn*$n+Vt*Gt)/(Bs(sn*sn+Vt*Vt)*Bs($n*$n+Gt*Gt)))/2),hn=Bs(en[0]*en[0]+en[1]*en[1]);Fe=Zk(Ne,(k-hn)/(Tn-1)),Le=Zk(Ne,(R-hn)/(Tn+1))}else Fe=Le=0}fe>$l?Le>$l?(Ze=e2(rn,un,rt,Be,R,Le,H),He=e2(Mt,Nt,nt,at,R,Le,H),i.moveTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Le<Ne?i.arc(Ze.cx,Ze.cy,Le,Zs(Ze.y01,Ze.x01),Zs(He.y01,He.x01),!H):(i.arc(Ze.cx,Ze.cy,Le,Zs(Ze.y01,Ze.x01),Zs(Ze.y11,Ze.x11),!H),i.arc(0,0,R,Zs(Ze.cy+Ze.y11,Ze.cx+Ze.x11),Zs(He.cy+He.y11,He.cx+He.x11),!H),i.arc(He.cx,He.cy,Le,Zs(He.y11,He.x11),Zs(He.y01,He.x01),!H))):(i.moveTo(rt,Be),i.arc(0,0,R,G,q,!H)):i.moveTo(rt,Be),!(k>$l)||!(ue>$l)?i.lineTo(nt,at):Fe>$l?(Ze=e2(nt,at,Mt,Nt,k,-Fe,H),He=e2(rt,Be,rn,un,k,-Fe,H),i.lineTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Fe<Ne?i.arc(Ze.cx,Ze.cy,Fe,Zs(Ze.y01,Ze.x01),Zs(He.y01,He.x01),!H):(i.arc(Ze.cx,Ze.cy,Fe,Zs(Ze.y01,Ze.x01),Zs(Ze.y11,Ze.x11),!H),i.arc(0,0,k,Zs(Ze.cy+Ze.y11,Ze.cx+Ze.x11),Zs(He.cy+He.y11,He.cx+He.x11),H),i.arc(He.cx,He.cy,Fe,Zs(He.y11,He.x11),Zs(He.y01,He.x01),!H))):i.arc(0,0,k,te,Q,H)}if(i.closePath(),T)return i=null,T+""||null}return b.centroid=function(){var T=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,A=(+a.apply(this,arguments)+ +c.apply(this,arguments))/2-fm/2;return[Xd(A)*T,Wl(A)*T]},b.innerRadius=function(T){return arguments.length?(e=typeof T=="function"?T:Ti(+T),b):e},b.outerRadius=function(T){return arguments.length?(t=typeof T=="function"?T:Ti(+T),b):t},b.cornerRadius=function(T){return arguments.length?(n=typeof T=="function"?T:Ti(+T),b):n},b.padRadius=function(T){return arguments.length?(r=T==null?null:typeof T=="function"?T:Ti(+T),b):r},b.startAngle=function(T){return arguments.length?(a=typeof T=="function"?T:Ti(+T),b):a},b.endAngle=function(T){return arguments.length?(c=typeof T=="function"?T:Ti(+T),b):c},b.padAngle=function(T){return arguments.length?(d=typeof T=="function"?T:Ti(+T),b):d},b.context=function(T){return arguments.length?(i=T??null,b):i},b}function aI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function VJ(e){this._context=e}VJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function sI(e){return new VJ(e)}function WJ(e){return e[0]}function GJ(e){return e[1]}function HJ(e,t){var n=Ti(!0),r=null,a=sI,c=null,d=oI(i);e=typeof e=="function"?e:e===void 0?WJ:Ti(e),t=typeof t=="function"?t:t===void 0?GJ:Ti(t);function i(_){var b,T=(_=aI(_)).length,A,k=!1,R;for(r==null&&(c=a(R=d())),b=0;b<=T;++b)!(b<T&&n(A=_[b],b,_))===k&&((k=!k)?c.lineStart():c.lineEnd()),k&&c.point(+e(A,b,_),+t(A,b,_));if(R)return c=null,R+""||null}return i.x=function(_){return arguments.length?(e=typeof _=="function"?_:Ti(+_),i):e},i.y=function(_){return arguments.length?(t=typeof _=="function"?_:Ti(+_),i):t},i.defined=function(_){return arguments.length?(n=typeof _=="function"?_:Ti(!!_),i):n},i.curve=function(_){return arguments.length?(a=_,r!=null&&(c=a(r)),i):a},i.context=function(_){return arguments.length?(_==null?r=c=null:c=a(r=_),i):r},i}function t2(e,t,n){var r=null,a=Ti(!0),c=null,d=sI,i=null,_=oI(b);e=typeof e=="function"?e:e===void 0?WJ:Ti(+e),t=typeof t=="function"?t:Ti(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?GJ:Ti(+n);function b(A){var k,R,B,N=(A=aI(A)).length,V,H=!1,G,q=new Array(N),Q=new Array(N);for(c==null&&(i=d(G=_())),k=0;k<=N;++k){if(!(k<N&&a(V=A[k],k,A))===H)if(H=!H)R=k,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),B=k-1;B>=R;--B)i.point(q[B],Q[B]);i.lineEnd(),i.areaEnd()}H&&(q[k]=+e(V,k,A),Q[k]=+t(V,k,A),i.point(r?+r(V,k,A):q[k],n?+n(V,k,A):Q[k]))}if(G)return i=null,G+""||null}function T(){return HJ().defined(a).curve(d).context(c)}return b.x=function(A){return arguments.length?(e=typeof A=="function"?A:Ti(+A),r=null,b):e},b.x0=function(A){return arguments.length?(e=typeof A=="function"?A:Ti(+A),b):e},b.x1=function(A){return arguments.length?(r=A==null?null:typeof A=="function"?A:Ti(+A),b):r},b.y=function(A){return arguments.length?(t=typeof A=="function"?A:Ti(+A),n=null,b):t},b.y0=function(A){return arguments.length?(t=typeof A=="function"?A:Ti(+A),b):t},b.y1=function(A){return arguments.length?(n=A==null?null:typeof A=="function"?A:Ti(+A),b):n},b.lineX0=b.lineY0=function(){return T().x(e).y(t)},b.lineY1=function(){return T().x(e).y(n)},b.lineX1=function(){return T().x(r).y(t)},b.defined=function(A){return arguments.length?(a=typeof A=="function"?A:Ti(!!A),b):a},b.curve=function(A){return arguments.length?(d=A,c!=null&&(i=d(c)),b):d},b.context=function(A){return arguments.length?(A==null?c=i=null:i=d(c=A),b):c},b}function TAe(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function EAe(e){return e}function aQe(){var e=EAe,t=TAe,n=null,r=Ti(0),a=Ti(Jp),c=Ti(0);function d(i){var _,b=(i=aI(i)).length,T,A,k=0,R=new Array(b),B=new Array(b),N=+r.apply(this,arguments),V=Math.min(Jp,Math.max(-Jp,a.apply(this,arguments)-N)),H,G=Math.min(Math.abs(V)/b,c.apply(this,arguments)),q=G*(V<0?-1:1),Q;for(_=0;_<b;++_)(Q=B[R[_]=_]=+e(i[_],_,i))>0&&(k+=Q);for(t!=null?R.sort(function(te,ue){return t(B[te],B[ue])}):n!=null&&R.sort(function(te,ue){return n(i[te],i[ue])}),_=0,A=k?(V-b*q)/k:0;_<b;++_,N=H)T=R[_],Q=B[T],H=N+(Q>0?Q*A:0)+q,B[T]={data:i[T],index:_,value:Q,startAngle:N,endAngle:H,padAngle:G};return B}return d.value=function(i){return arguments.length?(e=typeof i=="function"?i:Ti(+i),d):e},d.sortValues=function(i){return arguments.length?(t=i,n=null,d):t},d.sort=function(i){return arguments.length?(n=i,t=null,d):n},d.startAngle=function(i){return arguments.length?(r=typeof i=="function"?i:Ti(+i),d):r},d.endAngle=function(i){return arguments.length?(a=typeof i=="function"?i:Ti(+i),d):a},d.padAngle=function(i){return arguments.length?(c=typeof i=="function"?i:Ti(+i),d):c},d}class qJ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function AAe(e){return new qJ(e,!0)}function PAe(e){return new qJ(e,!1)}const yF={draw(e,t){const n=Bs(t/fm);e.moveTo(n,0),e.arc(0,0,n,0,Jp)}},CAe={draw(e,t){const n=Bs(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},ZJ=Bs(1/3),IAe=ZJ*2,MAe={draw(e,t){const n=Bs(t/IAe),r=n*ZJ;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},OAe={draw(e,t){const n=Bs(t),r=-n/2;e.rect(r,r,n,n)}},kAe=.8908130915292852,XJ=Wl(fm/10)/Wl(7*fm/10),RAe=Wl(Jp/10)*XJ,DAe=-Xd(Jp/10)*XJ,LAe={draw(e,t){const n=Bs(t*kAe),r=RAe*n,a=DAe*n;e.moveTo(0,-n),e.lineTo(r,a);for(let c=1;c<5;++c){const d=Jp*c/5,i=Xd(d),_=Wl(d);e.lineTo(_*n,-i*n),e.lineTo(i*r-_*a,_*r+i*a)}e.closePath()}},Xk=Bs(3),zAe={draw(e,t){const n=-Bs(t/(Xk*3));e.moveTo(0,n*2),e.lineTo(-Xk*n,-n),e.lineTo(Xk*n,-n),e.closePath()}},Zc=-.5,Xc=Bs(3)/2,gL=1/Bs(12),NAe=(gL/2+1)*3,FAe={draw(e,t){const n=Bs(t/NAe),r=n/2,a=n*gL,c=r,d=n*gL+n,i=-c,_=d;e.moveTo(r,a),e.lineTo(c,d),e.lineTo(i,_),e.lineTo(Zc*r-Xc*a,Xc*r+Zc*a),e.lineTo(Zc*c-Xc*d,Xc*c+Zc*d),e.lineTo(Zc*i-Xc*_,Xc*i+Zc*_),e.lineTo(Zc*r+Xc*a,Zc*a-Xc*r),e.lineTo(Zc*c+Xc*d,Zc*d-Xc*c),e.lineTo(Zc*i+Xc*_,Zc*_-Xc*i),e.closePath()}};function BAe(e,t){let n=null,r=oI(a);e=typeof e=="function"?e:Ti(e||yF),t=typeof t=="function"?t:Ti(t===void 0?64:+t);function a(){let c;if(n||(n=c=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),c)return n=null,c+""||null}return a.type=function(c){return arguments.length?(e=typeof c=="function"?c:Ti(c),a):e},a.size=function(c){return arguments.length?(t=typeof c=="function"?c:Ti(+c),a):t},a.context=function(c){return arguments.length?(n=c??null,a):n},a}function $A(){}function UA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function KJ(e){this._context=e}KJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:UA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:UA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jAe(e){return new KJ(e)}function YJ(e){this._context=e}YJ.prototype={areaStart:$A,areaEnd:$A,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:UA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $Ae(e){return new YJ(e)}function JJ(e){this._context=e}JJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:UA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function UAe(e){return new JJ(e)}function QJ(e){this._context=e}QJ.prototype={areaStart:$A,areaEnd:$A,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function VAe(e){return new QJ(e)}function B6(e){return e<0?-1:1}function j6(e,t,n){var r=e._x1-e._x0,a=t-e._x1,c=(e._y1-e._y0)/(r||a<0&&-0),d=(n-e._y1)/(a||r<0&&-0),i=(c*a+d*r)/(r+a);return(B6(c)+B6(d))*Math.min(Math.abs(c),Math.abs(d),.5*Math.abs(i))||0}function $6(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Kk(e,t,n){var r=e._x0,a=e._y0,c=e._x1,d=e._y1,i=(c-r)/3;e._context.bezierCurveTo(r+i,a+i*t,c-i,d-i*n,c,d)}function VA(e){this._context=e}VA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Kk(this,this._t0,$6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Kk(this,$6(this,n=j6(this,e,t)),n);break;default:Kk(this,this._t0,n=j6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function eQ(e){this._context=new tQ(e)}(eQ.prototype=Object.create(VA.prototype)).point=function(e,t){VA.prototype.point.call(this,t,e)};function tQ(e){this._context=e}tQ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,c){this._context.bezierCurveTo(t,e,r,n,c,a)}};function WAe(e){return new VA(e)}function GAe(e){return new eQ(e)}function nQ(e){this._context=e}nQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=U6(e),a=U6(t),c=0,d=1;d<n;++c,++d)this._context.bezierCurveTo(r[0][c],a[0][c],r[1][c],a[1][c],e[d],t[d]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function U6(e){var t,n=e.length-1,r,a=new Array(n),c=new Array(n),d=new Array(n);for(a[0]=0,c[0]=2,d[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,c[t]=4,d[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,c[n-1]=7,d[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/c[t-1],c[t]-=r,d[t]-=r*d[t-1];for(a[n-1]=d[n-1]/c[n-1],t=n-2;t>=0;--t)a[t]=(d[t]-a[t+1])/c[t];for(c[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)c[t]=2*e[t+1]-a[t+1];return[a,c]}function HAe(e){return new nQ(e)}function lI(e,t){this._context=e,this._t=t}lI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function qAe(e){return new lI(e,.5)}function ZAe(e){return new lI(e,0)}function XAe(e){return new lI(e,1)}function e0(e,t){if((d=e.length)>1)for(var n=1,r,a,c=e[t[0]],d,i=c.length;n<d;++n)for(a=c,c=e[t[n]],r=0;r<i;++r)c[r][1]+=c[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function _L(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function KAe(e,t){return e[t]}function YAe(e){const t=[];return t.key=e,t}function JAe(){var e=Ti([]),t=_L,n=e0,r=KAe;function a(c){var d=Array.from(e.apply(this,arguments),YAe),i,_=d.length,b=-1,T;for(const A of c)for(i=0,++b;i<_;++i)(d[i][b]=[0,+r(A,d[i].key,b,c)]).data=A;for(i=0,T=aI(t(d));i<_;++i)d[T[i]].index=i;return n(d,T),d}return a.keys=function(c){return arguments.length?(e=typeof c=="function"?c:Ti(Array.from(c)),a):e},a.value=function(c){return arguments.length?(r=typeof c=="function"?c:Ti(+c),a):r},a.order=function(c){return arguments.length?(t=c==null?_L:typeof c=="function"?c:Ti(Array.from(c)),a):t},a.offset=function(c){return arguments.length?(n=c??e0,a):n},a}function QAe(e,t){if((r=e.length)>0){for(var n,r,a=0,c=e[0].length,d;a<c;++a){for(d=n=0;n<r;++n)d+=e[n][a][1]||0;if(d)for(n=0;n<r;++n)e[n][a][1]/=d}e0(e,t)}}function ePe(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,c=r.length;n<c;++n){for(var d=0,i=0;d<a;++d)i+=e[d][n][1]||0;r[n][1]+=r[n][0]=-i/2}e0(e,t)}}function tPe(e,t){if(!(!((d=e.length)>0)||!((c=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,c,d;r<c;++r){for(var i=0,_=0,b=0;i<d;++i){for(var T=e[t[i]],A=T[r][1]||0,k=T[r-1][1]||0,R=(A-k)/2,B=0;B<i;++B){var N=e[t[B]],V=N[r][1]||0,H=N[r-1][1]||0;R+=V-H}_+=A,b+=R*A}a[r-1][1]+=a[r-1][0]=n,_&&(n-=b/_)}a[r-1][1]+=a[r-1][0]=n,e0(e,t)}}function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}var nPe=["type","size","sizeType"];function yL(){return yL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yL.apply(this,arguments)}function V6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function W6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V6(Object(n),!0).forEach(function(r){rPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rPe(e,t,n){return t=iPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iPe(e){var t=oPe(e,"string");return Pw(t)=="symbol"?t:t+""}function oPe(e,t){if(Pw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Pw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aPe(e,t){if(e==null)return{};var n=sPe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var rQ={symbolCircle:yF,symbolCross:CAe,symbolDiamond:MAe,symbolSquare:OAe,symbolStar:LAe,symbolTriangle:zAe,symbolWye:FAe},lPe=Math.PI/180,cPe=function(t){var n="symbol".concat(iI(t));return rQ[n]||yF},uPe=function(t,n,r){if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*lPe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},hPe=function(t,n){rQ["symbol".concat(iI(t))]=n},cI=function(t){var n=t.type,r=n===void 0?"circle":n,a=t.size,c=a===void 0?64:a,d=t.sizeType,i=d===void 0?"area":d,_=aPe(t,nPe),b=W6(W6({},_),{},{type:r,size:c,sizeType:i}),T=function(){var V=cPe(r),H=BAe().type(V).size(uPe(c,i,r));return H()},A=b.className,k=b.cx,R=b.cy,B=wr(b,!0);return k===+k&&R===+R&&c===+c?Ce.createElement("path",yL({},B,{className:li("recharts-symbols",A),transform:"translate(".concat(k,", ").concat(R,")"),d:T()})):null};cI.registerSymbol=hPe;function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function vL(){return vL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vL.apply(this,arguments)}function G6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dPe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G6(Object(n),!0).forEach(function(r){Cw(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oQ(r.key),r)}}function mPe(e,t,n){return t&&pPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gPe(e,t,n){return t=WA(t),_Pe(e,iQ()?Reflect.construct(t,n||[],WA(e).constructor):t.apply(e,n))}function _Pe(e,t){if(t&&(t0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yPe(e)}function yPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iQ=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},WA(e)}function vPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xL(e,t)}function xL(e,t){return xL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},xL(e,t)}function Cw(e,t,n){return t=oQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oQ(e){var t=xPe(e,"string");return t0(t)=="symbol"?t:t+""}function xPe(e,t){if(t0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(t0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kc=32,vF=function(e){function t(){return fPe(this,t),gPe(this,t,arguments)}return vPe(t,e),mPe(t,[{key:"renderIcon",value:function(r){var a=this.props.inactiveColor,c=Kc/2,d=Kc/6,i=Kc/3,_=r.inactive?a:r.color;if(r.type==="plainline")return Ce.createElement("line",{strokeWidth:4,fill:"none",stroke:_,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:c,x2:Kc,y2:c,className:"recharts-legend-icon"});if(r.type==="line")return Ce.createElement("path",{strokeWidth:4,fill:"none",stroke:_,d:"M0,".concat(c,"h").concat(i,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*i,",").concat(c,`
            H`).concat(Kc,"M").concat(2*i,",").concat(c,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(i,",").concat(c),className:"recharts-legend-icon"});if(r.type==="rect")return Ce.createElement("path",{stroke:"none",fill:_,d:"M0,".concat(Kc/8,"h").concat(Kc,"v").concat(Kc*3/4,"h").concat(-Kc,"z"),className:"recharts-legend-icon"});if(Ce.isValidElement(r.legendIcon)){var b=dPe({},r);return delete b.legendIcon,Ce.cloneElement(r.legendIcon,b)}return Ce.createElement(cI,{fill:_,cx:c,cy:c,size:Kc,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,a=this.props,c=a.payload,d=a.iconSize,i=a.layout,_=a.formatter,b=a.inactiveColor,T={x:0,y:0,width:Kc,height:Kc},A={display:i==="horizontal"?"inline-block":"block",marginRight:10},k={display:"inline-block",verticalAlign:"middle",marginRight:4};return c.map(function(R,B){var N=R.formatter||_,V=li(Cw(Cw({"recharts-legend-item":!0},"legend-item-".concat(B),!0),"inactive",R.inactive));if(R.type==="none")return null;var H=$r(R.value)?null:R.value;rh(!$r(R.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var G=R.inactive?b:R.color;return Ce.createElement("li",vL({className:V,style:A,key:"legend-item-".concat(B)},dm(r.props,R,B)),Ce.createElement(uL,{width:d,height:d,viewBox:T,style:k},r.renderIcon(R)),Ce.createElement("span",{className:"recharts-legend-item-text",style:{color:G}},N?N(H,R,B):H))})}},{key:"render",value:function(){var r=this.props,a=r.payload,c=r.layout,d=r.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:c==="horizontal"?d:"left"};return Ce.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(X.PureComponent);Cw(vF,"displayName","Legend");Cw(vF,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var bPe=GC;function wPe(){this.__data__=new bPe,this.size=0}var SPe=wPe;function TPe(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var EPe=TPe;function APe(e){return this.__data__.get(e)}var PPe=APe;function CPe(e){return this.__data__.has(e)}var IPe=CPe,MPe=GC,OPe=cF,kPe=uF,RPe=200;function DPe(e,t){var n=this.__data__;if(n instanceof MPe){var r=n.__data__;if(!OPe||r.length<RPe-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new kPe(r)}return n.set(e,t),this.size=n.size,this}var LPe=DPe,zPe=GC,NPe=SPe,FPe=EPe,BPe=PPe,jPe=IPe,$Pe=LPe;function Q0(e){var t=this.__data__=new zPe(e);this.size=t.size}Q0.prototype.clear=NPe;Q0.prototype.delete=FPe;Q0.prototype.get=BPe;Q0.prototype.has=jPe;Q0.prototype.set=$Pe;var aQ=Q0,UPe="__lodash_hash_undefined__";function VPe(e){return this.__data__.set(e,UPe),this}var WPe=VPe;function GPe(e){return this.__data__.has(e)}var HPe=GPe,qPe=uF,ZPe=WPe,XPe=HPe;function GA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new qPe;++t<n;)this.add(e[t])}GA.prototype.add=GA.prototype.push=ZPe;GA.prototype.has=XPe;var sQ=GA;function KPe(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var lQ=KPe;function YPe(e,t){return e.has(t)}var cQ=YPe,JPe=sQ,QPe=lQ,eCe=cQ,tCe=1,nCe=2;function rCe(e,t,n,r,a,c){var d=n&tCe,i=e.length,_=t.length;if(i!=_&&!(d&&_>i))return!1;var b=c.get(e),T=c.get(t);if(b&&T)return b==t&&T==e;var A=-1,k=!0,R=n&nCe?new JPe:void 0;for(c.set(e,t),c.set(t,e);++A<i;){var B=e[A],N=t[A];if(r)var V=d?r(N,B,A,t,e,c):r(B,N,A,e,t,c);if(V!==void 0){if(V)continue;k=!1;break}if(R){if(!QPe(t,function(H,G){if(!eCe(R,G)&&(B===H||a(B,H,n,r,c)))return R.push(G)})){k=!1;break}}else if(!(B===N||a(B,N,n,r,c))){k=!1;break}}return c.delete(e),c.delete(t),k}var uQ=rCe,iCe=sd,oCe=iCe.Uint8Array,aCe=oCe;function sCe(e){var t=-1,n=Array(e.size);return e.forEach(function(r,a){n[++t]=[a,r]}),n}var lCe=sCe;function cCe(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var xF=cCe,H6=zS,q6=aCe,uCe=lF,hCe=uQ,dCe=lCe,fCe=xF,pCe=1,mCe=2,gCe="[object Boolean]",_Ce="[object Date]",yCe="[object Error]",vCe="[object Map]",xCe="[object Number]",bCe="[object RegExp]",wCe="[object Set]",SCe="[object String]",TCe="[object Symbol]",ECe="[object ArrayBuffer]",ACe="[object DataView]",Z6=H6?H6.prototype:void 0,Yk=Z6?Z6.valueOf:void 0;function PCe(e,t,n,r,a,c,d){switch(n){case ACe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ECe:return!(e.byteLength!=t.byteLength||!c(new q6(e),new q6(t)));case gCe:case _Ce:case xCe:return uCe(+e,+t);case yCe:return e.name==t.name&&e.message==t.message;case bCe:case SCe:return e==t+"";case vCe:var i=dCe;case wCe:var _=r&pCe;if(i||(i=fCe),e.size!=t.size&&!_)return!1;var b=d.get(e);if(b)return b==t;r|=mCe,d.set(e,t);var T=hCe(i(e),i(t),r,a,c,d);return d.delete(e),T;case TCe:if(Yk)return Yk.call(e)==Yk.call(t)}return!1}var CCe=PCe;function ICe(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}var hQ=ICe,MCe=hQ,OCe=nc;function kCe(e,t,n){var r=t(e);return OCe(e)?r:MCe(r,n(e))}var RCe=kCe;function DCe(e,t){for(var n=-1,r=e==null?0:e.length,a=0,c=[];++n<r;){var d=e[n];t(d,n,e)&&(c[a++]=d)}return c}var LCe=DCe;function zCe(){return[]}var NCe=zCe,FCe=LCe,BCe=NCe,jCe=Object.prototype,$Ce=jCe.propertyIsEnumerable,X6=Object.getOwnPropertySymbols,UCe=X6?function(e){return e==null?[]:(e=Object(e),FCe(X6(e),function(t){return $Ce.call(e,t)}))}:BCe,VCe=UCe;function WCe(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var GCe=WCe,HCe=wf,qCe=Sf,ZCe="[object Arguments]";function XCe(e){return qCe(e)&&HCe(e)==ZCe}var KCe=XCe,K6=KCe,YCe=Sf,dQ=Object.prototype,JCe=dQ.hasOwnProperty,QCe=dQ.propertyIsEnumerable,eIe=K6(function(){return arguments}())?K6:function(e){return YCe(e)&&JCe.call(e,"callee")&&!QCe.call(e,"callee")},bF=eIe,HA={exports:{}};function tIe(){return!1}var nIe=tIe;HA.exports;(function(e,t){var n=sd,r=nIe,a=t&&!t.nodeType&&t,c=a&&!0&&e&&!e.nodeType&&e,d=c&&c.exports===a,i=d?n.Buffer:void 0,_=i?i.isBuffer:void 0,b=_||r;e.exports=b})(HA,HA.exports);var fQ=HA.exports,rIe=9007199254740991,iIe=/^(?:0|[1-9]\d*)$/;function oIe(e,t){var n=typeof e;return t=t??rIe,!!t&&(n=="number"||n!="symbol"&&iIe.test(e))&&e>-1&&e%1==0&&e<t}var wF=oIe,aIe=9007199254740991;function sIe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=aIe}var SF=sIe,lIe=wf,cIe=SF,uIe=Sf,hIe="[object Arguments]",dIe="[object Array]",fIe="[object Boolean]",pIe="[object Date]",mIe="[object Error]",gIe="[object Function]",_Ie="[object Map]",yIe="[object Number]",vIe="[object Object]",xIe="[object RegExp]",bIe="[object Set]",wIe="[object String]",SIe="[object WeakMap]",TIe="[object ArrayBuffer]",EIe="[object DataView]",AIe="[object Float32Array]",PIe="[object Float64Array]",CIe="[object Int8Array]",IIe="[object Int16Array]",MIe="[object Int32Array]",OIe="[object Uint8Array]",kIe="[object Uint8ClampedArray]",RIe="[object Uint16Array]",DIe="[object Uint32Array]",Ho={};Ho[AIe]=Ho[PIe]=Ho[CIe]=Ho[IIe]=Ho[MIe]=Ho[OIe]=Ho[kIe]=Ho[RIe]=Ho[DIe]=!0;Ho[hIe]=Ho[dIe]=Ho[TIe]=Ho[fIe]=Ho[EIe]=Ho[pIe]=Ho[mIe]=Ho[gIe]=Ho[_Ie]=Ho[yIe]=Ho[vIe]=Ho[xIe]=Ho[bIe]=Ho[wIe]=Ho[SIe]=!1;function LIe(e){return uIe(e)&&cIe(e.length)&&!!Ho[lIe(e)]}var zIe=LIe;function NIe(e){return function(t){return e(t)}}var pQ=NIe,qA={exports:{}};qA.exports;(function(e,t){var n=bJ,r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,c=a&&a.exports===r,d=c&&n.process,i=function(){try{var _=a&&a.require&&a.require("util").types;return _||d&&d.binding&&d.binding("util")}catch{}}();e.exports=i})(qA,qA.exports);var FIe=qA.exports,BIe=zIe,jIe=pQ,Y6=FIe,J6=Y6&&Y6.isTypedArray,$Ie=J6?jIe(J6):BIe,mQ=$Ie,UIe=GCe,VIe=bF,WIe=nc,GIe=fQ,HIe=wF,qIe=mQ,ZIe=Object.prototype,XIe=ZIe.hasOwnProperty;function KIe(e,t){var n=WIe(e),r=!n&&VIe(e),a=!n&&!r&&GIe(e),c=!n&&!r&&!a&&qIe(e),d=n||r||a||c,i=d?UIe(e.length,String):[],_=i.length;for(var b in e)(t||XIe.call(e,b))&&!(d&&(b=="length"||a&&(b=="offset"||b=="parent")||c&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||HIe(b,_)))&&i.push(b);return i}var YIe=KIe,JIe=Object.prototype;function QIe(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||JIe;return e===n}var eMe=QIe;function tMe(e,t){return function(n){return e(t(n))}}var gQ=tMe,nMe=gQ,rMe=nMe(Object.keys,Object),iMe=rMe,oMe=eMe,aMe=iMe,sMe=Object.prototype,lMe=sMe.hasOwnProperty;function cMe(e){if(!oMe(e))return aMe(e);var t=[];for(var n in Object(e))lMe.call(e,n)&&n!="constructor"&&t.push(n);return t}var uMe=cMe,hMe=sF,dMe=SF;function fMe(e){return e!=null&&dMe(e.length)&&!hMe(e)}var FS=fMe,pMe=YIe,mMe=uMe,gMe=FS;function _Me(e){return gMe(e)?pMe(e):mMe(e)}var uI=_Me,yMe=RCe,vMe=VCe,xMe=uI;function bMe(e){return yMe(e,xMe,vMe)}var wMe=bMe,Q6=wMe,SMe=1,TMe=Object.prototype,EMe=TMe.hasOwnProperty;function AMe(e,t,n,r,a,c){var d=n&SMe,i=Q6(e),_=i.length,b=Q6(t),T=b.length;if(_!=T&&!d)return!1;for(var A=_;A--;){var k=i[A];if(!(d?k in t:EMe.call(t,k)))return!1}var R=c.get(e),B=c.get(t);if(R&&B)return R==t&&B==e;var N=!0;c.set(e,t),c.set(t,e);for(var V=d;++A<_;){k=i[A];var H=e[k],G=t[k];if(r)var q=d?r(G,H,k,t,e,c):r(H,G,k,e,t,c);if(!(q===void 0?H===G||a(H,G,n,r,c):q)){N=!1;break}V||(V=k=="constructor")}if(N&&!V){var Q=e.constructor,te=t.constructor;Q!=te&&"constructor"in e&&"constructor"in t&&!(typeof Q=="function"&&Q instanceof Q&&typeof te=="function"&&te instanceof te)&&(N=!1)}return c.delete(e),c.delete(t),N}var PMe=AMe,CMe=I_,IMe=sd,MMe=CMe(IMe,"DataView"),OMe=MMe,kMe=I_,RMe=sd,DMe=kMe(RMe,"Promise"),LMe=DMe,zMe=I_,NMe=sd,FMe=zMe(NMe,"Set"),_Q=FMe,BMe=I_,jMe=sd,$Me=BMe(jMe,"WeakMap"),UMe=$Me,bL=OMe,wL=cF,SL=LMe,TL=_Q,EL=UMe,yQ=wf,ex=SJ,e8="[object Map]",VMe="[object Object]",t8="[object Promise]",n8="[object Set]",r8="[object WeakMap]",i8="[object DataView]",WMe=ex(bL),GMe=ex(wL),HMe=ex(SL),qMe=ex(TL),ZMe=ex(EL),Dg=yQ;(bL&&Dg(new bL(new ArrayBuffer(1)))!=i8||wL&&Dg(new wL)!=e8||SL&&Dg(SL.resolve())!=t8||TL&&Dg(new TL)!=n8||EL&&Dg(new EL)!=r8)&&(Dg=function(e){var t=yQ(e),n=t==VMe?e.constructor:void 0,r=n?ex(n):"";if(r)switch(r){case WMe:return i8;case GMe:return e8;case HMe:return t8;case qMe:return n8;case ZMe:return r8}return t});var XMe=Dg,Jk=aQ,KMe=uQ,YMe=CCe,JMe=PMe,o8=XMe,a8=nc,s8=fQ,QMe=mQ,eOe=1,l8="[object Arguments]",c8="[object Array]",n2="[object Object]",tOe=Object.prototype,u8=tOe.hasOwnProperty;function nOe(e,t,n,r,a,c){var d=a8(e),i=a8(t),_=d?c8:o8(e),b=i?c8:o8(t);_=_==l8?n2:_,b=b==l8?n2:b;var T=_==n2,A=b==n2,k=_==b;if(k&&s8(e)){if(!s8(t))return!1;d=!0,T=!1}if(k&&!T)return c||(c=new Jk),d||QMe(e)?KMe(e,t,n,r,a,c):YMe(e,t,_,n,r,a,c);if(!(n&eOe)){var R=T&&u8.call(e,"__wrapped__"),B=A&&u8.call(t,"__wrapped__");if(R||B){var N=R?e.value():e,V=B?t.value():t;return c||(c=new Jk),a(N,V,n,r,c)}}return k?(c||(c=new Jk),JMe(e,t,n,r,a,c)):!1}var rOe=nOe,iOe=rOe,h8=Sf;function vQ(e,t,n,r,a){return e===t?!0:e==null||t==null||!h8(e)&&!h8(t)?e!==e&&t!==t:iOe(e,t,n,r,vQ,a)}var TF=vQ,oOe=aQ,aOe=TF,sOe=1,lOe=2;function cOe(e,t,n,r){var a=n.length,c=a,d=!r;if(e==null)return!c;for(e=Object(e);a--;){var i=n[a];if(d&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++a<c;){i=n[a];var _=i[0],b=e[_],T=i[1];if(d&&i[2]){if(b===void 0&&!(_ in e))return!1}else{var A=new oOe;if(r)var k=r(b,T,_,e,t,A);if(!(k===void 0?aOe(T,b,sOe|lOe,r,A):k))return!1}}return!0}var uOe=cOe,hOe=Tm;function dOe(e){return e===e&&!hOe(e)}var xQ=dOe,fOe=xQ,pOe=uI;function mOe(e){for(var t=pOe(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,fOe(a)]}return t}var gOe=mOe;function _Oe(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var bQ=_Oe,yOe=uOe,vOe=gOe,xOe=bQ;function bOe(e){var t=vOe(e);return t.length==1&&t[0][2]?xOe(t[0][0],t[0][1]):function(n){return n===e||yOe(n,e,t)}}var wOe=bOe;function SOe(e,t){return e!=null&&t in Object(e)}var TOe=SOe,EOe=CJ,AOe=bF,POe=nc,COe=wF,IOe=SF,MOe=qC;function OOe(e,t,n){t=EOe(t,e);for(var r=-1,a=t.length,c=!1;++r<a;){var d=MOe(t[r]);if(!(c=e!=null&&n(e,d)))break;e=e[d]}return c||++r!=a?c:(a=e==null?0:e.length,!!a&&IOe(a)&&COe(d,a)&&(POe(e)||AOe(e)))}var kOe=OOe,ROe=TOe,DOe=kOe;function LOe(e,t){return e!=null&&DOe(e,t,ROe)}var zOe=LOe,NOe=TF,FOe=IJ,BOe=zOe,jOe=aF,$Oe=xQ,UOe=bQ,VOe=qC,WOe=1,GOe=2;function HOe(e,t){return jOe(e)&&$Oe(t)?UOe(VOe(e),t):function(n){var r=FOe(n,e);return r===void 0&&r===t?BOe(n,e):NOe(t,r,WOe|GOe)}}var qOe=HOe;function ZOe(e){return e}var tx=ZOe;function XOe(e){return function(t){return t==null?void 0:t[e]}}var KOe=XOe,YOe=fF;function JOe(e){return function(t){return YOe(t,e)}}var QOe=JOe,eke=KOe,tke=QOe,nke=aF,rke=qC;function ike(e){return nke(e)?eke(rke(e)):tke(e)}var oke=ike,ake=wOe,ske=qOe,lke=tx,cke=nc,uke=oke;function hke(e){return typeof e=="function"?e:e==null?lke:typeof e=="object"?cke(e)?ske(e[0],e[1]):ake(e):uke(e)}var ld=hke;function dke(e,t,n,r){for(var a=e.length,c=n+(r?1:-1);r?c--:++c<a;)if(t(e[c],c,e))return c;return-1}var wQ=dke;function fke(e){return e!==e}var pke=fke;function mke(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}var gke=mke,_ke=wQ,yke=pke,vke=gke;function xke(e,t,n){return t===t?vke(e,t,n):_ke(e,yke,n)}var bke=xke,wke=bke;function Ske(e,t){var n=e==null?0:e.length;return!!n&&wke(e,t,0)>-1}var Tke=Ske;function Eke(e,t,n){for(var r=-1,a=e==null?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}var Ake=Eke;function Pke(){}var Cke=Pke,Qk=_Q,Ike=Cke,Mke=xF,Oke=1/0,kke=Qk&&1/Mke(new Qk([,-0]))[1]==Oke?function(e){return new Qk(e)}:Ike,Rke=kke,Dke=sQ,Lke=Tke,zke=Ake,Nke=cQ,Fke=Rke,Bke=xF,jke=200;function $ke(e,t,n){var r=-1,a=Lke,c=e.length,d=!0,i=[],_=i;if(n)d=!1,a=zke;else if(c>=jke){var b=t?null:Fke(e);if(b)return Bke(b);d=!1,a=Nke,_=new Dke}else _=t?[]:i;e:for(;++r<c;){var T=e[r],A=t?t(T):T;if(T=n||T!==0?T:0,d&&A===A){for(var k=_.length;k--;)if(_[k]===A)continue e;t&&_.push(A),i.push(T)}else a(_,A,n)||(_!==i&&_.push(A),i.push(T))}return i}var Uke=$ke,Vke=ld,Wke=Uke;function Gke(e,t){return e&&e.length?Wke(e,Vke(t)):[]}var Hke=Gke;const d8=lo(Hke);function SQ(e,t,n){return t===!0?d8(e,n):$r(t)?d8(e,t):e}function n0(e){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n0(e)}var qke=["ref"];function f8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Vd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f8(Object(n),!0).forEach(function(r){hI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,EQ(r.key),r)}}function Xke(e,t,n){return t&&p8(e.prototype,t),n&&p8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kke(e,t,n){return t=ZA(t),Yke(e,TQ()?Reflect.construct(t,n||[],ZA(e).constructor):t.apply(e,n))}function Yke(e,t){if(t&&(n0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jke(e)}function Jke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TQ=function(){return!!e})()}function ZA(e){return ZA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZA(e)}function Qke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AL(e,t)}function AL(e,t){return AL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},AL(e,t)}function hI(e,t,n){return t=EQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EQ(e){var t=eRe(e,"string");return n0(t)=="symbol"?t:t+""}function eRe(e,t){if(n0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(n0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tRe(e,t){if(e==null)return{};var n=nRe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nRe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rRe(e){return e.value}function iRe(e,t){if(Ce.isValidElement(e))return Ce.cloneElement(e,t);if(typeof e=="function")return Ce.createElement(e,t);t.ref;var n=tRe(t,qke);return Ce.createElement(vF,n)}var m8=1,Ov=function(e){function t(){var n;Zke(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=Kke(this,t,[].concat(a)),hI(n,"lastBoundingBox",{width:-1,height:-1}),n}return Qke(t,e),Xke(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>m8||Math.abs(a.height-this.lastBoundingBox.height)>m8)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,r&&r(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Vd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var a=this.props,c=a.layout,d=a.align,i=a.verticalAlign,_=a.margin,b=a.chartWidth,T=a.chartHeight,A,k;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(d==="center"&&c==="vertical"){var R=this.getBBoxSnapshot();A={left:((b||0)-R.width)/2}}else A=d==="right"?{right:_&&_.right||0}:{left:_&&_.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(i==="middle"){var B=this.getBBoxSnapshot();k={top:((T||0)-B.height)/2}}else k=i==="bottom"?{bottom:_&&_.bottom||0}:{top:_&&_.top||0};return Vd(Vd({},A),k)}},{key:"render",value:function(){var r=this,a=this.props,c=a.content,d=a.width,i=a.height,_=a.wrapperStyle,b=a.payloadUniqBy,T=a.payload,A=Vd(Vd({position:"absolute",width:d||"auto",height:i||"auto"},this.getDefaultPosition(_)),_);return Ce.createElement("div",{className:"recharts-legend-wrapper",style:A,ref:function(R){r.wrapperNode=R}},iRe(c,Vd(Vd({},this.props),{},{payload:SQ(T,b,rRe)})))}}],[{key:"getWithHeight",value:function(r,a){var c=Vd(Vd({},this.defaultProps),r.props),d=c.layout;return d==="vertical"&&zn(r.props.height)?{height:r.props.height}:d==="horizontal"?{width:r.props.width||a}:null}}])}(X.PureComponent);hI(Ov,"displayName","Legend");hI(Ov,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var g8=zS,oRe=bF,aRe=nc,_8=g8?g8.isConcatSpreadable:void 0;function sRe(e){return aRe(e)||oRe(e)||!!(_8&&e&&e[_8])}var lRe=sRe,cRe=hQ,uRe=lRe;function AQ(e,t,n,r,a){var c=-1,d=e.length;for(n||(n=uRe),a||(a=[]);++c<d;){var i=e[c];t>0&&n(i)?t>1?AQ(i,t-1,n,r,a):cRe(a,i):r||(a[a.length]=i)}return a}var PQ=AQ;function hRe(e){return function(t,n,r){for(var a=-1,c=Object(t),d=r(t),i=d.length;i--;){var _=d[e?i:++a];if(n(c[_],_,c)===!1)break}return t}}var dRe=hRe,fRe=dRe,pRe=fRe(),mRe=pRe,gRe=mRe,_Re=uI;function yRe(e,t){return e&&gRe(e,t,_Re)}var CQ=yRe,vRe=FS;function xRe(e,t){return function(n,r){if(n==null)return n;if(!vRe(n))return e(n,r);for(var a=n.length,c=t?a:-1,d=Object(n);(t?c--:++c<a)&&r(d[c],c,d)!==!1;);return n}}var bRe=xRe,wRe=CQ,SRe=bRe,TRe=SRe(wRe),EF=TRe,ERe=EF,ARe=FS;function PRe(e,t){var n=-1,r=ARe(e)?Array(e.length):[];return ERe(e,function(a,c,d){r[++n]=t(a,c,d)}),r}var IQ=PRe;function CRe(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var IRe=CRe,y8=q0;function MRe(e,t){if(e!==t){var n=e!==void 0,r=e===null,a=e===e,c=y8(e),d=t!==void 0,i=t===null,_=t===t,b=y8(t);if(!i&&!b&&!c&&e>t||c&&d&&_&&!i&&!b||r&&d&&_||!n&&_||!a)return 1;if(!r&&!c&&!b&&e<t||b&&n&&a&&!r&&!c||i&&n&&a||!d&&a||!_)return-1}return 0}var ORe=MRe,kRe=ORe;function RRe(e,t,n){for(var r=-1,a=e.criteria,c=t.criteria,d=a.length,i=n.length;++r<d;){var _=kRe(a[r],c[r]);if(_){if(r>=i)return _;var b=n[r];return _*(b=="desc"?-1:1)}}return e.index-t.index}var DRe=RRe,eR=dF,LRe=fF,zRe=ld,NRe=IQ,FRe=IRe,BRe=pQ,jRe=DRe,$Re=tx,URe=nc;function VRe(e,t,n){t.length?t=eR(t,function(c){return URe(c)?function(d){return LRe(d,c.length===1?c[0]:c)}:c}):t=[$Re];var r=-1;t=eR(t,BRe(zRe));var a=NRe(e,function(c,d,i){var _=eR(t,function(b){return b(c)});return{criteria:_,index:++r,value:c}});return FRe(a,function(c,d){return jRe(c,d,n)})}var WRe=VRe;function GRe(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var HRe=GRe,qRe=HRe,v8=Math.max;function ZRe(e,t,n){return t=v8(t===void 0?e.length-1:t,0),function(){for(var r=arguments,a=-1,c=v8(r.length-t,0),d=Array(c);++a<c;)d[a]=r[t+a];a=-1;for(var i=Array(t+1);++a<t;)i[a]=r[a];return i[t]=n(d),qRe(e,this,i)}}var XRe=ZRe;function KRe(e){return function(){return e}}var YRe=KRe,JRe=I_,QRe=function(){try{var e=JRe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),MQ=QRe,eDe=YRe,x8=MQ,tDe=tx,nDe=x8?function(e,t){return x8(e,"toString",{configurable:!0,enumerable:!1,value:eDe(t),writable:!0})}:tDe,rDe=nDe,iDe=800,oDe=16,aDe=Date.now;function sDe(e){var t=0,n=0;return function(){var r=aDe(),a=oDe-(r-n);if(n=r,a>0){if(++t>=iDe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var lDe=sDe,cDe=rDe,uDe=lDe,hDe=uDe(cDe),dDe=hDe,fDe=tx,pDe=XRe,mDe=dDe;function gDe(e,t){return mDe(pDe(e,t,fDe),e+"")}var _De=gDe,yDe=lF,vDe=FS,xDe=wF,bDe=Tm;function wDe(e,t,n){if(!bDe(n))return!1;var r=typeof t;return(r=="number"?vDe(n)&&xDe(t,n.length):r=="string"&&t in n)?yDe(n[t],e):!1}var dI=wDe,SDe=PQ,TDe=WRe,EDe=_De,b8=dI,ADe=EDe(function(e,t){if(e==null)return[];var n=t.length;return n>1&&b8(e,t[0],t[1])?t=[]:n>2&&b8(t[0],t[1],t[2])&&(t=[t[0]]),TDe(e,SDe(t,1),[])}),PDe=ADe;const AF=lo(PDe);function Iw(e){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(e)}function PL(){return PL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PL.apply(this,arguments)}function CDe(e,t){return kDe(e)||ODe(e,t)||MDe(e,t)||IDe()}function IDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MDe(e,t){if(e){if(typeof e=="string")return w8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w8(e,t)}}function w8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ODe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function kDe(e){if(Array.isArray(e))return e}function S8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function tR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S8(Object(n),!0).forEach(function(r){RDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RDe(e,t,n){return t=DDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DDe(e){var t=LDe(e,"string");return Iw(t)=="symbol"?t:t+""}function LDe(e,t){if(Iw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Iw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zDe(e){return Array.isArray(e)&&us(e[0])&&us(e[1])?e.join(" ~ "):e}var NDe=function(t){var n=t.separator,r=n===void 0?" : ":n,a=t.contentStyle,c=a===void 0?{}:a,d=t.itemStyle,i=d===void 0?{}:d,_=t.labelStyle,b=_===void 0?{}:_,T=t.payload,A=t.formatter,k=t.itemSorter,R=t.wrapperClassName,B=t.labelClassName,N=t.label,V=t.labelFormatter,H=t.accessibilityLayer,G=H===void 0?!1:H,q=function(){if(T&&T.length){var Le={padding:0,margin:0},Ze=(k?AF(T,k):T).map(function(He,ct){if(He.type==="none")return null;var ot=tR({display:"block",paddingTop:4,paddingBottom:4,color:He.color||"#000"},i),rt=He.formatter||A||zDe,Be=He.value,nt=He.name,at=Be,Mt=nt;if(rt&&at!=null&&Mt!=null){var Nt=rt(Be,nt,He,ct,T);if(Array.isArray(Nt)){var rn=CDe(Nt,2);at=rn[0],Mt=rn[1]}else at=Nt}return Ce.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ct),style:ot},us(Mt)?Ce.createElement("span",{className:"recharts-tooltip-item-name"},Mt):null,us(Mt)?Ce.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,Ce.createElement("span",{className:"recharts-tooltip-item-value"},at),Ce.createElement("span",{className:"recharts-tooltip-item-unit"},He.unit||""))});return Ce.createElement("ul",{className:"recharts-tooltip-item-list",style:Le},Ze)}return null},Q=tR({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},c),te=tR({margin:0},b),ue=!Nr(N),fe=ue?N:"",ye=li("recharts-default-tooltip",R),De=li("recharts-tooltip-label",B);ue&&V&&T!==void 0&&T!==null&&(fe=V(N,T));var Ne=G?{role:"status","aria-live":"assertive"}:{};return Ce.createElement("div",PL({className:ye,style:Q},Ne),Ce.createElement("p",{className:De,style:te},Ce.isValidElement(fe)?fe:"".concat(fe)),q())};function Mw(e){"@babel/helpers - typeof";return Mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mw(e)}function r2(e,t,n){return t=FDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FDe(e){var t=BDe(e,"string");return Mw(t)=="symbol"?t:t+""}function BDe(e,t){if(Mw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Mw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H1="recharts-tooltip-wrapper",jDe={visibility:"hidden"};function $De(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return li(H1,r2(r2(r2(r2({},"".concat(H1,"-right"),zn(n)&&t&&zn(t.x)&&n>=t.x),"".concat(H1,"-left"),zn(n)&&t&&zn(t.x)&&n<t.x),"".concat(H1,"-bottom"),zn(r)&&t&&zn(t.y)&&r>=t.y),"".concat(H1,"-top"),zn(r)&&t&&zn(t.y)&&r<t.y))}function T8(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,c=e.position,d=e.reverseDirection,i=e.tooltipDimension,_=e.viewBox,b=e.viewBoxDimension;if(c&&zn(c[r]))return c[r];var T=n[r]-i-a,A=n[r]+a;if(t[r])return d[r]?T:A;if(d[r]){var k=T,R=_[r];return k<R?Math.max(A,_[r]):Math.max(T,_[r])}var B=A+i,N=_[r]+b;return B>N?Math.max(T,_[r]):Math.max(A,_[r])}function UDe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function VDe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,c=e.reverseDirection,d=e.tooltipBox,i=e.useTranslate3d,_=e.viewBox,b,T,A;return d.height>0&&d.width>0&&n?(T=T8({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:c,tooltipDimension:d.width,viewBox:_,viewBoxDimension:_.width}),A=T8({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:c,tooltipDimension:d.height,viewBox:_,viewBoxDimension:_.height}),b=UDe({translateX:T,translateY:A,useTranslate3d:i})):b=jDe,{cssProperties:b,cssClasses:$De({translateX:T,translateY:A,coordinate:n})}}function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function E8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function A8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E8(Object(n),!0).forEach(function(r){IL(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GDe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kQ(r.key),r)}}function HDe(e,t,n){return t&&GDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qDe(e,t,n){return t=XA(t),ZDe(e,OQ()?Reflect.construct(t,n||[],XA(e).constructor):t.apply(e,n))}function ZDe(e,t){if(t&&(r0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XDe(e)}function XDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OQ=function(){return!!e})()}function XA(e){return XA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XA(e)}function KDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CL(e,t)}function CL(e,t){return CL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},CL(e,t)}function IL(e,t,n){return t=kQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kQ(e){var t=YDe(e,"string");return r0(t)=="symbol"?t:t+""}function YDe(e,t){if(r0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(r0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P8=1,JDe=function(e){function t(){var n;WDe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=qDe(this,t,[].concat(a)),IL(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),IL(n,"handleKeyDown",function(d){if(d.key==="Escape"){var i,_,b,T;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(_=n.props.coordinate)===null||_===void 0?void 0:_.x)!==null&&i!==void 0?i:0,y:(b=(T=n.props.coordinate)===null||T===void 0?void 0:T.y)!==null&&b!==void 0?b:0}})}}),n}return KDe(t,e),HDe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>P8||Math.abs(r.height-this.state.lastBoundingBox.height)>P8)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,a=this.props,c=a.active,d=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.children,T=a.coordinate,A=a.hasPayload,k=a.isAnimationActive,R=a.offset,B=a.position,N=a.reverseDirection,V=a.useTranslate3d,H=a.viewBox,G=a.wrapperStyle,q=VDe({allowEscapeViewBox:d,coordinate:T,offsetTopLeft:R,position:B,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:V,viewBox:H}),Q=q.cssClasses,te=q.cssProperties,ue=A8(A8({transition:k&&c?"transform ".concat(i,"ms ").concat(_):void 0},te),{},{pointerEvents:"none",visibility:!this.state.dismissed&&c&&A?"visible":"hidden",position:"absolute",top:0,left:0},G);return Ce.createElement("div",{tabIndex:-1,className:Q,style:ue,ref:function(ye){r.wrapperNode=ye}},b)}}])}(X.PureComponent),QDe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},au={isSsr:QDe(),get:function(t){return au[t]},set:function(t,n){if(typeof t=="string")au[t]=n;else{var r=Object.keys(t);r&&r.length&&r.forEach(function(a){au[a]=t[a]})}}};function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function C8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function I8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C8(Object(n),!0).forEach(function(r){PF(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function eLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tLe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DQ(r.key),r)}}function nLe(e,t,n){return t&&tLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rLe(e,t,n){return t=KA(t),iLe(e,RQ()?Reflect.construct(t,n||[],KA(e).constructor):t.apply(e,n))}function iLe(e,t){if(t&&(i0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oLe(e)}function oLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RQ=function(){return!!e})()}function KA(e){return KA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},KA(e)}function aLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ML(e,t)}function ML(e,t){return ML=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},ML(e,t)}function PF(e,t,n){return t=DQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DQ(e){var t=sLe(e,"string");return i0(t)=="symbol"?t:t+""}function sLe(e,t){if(i0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(i0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lLe(e){return e.dataKey}function cLe(e,t){return Ce.isValidElement(e)?Ce.cloneElement(e,t):typeof e=="function"?Ce.createElement(e,t):Ce.createElement(NDe,t)}var Kd=function(e){function t(){return eLe(this,t),rLe(this,t,arguments)}return aLe(t,e),nLe(t,[{key:"render",value:function(){var r=this,a=this.props,c=a.active,d=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.content,T=a.coordinate,A=a.filterNull,k=a.isAnimationActive,R=a.offset,B=a.payload,N=a.payloadUniqBy,V=a.position,H=a.reverseDirection,G=a.useTranslate3d,q=a.viewBox,Q=a.wrapperStyle,te=B??[];A&&te.length&&(te=SQ(B.filter(function(fe){return fe.value!=null&&(fe.hide!==!0||r.props.includeHidden)}),N,lLe));var ue=te.length>0;return Ce.createElement(JDe,{allowEscapeViewBox:d,animationDuration:i,animationEasing:_,isAnimationActive:k,active:c,coordinate:T,hasPayload:ue,offset:R,position:V,reverseDirection:H,useTranslate3d:G,viewBox:q,wrapperStyle:Q},cLe(b,I8(I8({},this.props),{},{payload:te})))}}])}(X.PureComponent);PF(Kd,"displayName","Tooltip");PF(Kd,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!au.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var uLe=sd,hLe=function(){return uLe.Date.now()},dLe=hLe,fLe=/\s/;function pLe(e){for(var t=e.length;t--&&fLe.test(e.charAt(t)););return t}var mLe=pLe,gLe=mLe,_Le=/^\s+/;function yLe(e){return e&&e.slice(0,gLe(e)+1).replace(_Le,"")}var vLe=yLe,xLe=vLe,M8=Tm,bLe=q0,O8=NaN,wLe=/^[-+]0x[0-9a-f]+$/i,SLe=/^0b[01]+$/i,TLe=/^0o[0-7]+$/i,ELe=parseInt;function ALe(e){if(typeof e=="number")return e;if(bLe(e))return O8;if(M8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=xLe(e);var n=SLe.test(e);return n||TLe.test(e)?ELe(e.slice(2),n?2:8):wLe.test(e)?O8:+e}var LQ=ALe,PLe=Tm,nR=dLe,k8=LQ,CLe="Expected a function",ILe=Math.max,MLe=Math.min;function OLe(e,t,n){var r,a,c,d,i,_,b=0,T=!1,A=!1,k=!0;if(typeof e!="function")throw new TypeError(CLe);t=k8(t)||0,PLe(n)&&(T=!!n.leading,A="maxWait"in n,c=A?ILe(k8(n.maxWait)||0,t):c,k="trailing"in n?!!n.trailing:k);function R(ue){var fe=r,ye=a;return r=a=void 0,b=ue,d=e.apply(ye,fe),d}function B(ue){return b=ue,i=setTimeout(H,t),T?R(ue):d}function N(ue){var fe=ue-_,ye=ue-b,De=t-fe;return A?MLe(De,c-ye):De}function V(ue){var fe=ue-_,ye=ue-b;return _===void 0||fe>=t||fe<0||A&&ye>=c}function H(){var ue=nR();if(V(ue))return G(ue);i=setTimeout(H,N(ue))}function G(ue){return i=void 0,k&&r?R(ue):(r=a=void 0,d)}function q(){i!==void 0&&clearTimeout(i),b=0,r=_=a=i=void 0}function Q(){return i===void 0?d:G(nR())}function te(){var ue=nR(),fe=V(ue);if(r=arguments,a=this,_=ue,fe){if(i===void 0)return B(_);if(A)return clearTimeout(i),i=setTimeout(H,t),R(_)}return i===void 0&&(i=setTimeout(H,t)),d}return te.cancel=q,te.flush=Q,te}var kLe=OLe,RLe=kLe,DLe=Tm,LLe="Expected a function";function zLe(e,t,n){var r=!0,a=!0;if(typeof e!="function")throw new TypeError(LLe);return DLe(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),RLe(e,t,{leading:r,maxWait:t,trailing:a})}var NLe=zLe;const zQ=lo(NLe);function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function R8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function i2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R8(Object(n),!0).forEach(function(r){FLe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function FLe(e,t,n){return t=BLe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BLe(e){var t=jLe(e,"string");return Ow(t)=="symbol"?t:t+""}function jLe(e,t){if(Ow(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ow(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Le(e,t){return GLe(e)||WLe(e,t)||VLe(e,t)||ULe()}function ULe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VLe(e,t){if(e){if(typeof e=="string")return D8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D8(e,t)}}function D8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function WLe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function GLe(e){if(Array.isArray(e))return e}var sQe=X.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,c=e.width,d=c===void 0?"100%":c,i=e.height,_=i===void 0?"100%":i,b=e.minWidth,T=b===void 0?0:b,A=e.minHeight,k=e.maxHeight,R=e.children,B=e.debounce,N=B===void 0?0:B,V=e.id,H=e.className,G=e.onResize,q=e.style,Q=q===void 0?{}:q,te=X.useRef(null),ue=X.useRef();ue.current=G,X.useImperativeHandle(t,function(){return Object.defineProperty(te.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),te.current},configurable:!0})});var fe=X.useState({containerWidth:a.width,containerHeight:a.height}),ye=$Le(fe,2),De=ye[0],Ne=ye[1],Fe=X.useCallback(function(Ze,He){Ne(function(ct){var ot=Math.round(Ze),rt=Math.round(He);return ct.containerWidth===ot&&ct.containerHeight===rt?ct:{containerWidth:ot,containerHeight:rt}})},[]);X.useEffect(function(){var Ze=function(nt){var at,Mt=nt[0].contentRect,Nt=Mt.width,rn=Mt.height;Fe(Nt,rn),(at=ue.current)===null||at===void 0||at.call(ue,Nt,rn)};N>0&&(Ze=zQ(Ze,N,{trailing:!0,leading:!1}));var He=new ResizeObserver(Ze),ct=te.current.getBoundingClientRect(),ot=ct.width,rt=ct.height;return Fe(ot,rt),He.observe(te.current),function(){He.disconnect()}},[Fe,N]);var Le=X.useMemo(function(){var Ze=De.containerWidth,He=De.containerHeight;if(Ze<0||He<0)return null;rh(Ug(d)||Ug(_),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,_),rh(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ct=Ug(d)?Ze:d,ot=Ug(_)?He:_;n&&n>0&&(ct?ot=ct/n:ot&&(ct=ot*n),k&&ot>k&&(ot=k)),rh(ct>0||ot>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ct,ot,d,_,T,A,n);var rt=!Array.isArray(R)&&sf(R.type).endsWith("Chart");return Ce.Children.map(R,function(Be){return kJ.isElement(Be)?X.cloneElement(Be,i2({width:ct,height:ot},rt?{style:i2({height:"100%",width:"100%",maxHeight:ot,maxWidth:ct},Be.props.style)}:{})):Be})},[n,R,_,k,A,T,De,d]);return Ce.createElement("div",{id:V?"".concat(V):void 0,className:li("recharts-responsive-container",H),style:i2(i2({},Q),{},{width:d,height:_,minWidth:T,minHeight:A,maxHeight:k}),ref:te},Le)}),fI=function(t){return null};fI.displayName="Cell";function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function L8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function OL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L8(Object(n),!0).forEach(function(r){HLe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function HLe(e,t,n){return t=qLe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qLe(e){var t=ZLe(e,"string");return kw(t)=="symbol"?t:t+""}function ZLe(e,t){if(kw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(kw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ky={widthCache:{},cacheCount:0},XLe=2e3,KLe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},z8="recharts_measurement_span";function YLe(e){var t=OL({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var kb=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||au.isSsr)return{width:0,height:0};var r=YLe(n),a=JSON.stringify({text:t,copyStyle:r});if(Ky.widthCache[a])return Ky.widthCache[a];try{var c=document.getElementById(z8);c||(c=document.createElement("span"),c.setAttribute("id",z8),c.setAttribute("aria-hidden","true"),document.body.appendChild(c));var d=OL(OL({},KLe),r);Object.assign(c.style,d),c.textContent="".concat(t);var i=c.getBoundingClientRect(),_={width:i.width,height:i.height};return Ky.widthCache[a]=_,++Ky.cacheCount>XLe&&(Ky.cacheCount=0,Ky.widthCache={}),_}catch{return{width:0,height:0}}},JLe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function YA(e,t){return nze(e)||tze(e,t)||eze(e,t)||QLe()}function QLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eze(e,t){if(e){if(typeof e=="string")return N8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N8(e,t)}}function N8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tze(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;_=!1}else for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function nze(e){if(Array.isArray(e))return e}function rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oze(r.key),r)}}function ize(e,t,n){return t&&F8(e.prototype,t),n&&F8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oze(e){var t=aze(e,"string");return Rw(t)=="symbol"?t:t+""}function aze(e,t){if(Rw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Rw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var B8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,j8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sze=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,lze=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,NQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},cze=Object.keys(NQ),gv="NaN";function uze(e,t){return e*NQ[t]}var o2=function(){function e(t,n){rze(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!sze.test(n)&&(this.num=NaN,this.unit=""),cze.includes(n)&&(this.num=uze(t,n),this.unit="px")}return ize(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,a=(r=lze.exec(n))!==null&&r!==void 0?r:[],c=YA(a,3),d=c[1],i=c[2];return new e(parseFloat(d),i??"")}}])}();function FQ(e){if(e.includes(gv))return gv;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=B8.exec(t))!==null&&n!==void 0?n:[],a=YA(r,4),c=a[1],d=a[2],i=a[3],_=o2.parse(c??""),b=o2.parse(i??""),T=d==="*"?_.multiply(b):_.divide(b);if(T.isNaN())return gv;t=t.replace(B8,T.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var A,k=(A=j8.exec(t))!==null&&A!==void 0?A:[],R=YA(k,4),B=R[1],N=R[2],V=R[3],H=o2.parse(B??""),G=o2.parse(V??""),q=N==="+"?H.add(G):H.subtract(G);if(q.isNaN())return gv;t=t.replace(j8,q.toString())}return t}var $8=/\(([^()]*)\)/;function hze(e){for(var t=e;t.includes("(");){var n=$8.exec(t),r=YA(n,2),a=r[1];t=t.replace($8,FQ(a))}return t}function dze(e){var t=e.replace(/\s+/g,"");return t=hze(t),t=FQ(t),t}function fze(e){try{return dze(e)}catch{return gv}}function rR(e){var t=fze(e.slice(5,-1));return t===gv?"":t}var pze=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],mze=["dx","dy","angle","className","breakAll"];function kL(){return kL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kL.apply(this,arguments)}function U8(e,t){if(e==null)return{};var n=gze(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gze(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function V8(e,t){return xze(e)||vze(e,t)||yze(e,t)||_ze()}function _ze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yze(e,t){if(e){if(typeof e=="string")return W8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W8(e,t)}}function W8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vze(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;_=!1}else for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function xze(e){if(Array.isArray(e))return e}var BQ=/[ \f\n\r\t\v\u2028\u2029]+/,jQ=function(t){var n=t.children,r=t.breakAll,a=t.style;try{var c=[];Nr(n)||(r?c=n.toString().split(""):c=n.toString().split(BQ));var d=c.map(function(_){return{word:_,width:kb(_,a).width}}),i=r?0:kb("",a).width;return{wordsWithComputedWidth:d,spaceWidth:i}}catch{return null}},bze=function(t,n,r,a,c){var d=t.maxLines,i=t.children,_=t.style,b=t.breakAll,T=zn(d),A=i,k=function(){var ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ct.reduce(function(ot,rt){var Be=rt.word,nt=rt.width,at=ot[ot.length-1];if(at&&(a==null||c||at.width+nt+r<Number(a)))at.words.push(Be),at.width+=nt+r;else{var Mt={words:[Be],width:nt};ot.push(Mt)}return ot},[])},R=k(n),B=function(ct){return ct.reduce(function(ot,rt){return ot.width>rt.width?ot:rt})};if(!T)return R;for(var N="",V=function(ct){var ot=A.slice(0,ct),rt=jQ({breakAll:b,style:_,children:ot+N}).wordsWithComputedWidth,Be=k(rt),nt=Be.length>d||B(Be).width>Number(a);return[nt,Be]},H=0,G=A.length-1,q=0,Q;H<=G&&q<=A.length-1;){var te=Math.floor((H+G)/2),ue=te-1,fe=V(ue),ye=V8(fe,2),De=ye[0],Ne=ye[1],Fe=V(te),Le=V8(Fe,1),Ze=Le[0];if(!De&&!Ze&&(H=te+1),De&&Ze&&(G=te-1),!De&&Ze){Q=Ne;break}q++}return Q||R},G8=function(t){var n=Nr(t)?[]:t.toString().split(BQ);return[{words:n}]},wze=function(t){var n=t.width,r=t.scaleToFit,a=t.children,c=t.style,d=t.breakAll,i=t.maxLines;if((n||r)&&!au.isSsr){var _,b,T=jQ({breakAll:d,children:a,style:c});if(T){var A=T.wordsWithComputedWidth,k=T.spaceWidth;_=A,b=k}else return G8(a);return bze({breakAll:d,children:a,maxLines:i,style:c},_,b,n,r)}return G8(a)},H8="#808080",u_=function(t){var n=t.x,r=n===void 0?0:n,a=t.y,c=a===void 0?0:a,d=t.lineHeight,i=d===void 0?"1em":d,_=t.capHeight,b=_===void 0?"0.71em":_,T=t.scaleToFit,A=T===void 0?!1:T,k=t.textAnchor,R=k===void 0?"start":k,B=t.verticalAnchor,N=B===void 0?"end":B,V=t.fill,H=V===void 0?H8:V,G=U8(t,pze),q=X.useMemo(function(){return wze({breakAll:G.breakAll,children:G.children,maxLines:G.maxLines,scaleToFit:A,style:G.style,width:G.width})},[G.breakAll,G.children,G.maxLines,A,G.style,G.width]),Q=G.dx,te=G.dy,ue=G.angle,fe=G.className,ye=G.breakAll,De=U8(G,mze);if(!us(r)||!us(c))return null;var Ne=r+(zn(Q)?Q:0),Fe=c+(zn(te)?te:0),Le;switch(N){case"start":Le=rR("calc(".concat(b,")"));break;case"middle":Le=rR("calc(".concat((q.length-1)/2," * -").concat(i," + (").concat(b," / 2))"));break;default:Le=rR("calc(".concat(q.length-1," * -").concat(i,")"));break}var Ze=[];if(A){var He=q[0].width,ct=G.width;Ze.push("scale(".concat((zn(ct)?ct/He:1)/He,")"))}return ue&&Ze.push("rotate(".concat(ue,", ").concat(Ne,", ").concat(Fe,")")),Ze.length&&(De.transform=Ze.join(" ")),Ce.createElement("text",kL({},wr(De,!0),{x:Ne,y:Fe,className:li("recharts-text",fe),textAnchor:R,fill:H.includes("url")?H8:H}),q.map(function(ot,rt){var Be=ot.words.join(ye?"":" ");return Ce.createElement("tspan",{x:Ne,dy:rt===0?Le:i,key:"".concat(Be,"-").concat(rt)},Be)}))};function Qp(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Sze(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function CF(e){let t,n,r;e.length!==2?(t=Qp,n=(i,_)=>Qp(e(i),_),r=(i,_)=>e(i)-_):(t=e===Qp||e===Sze?e:Tze,n=e,r=e);function a(i,_,b=0,T=i.length){if(b<T){if(t(_,_)!==0)return T;do{const A=b+T>>>1;n(i[A],_)<0?b=A+1:T=A}while(b<T)}return b}function c(i,_,b=0,T=i.length){if(b<T){if(t(_,_)!==0)return T;do{const A=b+T>>>1;n(i[A],_)<=0?b=A+1:T=A}while(b<T)}return b}function d(i,_,b=0,T=i.length){const A=a(i,_,b,T-1);return A>b&&r(i[A-1],_)>-r(i[A],_)?A-1:A}return{left:a,center:d,right:c}}function Tze(){return 0}function $Q(e){return e===null?NaN:+e}function*Eze(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Aze=CF(Qp),BS=Aze.right;CF($Q).center;function lQe(e,t){let n,r;if(t===void 0)for(const a of e)a!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)));else{let a=-1;for(let c of e)(c=t(c,++a,e))!=null&&(n===void 0?c>=c&&(n=r=c):(n>c&&(n=c),r<c&&(r=c)))}return[n,r]}class q8 extends Map{constructor(t,n=Ize){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(Z8(this,t))}has(t){return super.has(Z8(this,t))}set(t,n){return super.set(Pze(this,t),n)}delete(t){return super.delete(Cze(this,t))}}function Z8({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Pze({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Cze({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Ize(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Mze(e=Qp){if(e===Qp)return UQ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function UQ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Oze=Math.sqrt(50),kze=Math.sqrt(10),Rze=Math.sqrt(2);function JA(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),c=r/Math.pow(10,a),d=c>=Oze?10:c>=kze?5:c>=Rze?2:1;let i,_,b;return a<0?(b=Math.pow(10,-a)/d,i=Math.round(e*b),_=Math.round(t*b),i/b<e&&++i,_/b>t&&--_,b=-b):(b=Math.pow(10,a)*d,i=Math.round(e/b),_=Math.round(t/b),i*b<e&&++i,_*b>t&&--_),_<i&&.5<=n&&n<2?JA(e,t,n*2):[i,_,b]}function RL(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,c,d]=r?JA(t,e,n):JA(e,t,n);if(!(c>=a))return[];const i=c-a+1,_=new Array(i);if(r)if(d<0)for(let b=0;b<i;++b)_[b]=(c-b)/-d;else for(let b=0;b<i;++b)_[b]=(c-b)*d;else if(d<0)for(let b=0;b<i;++b)_[b]=(a+b)/-d;else for(let b=0;b<i;++b)_[b]=(a+b)*d;return _}function DL(e,t,n){return t=+t,e=+e,n=+n,JA(e,t,n)[2]}function LL(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?DL(t,e,n):DL(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function X8(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of e)(a=t(a,++r,e))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function K8(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function VQ(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?UQ:Mze(a);r>n;){if(r-n>600){const _=r-n+1,b=t-n+1,T=Math.log(_),A=.5*Math.exp(2*T/3),k=.5*Math.sqrt(T*A*(_-A)/_)*(b-_/2<0?-1:1),R=Math.max(n,Math.floor(t-b*A/_+k)),B=Math.min(r,Math.floor(t+(_-b)*A/_+k));VQ(e,t,R,B,a)}const c=e[t];let d=n,i=r;for(q1(e,n,t),a(e[r],c)>0&&q1(e,n,r);d<i;){for(q1(e,d,i),++d,--i;a(e[d],c)<0;)++d;for(;a(e[i],c)>0;)--i}a(e[n],c)===0?q1(e,n,i):(++i,q1(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}return e}function q1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Dze(e,t,n){if(e=Float64Array.from(Eze(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return K8(e);if(t>=1)return X8(e);var r,a=(r-1)*t,c=Math.floor(a),d=X8(VQ(e,c).subarray(0,c+1)),i=K8(e.subarray(c+1));return d+(i-d)*(a-c)}}function Lze(e,t,n=$Q){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,c=Math.floor(a),d=+n(e[c],c,e),i=+n(e[c+1],c+1,e);return d+(i-d)*(a-c)}}function zze(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,c=new Array(a);++r<a;)c[r]=e+r*n;return c}function pu(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Tf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const zL=Symbol("implicit");function IF(){var e=new q8,t=[],n=[],r=zL;function a(c){let d=e.get(c);if(d===void 0){if(r!==zL)return r;e.set(c,d=t.push(c)-1)}return n[d%n.length]}return a.domain=function(c){if(!arguments.length)return t.slice();t=[],e=new q8;for(const d of c)e.has(d)||e.set(d,t.push(d)-1);return a},a.range=function(c){return arguments.length?(n=Array.from(c),a):n.slice()},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return IF(t,n).unknown(r)},pu.apply(a,arguments),a}function Dw(){var e=IF().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,c,d,i=!1,_=0,b=0,T=.5;delete e.unknown;function A(){var k=t().length,R=a<r,B=R?a:r,N=R?r:a;c=(N-B)/Math.max(1,k-_+b*2),i&&(c=Math.floor(c)),B+=(N-B-c*(k-_))*T,d=c*(1-_),i&&(B=Math.round(B),d=Math.round(d));var V=zze(k).map(function(H){return B+c*H});return n(R?V.reverse():V)}return e.domain=function(k){return arguments.length?(t(k),A()):t()},e.range=function(k){return arguments.length?([r,a]=k,r=+r,a=+a,A()):[r,a]},e.rangeRound=function(k){return[r,a]=k,r=+r,a=+a,i=!0,A()},e.bandwidth=function(){return d},e.step=function(){return c},e.round=function(k){return arguments.length?(i=!!k,A()):i},e.padding=function(k){return arguments.length?(_=Math.min(1,b=+k),A()):_},e.paddingInner=function(k){return arguments.length?(_=Math.min(1,k),A()):_},e.paddingOuter=function(k){return arguments.length?(b=+k,A()):b},e.align=function(k){return arguments.length?(T=Math.max(0,Math.min(1,k)),A()):T},e.copy=function(){return Dw(t(),[r,a]).round(i).paddingInner(_).paddingOuter(b).align(T)},pu.apply(A(),arguments)}function WQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return WQ(t())},e}function Rb(){return WQ(Dw.apply(null,arguments).paddingInner(1))}function MF(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function GQ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function jS(){}var Lw=.7,QA=1/Lw,kv="\\s*([+-]?\\d+)\\s*",zw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nze=/^#([0-9a-f]{3,8})$/,Fze=new RegExp(`^rgb\\(${kv},${kv},${kv}\\)$`),Bze=new RegExp(`^rgb\\(${Jh},${Jh},${Jh}\\)$`),jze=new RegExp(`^rgba\\(${kv},${kv},${kv},${zw}\\)$`),$ze=new RegExp(`^rgba\\(${Jh},${Jh},${Jh},${zw}\\)$`),Uze=new RegExp(`^hsl\\(${zw},${Jh},${Jh}\\)$`),Vze=new RegExp(`^hsla\\(${zw},${Jh},${Jh},${zw}\\)$`),Y8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};MF(jS,h_,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J8,formatHex:J8,formatHex8:Wze,formatHsl:Gze,formatRgb:Q8,toString:Q8});function J8(){return this.rgb().formatHex()}function Wze(){return this.rgb().formatHex8()}function Gze(){return HQ(this).formatHsl()}function Q8(){return this.rgb().formatRgb()}function h_(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Nze.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?eW(t):n===3?new Kl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?a2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?a2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Fze.exec(e))?new Kl(t[1],t[2],t[3],1):(t=Bze.exec(e))?new Kl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jze.exec(e))?a2(t[1],t[2],t[3],t[4]):(t=$ze.exec(e))?a2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Uze.exec(e))?rW(t[1],t[2]/100,t[3]/100,1):(t=Vze.exec(e))?rW(t[1],t[2]/100,t[3]/100,t[4]):Y8.hasOwnProperty(e)?eW(Y8[e]):e==="transparent"?new Kl(NaN,NaN,NaN,0):null}function eW(e){return new Kl(e>>16&255,e>>8&255,e&255,1)}function a2(e,t,n,r){return r<=0&&(e=t=n=NaN),new Kl(e,t,n,r)}function Hze(e){return e instanceof jS||(e=h_(e)),e?(e=e.rgb(),new Kl(e.r,e.g,e.b,e.opacity)):new Kl}function NL(e,t,n,r){return arguments.length===1?Hze(e):new Kl(e,t,n,r??1)}function Kl(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}MF(Kl,NL,GQ(jS,{brighter(e){return e=e==null?QA:Math.pow(QA,e),new Kl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Lw:Math.pow(Lw,e),new Kl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kl(Kg(this.r),Kg(this.g),Kg(this.b),eP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tW,formatHex:tW,formatHex8:qze,formatRgb:nW,toString:nW}));function tW(){return`#${Vg(this.r)}${Vg(this.g)}${Vg(this.b)}`}function qze(){return`#${Vg(this.r)}${Vg(this.g)}${Vg(this.b)}${Vg((isNaN(this.opacity)?1:this.opacity)*255)}`}function nW(){const e=eP(this.opacity);return`${e===1?"rgb(":"rgba("}${Kg(this.r)}, ${Kg(this.g)}, ${Kg(this.b)}${e===1?")":`, ${e})`}`}function eP(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Kg(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vg(e){return e=Kg(e),(e<16?"0":"")+e.toString(16)}function rW(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ju(e,t,n,r)}function HQ(e){if(e instanceof Ju)return new Ju(e.h,e.s,e.l,e.opacity);if(e instanceof jS||(e=h_(e)),!e)return new Ju;if(e instanceof Ju)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),c=Math.max(t,n,r),d=NaN,i=c-a,_=(c+a)/2;return i?(t===c?d=(n-r)/i+(n<r)*6:n===c?d=(r-t)/i+2:d=(t-n)/i+4,i/=_<.5?c+a:2-c-a,d*=60):i=_>0&&_<1?0:d,new Ju(d,i,_,e.opacity)}function Zze(e,t,n,r){return arguments.length===1?HQ(e):new Ju(e,t,n,r??1)}function Ju(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}MF(Ju,Zze,GQ(jS,{brighter(e){return e=e==null?QA:Math.pow(QA,e),new Ju(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Lw:Math.pow(Lw,e),new Ju(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Kl(iR(e>=240?e-240:e+120,a,r),iR(e,a,r),iR(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Ju(iW(this.h),s2(this.s),s2(this.l),eP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=eP(this.opacity);return`${e===1?"hsl(":"hsla("}${iW(this.h)}, ${s2(this.s)*100}%, ${s2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iW(e){return e=(e||0)%360,e<0?e+360:e}function s2(e){return Math.max(0,Math.min(1,e||0))}function iR(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const OF=e=>()=>e;function Xze(e,t){return function(n){return e+n*t}}function Kze(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Yze(e){return(e=+e)==1?qQ:function(t,n){return n-t?Kze(t,n,e):OF(isNaN(t)?n:t)}}function qQ(e,t){var n=t-e;return n?Xze(e,n):OF(isNaN(e)?t:e)}const tP=function e(t){var n=Yze(t);function r(a,c){var d=n((a=NL(a)).r,(c=NL(c)).r),i=n(a.g,c.g),_=n(a.b,c.b),b=qQ(a.opacity,c.opacity);return function(T){return a.r=d(T),a.g=i(T),a.b=_(T),a.opacity=b(T),a+""}}return r.gamma=e,r}(1);function Jze(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(c){for(a=0;a<n;++a)r[a]=e[a]*(1-c)+t[a]*c;return r}}function Qze(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function e3e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),c=new Array(n),d;for(d=0;d<r;++d)a[d]=nx(e[d],t[d]);for(;d<n;++d)c[d]=t[d];return function(i){for(d=0;d<r;++d)c[d]=a[d](i);return c}}function t3e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ku(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function n3e(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=nx(e[a],t[a]):r[a]=t[a];return function(c){for(a in n)r[a]=n[a](c);return r}}var FL=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oR=new RegExp(FL.source,"g");function r3e(e){return function(){return e}}function i3e(e){return function(t){return e(t)+""}}function ZQ(e,t){var n=FL.lastIndex=oR.lastIndex=0,r,a,c,d=-1,i=[],_=[];for(e=e+"",t=t+"";(r=FL.exec(e))&&(a=oR.exec(t));)(c=a.index)>n&&(c=t.slice(n,c),i[d]?i[d]+=c:i[++d]=c),(r=r[0])===(a=a[0])?i[d]?i[d]+=a:i[++d]=a:(i[++d]=null,_.push({i:d,x:Ku(r,a)})),n=oR.lastIndex;return n<t.length&&(c=t.slice(n),i[d]?i[d]+=c:i[++d]=c),i.length<2?_[0]?i3e(_[0].x):r3e(t):(t=_.length,function(b){for(var T=0,A;T<t;++T)i[(A=_[T]).i]=A.x(b);return i.join("")})}function nx(e,t){var n=typeof t,r;return t==null||n==="boolean"?OF(t):(n==="number"?Ku:n==="string"?(r=h_(t))?(t=r,tP):ZQ:t instanceof h_?tP:t instanceof Date?t3e:Qze(t)?Jze:Array.isArray(t)?e3e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?n3e:Ku)(e,t)}function kF(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var oW=180/Math.PI,BL={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function XQ(e,t,n,r,a,c){var d,i,_;return(d=Math.sqrt(e*e+t*t))&&(e/=d,t/=d),(_=e*n+t*r)&&(n-=e*_,r-=t*_),(i=Math.sqrt(n*n+r*r))&&(n/=i,r/=i,_/=i),e*r<t*n&&(e=-e,t=-t,_=-_,d=-d),{translateX:a,translateY:c,rotate:Math.atan2(t,e)*oW,skewX:Math.atan(_)*oW,scaleX:d,scaleY:i}}var l2;function o3e(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?BL:XQ(t.a,t.b,t.c,t.d,t.e,t.f)}function a3e(e){return e==null||(l2||(l2=document.createElementNS("http://www.w3.org/2000/svg","g")),l2.setAttribute("transform",e),!(e=l2.transform.baseVal.consolidate()))?BL:(e=e.matrix,XQ(e.a,e.b,e.c,e.d,e.e,e.f))}function KQ(e,t,n,r){function a(b){return b.length?b.pop()+" ":""}function c(b,T,A,k,R,B){if(b!==A||T!==k){var N=R.push("translate(",null,t,null,n);B.push({i:N-4,x:Ku(b,A)},{i:N-2,x:Ku(T,k)})}else(A||k)&&R.push("translate("+A+t+k+n)}function d(b,T,A,k){b!==T?(b-T>180?T+=360:T-b>180&&(b+=360),k.push({i:A.push(a(A)+"rotate(",null,r)-2,x:Ku(b,T)})):T&&A.push(a(A)+"rotate("+T+r)}function i(b,T,A,k){b!==T?k.push({i:A.push(a(A)+"skewX(",null,r)-2,x:Ku(b,T)}):T&&A.push(a(A)+"skewX("+T+r)}function _(b,T,A,k,R,B){if(b!==A||T!==k){var N=R.push(a(R)+"scale(",null,",",null,")");B.push({i:N-4,x:Ku(b,A)},{i:N-2,x:Ku(T,k)})}else(A!==1||k!==1)&&R.push(a(R)+"scale("+A+","+k+")")}return function(b,T){var A=[],k=[];return b=e(b),T=e(T),c(b.translateX,b.translateY,T.translateX,T.translateY,A,k),d(b.rotate,T.rotate,A,k),i(b.skewX,T.skewX,A,k),_(b.scaleX,b.scaleY,T.scaleX,T.scaleY,A,k),b=T=null,function(R){for(var B=-1,N=k.length,V;++B<N;)A[(V=k[B]).i]=V.x(R);return A.join("")}}}var s3e=KQ(o3e,"px, ","px)","deg)"),l3e=KQ(a3e,", ",")",")");function c3e(e,t){t===void 0&&(t=e,e=nx);for(var n=0,r=t.length-1,a=t[0],c=new Array(r<0?0:r);n<r;)c[n]=e(a,a=t[++n]);return function(d){var i=Math.max(0,Math.min(r-1,Math.floor(d*=r)));return c[i](d-i)}}function u3e(e){return function(){return e}}function nP(e){return+e}var aW=[0,1];function vl(e){return e}function jL(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:u3e(isNaN(t)?NaN:.5)}function h3e(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function d3e(e,t,n){var r=e[0],a=e[1],c=t[0],d=t[1];return a<r?(r=jL(a,r),c=n(d,c)):(r=jL(r,a),c=n(c,d)),function(i){return c(r(i))}}function f3e(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),c=new Array(r),d=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<r;)a[d]=jL(e[d],e[d+1]),c[d]=n(t[d],t[d+1]);return function(i){var _=BS(e,i,1,r)-1;return c[_](a[_](i))}}function $S(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pI(){var e=aW,t=aW,n=nx,r,a,c,d=vl,i,_,b;function T(){var k=Math.min(e.length,t.length);return d!==vl&&(d=h3e(e[0],e[k-1])),i=k>2?f3e:d3e,_=b=null,A}function A(k){return k==null||isNaN(k=+k)?c:(_||(_=i(e.map(r),t,n)))(r(d(k)))}return A.invert=function(k){return d(a((b||(b=i(t,e.map(r),Ku)))(k)))},A.domain=function(k){return arguments.length?(e=Array.from(k,nP),T()):e.slice()},A.range=function(k){return arguments.length?(t=Array.from(k),T()):t.slice()},A.rangeRound=function(k){return t=Array.from(k),n=kF,T()},A.clamp=function(k){return arguments.length?(d=k?!0:vl,T()):d!==vl},A.interpolate=function(k){return arguments.length?(n=k,T()):n},A.unknown=function(k){return arguments.length?(c=k,A):c},function(k,R){return r=k,a=R,T()}}function RF(){return pI()(vl,vl)}function p3e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function rP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function o0(e){return e=rP(Math.abs(e)),e?e[1]:NaN}function m3e(e,t){return function(n,r){for(var a=n.length,c=[],d=0,i=e[0],_=0;a>0&&i>0&&(_+i+1>r&&(i=Math.max(1,r-_)),c.push(n.substring(a-=i,a+i)),!((_+=i+1)>r));)i=e[d=(d+1)%e.length];return c.reverse().join(t)}}function g3e(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var _3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nw(e){if(!(t=_3e.exec(e)))throw new Error("invalid format: "+e);var t;return new DF({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Nw.prototype=DF.prototype;function DF(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}DF.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function y3e(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var YQ;function v3e(e,t){var n=rP(e,t);if(!n)return e+"";var r=n[0],a=n[1],c=a-(YQ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,d=r.length;return c===d?r:c>d?r+new Array(c-d+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+rP(e,Math.max(0,t+c-1))[0]}function sW(e,t){var n=rP(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const lW={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:p3e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>sW(e*100,t),r:sW,s:v3e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function cW(e){return e}var uW=Array.prototype.map,hW=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function x3e(e){var t=e.grouping===void 0||e.thousands===void 0?cW:m3e(uW.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",c=e.numerals===void 0?cW:g3e(uW.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",_=e.nan===void 0?"NaN":e.nan+"";function b(A){A=Nw(A);var k=A.fill,R=A.align,B=A.sign,N=A.symbol,V=A.zero,H=A.width,G=A.comma,q=A.precision,Q=A.trim,te=A.type;te==="n"?(G=!0,te="g"):lW[te]||(q===void 0&&(q=12),Q=!0,te="g"),(V||k==="0"&&R==="=")&&(V=!0,k="0",R="=");var ue=N==="$"?n:N==="#"&&/[boxX]/.test(te)?"0"+te.toLowerCase():"",fe=N==="$"?r:/[%p]/.test(te)?d:"",ye=lW[te],De=/[defgprs%]/.test(te);q=q===void 0?6:/[gprs]/.test(te)?Math.max(1,Math.min(21,q)):Math.max(0,Math.min(20,q));function Ne(Fe){var Le=ue,Ze=fe,He,ct,ot;if(te==="c")Ze=ye(Fe)+Ze,Fe="";else{Fe=+Fe;var rt=Fe<0||1/Fe<0;if(Fe=isNaN(Fe)?_:ye(Math.abs(Fe),q),Q&&(Fe=y3e(Fe)),rt&&+Fe==0&&B!=="+"&&(rt=!1),Le=(rt?B==="("?B:i:B==="-"||B==="("?"":B)+Le,Ze=(te==="s"?hW[8+YQ/3]:"")+Ze+(rt&&B==="("?")":""),De){for(He=-1,ct=Fe.length;++He<ct;)if(ot=Fe.charCodeAt(He),48>ot||ot>57){Ze=(ot===46?a+Fe.slice(He+1):Fe.slice(He))+Ze,Fe=Fe.slice(0,He);break}}}G&&!V&&(Fe=t(Fe,1/0));var Be=Le.length+Fe.length+Ze.length,nt=Be<H?new Array(H-Be+1).join(k):"";switch(G&&V&&(Fe=t(nt+Fe,nt.length?H-Ze.length:1/0),nt=""),R){case"<":Fe=Le+Fe+Ze+nt;break;case"=":Fe=Le+nt+Fe+Ze;break;case"^":Fe=nt.slice(0,Be=nt.length>>1)+Le+Fe+Ze+nt.slice(Be);break;default:Fe=nt+Le+Fe+Ze;break}return c(Fe)}return Ne.toString=function(){return A+""},Ne}function T(A,k){var R=b((A=Nw(A),A.type="f",A)),B=Math.max(-8,Math.min(8,Math.floor(o0(k)/3)))*3,N=Math.pow(10,-B),V=hW[8+B/3];return function(H){return R(N*H)+V}}return{format:b,formatPrefix:T}}var c2,LF,JQ;b3e({thousands:",",grouping:[3],currency:["$",""]});function b3e(e){return c2=x3e(e),LF=c2.format,JQ=c2.formatPrefix,c2}function w3e(e){return Math.max(0,-o0(Math.abs(e)))}function S3e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(o0(t)/3)))*3-o0(Math.abs(e)))}function T3e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,o0(t)-o0(e))+1}function QQ(e,t,n,r){var a=LL(e,t,n),c;switch(r=Nw(r??",f"),r.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(c=S3e(a,d))&&(r.precision=c),JQ(r,d)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(c=T3e(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=c-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(c=w3e(a))&&(r.precision=c-(r.type==="%")*2);break}}return LF(r)}function Am(e){var t=e.domain;return e.ticks=function(n){var r=t();return RL(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return QQ(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,c=r.length-1,d=r[a],i=r[c],_,b,T=10;for(i<d&&(b=d,d=i,i=b,b=a,a=c,c=b);T-- >0;){if(b=DL(d,i,n),b===_)return r[a]=d,r[c]=i,t(r);if(b>0)d=Math.floor(d/b)*b,i=Math.ceil(i/b)*b;else if(b<0)d=Math.ceil(d*b)/b,i=Math.floor(i*b)/b;else break;_=b}return e},e}function iP(){var e=RF();return e.copy=function(){return $S(e,iP())},pu.apply(e,arguments),Am(e)}function eee(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,nP),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return eee(e).unknown(t)},e=arguments.length?Array.from(e,nP):[0,1],Am(n)}function tee(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],c=e[r],d;return c<a&&(d=n,n=r,r=d,d=a,a=c,c=d),e[n]=t.floor(a),e[r]=t.ceil(c),e}function dW(e){return Math.log(e)}function fW(e){return Math.exp(e)}function E3e(e){return-Math.log(-e)}function A3e(e){return-Math.exp(-e)}function P3e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function C3e(e){return e===10?P3e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function I3e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function pW(e){return(t,n)=>-e(-t,n)}function zF(e){const t=e(dW,fW),n=t.domain;let r=10,a,c;function d(){return a=I3e(r),c=C3e(r),n()[0]<0?(a=pW(a),c=pW(c),e(E3e,A3e)):e(dW,fW),t}return t.base=function(i){return arguments.length?(r=+i,d()):r},t.domain=function(i){return arguments.length?(n(i),d()):n()},t.ticks=i=>{const _=n();let b=_[0],T=_[_.length-1];const A=T<b;A&&([b,T]=[T,b]);let k=a(b),R=a(T),B,N;const V=i==null?10:+i;let H=[];if(!(r%1)&&R-k<V){if(k=Math.floor(k),R=Math.ceil(R),b>0){for(;k<=R;++k)for(B=1;B<r;++B)if(N=k<0?B/c(-k):B*c(k),!(N<b)){if(N>T)break;H.push(N)}}else for(;k<=R;++k)for(B=r-1;B>=1;--B)if(N=k>0?B/c(-k):B*c(k),!(N<b)){if(N>T)break;H.push(N)}H.length*2<V&&(H=RL(b,T,V))}else H=RL(k,R,Math.min(R-k,V)).map(c);return A?H.reverse():H},t.tickFormat=(i,_)=>{if(i==null&&(i=10),_==null&&(_=r===10?"s":","),typeof _!="function"&&(!(r%1)&&(_=Nw(_)).precision==null&&(_.trim=!0),_=LF(_)),i===1/0)return _;const b=Math.max(1,r*i/t.ticks().length);return T=>{let A=T/c(Math.round(a(T)));return A*r<r-.5&&(A*=r),A<=b?_(T):""}},t.nice=()=>n(tee(n(),{floor:i=>c(Math.floor(a(i))),ceil:i=>c(Math.ceil(a(i)))})),t}function nee(){const e=zF(pI()).domain([1,10]);return e.copy=()=>$S(e,nee()).base(e.base()),pu.apply(e,arguments),e}function mW(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function gW(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function NF(e){var t=1,n=e(mW(t),gW(t));return n.constant=function(r){return arguments.length?e(mW(t=+r),gW(t)):t},Am(n)}function ree(){var e=NF(pI());return e.copy=function(){return $S(e,ree()).constant(e.constant())},pu.apply(e,arguments)}function _W(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function M3e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function O3e(e){return e<0?-e*e:e*e}function FF(e){var t=e(vl,vl),n=1;function r(){return n===1?e(vl,vl):n===.5?e(M3e,O3e):e(_W(n),_W(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Am(t)}function BF(){var e=FF(pI());return e.copy=function(){return $S(e,BF()).exponent(e.exponent())},pu.apply(e,arguments),e}function k3e(){return BF.apply(null,arguments).exponent(.5)}function yW(e){return Math.sign(e)*e*e}function R3e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function iee(){var e=RF(),t=[0,1],n=!1,r;function a(c){var d=R3e(e(c));return isNaN(d)?r:n?Math.round(d):d}return a.invert=function(c){return e.invert(yW(c))},a.domain=function(c){return arguments.length?(e.domain(c),a):e.domain()},a.range=function(c){return arguments.length?(e.range((t=Array.from(c,nP)).map(yW)),a):t.slice()},a.rangeRound=function(c){return a.range(c).round(!0)},a.round=function(c){return arguments.length?(n=!!c,a):n},a.clamp=function(c){return arguments.length?(e.clamp(c),a):e.clamp()},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return iee(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},pu.apply(a,arguments),Am(a)}function oee(){var e=[],t=[],n=[],r;function a(){var d=0,i=Math.max(1,t.length);for(n=new Array(i-1);++d<i;)n[d-1]=Lze(e,d/i);return c}function c(d){return d==null||isNaN(d=+d)?r:t[BS(n,d)]}return c.invertExtent=function(d){var i=t.indexOf(d);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},c.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let i of d)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Qp),a()},c.range=function(d){return arguments.length?(t=Array.from(d),a()):t.slice()},c.unknown=function(d){return arguments.length?(r=d,c):r},c.quantiles=function(){return n.slice()},c.copy=function(){return oee().domain(e).range(t).unknown(r)},pu.apply(c,arguments)}function aee(){var e=0,t=1,n=1,r=[.5],a=[0,1],c;function d(_){return _!=null&&_<=_?a[BS(r,_,0,n)]:c}function i(){var _=-1;for(r=new Array(n);++_<n;)r[_]=((_+1)*t-(_-n)*e)/(n+1);return d}return d.domain=function(_){return arguments.length?([e,t]=_,e=+e,t=+t,i()):[e,t]},d.range=function(_){return arguments.length?(n=(a=Array.from(_)).length-1,i()):a.slice()},d.invertExtent=function(_){var b=a.indexOf(_);return b<0?[NaN,NaN]:b<1?[e,r[0]]:b>=n?[r[n-1],t]:[r[b-1],r[b]]},d.unknown=function(_){return arguments.length&&(c=_),d},d.thresholds=function(){return r.slice()},d.copy=function(){return aee().domain([e,t]).range(a).unknown(c)},pu.apply(Am(d),arguments)}function see(){var e=[.5],t=[0,1],n,r=1;function a(c){return c!=null&&c<=c?t[BS(e,c,0,r)]:n}return a.domain=function(c){return arguments.length?(e=Array.from(c),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(c){return arguments.length?(t=Array.from(c),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(c){var d=t.indexOf(c);return[e[d-1],e[d]]},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return see().domain(e).range(t).unknown(n)},pu.apply(a,arguments)}const aR=new Date,sR=new Date;function hs(e,t,n,r){function a(c){return e(c=arguments.length===0?new Date:new Date(+c)),c}return a.floor=c=>(e(c=new Date(+c)),c),a.ceil=c=>(e(c=new Date(c-1)),t(c,1),e(c),c),a.round=c=>{const d=a(c),i=a.ceil(c);return c-d<i-c?d:i},a.offset=(c,d)=>(t(c=new Date(+c),d==null?1:Math.floor(d)),c),a.range=(c,d,i)=>{const _=[];if(c=a.ceil(c),i=i==null?1:Math.floor(i),!(c<d)||!(i>0))return _;let b;do _.push(b=new Date(+c)),t(c,i),e(c);while(b<c&&c<d);return _},a.filter=c=>hs(d=>{if(d>=d)for(;e(d),!c(d);)d.setTime(d-1)},(d,i)=>{if(d>=d)if(i<0)for(;++i<=0;)for(;t(d,-1),!c(d););else for(;--i>=0;)for(;t(d,1),!c(d););}),n&&(a.count=(c,d)=>(aR.setTime(+c),sR.setTime(+d),e(aR),e(sR),Math.floor(n(aR,sR))),a.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?a.filter(r?d=>r(d)%c===0:d=>a.count(0,d)%c===0):a)),a}const oP=hs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);oP.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?hs(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):oP);oP.range;const nf=1e3,ru=nf*60,rf=ru*60,gf=rf*24,jF=gf*7,vW=gf*30,lR=gf*365,Wg=hs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*nf)},(e,t)=>(t-e)/nf,e=>e.getUTCSeconds());Wg.range;const $F=hs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nf)},(e,t)=>{e.setTime(+e+t*ru)},(e,t)=>(t-e)/ru,e=>e.getMinutes());$F.range;const UF=hs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ru)},(e,t)=>(t-e)/ru,e=>e.getUTCMinutes());UF.range;const VF=hs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nf-e.getMinutes()*ru)},(e,t)=>{e.setTime(+e+t*rf)},(e,t)=>(t-e)/rf,e=>e.getHours());VF.range;const WF=hs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*rf)},(e,t)=>(t-e)/rf,e=>e.getUTCHours());WF.range;const US=hs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ru)/gf,e=>e.getDate()-1);US.range;const mI=hs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gf,e=>e.getUTCDate()-1);mI.range;const lee=hs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gf,e=>Math.floor(e/gf));lee.range;function M_(e){return hs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ru)/jF)}const gI=M_(0),aP=M_(1),D3e=M_(2),L3e=M_(3),a0=M_(4),z3e=M_(5),N3e=M_(6);gI.range;aP.range;D3e.range;L3e.range;a0.range;z3e.range;N3e.range;function O_(e){return hs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/jF)}const _I=O_(0),sP=O_(1),F3e=O_(2),B3e=O_(3),s0=O_(4),j3e=O_(5),$3e=O_(6);_I.range;sP.range;F3e.range;B3e.range;s0.range;j3e.range;$3e.range;const GF=hs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());GF.range;const HF=hs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());HF.range;const _f=hs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());_f.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});_f.range;const yf=hs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());yf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});yf.range;function cee(e,t,n,r,a,c){const d=[[Wg,1,nf],[Wg,5,5*nf],[Wg,15,15*nf],[Wg,30,30*nf],[c,1,ru],[c,5,5*ru],[c,15,15*ru],[c,30,30*ru],[a,1,rf],[a,3,3*rf],[a,6,6*rf],[a,12,12*rf],[r,1,gf],[r,2,2*gf],[n,1,jF],[t,1,vW],[t,3,3*vW],[e,1,lR]];function i(b,T,A){const k=T<b;k&&([b,T]=[T,b]);const R=A&&typeof A.range=="function"?A:_(b,T,A),B=R?R.range(b,+T+1):[];return k?B.reverse():B}function _(b,T,A){const k=Math.abs(T-b)/A,R=CF(([,,V])=>V).right(d,k);if(R===d.length)return e.every(LL(b/lR,T/lR,A));if(R===0)return oP.every(Math.max(LL(b,T,A),1));const[B,N]=d[k/d[R-1][2]<d[R][2]/k?R-1:R];return B.every(N)}return[i,_]}const[U3e,V3e]=cee(yf,HF,_I,lee,WF,UF),[W3e,G3e]=cee(_f,GF,gI,US,VF,$F);function cR(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uR(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Z1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function H3e(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,c=e.days,d=e.shortDays,i=e.months,_=e.shortMonths,b=X1(a),T=K1(a),A=X1(c),k=K1(c),R=X1(d),B=K1(d),N=X1(i),V=K1(i),H=X1(_),G=K1(_),q={a:rt,A:Be,b:nt,B:at,c:null,d:EW,e:EW,f:mNe,g:ENe,G:PNe,H:dNe,I:fNe,j:pNe,L:uee,m:gNe,M:_Ne,p:Mt,q:Nt,Q:CW,s:IW,S:yNe,u:vNe,U:xNe,V:bNe,w:wNe,W:SNe,x:null,X:null,y:TNe,Y:ANe,Z:CNe,"%":PW},Q={a:rn,A:un,b:en,B:sn,c:null,d:AW,e:AW,f:kNe,g:UNe,G:WNe,H:INe,I:MNe,j:ONe,L:dee,m:RNe,M:DNe,p:Vt,q:$n,Q:CW,s:IW,S:LNe,u:zNe,U:NNe,V:FNe,w:BNe,W:jNe,x:null,X:null,y:$Ne,Y:VNe,Z:GNe,"%":PW},te={a:Ne,A:Fe,b:Le,B:Ze,c:He,d:SW,e:SW,f:lNe,g:wW,G:bW,H:TW,I:TW,j:iNe,L:sNe,m:rNe,M:oNe,p:De,q:nNe,Q:uNe,s:hNe,S:aNe,u:Y3e,U:J3e,V:Q3e,w:K3e,W:eNe,x:ct,X:ot,y:wW,Y:bW,Z:tNe,"%":cNe};q.x=ue(n,q),q.X=ue(r,q),q.c=ue(t,q),Q.x=ue(n,Q),Q.X=ue(r,Q),Q.c=ue(t,Q);function ue(Gt,Tn){return function(hn){var yt=[],In=-1,Kn=0,Ar=Gt.length,_r,Vr,it;for(hn instanceof Date||(hn=new Date(+hn));++In<Ar;)Gt.charCodeAt(In)===37&&(yt.push(Gt.slice(Kn,In)),(Vr=xW[_r=Gt.charAt(++In)])!=null?_r=Gt.charAt(++In):Vr=_r==="e"?" ":"0",(it=Tn[_r])&&(_r=it(hn,Vr)),yt.push(_r),Kn=In+1);return yt.push(Gt.slice(Kn,In)),yt.join("")}}function fe(Gt,Tn){return function(hn){var yt=Z1(1900,void 0,1),In=ye(yt,Gt,hn+="",0),Kn,Ar;if(In!=hn.length)return null;if("Q"in yt)return new Date(yt.Q);if("s"in yt)return new Date(yt.s*1e3+("L"in yt?yt.L:0));if(Tn&&!("Z"in yt)&&(yt.Z=0),"p"in yt&&(yt.H=yt.H%12+yt.p*12),yt.m===void 0&&(yt.m="q"in yt?yt.q:0),"V"in yt){if(yt.V<1||yt.V>53)return null;"w"in yt||(yt.w=1),"Z"in yt?(Kn=uR(Z1(yt.y,0,1)),Ar=Kn.getUTCDay(),Kn=Ar>4||Ar===0?sP.ceil(Kn):sP(Kn),Kn=mI.offset(Kn,(yt.V-1)*7),yt.y=Kn.getUTCFullYear(),yt.m=Kn.getUTCMonth(),yt.d=Kn.getUTCDate()+(yt.w+6)%7):(Kn=cR(Z1(yt.y,0,1)),Ar=Kn.getDay(),Kn=Ar>4||Ar===0?aP.ceil(Kn):aP(Kn),Kn=US.offset(Kn,(yt.V-1)*7),yt.y=Kn.getFullYear(),yt.m=Kn.getMonth(),yt.d=Kn.getDate()+(yt.w+6)%7)}else("W"in yt||"U"in yt)&&("w"in yt||(yt.w="u"in yt?yt.u%7:"W"in yt?1:0),Ar="Z"in yt?uR(Z1(yt.y,0,1)).getUTCDay():cR(Z1(yt.y,0,1)).getDay(),yt.m=0,yt.d="W"in yt?(yt.w+6)%7+yt.W*7-(Ar+5)%7:yt.w+yt.U*7-(Ar+6)%7);return"Z"in yt?(yt.H+=yt.Z/100|0,yt.M+=yt.Z%100,uR(yt)):cR(yt)}}function ye(Gt,Tn,hn,yt){for(var In=0,Kn=Tn.length,Ar=hn.length,_r,Vr;In<Kn;){if(yt>=Ar)return-1;if(_r=Tn.charCodeAt(In++),_r===37){if(_r=Tn.charAt(In++),Vr=te[_r in xW?Tn.charAt(In++):_r],!Vr||(yt=Vr(Gt,hn,yt))<0)return-1}else if(_r!=hn.charCodeAt(yt++))return-1}return yt}function De(Gt,Tn,hn){var yt=b.exec(Tn.slice(hn));return yt?(Gt.p=T.get(yt[0].toLowerCase()),hn+yt[0].length):-1}function Ne(Gt,Tn,hn){var yt=R.exec(Tn.slice(hn));return yt?(Gt.w=B.get(yt[0].toLowerCase()),hn+yt[0].length):-1}function Fe(Gt,Tn,hn){var yt=A.exec(Tn.slice(hn));return yt?(Gt.w=k.get(yt[0].toLowerCase()),hn+yt[0].length):-1}function Le(Gt,Tn,hn){var yt=H.exec(Tn.slice(hn));return yt?(Gt.m=G.get(yt[0].toLowerCase()),hn+yt[0].length):-1}function Ze(Gt,Tn,hn){var yt=N.exec(Tn.slice(hn));return yt?(Gt.m=V.get(yt[0].toLowerCase()),hn+yt[0].length):-1}function He(Gt,Tn,hn){return ye(Gt,t,Tn,hn)}function ct(Gt,Tn,hn){return ye(Gt,n,Tn,hn)}function ot(Gt,Tn,hn){return ye(Gt,r,Tn,hn)}function rt(Gt){return d[Gt.getDay()]}function Be(Gt){return c[Gt.getDay()]}function nt(Gt){return _[Gt.getMonth()]}function at(Gt){return i[Gt.getMonth()]}function Mt(Gt){return a[+(Gt.getHours()>=12)]}function Nt(Gt){return 1+~~(Gt.getMonth()/3)}function rn(Gt){return d[Gt.getUTCDay()]}function un(Gt){return c[Gt.getUTCDay()]}function en(Gt){return _[Gt.getUTCMonth()]}function sn(Gt){return i[Gt.getUTCMonth()]}function Vt(Gt){return a[+(Gt.getUTCHours()>=12)]}function $n(Gt){return 1+~~(Gt.getUTCMonth()/3)}return{format:function(Gt){var Tn=ue(Gt+="",q);return Tn.toString=function(){return Gt},Tn},parse:function(Gt){var Tn=fe(Gt+="",!1);return Tn.toString=function(){return Gt},Tn},utcFormat:function(Gt){var Tn=ue(Gt+="",Q);return Tn.toString=function(){return Gt},Tn},utcParse:function(Gt){var Tn=fe(Gt+="",!0);return Tn.toString=function(){return Gt},Tn}}}var xW={"-":"",_:" ",0:"0"},Ts=/^\s*\d+/,q3e=/^%/,Z3e=/[\\^$*+?|[\]().{}]/g;function so(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",c=a.length;return r+(c<n?new Array(n-c+1).join(t)+a:a)}function X3e(e){return e.replace(Z3e,"\\$&")}function X1(e){return new RegExp("^(?:"+e.map(X3e).join("|")+")","i")}function K1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function K3e(e,t,n){var r=Ts.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Y3e(e,t,n){var r=Ts.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function J3e(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Q3e(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function eNe(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function bW(e,t,n){var r=Ts.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function wW(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function tNe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function nNe(e,t,n){var r=Ts.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function rNe(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function SW(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function iNe(e,t,n){var r=Ts.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function TW(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function oNe(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function aNe(e,t,n){var r=Ts.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function sNe(e,t,n){var r=Ts.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function lNe(e,t,n){var r=Ts.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function cNe(e,t,n){var r=q3e.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function uNe(e,t,n){var r=Ts.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function hNe(e,t,n){var r=Ts.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function EW(e,t){return so(e.getDate(),t,2)}function dNe(e,t){return so(e.getHours(),t,2)}function fNe(e,t){return so(e.getHours()%12||12,t,2)}function pNe(e,t){return so(1+US.count(_f(e),e),t,3)}function uee(e,t){return so(e.getMilliseconds(),t,3)}function mNe(e,t){return uee(e,t)+"000"}function gNe(e,t){return so(e.getMonth()+1,t,2)}function _Ne(e,t){return so(e.getMinutes(),t,2)}function yNe(e,t){return so(e.getSeconds(),t,2)}function vNe(e){var t=e.getDay();return t===0?7:t}function xNe(e,t){return so(gI.count(_f(e)-1,e),t,2)}function hee(e){var t=e.getDay();return t>=4||t===0?a0(e):a0.ceil(e)}function bNe(e,t){return e=hee(e),so(a0.count(_f(e),e)+(_f(e).getDay()===4),t,2)}function wNe(e){return e.getDay()}function SNe(e,t){return so(aP.count(_f(e)-1,e),t,2)}function TNe(e,t){return so(e.getFullYear()%100,t,2)}function ENe(e,t){return e=hee(e),so(e.getFullYear()%100,t,2)}function ANe(e,t){return so(e.getFullYear()%1e4,t,4)}function PNe(e,t){var n=e.getDay();return e=n>=4||n===0?a0(e):a0.ceil(e),so(e.getFullYear()%1e4,t,4)}function CNe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+so(t/60|0,"0",2)+so(t%60,"0",2)}function AW(e,t){return so(e.getUTCDate(),t,2)}function INe(e,t){return so(e.getUTCHours(),t,2)}function MNe(e,t){return so(e.getUTCHours()%12||12,t,2)}function ONe(e,t){return so(1+mI.count(yf(e),e),t,3)}function dee(e,t){return so(e.getUTCMilliseconds(),t,3)}function kNe(e,t){return dee(e,t)+"000"}function RNe(e,t){return so(e.getUTCMonth()+1,t,2)}function DNe(e,t){return so(e.getUTCMinutes(),t,2)}function LNe(e,t){return so(e.getUTCSeconds(),t,2)}function zNe(e){var t=e.getUTCDay();return t===0?7:t}function NNe(e,t){return so(_I.count(yf(e)-1,e),t,2)}function fee(e){var t=e.getUTCDay();return t>=4||t===0?s0(e):s0.ceil(e)}function FNe(e,t){return e=fee(e),so(s0.count(yf(e),e)+(yf(e).getUTCDay()===4),t,2)}function BNe(e){return e.getUTCDay()}function jNe(e,t){return so(sP.count(yf(e)-1,e),t,2)}function $Ne(e,t){return so(e.getUTCFullYear()%100,t,2)}function UNe(e,t){return e=fee(e),so(e.getUTCFullYear()%100,t,2)}function VNe(e,t){return so(e.getUTCFullYear()%1e4,t,4)}function WNe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?s0(e):s0.ceil(e),so(e.getUTCFullYear()%1e4,t,4)}function GNe(){return"+0000"}function PW(){return"%"}function CW(e){return+e}function IW(e){return Math.floor(+e/1e3)}var Yy,pee,mee;HNe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function HNe(e){return Yy=H3e(e),pee=Yy.format,Yy.parse,mee=Yy.utcFormat,Yy.utcParse,Yy}function qNe(e){return new Date(e)}function ZNe(e){return e instanceof Date?+e:+new Date(+e)}function qF(e,t,n,r,a,c,d,i,_,b){var T=RF(),A=T.invert,k=T.domain,R=b(".%L"),B=b(":%S"),N=b("%I:%M"),V=b("%I %p"),H=b("%a %d"),G=b("%b %d"),q=b("%B"),Q=b("%Y");function te(ue){return(_(ue)<ue?R:i(ue)<ue?B:d(ue)<ue?N:c(ue)<ue?V:r(ue)<ue?a(ue)<ue?H:G:n(ue)<ue?q:Q)(ue)}return T.invert=function(ue){return new Date(A(ue))},T.domain=function(ue){return arguments.length?k(Array.from(ue,ZNe)):k().map(qNe)},T.ticks=function(ue){var fe=k();return e(fe[0],fe[fe.length-1],ue??10)},T.tickFormat=function(ue,fe){return fe==null?te:b(fe)},T.nice=function(ue){var fe=k();return(!ue||typeof ue.range!="function")&&(ue=t(fe[0],fe[fe.length-1],ue??10)),ue?k(tee(fe,ue)):T},T.copy=function(){return $S(T,qF(e,t,n,r,a,c,d,i,_,b))},T}function XNe(){return pu.apply(qF(W3e,G3e,_f,GF,gI,US,VF,$F,Wg,pee).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function KNe(){return pu.apply(qF(U3e,V3e,yf,HF,_I,mI,WF,UF,Wg,mee).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yI(){var e=0,t=1,n,r,a,c,d=vl,i=!1,_;function b(A){return A==null||isNaN(A=+A)?_:d(a===0?.5:(A=(c(A)-n)*a,i?Math.max(0,Math.min(1,A)):A))}b.domain=function(A){return arguments.length?([e,t]=A,n=c(e=+e),r=c(t=+t),a=n===r?0:1/(r-n),b):[e,t]},b.clamp=function(A){return arguments.length?(i=!!A,b):i},b.interpolator=function(A){return arguments.length?(d=A,b):d};function T(A){return function(k){var R,B;return arguments.length?([R,B]=k,d=A(R,B),b):[d(0),d(1)]}}return b.range=T(nx),b.rangeRound=T(kF),b.unknown=function(A){return arguments.length?(_=A,b):_},function(A){return c=A,n=A(e),r=A(t),a=n===r?0:1/(r-n),b}}function Pm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function gee(){var e=Am(yI()(vl));return e.copy=function(){return Pm(e,gee())},Tf.apply(e,arguments)}function _ee(){var e=zF(yI()).domain([1,10]);return e.copy=function(){return Pm(e,_ee()).base(e.base())},Tf.apply(e,arguments)}function yee(){var e=NF(yI());return e.copy=function(){return Pm(e,yee()).constant(e.constant())},Tf.apply(e,arguments)}function ZF(){var e=FF(yI());return e.copy=function(){return Pm(e,ZF()).exponent(e.exponent())},Tf.apply(e,arguments)}function YNe(){return ZF.apply(null,arguments).exponent(.5)}function vee(){var e=[],t=vl;function n(r){if(r!=null&&!isNaN(r=+r))return t((BS(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Qp),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,c)=>Dze(e,c/r))},n.copy=function(){return vee(t).domain(e)},Tf.apply(n,arguments)}function vI(){var e=0,t=.5,n=1,r=1,a,c,d,i,_,b=vl,T,A=!1,k;function R(N){return isNaN(N=+N)?k:(N=.5+((N=+T(N))-c)*(r*N<r*c?i:_),b(A?Math.max(0,Math.min(1,N)):N))}R.domain=function(N){return arguments.length?([e,t,n]=N,a=T(e=+e),c=T(t=+t),d=T(n=+n),i=a===c?0:.5/(c-a),_=c===d?0:.5/(d-c),r=c<a?-1:1,R):[e,t,n]},R.clamp=function(N){return arguments.length?(A=!!N,R):A},R.interpolator=function(N){return arguments.length?(b=N,R):b};function B(N){return function(V){var H,G,q;return arguments.length?([H,G,q]=V,b=c3e(N,[H,G,q]),R):[b(0),b(.5),b(1)]}}return R.range=B(nx),R.rangeRound=B(kF),R.unknown=function(N){return arguments.length?(k=N,R):k},function(N){return T=N,a=N(e),c=N(t),d=N(n),i=a===c?0:.5/(c-a),_=c===d?0:.5/(d-c),r=c<a?-1:1,R}}function xee(){var e=Am(vI()(vl));return e.copy=function(){return Pm(e,xee())},Tf.apply(e,arguments)}function bee(){var e=zF(vI()).domain([.1,1,10]);return e.copy=function(){return Pm(e,bee()).base(e.base())},Tf.apply(e,arguments)}function wee(){var e=NF(vI());return e.copy=function(){return Pm(e,wee()).constant(e.constant())},Tf.apply(e,arguments)}function XF(){var e=FF(vI());return e.copy=function(){return Pm(e,XF()).exponent(e.exponent())},Tf.apply(e,arguments)}function JNe(){return XF.apply(null,arguments).exponent(.5)}const MW=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Dw,scaleDiverging:xee,scaleDivergingLog:bee,scaleDivergingPow:XF,scaleDivergingSqrt:JNe,scaleDivergingSymlog:wee,scaleIdentity:eee,scaleImplicit:zL,scaleLinear:iP,scaleLog:nee,scaleOrdinal:IF,scalePoint:Rb,scalePow:BF,scaleQuantile:oee,scaleQuantize:aee,scaleRadial:iee,scaleSequential:gee,scaleSequentialLog:_ee,scaleSequentialPow:ZF,scaleSequentialQuantile:vee,scaleSequentialSqrt:YNe,scaleSequentialSymlog:yee,scaleSqrt:k3e,scaleSymlog:ree,scaleThreshold:see,scaleTime:XNe,scaleUtc:KNe,tickFormat:QQ},Symbol.toStringTag,{value:"Module"}));var QNe=q0;function eFe(e,t,n){for(var r=-1,a=e.length;++r<a;){var c=e[r],d=t(c);if(d!=null&&(i===void 0?d===d&&!QNe(d):n(d,i)))var i=d,_=c}return _}var xI=eFe;function tFe(e,t){return e>t}var See=tFe,nFe=xI,rFe=See,iFe=tx;function oFe(e){return e&&e.length?nFe(e,iFe,rFe):void 0}var aFe=oFe;const Fp=lo(aFe);function sFe(e,t){return e<t}var Tee=sFe,lFe=xI,cFe=Tee,uFe=tx;function hFe(e){return e&&e.length?lFe(e,uFe,cFe):void 0}var dFe=hFe;const bI=lo(dFe);var fFe=dF,pFe=ld,mFe=IQ,gFe=nc;function _Fe(e,t){var n=gFe(e)?fFe:mFe;return n(e,pFe(t))}var yFe=_Fe,vFe=PQ,xFe=yFe;function bFe(e,t){return vFe(xFe(e,t),1)}var wFe=bFe;const SFe=lo(wFe);var TFe=TF;function EFe(e,t){return TFe(e,t)}var AFe=EFe;const pm=lo(AFe);var rx=1e9,PFe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},YF,ta=!0,cu="[DecimalError] ",Yg=cu+"Invalid argument: ",KF=cu+"Exponent out of range: ",ix=Math.floor,Lg=Math.pow,CFe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Cc,vs=1e7,qo=7,Eee=9007199254740991,lP=ix(Eee/qo),fr={};fr.absoluteValue=fr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};fr.comparedTo=fr.cmp=function(e){var t,n,r,a,c=this;if(e=new c.constructor(e),c.s!==e.s)return c.s||-e.s;if(c.e!==e.e)return c.e>e.e^c.s<0?1:-1;for(r=c.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(c.d[t]!==e.d[t])return c.d[t]>e.d[t]^c.s<0?1:-1;return r===a?0:r>a^c.s<0?1:-1};fr.decimalPlaces=fr.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*qo;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};fr.dividedBy=fr.div=function(e){return lf(this,new this.constructor(e))};fr.dividedToIntegerBy=fr.idiv=function(e){var t=this,n=t.constructor;return Io(lf(t,new n(e),0,1),n.precision)};fr.equals=fr.eq=function(e){return!this.cmp(e)};fr.exponent=function(){return Ja(this)};fr.greaterThan=fr.gt=function(e){return this.cmp(e)>0};fr.greaterThanOrEqualTo=fr.gte=function(e){return this.cmp(e)>=0};fr.isInteger=fr.isint=function(){return this.e>this.d.length-2};fr.isNegative=fr.isneg=function(){return this.s<0};fr.isPositive=fr.ispos=function(){return this.s>0};fr.isZero=function(){return this.s===0};fr.lessThan=fr.lt=function(e){return this.cmp(e)<0};fr.lessThanOrEqualTo=fr.lte=function(e){return this.cmp(e)<1};fr.logarithm=fr.log=function(e){var t,n=this,r=n.constructor,a=r.precision,c=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Cc))throw Error(cu+"NaN");if(n.s<1)throw Error(cu+(n.s?"NaN":"-Infinity"));return n.eq(Cc)?new r(0):(ta=!1,t=lf(Fw(n,c),Fw(e,c),c),ta=!0,Io(t,a))};fr.minus=fr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Cee(t,e):Aee(t,(e.s=-e.s,e))};fr.modulo=fr.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(cu+"NaN");return n.s?(ta=!1,t=lf(n,e,0,1).times(e),ta=!0,n.minus(t)):Io(new r(n),a)};fr.naturalExponential=fr.exp=function(){return Pee(this)};fr.naturalLogarithm=fr.ln=function(){return Fw(this)};fr.negated=fr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};fr.plus=fr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Aee(t,e):Cee(t,(e.s=-e.s,e))};fr.precision=fr.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Yg+e);if(t=Ja(a)+1,r=a.d.length-1,n=r*qo+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};fr.squareRoot=fr.sqrt=function(){var e,t,n,r,a,c,d,i=this,_=i.constructor;if(i.s<1){if(!i.s)return new _(0);throw Error(cu+"NaN")}for(e=Ja(i),ta=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=qh(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ix((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new _(t)):r=new _(a.toString()),n=_.precision,a=d=n+3;;)if(c=r,r=c.plus(lf(i,c,d+2)).times(.5),qh(c.d).slice(0,d)===(t=qh(r.d)).slice(0,d)){if(t=t.slice(d-3,d+1),a==d&&t=="4999"){if(Io(c,n+1,0),c.times(c).eq(i)){r=c;break}}else if(t!="9999")break;d+=4}return ta=!0,Io(r,n)};fr.times=fr.mul=function(e){var t,n,r,a,c,d,i,_,b,T=this,A=T.constructor,k=T.d,R=(e=new A(e)).d;if(!T.s||!e.s)return new A(0);for(e.s*=T.s,n=T.e+e.e,_=k.length,b=R.length,_<b&&(c=k,k=R,R=c,d=_,_=b,b=d),c=[],d=_+b,r=d;r--;)c.push(0);for(r=b;--r>=0;){for(t=0,a=_+r;a>r;)i=c[a]+R[r]*k[a-r-1]+t,c[a--]=i%vs|0,t=i/vs|0;c[a]=(c[a]+t)%vs|0}for(;!c[--d];)c.pop();return t?++n:c.shift(),e.d=c,e.e=n,ta?Io(e,A.precision):e};fr.toDecimalPlaces=fr.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(id(e,0,rx),t===void 0?t=r.rounding:id(t,0,8),Io(n,e+Ja(n)+1,t))};fr.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=d_(r,!0):(id(e,0,rx),t===void 0?t=a.rounding:id(t,0,8),r=Io(new a(r),e+1,t),n=d_(r,!0,e+1)),n};fr.toFixed=function(e,t){var n,r,a=this,c=a.constructor;return e===void 0?d_(a):(id(e,0,rx),t===void 0?t=c.rounding:id(t,0,8),r=Io(new c(a),e+Ja(a)+1,t),n=d_(r.abs(),!1,e+Ja(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)};fr.toInteger=fr.toint=function(){var e=this,t=e.constructor;return Io(new t(e),Ja(e)+1,t.rounding)};fr.toNumber=function(){return+this};fr.toPower=fr.pow=function(e){var t,n,r,a,c,d,i=this,_=i.constructor,b=12,T=+(e=new _(e));if(!e.s)return new _(Cc);if(i=new _(i),!i.s){if(e.s<1)throw Error(cu+"Infinity");return i}if(i.eq(Cc))return i;if(r=_.precision,e.eq(Cc))return Io(i,r);if(t=e.e,n=e.d.length-1,d=t>=n,c=i.s,d){if((n=T<0?-T:T)<=Eee){for(a=new _(Cc),t=Math.ceil(r/qo+4),ta=!1;n%2&&(a=a.times(i),kW(a.d,t)),n=ix(n/2),n!==0;)i=i.times(i),kW(i.d,t);return ta=!0,e.s<0?new _(Cc).div(a):Io(a,r)}}else if(c<0)throw Error(cu+"NaN");return c=c<0&&e.d[Math.max(t,n)]&1?-1:1,i.s=1,ta=!1,a=e.times(Fw(i,r+b)),ta=!0,a=Pee(a),a.s=c,a};fr.toPrecision=function(e,t){var n,r,a=this,c=a.constructor;return e===void 0?(n=Ja(a),r=d_(a,n<=c.toExpNeg||n>=c.toExpPos)):(id(e,1,rx),t===void 0?t=c.rounding:id(t,0,8),a=Io(new c(a),e,t),n=Ja(a),r=d_(a,e<=n||n<=c.toExpNeg,e)),r};fr.toSignificantDigits=fr.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(id(e,1,rx),t===void 0?t=r.rounding:id(t,0,8)),Io(new r(n),e,t)};fr.toString=fr.valueOf=fr.val=fr.toJSON=fr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ja(e),n=e.constructor;return d_(e,t<=n.toExpNeg||t>=n.toExpPos)};function Aee(e,t){var n,r,a,c,d,i,_,b,T=e.constructor,A=T.precision;if(!e.s||!t.s)return t.s||(t=new T(e)),ta?Io(t,A):t;if(_=e.d,b=t.d,d=e.e,a=t.e,_=_.slice(),c=d-a,c){for(c<0?(r=_,c=-c,i=b.length):(r=b,a=d,i=_.length),d=Math.ceil(A/qo),i=d>i?d+1:i+1,c>i&&(c=i,r.length=1),r.reverse();c--;)r.push(0);r.reverse()}for(i=_.length,c=b.length,i-c<0&&(c=i,r=b,b=_,_=r),n=0;c;)n=(_[--c]=_[c]+b[c]+n)/vs|0,_[c]%=vs;for(n&&(_.unshift(n),++a),i=_.length;_[--i]==0;)_.pop();return t.d=_,t.e=a,ta?Io(t,A):t}function id(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Yg+e)}function qh(e){var t,n,r,a=e.length-1,c="",d=e[0];if(a>0){for(c+=d,t=1;t<a;t++)r=e[t]+"",n=qo-r.length,n&&(c+=Cp(n)),c+=r;d=e[t],r=d+"",n=qo-r.length,n&&(c+=Cp(n))}else if(d===0)return"0";for(;d%10===0;)d/=10;return c+d}var lf=function(){function e(r,a){var c,d=0,i=r.length;for(r=r.slice();i--;)c=r[i]*a+d,r[i]=c%vs|0,d=c/vs|0;return d&&r.unshift(d),r}function t(r,a,c,d){var i,_;if(c!=d)_=c>d?1:-1;else for(i=_=0;i<c;i++)if(r[i]!=a[i]){_=r[i]>a[i]?1:-1;break}return _}function n(r,a,c){for(var d=0;c--;)r[c]-=d,d=r[c]<a[c]?1:0,r[c]=d*vs+r[c]-a[c];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,c,d){var i,_,b,T,A,k,R,B,N,V,H,G,q,Q,te,ue,fe,ye,De=r.constructor,Ne=r.s==a.s?1:-1,Fe=r.d,Le=a.d;if(!r.s)return new De(r);if(!a.s)throw Error(cu+"Division by zero");for(_=r.e-a.e,fe=Le.length,te=Fe.length,R=new De(Ne),B=R.d=[],b=0;Le[b]==(Fe[b]||0);)++b;if(Le[b]>(Fe[b]||0)&&--_,c==null?G=c=De.precision:d?G=c+(Ja(r)-Ja(a))+1:G=c,G<0)return new De(0);if(G=G/qo+2|0,b=0,fe==1)for(T=0,Le=Le[0],G++;(b<te||T)&&G--;b++)q=T*vs+(Fe[b]||0),B[b]=q/Le|0,T=q%Le|0;else{for(T=vs/(Le[0]+1)|0,T>1&&(Le=e(Le,T),Fe=e(Fe,T),fe=Le.length,te=Fe.length),Q=fe,N=Fe.slice(0,fe),V=N.length;V<fe;)N[V++]=0;ye=Le.slice(),ye.unshift(0),ue=Le[0],Le[1]>=vs/2&&++ue;do T=0,i=t(Le,N,fe,V),i<0?(H=N[0],fe!=V&&(H=H*vs+(N[1]||0)),T=H/ue|0,T>1?(T>=vs&&(T=vs-1),A=e(Le,T),k=A.length,V=N.length,i=t(A,N,k,V),i==1&&(T--,n(A,fe<k?ye:Le,k))):(T==0&&(i=T=1),A=Le.slice()),k=A.length,k<V&&A.unshift(0),n(N,A,V),i==-1&&(V=N.length,i=t(Le,N,fe,V),i<1&&(T++,n(N,fe<V?ye:Le,V))),V=N.length):i===0&&(T++,N=[0]),B[b++]=T,i&&N[0]?N[V++]=Fe[Q]||0:(N=[Fe[Q]],V=1);while((Q++<te||N[0]!==void 0)&&G--)}return B[0]||B.shift(),R.e=_,Io(R,d?c+Ja(R)+1:c)}}();function Pee(e,t){var n,r,a,c,d,i,_=0,b=0,T=e.constructor,A=T.precision;if(Ja(e)>16)throw Error(KF+Ja(e));if(!e.s)return new T(Cc);for(t==null?(ta=!1,i=A):i=t,d=new T(.03125);e.abs().gte(.1);)e=e.times(d),b+=5;for(r=Math.log(Lg(2,b))/Math.LN10*2+5|0,i+=r,n=a=c=new T(Cc),T.precision=i;;){if(a=Io(a.times(e),i),n=n.times(++_),d=c.plus(lf(a,n,i)),qh(d.d).slice(0,i)===qh(c.d).slice(0,i)){for(;b--;)c=Io(c.times(c),i);return T.precision=A,t==null?(ta=!0,Io(c,A)):c}c=d}}function Ja(e){for(var t=e.e*qo,n=e.d[0];n>=10;n/=10)t++;return t}function hR(e,t,n){if(t>e.LN10.sd())throw ta=!0,n&&(e.precision=n),Error(cu+"LN10 precision limit exceeded");return Io(new e(e.LN10),t)}function Cp(e){for(var t="";e--;)t+="0";return t}function Fw(e,t){var n,r,a,c,d,i,_,b,T,A=1,k=10,R=e,B=R.d,N=R.constructor,V=N.precision;if(R.s<1)throw Error(cu+(R.s?"NaN":"-Infinity"));if(R.eq(Cc))return new N(0);if(t==null?(ta=!1,b=V):b=t,R.eq(10))return t==null&&(ta=!0),hR(N,b);if(b+=k,N.precision=b,n=qh(B),r=n.charAt(0),c=Ja(R),Math.abs(c)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)R=R.times(e),n=qh(R.d),r=n.charAt(0),A++;c=Ja(R),r>1?(R=new N("0."+n),c++):R=new N(r+"."+n.slice(1))}else return _=hR(N,b+2,V).times(c+""),R=Fw(new N(r+"."+n.slice(1)),b-k).plus(_),N.precision=V,t==null?(ta=!0,Io(R,V)):R;for(i=d=R=lf(R.minus(Cc),R.plus(Cc),b),T=Io(R.times(R),b),a=3;;){if(d=Io(d.times(T),b),_=i.plus(lf(d,new N(a),b)),qh(_.d).slice(0,b)===qh(i.d).slice(0,b))return i=i.times(2),c!==0&&(i=i.plus(hR(N,b+2,V).times(c+""))),i=lf(i,new N(A),b),N.precision=V,t==null?(ta=!0,Io(i,V)):i;i=_,a+=2}}function OW(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=ix(n/qo),e.d=[],r=(n+1)%qo,n<0&&(r+=qo),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=qo;r<a;)e.d.push(+t.slice(r,r+=qo));t=t.slice(r),r=qo-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),ta&&(e.e>lP||e.e<-lP))throw Error(KF+n)}else e.s=0,e.e=0,e.d=[0];return e}function Io(e,t,n){var r,a,c,d,i,_,b,T,A=e.d;for(d=1,c=A[0];c>=10;c/=10)d++;if(r=t-d,r<0)r+=qo,a=t,b=A[T=0];else{if(T=Math.ceil((r+1)/qo),c=A.length,T>=c)return e;for(b=c=A[T],d=1;c>=10;c/=10)d++;r%=qo,a=r-qo+d}if(n!==void 0&&(c=Lg(10,d-a-1),i=b/c%10|0,_=t<0||A[T+1]!==void 0||b%c,_=n<4?(i||_)&&(n==0||n==(e.s<0?3:2)):i>5||i==5&&(n==4||_||n==6&&(r>0?a>0?b/Lg(10,d-a):0:A[T-1])%10&1||n==(e.s<0?8:7))),t<1||!A[0])return _?(c=Ja(e),A.length=1,t=t-c-1,A[0]=Lg(10,(qo-t%qo)%qo),e.e=ix(-t/qo)||0):(A.length=1,A[0]=e.e=e.s=0),e;if(r==0?(A.length=T,c=1,T--):(A.length=T+1,c=Lg(10,qo-r),A[T]=a>0?(b/Lg(10,d-a)%Lg(10,a)|0)*c:0),_)for(;;)if(T==0){(A[0]+=c)==vs&&(A[0]=1,++e.e);break}else{if(A[T]+=c,A[T]!=vs)break;A[T--]=0,c=1}for(r=A.length;A[--r]===0;)A.pop();if(ta&&(e.e>lP||e.e<-lP))throw Error(KF+Ja(e));return e}function Cee(e,t){var n,r,a,c,d,i,_,b,T,A,k=e.constructor,R=k.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new k(e),ta?Io(t,R):t;if(_=e.d,A=t.d,r=t.e,b=e.e,_=_.slice(),d=b-r,d){for(T=d<0,T?(n=_,d=-d,i=A.length):(n=A,r=b,i=_.length),a=Math.max(Math.ceil(R/qo),i)+2,d>a&&(d=a,n.length=1),n.reverse(),a=d;a--;)n.push(0);n.reverse()}else{for(a=_.length,i=A.length,T=a<i,T&&(i=a),a=0;a<i;a++)if(_[a]!=A[a]){T=_[a]<A[a];break}d=0}for(T&&(n=_,_=A,A=n,t.s=-t.s),i=_.length,a=A.length-i;a>0;--a)_[i++]=0;for(a=A.length;a>d;){if(_[--a]<A[a]){for(c=a;c&&_[--c]===0;)_[c]=vs-1;--_[c],_[a]+=vs}_[a]-=A[a]}for(;_[--i]===0;)_.pop();for(;_[0]===0;_.shift())--r;return _[0]?(t.d=_,t.e=r,ta?Io(t,R):t):new k(0)}function d_(e,t,n){var r,a=Ja(e),c=qh(e.d),d=c.length;return t?(n&&(r=n-d)>0?c=c.charAt(0)+"."+c.slice(1)+Cp(r):d>1&&(c=c.charAt(0)+"."+c.slice(1)),c=c+(a<0?"e":"e+")+a):a<0?(c="0."+Cp(-a-1)+c,n&&(r=n-d)>0&&(c+=Cp(r))):a>=d?(c+=Cp(a+1-d),n&&(r=n-a-1)>0&&(c=c+"."+Cp(r))):((r=a+1)<d&&(c=c.slice(0,r)+"."+c.slice(r)),n&&(r=n-d)>0&&(a+1===d&&(c+="."),c+=Cp(r))),e.s<0?"-"+c:c}function kW(e,t){if(e.length>t)return e.length=t,!0}function Iee(e){var t,n,r;function a(c){var d=this;if(!(d instanceof a))return new a(c);if(d.constructor=a,c instanceof a){d.s=c.s,d.e=c.e,d.d=(c=c.d)?c.slice():c;return}if(typeof c=="number"){if(c*0!==0)throw Error(Yg+c);if(c>0)d.s=1;else if(c<0)c=-c,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(c===~~c&&c<1e7){d.e=0,d.d=[c];return}return OW(d,c.toString())}else if(typeof c!="string")throw Error(Yg+c);if(c.charCodeAt(0)===45?(c=c.slice(1),d.s=-1):d.s=1,CFe.test(c))OW(d,c);else throw Error(Yg+c)}if(a.prototype=fr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Iee,a.config=a.set=IFe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function IFe(e){if(!e||typeof e!="object")throw Error(cu+"Object expected");var t,n,r,a=["precision",1,rx,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(ix(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(Yg+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Yg+n+": "+r);return this}var YF=Iee(PFe);Cc=new YF(1);const To=YF;function MFe(e){return DFe(e)||RFe(e)||kFe(e)||OFe()}function OFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kFe(e,t){if(e){if(typeof e=="string")return $L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $L(e,t)}}function RFe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function DFe(e){if(Array.isArray(e))return $L(e)}function $L(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var LFe=function(t){return t},Mee={"@@functional/placeholder":!0},Oee=function(t){return t===Mee},RW=function(t){return function n(){return arguments.length===0||arguments.length===1&&Oee(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},zFe=function e(t,n){return t===1?n:RW(function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];var d=a.filter(function(i){return i!==Mee}).length;return d>=t?n.apply(void 0,a):e(t-d,RW(function(){for(var i=arguments.length,_=new Array(i),b=0;b<i;b++)_[b]=arguments[b];var T=a.map(function(A){return Oee(A)?_.shift():A});return n.apply(void 0,MFe(T).concat(_))}))})},wI=function(t){return zFe(t.length,t)},UL=function(t,n){for(var r=[],a=t;a<n;++a)r[a-t]=a;return r},NFe=wI(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),FFe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return LFe;var a=n.reverse(),c=a[0],d=a.slice(1);return function(){return d.reduce(function(i,_){return _(i)},c.apply(void 0,arguments))}},VL=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},kee=function(t){var n=null,r=null;return function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return n&&c.every(function(i,_){return i===n[_]})||(n=c,r=t.apply(void 0,c)),r}};function BFe(e){var t;return e===0?t=1:t=Math.floor(new To(e).abs().log(10).toNumber())+1,t}function jFe(e,t,n){for(var r=new To(e),a=0,c=[];r.lt(t)&&a<1e5;)c.push(r.toNumber()),r=r.add(n),a++;return c}var $Fe=wI(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),UFe=wI(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),VFe=wI(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const SI={rangeStep:jFe,getDigitCount:BFe,interpolateNumber:$Fe,uninterpolateNumber:UFe,uninterpolateTruncation:VFe};function WL(e){return HFe(e)||GFe(e)||Ree(e)||WFe()}function WFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function HFe(e){if(Array.isArray(e))return GL(e)}function Bw(e,t){return XFe(e)||ZFe(e,t)||Ree(e,t)||qFe()}function qFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ree(e,t){if(e){if(typeof e=="string")return GL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GL(e,t)}}function GL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ZFe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,c=void 0;try{for(var d=e[Symbol.iterator](),i;!(r=(i=d.next()).done)&&(n.push(i.value),!(t&&n.length===t));r=!0);}catch(_){a=!0,c=_}finally{try{!r&&d.return!=null&&d.return()}finally{if(a)throw c}}return n}}function XFe(e){if(Array.isArray(e))return e}function Dee(e){var t=Bw(e,2),n=t[0],r=t[1],a=n,c=r;return n>r&&(a=r,c=n),[a,c]}function Lee(e,t,n){if(e.lte(0))return new To(0);var r=SI.getDigitCount(e.toNumber()),a=new To(10).pow(r),c=e.div(a),d=r!==1?.05:.1,i=new To(Math.ceil(c.div(d).toNumber())).add(n).mul(d),_=i.mul(a);return t?_:new To(Math.ceil(_))}function KFe(e,t,n){var r=1,a=new To(e);if(!a.isint()&&n){var c=Math.abs(e);c<1?(r=new To(10).pow(SI.getDigitCount(e)-1),a=new To(Math.floor(a.div(r).toNumber())).mul(r)):c>1&&(a=new To(Math.floor(e)))}else e===0?a=new To(Math.floor((t-1)/2)):n||(a=new To(Math.floor(e)));var d=Math.floor((t-1)/2),i=FFe(NFe(function(_){return a.add(new To(_-d).mul(r)).toNumber()}),UL);return i(0,t)}function zee(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new To(0),tickMin:new To(0),tickMax:new To(0)};var c=Lee(new To(t).sub(e).div(n-1),r,a),d;e<=0&&t>=0?d=new To(0):(d=new To(e).add(t).div(2),d=d.sub(new To(d).mod(c)));var i=Math.ceil(d.sub(e).div(c).toNumber()),_=Math.ceil(new To(t).sub(d).div(c).toNumber()),b=i+_+1;return b>n?zee(e,t,n,r,a+1):(b<n&&(_=t>0?_+(n-b):_,i=t>0?i:i+(n-b)),{step:c,tickMin:d.sub(new To(i).mul(c)),tickMax:d.add(new To(_).mul(c))})}function YFe(e){var t=Bw(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(a,2),i=Dee([n,r]),_=Bw(i,2),b=_[0],T=_[1];if(b===-1/0||T===1/0){var A=T===1/0?[b].concat(WL(UL(0,a-1).map(function(){return 1/0}))):[].concat(WL(UL(0,a-1).map(function(){return-1/0})),[T]);return n>r?VL(A):A}if(b===T)return KFe(b,a,c);var k=zee(b,T,d,c),R=k.step,B=k.tickMin,N=k.tickMax,V=SI.rangeStep(B,N.add(new To(.1).mul(R)),R);return n>r?VL(V):V}function JFe(e,t){var n=Bw(e,2),r=n[0],a=n[1],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Dee([r,a]),i=Bw(d,2),_=i[0],b=i[1];if(_===-1/0||b===1/0)return[r,a];if(_===b)return[_];var T=Math.max(t,2),A=Lee(new To(b).sub(_).div(T-1),c,0),k=[].concat(WL(SI.rangeStep(new To(_),new To(b).sub(new To(.99).mul(A)),A)),[b]);return r>a?VL(k):k}var QFe=kee(YFe),eBe=kee(JFe),tBe="Invariant failed";function f_(e,t){throw new Error(tBe)}var nBe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function l0(e){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l0(e)}function cP(){return cP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cP.apply(this,arguments)}function rBe(e,t){return sBe(e)||aBe(e,t)||oBe(e,t)||iBe()}function iBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oBe(e,t){if(e){if(typeof e=="string")return DW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DW(e,t)}}function DW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aBe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function sBe(e){if(Array.isArray(e))return e}function lBe(e,t){if(e==null)return{};var n=cBe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cBe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function uBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hBe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bee(r.key),r)}}function dBe(e,t,n){return t&&hBe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fBe(e,t,n){return t=uP(t),pBe(e,Nee()?Reflect.construct(t,n||[],uP(e).constructor):t.apply(e,n))}function pBe(e,t){if(t&&(l0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mBe(e)}function mBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nee=function(){return!!e})()}function uP(e){return uP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uP(e)}function gBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HL(e,t)}function HL(e,t){return HL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},HL(e,t)}function Fee(e,t,n){return t=Bee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bee(e){var t=_Be(e,"string");return l0(t)=="symbol"?t:t+""}function _Be(e,t){if(l0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(l0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ox=function(e){function t(){return uBe(this,t),fBe(this,t,arguments)}return gBe(t,e),dBe(t,[{key:"render",value:function(){var r=this.props,a=r.offset,c=r.layout,d=r.width,i=r.dataKey,_=r.data,b=r.dataPointFormatter,T=r.xAxis,A=r.yAxis,k=lBe(r,nBe),R=wr(k,!1);this.props.direction==="x"&&T.type!=="number"&&f_();var B=_.map(function(N){var V=b(N,i),H=V.x,G=V.y,q=V.value,Q=V.errorVal;if(!Q)return null;var te=[],ue,fe;if(Array.isArray(Q)){var ye=rBe(Q,2);ue=ye[0],fe=ye[1]}else ue=fe=Q;if(c==="vertical"){var De=T.scale,Ne=G+a,Fe=Ne+d,Le=Ne-d,Ze=De(q-ue),He=De(q+fe);te.push({x1:He,y1:Fe,x2:He,y2:Le}),te.push({x1:Ze,y1:Ne,x2:He,y2:Ne}),te.push({x1:Ze,y1:Fe,x2:Ze,y2:Le})}else if(c==="horizontal"){var ct=A.scale,ot=H+a,rt=ot-d,Be=ot+d,nt=ct(q-ue),at=ct(q+fe);te.push({x1:rt,y1:at,x2:Be,y2:at}),te.push({x1:ot,y1:nt,x2:ot,y2:at}),te.push({x1:rt,y1:nt,x2:Be,y2:nt})}return Ce.createElement(_i,cP({className:"recharts-errorBar",key:"bar-".concat(te.map(function(Mt){return"".concat(Mt.x1,"-").concat(Mt.x2,"-").concat(Mt.y1,"-").concat(Mt.y2)}))},R),te.map(function(Mt){return Ce.createElement("line",cP({},Mt,{key:"line-".concat(Mt.x1,"-").concat(Mt.x2,"-").concat(Mt.y1,"-").concat(Mt.y2)}))}))});return Ce.createElement(_i,{className:"recharts-errorBars"},B)}}])}(Ce.Component);Fee(ox,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Fee(ox,"displayName","ErrorBar");function jw(e){"@babel/helpers - typeof";return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function LW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ag(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LW(Object(n),!0).forEach(function(r){yBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yBe(e,t,n){return t=vBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vBe(e){var t=xBe(e,"string");return jw(t)=="symbol"?t:t+""}function xBe(e,t){if(jw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jee=function(t){var n=t.children,r=t.formattedGraphicalItems,a=t.legendWidth,c=t.legendContent,d=Ac(n,Ov);if(!d)return null;var i=Ov.defaultProps,_=i!==void 0?Ag(Ag({},i),d.props):{},b;return d.props&&d.props.payload?b=d.props&&d.props.payload:c==="children"?b=(r||[]).reduce(function(T,A){var k=A.item,R=A.props,B=R.sectors||R.data||[];return T.concat(B.map(function(N){return{type:d.props.iconType||k.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):b=(r||[]).map(function(T){var A=T.item,k=A.type.defaultProps,R=k!==void 0?Ag(Ag({},k),A.props):{},B=R.dataKey,N=R.name,V=R.legendType,H=R.hide;return{inactive:H,dataKey:B,type:_.iconType||V||"square",color:JF(A),value:N||B,payload:R}}),Ag(Ag(Ag({},_),Ov.getWithHeight(d,a)),{},{payload:b,item:d})};function $w(e){"@babel/helpers - typeof";return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(e)}function zW(e){return TBe(e)||SBe(e)||wBe(e)||bBe()}function bBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wBe(e,t){if(e){if(typeof e=="string")return qL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qL(e,t)}}function SBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TBe(e){if(Array.isArray(e))return qL(e)}function qL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ta(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NW(Object(n),!0).forEach(function(r){Rv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Rv(e,t,n){return t=EBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EBe(e){var t=ABe(e,"string");return $w(t)=="symbol"?t:t+""}function ABe(e,t){if($w(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($w(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zo(e,t,n){return Nr(e)||Nr(t)?n:us(t)?Rc(e,t,n):$r(t)?t(e):n}function Db(e,t,n,r){var a=SFe(e,function(i){return Zo(i,t)});if(n==="number"){var c=a.filter(function(i){return zn(i)||parseFloat(i)});return c.length?[bI(c),Fp(c)]:[1/0,-1/0]}var d=r?a.filter(function(i){return!Nr(i)}):a;return d.map(function(i){return us(i)||i instanceof Date?i:""})}var PBe=function(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,d=-1,i=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(i<=1)return 0;if(c&&c.axisType==="angleAxis"&&Math.abs(Math.abs(c.range[1]-c.range[0])-360)<=1e-6)for(var _=c.range,b=0;b<i;b++){var T=b>0?a[b-1].coordinate:a[i-1].coordinate,A=a[b].coordinate,k=b>=i-1?a[0].coordinate:a[b+1].coordinate,R=void 0;if(_l(A-T)!==_l(k-A)){var B=[];if(_l(k-A)===_l(_[1]-_[0])){R=k;var N=A+_[1]-_[0];B[0]=Math.min(N,(N+T)/2),B[1]=Math.max(N,(N+T)/2)}else{R=T;var V=k+_[1]-_[0];B[0]=Math.min(A,(V+A)/2),B[1]=Math.max(A,(V+A)/2)}var H=[Math.min(A,(R+A)/2),Math.max(A,(R+A)/2)];if(t>H[0]&&t<=H[1]||t>=B[0]&&t<=B[1]){d=a[b].index;break}}else{var G=Math.min(T,k),q=Math.max(T,k);if(t>(G+A)/2&&t<=(q+A)/2){d=a[b].index;break}}}else for(var Q=0;Q<i;Q++)if(Q===0&&t<=(r[Q].coordinate+r[Q+1].coordinate)/2||Q>0&&Q<i-1&&t>(r[Q].coordinate+r[Q-1].coordinate)/2&&t<=(r[Q].coordinate+r[Q+1].coordinate)/2||Q===i-1&&t>(r[Q].coordinate+r[Q-1].coordinate)/2){d=r[Q].index;break}return d},JF=function(t){var n,r=t,a=r.type.displayName,c=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Ta(Ta({},t.type.defaultProps),t.props):t.props,d=c.stroke,i=c.fill,_;switch(a){case"Line":_=d;break;case"Area":case"Radar":_=d&&d!=="none"?d:i;break;default:_=i;break}return _},CBe=function(t){var n=t.barSize,r=t.totalSize,a=t.stackGroups,c=a===void 0?{}:a;if(!c)return{};for(var d={},i=Object.keys(c),_=0,b=i.length;_<b;_++)for(var T=c[i[_]].stackGroups,A=Object.keys(T),k=0,R=A.length;k<R;k++){var B=T[A[k]],N=B.items,V=B.cateAxisId,H=N.filter(function(fe){return sf(fe.type).indexOf("Bar")>=0});if(H&&H.length){var G=H[0].type.defaultProps,q=G!==void 0?Ta(Ta({},G),H[0].props):H[0].props,Q=q.barSize,te=q[V];d[te]||(d[te]=[]);var ue=Nr(Q)?n:Q;d[te].push({item:H[0],stackList:H.slice(1),barSize:Nr(ue)?void 0:yl(ue,r,0)})}}return d},IBe=function(t){var n=t.barGap,r=t.barCategoryGap,a=t.bandSize,c=t.sizeList,d=c===void 0?[]:c,i=t.maxBarSize,_=d.length;if(_<1)return null;var b=yl(n,a,0,!0),T,A=[];if(d[0].barSize===+d[0].barSize){var k=!1,R=a/_,B=d.reduce(function(Q,te){return Q+te.barSize||0},0);B+=(_-1)*b,B>=a&&(B-=(_-1)*b,b=0),B>=a&&R>0&&(k=!0,R*=.9,B=_*R);var N=(a-B)/2>>0,V={offset:N-b,size:0};T=d.reduce(function(Q,te){var ue={item:te.item,position:{offset:V.offset+V.size+b,size:k?R:te.barSize}},fe=[].concat(zW(Q),[ue]);return V=fe[fe.length-1].position,te.stackList&&te.stackList.length&&te.stackList.forEach(function(ye){fe.push({item:ye,position:V})}),fe},A)}else{var H=yl(r,a,0,!0);a-2*H-(_-1)*b<=0&&(b=0);var G=(a-2*H-(_-1)*b)/_;G>1&&(G>>=0);var q=i===+i?Math.min(G,i):G;T=d.reduce(function(Q,te,ue){var fe=[].concat(zW(Q),[{item:te.item,position:{offset:H+(G+b)*ue+(G-q)/2,size:q}}]);return te.stackList&&te.stackList.length&&te.stackList.forEach(function(ye){fe.push({item:ye,position:fe[fe.length-1].position})}),fe},A)}return T},MBe=function(t,n,r,a){var c=r.children,d=r.width,i=r.margin,_=d-(i.left||0)-(i.right||0),b=jee({children:c,legendWidth:_});if(b){var T=a||{},A=T.width,k=T.height,R=b.align,B=b.verticalAlign,N=b.layout;if((N==="vertical"||N==="horizontal"&&B==="middle")&&R!=="center"&&zn(t[R]))return Ta(Ta({},t),{},Rv({},R,t[R]+(A||0)));if((N==="horizontal"||N==="vertical"&&R==="center")&&B!=="middle"&&zn(t[B]))return Ta(Ta({},t),{},Rv({},B,t[B]+(k||0)))}return t},OBe=function(t,n,r){return Nr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},$ee=function(t,n,r,a,c){var d=n.props.children,i=bl(d,ox).filter(function(b){return OBe(a,c,b.props.direction)});if(i&&i.length){var _=i.map(function(b){return b.props.dataKey});return t.reduce(function(b,T){var A=Zo(T,r);if(Nr(A))return b;var k=Array.isArray(A)?[bI(A),Fp(A)]:[A,A],R=_.reduce(function(B,N){var V=Zo(T,N,0),H=k[0]-Math.abs(Array.isArray(V)?V[0]:V),G=k[1]+Math.abs(Array.isArray(V)?V[1]:V);return[Math.min(H,B[0]),Math.max(G,B[1])]},[1/0,-1/0]);return[Math.min(R[0],b[0]),Math.max(R[1],b[1])]},[1/0,-1/0])}return null},kBe=function(t,n,r,a,c){var d=n.map(function(i){return $ee(t,i,r,c,a)}).filter(function(i){return!Nr(i)});return d&&d.length?d.reduce(function(i,_){return[Math.min(i[0],_[0]),Math.max(i[1],_[1])]},[1/0,-1/0]):null},Uee=function(t,n,r,a,c){var d=n.map(function(_){var b=_.props.dataKey;return r==="number"&&b&&$ee(t,_,b,a)||Db(t,b,r,c)});if(r==="number")return d.reduce(function(_,b){return[Math.min(_[0],b[0]),Math.max(_[1],b[1])]},[1/0,-1/0]);var i={};return d.reduce(function(_,b){for(var T=0,A=b.length;T<A;T++)i[b[T]]||(i[b[T]]=!0,_.push(b[T]));return _},[])},Vee=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},Wee=function(t,n,r,a){if(a)return t.map(function(_){return _.coordinate});var c,d,i=t.map(function(_){return _.coordinate===n&&(c=!0),_.coordinate===r&&(d=!0),_.coordinate});return c||i.push(n),d||i.push(r),i},of=function(t,n,r){if(!t)return null;var a=t.scale,c=t.duplicateDomain,d=t.type,i=t.range,_=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,b=(n||r)&&d==="category"&&a.bandwidth?a.bandwidth()/_:0;if(b=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?_l(i[0]-i[1])*2*b:b,n&&(t.ticks||t.niceTicks)){var T=(t.ticks||t.niceTicks).map(function(A){var k=c?c.indexOf(A):A;return{coordinate:a(k)+b,value:A,offset:b}});return T.filter(function(A){return!J0(A.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(A,k){return{coordinate:a(A)+b,value:A,index:k,offset:b}}):a.ticks&&!r?a.ticks(t.tickCount).map(function(A){return{coordinate:a(A)+b,value:A,offset:b}}):a.domain().map(function(A,k){return{coordinate:a(A)+b,value:c?c[A]:A,index:k,offset:b}})},dR=new WeakMap,u2=function(t,n){if(typeof n!="function")return t;dR.has(t)||dR.set(t,new WeakMap);var r=dR.get(t);if(r.has(n))return r.get(n);var a=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,a),a},Gee=function(t,n,r){var a=t.scale,c=t.type,d=t.layout,i=t.axisType;if(a==="auto")return d==="radial"&&i==="radiusAxis"?{scale:Dw(),realScaleType:"band"}:d==="radial"&&i==="angleAxis"?{scale:iP(),realScaleType:"linear"}:c==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:Rb(),realScaleType:"point"}:c==="category"?{scale:Dw(),realScaleType:"band"}:{scale:iP(),realScaleType:"linear"};if(NS(a)){var _="scale".concat(iI(a));return{scale:(MW[_]||Rb)(),realScaleType:MW[_]?_:"point"}}return $r(a)?{scale:a}:{scale:Rb(),realScaleType:"point"}},FW=1e-4,Hee=function(t){var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,a=t.range(),c=Math.min(a[0],a[1])-FW,d=Math.max(a[0],a[1])+FW,i=t(n[0]),_=t(n[r-1]);(i<c||i>d||_<c||_>d)&&t.domain([n[0],n[r-1]])}},RBe=function(t,n){if(!t)return null;for(var r=0,a=t.length;r<a;r++)if(t[r].item===n)return t[r].position;return null},DBe=function(t,n){if(!n||n.length!==2||!zn(n[0])||!zn(n[1]))return t;var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]),c=[t[0],t[1]];return(!zn(t[0])||t[0]<r)&&(c[0]=r),(!zn(t[1])||t[1]>a)&&(c[1]=a),c[0]>a&&(c[0]=a),c[1]<r&&(c[1]=r),c},LBe=function(t){var n=t.length;if(!(n<=0))for(var r=0,a=t[0].length;r<a;++r)for(var c=0,d=0,i=0;i<n;++i){var _=J0(t[i][r][1])?t[i][r][0]:t[i][r][1];_>=0?(t[i][r][0]=c,t[i][r][1]=c+_,c=t[i][r][1]):(t[i][r][0]=d,t[i][r][1]=d+_,d=t[i][r][1])}},zBe=function(t){var n=t.length;if(!(n<=0))for(var r=0,a=t[0].length;r<a;++r)for(var c=0,d=0;d<n;++d){var i=J0(t[d][r][1])?t[d][r][0]:t[d][r][1];i>=0?(t[d][r][0]=c,t[d][r][1]=c+i,c=t[d][r][1]):(t[d][r][0]=0,t[d][r][1]=0)}},NBe={sign:LBe,expand:QAe,none:e0,silhouette:ePe,wiggle:tPe,positive:zBe},FBe=function(t,n,r){var a=n.map(function(i){return i.props.dataKey}),c=NBe[r],d=JAe().keys(a).value(function(i,_){return+Zo(i,_,0)}).order(_L).offset(c);return d(t)},BBe=function(t,n,r,a,c,d){if(!t)return null;var i=d?n.reverse():n,_={},b=i.reduce(function(A,k){var R,B=(R=k.type)!==null&&R!==void 0&&R.defaultProps?Ta(Ta({},k.type.defaultProps),k.props):k.props,N=B.stackId,V=B.hide;if(V)return A;var H=B[r],G=A[H]||{hasStack:!1,stackGroups:{}};if(us(N)){var q=G.stackGroups[N]||{numericAxisId:r,cateAxisId:a,items:[]};q.items.push(k),G.hasStack=!0,G.stackGroups[N]=q}else G.stackGroups[Em("_stackId_")]={numericAxisId:r,cateAxisId:a,items:[k]};return Ta(Ta({},A),{},Rv({},H,G))},_),T={};return Object.keys(b).reduce(function(A,k){var R=b[k];if(R.hasStack){var B={};R.stackGroups=Object.keys(R.stackGroups).reduce(function(N,V){var H=R.stackGroups[V];return Ta(Ta({},N),{},Rv({},V,{numericAxisId:r,cateAxisId:a,items:H.items,stackedData:FBe(t,H.items,c)}))},B)}return Ta(Ta({},A),{},Rv({},k,R))},T)},qee=function(t,n){var r=n.realScaleType,a=n.type,c=n.tickCount,d=n.originalDomain,i=n.allowDecimals,_=r||n.scale;if(_!=="auto"&&_!=="linear")return null;if(c&&a==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var b=t.domain();if(!b.length)return null;var T=QFe(b,c,i);return t.domain([bI(T),Fp(T)]),{niceTicks:T}}if(c&&a==="number"){var A=t.domain(),k=eBe(A,c,i);return{niceTicks:k}}return null};function c0(e){var t=e.axis,n=e.ticks,r=e.bandSize,a=e.entry,c=e.index,d=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Nr(a[t.dataKey])){var i=FA(n,"value",a[t.dataKey]);if(i)return i.coordinate+r/2}return n[c]?n[c].coordinate+r/2:null}var _=Zo(a,Nr(d)?t.dataKey:d);return Nr(_)?null:t.scale(_)}var BW=function(t){var n=t.axis,r=t.ticks,a=t.offset,c=t.bandSize,d=t.entry,i=t.index;if(n.type==="category")return r[i]?r[i].coordinate+a:null;var _=Zo(d,n.dataKey,n.domain[i]);return Nr(_)?null:n.scale(_)-c/2+a},jBe=function(t){var n=t.numericAxis,r=n.scale.domain();if(n.type==="number"){var a=Math.min(r[0],r[1]),c=Math.max(r[0],r[1]);return a<=0&&c>=0?0:c<0?c:a}return r[0]},$Be=function(t,n){var r,a=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Ta(Ta({},t.type.defaultProps),t.props):t.props,c=a.stackId;if(us(c)){var d=n[c];if(d){var i=d.items.indexOf(t);return i>=0?d.stackedData[i]:null}}return null},UBe=function(t){return t.reduce(function(n,r){return[bI(r.concat([n[0]]).filter(zn)),Fp(r.concat([n[1]]).filter(zn))]},[1/0,-1/0])},Zee=function(t,n,r){return Object.keys(t).reduce(function(a,c){var d=t[c],i=d.stackedData,_=i.reduce(function(b,T){var A=UBe(T.slice(n,r+1));return[Math.min(b[0],A[0]),Math.max(b[1],A[1])]},[1/0,-1/0]);return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},jW=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,$W=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ZL=function(t,n,r){if($r(t))return t(n,r);if(!Array.isArray(t))return n;var a=[];if(zn(t[0]))a[0]=r?t[0]:Math.min(t[0],n[0]);else if(jW.test(t[0])){var c=+jW.exec(t[0])[1];a[0]=n[0]-c}else $r(t[0])?a[0]=t[0](n[0]):a[0]=n[0];if(zn(t[1]))a[1]=r?t[1]:Math.max(t[1],n[1]);else if($W.test(t[1])){var d=+$W.exec(t[1])[1];a[1]=n[1]+d}else $r(t[1])?a[1]=t[1](n[1]):a[1]=n[1];return a},hP=function(t,n,r){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!r||a>0)return a}if(t&&n&&n.length>=2){for(var c=AF(n,function(A){return A.coordinate}),d=1/0,i=1,_=c.length;i<_;i++){var b=c[i],T=c[i-1];d=Math.min((b.coordinate||0)-(T.coordinate||0),d)}return d===1/0?0:d}return r?void 0:0},UW=function(t,n,r){return!t||!t.length||pm(t,Rc(r,"type.defaultProps.domain"))?n:t},Xee=function(t,n){var r=t.type.defaultProps?Ta(Ta({},t.type.defaultProps),t.props):t.props,a=r.dataKey,c=r.name,d=r.unit,i=r.formatter,_=r.tooltipType,b=r.chartType,T=r.hide;return Ta(Ta({},wr(t,!1)),{},{dataKey:a,unit:d,formatter:i,name:c||a,color:JF(t),value:Zo(n,a),type:_,payload:n,chartType:b,hide:T})};function Uw(e){"@babel/helpers - typeof";return Uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uw(e)}function VW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Yd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VW(Object(n),!0).forEach(function(r){Kee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Kee(e,t,n){return t=VBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VBe(e){var t=WBe(e,"string");return Uw(t)=="symbol"?t:t+""}function WBe(e,t){if(Uw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Uw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GBe(e,t){return XBe(e)||ZBe(e,t)||qBe(e,t)||HBe()}function HBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qBe(e,t){if(e){if(typeof e=="string")return WW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WW(e,t)}}function WW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ZBe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function XBe(e){if(Array.isArray(e))return e}var dP=Math.PI/180,KBe=function(t){return t*180/Math.PI},No=function(t,n,r,a){return{x:t+Math.cos(-dP*a)*r,y:n+Math.sin(-dP*a)*r}},Yee=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},YBe=function(t,n,r,a,c){var d=t.width,i=t.height,_=t.startAngle,b=t.endAngle,T=yl(t.cx,d,d/2),A=yl(t.cy,i,i/2),k=Yee(d,i,r),R=yl(t.innerRadius,k,0),B=yl(t.outerRadius,k,k*.8),N=Object.keys(n);return N.reduce(function(V,H){var G=n[H],q=G.domain,Q=G.reversed,te;if(Nr(G.range))a==="angleAxis"?te=[_,b]:a==="radiusAxis"&&(te=[R,B]),Q&&(te=[te[1],te[0]]);else{te=G.range;var ue=te,fe=GBe(ue,2);_=fe[0],b=fe[1]}var ye=Gee(G,c),De=ye.realScaleType,Ne=ye.scale;Ne.domain(q).range(te),Hee(Ne);var Fe=qee(Ne,Yd(Yd({},G),{},{realScaleType:De})),Le=Yd(Yd(Yd({},G),Fe),{},{range:te,radius:B,realScaleType:De,scale:Ne,cx:T,cy:A,innerRadius:R,outerRadius:B,startAngle:_,endAngle:b});return Yd(Yd({},V),{},Kee({},H,Le))},{})},JBe=function(t,n){var r=t.x,a=t.y,c=n.x,d=n.y;return Math.sqrt(Math.pow(r-c,2)+Math.pow(a-d,2))},QBe=function(t,n){var r=t.x,a=t.y,c=n.cx,d=n.cy,i=JBe({x:r,y:a},{x:c,y:d});if(i<=0)return{radius:i};var _=(r-c)/i,b=Math.acos(_);return a>d&&(b=2*Math.PI-b),{radius:i,angle:KBe(b),angleInRadian:b}},eje=function(t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),c=Math.floor(r/360),d=Math.min(a,c);return{startAngle:n-d*360,endAngle:r-d*360}},tje=function(t,n){var r=n.startAngle,a=n.endAngle,c=Math.floor(r/360),d=Math.floor(a/360),i=Math.min(c,d);return t+i*360},GW=function(t,n){var r=t.x,a=t.y,c=QBe({x:r,y:a},n),d=c.radius,i=c.angle,_=n.innerRadius,b=n.outerRadius;if(d<_||d>b)return!1;if(d===0)return!0;var T=eje(n),A=T.startAngle,k=T.endAngle,R=i,B;if(A<=k){for(;R>k;)R-=360;for(;R<A;)R+=360;B=R>=A&&R<=k}else{for(;R>A;)R-=360;for(;R<k;)R+=360;B=R>=k&&R<=A}return B?Yd(Yd({},n),{},{radius:d,angle:tje(R,n)}):null},Jee=function(t){return!X.isValidElement(t)&&!$r(t)&&typeof t!="boolean"?t.className:""};function Vw(e){"@babel/helpers - typeof";return Vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vw(e)}var nje=["offset"];function rje(e){return sje(e)||aje(e)||oje(e)||ije()}function ije(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oje(e,t){if(e){if(typeof e=="string")return XL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XL(e,t)}}function aje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sje(e){if(Array.isArray(e))return XL(e)}function XL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lje(e,t){if(e==null)return{};var n=cje(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function HW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function as(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HW(Object(n),!0).forEach(function(r){uje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uje(e,t,n){return t=hje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hje(e){var t=dje(e,"string");return Vw(t)=="symbol"?t:t+""}function dje(e,t){if(Vw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ww.apply(this,arguments)}var fje=function(t){var n=t.value,r=t.formatter,a=Nr(t.children)?n:t.children;return $r(r)?r(a):a},pje=function(t,n){var r=_l(n-t),a=Math.min(Math.abs(n-t),360);return r*a},mje=function(t,n,r){var a=t.position,c=t.viewBox,d=t.offset,i=t.className,_=c,b=_.cx,T=_.cy,A=_.innerRadius,k=_.outerRadius,R=_.startAngle,B=_.endAngle,N=_.clockWise,V=(A+k)/2,H=pje(R,B),G=H>=0?1:-1,q,Q;a==="insideStart"?(q=R+G*d,Q=N):a==="insideEnd"?(q=B-G*d,Q=!N):a==="end"&&(q=B+G*d,Q=N),Q=H<=0?Q:!Q;var te=No(b,T,V,q),ue=No(b,T,V,q+(Q?1:-1)*359),fe="M".concat(te.x,",").concat(te.y,`
    A`).concat(V,",").concat(V,",0,1,").concat(Q?0:1,`,
    `).concat(ue.x,",").concat(ue.y),ye=Nr(t.id)?Em("recharts-radial-line-"):t.id;return Ce.createElement("text",Ww({},r,{dominantBaseline:"central",className:li("recharts-radial-bar-label",i)}),Ce.createElement("defs",null,Ce.createElement("path",{id:ye,d:fe})),Ce.createElement("textPath",{xlinkHref:"#".concat(ye)},n))},gje=function(t){var n=t.viewBox,r=t.offset,a=t.position,c=n,d=c.cx,i=c.cy,_=c.innerRadius,b=c.outerRadius,T=c.startAngle,A=c.endAngle,k=(T+A)/2;if(a==="outside"){var R=No(d,i,b+r,k),B=R.x,N=R.y;return{x:B,y:N,textAnchor:B>=d?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"end"};var V=(_+b)/2,H=No(d,i,V,k),G=H.x,q=H.y;return{x:G,y:q,textAnchor:"middle",verticalAnchor:"middle"}},_je=function(t){var n=t.viewBox,r=t.parentViewBox,a=t.offset,c=t.position,d=n,i=d.x,_=d.y,b=d.width,T=d.height,A=T>=0?1:-1,k=A*a,R=A>0?"end":"start",B=A>0?"start":"end",N=b>=0?1:-1,V=N*a,H=N>0?"end":"start",G=N>0?"start":"end";if(c==="top"){var q={x:i+b/2,y:_-A*a,textAnchor:"middle",verticalAnchor:R};return as(as({},q),r?{height:Math.max(_-r.y,0),width:b}:{})}if(c==="bottom"){var Q={x:i+b/2,y:_+T+k,textAnchor:"middle",verticalAnchor:B};return as(as({},Q),r?{height:Math.max(r.y+r.height-(_+T),0),width:b}:{})}if(c==="left"){var te={x:i-V,y:_+T/2,textAnchor:H,verticalAnchor:"middle"};return as(as({},te),r?{width:Math.max(te.x-r.x,0),height:T}:{})}if(c==="right"){var ue={x:i+b+V,y:_+T/2,textAnchor:G,verticalAnchor:"middle"};return as(as({},ue),r?{width:Math.max(r.x+r.width-ue.x,0),height:T}:{})}var fe=r?{width:b,height:T}:{};return c==="insideLeft"?as({x:i+V,y:_+T/2,textAnchor:G,verticalAnchor:"middle"},fe):c==="insideRight"?as({x:i+b-V,y:_+T/2,textAnchor:H,verticalAnchor:"middle"},fe):c==="insideTop"?as({x:i+b/2,y:_+k,textAnchor:"middle",verticalAnchor:B},fe):c==="insideBottom"?as({x:i+b/2,y:_+T-k,textAnchor:"middle",verticalAnchor:R},fe):c==="insideTopLeft"?as({x:i+V,y:_+k,textAnchor:G,verticalAnchor:B},fe):c==="insideTopRight"?as({x:i+b-V,y:_+k,textAnchor:H,verticalAnchor:B},fe):c==="insideBottomLeft"?as({x:i+V,y:_+T-k,textAnchor:G,verticalAnchor:R},fe):c==="insideBottomRight"?as({x:i+b-V,y:_+T-k,textAnchor:H,verticalAnchor:R},fe):Z0(c)&&(zn(c.x)||Ug(c.x))&&(zn(c.y)||Ug(c.y))?as({x:i+yl(c.x,b),y:_+yl(c.y,T),textAnchor:"end",verticalAnchor:"end"},fe):as({x:i+b/2,y:_+T/2,textAnchor:"middle",verticalAnchor:"middle"},fe)},yje=function(t){return"cx"in t&&zn(t.cx)};function bs(e){var t=e.offset,n=t===void 0?5:t,r=lje(e,nje),a=as({offset:n},r),c=a.viewBox,d=a.position,i=a.value,_=a.children,b=a.content,T=a.className,A=T===void 0?"":T,k=a.textBreakAll;if(!c||Nr(i)&&Nr(_)&&!X.isValidElement(b)&&!$r(b))return null;if(X.isValidElement(b))return X.cloneElement(b,a);var R;if($r(b)){if(R=X.createElement(b,a),X.isValidElement(R))return R}else R=fje(a);var B=yje(c),N=wr(a,!0);if(B&&(d==="insideStart"||d==="insideEnd"||d==="end"))return mje(a,R,N);var V=B?gje(a):_je(a);return Ce.createElement(u_,Ww({className:li("recharts-label",A)},N,V,{breakAll:k}),R)}bs.displayName="Label";var Qee=function(t){var n=t.cx,r=t.cy,a=t.angle,c=t.startAngle,d=t.endAngle,i=t.r,_=t.radius,b=t.innerRadius,T=t.outerRadius,A=t.x,k=t.y,R=t.top,B=t.left,N=t.width,V=t.height,H=t.clockWise,G=t.labelViewBox;if(G)return G;if(zn(N)&&zn(V)){if(zn(A)&&zn(k))return{x:A,y:k,width:N,height:V};if(zn(R)&&zn(B))return{x:R,y:B,width:N,height:V}}return zn(A)&&zn(k)?{x:A,y:k,width:0,height:0}:zn(n)&&zn(r)?{cx:n,cy:r,startAngle:c||a||0,endAngle:d||a||0,innerRadius:b||0,outerRadius:T||_||i||0,clockWise:H}:t.viewBox?t.viewBox:{}},vje=function(t,n){return t?t===!0?Ce.createElement(bs,{key:"label-implicit",viewBox:n}):us(t)?Ce.createElement(bs,{key:"label-implicit",viewBox:n,value:t}):X.isValidElement(t)?t.type===bs?X.cloneElement(t,{key:"label-implicit",viewBox:n}):Ce.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):$r(t)?Ce.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):Z0(t)?Ce.createElement(bs,Ww({viewBox:n},t,{key:"label-implicit"})):null:null},xje=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var a=t.children,c=Qee(t),d=bl(a,bs).map(function(_,b){return X.cloneElement(_,{viewBox:n||c,key:"label-".concat(b)})});if(!r)return d;var i=vje(t.label,n||c);return[i].concat(rje(d))};bs.parseViewBox=Qee;bs.renderCallByParent=xje;function bje(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var wje=bje;const Sje=lo(wje);function Gw(e){"@babel/helpers - typeof";return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gw(e)}var Tje=["valueAccessor"],Eje=["data","dataKey","clockWise","id","textBreakAll"];function Aje(e){return Mje(e)||Ije(e)||Cje(e)||Pje()}function Pje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cje(e,t){if(e){if(typeof e=="string")return KL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KL(e,t)}}function Ije(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mje(e){if(Array.isArray(e))return KL(e)}function KL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fP(){return fP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fP.apply(this,arguments)}function qW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ZW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qW(Object(n),!0).forEach(function(r){Oje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Oje(e,t,n){return t=kje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kje(e){var t=Rje(e,"string");return Gw(t)=="symbol"?t:t+""}function Rje(e,t){if(Gw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XW(e,t){if(e==null)return{};var n=Dje(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var Lje=function(t){return Array.isArray(t.value)?Sje(t.value):t.value};function ih(e){var t=e.valueAccessor,n=t===void 0?Lje:t,r=XW(e,Tje),a=r.data,c=r.dataKey,d=r.clockWise,i=r.id,_=r.textBreakAll,b=XW(r,Eje);return!a||!a.length?null:Ce.createElement(_i,{className:"recharts-label-list"},a.map(function(T,A){var k=Nr(c)?n(T,A):Zo(T&&T.payload,c),R=Nr(i)?{}:{id:"".concat(i,"-").concat(A)};return Ce.createElement(bs,fP({},wr(T,!0),b,R,{parentViewBox:T.parentViewBox,value:k,textBreakAll:_,viewBox:bs.parseViewBox(Nr(d)?T:ZW(ZW({},T),{},{clockWise:d})),key:"label-".concat(A),index:A}))}))}ih.displayName="LabelList";function zje(e,t){return e?e===!0?Ce.createElement(ih,{key:"labelList-implicit",data:t}):Ce.isValidElement(e)||$r(e)?Ce.createElement(ih,{key:"labelList-implicit",data:t,content:e}):Z0(e)?Ce.createElement(ih,fP({data:t},e,{key:"labelList-implicit"})):null:null}function Nje(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=bl(r,ih).map(function(d,i){return X.cloneElement(d,{data:t,key:"labelList-".concat(i)})});if(!n)return a;var c=zje(e.label,t);return[c].concat(Aje(a))}ih.renderCallByParent=Nje;function Hw(e){"@babel/helpers - typeof";return Hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hw(e)}function YL(){return YL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YL.apply(this,arguments)}function KW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function YW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KW(Object(n),!0).forEach(function(r){Fje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fje(e,t,n){return t=Bje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bje(e){var t=jje(e,"string");return Hw(t)=="symbol"?t:t+""}function jje(e,t){if(Hw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $je=function(t,n){var r=_l(n-t),a=Math.min(Math.abs(n-t),359.999);return r*a},h2=function(t){var n=t.cx,r=t.cy,a=t.radius,c=t.angle,d=t.sign,i=t.isExternal,_=t.cornerRadius,b=t.cornerIsExternal,T=_*(i?1:-1)+a,A=Math.asin(_/T)/dP,k=b?c:c+d*A,R=No(n,r,T,k),B=No(n,r,a,k),N=b?c-d*A:c,V=No(n,r,T*Math.cos(A*dP),N);return{center:R,circleTangency:B,lineTangency:V,theta:A}},ete=function(t){var n=t.cx,r=t.cy,a=t.innerRadius,c=t.outerRadius,d=t.startAngle,i=t.endAngle,_=$je(d,i),b=d+_,T=No(n,r,c,d),A=No(n,r,c,b),k="M ".concat(T.x,",").concat(T.y,`
    A `).concat(c,",").concat(c,`,0,
    `).concat(+(Math.abs(_)>180),",").concat(+(d>b),`,
    `).concat(A.x,",").concat(A.y,`
  `);if(a>0){var R=No(n,r,a,d),B=No(n,r,a,b);k+="L ".concat(B.x,",").concat(B.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(_)>180),",").concat(+(d<=b),`,
            `).concat(R.x,",").concat(R.y," Z")}else k+="L ".concat(n,",").concat(r," Z");return k},Uje=function(t){var n=t.cx,r=t.cy,a=t.innerRadius,c=t.outerRadius,d=t.cornerRadius,i=t.forceCornerRadius,_=t.cornerIsExternal,b=t.startAngle,T=t.endAngle,A=_l(T-b),k=h2({cx:n,cy:r,radius:c,angle:b,sign:A,cornerRadius:d,cornerIsExternal:_}),R=k.circleTangency,B=k.lineTangency,N=k.theta,V=h2({cx:n,cy:r,radius:c,angle:T,sign:-A,cornerRadius:d,cornerIsExternal:_}),H=V.circleTangency,G=V.lineTangency,q=V.theta,Q=_?Math.abs(b-T):Math.abs(b-T)-N-q;if(Q<0)return i?"M ".concat(B.x,",").concat(B.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):ete({cx:n,cy:r,innerRadius:a,outerRadius:c,startAngle:b,endAngle:T});var te="M ".concat(B.x,",").concat(B.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(A<0),",").concat(R.x,",").concat(R.y,`
    A`).concat(c,",").concat(c,",0,").concat(+(Q>180),",").concat(+(A<0),",").concat(H.x,",").concat(H.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(A<0),",").concat(G.x,",").concat(G.y,`
  `);if(a>0){var ue=h2({cx:n,cy:r,radius:a,angle:b,sign:A,isExternal:!0,cornerRadius:d,cornerIsExternal:_}),fe=ue.circleTangency,ye=ue.lineTangency,De=ue.theta,Ne=h2({cx:n,cy:r,radius:a,angle:T,sign:-A,isExternal:!0,cornerRadius:d,cornerIsExternal:_}),Fe=Ne.circleTangency,Le=Ne.lineTangency,Ze=Ne.theta,He=_?Math.abs(b-T):Math.abs(b-T)-De-Ze;if(He<0&&d===0)return"".concat(te,"L").concat(n,",").concat(r,"Z");te+="L".concat(Le.x,",").concat(Le.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(A<0),",").concat(Fe.x,",").concat(Fe.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(He>180),",").concat(+(A>0),",").concat(fe.x,",").concat(fe.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(A<0),",").concat(ye.x,",").concat(ye.y,"Z")}else te+="L".concat(n,",").concat(r,"Z");return te},Vje={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},tte=function(t){var n=YW(YW({},Vje),t),r=n.cx,a=n.cy,c=n.innerRadius,d=n.outerRadius,i=n.cornerRadius,_=n.forceCornerRadius,b=n.cornerIsExternal,T=n.startAngle,A=n.endAngle,k=n.className;if(d<c||T===A)return null;var R=li("recharts-sector",k),B=d-c,N=yl(i,B,0,!0),V;return N>0&&Math.abs(T-A)<360?V=Uje({cx:r,cy:a,innerRadius:c,outerRadius:d,cornerRadius:Math.min(N,B/2),forceCornerRadius:_,cornerIsExternal:b,startAngle:T,endAngle:A}):V=ete({cx:r,cy:a,innerRadius:c,outerRadius:d,startAngle:T,endAngle:A}),Ce.createElement("path",YL({},wr(n,!0),{className:R,d:V,role:"img"}))};function qw(e){"@babel/helpers - typeof";return qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qw(e)}function JL(){return JL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JL.apply(this,arguments)}function JW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function QW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JW(Object(n),!0).forEach(function(r){Wje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Wje(e,t,n){return t=Gje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gje(e){var t=Hje(e,"string");return qw(t)=="symbol"?t:t+""}function Hje(e,t){if(qw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(qw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eG={curveBasisClosed:$Ae,curveBasisOpen:UAe,curveBasis:jAe,curveBumpX:AAe,curveBumpY:PAe,curveLinearClosed:VAe,curveLinear:sI,curveMonotoneX:WAe,curveMonotoneY:GAe,curveNatural:HAe,curveStep:qAe,curveStepAfter:XAe,curveStepBefore:ZAe},d2=function(t){return t.x===+t.x&&t.y===+t.y},Y1=function(t){return t.x},J1=function(t){return t.y},qje=function(t,n){if($r(t))return t;var r="curve".concat(iI(t));return(r==="curveMonotone"||r==="curveBump")&&n?eG["".concat(r).concat(n==="vertical"?"Y":"X")]:eG[r]||sI},Zje=function(t){var n=t.type,r=n===void 0?"linear":n,a=t.points,c=a===void 0?[]:a,d=t.baseLine,i=t.layout,_=t.connectNulls,b=_===void 0?!1:_,T=qje(r,i),A=b?c.filter(function(N){return d2(N)}):c,k;if(Array.isArray(d)){var R=b?d.filter(function(N){return d2(N)}):d,B=A.map(function(N,V){return QW(QW({},N),{},{base:R[V]})});return i==="vertical"?k=t2().y(J1).x1(Y1).x0(function(N){return N.base.x}):k=t2().x(Y1).y1(J1).y0(function(N){return N.base.y}),k.defined(d2).curve(T),k(B)}return i==="vertical"&&zn(d)?k=t2().y(J1).x1(Y1).x0(d):zn(d)?k=t2().x(Y1).y1(J1).y0(d):k=HJ().x(Y1).y(J1),k.defined(d2).curve(T),k(A)},em=function(t){var n=t.className,r=t.points,a=t.path,c=t.pathRef;if((!r||!r.length)&&!a)return null;var d=r&&r.length?Zje(t):a;return Ce.createElement("path",JL({},wr(t,!1),BA(t),{className:li("recharts-curve",n),d,ref:c}))},nte={exports:{}},Xje="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Kje=Xje,Yje=Kje;function rte(){}function ite(){}ite.resetWarningCache=rte;var Jje=function(){function e(r,a,c,d,i,_){if(_!==Yje){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ite,resetWarningCache:rte};return n.PropTypes=n,n};nte.exports=Jje();var Qje=nte.exports;const Si=lo(Qje);var e4e=Object.getOwnPropertyNames,t4e=Object.getOwnPropertySymbols,n4e=Object.prototype.hasOwnProperty;function tG(e,t){return function(r,a,c){return e(r,a,c)&&t(r,a,c)}}function f2(e){return function(n,r,a){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,a);var c=a.cache,d=c.get(n),i=c.get(r);if(d&&i)return d===r&&i===n;c.set(n,r),c.set(r,n);var _=e(n,r,a);return c.delete(n),c.delete(r),_}}function nG(e){return e4e(e).concat(t4e(e))}var ote=Object.hasOwn||function(e,t){return n4e.call(e,t)};function ax(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var ate="_owner",rG=Object.getOwnPropertyDescriptor,iG=Object.keys;function r4e(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function i4e(e,t){return ax(e.getTime(),t.getTime())}function oG(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),c=0,d,i;(d=a.next())&&!d.done;){for(var _=t.entries(),b=!1,T=0;(i=_.next())&&!i.done;){var A=d.value,k=A[0],R=A[1],B=i.value,N=B[0],V=B[1];!b&&!r[T]&&(b=n.equals(k,N,c,T,e,t,n)&&n.equals(R,V,k,N,e,t,n))&&(r[T]=!0),T++}if(!b)return!1;c++}return!0}function o4e(e,t,n){var r=iG(e),a=r.length;if(iG(t).length!==a)return!1;for(var c;a-- >0;)if(c=r[a],c===ate&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ote(t,c)||!n.equals(e[c],t[c],c,c,e,t,n))return!1;return!0}function Q1(e,t,n){var r=nG(e),a=r.length;if(nG(t).length!==a)return!1;for(var c,d,i;a-- >0;)if(c=r[a],c===ate&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ote(t,c)||!n.equals(e[c],t[c],c,c,e,t,n)||(d=rG(e,c),i=rG(t,c),(d||i)&&(!d||!i||d.configurable!==i.configurable||d.enumerable!==i.enumerable||d.writable!==i.writable)))return!1;return!0}function a4e(e,t){return ax(e.valueOf(),t.valueOf())}function s4e(e,t){return e.source===t.source&&e.flags===t.flags}function aG(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),c,d;(c=a.next())&&!c.done;){for(var i=t.values(),_=!1,b=0;(d=i.next())&&!d.done;)!_&&!r[b]&&(_=n.equals(c.value,d.value,c.value,d.value,e,t,n))&&(r[b]=!0),b++;if(!_)return!1}return!0}function l4e(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var c4e="[object Arguments]",u4e="[object Boolean]",h4e="[object Date]",d4e="[object Map]",f4e="[object Number]",p4e="[object Object]",m4e="[object RegExp]",g4e="[object Set]",_4e="[object String]",y4e=Array.isArray,sG=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,lG=Object.assign,v4e=Object.prototype.toString.call.bind(Object.prototype.toString);function x4e(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,i=e.areSetsEqual,_=e.areTypedArraysEqual;return function(T,A,k){if(T===A)return!0;if(T==null||A==null||typeof T!="object"||typeof A!="object")return T!==T&&A!==A;var R=T.constructor;if(R!==A.constructor)return!1;if(R===Object)return a(T,A,k);if(y4e(T))return t(T,A,k);if(sG!=null&&sG(T))return _(T,A,k);if(R===Date)return n(T,A,k);if(R===RegExp)return d(T,A,k);if(R===Map)return r(T,A,k);if(R===Set)return i(T,A,k);var B=v4e(T);return B===h4e?n(T,A,k):B===m4e?d(T,A,k):B===d4e?r(T,A,k):B===g4e?i(T,A,k):B===p4e?typeof T.then!="function"&&typeof A.then!="function"&&a(T,A,k):B===c4e?a(T,A,k):B===u4e||B===f4e||B===_4e?c(T,A,k):!1}}function b4e(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Q1:r4e,areDatesEqual:i4e,areMapsEqual:r?tG(oG,Q1):oG,areObjectsEqual:r?Q1:o4e,arePrimitiveWrappersEqual:a4e,areRegExpsEqual:s4e,areSetsEqual:r?tG(aG,Q1):aG,areTypedArraysEqual:r?Q1:l4e};if(n&&(a=lG({},a,n(a))),t){var c=f2(a.areArraysEqual),d=f2(a.areMapsEqual),i=f2(a.areObjectsEqual),_=f2(a.areSetsEqual);a=lG({},a,{areArraysEqual:c,areMapsEqual:d,areObjectsEqual:i,areSetsEqual:_})}return a}function w4e(e){return function(t,n,r,a,c,d,i){return e(t,n,i)}}function S4e(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,c=e.strict;if(r)return function(_,b){var T=r(),A=T.cache,k=A===void 0?t?new WeakMap:void 0:A,R=T.meta;return n(_,b,{cache:k,equals:a,meta:R,strict:c})};if(t)return function(_,b){return n(_,b,{cache:new WeakMap,equals:a,meta:void 0,strict:c})};var d={cache:void 0,equals:a,meta:void 0,strict:c};return function(_,b){return n(_,b,d)}}var T4e=Cm();Cm({strict:!0});Cm({circular:!0});Cm({circular:!0,strict:!0});Cm({createInternalComparator:function(){return ax}});Cm({strict:!0,createInternalComparator:function(){return ax}});Cm({circular:!0,createInternalComparator:function(){return ax}});Cm({circular:!0,createInternalComparator:function(){return ax},strict:!0});function Cm(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,c=e.strict,d=c===void 0?!1:c,i=b4e(e),_=x4e(i),b=r?r(_):w4e(_);return S4e({circular:n,comparator:_,createState:a,equals:b,strict:d})}function E4e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function cG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(c){n<0&&(n=c),c-n>t?(e(c),n=-1):E4e(a)};requestAnimationFrame(r)}function QL(e){"@babel/helpers - typeof";return QL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QL(e)}function A4e(e){return M4e(e)||I4e(e)||C4e(e)||P4e()}function P4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C4e(e,t){if(e){if(typeof e=="string")return uG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uG(e,t)}}function uG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M4e(e){if(Array.isArray(e))return e}function O4e(){var e={},t=function(){return null},n=!1,r=function a(c){if(!n){if(Array.isArray(c)){if(!c.length)return;var d=c,i=A4e(d),_=i[0],b=i.slice(1);if(typeof _=="number"){cG(a.bind(null,b),_);return}a(_),cG(a.bind(null,b));return}QL(c)==="object"&&(e=c,t(e)),typeof c=="function"&&c()}};return{stop:function(){n=!0},start:function(c){n=!1,r(c)},subscribe:function(c){return t=c,function(){t=function(){return null}}}}}function Zw(e){"@babel/helpers - typeof";return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function hG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hG(Object(n),!0).forEach(function(r){ste(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ste(e,t,n){return t=k4e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k4e(e){var t=R4e(e,"string");return Zw(t)==="symbol"?t:String(t)}function R4e(e,t){if(Zw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Zw(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D4e=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(r,a){return r.filter(function(c){return a.includes(c)})})},L4e=function(t){return t},z4e=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Lb=function(t,n){return Object.keys(n).reduce(function(r,a){return dG(dG({},r),{},ste({},a,t(a,n[a])))},{})},fG=function(t,n,r){return t.map(function(a){return"".concat(z4e(a)," ").concat(n,"ms ").concat(r)}).join(",")};function N4e(e,t){return j4e(e)||B4e(e,t)||lte(e,t)||F4e()}function F4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B4e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function j4e(e){if(Array.isArray(e))return e}function $4e(e){return W4e(e)||V4e(e)||lte(e)||U4e()}function U4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lte(e,t){if(e){if(typeof e=="string")return ez(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ez(e,t)}}function V4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function W4e(e){if(Array.isArray(e))return ez(e)}function ez(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pP=1e-4,cte=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},ute=function(t,n){return t.map(function(r,a){return r*Math.pow(n,a)}).reduce(function(r,a){return r+a})},pG=function(t,n){return function(r){var a=cte(t,n);return ute(a,r)}},G4e=function(t,n){return function(r){var a=cte(t,n),c=[].concat($4e(a.map(function(d,i){return d*i}).slice(1)),[0]);return ute(c,r)}},mG=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0],c=n[1],d=n[2],i=n[3];if(n.length===1)switch(n[0]){case"linear":a=0,c=0,d=1,i=1;break;case"ease":a=.25,c=.1,d=.25,i=1;break;case"ease-in":a=.42,c=0,d=1,i=1;break;case"ease-out":a=.42,c=0,d=.58,i=1;break;case"ease-in-out":a=0,c=0,d=.58,i=1;break;default:{var _=n[0].split("(");if(_[0]==="cubic-bezier"&&_[1].split(")")[0].split(",").length===4){var b=_[1].split(")")[0].split(",").map(function(V){return parseFloat(V)}),T=N4e(b,4);a=T[0],c=T[1],d=T[2],i=T[3]}}}var A=pG(a,d),k=pG(c,i),R=G4e(a,d),B=function(H){return H>1?1:H<0?0:H},N=function(H){for(var G=H>1?1:H,q=G,Q=0;Q<8;++Q){var te=A(q)-G,ue=R(q);if(Math.abs(te-G)<pP||ue<pP)return k(q);q=B(q-te/ue)}return k(q)};return N.isStepper=!1,N},H4e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,r=n===void 0?100:n,a=t.damping,c=a===void 0?8:a,d=t.dt,i=d===void 0?17:d,_=function(T,A,k){var R=-(T-A)*r,B=k*c,N=k+(R-B)*i/1e3,V=k*i/1e3+T;return Math.abs(V-A)<pP&&Math.abs(N)<pP?[A,0]:[V,N]};return _.isStepper=!0,_.dt=i,_},q4e=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return mG(a);case"spring":return H4e();default:if(a.split("(")[0]==="cubic-bezier")return mG(a)}return typeof a=="function"?a:null};function Xw(e){"@babel/helpers - typeof";return Xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xw(e)}function gG(e){return K4e(e)||X4e(e)||hte(e)||Z4e()}function Z4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function K4e(e){if(Array.isArray(e))return nz(e)}function _G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ns(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_G(Object(n),!0).forEach(function(r){tz(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_G(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tz(e,t,n){return t=Y4e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y4e(e){var t=J4e(e,"string");return Xw(t)==="symbol"?t:String(t)}function J4e(e,t){if(Xw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xw(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q4e(e,t){return n5e(e)||t5e(e,t)||hte(e,t)||e5e()}function e5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hte(e,t){if(e){if(typeof e=="string")return nz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nz(e,t)}}function nz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t5e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function n5e(e){if(Array.isArray(e))return e}var mP=function(t,n,r){return t+(n-t)*r},rz=function(t){var n=t.from,r=t.to;return n!==r},r5e=function e(t,n,r){var a=Lb(function(c,d){if(rz(d)){var i=t(d.from,d.to,d.velocity),_=Q4e(i,2),b=_[0],T=_[1];return Ns(Ns({},d),{},{from:b,velocity:T})}return d},n);return r<1?Lb(function(c,d){return rz(d)?Ns(Ns({},d),{},{velocity:mP(d.velocity,a[c].velocity,r),from:mP(d.from,a[c].from,r)}):d},n):e(t,a,r-1)};const i5e=function(e,t,n,r,a){var c=D4e(e,t),d=c.reduce(function(V,H){return Ns(Ns({},V),{},tz({},H,[e[H],t[H]]))},{}),i=c.reduce(function(V,H){return Ns(Ns({},V),{},tz({},H,{from:e[H],velocity:0,to:t[H]}))},{}),_=-1,b,T,A=function(){return null},k=function(){return Lb(function(H,G){return G.from},i)},R=function(){return!Object.values(i).filter(rz).length},B=function(H){b||(b=H);var G=H-b,q=G/n.dt;i=r5e(n,i,q),a(Ns(Ns(Ns({},e),t),k())),b=H,R()||(_=requestAnimationFrame(A))},N=function(H){T||(T=H);var G=(H-T)/r,q=Lb(function(te,ue){return mP.apply(void 0,gG(ue).concat([n(G)]))},d);if(a(Ns(Ns(Ns({},e),t),q)),G<1)_=requestAnimationFrame(A);else{var Q=Lb(function(te,ue){return mP.apply(void 0,gG(ue).concat([n(1)]))},d);a(Ns(Ns(Ns({},e),t),Q))}};return A=n.isStepper?B:N,function(){return requestAnimationFrame(A),function(){cancelAnimationFrame(_)}}};function u0(e){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u0(e)}var o5e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function a5e(e,t){if(e==null)return{};var n=s5e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function s5e(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,c;for(c=0;c<r.length;c++)a=r[c],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function fR(e){return h5e(e)||u5e(e)||c5e(e)||l5e()}function l5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c5e(e,t){if(e){if(typeof e=="string")return iz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iz(e,t)}}function u5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function h5e(e){if(Array.isArray(e))return iz(e)}function iz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function $u(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(n),!0).forEach(function(r){hb(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hb(e,t,n){return t=dte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f5e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dte(r.key),r)}}function p5e(e,t,n){return t&&f5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dte(e){var t=m5e(e,"string");return u0(t)==="symbol"?t:String(t)}function m5e(e,t){if(u0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(u0(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oz(e,t)}function oz(e,t){return oz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},oz(e,t)}function _5e(e){var t=y5e();return function(){var r=gP(e),a;if(t){var c=gP(this).constructor;a=Reflect.construct(r,arguments,c)}else a=r.apply(this,arguments);return az(this,a)}}function az(e,t){if(t&&(u0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(e)}function sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gP(e){return gP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gP(e)}var uu=function(e){g5e(n,e);var t=_5e(n);function n(r,a){var c;d5e(this,n),c=t.call(this,r,a);var d=c.props,i=d.isActive,_=d.attributeName,b=d.from,T=d.to,A=d.steps,k=d.children,R=d.duration;if(c.handleStyleChange=c.handleStyleChange.bind(sz(c)),c.changeStyle=c.changeStyle.bind(sz(c)),!i||R<=0)return c.state={style:{}},typeof k=="function"&&(c.state={style:T}),az(c);if(A&&A.length)c.state={style:A[0].style};else if(b){if(typeof k=="function")return c.state={style:b},az(c);c.state={style:_?hb({},_,b):b}}else c.state={style:{}};return c}return p5e(n,[{key:"componentDidMount",value:function(){var a=this.props,c=a.isActive,d=a.canBegin;this.mounted=!0,!(!c||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var c=this.props,d=c.isActive,i=c.canBegin,_=c.attributeName,b=c.shouldReAnimate,T=c.to,A=c.from,k=this.state.style;if(i){if(!d){var R={style:_?hb({},_,T):T};this.state&&k&&(_&&k[_]!==T||!_&&k!==T)&&this.setState(R);return}if(!(T4e(a.to,T)&&a.canBegin&&a.isActive)){var B=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=B||b?A:a.to;if(this.state&&k){var V={style:_?hb({},_,N):N};(_&&k[_]!==N||!_&&k!==N)&&this.setState(V)}this.runAnimation($u($u({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var c=this,d=a.from,i=a.to,_=a.duration,b=a.easing,T=a.begin,A=a.onAnimationEnd,k=a.onAnimationStart,R=i5e(d,i,q4e(b),_,this.changeStyle),B=function(){c.stopJSAnimation=R()};this.manager.start([k,T,B,_,A])}},{key:"runStepAnimation",value:function(a){var c=this,d=a.steps,i=a.begin,_=a.onAnimationStart,b=d[0],T=b.style,A=b.duration,k=A===void 0?0:A,R=function(N,V,H){if(H===0)return N;var G=V.duration,q=V.easing,Q=q===void 0?"ease":q,te=V.style,ue=V.properties,fe=V.onAnimationEnd,ye=H>0?d[H-1]:V,De=ue||Object.keys(te);if(typeof Q=="function"||Q==="spring")return[].concat(fR(N),[c.runJSAnimation.bind(c,{from:ye.style,to:te,duration:G,easing:Q}),G]);var Ne=fG(De,G,Q),Fe=$u($u($u({},ye.style),te),{},{transition:Ne});return[].concat(fR(N),[Fe,G,fe]).filter(L4e)};return this.manager.start([_].concat(fR(d.reduce(R,[T,Math.max(k,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=O4e());var c=a.begin,d=a.duration,i=a.attributeName,_=a.to,b=a.easing,T=a.onAnimationStart,A=a.onAnimationEnd,k=a.steps,R=a.children,B=this.manager;if(this.unSubscribe=B.subscribe(this.handleStyleChange),typeof b=="function"||typeof R=="function"||b==="spring"){this.runJSAnimation(a);return}if(k.length>1){this.runStepAnimation(a);return}var N=i?hb({},i,_):_,V=fG(Object.keys(N),d,b);B.start([T,c,$u($u({},N),{},{transition:V}),d,A])}},{key:"render",value:function(){var a=this.props,c=a.children;a.begin;var d=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var _=a5e(a,o5e),b=X.Children.count(c),T=this.state.style;if(typeof c=="function")return c(T);if(!i||b===0||d<=0)return c;var A=function(R){var B=R.props,N=B.style,V=N===void 0?{}:N,H=B.className,G=X.cloneElement(R,$u($u({},_),{},{style:$u($u({},V),T),className:H}));return G};return b===1?A(X.Children.only(c)):Ce.createElement("div",null,X.Children.map(c,function(k){return A(k)}))}}]),n}(X.PureComponent);uu.displayName="Animate";uu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};uu.propTypes={from:Si.oneOfType([Si.object,Si.string]),to:Si.oneOfType([Si.object,Si.string]),attributeName:Si.string,duration:Si.number,begin:Si.number,easing:Si.oneOfType([Si.string,Si.func]),steps:Si.arrayOf(Si.shape({duration:Si.number.isRequired,style:Si.object.isRequired,easing:Si.oneOfType([Si.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Si.func]),properties:Si.arrayOf("string"),onAnimationEnd:Si.func})),children:Si.oneOfType([Si.node,Si.func]),isActive:Si.bool,canBegin:Si.bool,onAnimationEnd:Si.func,shouldReAnimate:Si.bool,onAnimationStart:Si.func,onAnimationReStart:Si.func};Si.object,Si.object,Si.object,Si.element;Si.object,Si.object,Si.object,Si.oneOfType([Si.array,Si.element]),Si.any;function Kw(e){"@babel/helpers - typeof";return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(e)}function _P(){return _P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_P.apply(this,arguments)}function v5e(e,t){return S5e(e)||w5e(e,t)||b5e(e,t)||x5e()}function x5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b5e(e,t){if(e){if(typeof e=="string")return vG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vG(e,t)}}function vG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w5e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function S5e(e){if(Array.isArray(e))return e}function xG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xG(Object(n),!0).forEach(function(r){T5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function T5e(e,t,n){return t=E5e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E5e(e){var t=A5e(e,"string");return Kw(t)=="symbol"?t:t+""}function A5e(e,t){if(Kw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wG=function(t,n,r,a,c){var d=Math.min(Math.abs(r)/2,Math.abs(a)/2),i=a>=0?1:-1,_=r>=0?1:-1,b=a>=0&&r>=0||a<0&&r<0?1:0,T;if(d>0&&c instanceof Array){for(var A=[0,0,0,0],k=0,R=4;k<R;k++)A[k]=c[k]>d?d:c[k];T="M".concat(t,",").concat(n+i*A[0]),A[0]>0&&(T+="A ".concat(A[0],",").concat(A[0],",0,0,").concat(b,",").concat(t+_*A[0],",").concat(n)),T+="L ".concat(t+r-_*A[1],",").concat(n),A[1]>0&&(T+="A ".concat(A[1],",").concat(A[1],",0,0,").concat(b,`,
        `).concat(t+r,",").concat(n+i*A[1])),T+="L ".concat(t+r,",").concat(n+a-i*A[2]),A[2]>0&&(T+="A ".concat(A[2],",").concat(A[2],",0,0,").concat(b,`,
        `).concat(t+r-_*A[2],",").concat(n+a)),T+="L ".concat(t+_*A[3],",").concat(n+a),A[3]>0&&(T+="A ".concat(A[3],",").concat(A[3],",0,0,").concat(b,`,
        `).concat(t,",").concat(n+a-i*A[3])),T+="Z"}else if(d>0&&c===+c&&c>0){var B=Math.min(d,c);T="M ".concat(t,",").concat(n+i*B,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+_*B,",").concat(n,`
            L `).concat(t+r-_*B,",").concat(n,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+r,",").concat(n+i*B,`
            L `).concat(t+r,",").concat(n+a-i*B,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+r-_*B,",").concat(n+a,`
            L `).concat(t+_*B,",").concat(n+a,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t,",").concat(n+a-i*B," Z")}else T="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return T},P5e=function(t,n){if(!t||!n)return!1;var r=t.x,a=t.y,c=n.x,d=n.y,i=n.width,_=n.height;if(Math.abs(i)>0&&Math.abs(_)>0){var b=Math.min(c,c+i),T=Math.max(c,c+i),A=Math.min(d,d+_),k=Math.max(d,d+_);return r>=b&&r<=T&&a>=A&&a<=k}return!1},C5e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},QF=function(t){var n=bG(bG({},C5e),t),r=X.useRef(),a=X.useState(-1),c=v5e(a,2),d=c[0],i=c[1];X.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var Q=r.current.getTotalLength();Q&&i(Q)}catch{}},[]);var _=n.x,b=n.y,T=n.width,A=n.height,k=n.radius,R=n.className,B=n.animationEasing,N=n.animationDuration,V=n.animationBegin,H=n.isAnimationActive,G=n.isUpdateAnimationActive;if(_!==+_||b!==+b||T!==+T||A!==+A||T===0||A===0)return null;var q=li("recharts-rectangle",R);return G?Ce.createElement(uu,{canBegin:d>0,from:{width:T,height:A,x:_,y:b},to:{width:T,height:A,x:_,y:b},duration:N,animationEasing:B,isActive:G},function(Q){var te=Q.width,ue=Q.height,fe=Q.x,ye=Q.y;return Ce.createElement(uu,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:N,isActive:H,easing:B},Ce.createElement("path",_P({},wr(n,!0),{className:q,d:wG(fe,ye,te,ue,k),ref:r})))}):Ce.createElement("path",_P({},wr(n,!0),{className:q,d:wG(_,b,T,A,k)}))},I5e=["points","className","baseLinePoints","connectNulls"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_v.apply(this,arguments)}function M5e(e,t){if(e==null)return{};var n=O5e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O5e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function SG(e){return L5e(e)||D5e(e)||R5e(e)||k5e()}function k5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R5e(e,t){if(e){if(typeof e=="string")return lz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lz(e,t)}}function D5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function L5e(e){if(Array.isArray(e))return lz(e)}function lz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var TG=function(t){return t&&t.x===+t.x&&t.y===+t.y},z5e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(r){TG(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),TG(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},zb=function(t,n){var r=z5e(t);n&&(r=[r.reduce(function(c,d){return[].concat(SG(c),SG(d))},[])]);var a=r.map(function(c){return c.reduce(function(d,i,_){return"".concat(d).concat(_===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return r.length===1?"".concat(a,"Z"):a},N5e=function(t,n,r){var a=zb(t,r);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(zb(n.reverse(),r).slice(1))},F5e=function(t){var n=t.points,r=t.className,a=t.baseLinePoints,c=t.connectNulls,d=M5e(t,I5e);if(!n||!n.length)return null;var i=li("recharts-polygon",r);if(a&&a.length){var _=d.stroke&&d.stroke!=="none",b=N5e(n,a,c);return Ce.createElement("g",{className:i},Ce.createElement("path",_v({},wr(d,!0),{fill:b.slice(-1)==="Z"?d.fill:"none",stroke:"none",d:b})),_?Ce.createElement("path",_v({},wr(d,!0),{fill:"none",d:zb(n,c)})):null,_?Ce.createElement("path",_v({},wr(d,!0),{fill:"none",d:zb(a,c)})):null)}var T=zb(n,c);return Ce.createElement("path",_v({},wr(d,!0),{fill:T.slice(-1)==="Z"?d.fill:"none",className:i,d:T}))};function cz(){return cz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cz.apply(this,arguments)}var VS=function(t){var n=t.cx,r=t.cy,a=t.r,c=t.className,d=li("recharts-dot",c);return n===+n&&r===+r&&a===+a?Ce.createElement("circle",cz({},wr(t,!1),BA(t),{className:d,cx:n,cy:r,r:a})):null};function Yw(e){"@babel/helpers - typeof";return Yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}var B5e=["x","y","top","left","width","height","className"];function uz(){return uz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uz.apply(this,arguments)}function EG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function j5e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EG(Object(n),!0).forEach(function(r){$5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $5e(e,t,n){return t=U5e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U5e(e){var t=V5e(e,"string");return Yw(t)=="symbol"?t:t+""}function V5e(e,t){if(Yw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Yw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W5e(e,t){if(e==null)return{};var n=G5e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G5e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var H5e=function(t,n,r,a,c,d){return"M".concat(t,",").concat(c,"v").concat(a,"M").concat(d,",").concat(n,"h").concat(r)},q5e=function(t){var n=t.x,r=n===void 0?0:n,a=t.y,c=a===void 0?0:a,d=t.top,i=d===void 0?0:d,_=t.left,b=_===void 0?0:_,T=t.width,A=T===void 0?0:T,k=t.height,R=k===void 0?0:k,B=t.className,N=W5e(t,B5e),V=j5e({x:r,y:c,top:i,left:b,width:A,height:R},N);return!zn(r)||!zn(c)||!zn(A)||!zn(R)||!zn(i)||!zn(b)?null:Ce.createElement("path",uz({},wr(V,!0),{className:li("recharts-cross",B),d:H5e(r,c,A,R,i,b)}))},Z5e=xI,X5e=See,K5e=ld;function Y5e(e,t){return e&&e.length?Z5e(e,K5e(t),X5e):void 0}var J5e=Y5e;const Q5e=lo(J5e);var e$e=xI,t$e=ld,n$e=Tee;function r$e(e,t){return e&&e.length?e$e(e,t$e(t),n$e):void 0}var i$e=r$e;const o$e=lo(i$e);var a$e=["cx","cy","angle","ticks","axisLine"],s$e=["ticks","tick","angle","tickFormatter","stroke"];function h0(e){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h0(e)}function Nb(){return Nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nb.apply(this,arguments)}function AG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Pg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AG(Object(n),!0).forEach(function(r){TI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PG(e,t){if(e==null)return{};var n=l$e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l$e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function c$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pte(r.key),r)}}function u$e(e,t,n){return t&&CG(e.prototype,t),n&&CG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h$e(e,t,n){return t=yP(t),d$e(e,fte()?Reflect.construct(t,n||[],yP(e).constructor):t.apply(e,n))}function d$e(e,t){if(t&&(h0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f$e(e)}function f$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fte=function(){return!!e})()}function yP(e){return yP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yP(e)}function p$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hz(e,t)}function hz(e,t){return hz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},hz(e,t)}function TI(e,t,n){return t=pte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pte(e){var t=m$e(e,"string");return h0(t)=="symbol"?t:t+""}function m$e(e,t){if(h0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(h0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EI=function(e){function t(){return c$e(this,t),h$e(this,t,arguments)}return p$e(t,e),u$e(t,[{key:"getTickValueCoord",value:function(r){var a=r.coordinate,c=this.props,d=c.angle,i=c.cx,_=c.cy;return No(i,_,a,d)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,a;switch(r){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var r=this.props,a=r.cx,c=r.cy,d=r.angle,i=r.ticks,_=Q5e(i,function(T){return T.coordinate||0}),b=o$e(i,function(T){return T.coordinate||0});return{cx:a,cy:c,startAngle:d,endAngle:d,innerRadius:b.coordinate||0,outerRadius:_.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,c=r.cy,d=r.angle,i=r.ticks,_=r.axisLine,b=PG(r,a$e),T=i.reduce(function(B,N){return[Math.min(B[0],N.coordinate),Math.max(B[1],N.coordinate)]},[1/0,-1/0]),A=No(a,c,T[0],d),k=No(a,c,T[1],d),R=Pg(Pg(Pg({},wr(b,!1)),{},{fill:"none"},wr(_,!1)),{},{x1:A.x,y1:A.y,x2:k.x,y2:k.y});return Ce.createElement("line",Nb({className:"recharts-polar-radius-axis-line"},R))}},{key:"renderTicks",value:function(){var r=this,a=this.props,c=a.ticks,d=a.tick,i=a.angle,_=a.tickFormatter,b=a.stroke,T=PG(a,s$e),A=this.getTickTextAnchor(),k=wr(T,!1),R=wr(d,!1),B=c.map(function(N,V){var H=r.getTickValueCoord(N),G=Pg(Pg(Pg(Pg({textAnchor:A,transform:"rotate(".concat(90-i,", ").concat(H.x,", ").concat(H.y,")")},k),{},{stroke:"none",fill:b},R),{},{index:V},H),{},{payload:N});return Ce.createElement(_i,Nb({className:li("recharts-polar-radius-axis-tick",Jee(d)),key:"tick-".concat(N.coordinate)},dm(r.props,N,V)),t.renderTickItem(d,G,_?_(N.value,V):N.value))});return Ce.createElement(_i,{className:"recharts-polar-radius-axis-ticks"},B)}},{key:"render",value:function(){var r=this.props,a=r.ticks,c=r.axisLine,d=r.tick;return!a||!a.length?null:Ce.createElement(_i,{className:li("recharts-polar-radius-axis",this.props.className)},c&&this.renderAxisLine(),d&&this.renderTicks(),bs.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,a,c){var d;return Ce.isValidElement(r)?d=Ce.cloneElement(r,a):$r(r)?d=r(a):d=Ce.createElement(u_,Nb({},a,{className:"recharts-polar-radius-axis-tick-value"}),c),d}}])}(X.PureComponent);TI(EI,"displayName","PolarRadiusAxis");TI(EI,"axisType","radiusAxis");TI(EI,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function d0(e){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d0(e)}function Ng(){return Ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ng.apply(this,arguments)}function IG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Cg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IG(Object(n),!0).forEach(function(r){AI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function g$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gte(r.key),r)}}function _$e(e,t,n){return t&&MG(e.prototype,t),n&&MG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e,t,n){return t=vP(t),v$e(e,mte()?Reflect.construct(t,n||[],vP(e).constructor):t.apply(e,n))}function v$e(e,t){if(t&&(d0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x$e(e)}function x$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mte=function(){return!!e})()}function vP(e){return vP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},vP(e)}function b$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dz(e,t)}function dz(e,t){return dz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},dz(e,t)}function AI(e,t,n){return t=gte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gte(e){var t=w$e(e,"string");return d0(t)=="symbol"?t:t+""}function w$e(e,t){if(d0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(d0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S$e=Math.PI/180,OG=1e-5,PI=function(e){function t(){return g$e(this,t),y$e(this,t,arguments)}return b$e(t,e),_$e(t,[{key:"getTickLineCoord",value:function(r){var a=this.props,c=a.cx,d=a.cy,i=a.radius,_=a.orientation,b=a.tickSize,T=b||8,A=No(c,d,i,r.coordinate),k=No(c,d,i+(_==="inner"?-1:1)*T,r.coordinate);return{x1:A.x,y1:A.y,x2:k.x,y2:k.y}}},{key:"getTickTextAnchor",value:function(r){var a=this.props.orientation,c=Math.cos(-r.coordinate*S$e),d;return c>OG?d=a==="outer"?"start":"end":c<-OG?d=a==="outer"?"end":"start":d="middle",d}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,c=r.cy,d=r.radius,i=r.axisLine,_=r.axisLineType,b=Cg(Cg({},wr(this.props,!1)),{},{fill:"none"},wr(i,!1));if(_==="circle")return Ce.createElement(VS,Ng({className:"recharts-polar-angle-axis-line"},b,{cx:a,cy:c,r:d}));var T=this.props.ticks,A=T.map(function(k){return No(a,c,d,k.coordinate)});return Ce.createElement(F5e,Ng({className:"recharts-polar-angle-axis-line"},b,{points:A}))}},{key:"renderTicks",value:function(){var r=this,a=this.props,c=a.ticks,d=a.tick,i=a.tickLine,_=a.tickFormatter,b=a.stroke,T=wr(this.props,!1),A=wr(d,!1),k=Cg(Cg({},T),{},{fill:"none"},wr(i,!1)),R=c.map(function(B,N){var V=r.getTickLineCoord(B),H=r.getTickTextAnchor(B),G=Cg(Cg(Cg({textAnchor:H},T),{},{stroke:"none",fill:b},A),{},{index:N,payload:B,x:V.x2,y:V.y2});return Ce.createElement(_i,Ng({className:li("recharts-polar-angle-axis-tick",Jee(d)),key:"tick-".concat(B.coordinate)},dm(r.props,B,N)),i&&Ce.createElement("line",Ng({className:"recharts-polar-angle-axis-tick-line"},k,V)),d&&t.renderTickItem(d,G,_?_(B.value,N):B.value))});return Ce.createElement(_i,{className:"recharts-polar-angle-axis-ticks"},R)}},{key:"render",value:function(){var r=this.props,a=r.ticks,c=r.radius,d=r.axisLine;return c<=0||!a||!a.length?null:Ce.createElement(_i,{className:li("recharts-polar-angle-axis",this.props.className)},d&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,a,c){var d;return Ce.isValidElement(r)?d=Ce.cloneElement(r,a):$r(r)?d=r(a):d=Ce.createElement(u_,Ng({},a,{className:"recharts-polar-angle-axis-tick-value"}),c),d}}])}(X.PureComponent);AI(PI,"displayName","PolarAngleAxis");AI(PI,"axisType","angleAxis");AI(PI,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var T$e=gQ,E$e=T$e(Object.getPrototypeOf,Object),A$e=E$e,P$e=wf,C$e=A$e,I$e=Sf,M$e="[object Object]",O$e=Function.prototype,k$e=Object.prototype,_te=O$e.toString,R$e=k$e.hasOwnProperty,D$e=_te.call(Object);function L$e(e){if(!I$e(e)||P$e(e)!=M$e)return!1;var t=C$e(e);if(t===null)return!0;var n=R$e.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&_te.call(n)==D$e}var z$e=L$e;const N$e=lo(z$e);var F$e=wf,B$e=Sf,j$e="[object Boolean]";function $$e(e){return e===!0||e===!1||B$e(e)&&F$e(e)==j$e}var U$e=$$e;const V$e=lo(U$e);function Jw(e){"@babel/helpers - typeof";return Jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jw(e)}function xP(){return xP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xP.apply(this,arguments)}function W$e(e,t){return Z$e(e)||q$e(e,t)||H$e(e,t)||G$e()}function G$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H$e(e,t){if(e){if(typeof e=="string")return kG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kG(e,t)}}function kG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q$e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function Z$e(e){if(Array.isArray(e))return e}function RG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RG(Object(n),!0).forEach(function(r){X$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function X$e(e,t,n){return t=K$e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K$e(e){var t=Y$e(e,"string");return Jw(t)=="symbol"?t:t+""}function Y$e(e,t){if(Jw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Jw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LG=function(t,n,r,a,c){var d=r-a,i;return i="M ".concat(t,",").concat(n),i+="L ".concat(t+r,",").concat(n),i+="L ".concat(t+r-d/2,",").concat(n+c),i+="L ".concat(t+r-d/2-a,",").concat(n+c),i+="L ".concat(t,",").concat(n," Z"),i},J$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Q$e=function(t){var n=DG(DG({},J$e),t),r=X.useRef(),a=X.useState(-1),c=W$e(a,2),d=c[0],i=c[1];X.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var q=r.current.getTotalLength();q&&i(q)}catch{}},[]);var _=n.x,b=n.y,T=n.upperWidth,A=n.lowerWidth,k=n.height,R=n.className,B=n.animationEasing,N=n.animationDuration,V=n.animationBegin,H=n.isUpdateAnimationActive;if(_!==+_||b!==+b||T!==+T||A!==+A||k!==+k||T===0&&A===0||k===0)return null;var G=li("recharts-trapezoid",R);return H?Ce.createElement(uu,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:k,x:_,y:b},to:{upperWidth:T,lowerWidth:A,height:k,x:_,y:b},duration:N,animationEasing:B,isActive:H},function(q){var Q=q.upperWidth,te=q.lowerWidth,ue=q.height,fe=q.x,ye=q.y;return Ce.createElement(uu,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:N,easing:B},Ce.createElement("path",xP({},wr(n,!0),{className:G,d:LG(fe,ye,Q,te,ue),ref:r})))}):Ce.createElement("g",null,Ce.createElement("path",xP({},wr(n,!0),{className:G,d:LG(_,b,T,A,k)})))},eUe=["option","shapeType","propTransformer","activeClassName","isActive"];function Qw(e){"@babel/helpers - typeof";return Qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qw(e)}function tUe(e,t){if(e==null)return{};var n=nUe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nUe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function zG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bP(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zG(Object(n),!0).forEach(function(r){rUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rUe(e,t,n){return t=iUe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iUe(e){var t=oUe(e,"string");return Qw(t)=="symbol"?t:t+""}function oUe(e,t){if(Qw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Qw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aUe(e,t){return bP(bP({},t),e)}function sUe(e,t){return e==="symbols"}function NG(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return Ce.createElement(QF,n);case"trapezoid":return Ce.createElement(Q$e,n);case"sector":return Ce.createElement(tte,n);case"symbols":if(sUe(t))return Ce.createElement(cI,n);break;default:return null}}function lUe(e){return X.isValidElement(e)?e.props:e}function wP(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?aUe:r,c=e.activeClassName,d=c===void 0?"recharts-active-shape":c,i=e.isActive,_=tUe(e,eUe),b;if(X.isValidElement(t))b=X.cloneElement(t,bP(bP({},_),lUe(t)));else if($r(t))b=t(_);else if(N$e(t)&&!V$e(t)){var T=a(t,_);b=Ce.createElement(NG,{shapeType:n,elementProps:T})}else{var A=_;b=Ce.createElement(NG,{shapeType:n,elementProps:A})}return i?Ce.createElement(_i,{className:d},b):b}function CI(e,t){return t!=null&&"trapezoids"in e.props}function II(e,t){return t!=null&&"sectors"in e.props}function eS(e,t){return t!=null&&"points"in e.props}function cUe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,c=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&c}function uUe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function hUe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function dUe(e,t){var n;return CI(e,t)?n=cUe:II(e,t)?n=uUe:eS(e,t)&&(n=hUe),n}function fUe(e,t){var n;return CI(e,t)?n="trapezoids":II(e,t)?n="sectors":eS(e,t)&&(n="points"),n}function pUe(e,t){if(CI(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(II(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return eS(e,t)?t.payload:{}}function mUe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=fUe(n,t),c=pUe(n,t),d=r.filter(function(_,b){var T=pm(c,_),A=n.props[a].filter(function(B){var N=dUe(n,t);return N(B,t)}),k=n.props[a].indexOf(A[A.length-1]),R=b===k;return T&&R}),i=r.indexOf(d[d.length-1]);return i}var R2;function f0(e){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f0(e)}function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yv.apply(this,arguments)}function FG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Lo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FG(Object(n),!0).forEach(function(r){tu(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vte(r.key),r)}}function _Ue(e,t,n){return t&&BG(e.prototype,t),n&&BG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yUe(e,t,n){return t=SP(t),vUe(e,yte()?Reflect.construct(t,n||[],SP(e).constructor):t.apply(e,n))}function vUe(e,t){if(t&&(f0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xUe(e)}function xUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yte=function(){return!!e})()}function SP(e){return SP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},SP(e)}function bUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fz(e,t)}function fz(e,t){return fz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},fz(e,t)}function tu(e,t,n){return t=vte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vte(e){var t=wUe(e,"string");return f0(t)=="symbol"?t:t+""}function wUe(e,t){if(f0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(f0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Im=function(e){function t(n){var r;return gUe(this,t),r=yUe(this,t,[n]),tu(r,"pieRef",null),tu(r,"sectorRefs",[]),tu(r,"id",Em("recharts-pie-")),tu(r,"handleAnimationEnd",function(){var a=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),$r(a)&&a()}),tu(r,"handleAnimationStart",function(){var a=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),$r(a)&&a()}),r.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},r}return bUe(t,e),_Ue(t,[{key:"isActiveIndex",value:function(r){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(r)!==-1:r===a}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.label,i=c.labelLine,_=c.dataKey,b=c.valueKey,T=wr(this.props,!1),A=wr(d,!1),k=wr(i,!1),R=d&&d.offsetRadius||20,B=r.map(function(N,V){var H=(N.startAngle+N.endAngle)/2,G=No(N.cx,N.cy,N.outerRadius+R,H),q=Lo(Lo(Lo(Lo({},T),N),{},{stroke:"none"},A),{},{index:V,textAnchor:t.getTextAnchor(G.x,N.cx)},G),Q=Lo(Lo(Lo(Lo({},T),N),{},{fill:"none",stroke:N.fill},k),{},{index:V,points:[No(N.cx,N.cy,N.outerRadius,H),G]}),te=_;return Nr(_)&&Nr(b)?te="value":Nr(_)&&(te=b),Ce.createElement(_i,{key:"label-".concat(N.startAngle,"-").concat(N.endAngle,"-").concat(N.midAngle,"-").concat(V)},i&&t.renderLabelLineItem(i,Q,"line"),t.renderLabelItem(d,q,Zo(N,te)))});return Ce.createElement(_i,{className:"recharts-pie-labels"},B)}},{key:"renderSectorsStatically",value:function(r){var a=this,c=this.props,d=c.activeShape,i=c.blendStroke,_=c.inactiveShape;return r.map(function(b,T){if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&r.length!==1)return null;var A=a.isActiveIndex(T),k=_&&a.hasActiveIndex()?_:null,R=A?d:k,B=Lo(Lo({},b),{},{stroke:i?b.fill:b.stroke,tabIndex:-1});return Ce.createElement(_i,yv({ref:function(V){V&&!a.sectorRefs.includes(V)&&a.sectorRefs.push(V)},tabIndex:-1,className:"recharts-pie-sector"},dm(a.props,b,T),{key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(T)}),Ce.createElement(wP,yv({option:R,isActive:A,shapeType:"sector"},B)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,a=this.props,c=a.sectors,d=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,b=a.animationEasing,T=a.animationId,A=this.state,k=A.prevSectors,R=A.prevIsAnimationActive;return Ce.createElement(uu,{begin:i,duration:_,isActive:d,easing:b,from:{t:0},to:{t:1},key:"pie-".concat(T,"-").concat(R),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(B){var N=B.t,V=[],H=c&&c[0],G=H.startAngle;return c.forEach(function(q,Q){var te=k&&k[Q],ue=Q>0?Rc(q,"paddingAngle",0):0;if(te){var fe=ca(te.endAngle-te.startAngle,q.endAngle-q.startAngle),ye=Lo(Lo({},q),{},{startAngle:G+ue,endAngle:G+fe(N)+ue});V.push(ye),G=ye.endAngle}else{var De=q.endAngle,Ne=q.startAngle,Fe=ca(0,De-Ne),Le=Fe(N),Ze=Lo(Lo({},q),{},{startAngle:G+ue,endAngle:G+Le+ue});V.push(Ze),G=Ze.endAngle}}),Ce.createElement(_i,null,r.renderSectorsStatically(V))})}},{key:"attachKeyboardHandlers",value:function(r){var a=this;r.onkeydown=function(c){if(!c.altKey)switch(c.key){case"ArrowLeft":{var d=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[d].focus(),a.setState({sectorToFocus:d});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,a=r.sectors,c=r.isAnimationActive,d=this.state.prevSectors;return c&&a&&a.length&&(!d||!pm(d,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,a=this.props,c=a.hide,d=a.sectors,i=a.className,_=a.label,b=a.cx,T=a.cy,A=a.innerRadius,k=a.outerRadius,R=a.isAnimationActive,B=this.state.isAnimationFinished;if(c||!d||!d.length||!zn(b)||!zn(T)||!zn(A)||!zn(k))return null;var N=li("recharts-pie",i);return Ce.createElement(_i,{tabIndex:this.props.rootTabIndex,className:N,ref:function(H){r.pieRef=H}},this.renderSectors(),_&&this.renderLabels(d),bs.renderCallByParent(this.props,null,!1),(!R||B)&&ih.renderCallByParent(this.props,d,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return a.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:r.sectors!==a.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,a){return r>a?"start":r<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,a,c){if(Ce.isValidElement(r))return Ce.cloneElement(r,a);if($r(r))return r(a);var d=li("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return Ce.createElement(em,yv({},a,{key:c,type:"linear",className:d}))}},{key:"renderLabelItem",value:function(r,a,c){if(Ce.isValidElement(r))return Ce.cloneElement(r,a);var d=c;if($r(r)&&(d=r(a),Ce.isValidElement(d)))return d;var i=li("recharts-pie-label-text",typeof r!="boolean"&&!$r(r)?r.className:"");return Ce.createElement(u_,yv({},a,{alignmentBaseline:"middle",className:i}),d)}}])}(X.PureComponent);R2=Im;tu(Im,"displayName","Pie");tu(Im,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!au.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});tu(Im,"parseDeltaAngle",function(e,t){var n=_l(t-e),r=Math.min(Math.abs(t-e),360);return n*r});tu(Im,"getRealPieData",function(e){var t=e.data,n=e.children,r=wr(e,!1),a=bl(n,fI);return t&&t.length?t.map(function(c,d){return Lo(Lo(Lo({payload:c},r),c),a&&a[d]&&a[d].props)}):a&&a.length?a.map(function(c){return Lo(Lo({},r),c.props)}):[]});tu(Im,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,a=t.width,c=t.height,d=Yee(a,c),i=r+yl(e.cx,a,a/2),_=n+yl(e.cy,c,c/2),b=yl(e.innerRadius,d,0),T=yl(e.outerRadius,d,d*.8),A=e.maxRadius||Math.sqrt(a*a+c*c)/2;return{cx:i,cy:_,innerRadius:b,outerRadius:T,maxRadius:A}});tu(Im,"getComposedData",function(e){var t=e.item,n=e.offset,r=t.type.defaultProps!==void 0?Lo(Lo({},t.type.defaultProps),t.props):t.props,a=R2.getRealPieData(r);if(!a||!a.length)return null;var c=r.cornerRadius,d=r.startAngle,i=r.endAngle,_=r.paddingAngle,b=r.dataKey,T=r.nameKey,A=r.valueKey,k=r.tooltipType,R=Math.abs(r.minAngle),B=R2.parseCoordinateOfPie(r,n),N=R2.parseDeltaAngle(d,i),V=Math.abs(N),H=b;Nr(b)&&Nr(A)?(rh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H="value"):Nr(b)&&(rh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H=A);var G=a.filter(function(ye){return Zo(ye,H,0)!==0}).length,q=(V>=360?G:G-1)*_,Q=V-G*R-q,te=a.reduce(function(ye,De){var Ne=Zo(De,H,0);return ye+(zn(Ne)?Ne:0)},0),ue;if(te>0){var fe;ue=a.map(function(ye,De){var Ne=Zo(ye,H,0),Fe=Zo(ye,T,De),Le=(zn(Ne)?Ne:0)/te,Ze;De?Ze=fe.endAngle+_l(N)*_*(Ne!==0?1:0):Ze=d;var He=Ze+_l(N)*((Ne!==0?R:0)+Le*Q),ct=(Ze+He)/2,ot=(B.innerRadius+B.outerRadius)/2,rt=[{name:Fe,value:Ne,payload:ye,dataKey:H,type:k}],Be=No(B.cx,B.cy,ot,ct);return fe=Lo(Lo(Lo({percent:Le,cornerRadius:c,name:Fe,tooltipPayload:rt,midAngle:ct,middleRadius:ot,tooltipPosition:Be},ye),B),{},{value:Zo(ye,H),startAngle:Ze,endAngle:He,payload:ye,paddingAngle:_l(N)*_}),fe})}return Lo(Lo({},B),{},{sectors:ue,data:a})});var SUe=Math.ceil,TUe=Math.max;function EUe(e,t,n,r){for(var a=-1,c=TUe(SUe((t-e)/(n||1)),0),d=Array(c);c--;)d[r?c:++a]=e,e+=n;return d}var AUe=EUe,PUe=LQ,jG=1/0,CUe=17976931348623157e292;function IUe(e){if(!e)return e===0?e:0;if(e=PUe(e),e===jG||e===-jG){var t=e<0?-1:1;return t*CUe}return e===e?e:0}var xte=IUe,MUe=AUe,OUe=dI,pR=xte;function kUe(e){return function(t,n,r){return r&&typeof r!="number"&&OUe(t,n,r)&&(n=r=void 0),t=pR(t),n===void 0?(n=t,t=0):n=pR(n),r=r===void 0?t<n?1:-1:pR(r),MUe(t,n,r,e)}}var RUe=kUe,DUe=RUe,LUe=DUe(),zUe=LUe;const TP=lo(zUe);function tS(e){"@babel/helpers - typeof";return tS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tS(e)}function $G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function UG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(n),!0).forEach(function(r){bte(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$G(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function bte(e,t,n){return t=NUe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NUe(e){var t=FUe(e,"string");return tS(t)=="symbol"?t:t+""}function FUe(e,t){if(tS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BUe=["Webkit","Moz","O","ms"],jUe=function(t,n){var r=t.replace(/(\w)/,function(c){return c.toUpperCase()}),a=BUe.reduce(function(c,d){return UG(UG({},c),{},bte({},d+r,n))},{});return a[t]=n,a};function p0(e){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0(e)}function EP(){return EP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EP.apply(this,arguments)}function VG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function mR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(n),!0).forEach(function(r){Tc(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ste(r.key),r)}}function UUe(e,t,n){return t&&WG(e.prototype,t),n&&WG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VUe(e,t,n){return t=AP(t),WUe(e,wte()?Reflect.construct(t,n||[],AP(e).constructor):t.apply(e,n))}function WUe(e,t){if(t&&(p0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GUe(e)}function GUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wte=function(){return!!e})()}function AP(e){return AP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},AP(e)}function HUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pz(e,t)}function pz(e,t){return pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},pz(e,t)}function Tc(e,t,n){return t=Ste(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ste(e){var t=qUe(e,"string");return p0(t)=="symbol"?t:t+""}function qUe(e,t){if(p0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(p0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZUe=function(t){var n=t.data,r=t.startIndex,a=t.endIndex,c=t.x,d=t.width,i=t.travellerWidth;if(!n||!n.length)return{};var _=n.length,b=Rb().domain(TP(0,_)).range([c,c+d-i]),T=b.domain().map(function(A){return b(A)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:b(r),endX:b(a),scale:b,scaleValues:T}},GG=function(t){return t.changedTouches&&!!t.changedTouches.length},m0=function(e){function t(n){var r;return $Ue(this,t),r=VUe(this,t,[n]),Tc(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),Tc(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),Tc(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,c=a.endIndex,d=a.onDragEnd,i=a.startIndex;d==null||d({endIndex:c,startIndex:i})}),r.detachDragEndListener()}),Tc(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Tc(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Tc(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Tc(r,"handleSlideDragStart",function(a){var c=GG(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:c.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return HUe(t,e),UUe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var a=r.startX,c=r.endX,d=this.state.scaleValues,i=this.props,_=i.gap,b=i.data,T=b.length-1,A=Math.min(a,c),k=Math.max(a,c),R=t.getIndexInRange(d,A),B=t.getIndexInRange(d,k);return{startIndex:R-R%_,endIndex:B===T?T:B-B%_}}},{key:"getTextOfTick",value:function(r){var a=this.props,c=a.data,d=a.tickFormatter,i=a.dataKey,_=Zo(c[r],i,r);return $r(d)?d(_,r):_}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var a=this.state,c=a.slideMoveStartX,d=a.startX,i=a.endX,_=this.props,b=_.x,T=_.width,A=_.travellerWidth,k=_.startIndex,R=_.endIndex,B=_.onChange,N=r.pageX-c;N>0?N=Math.min(N,b+T-A-i,b+T-A-d):N<0&&(N=Math.max(N,b-d,b-i));var V=this.getIndex({startX:d+N,endX:i+N});(V.startIndex!==k||V.endIndex!==R)&&B&&B(V),this.setState({startX:d+N,endX:i+N,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,a){var c=GG(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:c.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var a=this.state,c=a.brushMoveStartX,d=a.movingTravellerId,i=a.endX,_=a.startX,b=this.state[d],T=this.props,A=T.x,k=T.width,R=T.travellerWidth,B=T.onChange,N=T.gap,V=T.data,H={startX:this.state.startX,endX:this.state.endX},G=r.pageX-c;G>0?G=Math.min(G,A+k-R-b):G<0&&(G=Math.max(G,A-b)),H[d]=b+G;var q=this.getIndex(H),Q=q.startIndex,te=q.endIndex,ue=function(){var ye=V.length-1;return d==="startX"&&(i>_?Q%N===0:te%N===0)||i<_&&te===ye||d==="endX"&&(i>_?te%N===0:Q%N===0)||i>_&&te===ye};this.setState(Tc(Tc({},d,b+G),"brushMoveStartX",r.pageX),function(){B&&ue()&&B(q)})}},{key:"handleTravellerMoveKeyboard",value:function(r,a){var c=this,d=this.state,i=d.scaleValues,_=d.startX,b=d.endX,T=this.state[a],A=i.indexOf(T);if(A!==-1){var k=A+r;if(!(k===-1||k>=i.length)){var R=i[k];a==="startX"&&R>=b||a==="endX"&&R<=_||this.setState(Tc({},a,R),function(){c.props.onChange(c.getIndex({startX:c.state.startX,endX:c.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,a=r.x,c=r.y,d=r.width,i=r.height,_=r.fill,b=r.stroke;return Ce.createElement("rect",{stroke:b,fill:_,x:a,y:c,width:d,height:i})}},{key:"renderPanorama",value:function(){var r=this.props,a=r.x,c=r.y,d=r.width,i=r.height,_=r.data,b=r.children,T=r.padding,A=X.Children.only(b);return A?Ce.cloneElement(A,{x:a,y:c,width:d,height:i,margin:T,compact:!0,data:_}):null}},{key:"renderTravellerLayer",value:function(r,a){var c,d,i=this,_=this.props,b=_.y,T=_.travellerWidth,A=_.height,k=_.traveller,R=_.ariaLabel,B=_.data,N=_.startIndex,V=_.endIndex,H=Math.max(r,this.props.x),G=mR(mR({},wr(this.props,!1)),{},{x:H,y:b,width:T,height:A}),q=R||"Min value: ".concat((c=B[N])===null||c===void 0?void 0:c.name,", Max value: ").concat((d=B[V])===null||d===void 0?void 0:d.name);return Ce.createElement(_i,{tabIndex:0,role:"slider","aria-label":q,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(te){["ArrowLeft","ArrowRight"].includes(te.key)&&(te.preventDefault(),te.stopPropagation(),i.handleTravellerMoveKeyboard(te.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(k,G))}},{key:"renderSlide",value:function(r,a){var c=this.props,d=c.y,i=c.height,_=c.stroke,b=c.travellerWidth,T=Math.min(r,a)+b,A=Math.max(Math.abs(a-r)-b,0);return Ce.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:_,fillOpacity:.2,x:T,y:d,width:A,height:i})}},{key:"renderText",value:function(){var r=this.props,a=r.startIndex,c=r.endIndex,d=r.y,i=r.height,_=r.travellerWidth,b=r.stroke,T=this.state,A=T.startX,k=T.endX,R=5,B={pointerEvents:"none",fill:b};return Ce.createElement(_i,{className:"recharts-brush-texts"},Ce.createElement(u_,EP({textAnchor:"end",verticalAnchor:"middle",x:Math.min(A,k)-R,y:d+i/2},B),this.getTextOfTick(a)),Ce.createElement(u_,EP({textAnchor:"start",verticalAnchor:"middle",x:Math.max(A,k)+_+R,y:d+i/2},B),this.getTextOfTick(c)))}},{key:"render",value:function(){var r=this.props,a=r.data,c=r.className,d=r.children,i=r.x,_=r.y,b=r.width,T=r.height,A=r.alwaysShowText,k=this.state,R=k.startX,B=k.endX,N=k.isTextActive,V=k.isSlideMoving,H=k.isTravellerMoving,G=k.isTravellerFocused;if(!a||!a.length||!zn(i)||!zn(_)||!zn(b)||!zn(T)||b<=0||T<=0)return null;var q=li("recharts-brush",c),Q=Ce.Children.count(d)===1,te=jUe("userSelect","none");return Ce.createElement(_i,{className:q,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:te},this.renderBackground(),Q&&this.renderPanorama(),this.renderSlide(R,B),this.renderTravellerLayer(R,"startX"),this.renderTravellerLayer(B,"endX"),(N||V||H||G||A)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var a=r.x,c=r.y,d=r.width,i=r.height,_=r.stroke,b=Math.floor(c+i/2)-1;return Ce.createElement(Ce.Fragment,null,Ce.createElement("rect",{x:a,y:c,width:d,height:i,fill:_,stroke:"none"}),Ce.createElement("line",{x1:a+1,y1:b,x2:a+d-1,y2:b,fill:"none",stroke:"#fff"}),Ce.createElement("line",{x1:a+1,y1:b+2,x2:a+d-1,y2:b+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,a){var c;return Ce.isValidElement(r)?c=Ce.cloneElement(r,a):$r(r)?c=r(a):c=t.renderDefaultTraveller(a),c}},{key:"getDerivedStateFromProps",value:function(r,a){var c=r.data,d=r.width,i=r.x,_=r.travellerWidth,b=r.updateId,T=r.startIndex,A=r.endIndex;if(c!==a.prevData||b!==a.prevUpdateId)return mR({prevData:c,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:d},c&&c.length?ZUe({data:c,width:d,x:i,travellerWidth:_,startIndex:T,endIndex:A}):{scale:null,scaleValues:null});if(a.scale&&(d!==a.prevWidth||i!==a.prevX||_!==a.prevTravellerWidth)){a.scale.range([i,i+d-_]);var k=a.scale.domain().map(function(R){return a.scale(R)});return{prevData:c,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:d,startX:a.scale(r.startIndex),endX:a.scale(r.endIndex),scaleValues:k}}return null}},{key:"getIndexInRange",value:function(r,a){for(var c=r.length,d=0,i=c-1;i-d>1;){var _=Math.floor((d+i)/2);r[_]>a?i=_:d=_}return a>=r[i]?i:d}}])}(X.PureComponent);Tc(m0,"displayName","Brush");Tc(m0,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var XUe=EF;function KUe(e,t){var n;return XUe(e,function(r,a,c){return n=t(r,a,c),!n}),!!n}var YUe=KUe,JUe=lQ,QUe=ld,eVe=YUe,tVe=nc,nVe=dI;function rVe(e,t,n){var r=tVe(e)?JUe:eVe;return n&&nVe(e,t,n)&&(t=void 0),r(e,QUe(t))}var iVe=rVe;const oVe=lo(iVe);var Qh=function(t,n){var r=t.alwaysShow,a=t.ifOverflow;return r&&(a="extendDomain"),a===n},HG=MQ;function aVe(e,t,n){t=="__proto__"&&HG?HG(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var sVe=aVe,lVe=sVe,cVe=CQ,uVe=ld;function hVe(e,t){var n={};return t=uVe(t),cVe(e,function(r,a,c){lVe(n,a,t(r,a,c))}),n}var dVe=hVe;const fVe=lo(dVe);function pVe(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}var mVe=pVe,gVe=EF;function _Ve(e,t){var n=!0;return gVe(e,function(r,a,c){return n=!!t(r,a,c),n}),n}var yVe=_Ve,vVe=mVe,xVe=yVe,bVe=ld,wVe=nc,SVe=dI;function TVe(e,t,n){var r=wVe(e)?vVe:xVe;return n&&SVe(e,t,n)&&(t=void 0),r(e,bVe(t))}var EVe=TVe;const Tte=lo(EVe);var AVe=["x","y"];function nS(e){"@babel/helpers - typeof";return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nS(e)}function mz(){return mz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mz.apply(this,arguments)}function qG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function eb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qG(Object(n),!0).forEach(function(r){PVe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PVe(e,t,n){return t=CVe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CVe(e){var t=IVe(e,"string");return nS(t)=="symbol"?t:t+""}function IVe(e,t){if(nS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MVe(e,t){if(e==null)return{};var n=OVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function kVe(e,t){var n=e.x,r=e.y,a=MVe(e,AVe),c="".concat(n),d=parseInt(c,10),i="".concat(r),_=parseInt(i,10),b="".concat(t.height||a.height),T=parseInt(b,10),A="".concat(t.width||a.width),k=parseInt(A,10);return eb(eb(eb(eb(eb({},t),a),d?{x:d}:{}),_?{y:_}:{}),{},{height:T,width:k,name:t.name,radius:t.radius})}function ZG(e){return Ce.createElement(wP,mz({shapeType:"rectangle",propTransformer:kVe,activeClassName:"recharts-active-bar"},e))}var RVe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,a){if(typeof t=="number")return t;var c=typeof r=="number";return c?t(r,a):(c||f_(),n)}},DVe=["value","background"],Ete;function g0(e){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g0(e)}function LVe(e,t){if(e==null)return{};var n=zVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function PP(){return PP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PP.apply(this,arguments)}function XG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(n),!0).forEach(function(r){Bp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pte(r.key),r)}}function FVe(e,t,n){return t&&KG(e.prototype,t),n&&KG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function BVe(e,t,n){return t=CP(t),jVe(e,Ate()?Reflect.construct(t,n||[],CP(e).constructor):t.apply(e,n))}function jVe(e,t){if(t&&(g0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ve(e)}function $Ve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ate(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ate=function(){return!!e})()}function CP(e){return CP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CP(e)}function UVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gz(e,t)}function gz(e,t){return gz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},gz(e,t)}function Bp(e,t,n){return t=Pte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pte(e){var t=VVe(e,"string");return g0(t)=="symbol"?t:t+""}function VVe(e,t){if(g0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(g0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sx=function(e){function t(){var n;NVe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=BVe(this,t,[].concat(a)),Bp(n,"state",{isAnimationFinished:!1}),Bp(n,"id",Em("recharts-bar-")),Bp(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),d&&d()}),Bp(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),d&&d()}),n}return UVe(t,e),FVe(t,[{key:"renderRectanglesStatically",value:function(r){var a=this,c=this.props,d=c.shape,i=c.dataKey,_=c.activeIndex,b=c.activeBar,T=wr(this.props,!1);return r&&r.map(function(A,k){var R=k===_,B=R?b:d,N=Xa(Xa(Xa({},T),A),{},{isActive:R,option:B,index:k,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Ce.createElement(_i,PP({className:"recharts-bar-rectangle"},dm(a.props,A,k),{key:"rectangle-".concat(A==null?void 0:A.x,"-").concat(A==null?void 0:A.y,"-").concat(A==null?void 0:A.value)}),Ce.createElement(ZG,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,a=this.props,c=a.data,d=a.layout,i=a.isAnimationActive,_=a.animationBegin,b=a.animationDuration,T=a.animationEasing,A=a.animationId,k=this.state.prevData;return Ce.createElement(uu,{begin:_,duration:b,isActive:i,easing:T,from:{t:0},to:{t:1},key:"bar-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var B=R.t,N=c.map(function(V,H){var G=k&&k[H];if(G){var q=ca(G.x,V.x),Q=ca(G.y,V.y),te=ca(G.width,V.width),ue=ca(G.height,V.height);return Xa(Xa({},V),{},{x:q(B),y:Q(B),width:te(B),height:ue(B)})}if(d==="horizontal"){var fe=ca(0,V.height),ye=fe(B);return Xa(Xa({},V),{},{y:V.y+V.height-ye,height:ye})}var De=ca(0,V.width),Ne=De(B);return Xa(Xa({},V),{},{width:Ne})});return Ce.createElement(_i,null,r.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var r=this.props,a=r.data,c=r.isAnimationActive,d=this.state.prevData;return c&&a&&a.length&&(!d||!pm(d,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var r=this,a=this.props,c=a.data,d=a.dataKey,i=a.activeIndex,_=wr(this.props.background,!1);return c.map(function(b,T){b.value;var A=b.background,k=LVe(b,DVe);if(!A)return null;var R=Xa(Xa(Xa(Xa(Xa({},k),{},{fill:"#eee"},A),_),dm(r.props,b,T)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:d,index:T,className:"recharts-bar-background-rectangle"});return Ce.createElement(ZG,PP({key:"background-bar-".concat(T),option:r.props.background,isActive:T===i},R))})}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.data,i=c.xAxis,_=c.yAxis,b=c.layout,T=c.children,A=bl(T,ox);if(!A)return null;var k=b==="vertical"?d[0].height/2:d[0].width/2,R=function(V,H){var G=Array.isArray(V.value)?V.value[1]:V.value;return{x:V.x,y:V.y,value:G,errorVal:Zo(V,H)}},B={clipPath:r?"url(#clipPath-".concat(a,")"):null};return Ce.createElement(_i,B,A.map(function(N){return Ce.cloneElement(N,{key:"error-bar-".concat(a,"-").concat(N.props.dataKey),data:d,xAxis:i,yAxis:_,layout:b,offset:k,dataPointFormatter:R})}))}},{key:"render",value:function(){var r=this.props,a=r.hide,c=r.data,d=r.className,i=r.xAxis,_=r.yAxis,b=r.left,T=r.top,A=r.width,k=r.height,R=r.isAnimationActive,B=r.background,N=r.id;if(a||!c||!c.length)return null;var V=this.state.isAnimationFinished,H=li("recharts-bar",d),G=i&&i.allowDataOverflow,q=_&&_.allowDataOverflow,Q=G||q,te=Nr(N)?this.id:N;return Ce.createElement(_i,{className:H},G||q?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(te)},Ce.createElement("rect",{x:G?b:b-A/2,y:q?T:T-k/2,width:G?A:A*2,height:q?k:k*2}))):null,Ce.createElement(_i,{className:"recharts-bar-rectangles",clipPath:Q?"url(#clipPath-".concat(te,")"):null},B?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(Q,te),(!R||V)&&ih.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:a.curData}:r.data!==a.curData?{curData:r.data}:null}}])}(X.PureComponent);Ete=sx;Bp(sx,"displayName","Bar");Bp(sx,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!au.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Bp(sx,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,c=e.xAxis,d=e.yAxis,i=e.xAxisTicks,_=e.yAxisTicks,b=e.stackedData,T=e.dataStartIndex,A=e.displayedData,k=e.offset,R=RBe(r,n);if(!R)return null;var B=t.layout,N=n.type.defaultProps,V=N!==void 0?Xa(Xa({},N),n.props):n.props,H=V.dataKey,G=V.children,q=V.minPointSize,Q=B==="horizontal"?d:c,te=b?Q.scale.domain():null,ue=jBe({numericAxis:Q}),fe=bl(G,fI),ye=A.map(function(De,Ne){var Fe,Le,Ze,He,ct,ot;b?Fe=DBe(b[T+Ne],te):(Fe=Zo(De,H),Array.isArray(Fe)||(Fe=[ue,Fe]));var rt=RVe(q,Ete.defaultProps.minPointSize)(Fe[1],Ne);if(B==="horizontal"){var Be,nt=[d.scale(Fe[0]),d.scale(Fe[1])],at=nt[0],Mt=nt[1];Le=BW({axis:c,ticks:i,bandSize:a,offset:R.offset,entry:De,index:Ne}),Ze=(Be=Mt??at)!==null&&Be!==void 0?Be:void 0,He=R.size;var Nt=at-Mt;if(ct=Number.isNaN(Nt)?0:Nt,ot={x:Le,y:d.y,width:He,height:d.height},Math.abs(rt)>0&&Math.abs(ct)<Math.abs(rt)){var rn=_l(ct||rt)*(Math.abs(rt)-Math.abs(ct));Ze-=rn,ct+=rn}}else{var un=[c.scale(Fe[0]),c.scale(Fe[1])],en=un[0],sn=un[1];if(Le=en,Ze=BW({axis:d,ticks:_,bandSize:a,offset:R.offset,entry:De,index:Ne}),He=sn-en,ct=R.size,ot={x:c.x,y:Ze,width:c.width,height:ct},Math.abs(rt)>0&&Math.abs(He)<Math.abs(rt)){var Vt=_l(He||rt)*(Math.abs(rt)-Math.abs(He));He+=Vt}}return Xa(Xa(Xa({},De),{},{x:Le,y:Ze,width:He,height:ct,value:b?Fe:Fe[1],payload:De,background:ot},fe&&fe[Ne]&&fe[Ne].props),{},{tooltipPayload:[Xee(n,De)],tooltipPosition:{x:Le+He/2,y:Ze+ct/2}})});return Xa({data:ye,layout:B},k)});function rS(e){"@babel/helpers - typeof";return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(e)}function WVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cte(r.key),r)}}function GVe(e,t,n){return t&&YG(e.prototype,t),n&&YG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JG(Object(n),!0).forEach(function(r){MI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function MI(e,t,n){return t=Cte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cte(e){var t=HVe(e,"string");return rS(t)=="symbol"?t:t+""}function HVe(e,t){if(rS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OI=function(t,n,r,a,c){var d=t.width,i=t.height,_=t.layout,b=t.children,T=Object.keys(n),A={left:r.left,leftMirror:r.left,right:d-r.right,rightMirror:d-r.right,top:r.top,topMirror:r.top,bottom:i-r.bottom,bottomMirror:i-r.bottom},k=!!Ac(b,sx);return T.reduce(function(R,B){var N=n[B],V=N.orientation,H=N.domain,G=N.padding,q=G===void 0?{}:G,Q=N.mirror,te=N.reversed,ue="".concat(V).concat(Q?"Mirror":""),fe,ye,De,Ne,Fe;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var Le=H[1]-H[0],Ze=1/0,He=N.categoricalDomain.sort();if(He.forEach(function(un,en){en>0&&(Ze=Math.min((un||0)-(He[en-1]||0),Ze))}),Number.isFinite(Ze)){var ct=Ze/Le,ot=N.layout==="vertical"?r.height:r.width;if(N.padding==="gap"&&(fe=ct*ot/2),N.padding==="no-gap"){var rt=yl(t.barCategoryGap,ct*ot),Be=ct*ot/2;fe=Be-rt-(Be-rt)/ot*rt}}}a==="xAxis"?ye=[r.left+(q.left||0)+(fe||0),r.left+r.width-(q.right||0)-(fe||0)]:a==="yAxis"?ye=_==="horizontal"?[r.top+r.height-(q.bottom||0),r.top+(q.top||0)]:[r.top+(q.top||0)+(fe||0),r.top+r.height-(q.bottom||0)-(fe||0)]:ye=N.range,te&&(ye=[ye[1],ye[0]]);var nt=Gee(N,c,k),at=nt.scale,Mt=nt.realScaleType;at.domain(H).range(ye),Hee(at);var Nt=qee(at,qu(qu({},N),{},{realScaleType:Mt}));a==="xAxis"?(Fe=V==="top"&&!Q||V==="bottom"&&Q,De=r.left,Ne=A[ue]-Fe*N.height):a==="yAxis"&&(Fe=V==="left"&&!Q||V==="right"&&Q,De=A[ue]-Fe*N.width,Ne=r.top);var rn=qu(qu(qu({},N),Nt),{},{realScaleType:Mt,x:De,y:Ne,scale:at,width:a==="xAxis"?r.width:N.width,height:a==="yAxis"?r.height:N.height});return rn.bandSize=hP(rn,Nt),!N.hide&&a==="xAxis"?A[ue]+=(Fe?-1:1)*rn.height:N.hide||(A[ue]+=(Fe?-1:1)*rn.width),qu(qu({},R),{},MI({},B,rn))},{})},Ite=function(t,n){var r=t.x,a=t.y,c=n.x,d=n.y;return{x:Math.min(r,c),y:Math.min(a,d),width:Math.abs(c-r),height:Math.abs(d-a)}},qVe=function(t){var n=t.x1,r=t.y1,a=t.x2,c=t.y2;return Ite({x:n,y:r},{x:a,y:c})},Mte=function(){function e(t){WVe(this,e),this.scale=t}return GVe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,c=r.position;if(n!==void 0){if(c)switch(c){case"start":return this.scale(n);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+d}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(n)+i}default:return this.scale(n)}if(a){var _=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+_}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),a=r[0],c=r[r.length-1];return a<=c?n>=a&&n<=c:n>=c&&n<=a}}],[{key:"create",value:function(n){return new e(n)}}])}();MI(Mte,"EPS",1e-4);var eB=function(t){var n=Object.keys(t).reduce(function(r,a){return qu(qu({},r),{},MI({},a,Mte.create(t[a])))},{});return qu(qu({},n),{},{apply:function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=c.bandAware,i=c.position;return fVe(a,function(_,b){return n[b].apply(_,{bandAware:d,position:i})})},isInRange:function(a){return Tte(a,function(c,d){return n[d].isInRange(c)})}})};function ZVe(e){return(e%180+180)%180}var XVe=function(t){var n=t.width,r=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=ZVe(a),d=c*Math.PI/180,i=Math.atan(r/n),_=d>i&&d<Math.PI-i?r/Math.sin(d):n/Math.cos(d);return Math.abs(_)},KVe=ld,YVe=FS,JVe=uI;function QVe(e){return function(t,n,r){var a=Object(t);if(!YVe(t)){var c=KVe(n);t=JVe(t),n=function(i){return c(a[i],i,a)}}var d=e(t,n,r);return d>-1?a[c?t[d]:d]:void 0}}var e6e=QVe,t6e=xte;function n6e(e){var t=t6e(e),n=t%1;return t===t?n?t-n:t:0}var r6e=n6e,i6e=wQ,o6e=ld,a6e=r6e,s6e=Math.max;function l6e(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var a=n==null?0:a6e(n);return a<0&&(a=s6e(r+a,0)),i6e(e,o6e(t),a)}var c6e=l6e,u6e=e6e,h6e=c6e,d6e=u6e(h6e),f6e=d6e;const p6e=lo(f6e);var m6e=lEe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),tB=X.createContext(void 0),nB=X.createContext(void 0),Ote=X.createContext(void 0),kte=X.createContext({}),Rte=X.createContext(void 0),Dte=X.createContext(0),Lte=X.createContext(0),QG=function(t){var n=t.state,r=n.xAxisMap,a=n.yAxisMap,c=n.offset,d=t.clipPathId,i=t.children,_=t.width,b=t.height,T=m6e(c);return Ce.createElement(tB.Provider,{value:r},Ce.createElement(nB.Provider,{value:a},Ce.createElement(kte.Provider,{value:c},Ce.createElement(Ote.Provider,{value:T},Ce.createElement(Rte.Provider,{value:d},Ce.createElement(Dte.Provider,{value:b},Ce.createElement(Lte.Provider,{value:_},i)))))))},g6e=function(){return X.useContext(Rte)},zte=function(t){var n=X.useContext(tB);n==null&&f_();var r=n[t];return r==null&&f_(),r},_6e=function(){var t=X.useContext(tB);return Dp(t)},y6e=function(){var t=X.useContext(nB),n=p6e(t,function(r){return Tte(r.domain,Number.isFinite)});return n||Dp(t)},Nte=function(t){var n=X.useContext(nB);n==null&&f_();var r=n[t];return r==null&&f_(),r},v6e=function(){var t=X.useContext(Ote);return t},x6e=function(){return X.useContext(kte)},rB=function(){return X.useContext(Lte)},iB=function(){return X.useContext(Dte)};function _0(e){"@babel/helpers - typeof";return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_0(e)}function b6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bte(r.key),r)}}function S6e(e,t,n){return t&&w6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function T6e(e,t,n){return t=IP(t),E6e(e,Fte()?Reflect.construct(t,n||[],IP(e).constructor):t.apply(e,n))}function E6e(e,t){if(t&&(_0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A6e(e)}function A6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fte=function(){return!!e})()}function IP(e){return IP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},IP(e)}function P6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_z(e,t)}function _z(e,t){return _z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},_z(e,t)}function eH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function tH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eH(Object(n),!0).forEach(function(r){oB(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oB(e,t,n){return t=Bte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bte(e){var t=C6e(e,"string");return _0(t)=="symbol"?t:t+""}function C6e(e,t){if(_0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I6e(e,t){return R6e(e)||k6e(e,t)||O6e(e,t)||M6e()}function M6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O6e(e,t){if(e){if(typeof e=="string")return nH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nH(e,t)}}function nH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k6e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function R6e(e){if(Array.isArray(e))return e}function yz(){return yz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yz.apply(this,arguments)}var D6e=function(t,n){var r;return Ce.isValidElement(t)?r=Ce.cloneElement(t,n):$r(t)?r=t(n):r=Ce.createElement("line",yz({},n,{className:"recharts-reference-line-line"})),r},L6e=function(t,n,r,a,c,d,i,_,b){var T=c.x,A=c.y,k=c.width,R=c.height;if(r){var B=b.y,N=t.y.apply(B,{position:d});if(Qh(b,"discard")&&!t.y.isInRange(N))return null;var V=[{x:T+k,y:N},{x:T,y:N}];return _==="left"?V.reverse():V}if(n){var H=b.x,G=t.x.apply(H,{position:d});if(Qh(b,"discard")&&!t.x.isInRange(G))return null;var q=[{x:G,y:A+R},{x:G,y:A}];return i==="top"?q.reverse():q}if(a){var Q=b.segment,te=Q.map(function(ue){return t.apply(ue,{position:d})});return Qh(b,"discard")&&oVe(te,function(ue){return!t.isInRange(ue)})?null:te}return null};function z6e(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,c=e.yAxisId,d=e.shape,i=e.className,_=e.alwaysShow,b=g6e(),T=zte(a),A=Nte(c),k=v6e();if(!b||!k)return null;rh(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var R=eB({x:T.scale,y:A.scale}),B=us(t),N=us(n),V=r&&r.length===2,H=L6e(R,B,N,V,k,e.position,T.orientation,A.orientation,e);if(!H)return null;var G=I6e(H,2),q=G[0],Q=q.x,te=q.y,ue=G[1],fe=ue.x,ye=ue.y,De=Qh(e,"hidden")?"url(#".concat(b,")"):void 0,Ne=tH(tH({clipPath:De},wr(e,!0)),{},{x1:Q,y1:te,x2:fe,y2:ye});return Ce.createElement(_i,{className:li("recharts-reference-line",i)},D6e(d,Ne),bs.renderCallByParent(e,qVe({x1:Q,y1:te,x2:fe,y2:ye})))}var aB=function(e){function t(){return b6e(this,t),T6e(this,t,arguments)}return P6e(t,e),S6e(t,[{key:"render",value:function(){return Ce.createElement(z6e,this.props)}}])}(Ce.Component);oB(aB,"displayName","ReferenceLine");oB(aB,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function vz(){return vz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vz.apply(this,arguments)}function y0(e){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y0(e)}function rH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rH(Object(n),!0).forEach(function(r){kI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function N6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$te(r.key),r)}}function B6e(e,t,n){return t&&F6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function j6e(e,t,n){return t=MP(t),$6e(e,jte()?Reflect.construct(t,n||[],MP(e).constructor):t.apply(e,n))}function $6e(e,t){if(t&&(y0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U6e(e)}function U6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jte=function(){return!!e})()}function MP(e){return MP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MP(e)}function V6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xz(e,t)}function xz(e,t){return xz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},xz(e,t)}function kI(e,t,n){return t=$te(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $te(e){var t=W6e(e,"string");return y0(t)=="symbol"?t:t+""}function W6e(e,t){if(y0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(y0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G6e=function(t){var n=t.x,r=t.y,a=t.xAxis,c=t.yAxis,d=eB({x:a.scale,y:c.scale}),i=d.apply({x:n,y:r},{bandAware:!0});return Qh(t,"discard")&&!d.isInRange(i)?null:i},RI=function(e){function t(){return N6e(this,t),j6e(this,t,arguments)}return V6e(t,e),B6e(t,[{key:"render",value:function(){var r=this.props,a=r.x,c=r.y,d=r.r,i=r.alwaysShow,_=r.clipPathId,b=us(a),T=us(c);if(rh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!b||!T)return null;var A=G6e(this.props);if(!A)return null;var k=A.x,R=A.y,B=this.props,N=B.shape,V=B.className,H=Qh(this.props,"hidden")?"url(#".concat(_,")"):void 0,G=iH(iH({clipPath:H},wr(this.props,!0)),{},{cx:k,cy:R});return Ce.createElement(_i,{className:li("recharts-reference-dot",V)},t.renderDot(N,G),bs.renderCallByParent(this.props,{x:k-d,y:R-d,width:2*d,height:2*d}))}}])}(Ce.Component);kI(RI,"displayName","ReferenceDot");kI(RI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});kI(RI,"renderDot",function(e,t){var n;return Ce.isValidElement(e)?n=Ce.cloneElement(e,t):$r(e)?n=e(t):n=Ce.createElement(VS,vz({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function bz(){return bz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bz.apply(this,arguments)}function v0(e){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v0(e)}function oH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(n),!0).forEach(function(r){DI(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function H6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vte(r.key),r)}}function Z6e(e,t,n){return t&&q6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function X6e(e,t,n){return t=OP(t),K6e(e,Ute()?Reflect.construct(t,n||[],OP(e).constructor):t.apply(e,n))}function K6e(e,t){if(t&&(v0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y6e(e)}function Y6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ute(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ute=function(){return!!e})()}function OP(e){return OP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},OP(e)}function J6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wz(e,t)}function wz(e,t){return wz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},wz(e,t)}function DI(e,t,n){return t=Vte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vte(e){var t=Q6e(e,"string");return v0(t)=="symbol"?t:t+""}function Q6e(e,t){if(v0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(v0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e8e=function(t,n,r,a,c){var d=c.x1,i=c.x2,_=c.y1,b=c.y2,T=c.xAxis,A=c.yAxis;if(!T||!A)return null;var k=eB({x:T.scale,y:A.scale}),R={x:t?k.x.apply(d,{position:"start"}):k.x.rangeMin,y:r?k.y.apply(_,{position:"start"}):k.y.rangeMin},B={x:n?k.x.apply(i,{position:"end"}):k.x.rangeMax,y:a?k.y.apply(b,{position:"end"}):k.y.rangeMax};return Qh(c,"discard")&&(!k.isInRange(R)||!k.isInRange(B))?null:Ite(R,B)},LI=function(e){function t(){return H6e(this,t),X6e(this,t,arguments)}return J6e(t,e),Z6e(t,[{key:"render",value:function(){var r=this.props,a=r.x1,c=r.x2,d=r.y1,i=r.y2,_=r.className,b=r.alwaysShow,T=r.clipPathId;rh(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var A=us(a),k=us(c),R=us(d),B=us(i),N=this.props.shape;if(!A&&!k&&!R&&!B&&!N)return null;var V=e8e(A,k,R,B,this.props);if(!V&&!N)return null;var H=Qh(this.props,"hidden")?"url(#".concat(T,")"):void 0;return Ce.createElement(_i,{className:li("recharts-reference-area",_)},t.renderRect(N,aH(aH({clipPath:H},wr(this.props,!0)),V)),bs.renderCallByParent(this.props,V))}}])}(Ce.Component);DI(LI,"displayName","ReferenceArea");DI(LI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});DI(LI,"renderRect",function(e,t){var n;return Ce.isValidElement(e)?n=Ce.cloneElement(e,t):$r(e)?n=e(t):n=Ce.createElement(QF,bz({},t,{className:"recharts-reference-area-rect"})),n});function Wte(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function t8e(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return XVe(r,n)}function n8e(e,t,n){var r=n==="width",a=e.x,c=e.y,d=e.width,i=e.height;return t===1?{start:r?a:c,end:r?a+d:c+i}:{start:r?a+d:c+i,end:r?a:c}}function kP(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var c=n();return e*(t-e*c/2-r)>=0&&e*(t+e*c/2-a)<=0}function r8e(e,t){return Wte(e,t+1)}function i8e(e,t,n,r,a){for(var c=(r||[]).slice(),d=t.start,i=t.end,_=0,b=1,T=d,A=function(){var B=r==null?void 0:r[_];if(B===void 0)return{v:Wte(r,b)};var N=_,V,H=function(){return V===void 0&&(V=n(B,N)),V},G=B.coordinate,q=_===0||kP(e,G,H,T,i);q||(_=0,T=d,b+=1),q&&(T=G+e*(H()/2+a),_+=b)},k;b<=c.length;)if(k=A(),k)return k.v;return[]}function iS(e){"@babel/helpers - typeof";return iS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iS(e)}function sH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ks(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sH(Object(n),!0).forEach(function(r){o8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function o8e(e,t,n){return t=a8e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a8e(e){var t=s8e(e,"string");return iS(t)=="symbol"?t:t+""}function s8e(e,t){if(iS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(iS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l8e(e,t,n,r,a){for(var c=(r||[]).slice(),d=c.length,i=t.start,_=t.end,b=function(k){var R=c[k],B,N=function(){return B===void 0&&(B=n(R,k)),B};if(k===d-1){var V=e*(R.coordinate+e*N()/2-_);c[k]=R=Ks(Ks({},R),{},{tickCoord:V>0?R.coordinate-V*e:R.coordinate})}else c[k]=R=Ks(Ks({},R),{},{tickCoord:R.coordinate});var H=kP(e,R.tickCoord,N,i,_);H&&(_=R.tickCoord-e*(N()/2+a),c[k]=Ks(Ks({},R),{},{isShow:!0}))},T=d-1;T>=0;T--)b(T);return c}function c8e(e,t,n,r,a,c){var d=(r||[]).slice(),i=d.length,_=t.start,b=t.end;if(c){var T=r[i-1],A=n(T,i-1),k=e*(T.coordinate+e*A/2-b);d[i-1]=T=Ks(Ks({},T),{},{tickCoord:k>0?T.coordinate-k*e:T.coordinate});var R=kP(e,T.tickCoord,function(){return A},_,b);R&&(b=T.tickCoord-e*(A/2+a),d[i-1]=Ks(Ks({},T),{},{isShow:!0}))}for(var B=c?i-1:i,N=function(G){var q=d[G],Q,te=function(){return Q===void 0&&(Q=n(q,G)),Q};if(G===0){var ue=e*(q.coordinate-e*te()/2-_);d[G]=q=Ks(Ks({},q),{},{tickCoord:ue<0?q.coordinate-ue*e:q.coordinate})}else d[G]=q=Ks(Ks({},q),{},{tickCoord:q.coordinate});var fe=kP(e,q.tickCoord,te,_,b);fe&&(_=q.tickCoord+e*(te()/2+a),d[G]=Ks(Ks({},q),{},{isShow:!0}))},V=0;V<B;V++)N(V);return d}function sB(e,t,n){var r=e.tick,a=e.ticks,c=e.viewBox,d=e.minTickGap,i=e.orientation,_=e.interval,b=e.tickFormatter,T=e.unit,A=e.angle;if(!a||!a.length||!r)return[];if(zn(_)||au.isSsr)return r8e(a,typeof _=="number"&&zn(_)?_:0);var k=[],R=i==="top"||i==="bottom"?"width":"height",B=T&&R==="width"?kb(T,{fontSize:t,letterSpacing:n}):{width:0,height:0},N=function(q,Q){var te=$r(b)?b(q.value,Q):q.value;return R==="width"?t8e(kb(te,{fontSize:t,letterSpacing:n}),B,A):kb(te,{fontSize:t,letterSpacing:n})[R]},V=a.length>=2?_l(a[1].coordinate-a[0].coordinate):1,H=n8e(c,V,R);return _==="equidistantPreserveStart"?i8e(V,H,N,a,d):(_==="preserveStart"||_==="preserveStartEnd"?k=c8e(V,H,N,a,d,_==="preserveStartEnd"):k=l8e(V,H,N,a,d),k.filter(function(G){return G.isShow}))}var u8e=["viewBox"],h8e=["viewBox"],d8e=["ticks"];function x0(e){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(e)}function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vv.apply(this,arguments)}function lH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function fl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lH(Object(n),!0).forEach(function(r){lB(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gR(e,t){if(e==null)return{};var n=f8e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f8e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function p8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hte(r.key),r)}}function m8e(e,t,n){return t&&cH(e.prototype,t),n&&cH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g8e(e,t,n){return t=RP(t),_8e(e,Gte()?Reflect.construct(t,n||[],RP(e).constructor):t.apply(e,n))}function _8e(e,t){if(t&&(x0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y8e(e)}function y8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gte=function(){return!!e})()}function RP(e){return RP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},RP(e)}function v8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sz(e,t)}function Sz(e,t){return Sz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Sz(e,t)}function lB(e,t,n){return t=Hte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hte(e){var t=x8e(e,"string");return x0(t)=="symbol"?t:t+""}function x8e(e,t){if(x0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(x0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lx=function(e){function t(n){var r;return p8e(this,t),r=g8e(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return v8e(t,e),m8e(t,[{key:"shouldComponentUpdate",value:function(r,a){var c=r.viewBox,d=gR(r,u8e),i=this.props,_=i.viewBox,b=gR(i,h8e);return!Mv(c,_)||!Mv(d,b)||!Mv(a,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var a=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var a=this.props,c=a.x,d=a.y,i=a.width,_=a.height,b=a.orientation,T=a.tickSize,A=a.mirror,k=a.tickMargin,R,B,N,V,H,G,q=A?-1:1,Q=r.tickSize||T,te=zn(r.tickCoord)?r.tickCoord:r.coordinate;switch(b){case"top":R=B=r.coordinate,V=d+ +!A*_,N=V-q*Q,G=N-q*k,H=te;break;case"left":N=V=r.coordinate,B=c+ +!A*i,R=B-q*Q,H=R-q*k,G=te;break;case"right":N=V=r.coordinate,B=c+ +A*i,R=B+q*Q,H=R+q*k,G=te;break;default:R=B=r.coordinate,V=d+ +A*_,N=V+q*Q,G=N+q*k,H=te;break}return{line:{x1:R,y1:N,x2:B,y2:V},tick:{x:H,y:G}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,a=r.orientation,c=r.mirror,d;switch(a){case"left":d=c?"start":"end";break;case"right":d=c?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,a=r.orientation,c=r.mirror,d="end";switch(a){case"left":case"right":d="middle";break;case"top":d=c?"start":"end";break;default:d=c?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.x,c=r.y,d=r.width,i=r.height,_=r.orientation,b=r.mirror,T=r.axisLine,A=fl(fl(fl({},wr(this.props,!1)),wr(T,!1)),{},{fill:"none"});if(_==="top"||_==="bottom"){var k=+(_==="top"&&!b||_==="bottom"&&b);A=fl(fl({},A),{},{x1:a,y1:c+k*i,x2:a+d,y2:c+k*i})}else{var R=+(_==="left"&&!b||_==="right"&&b);A=fl(fl({},A),{},{x1:a+R*d,y1:c,x2:a+R*d,y2:c+i})}return Ce.createElement("line",vv({},A,{className:li("recharts-cartesian-axis-line",Rc(T,"className"))}))}},{key:"renderTicks",value:function(r,a,c){var d=this,i=this.props,_=i.tickLine,b=i.stroke,T=i.tick,A=i.tickFormatter,k=i.unit,R=sB(fl(fl({},this.props),{},{ticks:r}),a,c),B=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),V=wr(this.props,!1),H=wr(T,!1),G=fl(fl({},V),{},{fill:"none"},wr(_,!1)),q=R.map(function(Q,te){var ue=d.getTickLineCoord(Q),fe=ue.line,ye=ue.tick,De=fl(fl(fl(fl({textAnchor:B,verticalAnchor:N},V),{},{stroke:"none",fill:b},H),ye),{},{index:te,payload:Q,visibleTicksCount:R.length,tickFormatter:A});return Ce.createElement(_i,vv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Q.value,"-").concat(Q.coordinate,"-").concat(Q.tickCoord)},dm(d.props,Q,te)),_&&Ce.createElement("line",vv({},G,fe,{className:li("recharts-cartesian-axis-tick-line",Rc(_,"className"))})),T&&t.renderTickItem(T,De,"".concat($r(A)?A(Q.value,te):Q.value).concat(k||"")))});return Ce.createElement("g",{className:"recharts-cartesian-axis-ticks"},q)}},{key:"render",value:function(){var r=this,a=this.props,c=a.axisLine,d=a.width,i=a.height,_=a.ticksGenerator,b=a.className,T=a.hide;if(T)return null;var A=this.props,k=A.ticks,R=gR(A,d8e),B=k;return $r(_)&&(B=k&&k.length>0?_(this.props):_(R)),d<=0||i<=0||!B||!B.length?null:Ce.createElement(_i,{className:li("recharts-cartesian-axis",b),ref:function(V){r.layerReference=V}},c&&this.renderAxisLine(),this.renderTicks(B,this.state.fontSize,this.state.letterSpacing),bs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,a,c){var d;return Ce.isValidElement(r)?d=Ce.cloneElement(r,a):$r(r)?d=r(a):d=Ce.createElement(u_,vv({},a,{className:"recharts-cartesian-axis-tick-value"}),c),d}}])}(X.Component);lB(lx,"displayName","CartesianAxis");lB(lx,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var b8e=["x1","y1","x2","y2","key"],w8e=["offset"];function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function uH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Js(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uH(Object(n),!0).forEach(function(r){S8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S8e(e,t,n){return t=T8e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T8e(e){var t=E8e(e,"string");return p_(t)=="symbol"?t:t+""}function E8e(e,t){if(p_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(p_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gg(){return Gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gg.apply(this,arguments)}function hH(e,t){if(e==null)return{};var n=A8e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A8e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var P8e=function(t){var n=t.fill;if(!n||n==="none")return null;var r=t.fillOpacity,a=t.x,c=t.y,d=t.width,i=t.height,_=t.ry;return Ce.createElement("rect",{x:a,y:c,ry:_,width:d,height:i,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function qte(e,t){var n;if(Ce.isValidElement(e))n=Ce.cloneElement(e,t);else if($r(e))n=e(t);else{var r=t.x1,a=t.y1,c=t.x2,d=t.y2,i=t.key,_=hH(t,b8e),b=wr(_,!1);b.offset;var T=hH(b,w8e);n=Ce.createElement("line",Gg({},T,{x1:r,y1:a,x2:c,y2:d,fill:"none",key:i}))}return n}function C8e(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,c=e.horizontalPoints;if(!a||!c||!c.length)return null;var d=c.map(function(i,_){var b=Js(Js({},e),{},{x1:t,y1:i,x2:t+n,y2:i,key:"line-".concat(_),index:_});return qte(a,b)});return Ce.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function I8e(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,c=e.verticalPoints;if(!a||!c||!c.length)return null;var d=c.map(function(i,_){var b=Js(Js({},e),{},{x1:i,y1:t,x2:i,y2:t+n,key:"line-".concat(_),index:_});return qte(a,b)});return Ce.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function M8e(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,c=e.width,d=e.height,i=e.horizontalPoints,_=e.horizontal,b=_===void 0?!0:_;if(!b||!t||!t.length)return null;var T=i.map(function(k){return Math.round(k+a-a)}).sort(function(k,R){return k-R});a!==T[0]&&T.unshift(0);var A=T.map(function(k,R){var B=!T[R+1],N=B?a+d-k:T[R+1]-k;if(N<=0)return null;var V=R%t.length;return Ce.createElement("rect",{key:"react-".concat(R),y:k,x:r,height:N,width:c,stroke:"none",fill:t[V],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},A)}function O8e(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,c=e.x,d=e.y,i=e.width,_=e.height,b=e.verticalPoints;if(!n||!r||!r.length)return null;var T=b.map(function(k){return Math.round(k+c-c)}).sort(function(k,R){return k-R});c!==T[0]&&T.unshift(0);var A=T.map(function(k,R){var B=!T[R+1],N=B?c+i-k:T[R+1]-k;if(N<=0)return null;var V=R%r.length;return Ce.createElement("rect",{key:"react-".concat(R),x:k,y:d,width:N,height:_,stroke:"none",fill:r[V],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},A)}var k8e=function(t,n){var r=t.xAxis,a=t.width,c=t.height,d=t.offset;return Wee(sB(Js(Js(Js({},lx.defaultProps),r),{},{ticks:of(r,!0),viewBox:{x:0,y:0,width:a,height:c}})),d.left,d.left+d.width,n)},R8e=function(t,n){var r=t.yAxis,a=t.width,c=t.height,d=t.offset;return Wee(sB(Js(Js(Js({},lx.defaultProps),r),{},{ticks:of(r,!0),viewBox:{x:0,y:0,width:a,height:c}})),d.top,d.top+d.height,n)},Jy={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function D8e(e){var t,n,r,a,c,d,i=rB(),_=iB(),b=x6e(),T=Js(Js({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Jy.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Jy.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Jy.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Jy.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:Jy.vertical,verticalFill:(d=e.verticalFill)!==null&&d!==void 0?d:Jy.verticalFill,x:zn(e.x)?e.x:b.left,y:zn(e.y)?e.y:b.top,width:zn(e.width)?e.width:b.width,height:zn(e.height)?e.height:b.height}),A=T.x,k=T.y,R=T.width,B=T.height,N=T.syncWithTicks,V=T.horizontalValues,H=T.verticalValues,G=_6e(),q=y6e();if(!zn(R)||R<=0||!zn(B)||B<=0||!zn(A)||A!==+A||!zn(k)||k!==+k)return null;var Q=T.verticalCoordinatesGenerator||k8e,te=T.horizontalCoordinatesGenerator||R8e,ue=T.horizontalPoints,fe=T.verticalPoints;if((!ue||!ue.length)&&$r(te)){var ye=V&&V.length,De=te({yAxis:q?Js(Js({},q),{},{ticks:ye?V:q.ticks}):void 0,width:i,height:_,offset:b},ye?!0:N);rh(Array.isArray(De),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(p_(De),"]")),Array.isArray(De)&&(ue=De)}if((!fe||!fe.length)&&$r(Q)){var Ne=H&&H.length,Fe=Q({xAxis:G?Js(Js({},G),{},{ticks:Ne?H:G.ticks}):void 0,width:i,height:_,offset:b},Ne?!0:N);rh(Array.isArray(Fe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(p_(Fe),"]")),Array.isArray(Fe)&&(fe=Fe)}return Ce.createElement("g",{className:"recharts-cartesian-grid"},Ce.createElement(P8e,{fill:T.fill,fillOpacity:T.fillOpacity,x:T.x,y:T.y,width:T.width,height:T.height,ry:T.ry}),Ce.createElement(C8e,Gg({},T,{offset:b,horizontalPoints:ue,xAxis:G,yAxis:q})),Ce.createElement(I8e,Gg({},T,{offset:b,verticalPoints:fe,xAxis:G,yAxis:q})),Ce.createElement(M8e,Gg({},T,{horizontalPoints:ue})),Ce.createElement(O8e,Gg({},T,{verticalPoints:fe})))}D8e.displayName="CartesianGrid";var L8e=["type","layout","connectNulls","ref"],z8e=["key"];function b0(e){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(e)}function dH(e,t){if(e==null)return{};var n=N8e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N8e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Fb(){return Fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fb.apply(this,arguments)}function fH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Sc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fH(Object(n),!0).forEach(function(r){Zu(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qy(e){return $8e(e)||j8e(e)||B8e(e)||F8e()}function F8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B8e(e,t){if(e){if(typeof e=="string")return Tz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tz(e,t)}}function j8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $8e(e){if(Array.isArray(e))return Tz(e)}function Tz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xte(r.key),r)}}function V8e(e,t,n){return t&&pH(e.prototype,t),n&&pH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function W8e(e,t,n){return t=DP(t),G8e(e,Zte()?Reflect.construct(t,n||[],DP(e).constructor):t.apply(e,n))}function G8e(e,t){if(t&&(b0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H8e(e)}function H8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zte=function(){return!!e})()}function DP(e){return DP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DP(e)}function q8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ez(e,t)}function Ez(e,t){return Ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Ez(e,t)}function Zu(e,t,n){return t=Xte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xte(e){var t=Z8e(e,"string");return b0(t)=="symbol"?t:t+""}function Z8e(e,t){if(b0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(b0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zI=function(e){function t(){var n;U8e(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=W8e(this,t,[].concat(a)),Zu(n,"state",{isAnimationFinished:!0,totalLength:0}),Zu(n,"generateSimpleStrokeDasharray",function(d,i){return"".concat(i,"px ").concat(d-i,"px")}),Zu(n,"getStrokeDasharray",function(d,i,_){var b=_.reduce(function(H,G){return H+G});if(!b)return n.generateSimpleStrokeDasharray(i,d);for(var T=Math.floor(d/b),A=d%b,k=i-d,R=[],B=0,N=0;B<_.length;N+=_[B],++B)if(N+_[B]>A){R=[].concat(Qy(_.slice(0,B)),[A-N]);break}var V=R.length%2===0?[0,k]:[k];return[].concat(Qy(t.repeat(_,T)),Qy(R),V).map(function(H){return"".concat(H,"px")}).join(", ")}),Zu(n,"id",Em("recharts-line-")),Zu(n,"pathRef",function(d){n.mainCurve=d}),Zu(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Zu(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return q8e(t,e),V8e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.points,i=c.xAxis,_=c.yAxis,b=c.layout,T=c.children,A=bl(T,ox);if(!A)return null;var k=function(N,V){return{x:N.x,y:N.y,value:N.value,errorVal:Zo(N.payload,V)}},R={clipPath:r?"url(#clipPath-".concat(a,")"):null};return Ce.createElement(_i,R,A.map(function(B){return Ce.cloneElement(B,{key:"bar-".concat(B.props.dataKey),data:d,xAxis:i,yAxis:_,layout:b,dataPointFormatter:k})}))}},{key:"renderDots",value:function(r,a,c){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var i=this.props,_=i.dot,b=i.points,T=i.dataKey,A=wr(this.props,!1),k=wr(_,!0),R=b.map(function(N,V){var H=Sc(Sc(Sc({key:"dot-".concat(V),r:3},A),k),{},{value:N.value,dataKey:T,cx:N.x,cy:N.y,index:V,payload:N.payload});return t.renderDotItem(_,H)}),B={clipPath:r?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Ce.createElement(_i,Fb({className:"recharts-line-dots",key:"dots"},B),R)}},{key:"renderCurveStatically",value:function(r,a,c,d){var i=this.props,_=i.type,b=i.layout,T=i.connectNulls;i.ref;var A=dH(i,L8e),k=Sc(Sc(Sc({},wr(A,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(c,")"):null,points:r},d),{},{type:_,layout:b,connectNulls:T});return Ce.createElement(em,Fb({},k,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,a){var c=this,d=this.props,i=d.points,_=d.strokeDasharray,b=d.isAnimationActive,T=d.animationBegin,A=d.animationDuration,k=d.animationEasing,R=d.animationId,B=d.animateNewValues,N=d.width,V=d.height,H=this.state,G=H.prevPoints,q=H.totalLength;return Ce.createElement(uu,{begin:T,duration:A,isActive:b,easing:k,from:{t:0},to:{t:1},key:"line-".concat(R),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(Q){var te=Q.t;if(G){var ue=G.length/i.length,fe=i.map(function(Le,Ze){var He=Math.floor(Ze*ue);if(G[He]){var ct=G[He],ot=ca(ct.x,Le.x),rt=ca(ct.y,Le.y);return Sc(Sc({},Le),{},{x:ot(te),y:rt(te)})}if(B){var Be=ca(N*2,Le.x),nt=ca(V/2,Le.y);return Sc(Sc({},Le),{},{x:Be(te),y:nt(te)})}return Sc(Sc({},Le),{},{x:Le.x,y:Le.y})});return c.renderCurveStatically(fe,r,a)}var ye=ca(0,q),De=ye(te),Ne;if(_){var Fe="".concat(_).split(/[,\s]+/gim).map(function(Le){return parseFloat(Le)});Ne=c.getStrokeDasharray(De,q,Fe)}else Ne=c.generateSimpleStrokeDasharray(q,De);return c.renderCurveStatically(i,r,a,{strokeDasharray:Ne})})}},{key:"renderCurve",value:function(r,a){var c=this.props,d=c.points,i=c.isAnimationActive,_=this.state,b=_.prevPoints,T=_.totalLength;return i&&d&&d.length&&(!b&&T>0||!pm(b,d))?this.renderCurveWithAnimation(r,a):this.renderCurveStatically(d,r,a)}},{key:"render",value:function(){var r,a=this.props,c=a.hide,d=a.dot,i=a.points,_=a.className,b=a.xAxis,T=a.yAxis,A=a.top,k=a.left,R=a.width,B=a.height,N=a.isAnimationActive,V=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,G=i.length===1,q=li("recharts-line",_),Q=b&&b.allowDataOverflow,te=T&&T.allowDataOverflow,ue=Q||te,fe=Nr(V)?this.id:V,ye=(r=wr(d,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},De=ye.r,Ne=De===void 0?3:De,Fe=ye.strokeWidth,Le=Fe===void 0?2:Fe,Ze=DJ(d)?d:{},He=Ze.clipDot,ct=He===void 0?!0:He,ot=Ne*2+Le;return Ce.createElement(_i,{className:q},Q||te?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(fe)},Ce.createElement("rect",{x:Q?k:k-R/2,y:te?A:A-B/2,width:Q?R:R*2,height:te?B:B*2})),!ct&&Ce.createElement("clipPath",{id:"clipPath-dots-".concat(fe)},Ce.createElement("rect",{x:k-ot/2,y:A-ot/2,width:R+ot,height:B+ot}))):null,!G&&this.renderCurve(ue,fe),this.renderErrorBar(ue,fe),(G||d)&&this.renderDots(ue,ct,fe),(!N||H)&&ih.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,a){for(var c=r.length%2!==0?[].concat(Qy(r),[0]):r,d=[],i=0;i<a;++i)d=[].concat(Qy(d),Qy(c));return d}},{key:"renderDotItem",value:function(r,a){var c;if(Ce.isValidElement(r))c=Ce.cloneElement(r,a);else if($r(r))c=r(a);else{var d=a.key,i=dH(a,z8e),_=li("recharts-line-dot",typeof r!="boolean"?r.className:"");c=Ce.createElement(VS,Fb({key:d},i,{className:_}))}return c}}])}(X.PureComponent);Zu(zI,"displayName","Line");Zu(zI,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!au.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Zu(zI,"getComposedData",function(e){var t=e.props,n=e.xAxis,r=e.yAxis,a=e.xAxisTicks,c=e.yAxisTicks,d=e.dataKey,i=e.bandSize,_=e.displayedData,b=e.offset,T=t.layout,A=_.map(function(k,R){var B=Zo(k,d);return T==="horizontal"?{x:c0({axis:n,ticks:a,bandSize:i,entry:k,index:R}),y:Nr(B)?null:r.scale(B),value:B,payload:k}:{x:Nr(B)?null:n.scale(B),y:c0({axis:r,ticks:c,bandSize:i,entry:k,index:R}),value:B,payload:k}});return Sc({points:A,layout:T},b)});var X8e=["layout","type","stroke","connectNulls","isRange","ref"],K8e=["key"],Kte;function w0(e){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w0(e)}function Yte(e,t){if(e==null)return{};var n=Y8e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y8e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Hg(){return Hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hg.apply(this,arguments)}function mH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Tp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mH(Object(n),!0).forEach(function(r){Zh(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function J8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qte(r.key),r)}}function Q8e(e,t,n){return t&&gH(e.prototype,t),n&&gH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function eWe(e,t,n){return t=LP(t),tWe(e,Jte()?Reflect.construct(t,n||[],LP(e).constructor):t.apply(e,n))}function tWe(e,t){if(t&&(w0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nWe(e)}function nWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jte=function(){return!!e})()}function LP(e){return LP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},LP(e)}function rWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Az(e,t)}function Az(e,t){return Az=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Az(e,t)}function Zh(e,t,n){return t=Qte(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qte(e){var t=iWe(e,"string");return w0(t)=="symbol"?t:t+""}function iWe(e,t){if(w0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(w0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k_=function(e){function t(){var n;J8e(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=eWe(this,t,[].concat(a)),Zh(n,"state",{isAnimationFinished:!0}),Zh(n,"id",Em("recharts-area-")),Zh(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),$r(d)&&d()}),Zh(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),$r(d)&&d()}),n}return rWe(t,e),Q8e(t,[{key:"renderDots",value:function(r,a,c){var d=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(d&&!i)return null;var _=this.props,b=_.dot,T=_.points,A=_.dataKey,k=wr(this.props,!1),R=wr(b,!0),B=T.map(function(V,H){var G=Tp(Tp(Tp({key:"dot-".concat(H),r:3},k),R),{},{index:H,cx:V.x,cy:V.y,dataKey:A,value:V.value,payload:V.payload,points:T});return t.renderDotItem(b,G)}),N={clipPath:r?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Ce.createElement(_i,Hg({className:"recharts-area-dots"},N),B)}},{key:"renderHorizontalRect",value:function(r){var a=this.props,c=a.baseLine,d=a.points,i=a.strokeWidth,_=d[0].x,b=d[d.length-1].x,T=r*Math.abs(_-b),A=Fp(d.map(function(k){return k.y||0}));return zn(c)&&typeof c=="number"?A=Math.max(c,A):c&&Array.isArray(c)&&c.length&&(A=Math.max(Fp(c.map(function(k){return k.y||0})),A)),zn(A)?Ce.createElement("rect",{x:_<b?_:_-T,y:0,width:T,height:Math.floor(A+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var a=this.props,c=a.baseLine,d=a.points,i=a.strokeWidth,_=d[0].y,b=d[d.length-1].y,T=r*Math.abs(_-b),A=Fp(d.map(function(k){return k.x||0}));return zn(c)&&typeof c=="number"?A=Math.max(c,A):c&&Array.isArray(c)&&c.length&&(A=Math.max(Fp(c.map(function(k){return k.x||0})),A)),zn(A)?Ce.createElement("rect",{x:0,y:_<b?_:_-T,width:A+(i?parseInt("".concat(i),10):1),height:Math.floor(T)}):null}},{key:"renderClipRect",value:function(r){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,a,c,d){var i=this.props,_=i.layout,b=i.type,T=i.stroke,A=i.connectNulls,k=i.isRange;i.ref;var R=Yte(i,X8e);return Ce.createElement(_i,{clipPath:c?"url(#clipPath-".concat(d,")"):null},Ce.createElement(em,Hg({},wr(R,!0),{points:r,connectNulls:A,type:b,baseLine:a,layout:_,stroke:"none",className:"recharts-area-area"})),T!=="none"&&Ce.createElement(em,Hg({},wr(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:A,fill:"none",points:r})),T!=="none"&&k&&Ce.createElement(em,Hg({},wr(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:A,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(r,a){var c=this,d=this.props,i=d.points,_=d.baseLine,b=d.isAnimationActive,T=d.animationBegin,A=d.animationDuration,k=d.animationEasing,R=d.animationId,B=this.state,N=B.prevPoints,V=B.prevBaseLine;return Ce.createElement(uu,{begin:T,duration:A,isActive:b,easing:k,from:{t:0},to:{t:1},key:"area-".concat(R),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(H){var G=H.t;if(N){var q=N.length/i.length,Q=i.map(function(ye,De){var Ne=Math.floor(De*q);if(N[Ne]){var Fe=N[Ne],Le=ca(Fe.x,ye.x),Ze=ca(Fe.y,ye.y);return Tp(Tp({},ye),{},{x:Le(G),y:Ze(G)})}return ye}),te;if(zn(_)&&typeof _=="number"){var ue=ca(V,_);te=ue(G)}else if(Nr(_)||J0(_)){var fe=ca(V,0);te=fe(G)}else te=_.map(function(ye,De){var Ne=Math.floor(De*q);if(V[Ne]){var Fe=V[Ne],Le=ca(Fe.x,ye.x),Ze=ca(Fe.y,ye.y);return Tp(Tp({},ye),{},{x:Le(G),y:Ze(G)})}return ye});return c.renderAreaStatically(Q,te,r,a)}return Ce.createElement(_i,null,Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"animationClipPath-".concat(a)},c.renderClipRect(G))),Ce.createElement(_i,{clipPath:"url(#animationClipPath-".concat(a,")")},c.renderAreaStatically(i,_,r,a)))})}},{key:"renderArea",value:function(r,a){var c=this.props,d=c.points,i=c.baseLine,_=c.isAnimationActive,b=this.state,T=b.prevPoints,A=b.prevBaseLine,k=b.totalLength;return _&&d&&d.length&&(!T&&k>0||!pm(T,d)||!pm(A,i))?this.renderAreaWithAnimation(r,a):this.renderAreaStatically(d,i,r,a)}},{key:"render",value:function(){var r,a=this.props,c=a.hide,d=a.dot,i=a.points,_=a.className,b=a.top,T=a.left,A=a.xAxis,k=a.yAxis,R=a.width,B=a.height,N=a.isAnimationActive,V=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,G=i.length===1,q=li("recharts-area",_),Q=A&&A.allowDataOverflow,te=k&&k.allowDataOverflow,ue=Q||te,fe=Nr(V)?this.id:V,ye=(r=wr(d,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},De=ye.r,Ne=De===void 0?3:De,Fe=ye.strokeWidth,Le=Fe===void 0?2:Fe,Ze=DJ(d)?d:{},He=Ze.clipDot,ct=He===void 0?!0:He,ot=Ne*2+Le;return Ce.createElement(_i,{className:q},Q||te?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(fe)},Ce.createElement("rect",{x:Q?T:T-R/2,y:te?b:b-B/2,width:Q?R:R*2,height:te?B:B*2})),!ct&&Ce.createElement("clipPath",{id:"clipPath-dots-".concat(fe)},Ce.createElement("rect",{x:T-ot/2,y:b-ot/2,width:R+ot,height:B+ot}))):null,G?null:this.renderArea(ue,fe),(d||G)&&this.renderDots(ue,ct,fe),(!N||H)&&ih.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:r.points!==a.curPoints||r.baseLine!==a.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(X.PureComponent);Kte=k_;Zh(k_,"displayName","Area");Zh(k_,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!au.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Zh(k_,"getBaseValue",function(e,t,n,r){var a=e.layout,c=e.baseValue,d=t.props.baseValue,i=d??c;if(zn(i)&&typeof i=="number")return i;var _=a==="horizontal"?r:n,b=_.scale.domain();if(_.type==="number"){var T=Math.max(b[0],b[1]),A=Math.min(b[0],b[1]);return i==="dataMin"?A:i==="dataMax"||T<0?T:Math.max(Math.min(b[0],b[1]),0)}return i==="dataMin"?b[0]:i==="dataMax"?b[1]:b[0]});Zh(k_,"getComposedData",function(e){var t=e.props,n=e.item,r=e.xAxis,a=e.yAxis,c=e.xAxisTicks,d=e.yAxisTicks,i=e.bandSize,_=e.dataKey,b=e.stackedData,T=e.dataStartIndex,A=e.displayedData,k=e.offset,R=t.layout,B=b&&b.length,N=Kte.getBaseValue(t,n,r,a),V=R==="horizontal",H=!1,G=A.map(function(Q,te){var ue;B?ue=b[T+te]:(ue=Zo(Q,_),Array.isArray(ue)?H=!0:ue=[N,ue]);var fe=ue[1]==null||B&&Zo(Q,_)==null;return V?{x:c0({axis:r,ticks:c,bandSize:i,entry:Q,index:te}),y:fe?null:a.scale(ue[1]),value:ue,payload:Q}:{x:fe?null:r.scale(ue[1]),y:c0({axis:a,ticks:d,bandSize:i,entry:Q,index:te}),value:ue,payload:Q}}),q;return B||H?q=G.map(function(Q){var te=Array.isArray(Q.value)?Q.value[0]:null;return V?{x:Q.x,y:te!=null&&Q.y!=null?a.scale(te):null}:{x:te!=null?r.scale(te):null,y:Q.y}}):q=V?a.scale(N):r.scale(N),Tp({points:G,baseLine:q,layout:R,isRange:H},k)});Zh(k_,"renderDotItem",function(e,t){var n;if(Ce.isValidElement(e))n=Ce.cloneElement(e,t);else if($r(e))n=e(t);else{var r=li("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,c=Yte(t,K8e);n=Ce.createElement(VS,Hg({},c,{key:a,className:r}))}return n});function S0(e){"@babel/helpers - typeof";return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S0(e)}function oWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aWe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nne(r.key),r)}}function sWe(e,t,n){return t&&aWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lWe(e,t,n){return t=zP(t),cWe(e,ene()?Reflect.construct(t,n||[],zP(e).constructor):t.apply(e,n))}function cWe(e,t){if(t&&(S0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uWe(e)}function uWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ene(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ene=function(){return!!e})()}function zP(e){return zP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zP(e)}function hWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pz(e,t)}function Pz(e,t){return Pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Pz(e,t)}function tne(e,t,n){return t=nne(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nne(e){var t=dWe(e,"string");return S0(t)=="symbol"?t:t+""}function dWe(e,t){if(S0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(S0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NI=function(e){function t(){return oWe(this,t),lWe(this,t,arguments)}return hWe(t,e),sWe(t,[{key:"render",value:function(){return null}}])}(Ce.Component);tne(NI,"displayName","ZAxis");tne(NI,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var fWe=["option","isActive"];function Bb(){return Bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bb.apply(this,arguments)}function pWe(e,t){if(e==null)return{};var n=mWe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mWe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function gWe(e){var t=e.option,n=e.isActive,r=pWe(e,fWe);return typeof t=="string"?Ce.createElement(wP,Bb({option:Ce.createElement(cI,Bb({type:t},r)),isActive:n,shapeType:"symbols"},r)):Ce.createElement(wP,Bb({option:t,isActive:n,shapeType:"symbols"},r))}function T0(e){"@babel/helpers - typeof";return T0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T0(e)}function jb(){return jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jb.apply(this,arguments)}function _H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Yc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(n),!0).forEach(function(r){jp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_H(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ine(r.key),r)}}function yWe(e,t,n){return t&&yH(e.prototype,t),n&&yH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vWe(e,t,n){return t=NP(t),xWe(e,rne()?Reflect.construct(t,n||[],NP(e).constructor):t.apply(e,n))}function xWe(e,t){if(t&&(T0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bWe(e)}function bWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rne=function(){return!!e})()}function NP(e){return NP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},NP(e)}function wWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cz(e,t)}function Cz(e,t){return Cz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Cz(e,t)}function jp(e,t,n){return t=ine(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ine(e){var t=SWe(e,"string");return T0(t)=="symbol"?t:t+""}function SWe(e,t){if(T0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(T0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FI=function(e){function t(){var n;_We(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=vWe(this,t,[].concat(a)),jp(n,"state",{isAnimationFinished:!1}),jp(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),jp(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),jp(n,"id",Em("recharts-scatter-")),n}return wWe(t,e),yWe(t,[{key:"renderSymbolsStatically",value:function(r){var a=this,c=this.props,d=c.shape,i=c.activeShape,_=c.activeIndex,b=wr(this.props,!1);return r.map(function(T,A){var k=_===A,R=k?i:d,B=Yc(Yc({},b),T);return Ce.createElement(_i,jb({className:"recharts-scatter-symbol",key:"symbol-".concat(T==null?void 0:T.cx,"-").concat(T==null?void 0:T.cy,"-").concat(T==null?void 0:T.size,"-").concat(A)},dm(a.props,T,A),{role:"img"}),Ce.createElement(gWe,jb({option:R,isActive:k,key:"symbol-".concat(A)},B)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,a=this.props,c=a.points,d=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,b=a.animationEasing,T=a.animationId,A=this.state.prevPoints;return Ce.createElement(uu,{begin:i,duration:_,isActive:d,easing:b,from:{t:0},to:{t:1},key:"pie-".concat(T),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var R=k.t,B=c.map(function(N,V){var H=A&&A[V];if(H){var G=ca(H.cx,N.cx),q=ca(H.cy,N.cy),Q=ca(H.size,N.size);return Yc(Yc({},N),{},{cx:G(R),cy:q(R),size:Q(R)})}var te=ca(0,N.size);return Yc(Yc({},N),{},{size:te(R)})});return Ce.createElement(_i,null,r.renderSymbolsStatically(B))})}},{key:"renderSymbols",value:function(){var r=this.props,a=r.points,c=r.isAnimationActive,d=this.state.prevPoints;return c&&a&&a.length&&(!d||!pm(d,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var a=this.props,c=a.points,d=a.xAxis,i=a.yAxis,_=a.children,b=bl(_,ox);return b?b.map(function(T,A){var k=T.props,R=k.direction,B=k.dataKey;return Ce.cloneElement(T,{key:"".concat(R,"-").concat(B,"-").concat(c[A]),data:c,xAxis:d,yAxis:i,layout:R==="x"?"vertical":"horizontal",dataPointFormatter:function(V,H){return{x:V.cx,y:V.cy,value:R==="x"?+V.node.x:+V.node.y,errorVal:Zo(V,H)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,a=r.points,c=r.line,d=r.lineType,i=r.lineJointType,_=wr(this.props,!1),b=wr(c,!1),T,A;if(d==="joint")T=a.map(function(q){return{x:q.cx,y:q.cy}});else if(d==="fitting"){var k=o2e(a),R=k.xmin,B=k.xmax,N=k.a,V=k.b,H=function(Q){return N*Q+V};T=[{x:R,y:H(R)},{x:B,y:H(B)}]}var G=Yc(Yc(Yc({},_),{},{fill:"none",stroke:_&&_.fill},b),{},{points:T});return Ce.isValidElement(c)?A=Ce.cloneElement(c,G):$r(c)?A=c(G):A=Ce.createElement(em,jb({},G,{type:i})),Ce.createElement(_i,{className:"recharts-scatter-line",key:"recharts-scatter-line"},A)}},{key:"render",value:function(){var r=this.props,a=r.hide,c=r.points,d=r.line,i=r.className,_=r.xAxis,b=r.yAxis,T=r.left,A=r.top,k=r.width,R=r.height,B=r.id,N=r.isAnimationActive;if(a||!c||!c.length)return null;var V=this.state.isAnimationFinished,H=li("recharts-scatter",i),G=_&&_.allowDataOverflow,q=b&&b.allowDataOverflow,Q=G||q,te=Nr(B)?this.id:B;return Ce.createElement(_i,{className:H,clipPath:Q?"url(#clipPath-".concat(te,")"):null},G||q?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(te)},Ce.createElement("rect",{x:G?T:T-k/2,y:q?A:A-R/2,width:G?k:k*2,height:q?R:R*2}))):null,d&&this.renderLine(),this.renderErrorBar(),Ce.createElement(_i,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!N||V)&&ih.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}}])}(X.PureComponent);jp(FI,"displayName","Scatter");jp(FI,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!au.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});jp(FI,"getComposedData",function(e){var t=e.xAxis,n=e.yAxis,r=e.zAxis,a=e.item,c=e.displayedData,d=e.xAxisTicks,i=e.yAxisTicks,_=e.offset,b=a.props.tooltipType,T=bl(a.props.children,fI),A=Nr(t.dataKey)?a.props.dataKey:t.dataKey,k=Nr(n.dataKey)?a.props.dataKey:n.dataKey,R=r&&r.dataKey,B=r?r.range:NI.defaultProps.range,N=B&&B[0],V=t.scale.bandwidth?t.scale.bandwidth():0,H=n.scale.bandwidth?n.scale.bandwidth():0,G=c.map(function(q,Q){var te=Zo(q,A),ue=Zo(q,k),fe=!Nr(R)&&Zo(q,R)||"-",ye=[{name:Nr(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:te,payload:q,dataKey:A,type:b},{name:Nr(n.dataKey)?a.props.name:n.name||n.dataKey,unit:n.unit||"",value:ue,payload:q,dataKey:k,type:b}];fe!=="-"&&ye.push({name:r.name||r.dataKey,unit:r.unit||"",value:fe,payload:q,dataKey:R,type:b});var De=c0({axis:t,ticks:d,bandSize:V,entry:q,index:Q,dataKey:A}),Ne=c0({axis:n,ticks:i,bandSize:H,entry:q,index:Q,dataKey:k}),Fe=fe!=="-"?r.scale(fe):N,Le=Math.sqrt(Math.max(Fe,0)/Math.PI);return Yc(Yc({},q),{},{cx:De,cy:Ne,x:De-Le,y:Ne-Le,xAxis:t,yAxis:n,zAxis:r,width:2*Le,height:2*Le,size:Fe,node:{x:te,y:ue,z:fe},tooltipPayload:ye,tooltipPosition:{x:De,y:Ne},payload:q},T&&T[Q]&&T[Q].props)});return Yc({points:G},_)});function E0(e){"@babel/helpers - typeof";return E0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E0(e)}function TWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EWe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sne(r.key),r)}}function AWe(e,t,n){return t&&EWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PWe(e,t,n){return t=FP(t),CWe(e,one()?Reflect.construct(t,n||[],FP(e).constructor):t.apply(e,n))}function CWe(e,t){if(t&&(E0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IWe(e)}function IWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function one(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(one=function(){return!!e})()}function FP(e){return FP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},FP(e)}function MWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iz(e,t)}function Iz(e,t){return Iz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Iz(e,t)}function ane(e,t,n){return t=sne(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sne(e){var t=OWe(e,"string");return E0(t)=="symbol"?t:t+""}function OWe(e,t){if(E0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(E0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mz(){return Mz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mz.apply(this,arguments)}function kWe(e){var t=e.xAxisId,n=rB(),r=iB(),a=zte(t);return a==null?null:Ce.createElement(lx,Mz({},a,{className:li("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(d){return of(d,!0)}}))}var cx=function(e){function t(){return TWe(this,t),PWe(this,t,arguments)}return MWe(t,e),AWe(t,[{key:"render",value:function(){return Ce.createElement(kWe,this.props)}}])}(Ce.Component);ane(cx,"displayName","XAxis");ane(cx,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function A0(e){"@babel/helpers - typeof";return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A0(e)}function RWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DWe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,une(r.key),r)}}function LWe(e,t,n){return t&&DWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zWe(e,t,n){return t=BP(t),NWe(e,lne()?Reflect.construct(t,n||[],BP(e).constructor):t.apply(e,n))}function NWe(e,t){if(t&&(A0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FWe(e)}function FWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lne=function(){return!!e})()}function BP(e){return BP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},BP(e)}function BWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oz(e,t)}function Oz(e,t){return Oz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Oz(e,t)}function cne(e,t,n){return t=une(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function une(e){var t=jWe(e,"string");return A0(t)=="symbol"?t:t+""}function jWe(e,t){if(A0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(A0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kz(){return kz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kz.apply(this,arguments)}var $We=function(t){var n=t.yAxisId,r=rB(),a=iB(),c=Nte(n);return c==null?null:Ce.createElement(lx,kz({},c,{className:li("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:r,height:a},ticksGenerator:function(i){return of(i,!0)}}))},ux=function(e){function t(){return RWe(this,t),zWe(this,t,arguments)}return BWe(t,e),LWe(t,[{key:"render",value:function(){return Ce.createElement($We,this.props)}}])}(Ce.Component);cne(ux,"displayName","YAxis");cne(ux,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function vH(e){return GWe(e)||WWe(e)||VWe(e)||UWe()}function UWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VWe(e,t){if(e){if(typeof e=="string")return Rz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rz(e,t)}}function WWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GWe(e){if(Array.isArray(e))return Rz(e)}function Rz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dz=function(t,n,r,a,c){var d=bl(t,aB),i=bl(t,RI),_=[].concat(vH(d),vH(i)),b=bl(t,LI),T="".concat(a,"Id"),A=a[0],k=n;if(_.length&&(k=_.reduce(function(N,V){if(V.props[T]===r&&Qh(V.props,"extendDomain")&&zn(V.props[A])){var H=V.props[A];return[Math.min(N[0],H),Math.max(N[1],H)]}return N},k)),b.length){var R="".concat(A,"1"),B="".concat(A,"2");k=b.reduce(function(N,V){if(V.props[T]===r&&Qh(V.props,"extendDomain")&&zn(V.props[R])&&zn(V.props[B])){var H=V.props[R],G=V.props[B];return[Math.min(N[0],H,G),Math.max(N[1],H,G)]}return N},k)}return c&&c.length&&(k=c.reduce(function(N,V){return zn(V)?[Math.min(N[0],V),Math.max(N[1],V)]:N},k)),k},hne={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(_,b,T){this.fn=_,this.context=b,this.once=T||!1}function c(_,b,T,A,k){if(typeof T!="function")throw new TypeError("The listener must be a function");var R=new a(T,A||_,k),B=n?n+b:b;return _._events[B]?_._events[B].fn?_._events[B]=[_._events[B],R]:_._events[B].push(R):(_._events[B]=R,_._eventsCount++),_}function d(_,b){--_._eventsCount===0?_._events=new r:delete _._events[b]}function i(){this._events=new r,this._eventsCount=0}i.prototype.eventNames=function(){var b=[],T,A;if(this._eventsCount===0)return b;for(A in T=this._events)t.call(T,A)&&b.push(n?A.slice(1):A);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(T)):b},i.prototype.listeners=function(b){var T=n?n+b:b,A=this._events[T];if(!A)return[];if(A.fn)return[A.fn];for(var k=0,R=A.length,B=new Array(R);k<R;k++)B[k]=A[k].fn;return B},i.prototype.listenerCount=function(b){var T=n?n+b:b,A=this._events[T];return A?A.fn?1:A.length:0},i.prototype.emit=function(b,T,A,k,R,B){var N=n?n+b:b;if(!this._events[N])return!1;var V=this._events[N],H=arguments.length,G,q;if(V.fn){switch(V.once&&this.removeListener(b,V.fn,void 0,!0),H){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,T),!0;case 3:return V.fn.call(V.context,T,A),!0;case 4:return V.fn.call(V.context,T,A,k),!0;case 5:return V.fn.call(V.context,T,A,k,R),!0;case 6:return V.fn.call(V.context,T,A,k,R,B),!0}for(q=1,G=new Array(H-1);q<H;q++)G[q-1]=arguments[q];V.fn.apply(V.context,G)}else{var Q=V.length,te;for(q=0;q<Q;q++)switch(V[q].once&&this.removeListener(b,V[q].fn,void 0,!0),H){case 1:V[q].fn.call(V[q].context);break;case 2:V[q].fn.call(V[q].context,T);break;case 3:V[q].fn.call(V[q].context,T,A);break;case 4:V[q].fn.call(V[q].context,T,A,k);break;default:if(!G)for(te=1,G=new Array(H-1);te<H;te++)G[te-1]=arguments[te];V[q].fn.apply(V[q].context,G)}}return!0},i.prototype.on=function(b,T,A){return c(this,b,T,A,!1)},i.prototype.once=function(b,T,A){return c(this,b,T,A,!0)},i.prototype.removeListener=function(b,T,A,k){var R=n?n+b:b;if(!this._events[R])return this;if(!T)return d(this,R),this;var B=this._events[R];if(B.fn)B.fn===T&&(!k||B.once)&&(!A||B.context===A)&&d(this,R);else{for(var N=0,V=[],H=B.length;N<H;N++)(B[N].fn!==T||k&&!B[N].once||A&&B[N].context!==A)&&V.push(B[N]);V.length?this._events[R]=V.length===1?V[0]:V:d(this,R)}return this},i.prototype.removeAllListeners=function(b){var T;return b?(T=n?n+b:b,this._events[T]&&d(this,T)):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,e.exports=i})(hne);var HWe=hne.exports;const qWe=lo(HWe);var _R=new qWe,yR="recharts.syncMouseEvents";function oS(e){"@babel/helpers - typeof";return oS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oS(e)}function ZWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XWe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dne(r.key),r)}}function KWe(e,t,n){return t&&XWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vR(e,t,n){return t=dne(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dne(e){var t=YWe(e,"string");return oS(t)=="symbol"?t:t+""}function YWe(e,t){if(oS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(oS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var JWe=function(){function e(){ZWe(this,e),vR(this,"activeIndex",0),vR(this,"coordinateList",[]),vR(this,"layout","horizontal")}return KWe(e,[{key:"setDetails",value:function(n){var r,a=n.coordinateList,c=a===void 0?null:a,d=n.container,i=d===void 0?null:d,_=n.layout,b=_===void 0?null:_,T=n.offset,A=T===void 0?null:T,k=n.mouseHandlerCallback,R=k===void 0?null:k;this.coordinateList=(r=c??this.coordinateList)!==null&&r!==void 0?r:[],this.container=i??this.container,this.layout=b??this.layout,this.offset=A??this.offset,this.mouseHandlerCallback=R??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),c=a.x,d=a.y,i=a.height,_=this.coordinateList[this.activeIndex].coordinate,b=((n=window)===null||n===void 0?void 0:n.scrollX)||0,T=((r=window)===null||r===void 0?void 0:r.scrollY)||0,A=c+_+b,k=d+this.offset.top+i/2+T;this.mouseHandlerCallback({pageX:A,pageY:k})}}}])}();function QWe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&zn(r)&&zn(a))return!0}return!1}function eGe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function fne(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,c=e.endAngle,d=No(t,n,r,a),i=No(t,n,r,c);return{points:[d,i],cx:t,cy:n,radius:r,startAngle:a,endAngle:c}}function tGe(e,t,n){var r,a,c,d;if(e==="horizontal")r=t.x,c=r,a=n.top,d=n.top+n.height;else if(e==="vertical")a=t.y,d=a,r=n.left,c=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,_=t.cy,b=t.innerRadius,T=t.outerRadius,A=t.angle,k=No(i,_,b,A),R=No(i,_,T,A);r=k.x,a=k.y,c=R.x,d=R.y}else return fne(t);return[{x:r,y:a},{x:c,y:d}]}function aS(e){"@babel/helpers - typeof";return aS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aS(e)}function xH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function p2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xH(Object(n),!0).forEach(function(r){nGe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nGe(e,t,n){return t=rGe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rGe(e){var t=iGe(e,"string");return aS(t)=="symbol"?t:t+""}function iGe(e,t){if(aS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(aS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oGe(e){var t,n,r=e.element,a=e.tooltipEventType,c=e.isActive,d=e.activeCoordinate,i=e.activePayload,_=e.offset,b=e.activeTooltipIndex,T=e.tooltipAxisBandSize,A=e.layout,k=e.chartName,R=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!R||!c||!d||k!=="ScatterChart"&&a!=="axis")return null;var B,N=em;if(k==="ScatterChart")B=d,N=q5e;else if(k==="BarChart")B=eGe(A,d,_,T),N=QF;else if(A==="radial"){var V=fne(d),H=V.cx,G=V.cy,q=V.radius,Q=V.startAngle,te=V.endAngle;B={cx:H,cy:G,startAngle:Q,endAngle:te,innerRadius:q,outerRadius:q},N=tte}else B={points:tGe(A,d,_)},N=em;var ue=p2(p2(p2(p2({stroke:"#ccc",pointerEvents:"none"},_),B),wr(R,!1)),{},{payload:i,payloadIndex:b,className:li("recharts-tooltip-cursor",R.className)});return X.isValidElement(R)?X.cloneElement(R,ue):X.createElement(N,ue)}var aGe=["item"],sGe=["children","className","width","height","style","compact","title","desc"];function P0(e){"@babel/helpers - typeof";return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P0(e)}function $b(){return $b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$b.apply(this,arguments)}function bH(e,t){return uGe(e)||cGe(e,t)||mne(e,t)||lGe()}function lGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cGe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,d,i=[],_=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(_=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);_=!0);}catch(T){b=!0,a=T}finally{try{if(!_&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(b)throw a}}return i}}function uGe(e){if(Array.isArray(e))return e}function wH(e,t){if(e==null)return{};var n=hGe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hGe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function dGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fGe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gne(r.key),r)}}function pGe(e,t,n){return t&&fGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mGe(e,t,n){return t=jP(t),gGe(e,pne()?Reflect.construct(t,n||[],jP(e).constructor):t.apply(e,n))}function gGe(e,t){if(t&&(P0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ge(e)}function _Ge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pne=function(){return!!e})()}function jP(e){return jP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},jP(e)}function yGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lz(e,t)}function Lz(e,t){return Lz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Lz(e,t)}function C0(e){return bGe(e)||xGe(e)||mne(e)||vGe()}function vGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mne(e,t){if(e){if(typeof e=="string")return zz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zz(e,t)}}function xGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bGe(e){if(Array.isArray(e))return zz(e)}function zz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(n),!0).forEach(function(r){Hr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hr(e,t,n){return t=gne(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gne(e){var t=wGe(e,"string");return P0(t)=="symbol"?t:t+""}function wGe(e,t){if(P0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(P0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SGe={xAxis:["bottom","top"],yAxis:["left","right"]},TGe={width:"100%",height:"100%"},_ne={x:0,y:0};function m2(e){return e}var EGe=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},AGe=function(t,n,r,a){var c=n.find(function(T){return T&&T.index===r});if(c){if(t==="horizontal")return{x:c.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:c.coordinate};if(t==="centric"){var d=c.coordinate,i=a.radius;return on(on(on({},a),No(a.cx,a.cy,i,d)),{},{angle:d,radius:i})}var _=c.coordinate,b=a.angle;return on(on(on({},a),No(a.cx,a.cy,_,b)),{},{angle:b,radius:_})}return _ne},BI=function(t,n){var r=n.graphicalItems,a=n.dataStartIndex,c=n.dataEndIndex,d=(r??[]).reduce(function(i,_){var b=_.props.data;return b&&b.length?[].concat(C0(i),C0(b)):i},[]);return d.length>0?d:t&&t.length&&zn(a)&&zn(c)?t.slice(a,c+1):[]};function yne(e){return e==="number"?[0,"auto"]:void 0}var Nz=function(t,n,r,a){var c=t.graphicalItems,d=t.tooltipAxis,i=BI(n,t);return r<0||!c||!c.length||r>=i.length?null:c.reduce(function(_,b){var T,A=(T=b.props.data)!==null&&T!==void 0?T:n;A&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=r&&(A=A.slice(t.dataStartIndex,t.dataEndIndex+1));var k;if(d.dataKey&&!d.allowDuplicatedCategory){var R=A===void 0?i:A;k=FA(R,d.dataKey,a)}else k=A&&A[r]||i[r];return k?[].concat(C0(_),[Xee(b,k)]):_},[])},TH=function(t,n,r,a){var c=a||{x:t.chartX,y:t.chartY},d=EGe(c,r),i=t.orderedTooltipTicks,_=t.tooltipAxis,b=t.tooltipTicks,T=PBe(d,i,b,_);if(T>=0&&b){var A=b[T]&&b[T].value,k=Nz(t,n,T,A),R=AGe(r,i,T,c);return{activeTooltipIndex:T,activeLabel:A,activePayload:k,activeCoordinate:R}}return null},PGe=function(t,n){var r=n.axes,a=n.graphicalItems,c=n.axisType,d=n.axisIdKey,i=n.stackGroups,_=n.dataStartIndex,b=n.dataEndIndex,T=t.layout,A=t.children,k=t.stackOffset,R=Vee(T,c);return r.reduce(function(B,N){var V,H=N.type.defaultProps!==void 0?on(on({},N.type.defaultProps),N.props):N.props,G=H.type,q=H.dataKey,Q=H.allowDataOverflow,te=H.allowDuplicatedCategory,ue=H.scale,fe=H.ticks,ye=H.includeHidden,De=H[d];if(B[De])return B;var Ne=BI(t.data,{graphicalItems:a.filter(function(Nt){var rn,un=d in Nt.props?Nt.props[d]:(rn=Nt.type.defaultProps)===null||rn===void 0?void 0:rn[d];return un===De}),dataStartIndex:_,dataEndIndex:b}),Fe=Ne.length,Le,Ze,He;QWe(H.domain,Q,G)&&(Le=ZL(H.domain,null,Q),R&&(G==="number"||ue!=="auto")&&(He=Db(Ne,q,"category")));var ct=yne(G);if(!Le||Le.length===0){var ot,rt=(ot=H.domain)!==null&&ot!==void 0?ot:ct;if(q){if(Le=Db(Ne,q,G),G==="category"&&R){var Be=i2e(Le);te&&Be?(Ze=Le,Le=TP(0,Fe)):te||(Le=UW(rt,Le,N).reduce(function(Nt,rn){return Nt.indexOf(rn)>=0?Nt:[].concat(C0(Nt),[rn])},[]))}else if(G==="category")te?Le=Le.filter(function(Nt){return Nt!==""&&!Nr(Nt)}):Le=UW(rt,Le,N).reduce(function(Nt,rn){return Nt.indexOf(rn)>=0||rn===""||Nr(rn)?Nt:[].concat(C0(Nt),[rn])},[]);else if(G==="number"){var nt=kBe(Ne,a.filter(function(Nt){var rn,un,en=d in Nt.props?Nt.props[d]:(rn=Nt.type.defaultProps)===null||rn===void 0?void 0:rn[d],sn="hide"in Nt.props?Nt.props.hide:(un=Nt.type.defaultProps)===null||un===void 0?void 0:un.hide;return en===De&&(ye||!sn)}),q,c,T);nt&&(Le=nt)}R&&(G==="number"||ue!=="auto")&&(He=Db(Ne,q,"category"))}else R?Le=TP(0,Fe):i&&i[De]&&i[De].hasStack&&G==="number"?Le=k==="expand"?[0,1]:Zee(i[De].stackGroups,_,b):Le=Uee(Ne,a.filter(function(Nt){var rn=d in Nt.props?Nt.props[d]:Nt.type.defaultProps[d],un="hide"in Nt.props?Nt.props.hide:Nt.type.defaultProps.hide;return rn===De&&(ye||!un)}),G,T,!0);if(G==="number")Le=Dz(A,Le,De,c,fe),rt&&(Le=ZL(rt,Le,Q));else if(G==="category"&&rt){var at=rt,Mt=Le.every(function(Nt){return at.indexOf(Nt)>=0});Mt&&(Le=at)}}return on(on({},B),{},Hr({},De,on(on({},H),{},{axisType:c,domain:Le,categoricalDomain:He,duplicateDomain:Ze,originalDomain:(V=H.domain)!==null&&V!==void 0?V:ct,isCategorical:R,layout:T})))},{})},CGe=function(t,n){var r=n.graphicalItems,a=n.Axis,c=n.axisType,d=n.axisIdKey,i=n.stackGroups,_=n.dataStartIndex,b=n.dataEndIndex,T=t.layout,A=t.children,k=BI(t.data,{graphicalItems:r,dataStartIndex:_,dataEndIndex:b}),R=k.length,B=Vee(T,c),N=-1;return r.reduce(function(V,H){var G=H.type.defaultProps!==void 0?on(on({},H.type.defaultProps),H.props):H.props,q=G[d],Q=yne("number");if(!V[q]){N++;var te;return B?te=TP(0,R):i&&i[q]&&i[q].hasStack?(te=Zee(i[q].stackGroups,_,b),te=Dz(A,te,q,c)):(te=ZL(Q,Uee(k,r.filter(function(ue){var fe,ye,De=d in ue.props?ue.props[d]:(fe=ue.type.defaultProps)===null||fe===void 0?void 0:fe[d],Ne="hide"in ue.props?ue.props.hide:(ye=ue.type.defaultProps)===null||ye===void 0?void 0:ye.hide;return De===q&&!Ne}),"number",T),a.defaultProps.allowDataOverflow),te=Dz(A,te,q,c)),on(on({},V),{},Hr({},q,on(on({axisType:c},a.defaultProps),{},{hide:!0,orientation:Rc(SGe,"".concat(c,".").concat(N%2),null),domain:te,originalDomain:Q,isCategorical:B,layout:T})))}return V},{})},IGe=function(t,n){var r=n.axisType,a=r===void 0?"xAxis":r,c=n.AxisComp,d=n.graphicalItems,i=n.stackGroups,_=n.dataStartIndex,b=n.dataEndIndex,T=t.children,A="".concat(a,"Id"),k=bl(T,c),R={};return k&&k.length?R=PGe(t,{axes:k,graphicalItems:d,axisType:a,axisIdKey:A,stackGroups:i,dataStartIndex:_,dataEndIndex:b}):d&&d.length&&(R=CGe(t,{Axis:c,graphicalItems:d,axisType:a,axisIdKey:A,stackGroups:i,dataStartIndex:_,dataEndIndex:b})),R},MGe=function(t){var n=Dp(t),r=of(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:AF(r,function(a){return a.coordinate}),tooltipAxis:n,tooltipAxisBandSize:hP(n,r)}},EH=function(t){var n=t.children,r=t.defaultShowTooltip,a=Ac(n,m0),c=0,d=0;return t.data&&t.data.length!==0&&(d=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(c=a.props.startIndex),a.props.endIndex>=0&&(d=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:c,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!r}},OGe=function(t){return!t||!t.length?!1:t.some(function(n){var r=sf(n&&n.type);return r&&r.indexOf("Bar")>=0})},AH=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},kGe=function(t,n){var r=t.props,a=t.graphicalItems,c=t.xAxisMap,d=c===void 0?{}:c,i=t.yAxisMap,_=i===void 0?{}:i,b=r.width,T=r.height,A=r.children,k=r.margin||{},R=Ac(A,m0),B=Ac(A,Ov),N=Object.keys(_).reduce(function(te,ue){var fe=_[ue],ye=fe.orientation;return!fe.mirror&&!fe.hide?on(on({},te),{},Hr({},ye,te[ye]+fe.width)):te},{left:k.left||0,right:k.right||0}),V=Object.keys(d).reduce(function(te,ue){var fe=d[ue],ye=fe.orientation;return!fe.mirror&&!fe.hide?on(on({},te),{},Hr({},ye,Rc(te,"".concat(ye))+fe.height)):te},{top:k.top||0,bottom:k.bottom||0}),H=on(on({},V),N),G=H.bottom;R&&(H.bottom+=R.props.height||m0.defaultProps.height),B&&n&&(H=MBe(H,a,r,n));var q=b-H.left-H.right,Q=T-H.top-H.bottom;return on(on({brushBottom:G},H),{},{width:Math.max(q,0),height:Math.max(Q,0)})},RGe=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},WS=function(t){var n=t.chartName,r=t.GraphicalChild,a=t.defaultTooltipEventType,c=a===void 0?"axis":a,d=t.validateTooltipEventTypes,i=d===void 0?["axis"]:d,_=t.axisComponents,b=t.legendContent,T=t.formatAxisMap,A=t.defaultProps,k=function(V,H){var G=H.graphicalItems,q=H.stackGroups,Q=H.offset,te=H.updateId,ue=H.dataStartIndex,fe=H.dataEndIndex,ye=V.barSize,De=V.layout,Ne=V.barGap,Fe=V.barCategoryGap,Le=V.maxBarSize,Ze=AH(De),He=Ze.numericAxisName,ct=Ze.cateAxisName,ot=OGe(G),rt=[];return G.forEach(function(Be,nt){var at=BI(V.data,{graphicalItems:[Be],dataStartIndex:ue,dataEndIndex:fe}),Mt=Be.type.defaultProps!==void 0?on(on({},Be.type.defaultProps),Be.props):Be.props,Nt=Mt.dataKey,rn=Mt.maxBarSize,un=Mt["".concat(He,"Id")],en=Mt["".concat(ct,"Id")],sn={},Vt=_.reduce(function(jt,Cn){var Mn=H["".concat(Cn.axisType,"Map")],_n=Mt["".concat(Cn.axisType,"Id")];Mn&&Mn[_n]||Cn.axisType==="zAxis"||f_();var Gn=Mn[_n];return on(on({},jt),{},Hr(Hr({},Cn.axisType,Gn),"".concat(Cn.axisType,"Ticks"),of(Gn)))},sn),$n=Vt[ct],Gt=Vt["".concat(ct,"Ticks")],Tn=q&&q[un]&&q[un].hasStack&&$Be(Be,q[un].stackGroups),hn=sf(Be.type).indexOf("Bar")>=0,yt=hP($n,Gt),In=[],Kn=ot&&CBe({barSize:ye,stackGroups:q,totalSize:RGe(Vt,ct)});if(hn){var Ar,_r,Vr=Nr(rn)?Le:rn,it=(Ar=(_r=hP($n,Gt,!0))!==null&&_r!==void 0?_r:Vr)!==null&&Ar!==void 0?Ar:0;In=IBe({barGap:Ne,barCategoryGap:Fe,bandSize:it!==yt?it:yt,sizeList:Kn[en],maxBarSize:Vr}),it!==yt&&(In=In.map(function(jt){return on(on({},jt),{},{position:on(on({},jt.position),{},{offset:jt.position.offset-it/2})})}))}var Pt=Be&&Be.type&&Be.type.getComposedData;Pt&&rt.push({props:on(on({},Pt(on(on({},Vt),{},{displayedData:at,props:V,dataKey:Nt,item:Be,bandSize:yt,barPosition:In,offset:Q,stackedData:Tn,layout:De,dataStartIndex:ue,dataEndIndex:fe}))),{},Hr(Hr(Hr({key:Be.key||"item-".concat(nt)},He,Vt[He]),ct,Vt[ct]),"animationId",te)),childIndex:g2e(Be,V.children),item:Be})}),rt},R=function(V,H){var G=V.props,q=V.dataStartIndex,Q=V.dataEndIndex,te=V.updateId;if(!D6({props:G}))return null;var ue=G.children,fe=G.layout,ye=G.stackOffset,De=G.data,Ne=G.reverseStackOrder,Fe=AH(fe),Le=Fe.numericAxisName,Ze=Fe.cateAxisName,He=bl(ue,r),ct=BBe(De,He,"".concat(Le,"Id"),"".concat(Ze,"Id"),ye,Ne),ot=_.reduce(function(Mt,Nt){var rn="".concat(Nt.axisType,"Map");return on(on({},Mt),{},Hr({},rn,IGe(G,on(on({},Nt),{},{graphicalItems:He,stackGroups:Nt.axisType===Le&&ct,dataStartIndex:q,dataEndIndex:Q}))))},{}),rt=kGe(on(on({},ot),{},{props:G,graphicalItems:He}),H==null?void 0:H.legendBBox);Object.keys(ot).forEach(function(Mt){ot[Mt]=T(G,ot[Mt],rt,Mt.replace("Map",""),n)});var Be=ot["".concat(Ze,"Map")],nt=MGe(Be),at=k(G,on(on({},ot),{},{dataStartIndex:q,dataEndIndex:Q,updateId:te,graphicalItems:He,stackGroups:ct,offset:rt}));return on(on({formattedGraphicalItems:at,graphicalItems:He,offset:rt,stackGroups:ct},nt),ot)},B=function(N){function V(H){var G,q,Q;return dGe(this,V),Q=mGe(this,V,[H]),Hr(Q,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Hr(Q,"accessibilityManager",new JWe),Hr(Q,"handleLegendBBoxUpdate",function(te){if(te){var ue=Q.state,fe=ue.dataStartIndex,ye=ue.dataEndIndex,De=ue.updateId;Q.setState(on({legendBBox:te},R({props:Q.props,dataStartIndex:fe,dataEndIndex:ye,updateId:De},on(on({},Q.state),{},{legendBBox:te}))))}}),Hr(Q,"handleReceiveSyncEvent",function(te,ue,fe){if(Q.props.syncId===te){if(fe===Q.eventEmitterSymbol&&typeof Q.props.syncMethod!="function")return;Q.applySyncEvent(ue)}}),Hr(Q,"handleBrushChange",function(te){var ue=te.startIndex,fe=te.endIndex;if(ue!==Q.state.dataStartIndex||fe!==Q.state.dataEndIndex){var ye=Q.state.updateId;Q.setState(function(){return on({dataStartIndex:ue,dataEndIndex:fe},R({props:Q.props,dataStartIndex:ue,dataEndIndex:fe,updateId:ye},Q.state))}),Q.triggerSyncEvent({dataStartIndex:ue,dataEndIndex:fe})}}),Hr(Q,"handleMouseEnter",function(te){var ue=Q.getMouseInfo(te);if(ue){var fe=on(on({},ue),{},{isTooltipActive:!0});Q.setState(fe),Q.triggerSyncEvent(fe);var ye=Q.props.onMouseEnter;$r(ye)&&ye(fe,te)}}),Hr(Q,"triggeredAfterMouseMove",function(te){var ue=Q.getMouseInfo(te),fe=ue?on(on({},ue),{},{isTooltipActive:!0}):{isTooltipActive:!1};Q.setState(fe),Q.triggerSyncEvent(fe);var ye=Q.props.onMouseMove;$r(ye)&&ye(fe,te)}),Hr(Q,"handleItemMouseEnter",function(te){Q.setState(function(){return{isTooltipActive:!0,activeItem:te,activePayload:te.tooltipPayload,activeCoordinate:te.tooltipPosition||{x:te.cx,y:te.cy}}})}),Hr(Q,"handleItemMouseLeave",function(){Q.setState(function(){return{isTooltipActive:!1}})}),Hr(Q,"handleMouseMove",function(te){te.persist(),Q.throttleTriggeredAfterMouseMove(te)}),Hr(Q,"handleMouseLeave",function(te){Q.throttleTriggeredAfterMouseMove.cancel();var ue={isTooltipActive:!1};Q.setState(ue),Q.triggerSyncEvent(ue);var fe=Q.props.onMouseLeave;$r(fe)&&fe(ue,te)}),Hr(Q,"handleOuterEvent",function(te){var ue=m2e(te),fe=Rc(Q.props,"".concat(ue));if(ue&&$r(fe)){var ye,De;/.*touch.*/i.test(ue)?De=Q.getMouseInfo(te.changedTouches[0]):De=Q.getMouseInfo(te),fe((ye=De)!==null&&ye!==void 0?ye:{},te)}}),Hr(Q,"handleClick",function(te){var ue=Q.getMouseInfo(te);if(ue){var fe=on(on({},ue),{},{isTooltipActive:!0});Q.setState(fe),Q.triggerSyncEvent(fe);var ye=Q.props.onClick;$r(ye)&&ye(fe,te)}}),Hr(Q,"handleMouseDown",function(te){var ue=Q.props.onMouseDown;if($r(ue)){var fe=Q.getMouseInfo(te);ue(fe,te)}}),Hr(Q,"handleMouseUp",function(te){var ue=Q.props.onMouseUp;if($r(ue)){var fe=Q.getMouseInfo(te);ue(fe,te)}}),Hr(Q,"handleTouchMove",function(te){te.changedTouches!=null&&te.changedTouches.length>0&&Q.throttleTriggeredAfterMouseMove(te.changedTouches[0])}),Hr(Q,"handleTouchStart",function(te){te.changedTouches!=null&&te.changedTouches.length>0&&Q.handleMouseDown(te.changedTouches[0])}),Hr(Q,"handleTouchEnd",function(te){te.changedTouches!=null&&te.changedTouches.length>0&&Q.handleMouseUp(te.changedTouches[0])}),Hr(Q,"triggerSyncEvent",function(te){Q.props.syncId!==void 0&&_R.emit(yR,Q.props.syncId,te,Q.eventEmitterSymbol)}),Hr(Q,"applySyncEvent",function(te){var ue=Q.props,fe=ue.layout,ye=ue.syncMethod,De=Q.state.updateId,Ne=te.dataStartIndex,Fe=te.dataEndIndex;if(te.dataStartIndex!==void 0||te.dataEndIndex!==void 0)Q.setState(on({dataStartIndex:Ne,dataEndIndex:Fe},R({props:Q.props,dataStartIndex:Ne,dataEndIndex:Fe,updateId:De},Q.state)));else if(te.activeTooltipIndex!==void 0){var Le=te.chartX,Ze=te.chartY,He=te.activeTooltipIndex,ct=Q.state,ot=ct.offset,rt=ct.tooltipTicks;if(!ot)return;if(typeof ye=="function")He=ye(rt,te);else if(ye==="value"){He=-1;for(var Be=0;Be<rt.length;Be++)if(rt[Be].value===te.activeLabel){He=Be;break}}var nt=on(on({},ot),{},{x:ot.left,y:ot.top}),at=Math.min(Le,nt.x+nt.width),Mt=Math.min(Ze,nt.y+nt.height),Nt=rt[He]&&rt[He].value,rn=Nz(Q.state,Q.props.data,He),un=rt[He]?{x:fe==="horizontal"?rt[He].coordinate:at,y:fe==="horizontal"?Mt:rt[He].coordinate}:_ne;Q.setState(on(on({},te),{},{activeLabel:Nt,activeCoordinate:un,activePayload:rn,activeTooltipIndex:He}))}else Q.setState(te)}),Hr(Q,"renderCursor",function(te){var ue,fe=Q.state,ye=fe.isTooltipActive,De=fe.activeCoordinate,Ne=fe.activePayload,Fe=fe.offset,Le=fe.activeTooltipIndex,Ze=fe.tooltipAxisBandSize,He=Q.getTooltipEventType(),ct=(ue=te.props.active)!==null&&ue!==void 0?ue:ye,ot=Q.props.layout,rt=te.key||"_recharts-cursor";return Ce.createElement(oGe,{key:rt,activeCoordinate:De,activePayload:Ne,activeTooltipIndex:Le,chartName:n,element:te,isActive:ct,layout:ot,offset:Fe,tooltipAxisBandSize:Ze,tooltipEventType:He})}),Hr(Q,"renderPolarAxis",function(te,ue,fe){var ye=Rc(te,"type.axisType"),De=Rc(Q.state,"".concat(ye,"Map")),Ne=te.type.defaultProps,Fe=Ne!==void 0?on(on({},Ne),te.props):te.props,Le=De&&De[Fe["".concat(ye,"Id")]];return X.cloneElement(te,on(on({},Le),{},{className:li(ye,Le.className),key:te.key||"".concat(ue,"-").concat(fe),ticks:of(Le,!0)}))}),Hr(Q,"renderPolarGrid",function(te){var ue=te.props,fe=ue.radialLines,ye=ue.polarAngles,De=ue.polarRadius,Ne=Q.state,Fe=Ne.radiusAxisMap,Le=Ne.angleAxisMap,Ze=Dp(Fe),He=Dp(Le),ct=He.cx,ot=He.cy,rt=He.innerRadius,Be=He.outerRadius;return X.cloneElement(te,{polarAngles:Array.isArray(ye)?ye:of(He,!0).map(function(nt){return nt.coordinate}),polarRadius:Array.isArray(De)?De:of(Ze,!0).map(function(nt){return nt.coordinate}),cx:ct,cy:ot,innerRadius:rt,outerRadius:Be,key:te.key||"polar-grid",radialLines:fe})}),Hr(Q,"renderLegend",function(){var te=Q.state.formattedGraphicalItems,ue=Q.props,fe=ue.children,ye=ue.width,De=ue.height,Ne=Q.props.margin||{},Fe=ye-(Ne.left||0)-(Ne.right||0),Le=jee({children:fe,formattedGraphicalItems:te,legendWidth:Fe,legendContent:b});if(!Le)return null;var Ze=Le.item,He=wH(Le,aGe);return X.cloneElement(Ze,on(on({},He),{},{chartWidth:ye,chartHeight:De,margin:Ne,onBBoxUpdate:Q.handleLegendBBoxUpdate}))}),Hr(Q,"renderTooltip",function(){var te,ue=Q.props,fe=ue.children,ye=ue.accessibilityLayer,De=Ac(fe,Kd);if(!De)return null;var Ne=Q.state,Fe=Ne.isTooltipActive,Le=Ne.activeCoordinate,Ze=Ne.activePayload,He=Ne.activeLabel,ct=Ne.offset,ot=(te=De.props.active)!==null&&te!==void 0?te:Fe;return X.cloneElement(De,{viewBox:on(on({},ct),{},{x:ct.left,y:ct.top}),active:ot,label:He,payload:ot?Ze:[],coordinate:Le,accessibilityLayer:ye})}),Hr(Q,"renderBrush",function(te){var ue=Q.props,fe=ue.margin,ye=ue.data,De=Q.state,Ne=De.offset,Fe=De.dataStartIndex,Le=De.dataEndIndex,Ze=De.updateId;return X.cloneElement(te,{key:te.key||"_recharts-brush",onChange:u2(Q.handleBrushChange,te.props.onChange),data:ye,x:zn(te.props.x)?te.props.x:Ne.left,y:zn(te.props.y)?te.props.y:Ne.top+Ne.height+Ne.brushBottom-(fe.bottom||0),width:zn(te.props.width)?te.props.width:Ne.width,startIndex:Fe,endIndex:Le,updateId:"brush-".concat(Ze)})}),Hr(Q,"renderReferenceElement",function(te,ue,fe){if(!te)return null;var ye=Q,De=ye.clipPathId,Ne=Q.state,Fe=Ne.xAxisMap,Le=Ne.yAxisMap,Ze=Ne.offset,He=te.type.defaultProps||{},ct=te.props,ot=ct.xAxisId,rt=ot===void 0?He.xAxisId:ot,Be=ct.yAxisId,nt=Be===void 0?He.yAxisId:Be;return X.cloneElement(te,{key:te.key||"".concat(ue,"-").concat(fe),xAxis:Fe[rt],yAxis:Le[nt],viewBox:{x:Ze.left,y:Ze.top,width:Ze.width,height:Ze.height},clipPathId:De})}),Hr(Q,"renderActivePoints",function(te){var ue=te.item,fe=te.activePoint,ye=te.basePoint,De=te.childIndex,Ne=te.isRange,Fe=[],Le=ue.props.key,Ze=ue.item.type.defaultProps!==void 0?on(on({},ue.item.type.defaultProps),ue.item.props):ue.item.props,He=Ze.activeDot,ct=Ze.dataKey,ot=on(on({index:De,dataKey:ct,cx:fe.x,cy:fe.y,r:4,fill:JF(ue.item),strokeWidth:2,stroke:"#fff",payload:fe.payload,value:fe.value},wr(He,!1)),BA(He));return Fe.push(V.renderActiveDot(He,ot,"".concat(Le,"-activePoint-").concat(De))),ye?Fe.push(V.renderActiveDot(He,on(on({},ot),{},{cx:ye.x,cy:ye.y}),"".concat(Le,"-basePoint-").concat(De))):Ne&&Fe.push(null),Fe}),Hr(Q,"renderGraphicChild",function(te,ue,fe){var ye=Q.filterFormatItem(te,ue,fe);if(!ye)return null;var De=Q.getTooltipEventType(),Ne=Q.state,Fe=Ne.isTooltipActive,Le=Ne.tooltipAxis,Ze=Ne.activeTooltipIndex,He=Ne.activeLabel,ct=Q.props.children,ot=Ac(ct,Kd),rt=ye.props,Be=rt.points,nt=rt.isRange,at=rt.baseLine,Mt=ye.item.type.defaultProps!==void 0?on(on({},ye.item.type.defaultProps),ye.item.props):ye.item.props,Nt=Mt.activeDot,rn=Mt.hide,un=Mt.activeBar,en=Mt.activeShape,sn=!!(!rn&&Fe&&ot&&(Nt||un||en)),Vt={};De!=="axis"&&ot&&ot.props.trigger==="click"?Vt={onClick:u2(Q.handleItemMouseEnter,te.props.onClick)}:De!=="axis"&&(Vt={onMouseLeave:u2(Q.handleItemMouseLeave,te.props.onMouseLeave),onMouseEnter:u2(Q.handleItemMouseEnter,te.props.onMouseEnter)});var $n=X.cloneElement(te,on(on({},ye.props),Vt));function Gt(Cn){return typeof Le.dataKey=="function"?Le.dataKey(Cn.payload):null}if(sn)if(Ze>=0){var Tn,hn;if(Le.dataKey&&!Le.allowDuplicatedCategory){var yt=typeof Le.dataKey=="function"?Gt:"payload.".concat(Le.dataKey.toString());Tn=FA(Be,yt,He),hn=nt&&at&&FA(at,yt,He)}else Tn=Be==null?void 0:Be[Ze],hn=nt&&at&&at[Ze];if(en||un){var In=te.props.activeIndex!==void 0?te.props.activeIndex:Ze;return[X.cloneElement(te,on(on(on({},ye.props),Vt),{},{activeIndex:In})),null,null]}if(!Nr(Tn))return[$n].concat(C0(Q.renderActivePoints({item:ye,activePoint:Tn,basePoint:hn,childIndex:Ze,isRange:nt})))}else{var Kn,Ar=(Kn=Q.getItemByXY(Q.state.activeCoordinate))!==null&&Kn!==void 0?Kn:{graphicalItem:$n},_r=Ar.graphicalItem,Vr=_r.item,it=Vr===void 0?te:Vr,Pt=_r.childIndex,jt=on(on(on({},ye.props),Vt),{},{activeIndex:Pt});return[X.cloneElement(it,jt),null,null]}return nt?[$n,null,null]:[$n,null]}),Hr(Q,"renderCustomized",function(te,ue,fe){return X.cloneElement(te,on(on({key:"recharts-customized-".concat(fe)},Q.props),Q.state))}),Hr(Q,"renderMap",{CartesianGrid:{handler:m2,once:!0},ReferenceArea:{handler:Q.renderReferenceElement},ReferenceLine:{handler:m2},ReferenceDot:{handler:Q.renderReferenceElement},XAxis:{handler:m2},YAxis:{handler:m2},Brush:{handler:Q.renderBrush,once:!0},Bar:{handler:Q.renderGraphicChild},Line:{handler:Q.renderGraphicChild},Area:{handler:Q.renderGraphicChild},Radar:{handler:Q.renderGraphicChild},RadialBar:{handler:Q.renderGraphicChild},Scatter:{handler:Q.renderGraphicChild},Pie:{handler:Q.renderGraphicChild},Funnel:{handler:Q.renderGraphicChild},Tooltip:{handler:Q.renderCursor,once:!0},PolarGrid:{handler:Q.renderPolarGrid,once:!0},PolarAngleAxis:{handler:Q.renderPolarAxis},PolarRadiusAxis:{handler:Q.renderPolarAxis},Customized:{handler:Q.renderCustomized}}),Q.clipPathId="".concat((G=H.id)!==null&&G!==void 0?G:Em("recharts"),"-clip"),Q.throttleTriggeredAfterMouseMove=zQ(Q.triggeredAfterMouseMove,(q=H.throttleDelay)!==null&&q!==void 0?q:1e3/60),Q.state={},Q}return yGe(V,N),pGe(V,[{key:"componentDidMount",value:function(){var G,q;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(G=this.props.margin.left)!==null&&G!==void 0?G:0,top:(q=this.props.margin.top)!==null&&q!==void 0?q:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var G=this.props,q=G.children,Q=G.data,te=G.height,ue=G.layout,fe=Ac(q,Kd);if(fe){var ye=fe.props.defaultIndex;if(!(typeof ye!="number"||ye<0||ye>this.state.tooltipTicks.length-1)){var De=this.state.tooltipTicks[ye]&&this.state.tooltipTicks[ye].value,Ne=Nz(this.state,Q,ye,De),Fe=this.state.tooltipTicks[ye].coordinate,Le=(this.state.offset.top+te)/2,Ze=ue==="horizontal",He=Ze?{x:Fe,y:Le}:{y:Fe,x:Le},ct=this.state.formattedGraphicalItems.find(function(rt){var Be=rt.item;return Be.type.name==="Scatter"});ct&&(He=on(on({},He),ct.props.points[ye].tooltipPosition),Ne=ct.props.points[ye].tooltipPayload);var ot={activeTooltipIndex:ye,isTooltipActive:!0,activeLabel:De,activePayload:Ne,activeCoordinate:He};this.setState(ot),this.renderCursor(fe),this.accessibilityManager.setIndex(ye)}}}},{key:"getSnapshotBeforeUpdate",value:function(G,q){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==q.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==G.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==G.margin){var Q,te;this.accessibilityManager.setDetails({offset:{left:(Q=this.props.margin.left)!==null&&Q!==void 0?Q:0,top:(te=this.props.margin.top)!==null&&te!==void 0?te:0}})}return null}},{key:"componentDidUpdate",value:function(G){lL([Ac(G.children,Kd)],[Ac(this.props.children,Kd)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var G=Ac(this.props.children,Kd);if(G&&typeof G.props.shared=="boolean"){var q=G.props.shared?"axis":"item";return i.indexOf(q)>=0?q:c}return c}},{key:"getMouseInfo",value:function(G){if(!this.container)return null;var q=this.container,Q=q.getBoundingClientRect(),te=JLe(Q),ue={chartX:Math.round(G.pageX-te.left),chartY:Math.round(G.pageY-te.top)},fe=Q.width/q.offsetWidth||1,ye=this.inRange(ue.chartX,ue.chartY,fe);if(!ye)return null;var De=this.state,Ne=De.xAxisMap,Fe=De.yAxisMap,Le=this.getTooltipEventType();if(Le!=="axis"&&Ne&&Fe){var Ze=Dp(Ne).scale,He=Dp(Fe).scale,ct=Ze&&Ze.invert?Ze.invert(ue.chartX):null,ot=He&&He.invert?He.invert(ue.chartY):null;return on(on({},ue),{},{xValue:ct,yValue:ot})}var rt=TH(this.state,this.props.data,this.props.layout,ye);return rt?on(on({},ue),rt):null}},{key:"inRange",value:function(G,q){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,te=this.props.layout,ue=G/Q,fe=q/Q;if(te==="horizontal"||te==="vertical"){var ye=this.state.offset,De=ue>=ye.left&&ue<=ye.left+ye.width&&fe>=ye.top&&fe<=ye.top+ye.height;return De?{x:ue,y:fe}:null}var Ne=this.state,Fe=Ne.angleAxisMap,Le=Ne.radiusAxisMap;if(Fe&&Le){var Ze=Dp(Fe);return GW({x:ue,y:fe},Ze)}return null}},{key:"parseEventsOfWrapper",value:function(){var G=this.props.children,q=this.getTooltipEventType(),Q=Ac(G,Kd),te={};Q&&q==="axis"&&(Q.props.trigger==="click"?te={onClick:this.handleClick}:te={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var ue=BA(this.props,this.handleOuterEvent);return on(on({},ue),te)}},{key:"addListener",value:function(){_R.on(yR,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){_R.removeListener(yR,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(G,q,Q){for(var te=this.state.formattedGraphicalItems,ue=0,fe=te.length;ue<fe;ue++){var ye=te[ue];if(ye.item===G||ye.props.key===G.key||q===sf(ye.item.type)&&Q===ye.childIndex)return ye}return null}},{key:"renderClipPath",value:function(){var G=this.clipPathId,q=this.state.offset,Q=q.left,te=q.top,ue=q.height,fe=q.width;return Ce.createElement("defs",null,Ce.createElement("clipPath",{id:G},Ce.createElement("rect",{x:Q,y:te,height:ue,width:fe})))}},{key:"getXScales",value:function(){var G=this.state.xAxisMap;return G?Object.entries(G).reduce(function(q,Q){var te=bH(Q,2),ue=te[0],fe=te[1];return on(on({},q),{},Hr({},ue,fe.scale))},{}):null}},{key:"getYScales",value:function(){var G=this.state.yAxisMap;return G?Object.entries(G).reduce(function(q,Q){var te=bH(Q,2),ue=te[0],fe=te[1];return on(on({},q),{},Hr({},ue,fe.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(G){var q;return(q=this.state.xAxisMap)===null||q===void 0||(q=q[G])===null||q===void 0?void 0:q.scale}},{key:"getYScaleByAxisId",value:function(G){var q;return(q=this.state.yAxisMap)===null||q===void 0||(q=q[G])===null||q===void 0?void 0:q.scale}},{key:"getItemByXY",value:function(G){var q=this.state,Q=q.formattedGraphicalItems,te=q.activeItem;if(Q&&Q.length)for(var ue=0,fe=Q.length;ue<fe;ue++){var ye=Q[ue],De=ye.props,Ne=ye.item,Fe=Ne.type.defaultProps!==void 0?on(on({},Ne.type.defaultProps),Ne.props):Ne.props,Le=sf(Ne.type);if(Le==="Bar"){var Ze=(De.data||[]).find(function(rt){return P5e(G,rt)});if(Ze)return{graphicalItem:ye,payload:Ze}}else if(Le==="RadialBar"){var He=(De.data||[]).find(function(rt){return GW(G,rt)});if(He)return{graphicalItem:ye,payload:He}}else if(CI(ye,te)||II(ye,te)||eS(ye,te)){var ct=mUe({graphicalItem:ye,activeTooltipItem:te,itemData:Fe.data}),ot=Fe.activeIndex===void 0?ct:Fe.activeIndex;return{graphicalItem:on(on({},ye),{},{childIndex:ot}),payload:eS(ye,te)?Fe.data[ct]:ye.props.data[ct]}}}return null}},{key:"render",value:function(){var G=this;if(!D6(this))return null;var q=this.props,Q=q.children,te=q.className,ue=q.width,fe=q.height,ye=q.style,De=q.compact,Ne=q.title,Fe=q.desc,Le=wH(q,sGe),Ze=wr(Le,!1);if(De)return Ce.createElement(QG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement(uL,$b({},Ze,{width:ue,height:fe,title:Ne,desc:Fe}),this.renderClipPath(),z6(Q,this.renderMap)));if(this.props.accessibilityLayer){var He,ct;Ze.tabIndex=(He=this.props.tabIndex)!==null&&He!==void 0?He:0,Ze.role=(ct=this.props.role)!==null&&ct!==void 0?ct:"application",Ze.onKeyDown=function(rt){G.accessibilityManager.keyboardEvent(rt)},Ze.onFocus=function(){G.accessibilityManager.focus()}}var ot=this.parseEventsOfWrapper();return Ce.createElement(QG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement("div",$b({className:li("recharts-wrapper",te),style:on({position:"relative",cursor:"default",width:ue,height:fe},ye)},ot,{ref:function(Be){G.container=Be}}),Ce.createElement(uL,$b({},Ze,{width:ue,height:fe,title:Ne,desc:Fe,style:TGe}),this.renderClipPath(),z6(Q,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(X.Component);return Hr(B,"displayName",n),Hr(B,"defaultProps",on({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},A)),Hr(B,"getDerivedStateFromProps",function(N,V){var H=N.dataKey,G=N.data,q=N.children,Q=N.width,te=N.height,ue=N.layout,fe=N.stackOffset,ye=N.margin,De=V.dataStartIndex,Ne=V.dataEndIndex;if(V.updateId===void 0){var Fe=EH(N);return on(on(on({},Fe),{},{updateId:0},R(on(on({props:N},Fe),{},{updateId:0}),V)),{},{prevDataKey:H,prevData:G,prevWidth:Q,prevHeight:te,prevLayout:ue,prevStackOffset:fe,prevMargin:ye,prevChildren:q})}if(H!==V.prevDataKey||G!==V.prevData||Q!==V.prevWidth||te!==V.prevHeight||ue!==V.prevLayout||fe!==V.prevStackOffset||!Mv(ye,V.prevMargin)){var Le=EH(N),Ze={chartX:V.chartX,chartY:V.chartY,isTooltipActive:V.isTooltipActive},He=on(on({},TH(V,G,ue)),{},{updateId:V.updateId+1}),ct=on(on(on({},Le),Ze),He);return on(on(on({},ct),R(on({props:N},ct),V)),{},{prevDataKey:H,prevData:G,prevWidth:Q,prevHeight:te,prevLayout:ue,prevStackOffset:fe,prevMargin:ye,prevChildren:q})}if(!lL(q,V.prevChildren)){var ot,rt,Be,nt,at=Ac(q,m0),Mt=at&&(ot=(rt=at.props)===null||rt===void 0?void 0:rt.startIndex)!==null&&ot!==void 0?ot:De,Nt=at&&(Be=(nt=at.props)===null||nt===void 0?void 0:nt.endIndex)!==null&&Be!==void 0?Be:Ne,rn=Mt!==De||Nt!==Ne,un=!Nr(G),en=un&&!rn?V.updateId:V.updateId+1;return on(on({updateId:en},R(on(on({props:N},V),{},{updateId:en,dataStartIndex:Mt,dataEndIndex:Nt}),V)),{},{prevChildren:q,dataStartIndex:Mt,dataEndIndex:Nt})}return null}),Hr(B,"renderActiveDot",function(N,V,H){var G;return X.isValidElement(N)?G=X.cloneElement(N,V):$r(N)?G=N(V):G=Ce.createElement(VS,V),Ce.createElement(_i,{className:"recharts-active-dot",key:H},G)}),function(V){return Ce.createElement(B,V)}},cQe=WS({chartName:"LineChart",GraphicalChild:zI,axisComponents:[{axisType:"xAxis",AxisComp:cx},{axisType:"yAxis",AxisComp:ux}],formatAxisMap:OI}),uQe=WS({chartName:"BarChart",GraphicalChild:sx,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:cx},{axisType:"yAxis",AxisComp:ux}],formatAxisMap:OI}),hQe=WS({chartName:"PieChart",GraphicalChild:Im,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:PI},{axisType:"radiusAxis",AxisComp:EI}],formatAxisMap:YBe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),dQe=WS({chartName:"ScatterChart",GraphicalChild:FI,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:cx},{axisType:"yAxis",AxisComp:ux},{axisType:"zAxis",AxisComp:NI}],formatAxisMap:OI}),fQe=WS({chartName:"AreaChart",GraphicalChild:k_,axisComponents:[{axisType:"xAxis",AxisComp:cx},{axisType:"yAxis",AxisComp:ux}],formatAxisMap:OI});function vne(e,t){const n=X.useRef(t);X.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const DGe=1;function LGe(e){return Object.freeze({__version:DGe,map:e})}function xne(e,t){return Object.freeze({...e,...t})}const cB=X.createContext(null);function jI(){const e=X.use(cB);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function bne(e){function t(n,r){const{instance:a,context:c}=e(n).current;X.useImperativeHandle(r,()=>a);const{children:d}=n;return d==null?null:Ce.createElement(cB,{value:c},d)}return X.forwardRef(t)}function zGe(e){function t(n,r){const[a,c]=X.useState(!1),{instance:d}=e(n,c).current;X.useImperativeHandle(r,()=>d),X.useEffect(function(){a&&d.update()},[d,a,n.children]);const i=d._contentNode;return i?ym.createPortal(n.children,i):null}return X.forwardRef(t)}function NGe(e){function t(n,r){const{instance:a}=e(n).current;return X.useImperativeHandle(r,()=>a),null}return X.forwardRef(t)}function uB(e,t){const n=X.useRef(void 0);X.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function $I(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function FGe(e,t){return function(r,a){const c=jI(),d=e($I(r,c),c);return vne(c.map,r.attribution),uB(d.current,r.eventHandlers),t(d.current,c,r,a),d}}var Fz={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,r){r(t)})(ws,function(n){var r="1.9.4";function a(x){var I,U,ne,pe;for(U=1,ne=arguments.length;U<ne;U++){pe=arguments[U];for(I in pe)x[I]=pe[I]}return x}var c=Object.create||function(){function x(){}return function(I){return x.prototype=I,new x}}();function d(x,I){var U=Array.prototype.slice;if(x.bind)return x.bind.apply(x,U.call(arguments,1));var ne=U.call(arguments,2);return function(){return x.apply(I,ne.length?ne.concat(U.call(arguments)):arguments)}}var i=0;function _(x){return"_leaflet_id"in x||(x._leaflet_id=++i),x._leaflet_id}function b(x,I,U){var ne,pe,Oe,lt;return lt=function(){ne=!1,pe&&(Oe.apply(U,pe),pe=!1)},Oe=function(){ne?pe=arguments:(x.apply(U,arguments),setTimeout(lt,I),ne=!0)},Oe}function T(x,I,U){var ne=I[1],pe=I[0],Oe=ne-pe;return x===ne&&U?x:((x-pe)%Oe+Oe)%Oe+pe}function A(){return!1}function k(x,I){if(I===!1)return x;var U=Math.pow(10,I===void 0?6:I);return Math.round(x*U)/U}function R(x){return x.trim?x.trim():x.replace(/^\s+|\s+$/g,"")}function B(x){return R(x).split(/\s+/)}function N(x,I){Object.prototype.hasOwnProperty.call(x,"options")||(x.options=x.options?c(x.options):{});for(var U in I)x.options[U]=I[U];return x.options}function V(x,I,U){var ne=[];for(var pe in x)ne.push(encodeURIComponent(U?pe.toUpperCase():pe)+"="+encodeURIComponent(x[pe]));return(!I||I.indexOf("?")===-1?"?":"&")+ne.join("&")}var H=/\{ *([\w_ -]+) *\}/g;function G(x,I){return x.replace(H,function(U,ne){var pe=I[ne];if(pe===void 0)throw new Error("No value provided for variable "+U);return typeof pe=="function"&&(pe=pe(I)),pe})}var q=Array.isArray||function(x){return Object.prototype.toString.call(x)==="[object Array]"};function Q(x,I){for(var U=0;U<x.length;U++)if(x[U]===I)return U;return-1}var te="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ue(x){return window["webkit"+x]||window["moz"+x]||window["ms"+x]}var fe=0;function ye(x){var I=+new Date,U=Math.max(0,16-(I-fe));return fe=I+U,window.setTimeout(x,U)}var De=window.requestAnimationFrame||ue("RequestAnimationFrame")||ye,Ne=window.cancelAnimationFrame||ue("CancelAnimationFrame")||ue("CancelRequestAnimationFrame")||function(x){window.clearTimeout(x)};function Fe(x,I,U){if(U&&De===ye)x.call(I);else return De.call(window,d(x,I))}function Le(x){x&&Ne.call(window,x)}var Ze={__proto__:null,extend:a,create:c,bind:d,get lastId(){return i},stamp:_,throttle:b,wrapNum:T,falseFn:A,formatNum:k,trim:R,splitWords:B,setOptions:N,getParamString:V,template:G,isArray:q,indexOf:Q,emptyImageUrl:te,requestFn:De,cancelFn:Ne,requestAnimFrame:Fe,cancelAnimFrame:Le};function He(){}He.extend=function(x){var I=function(){N(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},U=I.__super__=this.prototype,ne=c(U);ne.constructor=I,I.prototype=ne;for(var pe in this)Object.prototype.hasOwnProperty.call(this,pe)&&pe!=="prototype"&&pe!=="__super__"&&(I[pe]=this[pe]);return x.statics&&a(I,x.statics),x.includes&&(ct(x.includes),a.apply(null,[ne].concat(x.includes))),a(ne,x),delete ne.statics,delete ne.includes,ne.options&&(ne.options=U.options?c(U.options):{},a(ne.options,x.options)),ne._initHooks=[],ne.callInitHooks=function(){if(!this._initHooksCalled){U.callInitHooks&&U.callInitHooks.call(this),this._initHooksCalled=!0;for(var Oe=0,lt=ne._initHooks.length;Oe<lt;Oe++)ne._initHooks[Oe].call(this)}},I},He.include=function(x){var I=this.prototype.options;return a(this.prototype,x),x.options&&(this.prototype.options=I,this.mergeOptions(x.options)),this},He.mergeOptions=function(x){return a(this.prototype.options,x),this},He.addInitHook=function(x){var I=Array.prototype.slice.call(arguments,1),U=typeof x=="function"?x:function(){this[x].apply(this,I)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(U),this};function ct(x){if(!(typeof L>"u"||!L||!L.Mixin)){x=q(x)?x:[x];for(var I=0;I<x.length;I++)x[I]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ot={on:function(x,I,U){if(typeof x=="object")for(var ne in x)this._on(ne,x[ne],I);else{x=B(x);for(var pe=0,Oe=x.length;pe<Oe;pe++)this._on(x[pe],I,U)}return this},off:function(x,I,U){if(!arguments.length)delete this._events;else if(typeof x=="object")for(var ne in x)this._off(ne,x[ne],I);else{x=B(x);for(var pe=arguments.length===1,Oe=0,lt=x.length;Oe<lt;Oe++)pe?this._off(x[Oe]):this._off(x[Oe],I,U)}return this},_on:function(x,I,U,ne){if(typeof I!="function"){console.warn("wrong listener type: "+typeof I);return}if(this._listens(x,I,U)===!1){U===this&&(U=void 0);var pe={fn:I,ctx:U};ne&&(pe.once=!0),this._events=this._events||{},this._events[x]=this._events[x]||[],this._events[x].push(pe)}},_off:function(x,I,U){var ne,pe,Oe;if(this._events&&(ne=this._events[x],!!ne)){if(arguments.length===1){if(this._firingCount)for(pe=0,Oe=ne.length;pe<Oe;pe++)ne[pe].fn=A;delete this._events[x];return}if(typeof I!="function"){console.warn("wrong listener type: "+typeof I);return}var lt=this._listens(x,I,U);if(lt!==!1){var Rt=ne[lt];this._firingCount&&(Rt.fn=A,this._events[x]=ne=ne.slice()),ne.splice(lt,1)}}},fire:function(x,I,U){if(!this.listens(x,U))return this;var ne=a({},I,{type:x,target:this,sourceTarget:I&&I.sourceTarget||this});if(this._events){var pe=this._events[x];if(pe){this._firingCount=this._firingCount+1||1;for(var Oe=0,lt=pe.length;Oe<lt;Oe++){var Rt=pe[Oe],Ht=Rt.fn;Rt.once&&this.off(x,Ht,Rt.ctx),Ht.call(Rt.ctx||this,ne)}this._firingCount--}}return U&&this._propagateEvent(ne),this},listens:function(x,I,U,ne){typeof x!="string"&&console.warn('"string" type argument expected');var pe=I;typeof I!="function"&&(ne=!!I,pe=void 0,U=void 0);var Oe=this._events&&this._events[x];if(Oe&&Oe.length&&this._listens(x,pe,U)!==!1)return!0;if(ne){for(var lt in this._eventParents)if(this._eventParents[lt].listens(x,I,U,ne))return!0}return!1},_listens:function(x,I,U){if(!this._events)return!1;var ne=this._events[x]||[];if(!I)return!!ne.length;U===this&&(U=void 0);for(var pe=0,Oe=ne.length;pe<Oe;pe++)if(ne[pe].fn===I&&ne[pe].ctx===U)return pe;return!1},once:function(x,I,U){if(typeof x=="object")for(var ne in x)this._on(ne,x[ne],I,!0);else{x=B(x);for(var pe=0,Oe=x.length;pe<Oe;pe++)this._on(x[pe],I,U,!0)}return this},addEventParent:function(x){return this._eventParents=this._eventParents||{},this._eventParents[_(x)]=x,this},removeEventParent:function(x){return this._eventParents&&delete this._eventParents[_(x)],this},_propagateEvent:function(x){for(var I in this._eventParents)this._eventParents[I].fire(x.type,a({layer:x.target,propagatedFrom:x.target},x),!0)}};ot.addEventListener=ot.on,ot.removeEventListener=ot.clearAllEventListeners=ot.off,ot.addOneTimeEventListener=ot.once,ot.fireEvent=ot.fire,ot.hasEventListeners=ot.listens;var rt=He.extend(ot);function Be(x,I,U){this.x=U?Math.round(x):x,this.y=U?Math.round(I):I}var nt=Math.trunc||function(x){return x>0?Math.floor(x):Math.ceil(x)};Be.prototype={clone:function(){return new Be(this.x,this.y)},add:function(x){return this.clone()._add(at(x))},_add:function(x){return this.x+=x.x,this.y+=x.y,this},subtract:function(x){return this.clone()._subtract(at(x))},_subtract:function(x){return this.x-=x.x,this.y-=x.y,this},divideBy:function(x){return this.clone()._divideBy(x)},_divideBy:function(x){return this.x/=x,this.y/=x,this},multiplyBy:function(x){return this.clone()._multiplyBy(x)},_multiplyBy:function(x){return this.x*=x,this.y*=x,this},scaleBy:function(x){return new Be(this.x*x.x,this.y*x.y)},unscaleBy:function(x){return new Be(this.x/x.x,this.y/x.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=nt(this.x),this.y=nt(this.y),this},distanceTo:function(x){x=at(x);var I=x.x-this.x,U=x.y-this.y;return Math.sqrt(I*I+U*U)},equals:function(x){return x=at(x),x.x===this.x&&x.y===this.y},contains:function(x){return x=at(x),Math.abs(x.x)<=Math.abs(this.x)&&Math.abs(x.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function at(x,I,U){return x instanceof Be?x:q(x)?new Be(x[0],x[1]):x==null?x:typeof x=="object"&&"x"in x&&"y"in x?new Be(x.x,x.y):new Be(x,I,U)}function Mt(x,I){if(x)for(var U=I?[x,I]:x,ne=0,pe=U.length;ne<pe;ne++)this.extend(U[ne])}Mt.prototype={extend:function(x){var I,U;if(!x)return this;if(x instanceof Be||typeof x[0]=="number"||"x"in x)I=U=at(x);else if(x=Nt(x),I=x.min,U=x.max,!I||!U)return this;return!this.min&&!this.max?(this.min=I.clone(),this.max=U.clone()):(this.min.x=Math.min(I.x,this.min.x),this.max.x=Math.max(U.x,this.max.x),this.min.y=Math.min(I.y,this.min.y),this.max.y=Math.max(U.y,this.max.y)),this},getCenter:function(x){return at((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,x)},getBottomLeft:function(){return at(this.min.x,this.max.y)},getTopRight:function(){return at(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(x){var I,U;return typeof x[0]=="number"||x instanceof Be?x=at(x):x=Nt(x),x instanceof Mt?(I=x.min,U=x.max):I=U=x,I.x>=this.min.x&&U.x<=this.max.x&&I.y>=this.min.y&&U.y<=this.max.y},intersects:function(x){x=Nt(x);var I=this.min,U=this.max,ne=x.min,pe=x.max,Oe=pe.x>=I.x&&ne.x<=U.x,lt=pe.y>=I.y&&ne.y<=U.y;return Oe&&lt},overlaps:function(x){x=Nt(x);var I=this.min,U=this.max,ne=x.min,pe=x.max,Oe=pe.x>I.x&&ne.x<U.x,lt=pe.y>I.y&&ne.y<U.y;return Oe&&lt},isValid:function(){return!!(this.min&&this.max)},pad:function(x){var I=this.min,U=this.max,ne=Math.abs(I.x-U.x)*x,pe=Math.abs(I.y-U.y)*x;return Nt(at(I.x-ne,I.y-pe),at(U.x+ne,U.y+pe))},equals:function(x){return x?(x=Nt(x),this.min.equals(x.getTopLeft())&&this.max.equals(x.getBottomRight())):!1}};function Nt(x,I){return!x||x instanceof Mt?x:new Mt(x,I)}function rn(x,I){if(x)for(var U=I?[x,I]:x,ne=0,pe=U.length;ne<pe;ne++)this.extend(U[ne])}rn.prototype={extend:function(x){var I=this._southWest,U=this._northEast,ne,pe;if(x instanceof en)ne=x,pe=x;else if(x instanceof rn){if(ne=x._southWest,pe=x._northEast,!ne||!pe)return this}else return x?this.extend(sn(x)||un(x)):this;return!I&&!U?(this._southWest=new en(ne.lat,ne.lng),this._northEast=new en(pe.lat,pe.lng)):(I.lat=Math.min(ne.lat,I.lat),I.lng=Math.min(ne.lng,I.lng),U.lat=Math.max(pe.lat,U.lat),U.lng=Math.max(pe.lng,U.lng)),this},pad:function(x){var I=this._southWest,U=this._northEast,ne=Math.abs(I.lat-U.lat)*x,pe=Math.abs(I.lng-U.lng)*x;return new rn(new en(I.lat-ne,I.lng-pe),new en(U.lat+ne,U.lng+pe))},getCenter:function(){return new en((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new en(this.getNorth(),this.getWest())},getSouthEast:function(){return new en(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(x){typeof x[0]=="number"||x instanceof en||"lat"in x?x=sn(x):x=un(x);var I=this._southWest,U=this._northEast,ne,pe;return x instanceof rn?(ne=x.getSouthWest(),pe=x.getNorthEast()):ne=pe=x,ne.lat>=I.lat&&pe.lat<=U.lat&&ne.lng>=I.lng&&pe.lng<=U.lng},intersects:function(x){x=un(x);var I=this._southWest,U=this._northEast,ne=x.getSouthWest(),pe=x.getNorthEast(),Oe=pe.lat>=I.lat&&ne.lat<=U.lat,lt=pe.lng>=I.lng&&ne.lng<=U.lng;return Oe&&lt},overlaps:function(x){x=un(x);var I=this._southWest,U=this._northEast,ne=x.getSouthWest(),pe=x.getNorthEast(),Oe=pe.lat>I.lat&&ne.lat<U.lat,lt=pe.lng>I.lng&&ne.lng<U.lng;return Oe&&lt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(x,I){return x?(x=un(x),this._southWest.equals(x.getSouthWest(),I)&&this._northEast.equals(x.getNorthEast(),I)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function un(x,I){return x instanceof rn?x:new rn(x,I)}function en(x,I,U){if(isNaN(x)||isNaN(I))throw new Error("Invalid LatLng object: ("+x+", "+I+")");this.lat=+x,this.lng=+I,U!==void 0&&(this.alt=+U)}en.prototype={equals:function(x,I){if(!x)return!1;x=sn(x);var U=Math.max(Math.abs(this.lat-x.lat),Math.abs(this.lng-x.lng));return U<=(I===void 0?1e-9:I)},toString:function(x){return"LatLng("+k(this.lat,x)+", "+k(this.lng,x)+")"},distanceTo:function(x){return $n.distance(this,sn(x))},wrap:function(){return $n.wrapLatLng(this)},toBounds:function(x){var I=180*x/40075017,U=I/Math.cos(Math.PI/180*this.lat);return un([this.lat-I,this.lng-U],[this.lat+I,this.lng+U])},clone:function(){return new en(this.lat,this.lng,this.alt)}};function sn(x,I,U){return x instanceof en?x:q(x)&&typeof x[0]!="object"?x.length===3?new en(x[0],x[1],x[2]):x.length===2?new en(x[0],x[1]):null:x==null?x:typeof x=="object"&&"lat"in x?new en(x.lat,"lng"in x?x.lng:x.lon,x.alt):I===void 0?null:new en(x,I,U)}var Vt={latLngToPoint:function(x,I){var U=this.projection.project(x),ne=this.scale(I);return this.transformation._transform(U,ne)},pointToLatLng:function(x,I){var U=this.scale(I),ne=this.transformation.untransform(x,U);return this.projection.unproject(ne)},project:function(x){return this.projection.project(x)},unproject:function(x){return this.projection.unproject(x)},scale:function(x){return 256*Math.pow(2,x)},zoom:function(x){return Math.log(x/256)/Math.LN2},getProjectedBounds:function(x){if(this.infinite)return null;var I=this.projection.bounds,U=this.scale(x),ne=this.transformation.transform(I.min,U),pe=this.transformation.transform(I.max,U);return new Mt(ne,pe)},infinite:!1,wrapLatLng:function(x){var I=this.wrapLng?T(x.lng,this.wrapLng,!0):x.lng,U=this.wrapLat?T(x.lat,this.wrapLat,!0):x.lat,ne=x.alt;return new en(U,I,ne)},wrapLatLngBounds:function(x){var I=x.getCenter(),U=this.wrapLatLng(I),ne=I.lat-U.lat,pe=I.lng-U.lng;if(ne===0&&pe===0)return x;var Oe=x.getSouthWest(),lt=x.getNorthEast(),Rt=new en(Oe.lat-ne,Oe.lng-pe),Ht=new en(lt.lat-ne,lt.lng-pe);return new rn(Rt,Ht)}},$n=a({},Vt,{wrapLng:[-180,180],R:6371e3,distance:function(x,I){var U=Math.PI/180,ne=x.lat*U,pe=I.lat*U,Oe=Math.sin((I.lat-x.lat)*U/2),lt=Math.sin((I.lng-x.lng)*U/2),Rt=Oe*Oe+Math.cos(ne)*Math.cos(pe)*lt*lt,Ht=2*Math.atan2(Math.sqrt(Rt),Math.sqrt(1-Rt));return this.R*Ht}}),Gt=6378137,Tn={R:Gt,MAX_LATITUDE:85.0511287798,project:function(x){var I=Math.PI/180,U=this.MAX_LATITUDE,ne=Math.max(Math.min(U,x.lat),-U),pe=Math.sin(ne*I);return new Be(this.R*x.lng*I,this.R*Math.log((1+pe)/(1-pe))/2)},unproject:function(x){var I=180/Math.PI;return new en((2*Math.atan(Math.exp(x.y/this.R))-Math.PI/2)*I,x.x*I/this.R)},bounds:function(){var x=Gt*Math.PI;return new Mt([-x,-x],[x,x])}()};function hn(x,I,U,ne){if(q(x)){this._a=x[0],this._b=x[1],this._c=x[2],this._d=x[3];return}this._a=x,this._b=I,this._c=U,this._d=ne}hn.prototype={transform:function(x,I){return this._transform(x.clone(),I)},_transform:function(x,I){return I=I||1,x.x=I*(this._a*x.x+this._b),x.y=I*(this._c*x.y+this._d),x},untransform:function(x,I){return I=I||1,new Be((x.x/I-this._b)/this._a,(x.y/I-this._d)/this._c)}};function yt(x,I,U,ne){return new hn(x,I,U,ne)}var In=a({},$n,{code:"EPSG:3857",projection:Tn,transformation:function(){var x=.5/(Math.PI*Tn.R);return yt(x,.5,-x,.5)}()}),Kn=a({},In,{code:"EPSG:900913"});function Ar(x){return document.createElementNS("http://www.w3.org/2000/svg",x)}function _r(x,I){var U="",ne,pe,Oe,lt,Rt,Ht;for(ne=0,Oe=x.length;ne<Oe;ne++){for(Rt=x[ne],pe=0,lt=Rt.length;pe<lt;pe++)Ht=Rt[pe],U+=(pe?"L":"M")+Ht.x+" "+Ht.y;U+=I?$e.svg?"z":"x":""}return U||"M0 0"}var Vr=document.documentElement.style,it="ActiveXObject"in window,Pt=it&&!document.addEventListener,jt="msLaunchUri"in navigator&&!("documentMode"in document),Cn=Xe("webkit"),Mn=Xe("android"),_n=Xe("android 2")||Xe("android 3"),Gn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),vr=Mn&&Xe("Google")&&Gn<537&&!("AudioNode"in window),ni=!!window.opera,vi=!jt&&Xe("chrome"),na=Xe("gecko")&&!Cn&&!ni&&!it,fa=!vi&&Xe("safari"),to=Xe("phantom"),uo="OTransition"in Vr,ja=navigator.platform.indexOf("Win")===0,Bo=it&&"transition"in Vr,fo="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_n,$a="MozPerspective"in Vr,Ua=!window.L_DISABLE_3D&&(Bo||fo||$a)&&!uo&&!to,Es=typeof orientation<"u"||Xe("mobile"),ci=Es&&Cn,Qa=Es&&fo,As=!window.PointerEvent&&window.MSPointerEvent,pa=!!(window.PointerEvent||As),Ps="ontouchstart"in window||!!window.TouchEvent,es=!window.L_NO_TOUCH&&(Ps||pa),Cl=Es&&ni,Tt=Es&&na,pi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Yi=function(){var x=!1;try{var I=Object.defineProperty({},"passive",{get:function(){x=!0}});window.addEventListener("testPassiveEventSupport",A,I),window.removeEventListener("testPassiveEventSupport",A,I)}catch{}return x}(),mt=function(){return!!document.createElement("canvas").getContext}(),ae=!!(document.createElementNS&&Ar("svg").createSVGRect),me=!!ae&&function(){var x=document.createElement("div");return x.innerHTML="<svg/>",(x.firstChild&&x.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Me=!ae&&function(){try{var x=document.createElement("div");x.innerHTML='<v:shape adj="1"/>';var I=x.firstChild;return I.style.behavior="url(#default#VML)",I&&typeof I.adj=="object"}catch{return!1}}(),We=navigator.platform.indexOf("Mac")===0,je=navigator.platform.indexOf("Linux")===0;function Xe(x){return navigator.userAgent.toLowerCase().indexOf(x)>=0}var $e={ie:it,ielt9:Pt,edge:jt,webkit:Cn,android:Mn,android23:_n,androidStock:vr,opera:ni,chrome:vi,gecko:na,safari:fa,phantom:to,opera12:uo,win:ja,ie3d:Bo,webkit3d:fo,gecko3d:$a,any3d:Ua,mobile:Es,mobileWebkit:ci,mobileWebkit3d:Qa,msPointer:As,pointer:pa,touch:es,touchNative:Ps,mobileOpera:Cl,mobileGecko:Tt,retina:pi,passiveEvents:Yi,canvas:mt,svg:ae,vml:Me,inlineSvg:me,mac:We,linux:je},Ye=$e.msPointer?"MSPointerDown":"pointerdown",ft=$e.msPointer?"MSPointerMove":"pointermove",St=$e.msPointer?"MSPointerUp":"pointerup",ut=$e.msPointer?"MSPointerCancel":"pointercancel",Yt={touchstart:Ye,touchmove:ft,touchend:St,touchcancel:ut},an={touchstart:hi,touchmove:Cr,touchend:Cr,touchcancel:Cr},pn={},Zn=!1;function er(x,I,U){return I==="touchstart"&&ui(),an[I]?(U=an[I].bind(this,U),x.addEventListener(Yt[I],U,!1),U):(console.warn("wrong event specified:",I),A)}function or(x,I,U){if(!Yt[I]){console.warn("wrong event specified:",I);return}x.removeEventListener(Yt[I],U,!1)}function pr(x){pn[x.pointerId]=x}function Wi(x){pn[x.pointerId]&&(pn[x.pointerId]=x)}function mr(x){delete pn[x.pointerId]}function ui(){Zn||(document.addEventListener(Ye,pr,!0),document.addEventListener(ft,Wi,!0),document.addEventListener(St,mr,!0),document.addEventListener(ut,mr,!0),Zn=!0)}function Cr(x,I){if(I.pointerType!==(I.MSPOINTER_TYPE_MOUSE||"mouse")){I.touches=[];for(var U in pn)I.touches.push(pn[U]);I.changedTouches=[I],x(I)}}function hi(x,I){I.MSPOINTER_TYPE_TOUCH&&I.pointerType===I.MSPOINTER_TYPE_TOUCH&&ya(I),Cr(x,I)}function mi(x){var I={},U,ne;for(ne in x)U=x[ne],I[ne]=U&&U.bind?U.bind(x):U;return x=I,I.type="dblclick",I.detail=2,I.isTrusted=!1,I._simulated=!0,I}var no=200;function vo(x,I){x.addEventListener("dblclick",I);var U=0,ne;function pe(Oe){if(Oe.detail!==1){ne=Oe.detail;return}if(!(Oe.pointerType==="mouse"||Oe.sourceCapabilities&&!Oe.sourceCapabilities.firesTouchEvents)){var lt=jc(Oe);if(!(lt.some(function(Ht){return Ht instanceof HTMLLabelElement&&Ht.attributes.for})&&!lt.some(function(Ht){return Ht instanceof HTMLInputElement||Ht instanceof HTMLSelectElement}))){var Rt=Date.now();Rt-U<=no?(ne++,ne===2&&I(mi(Oe))):ne=1,U=Rt}}}return x.addEventListener("click",pe),{dblclick:I,simDblclick:pe}}function jo(x,I){x.removeEventListener("dblclick",I.dblclick),x.removeEventListener("click",I.simDblclick)}var $o=Pa(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Cs=Pa(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ma=Cs==="webkitTransition"||Cs==="OTransition"?Cs+"End":"transitionend";function ga(x){return typeof x=="string"?document.getElementById(x):x}function xo(x,I){var U=x.style[I]||x.currentStyle&&x.currentStyle[I];if((!U||U==="auto")&&document.defaultView){var ne=document.defaultView.getComputedStyle(x,null);U=ne?ne[I]:null}return U==="auto"?null:U}function kr(x,I,U){var ne=document.createElement(x);return ne.className=I||"",U&&U.appendChild(ne),ne}function Gi(x){var I=x.parentNode;I&&I.removeChild(x)}function Il(x){for(;x.firstChild;)x.removeChild(x.firstChild)}function Ml(x){var I=x.parentNode;I&&I.lastChild!==x&&I.appendChild(x)}function rl(x){var I=x.parentNode;I&&I.firstChild!==x&&I.insertBefore(x,I.firstChild)}function mh(x,I){if(x.classList!==void 0)return x.classList.contains(I);var U=gh(x);return U.length>0&&new RegExp("(^|\\s)"+I+"(\\s|$)").test(U)}function Wr(x,I){if(x.classList!==void 0)for(var U=B(I),ne=0,pe=U.length;ne<pe;ne++)x.classList.add(U[ne]);else if(!mh(x,I)){var Oe=gh(x);mu(x,(Oe?Oe+" ":"")+I)}}function co(x,I){x.classList!==void 0?x.classList.remove(I):mu(x,R((" "+gh(x)+" ").replace(" "+I+" "," ")))}function mu(x,I){x.className.baseVal===void 0?x.className=I:x.className.baseVal=I}function gh(x){return x.correspondingElement&&(x=x.correspondingElement),x.className.baseVal===void 0?x.className:x.className.baseVal}function Mo(x,I){"opacity"in x.style?x.style.opacity=I:"filter"in x.style&&Mm(x,I)}function Mm(x,I){var U=!1,ne="DXImageTransform.Microsoft.Alpha";try{U=x.filters.item(ne)}catch{if(I===1)return}I=Math.round(I*100),U?(U.Enabled=I!==100,U.Opacity=I):x.style.filter+=" progid:"+ne+"(opacity="+I+")"}function Pa(x){for(var I=document.documentElement.style,U=0;U<x.length;U++)if(x[U]in I)return x[U];return!1}function Ca(x,I,U){var ne=I||new Be(0,0);x.style[$o]=($e.ie3d?"translate("+ne.x+"px,"+ne.y+"px)":"translate3d("+ne.x+"px,"+ne.y+"px,0)")+(U?" scale("+U+")":"")}function ro(x,I){x._leaflet_pos=I,$e.any3d?Ca(x,I):(x.style.left=I.x+"px",x.style.top=I.y+"px")}function Ia(x){return x._leaflet_pos||new Be(0,0)}var Is,Va,gu;if("onselectstart"in document)Is=function(){Fr(window,"selectstart",ya)},Va=function(){Hn(window,"selectstart",ya)};else{var _u=Pa(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Is=function(){if(_u){var x=document.documentElement.style;gu=x[_u],x[_u]="none"}},Va=function(){_u&&(document.documentElement.style[_u]=gu,gu=void 0)}}function il(){Fr(window,"dragstart",ya)}function yu(){Hn(window,"dragstart",ya)}var _h,vu;function _a(x){for(;x.tabIndex===-1;)x=x.parentNode;x.style&&(xu(),_h=x,vu=x.style.outlineStyle,x.style.outlineStyle="none",Fr(window,"keydown",xu))}function xu(){_h&&(_h.style.outlineStyle=vu,_h=void 0,vu=void 0,Hn(window,"keydown",xu))}function ud(x){do x=x.parentNode;while((!x.offsetWidth||!x.offsetHeight)&&x!==document.body);return x}function Fc(x){var I=x.getBoundingClientRect();return{x:I.width/x.offsetWidth||1,y:I.height/x.offsetHeight||1,boundingClientRect:I}}var R_={__proto__:null,TRANSFORM:$o,TRANSITION:Cs,TRANSITION_END:ma,get:ga,getStyle:xo,create:kr,remove:Gi,empty:Il,toFront:Ml,toBack:rl,hasClass:mh,addClass:Wr,removeClass:co,setClass:mu,getClass:gh,setOpacity:Mo,testProp:Pa,setTransform:Ca,setPosition:ro,getPosition:Ia,get disableTextSelection(){return Is},get enableTextSelection(){return Va},disableImageDrag:il,enableImageDrag:yu,preventOutline:_a,restoreOutline:xu,getSizedParentNode:ud,getScale:Fc};function Fr(x,I,U,ne){if(I&&typeof I=="object")for(var pe in I)Om(x,pe,I[pe],U);else{I=B(I);for(var Oe=0,lt=I.length;Oe<lt;Oe++)Om(x,I[Oe],U,ne)}return this}var Ms="_leaflet_events";function Hn(x,I,U,ne){if(arguments.length===1)bu(x),delete x[Ms];else if(I&&typeof I=="object")for(var pe in I)Pf(x,pe,I[pe],U);else if(I=B(I),arguments.length===2)bu(x,function(Rt){return Q(I,Rt)!==-1});else for(var Oe=0,lt=I.length;Oe<lt;Oe++)Pf(x,I[Oe],U,ne);return this}function bu(x,I){for(var U in x[Ms]){var ne=U.split(/\d/)[0];(!I||I(ne))&&Pf(x,ne,null,null,U)}}var Bc={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Om(x,I,U,ne){var pe=I+_(U)+(ne?"_"+_(ne):"");if(x[Ms]&&x[Ms][pe])return this;var Oe=function(Rt){return U.call(ne||x,Rt||window.event)},lt=Oe;!$e.touchNative&&$e.pointer&&I.indexOf("touch")===0?Oe=er(x,I,Oe):$e.touch&&I==="dblclick"?Oe=vo(x,Oe):"addEventListener"in x?I==="touchstart"||I==="touchmove"||I==="wheel"||I==="mousewheel"?x.addEventListener(Bc[I]||I,Oe,$e.passiveEvents?{passive:!1}:!1):I==="mouseenter"||I==="mouseleave"?(Oe=function(Rt){Rt=Rt||window.event,dd(x,Rt)&&lt(Rt)},x.addEventListener(Bc[I],Oe,!1)):x.addEventListener(I,lt,!1):x.attachEvent("on"+I,Oe),x[Ms]=x[Ms]||{},x[Ms][pe]=Oe}function Pf(x,I,U,ne,pe){pe=pe||I+_(U)+(ne?"_"+_(ne):"");var Oe=x[Ms]&&x[Ms][pe];if(!Oe)return this;!$e.touchNative&&$e.pointer&&I.indexOf("touch")===0?or(x,I,Oe):$e.touch&&I==="dblclick"?jo(x,Oe):"removeEventListener"in x?x.removeEventListener(Bc[I]||I,Oe,!1):x.detachEvent("on"+I,Oe),x[Ms][pe]=null}function Os(x){return x.stopPropagation?x.stopPropagation():x.originalEvent?x.originalEvent._stopped=!0:x.cancelBubble=!0,this}function Ol(x){return Om(x,"wheel",Os),this}function kl(x){return Fr(x,"mousedown touchstart dblclick contextmenu",Os),x._leaflet_disable_click=!0,this}function ya(x){return x.preventDefault?x.preventDefault():x.returnValue=!1,this}function rc(x){return ya(x),Os(x),this}function jc(x){if(x.composedPath)return x.composedPath();for(var I=[],U=x.target;U;)I.push(U),U=U.parentNode;return I}function yh(x,I){if(!I)return new Be(x.clientX,x.clientY);var U=Fc(I),ne=U.boundingClientRect;return new Be((x.clientX-ne.left)/U.x-I.clientLeft,(x.clientY-ne.top)/U.y-I.clientTop)}var vh=$e.linux&&$e.chrome?window.devicePixelRatio:$e.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function hd(x){return $e.edge?x.wheelDeltaY/2:x.deltaY&&x.deltaMode===0?-x.deltaY/vh:x.deltaY&&x.deltaMode===1?-x.deltaY*20:x.deltaY&&x.deltaMode===2?-x.deltaY*60:x.deltaX||x.deltaZ?0:x.wheelDelta?(x.wheelDeltaY||x.wheelDelta)/2:x.detail&&Math.abs(x.detail)<32765?-x.detail*20:x.detail?x.detail/-32765*60:0}function dd(x,I){var U=I.relatedTarget;if(!U)return!0;try{for(;U&&U!==x;)U=U.parentNode}catch{return!1}return U!==x}var ds={__proto__:null,on:Fr,off:Hn,stopPropagation:Os,disableScrollPropagation:Ol,disableClickPropagation:kl,preventDefault:ya,stop:rc,getPropagationPath:jc,getMousePosition:yh,getWheelDelta:hd,isExternalTarget:dd,addListener:Fr,removeListener:Hn},ic=rt.extend({run:function(x,I,U,ne){this.stop(),this._el=x,this._inProgress=!0,this._duration=U||.25,this._easeOutPower=1/Math.max(ne||.5,.2),this._startPos=Ia(x),this._offset=I.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Fe(this._animate,this),this._step()},_step:function(x){var I=+new Date-this._startTime,U=this._duration*1e3;I<U?this._runFrame(this._easeOut(I/U),x):(this._runFrame(1),this._complete())},_runFrame:function(x,I){var U=this._startPos.add(this._offset.multiplyBy(x));I&&U._round(),ro(this._el,U),this.fire("step")},_complete:function(){Le(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(x){return 1-Math.pow(1-x,this._easeOutPower)}}),Ei=rt.extend({options:{crs:In,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(x,I){I=N(this,I),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(x),this._initLayout(),this._onResize=d(this._onResize,this),this._initEvents(),I.maxBounds&&this.setMaxBounds(I.maxBounds),I.zoom!==void 0&&(this._zoom=this._limitZoom(I.zoom)),I.center&&I.zoom!==void 0&&this.setView(sn(I.center),I.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Cs&&$e.any3d&&!$e.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Fr(this._proxy,ma,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(x,I,U){if(I=I===void 0?this._zoom:this._limitZoom(I),x=this._limitCenter(sn(x),I,this.options.maxBounds),U=U||{},this._stop(),this._loaded&&!U.reset&&U!==!0){U.animate!==void 0&&(U.zoom=a({animate:U.animate},U.zoom),U.pan=a({animate:U.animate,duration:U.duration},U.pan));var ne=this._zoom!==I?this._tryAnimatedZoom&&this._tryAnimatedZoom(x,I,U.zoom):this._tryAnimatedPan(x,U.pan);if(ne)return clearTimeout(this._sizeTimer),this}return this._resetView(x,I,U.pan&&U.pan.noMoveStart),this},setZoom:function(x,I){return this._loaded?this.setView(this.getCenter(),x,{zoom:I}):(this._zoom=x,this)},zoomIn:function(x,I){return x=x||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+x,I)},zoomOut:function(x,I){return x=x||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-x,I)},setZoomAround:function(x,I,U){var ne=this.getZoomScale(I),pe=this.getSize().divideBy(2),Oe=x instanceof Be?x:this.latLngToContainerPoint(x),lt=Oe.subtract(pe).multiplyBy(1-1/ne),Rt=this.containerPointToLatLng(pe.add(lt));return this.setView(Rt,I,{zoom:U})},_getBoundsCenterZoom:function(x,I){I=I||{},x=x.getBounds?x.getBounds():un(x);var U=at(I.paddingTopLeft||I.padding||[0,0]),ne=at(I.paddingBottomRight||I.padding||[0,0]),pe=this.getBoundsZoom(x,!1,U.add(ne));if(pe=typeof I.maxZoom=="number"?Math.min(I.maxZoom,pe):pe,pe===1/0)return{center:x.getCenter(),zoom:pe};var Oe=ne.subtract(U).divideBy(2),lt=this.project(x.getSouthWest(),pe),Rt=this.project(x.getNorthEast(),pe),Ht=this.unproject(lt.add(Rt).divideBy(2).add(Oe),pe);return{center:Ht,zoom:pe}},fitBounds:function(x,I){if(x=un(x),!x.isValid())throw new Error("Bounds are not valid.");var U=this._getBoundsCenterZoom(x,I);return this.setView(U.center,U.zoom,I)},fitWorld:function(x){return this.fitBounds([[-90,-180],[90,180]],x)},panTo:function(x,I){return this.setView(x,this._zoom,{pan:I})},panBy:function(x,I){if(x=at(x).round(),I=I||{},!x.x&&!x.y)return this.fire("moveend");if(I.animate!==!0&&!this.getSize().contains(x))return this._resetView(this.unproject(this.project(this.getCenter()).add(x)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ic,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),I.noMoveStart||this.fire("movestart"),I.animate!==!1){Wr(this._mapPane,"leaflet-pan-anim");var U=this._getMapPanePos().subtract(x).round();this._panAnim.run(this._mapPane,U,I.duration||.25,I.easeLinearity)}else this._rawPanBy(x),this.fire("move").fire("moveend");return this},flyTo:function(x,I,U){if(U=U||{},U.animate===!1||!$e.any3d)return this.setView(x,I,U);this._stop();var ne=this.project(this.getCenter()),pe=this.project(x),Oe=this.getSize(),lt=this._zoom;x=sn(x),I=I===void 0?lt:I;var Rt=Math.max(Oe.x,Oe.y),Ht=Rt*this.getZoomScale(lt,I),bn=pe.distanceTo(ne)||1,Yn=1.42,Ir=Yn*Yn;function Yr(Jo){var Ch=Jo?-1:1,px=Jo?Ht:Rt,jf=Ht*Ht-Rt*Rt+Ch*Ir*Ir*bn*bn,Wm=2*px*Ir*bn,Sd=jf/Wm,$f=Math.sqrt(Sd*Sd+1)-Sd,Gm=$f<1e-9?-18:Math.log($f);return Gm}function va(Jo){return(Math.exp(Jo)-Math.exp(-Jo))/2}function Yo(Jo){return(Math.exp(Jo)+Math.exp(-Jo))/2}function Ds(Jo){return va(Jo)/Yo(Jo)}var Ga=Yr(0);function mc(Jo){return Rt*(Yo(Ga)/Yo(Ga+Yn*Jo))}function wd(Jo){return Rt*(Yo(Ga)*Ds(Ga+Yn*Jo)-va(Ga))/Ir}function V_(Jo){return 1-Math.pow(1-Jo,1.5)}var W_=Date.now(),Um=(Yr(1)-Ga)/Yn,Ph=U.duration?1e3*U.duration:1e3*Um*.8;function Vm(){var Jo=(Date.now()-W_)/Ph,Ch=V_(Jo)*Um;Jo<=1?(this._flyToFrame=Fe(Vm,this),this._move(this.unproject(ne.add(pe.subtract(ne).multiplyBy(wd(Ch)/bn)),lt),this.getScaleZoom(Rt/mc(Ch),lt),{flyTo:!0})):this._move(x,I)._moveEnd(!0)}return this._moveStart(!0,U.noMoveStart),Vm.call(this),this},flyToBounds:function(x,I){var U=this._getBoundsCenterZoom(x,I);return this.flyTo(U.center,U.zoom,I)},setMaxBounds:function(x){return x=un(x),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),x.isValid()?(this.options.maxBounds=x,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(x){var I=this.options.minZoom;return this.options.minZoom=x,this._loaded&&I!==x&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(x):this},setMaxZoom:function(x){var I=this.options.maxZoom;return this.options.maxZoom=x,this._loaded&&I!==x&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(x):this},panInsideBounds:function(x,I){this._enforcingBounds=!0;var U=this.getCenter(),ne=this._limitCenter(U,this._zoom,un(x));return U.equals(ne)||this.panTo(ne,I),this._enforcingBounds=!1,this},panInside:function(x,I){I=I||{};var U=at(I.paddingTopLeft||I.padding||[0,0]),ne=at(I.paddingBottomRight||I.padding||[0,0]),pe=this.project(this.getCenter()),Oe=this.project(x),lt=this.getPixelBounds(),Rt=Nt([lt.min.add(U),lt.max.subtract(ne)]),Ht=Rt.getSize();if(!Rt.contains(Oe)){this._enforcingBounds=!0;var bn=Oe.subtract(Rt.getCenter()),Yn=Rt.extend(Oe).getSize().subtract(Ht);pe.x+=bn.x<0?-Yn.x:Yn.x,pe.y+=bn.y<0?-Yn.y:Yn.y,this.panTo(this.unproject(pe),I),this._enforcingBounds=!1}return this},invalidateSize:function(x){if(!this._loaded)return this;x=a({animate:!1,pan:!0},x===!0?{animate:!0}:x);var I=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var U=this.getSize(),ne=I.divideBy(2).round(),pe=U.divideBy(2).round(),Oe=ne.subtract(pe);return!Oe.x&&!Oe.y?this:(x.animate&&x.pan?this.panBy(Oe):(x.pan&&this._rawPanBy(Oe),this.fire("move"),x.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:I,newSize:U}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(x){if(x=this._locateOptions=a({timeout:1e4,watch:!1},x),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var I=d(this._handleGeolocationResponse,this),U=d(this._handleGeolocationError,this);return x.watch?this._locationWatchId=navigator.geolocation.watchPosition(I,U,x):navigator.geolocation.getCurrentPosition(I,U,x),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(x){if(this._container._leaflet_id){var I=x.code,U=x.message||(I===1?"permission denied":I===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:I,message:"Geolocation error: "+U+"."})}},_handleGeolocationResponse:function(x){if(this._container._leaflet_id){var I=x.coords.latitude,U=x.coords.longitude,ne=new en(I,U),pe=ne.toBounds(x.coords.accuracy*2),Oe=this._locateOptions;if(Oe.setView){var lt=this.getBoundsZoom(pe);this.setView(ne,Oe.maxZoom?Math.min(lt,Oe.maxZoom):lt)}var Rt={latlng:ne,bounds:pe,timestamp:x.timestamp};for(var Ht in x.coords)typeof x.coords[Ht]=="number"&&(Rt[Ht]=x.coords[Ht]);this.fire("locationfound",Rt)}},addHandler:function(x,I){if(!I)return this;var U=this[x]=new I(this);return this._handlers.push(U),this.options[x]&&U.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Gi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Le(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var x;for(x in this._layers)this._layers[x].remove();for(x in this._panes)Gi(this._panes[x]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(x,I){var U="leaflet-pane"+(x?" leaflet-"+x.replace("Pane","")+"-pane":""),ne=kr("div",U,I||this._mapPane);return x&&(this._panes[x]=ne),ne},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var x=this.getPixelBounds(),I=this.unproject(x.getBottomLeft()),U=this.unproject(x.getTopRight());return new rn(I,U)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(x,I,U){x=un(x),U=at(U||[0,0]);var ne=this.getZoom()||0,pe=this.getMinZoom(),Oe=this.getMaxZoom(),lt=x.getNorthWest(),Rt=x.getSouthEast(),Ht=this.getSize().subtract(U),bn=Nt(this.project(Rt,ne),this.project(lt,ne)).getSize(),Yn=$e.any3d?this.options.zoomSnap:1,Ir=Ht.x/bn.x,Yr=Ht.y/bn.y,va=I?Math.max(Ir,Yr):Math.min(Ir,Yr);return ne=this.getScaleZoom(va,ne),Yn&&(ne=Math.round(ne/(Yn/100))*(Yn/100),ne=I?Math.ceil(ne/Yn)*Yn:Math.floor(ne/Yn)*Yn),Math.max(pe,Math.min(Oe,ne))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Be(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(x,I){var U=this._getTopLeftPoint(x,I);return new Mt(U,U.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(x){return this.options.crs.getProjectedBounds(x===void 0?this.getZoom():x)},getPane:function(x){return typeof x=="string"?this._panes[x]:x},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(x,I){var U=this.options.crs;return I=I===void 0?this._zoom:I,U.scale(x)/U.scale(I)},getScaleZoom:function(x,I){var U=this.options.crs;I=I===void 0?this._zoom:I;var ne=U.zoom(x*U.scale(I));return isNaN(ne)?1/0:ne},project:function(x,I){return I=I===void 0?this._zoom:I,this.options.crs.latLngToPoint(sn(x),I)},unproject:function(x,I){return I=I===void 0?this._zoom:I,this.options.crs.pointToLatLng(at(x),I)},layerPointToLatLng:function(x){var I=at(x).add(this.getPixelOrigin());return this.unproject(I)},latLngToLayerPoint:function(x){var I=this.project(sn(x))._round();return I._subtract(this.getPixelOrigin())},wrapLatLng:function(x){return this.options.crs.wrapLatLng(sn(x))},wrapLatLngBounds:function(x){return this.options.crs.wrapLatLngBounds(un(x))},distance:function(x,I){return this.options.crs.distance(sn(x),sn(I))},containerPointToLayerPoint:function(x){return at(x).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(x){return at(x).add(this._getMapPanePos())},containerPointToLatLng:function(x){var I=this.containerPointToLayerPoint(at(x));return this.layerPointToLatLng(I)},latLngToContainerPoint:function(x){return this.layerPointToContainerPoint(this.latLngToLayerPoint(sn(x)))},mouseEventToContainerPoint:function(x){return yh(x,this._container)},mouseEventToLayerPoint:function(x){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(x))},mouseEventToLatLng:function(x){return this.layerPointToLatLng(this.mouseEventToLayerPoint(x))},_initContainer:function(x){var I=this._container=ga(x);if(I){if(I._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Fr(I,"scroll",this._onScroll,this),this._containerId=_(I)},_initLayout:function(){var x=this._container;this._fadeAnimated=this.options.fadeAnimation&&$e.any3d,Wr(x,"leaflet-container"+($e.touch?" leaflet-touch":"")+($e.retina?" leaflet-retina":"")+($e.ielt9?" leaflet-oldie":"")+($e.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var I=xo(x,"position");I!=="absolute"&&I!=="relative"&&I!=="fixed"&&I!=="sticky"&&(x.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var x=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ro(this._mapPane,new Be(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Wr(x.markerPane,"leaflet-zoom-hide"),Wr(x.shadowPane,"leaflet-zoom-hide"))},_resetView:function(x,I,U){ro(this._mapPane,new Be(0,0));var ne=!this._loaded;this._loaded=!0,I=this._limitZoom(I),this.fire("viewprereset");var pe=this._zoom!==I;this._moveStart(pe,U)._move(x,I)._moveEnd(pe),this.fire("viewreset"),ne&&this.fire("load")},_moveStart:function(x,I){return x&&this.fire("zoomstart"),I||this.fire("movestart"),this},_move:function(x,I,U,ne){I===void 0&&(I=this._zoom);var pe=this._zoom!==I;return this._zoom=I,this._lastCenter=x,this._pixelOrigin=this._getNewPixelOrigin(x),ne?U&&U.pinch&&this.fire("zoom",U):((pe||U&&U.pinch)&&this.fire("zoom",U),this.fire("move",U)),this},_moveEnd:function(x){return x&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Le(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(x){ro(this._mapPane,this._getMapPanePos().subtract(x))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(x){this._targets={},this._targets[_(this._container)]=this;var I=x?Hn:Fr;I(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&I(window,"resize",this._onResize,this),$e.any3d&&this.options.transform3DLimit&&(x?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Le(this._resizeRequest),this._resizeRequest=Fe(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var x=this._getMapPanePos();Math.max(Math.abs(x.x),Math.abs(x.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(x,I){for(var U=[],ne,pe=I==="mouseout"||I==="mouseover",Oe=x.target||x.srcElement,lt=!1;Oe;){if(ne=this._targets[_(Oe)],ne&&(I==="click"||I==="preclick")&&this._draggableMoved(ne)){lt=!0;break}if(ne&&ne.listens(I,!0)&&(pe&&!dd(Oe,x)||(U.push(ne),pe))||Oe===this._container)break;Oe=Oe.parentNode}return!U.length&&!lt&&!pe&&this.listens(I,!0)&&(U=[this]),U},_isClickDisabled:function(x){for(;x&&x!==this._container;){if(x._leaflet_disable_click)return!0;x=x.parentNode}},_handleDOMEvent:function(x){var I=x.target||x.srcElement;if(!(!this._loaded||I._leaflet_disable_events||x.type==="click"&&this._isClickDisabled(I))){var U=x.type;U==="mousedown"&&_a(I),this._fireDOMEvent(x,U)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(x,I,U){if(x.type==="click"){var ne=a({},x);ne.type="preclick",this._fireDOMEvent(ne,ne.type,U)}var pe=this._findEventTargets(x,I);if(U){for(var Oe=[],lt=0;lt<U.length;lt++)U[lt].listens(I,!0)&&Oe.push(U[lt]);pe=Oe.concat(pe)}if(pe.length){I==="contextmenu"&&ya(x);var Rt=pe[0],Ht={originalEvent:x};if(x.type!=="keypress"&&x.type!=="keydown"&&x.type!=="keyup"){var bn=Rt.getLatLng&&(!Rt._radius||Rt._radius<=10);Ht.containerPoint=bn?this.latLngToContainerPoint(Rt.getLatLng()):this.mouseEventToContainerPoint(x),Ht.layerPoint=this.containerPointToLayerPoint(Ht.containerPoint),Ht.latlng=bn?Rt.getLatLng():this.layerPointToLatLng(Ht.layerPoint)}for(lt=0;lt<pe.length;lt++)if(pe[lt].fire(I,Ht,!0),Ht.originalEvent._stopped||pe[lt].options.bubblingMouseEvents===!1&&Q(this._mouseEvents,I)!==-1)return}},_draggableMoved:function(x){return x=x.dragging&&x.dragging.enabled()?x:this,x.dragging&&x.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var x=0,I=this._handlers.length;x<I;x++)this._handlers[x].disable()},whenReady:function(x,I){return this._loaded?x.call(I||this,{target:this}):this.on("load",x,I),this},_getMapPanePos:function(){return Ia(this._mapPane)||new Be(0,0)},_moved:function(){var x=this._getMapPanePos();return x&&!x.equals([0,0])},_getTopLeftPoint:function(x,I){var U=x&&I!==void 0?this._getNewPixelOrigin(x,I):this.getPixelOrigin();return U.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(x,I){var U=this.getSize()._divideBy(2);return this.project(x,I)._subtract(U)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(x,I,U){var ne=this._getNewPixelOrigin(U,I);return this.project(x,I)._subtract(ne)},_latLngBoundsToNewLayerBounds:function(x,I,U){var ne=this._getNewPixelOrigin(U,I);return Nt([this.project(x.getSouthWest(),I)._subtract(ne),this.project(x.getNorthWest(),I)._subtract(ne),this.project(x.getSouthEast(),I)._subtract(ne),this.project(x.getNorthEast(),I)._subtract(ne)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(x){return this.latLngToLayerPoint(x).subtract(this._getCenterLayerPoint())},_limitCenter:function(x,I,U){if(!U)return x;var ne=this.project(x,I),pe=this.getSize().divideBy(2),Oe=new Mt(ne.subtract(pe),ne.add(pe)),lt=this._getBoundsOffset(Oe,U,I);return Math.abs(lt.x)<=1&&Math.abs(lt.y)<=1?x:this.unproject(ne.add(lt),I)},_limitOffset:function(x,I){if(!I)return x;var U=this.getPixelBounds(),ne=new Mt(U.min.add(x),U.max.add(x));return x.add(this._getBoundsOffset(ne,I))},_getBoundsOffset:function(x,I,U){var ne=Nt(this.project(I.getNorthEast(),U),this.project(I.getSouthWest(),U)),pe=ne.min.subtract(x.min),Oe=ne.max.subtract(x.max),lt=this._rebound(pe.x,-Oe.x),Rt=this._rebound(pe.y,-Oe.y);return new Be(lt,Rt)},_rebound:function(x,I){return x+I>0?Math.round(x-I)/2:Math.max(0,Math.ceil(x))-Math.max(0,Math.floor(I))},_limitZoom:function(x){var I=this.getMinZoom(),U=this.getMaxZoom(),ne=$e.any3d?this.options.zoomSnap:1;return ne&&(x=Math.round(x/ne)*ne),Math.max(I,Math.min(U,x))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){co(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(x,I){var U=this._getCenterOffset(x)._trunc();return(I&&I.animate)!==!0&&!this.getSize().contains(U)?!1:(this.panBy(U,I),!0)},_createAnimProxy:function(){var x=this._proxy=kr("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(x),this.on("zoomanim",function(I){var U=$o,ne=this._proxy.style[U];Ca(this._proxy,this.project(I.center,I.zoom),this.getZoomScale(I.zoom,1)),ne===this._proxy.style[U]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Gi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var x=this.getCenter(),I=this.getZoom();Ca(this._proxy,this.project(x,I),this.getZoomScale(I,1))},_catchTransitionEnd:function(x){this._animatingZoom&&x.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(x,I,U){if(this._animatingZoom)return!0;if(U=U||{},!this._zoomAnimated||U.animate===!1||this._nothingToAnimate()||Math.abs(I-this._zoom)>this.options.zoomAnimationThreshold)return!1;var ne=this.getZoomScale(I),pe=this._getCenterOffset(x)._divideBy(1-1/ne);return U.animate!==!0&&!this.getSize().contains(pe)?!1:(Fe(function(){this._moveStart(!0,U.noMoveStart||!1)._animateZoom(x,I,!0)},this),!0)},_animateZoom:function(x,I,U,ne){this._mapPane&&(U&&(this._animatingZoom=!0,this._animateToCenter=x,this._animateToZoom=I,Wr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:x,zoom:I,noUpdate:ne}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(d(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&co(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function km(x,I){return new Ei(x,I)}var fs=He.extend({options:{position:"topright"},initialize:function(x){N(this,x)},getPosition:function(){return this.options.position},setPosition:function(x){var I=this._map;return I&&I.removeControl(this),this.options.position=x,I&&I.addControl(this),this},getContainer:function(){return this._container},addTo:function(x){this.remove(),this._map=x;var I=this._container=this.onAdd(x),U=this.getPosition(),ne=x._controlCorners[U];return Wr(I,"leaflet-control"),U.indexOf("bottom")!==-1?ne.insertBefore(I,ne.firstChild):ne.appendChild(I),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Gi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(x){this._map&&x&&x.screenX>0&&x.screenY>0&&this._map.getContainer().focus()}}),ol=function(x){return new fs(x)};Ei.include({addControl:function(x){return x.addTo(this),this},removeControl:function(x){return x.remove(),this},_initControlPos:function(){var x=this._controlCorners={},I="leaflet-",U=this._controlContainer=kr("div",I+"control-container",this._container);function ne(pe,Oe){var lt=I+pe+" "+I+Oe;x[pe+Oe]=kr("div",lt,U)}ne("top","left"),ne("top","right"),ne("bottom","left"),ne("bottom","right")},_clearControlPos:function(){for(var x in this._controlCorners)Gi(this._controlCorners[x]);Gi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ts=fs.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(x,I,U,ne){return U<ne?-1:ne<U?1:0}},initialize:function(x,I,U){N(this,U),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var ne in x)this._addLayer(x[ne],ne);for(ne in I)this._addLayer(I[ne],ne,!0)},onAdd:function(x){this._initLayout(),this._update(),this._map=x,x.on("zoomend",this._checkDisabledLayers,this);for(var I=0;I<this._layers.length;I++)this._layers[I].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(x){return fs.prototype.addTo.call(this,x),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var x=0;x<this._layers.length;x++)this._layers[x].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(x,I){return this._addLayer(x,I),this._map?this._update():this},addOverlay:function(x,I){return this._addLayer(x,I,!0),this._map?this._update():this},removeLayer:function(x){x.off("add remove",this._onLayerChange,this);var I=this._getLayer(_(x));return I&&this._layers.splice(this._layers.indexOf(I),1),this._map?this._update():this},expand:function(){Wr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var x=this._map.getSize().y-(this._container.offsetTop+50);return x<this._section.clientHeight?(Wr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=x+"px"):co(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return co(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var x="leaflet-control-layers",I=this._container=kr("div",x),U=this.options.collapsed;I.setAttribute("aria-haspopup",!0),kl(I),Ol(I);var ne=this._section=kr("section",x+"-list");U&&(this._map.on("click",this.collapse,this),Fr(I,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var pe=this._layersLink=kr("a",x+"-toggle",I);pe.href="#",pe.title="Layers",pe.setAttribute("role","button"),Fr(pe,{keydown:function(Oe){Oe.keyCode===13&&this._expandSafely()},click:function(Oe){ya(Oe),this._expandSafely()}},this),U||this.expand(),this._baseLayersList=kr("div",x+"-base",ne),this._separator=kr("div",x+"-separator",ne),this._overlaysList=kr("div",x+"-overlays",ne),I.appendChild(ne)},_getLayer:function(x){for(var I=0;I<this._layers.length;I++)if(this._layers[I]&&_(this._layers[I].layer)===x)return this._layers[I]},_addLayer:function(x,I,U){this._map&&x.on("add remove",this._onLayerChange,this),this._layers.push({layer:x,name:I,overlay:U}),this.options.sortLayers&&this._layers.sort(d(function(ne,pe){return this.options.sortFunction(ne.layer,pe.layer,ne.name,pe.name)},this)),this.options.autoZIndex&&x.setZIndex&&(this._lastZIndex++,x.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Il(this._baseLayersList),Il(this._overlaysList),this._layerControlInputs=[];var x,I,U,ne,pe=0;for(U=0;U<this._layers.length;U++)ne=this._layers[U],this._addItem(ne),I=I||ne.overlay,x=x||!ne.overlay,pe+=ne.overlay?0:1;return this.options.hideSingleBase&&(x=x&&pe>1,this._baseLayersList.style.display=x?"":"none"),this._separator.style.display=I&&x?"":"none",this},_onLayerChange:function(x){this._handlingClick||this._update();var I=this._getLayer(_(x.target)),U=I.overlay?x.type==="add"?"overlayadd":"overlayremove":x.type==="add"?"baselayerchange":null;U&&this._map.fire(U,I)},_createRadioElement:function(x,I){var U='<input type="radio" class="leaflet-control-layers-selector" name="'+x+'"'+(I?' checked="checked"':"")+"/>",ne=document.createElement("div");return ne.innerHTML=U,ne.firstChild},_addItem:function(x){var I=document.createElement("label"),U=this._map.hasLayer(x.layer),ne;x.overlay?(ne=document.createElement("input"),ne.type="checkbox",ne.className="leaflet-control-layers-selector",ne.defaultChecked=U):ne=this._createRadioElement("leaflet-base-layers_"+_(this),U),this._layerControlInputs.push(ne),ne.layerId=_(x.layer),Fr(ne,"click",this._onInputClick,this);var pe=document.createElement("span");pe.innerHTML=" "+x.name;var Oe=document.createElement("span");I.appendChild(Oe),Oe.appendChild(ne),Oe.appendChild(pe);var lt=x.overlay?this._overlaysList:this._baseLayersList;return lt.appendChild(I),this._checkDisabledLayers(),I},_onInputClick:function(){if(!this._preventClick){var x=this._layerControlInputs,I,U,ne=[],pe=[];this._handlingClick=!0;for(var Oe=x.length-1;Oe>=0;Oe--)I=x[Oe],U=this._getLayer(I.layerId).layer,I.checked?ne.push(U):I.checked||pe.push(U);for(Oe=0;Oe<pe.length;Oe++)this._map.hasLayer(pe[Oe])&&this._map.removeLayer(pe[Oe]);for(Oe=0;Oe<ne.length;Oe++)this._map.hasLayer(ne[Oe])||this._map.addLayer(ne[Oe]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var x=this._layerControlInputs,I,U,ne=this._map.getZoom(),pe=x.length-1;pe>=0;pe--)I=x[pe],U=this._getLayer(I.layerId).layer,I.disabled=U.options.minZoom!==void 0&&ne<U.options.minZoom||U.options.maxZoom!==void 0&&ne>U.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var x=this._section;this._preventClick=!0,Fr(x,"click",ya),this.expand();var I=this;setTimeout(function(){Hn(x,"click",ya),I._preventClick=!1})}}),Rm=function(x,I,U){return new ts(x,I,U)},xh=fs.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(x){var I="leaflet-control-zoom",U=kr("div",I+" leaflet-bar"),ne=this.options;return this._zoomInButton=this._createButton(ne.zoomInText,ne.zoomInTitle,I+"-in",U,this._zoomIn),this._zoomOutButton=this._createButton(ne.zoomOutText,ne.zoomOutTitle,I+"-out",U,this._zoomOut),this._updateDisabled(),x.on("zoomend zoomlevelschange",this._updateDisabled,this),U},onRemove:function(x){x.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(x){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(x.shiftKey?3:1))},_zoomOut:function(x){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(x.shiftKey?3:1))},_createButton:function(x,I,U,ne,pe){var Oe=kr("a",U,ne);return Oe.innerHTML=x,Oe.href="#",Oe.title=I,Oe.setAttribute("role","button"),Oe.setAttribute("aria-label",I),kl(Oe),Fr(Oe,"click",rc),Fr(Oe,"click",pe,this),Fr(Oe,"click",this._refocusOnMap,this),Oe},_updateDisabled:function(){var x=this._map,I="leaflet-disabled";co(this._zoomInButton,I),co(this._zoomOutButton,I),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||x._zoom===x.getMinZoom())&&(Wr(this._zoomOutButton,I),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||x._zoom===x.getMaxZoom())&&(Wr(this._zoomInButton,I),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ei.mergeOptions({zoomControl:!0}),Ei.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xh,this.addControl(this.zoomControl))});var fd=function(x){return new xh(x)},Dr=fs.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(x){var I="leaflet-control-scale",U=kr("div",I),ne=this.options;return this._addScales(ne,I+"-line",U),x.on(ne.updateWhenIdle?"moveend":"move",this._update,this),x.whenReady(this._update,this),U},onRemove:function(x){x.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(x,I,U){x.metric&&(this._mScale=kr("div",I,U)),x.imperial&&(this._iScale=kr("div",I,U))},_update:function(){var x=this._map,I=x.getSize().y/2,U=x.distance(x.containerPointToLatLng([0,I]),x.containerPointToLatLng([this.options.maxWidth,I]));this._updateScales(U)},_updateScales:function(x){this.options.metric&&x&&this._updateMetric(x),this.options.imperial&&x&&this._updateImperial(x)},_updateMetric:function(x){var I=this._getRoundNum(x),U=I<1e3?I+" m":I/1e3+" km";this._updateScale(this._mScale,U,I/x)},_updateImperial:function(x){var I=x*3.2808399,U,ne,pe;I>5280?(U=I/5280,ne=this._getRoundNum(U),this._updateScale(this._iScale,ne+" mi",ne/U)):(pe=this._getRoundNum(I),this._updateScale(this._iScale,pe+" ft",pe/I))},_updateScale:function(x,I,U){x.style.width=Math.round(this.options.maxWidth*U)+"px",x.innerHTML=I},_getRoundNum:function(x){var I=Math.pow(10,(Math.floor(x)+"").length-1),U=x/I;return U=U>=10?10:U>=5?5:U>=3?3:U>=2?2:1,I*U}}),D_=function(x){return new Dr(x)},kn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Cf=fs.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+($e.inlineSvg?kn+" ":"")+"Leaflet</a>"},initialize:function(x){N(this,x),this._attributions={}},onAdd:function(x){x.attributionControl=this,this._container=kr("div","leaflet-control-attribution"),kl(this._container);for(var I in x._layers)x._layers[I].getAttribution&&this.addAttribution(x._layers[I].getAttribution());return this._update(),x.on("layeradd",this._addAttribution,this),this._container},onRemove:function(x){x.off("layeradd",this._addAttribution,this)},_addAttribution:function(x){x.layer.getAttribution&&(this.addAttribution(x.layer.getAttribution()),x.layer.once("remove",function(){this.removeAttribution(x.layer.getAttribution())},this))},setPrefix:function(x){return this.options.prefix=x,this._update(),this},addAttribution:function(x){return x?(this._attributions[x]||(this._attributions[x]=0),this._attributions[x]++,this._update(),this):this},removeAttribution:function(x){return x?(this._attributions[x]&&(this._attributions[x]--,this._update()),this):this},_update:function(){if(this._map){var x=[];for(var I in this._attributions)this._attributions[I]&&x.push(I);var U=[];this.options.prefix&&U.push(this.options.prefix),x.length&&U.push(x.join(", ")),this._container.innerHTML=U.join(' <span aria-hidden="true">|</span> ')}}});Ei.mergeOptions({attributionControl:!0}),Ei.addInitHook(function(){this.options.attributionControl&&new Cf().addTo(this)});var If=function(x){return new Cf(x)};fs.Layers=ts,fs.Zoom=xh,fs.Scale=Dr,fs.Attribution=Cf,ol.layers=Rm,ol.zoom=fd,ol.scale=D_,ol.attribution=If;var ks=He.extend({initialize:function(x){this._map=x},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ks.addTo=function(x,I){return x.addHandler(I,this),this};var pd={Events:ot},Rs=$e.touch?"touchstart mousedown":"mousedown",ps=rt.extend({options:{clickTolerance:3},initialize:function(x,I,U,ne){N(this,ne),this._element=x,this._dragStartTarget=I||x,this._preventOutline=U},enable:function(){this._enabled||(Fr(this._dragStartTarget,Rs,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ps._dragging===this&&this.finishDrag(!0),Hn(this._dragStartTarget,Rs,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(x){if(this._enabled&&(this._moved=!1,!mh(this._element,"leaflet-zoom-anim"))){if(x.touches&&x.touches.length!==1){ps._dragging===this&&this.finishDrag();return}if(!(ps._dragging||x.shiftKey||x.which!==1&&x.button!==1&&!x.touches)&&(ps._dragging=this,this._preventOutline&&_a(this._element),il(),Is(),!this._moving)){this.fire("down");var I=x.touches?x.touches[0]:x,U=ud(this._element);this._startPoint=new Be(I.clientX,I.clientY),this._startPos=Ia(this._element),this._parentScale=Fc(U);var ne=x.type==="mousedown";Fr(document,ne?"mousemove":"touchmove",this._onMove,this),Fr(document,ne?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(x){if(this._enabled){if(x.touches&&x.touches.length>1){this._moved=!0;return}var I=x.touches&&x.touches.length===1?x.touches[0]:x,U=new Be(I.clientX,I.clientY)._subtract(this._startPoint);!U.x&&!U.y||Math.abs(U.x)+Math.abs(U.y)<this.options.clickTolerance||(U.x/=this._parentScale.x,U.y/=this._parentScale.y,ya(x),this._moved||(this.fire("dragstart"),this._moved=!0,Wr(document.body,"leaflet-dragging"),this._lastTarget=x.target||x.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Wr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(U),this._moving=!0,this._lastEvent=x,this._updatePosition())}},_updatePosition:function(){var x={originalEvent:this._lastEvent};this.fire("predrag",x),ro(this._element,this._newPos),this.fire("drag",x)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(x){co(document.body,"leaflet-dragging"),this._lastTarget&&(co(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Hn(document,"mousemove touchmove",this._onMove,this),Hn(document,"mouseup touchend touchcancel",this._onUp,this),yu(),Va();var I=this._moved&&this._moving;this._moving=!1,ps._dragging=!1,I&&this.fire("dragend",{noInertia:x,distance:this._newPos.distanceTo(this._startPos)})}});function oc(x,I,U){var ne,pe=[1,4,2,8],Oe,lt,Rt,Ht,bn,Yn,Ir,Yr;for(Oe=0,Yn=x.length;Oe<Yn;Oe++)x[Oe]._code=al(x[Oe],I);for(Rt=0;Rt<4;Rt++){for(Ir=pe[Rt],ne=[],Oe=0,Yn=x.length,lt=Yn-1;Oe<Yn;lt=Oe++)Ht=x[Oe],bn=x[lt],Ht._code&Ir?bn._code&Ir||(Yr=Mf(bn,Ht,Ir,I,U),Yr._code=al(Yr,I),ne.push(Yr)):(bn._code&Ir&&(Yr=Mf(bn,Ht,Ir,I,U),Yr._code=al(Yr,I),ne.push(Yr)),ne.push(Ht));x=ne}return x}function An(x,I){var U,ne,pe,Oe,lt,Rt,Ht,bn,Yn;if(!x||x.length===0)throw new Error("latlngs not passed");ra(x)||(console.warn("latlngs are not flat! Only the first ring will be used"),x=x[0]);var Ir=sn([0,0]),Yr=un(x),va=Yr.getNorthWest().distanceTo(Yr.getSouthWest())*Yr.getNorthEast().distanceTo(Yr.getNorthWest());va<1700&&(Ir=Kr(x));var Yo=x.length,Ds=[];for(U=0;U<Yo;U++){var Ga=sn(x[U]);Ds.push(I.project(sn([Ga.lat-Ir.lat,Ga.lng-Ir.lng])))}for(Rt=Ht=bn=0,U=0,ne=Yo-1;U<Yo;ne=U++)pe=Ds[U],Oe=Ds[ne],lt=pe.y*Oe.x-Oe.y*pe.x,Ht+=(pe.x+Oe.x)*lt,bn+=(pe.y+Oe.y)*lt,Rt+=lt*3;Rt===0?Yn=Ds[0]:Yn=[Ht/Rt,bn/Rt];var mc=I.unproject(at(Yn));return sn([mc.lat+Ir.lat,mc.lng+Ir.lng])}function Kr(x){for(var I=0,U=0,ne=0,pe=0;pe<x.length;pe++){var Oe=sn(x[pe]);I+=Oe.lat,U+=Oe.lng,ne++}return sn([I/ne,U/ne])}var Gr={__proto__:null,clipPolygon:oc,polygonCenter:An,centroid:Kr};function Wa(x,I){if(!I||!x.length)return x.slice();var U=I*I;return x=md(x,U),x=wu(x,U),x}function ac(x,I,U){return Math.sqrt(Rl(x,I,U,!0))}function Br(x,I,U){return Rl(x,I,U)}function wu(x,I){var U=x.length,ne=typeof Uint8Array<"u"?Uint8Array:Array,pe=new ne(U);pe[0]=pe[U-1]=1,Su(x,pe,I,0,U-1);var Oe,lt=[];for(Oe=0;Oe<U;Oe++)pe[Oe]&&lt.push(x[Oe]);return lt}function Su(x,I,U,ne,pe){var Oe=0,lt,Rt,Ht;for(Rt=ne+1;Rt<=pe-1;Rt++)Ht=Rl(x[Rt],x[ne],x[pe],!0),Ht>Oe&&(lt=Rt,Oe=Ht);Oe>U&&(I[lt]=1,Su(x,I,U,ne,lt),Su(x,I,U,lt,pe))}function md(x,I){for(var U=[x[0]],ne=1,pe=0,Oe=x.length;ne<Oe;ne++)Dm(x[ne],x[pe])>I&&(U.push(x[ne]),pe=ne);return pe<Oe-1&&U.push(x[Oe-1]),U}var Ma;function po(x,I,U,ne,pe){var Oe=ne?Ma:al(x,U),lt=al(I,U),Rt,Ht,bn;for(Ma=lt;;){if(!(Oe|lt))return[x,I];if(Oe&lt)return!1;Rt=Oe||lt,Ht=Mf(x,I,Rt,U,pe),bn=al(Ht,U),Rt===Oe?(x=Ht,Oe=bn):(I=Ht,lt=bn)}}function Mf(x,I,U,ne,pe){var Oe=I.x-x.x,lt=I.y-x.y,Rt=ne.min,Ht=ne.max,bn,Yn;return U&8?(bn=x.x+Oe*(Ht.y-x.y)/lt,Yn=Ht.y):U&4?(bn=x.x+Oe*(Rt.y-x.y)/lt,Yn=Rt.y):U&2?(bn=Ht.x,Yn=x.y+lt*(Ht.x-x.x)/Oe):U&1&&(bn=Rt.x,Yn=x.y+lt*(Rt.x-x.x)/Oe),new Be(bn,Yn,pe)}function al(x,I){var U=0;return x.x<I.min.x?U|=1:x.x>I.max.x&&(U|=2),x.y<I.min.y?U|=4:x.y>I.max.y&&(U|=8),U}function Dm(x,I){var U=I.x-x.x,ne=I.y-x.y;return U*U+ne*ne}function Rl(x,I,U,ne){var pe=I.x,Oe=I.y,lt=U.x-pe,Rt=U.y-Oe,Ht=lt*lt+Rt*Rt,bn;return Ht>0&&(bn=((x.x-pe)*lt+(x.y-Oe)*Rt)/Ht,bn>1?(pe=U.x,Oe=U.y):bn>0&&(pe+=lt*bn,Oe+=Rt*bn)),lt=x.x-pe,Rt=x.y-Oe,ne?lt*lt+Rt*Rt:new Be(pe,Oe)}function ra(x){return!q(x[0])||typeof x[0][0]!="object"&&typeof x[0][0]<"u"}function gd(x){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ra(x)}function Oa(x,I){var U,ne,pe,Oe,lt,Rt,Ht,bn;if(!x||x.length===0)throw new Error("latlngs not passed");ra(x)||(console.warn("latlngs are not flat! Only the first ring will be used"),x=x[0]);var Yn=sn([0,0]),Ir=un(x),Yr=Ir.getNorthWest().distanceTo(Ir.getSouthWest())*Ir.getNorthEast().distanceTo(Ir.getNorthWest());Yr<1700&&(Yn=Kr(x));var va=x.length,Yo=[];for(U=0;U<va;U++){var Ds=sn(x[U]);Yo.push(I.project(sn([Ds.lat-Yn.lat,Ds.lng-Yn.lng])))}for(U=0,ne=0;U<va-1;U++)ne+=Yo[U].distanceTo(Yo[U+1])/2;if(ne===0)bn=Yo[0];else for(U=0,Oe=0;U<va-1;U++)if(lt=Yo[U],Rt=Yo[U+1],pe=lt.distanceTo(Rt),Oe+=pe,Oe>ne){Ht=(Oe-ne)/pe,bn=[Rt.x-Ht*(Rt.x-lt.x),Rt.y-Ht*(Rt.y-lt.y)];break}var Ga=I.unproject(at(bn));return sn([Ga.lat+Yn.lat,Ga.lng+Yn.lng])}var sl={__proto__:null,simplify:Wa,pointToSegmentDistance:ac,closestPointOnSegment:Br,clipSegment:po,_getEdgeIntersection:Mf,_getBitCode:al,_sqClosestPointOnSegment:Rl,isFlat:ra,_flat:gd,polylineCenter:Oa},ka={project:function(x){return new Be(x.lng,x.lat)},unproject:function(x){return new en(x.y,x.x)},bounds:new Mt([-180,-90],[180,90])},Of={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Mt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(x){var I=Math.PI/180,U=this.R,ne=x.lat*I,pe=this.R_MINOR/U,Oe=Math.sqrt(1-pe*pe),lt=Oe*Math.sin(ne),Rt=Math.tan(Math.PI/4-ne/2)/Math.pow((1-lt)/(1+lt),Oe/2);return ne=-U*Math.log(Math.max(Rt,1e-10)),new Be(x.lng*I*U,ne)},unproject:function(x){for(var I=180/Math.PI,U=this.R,ne=this.R_MINOR/U,pe=Math.sqrt(1-ne*ne),Oe=Math.exp(-x.y/U),lt=Math.PI/2-2*Math.atan(Oe),Rt=0,Ht=.1,bn;Rt<15&&Math.abs(Ht)>1e-7;Rt++)bn=pe*Math.sin(lt),bn=Math.pow((1-bn)/(1+bn),pe/2),Ht=Math.PI/2-2*Math.atan(Oe*bn)-lt,lt+=Ht;return new en(lt*I,x.x*I/U)}},bh={__proto__:null,LonLat:ka,Mercator:Of,SphericalMercator:Tn},Oo=a({},$n,{code:"EPSG:3395",projection:Of,transformation:function(){var x=.5/(Math.PI*Of.R);return yt(x,.5,-x,.5)}()}),Ra=a({},$n,{code:"EPSG:4326",projection:ka,transformation:yt(1/180,1,-1/180,.5)}),ar=a({},Vt,{projection:ka,transformation:yt(1,0,-1,0),scale:function(x){return Math.pow(2,x)},zoom:function(x){return Math.log(x)/Math.LN2},distance:function(x,I){var U=I.lng-x.lng,ne=I.lat-x.lat;return Math.sqrt(U*U+ne*ne)},infinite:!0});Vt.Earth=$n,Vt.EPSG3395=Oo,Vt.EPSG3857=In,Vt.EPSG900913=Kn,Vt.EPSG4326=Ra,Vt.Simple=ar;var nn=rt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(x){return x.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(x){return x&&x.removeLayer(this),this},getPane:function(x){return this._map.getPane(x?this.options[x]||x:this.options.pane)},addInteractiveTarget:function(x){return this._map._targets[_(x)]=this,this},removeInteractiveTarget:function(x){return delete this._map._targets[_(x)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(x){var I=x.target;if(I.hasLayer(this)){if(this._map=I,this._zoomAnimated=I._zoomAnimated,this.getEvents){var U=this.getEvents();I.on(U,this),this.once("remove",function(){I.off(U,this)},this)}this.onAdd(I),this.fire("add"),I.fire("layeradd",{layer:this})}}});Ei.include({addLayer:function(x){if(!x._layerAdd)throw new Error("The provided object is not a Layer.");var I=_(x);return this._layers[I]?this:(this._layers[I]=x,x._mapToAdd=this,x.beforeAdd&&x.beforeAdd(this),this.whenReady(x._layerAdd,x),this)},removeLayer:function(x){var I=_(x);return this._layers[I]?(this._loaded&&x.onRemove(this),delete this._layers[I],this._loaded&&(this.fire("layerremove",{layer:x}),x.fire("remove")),x._map=x._mapToAdd=null,this):this},hasLayer:function(x){return _(x)in this._layers},eachLayer:function(x,I){for(var U in this._layers)x.call(I,this._layers[U]);return this},_addLayers:function(x){x=x?q(x)?x:[x]:[];for(var I=0,U=x.length;I<U;I++)this.addLayer(x[I])},_addZoomLimit:function(x){(!isNaN(x.options.maxZoom)||!isNaN(x.options.minZoom))&&(this._zoomBoundLayers[_(x)]=x,this._updateZoomLevels())},_removeZoomLimit:function(x){var I=_(x);this._zoomBoundLayers[I]&&(delete this._zoomBoundLayers[I],this._updateZoomLevels())},_updateZoomLevels:function(){var x=1/0,I=-1/0,U=this._getZoomSpan();for(var ne in this._zoomBoundLayers){var pe=this._zoomBoundLayers[ne].options;x=pe.minZoom===void 0?x:Math.min(x,pe.minZoom),I=pe.maxZoom===void 0?I:Math.max(I,pe.maxZoom)}this._layersMaxZoom=I===-1/0?void 0:I,this._layersMinZoom=x===1/0?void 0:x,U!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Dl=nn.extend({initialize:function(x,I){N(this,I),this._layers={};var U,ne;if(x)for(U=0,ne=x.length;U<ne;U++)this.addLayer(x[U])},addLayer:function(x){var I=this.getLayerId(x);return this._layers[I]=x,this._map&&this._map.addLayer(x),this},removeLayer:function(x){var I=x in this._layers?x:this.getLayerId(x);return this._map&&this._layers[I]&&this._map.removeLayer(this._layers[I]),delete this._layers[I],this},hasLayer:function(x){var I=typeof x=="number"?x:this.getLayerId(x);return I in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(x){var I=Array.prototype.slice.call(arguments,1),U,ne;for(U in this._layers)ne=this._layers[U],ne[x]&&ne[x].apply(ne,I);return this},onAdd:function(x){this.eachLayer(x.addLayer,x)},onRemove:function(x){this.eachLayer(x.removeLayer,x)},eachLayer:function(x,I){for(var U in this._layers)x.call(I,this._layers[U]);return this},getLayer:function(x){return this._layers[x]},getLayers:function(){var x=[];return this.eachLayer(x.push,x),x},setZIndex:function(x){return this.invoke("setZIndex",x)},getLayerId:function(x){return _(x)}}),Un=function(x,I){return new Dl(x,I)},ns=Dl.extend({addLayer:function(x){return this.hasLayer(x)?this:(x.addEventParent(this),Dl.prototype.addLayer.call(this,x),this.fire("layeradd",{layer:x}))},removeLayer:function(x){return this.hasLayer(x)?(x in this._layers&&(x=this._layers[x]),x.removeEventParent(this),Dl.prototype.removeLayer.call(this,x),this.fire("layerremove",{layer:x})):this},setStyle:function(x){return this.invoke("setStyle",x)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var x=new rn;for(var I in this._layers){var U=this._layers[I];x.extend(U.getBounds?U.getBounds():U.getLatLng())}return x}}),wh=function(x,I){return new ns(x,I)},Fn=He.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(x){N(this,x)},createIcon:function(x){return this._createIcon("icon",x)},createShadow:function(x){return this._createIcon("shadow",x)},_createIcon:function(x,I){var U=this._getIconUrl(x);if(!U){if(x==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var ne=this._createImg(U,I&&I.tagName==="IMG"?I:null);return this._setIconStyles(ne,x),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ne.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),ne},_setIconStyles:function(x,I){var U=this.options,ne=U[I+"Size"];typeof ne=="number"&&(ne=[ne,ne]);var pe=at(ne),Oe=at(I==="shadow"&&U.shadowAnchor||U.iconAnchor||pe&&pe.divideBy(2,!0));x.className="leaflet-marker-"+I+" "+(U.className||""),Oe&&(x.style.marginLeft=-Oe.x+"px",x.style.marginTop=-Oe.y+"px"),pe&&(x.style.width=pe.x+"px",x.style.height=pe.y+"px")},_createImg:function(x,I){return I=I||document.createElement("img"),I.src=x,I},_getIconUrl:function(x){return $e.retina&&this.options[x+"RetinaUrl"]||this.options[x+"Url"]}});function L_(x){return new Fn(x)}var rs=Fn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(x){return typeof rs.imagePath!="string"&&(rs.imagePath=this._detectIconPath()),(this.options.imagePath||rs.imagePath)+Fn.prototype._getIconUrl.call(this,x)},_stripUrl:function(x){var I=function(U,ne,pe){var Oe=ne.exec(U);return Oe&&Oe[pe]};return x=I(x,/^url\((['"])?(.+)\1\)$/,2),x&&I(x,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var x=kr("div","leaflet-default-icon-path",document.body),I=xo(x,"background-image")||xo(x,"backgroundImage");if(document.body.removeChild(x),I=this._stripUrl(I),I)return I;var U=document.querySelector('link[href$="leaflet.css"]');return U?U.href.substring(0,U.href.length-11-1):""}}),Lm=ks.extend({initialize:function(x){this._marker=x},addHooks:function(){var x=this._marker._icon;this._draggable||(this._draggable=new ps(x,x,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Wr(x,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&co(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(x){var I=this._marker,U=I._map,ne=this._marker.options.autoPanSpeed,pe=this._marker.options.autoPanPadding,Oe=Ia(I._icon),lt=U.getPixelBounds(),Rt=U.getPixelOrigin(),Ht=Nt(lt.min._subtract(Rt).add(pe),lt.max._subtract(Rt).subtract(pe));if(!Ht.contains(Oe)){var bn=at((Math.max(Ht.max.x,Oe.x)-Ht.max.x)/(lt.max.x-Ht.max.x)-(Math.min(Ht.min.x,Oe.x)-Ht.min.x)/(lt.min.x-Ht.min.x),(Math.max(Ht.max.y,Oe.y)-Ht.max.y)/(lt.max.y-Ht.max.y)-(Math.min(Ht.min.y,Oe.y)-Ht.min.y)/(lt.min.y-Ht.min.y)).multiplyBy(ne);U.panBy(bn,{animate:!1}),this._draggable._newPos._add(bn),this._draggable._startPos._add(bn),ro(I._icon,this._draggable._newPos),this._onDrag(x),this._panRequest=Fe(this._adjustPan.bind(this,x))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(x){this._marker.options.autoPan&&(Le(this._panRequest),this._panRequest=Fe(this._adjustPan.bind(this,x)))},_onDrag:function(x){var I=this._marker,U=I._shadow,ne=Ia(I._icon),pe=I._map.layerPointToLatLng(ne);U&&ro(U,ne),I._latlng=pe,x.latlng=pe,x.oldLatLng=this._oldLatLng,I.fire("move",x).fire("drag",x)},_onDragEnd:function(x){Le(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",x)}}),Tu=nn.extend({options:{icon:new rs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(x,I){N(this,I),this._latlng=sn(x)},onAdd:function(x){this._zoomAnimated=this._zoomAnimated&&x.options.markerZoomAnimation,this._zoomAnimated&&x.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(x){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&x.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(x){var I=this._latlng;return this._latlng=sn(x),this.update(),this.fire("move",{oldLatLng:I,latlng:this._latlng})},setZIndexOffset:function(x){return this.options.zIndexOffset=x,this.update()},getIcon:function(){return this.options.icon},setIcon:function(x){return this.options.icon=x,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var x=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(x)}return this},_initIcon:function(){var x=this.options,I="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),U=x.icon.createIcon(this._icon),ne=!1;U!==this._icon&&(this._icon&&this._removeIcon(),ne=!0,x.title&&(U.title=x.title),U.tagName==="IMG"&&(U.alt=x.alt||"")),Wr(U,I),x.keyboard&&(U.tabIndex="0",U.setAttribute("role","button")),this._icon=U,x.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Fr(U,"focus",this._panOnFocus,this);var pe=x.icon.createShadow(this._shadow),Oe=!1;pe!==this._shadow&&(this._removeShadow(),Oe=!0),pe&&(Wr(pe,I),pe.alt=""),this._shadow=pe,x.opacity<1&&this._updateOpacity(),ne&&this.getPane().appendChild(this._icon),this._initInteraction(),pe&&Oe&&this.getPane(x.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Hn(this._icon,"focus",this._panOnFocus,this),Gi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Gi(this._shadow),this._shadow=null},_setPos:function(x){this._icon&&ro(this._icon,x),this._shadow&&ro(this._shadow,x),this._zIndex=x.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(x){this._icon&&(this._icon.style.zIndex=this._zIndex+x)},_animateZoom:function(x){var I=this._map._latLngToNewLayerPoint(this._latlng,x.zoom,x.center).round();this._setPos(I)},_initInteraction:function(){if(this.options.interactive&&(Wr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Lm)){var x=this.options.draggable;this.dragging&&(x=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Lm(this),x&&this.dragging.enable()}},setOpacity:function(x){return this.options.opacity=x,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var x=this.options.opacity;this._icon&&Mo(this._icon,x),this._shadow&&Mo(this._shadow,x)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var x=this._map;if(x){var I=this.options.icon.options,U=I.iconSize?at(I.iconSize):at(0,0),ne=I.iconAnchor?at(I.iconAnchor):at(0,0);x.panInside(this._latlng,{paddingTopLeft:ne,paddingBottomRight:U.subtract(ne)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Da(x,I){return new Tu(x,I)}var Eo=nn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(x){this._renderer=x.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(x){return N(this,x),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&x&&Object.prototype.hasOwnProperty.call(x,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),sc=Eo.extend({options:{fill:!0,radius:10},initialize:function(x,I){N(this,I),this._latlng=sn(x),this._radius=this.options.radius},setLatLng:function(x){var I=this._latlng;return this._latlng=sn(x),this.redraw(),this.fire("move",{oldLatLng:I,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(x){return this.options.radius=this._radius=x,this.redraw()},getRadius:function(){return this._radius},setStyle:function(x){var I=x&&x.radius||this._radius;return Eo.prototype.setStyle.call(this,x),this.setRadius(I),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var x=this._radius,I=this._radiusY||x,U=this._clickTolerance(),ne=[x+U,I+U];this._pxBounds=new Mt(this._point.subtract(ne),this._point.add(ne))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(x){return x.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function $c(x,I){return new sc(x,I)}var lc=sc.extend({initialize:function(x,I,U){if(typeof I=="number"&&(I=a({},U,{radius:I})),N(this,I),this._latlng=sn(x),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(x){return this._mRadius=x,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var x=[this._radius,this._radiusY||this._radius];return new rn(this._map.layerPointToLatLng(this._point.subtract(x)),this._map.layerPointToLatLng(this._point.add(x)))},setStyle:Eo.prototype.setStyle,_project:function(){var x=this._latlng.lng,I=this._latlng.lat,U=this._map,ne=U.options.crs;if(ne.distance===$n.distance){var pe=Math.PI/180,Oe=this._mRadius/$n.R/pe,lt=U.project([I+Oe,x]),Rt=U.project([I-Oe,x]),Ht=lt.add(Rt).divideBy(2),bn=U.unproject(Ht).lat,Yn=Math.acos((Math.cos(Oe*pe)-Math.sin(I*pe)*Math.sin(bn*pe))/(Math.cos(I*pe)*Math.cos(bn*pe)))/pe;(isNaN(Yn)||Yn===0)&&(Yn=Oe/Math.cos(Math.PI/180*I)),this._point=Ht.subtract(U.getPixelOrigin()),this._radius=isNaN(Yn)?0:Ht.x-U.project([bn,x-Yn]).x,this._radiusY=Ht.y-lt.y}else{var Ir=ne.unproject(ne.project(this._latlng).subtract([this._mRadius,0]));this._point=U.latLngToLayerPoint(this._latlng),this._radius=this._point.x-U.latLngToLayerPoint(Ir).x}this._updateBounds()}});function Eu(x,I,U){return new lc(x,I,U)}var bo=Eo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(x,I){N(this,I),this._setLatLngs(x)},getLatLngs:function(){return this._latlngs},setLatLngs:function(x){return this._setLatLngs(x),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(x){for(var I=1/0,U=null,ne=Rl,pe,Oe,lt=0,Rt=this._parts.length;lt<Rt;lt++)for(var Ht=this._parts[lt],bn=1,Yn=Ht.length;bn<Yn;bn++){pe=Ht[bn-1],Oe=Ht[bn];var Ir=ne(x,pe,Oe,!0);Ir<I&&(I=Ir,U=ne(x,pe,Oe))}return U&&(U.distance=Math.sqrt(I)),U},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Oa(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(x,I){return I=I||this._defaultShape(),x=sn(x),I.push(x),this._bounds.extend(x),this.redraw()},_setLatLngs:function(x){this._bounds=new rn,this._latlngs=this._convertLatLngs(x)},_defaultShape:function(){return ra(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(x){for(var I=[],U=ra(x),ne=0,pe=x.length;ne<pe;ne++)U?(I[ne]=sn(x[ne]),this._bounds.extend(I[ne])):I[ne]=this._convertLatLngs(x[ne]);return I},_project:function(){var x=new Mt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,x),this._bounds.isValid()&&x.isValid()&&(this._rawPxBounds=x,this._updateBounds())},_updateBounds:function(){var x=this._clickTolerance(),I=new Be(x,x);this._rawPxBounds&&(this._pxBounds=new Mt([this._rawPxBounds.min.subtract(I),this._rawPxBounds.max.add(I)]))},_projectLatlngs:function(x,I,U){var ne=x[0]instanceof en,pe=x.length,Oe,lt;if(ne){for(lt=[],Oe=0;Oe<pe;Oe++)lt[Oe]=this._map.latLngToLayerPoint(x[Oe]),U.extend(lt[Oe]);I.push(lt)}else for(Oe=0;Oe<pe;Oe++)this._projectLatlngs(x[Oe],I,U)},_clipPoints:function(){var x=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(x))){if(this.options.noClip){this._parts=this._rings;return}var I=this._parts,U,ne,pe,Oe,lt,Rt,Ht;for(U=0,pe=0,Oe=this._rings.length;U<Oe;U++)for(Ht=this._rings[U],ne=0,lt=Ht.length;ne<lt-1;ne++)Rt=po(Ht[ne],Ht[ne+1],x,ne,!0),Rt&&(I[pe]=I[pe]||[],I[pe].push(Rt[0]),(Rt[1]!==Ht[ne+1]||ne===lt-2)&&(I[pe].push(Rt[1]),pe++))}},_simplifyPoints:function(){for(var x=this._parts,I=this.options.smoothFactor,U=0,ne=x.length;U<ne;U++)x[U]=Wa(x[U],I)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(x,I){var U,ne,pe,Oe,lt,Rt,Ht=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(x))return!1;for(U=0,Oe=this._parts.length;U<Oe;U++)for(Rt=this._parts[U],ne=0,lt=Rt.length,pe=lt-1;ne<lt;pe=ne++)if(!(!I&&ne===0)&&ac(x,Rt[pe],Rt[ne])<=Ht)return!0;return!1}});function _d(x,I){return new bo(x,I)}bo._flat=gd;var Ll=bo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return An(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(x){var I=bo.prototype._convertLatLngs.call(this,x),U=I.length;return U>=2&&I[0]instanceof en&&I[0].equals(I[U-1])&&I.pop(),I},_setLatLngs:function(x){bo.prototype._setLatLngs.call(this,x),ra(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ra(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var x=this._renderer._bounds,I=this.options.weight,U=new Be(I,I);if(x=new Mt(x.min.subtract(U),x.max.add(U)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(x))){if(this.options.noClip){this._parts=this._rings;return}for(var ne=0,pe=this._rings.length,Oe;ne<pe;ne++)Oe=oc(this._rings[ne],x,!0),Oe.length&&this._parts.push(Oe)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(x){var I=!1,U,ne,pe,Oe,lt,Rt,Ht,bn;if(!this._pxBounds||!this._pxBounds.contains(x))return!1;for(Oe=0,Ht=this._parts.length;Oe<Ht;Oe++)for(U=this._parts[Oe],lt=0,bn=U.length,Rt=bn-1;lt<bn;Rt=lt++)ne=U[lt],pe=U[Rt],ne.y>x.y!=pe.y>x.y&&x.x<(pe.x-ne.x)*(x.y-ne.y)/(pe.y-ne.y)+ne.x&&(I=!I);return I||bo.prototype._containsPoint.call(this,x,!0)}});function dx(x,I){return new Ll(x,I)}var La=ns.extend({initialize:function(x,I){N(this,I),this._layers={},x&&this.addData(x)},addData:function(x){var I=q(x)?x:x.features,U,ne,pe;if(I){for(U=0,ne=I.length;U<ne;U++)pe=I[U],(pe.geometries||pe.geometry||pe.features||pe.coordinates)&&this.addData(pe);return this}var Oe=this.options;if(Oe.filter&&!Oe.filter(x))return this;var lt=Sh(x,Oe);return lt?(lt.feature=vd(x),lt.defaultOptions=lt.options,this.resetStyle(lt),Oe.onEachFeature&&Oe.onEachFeature(x,lt),this.addLayer(lt)):this},resetStyle:function(x){return x===void 0?this.eachLayer(this.resetStyle,this):(x.options=a({},x.defaultOptions),this._setLayerStyle(x,this.options.style),this)},setStyle:function(x){return this.eachLayer(function(I){this._setLayerStyle(I,x)},this)},_setLayerStyle:function(x,I){x.setStyle&&(typeof I=="function"&&(I=I(x.feature)),x.setStyle(I))}});function Sh(x,I){var U=x.type==="Feature"?x.geometry:x,ne=U?U.coordinates:null,pe=[],Oe=I&&I.pointToLayer,lt=I&&I.coordsToLatLng||yd,Rt,Ht,bn,Yn;if(!ne&&!U)return null;switch(U.type){case"Point":return Rt=lt(ne),ll(Oe,x,Rt,I);case"MultiPoint":for(bn=0,Yn=ne.length;bn<Yn;bn++)Rt=lt(ne[bn]),pe.push(ll(Oe,x,Rt,I));return new ns(pe);case"LineString":case"MultiLineString":return Ht=cl(ne,U.type==="LineString"?0:1,lt),new bo(Ht,I);case"Polygon":case"MultiPolygon":return Ht=cl(ne,U.type==="Polygon"?1:2,lt),new Ll(Ht,I);case"GeometryCollection":for(bn=0,Yn=U.geometries.length;bn<Yn;bn++){var Ir=Sh({geometry:U.geometries[bn],type:"Feature",properties:x.properties},I);Ir&&pe.push(Ir)}return new ns(pe);case"FeatureCollection":for(bn=0,Yn=U.features.length;bn<Yn;bn++){var Yr=Sh(U.features[bn],I);Yr&&pe.push(Yr)}return new ns(pe);default:throw new Error("Invalid GeoJSON object.")}}function ll(x,I,U,ne){return x?x(I,U):new Tu(U,ne&&ne.markersInheritOptions&&ne)}function yd(x){return new en(x[1],x[0],x[2])}function cl(x,I,U){for(var ne=[],pe=0,Oe=x.length,lt;pe<Oe;pe++)lt=I?cl(x[pe],I-1,U):(U||yd)(x[pe]),ne.push(lt);return ne}function zm(x,I){return x=sn(x),x.alt!==void 0?[k(x.lng,I),k(x.lat,I),k(x.alt,I)]:[k(x.lng,I),k(x.lat,I)]}function kf(x,I,U,ne){for(var pe=[],Oe=0,lt=x.length;Oe<lt;Oe++)pe.push(I?kf(x[Oe],ra(x[Oe])?0:I-1,U,ne):zm(x[Oe],ne));return!I&&U&&pe.length>0&&pe.push(pe[0].slice()),pe}function Au(x,I){return x.feature?a({},x.feature,{geometry:I}):vd(I)}function vd(x){return x.type==="Feature"||x.type==="FeatureCollection"?x:{type:"Feature",properties:{},geometry:x}}var Nm={toGeoJSON:function(x){return Au(this,{type:"Point",coordinates:zm(this.getLatLng(),x)})}};Tu.include(Nm),lc.include(Nm),sc.include(Nm),bo.include({toGeoJSON:function(x){var I=!ra(this._latlngs),U=kf(this._latlngs,I?1:0,!1,x);return Au(this,{type:(I?"Multi":"")+"LineString",coordinates:U})}}),Ll.include({toGeoJSON:function(x){var I=!ra(this._latlngs),U=I&&!ra(this._latlngs[0]),ne=kf(this._latlngs,U?2:I?1:0,!0,x);return I||(ne=[ne]),Au(this,{type:(U?"Multi":"")+"Polygon",coordinates:ne})}}),Dl.include({toMultiPoint:function(x){var I=[];return this.eachLayer(function(U){I.push(U.toGeoJSON(x).geometry.coordinates)}),Au(this,{type:"MultiPoint",coordinates:I})},toGeoJSON:function(x){var I=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(I==="MultiPoint")return this.toMultiPoint(x);var U=I==="GeometryCollection",ne=[];return this.eachLayer(function(pe){if(pe.toGeoJSON){var Oe=pe.toGeoJSON(x);if(U)ne.push(Oe.geometry);else{var lt=vd(Oe);lt.type==="FeatureCollection"?ne.push.apply(ne,lt.features):ne.push(lt)}}}),U?Au(this,{geometries:ne,type:"GeometryCollection"}):{type:"FeatureCollection",features:ne}}});function xd(x,I){return new La(x,I)}var z_=xd,ul=nn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(x,I,U){this._url=x,this._bounds=un(I),N(this,U)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Wr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Gi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(x){return this.options.opacity=x,this._image&&this._updateOpacity(),this},setStyle:function(x){return x.opacity&&this.setOpacity(x.opacity),this},bringToFront:function(){return this._map&&Ml(this._image),this},bringToBack:function(){return this._map&&rl(this._image),this},setUrl:function(x){return this._url=x,this._image&&(this._image.src=x),this},setBounds:function(x){return this._bounds=un(x),this._map&&this._reset(),this},getEvents:function(){var x={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(x.zoomanim=this._animateZoom),x},setZIndex:function(x){return this.options.zIndex=x,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var x=this._url.tagName==="IMG",I=this._image=x?this._url:kr("img");if(Wr(I,"leaflet-image-layer"),this._zoomAnimated&&Wr(I,"leaflet-zoom-animated"),this.options.className&&Wr(I,this.options.className),I.onselectstart=A,I.onmousemove=A,I.onload=d(this.fire,this,"load"),I.onerror=d(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(I.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),x){this._url=I.src;return}I.src=this._url,I.alt=this.options.alt},_animateZoom:function(x){var I=this._map.getZoomScale(x.zoom),U=this._map._latLngBoundsToNewLayerBounds(this._bounds,x.zoom,x.center).min;Ca(this._image,U,I)},_reset:function(){var x=this._image,I=new Mt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),U=I.getSize();ro(x,I.min),x.style.width=U.x+"px",x.style.height=U.y+"px"},_updateOpacity:function(){Mo(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var x=this.options.errorOverlayUrl;x&&this._url!==x&&(this._url=x,this._image.src=x)},getCenter:function(){return this._bounds.getCenter()}}),N_=function(x,I,U){return new ul(x,I,U)},Fm=ul.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var x=this._url.tagName==="VIDEO",I=this._image=x?this._url:kr("video");if(Wr(I,"leaflet-image-layer"),this._zoomAnimated&&Wr(I,"leaflet-zoom-animated"),this.options.className&&Wr(I,this.options.className),I.onselectstart=A,I.onmousemove=A,I.onloadeddata=d(this.fire,this,"load"),x){for(var U=I.getElementsByTagName("source"),ne=[],pe=0;pe<U.length;pe++)ne.push(U[pe].src);this._url=U.length>0?ne:[I.src];return}q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(I.style,"objectFit")&&(I.style.objectFit="fill"),I.autoplay=!!this.options.autoplay,I.loop=!!this.options.loop,I.muted=!!this.options.muted,I.playsInline=!!this.options.playsInline;for(var Oe=0;Oe<this._url.length;Oe++){var lt=kr("source");lt.src=this._url[Oe],I.appendChild(lt)}}});function cc(x,I,U){return new Fm(x,I,U)}var Th=ul.extend({_initImage:function(){var x=this._image=this._url;Wr(x,"leaflet-image-layer"),this._zoomAnimated&&Wr(x,"leaflet-zoom-animated"),this.options.className&&Wr(x,this.options.className),x.onselectstart=A,x.onmousemove=A}});function Bm(x,I,U){return new Th(x,I,U)}var Uo=nn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(x,I){x&&(x instanceof en||q(x))?(this._latlng=sn(x),N(this,I)):(N(this,x),this._source=I),this.options.content&&(this._content=this.options.content)},openOn:function(x){return x=arguments.length?x:this._source._map,x.hasLayer(this)||x.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(x){return this._map?this.close():(arguments.length?this._source=x:x=this._source,this._prepareOpen(),this.openOn(x._map)),this},onAdd:function(x){this._zoomAnimated=x._zoomAnimated,this._container||this._initLayout(),x._fadeAnimated&&Mo(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),x._fadeAnimated&&Mo(this._container,1),this.bringToFront(),this.options.interactive&&(Wr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(x){x._fadeAnimated?(Mo(this._container,0),this._removeTimeout=setTimeout(d(Gi,void 0,this._container),200)):Gi(this._container),this.options.interactive&&(co(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(x){return this._latlng=sn(x),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(x){return this._content=x,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var x={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(x.zoomanim=this._animateZoom),x},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ml(this._container),this},bringToBack:function(){return this._map&&rl(this._container),this},_prepareOpen:function(x){var I=this._source;if(!I._map)return!1;if(I instanceof ns){I=null;var U=this._source._layers;for(var ne in U)if(U[ne]._map){I=U[ne];break}if(!I)return!1;this._source=I}if(!x)if(I.getCenter)x=I.getCenter();else if(I.getLatLng)x=I.getLatLng();else if(I.getBounds)x=I.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(x),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var x=this._contentNode,I=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof I=="string")x.innerHTML=I;else{for(;x.hasChildNodes();)x.removeChild(x.firstChild);x.appendChild(I)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var x=this._map.latLngToLayerPoint(this._latlng),I=at(this.options.offset),U=this._getAnchor();this._zoomAnimated?ro(this._container,x.add(U)):I=I.add(x).add(U);var ne=this._containerBottom=-I.y,pe=this._containerLeft=-Math.round(this._containerWidth/2)+I.x;this._container.style.bottom=ne+"px",this._container.style.left=pe+"px"}},_getAnchor:function(){return[0,0]}});Ei.include({_initOverlay:function(x,I,U,ne){var pe=I;return pe instanceof x||(pe=new x(ne).setContent(I)),U&&pe.setLatLng(U),pe}}),nn.include({_initOverlay:function(x,I,U,ne){var pe=U;return pe instanceof x?(N(pe,ne),pe._source=this):(pe=I&&!ne?I:new x(ne,this),pe.setContent(U)),pe}});var uc=Uo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(x){return x=arguments.length?x:this._source._map,!x.hasLayer(this)&&x._popup&&x._popup.options.autoClose&&x.removeLayer(x._popup),x._popup=this,Uo.prototype.openOn.call(this,x)},onAdd:function(x){Uo.prototype.onAdd.call(this,x),x.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Eo||this._source.on("preclick",Os))},onRemove:function(x){Uo.prototype.onRemove.call(this,x),x.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Eo||this._source.off("preclick",Os))},getEvents:function(){var x=Uo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(x.preclick=this.close),this.options.keepInView&&(x.moveend=this._adjustPan),x},_initLayout:function(){var x="leaflet-popup",I=this._container=kr("div",x+" "+(this.options.className||"")+" leaflet-zoom-animated"),U=this._wrapper=kr("div",x+"-content-wrapper",I);if(this._contentNode=kr("div",x+"-content",U),kl(I),Ol(this._contentNode),Fr(I,"contextmenu",Os),this._tipContainer=kr("div",x+"-tip-container",I),this._tip=kr("div",x+"-tip",this._tipContainer),this.options.closeButton){var ne=this._closeButton=kr("a",x+"-close-button",I);ne.setAttribute("role","button"),ne.setAttribute("aria-label","Close popup"),ne.href="#close",ne.innerHTML='<span aria-hidden="true">&#215;</span>',Fr(ne,"click",function(pe){ya(pe),this.close()},this)}},_updateLayout:function(){var x=this._contentNode,I=x.style;I.width="",I.whiteSpace="nowrap";var U=x.offsetWidth;U=Math.min(U,this.options.maxWidth),U=Math.max(U,this.options.minWidth),I.width=U+1+"px",I.whiteSpace="",I.height="";var ne=x.offsetHeight,pe=this.options.maxHeight,Oe="leaflet-popup-scrolled";pe&&ne>pe?(I.height=pe+"px",Wr(x,Oe)):co(x,Oe),this._containerWidth=this._container.offsetWidth},_animateZoom:function(x){var I=this._map._latLngToNewLayerPoint(this._latlng,x.zoom,x.center),U=this._getAnchor();ro(this._container,I.add(U))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var x=this._map,I=parseInt(xo(this._container,"marginBottom"),10)||0,U=this._container.offsetHeight+I,ne=this._containerWidth,pe=new Be(this._containerLeft,-U-this._containerBottom);pe._add(Ia(this._container));var Oe=x.layerPointToContainerPoint(pe),lt=at(this.options.autoPanPadding),Rt=at(this.options.autoPanPaddingTopLeft||lt),Ht=at(this.options.autoPanPaddingBottomRight||lt),bn=x.getSize(),Yn=0,Ir=0;Oe.x+ne+Ht.x>bn.x&&(Yn=Oe.x+ne-bn.x+Ht.x),Oe.x-Yn-Rt.x<0&&(Yn=Oe.x-Rt.x),Oe.y+U+Ht.y>bn.y&&(Ir=Oe.y+U-bn.y+Ht.y),Oe.y-Ir-Rt.y<0&&(Ir=Oe.y-Rt.y),(Yn||Ir)&&(this.options.keepInView&&(this._autopanning=!0),x.fire("autopanstart").panBy([Yn,Ir]))}},_getAnchor:function(){return at(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Eh=function(x,I){return new uc(x,I)};Ei.mergeOptions({closePopupOnClick:!0}),Ei.include({openPopup:function(x,I,U){return this._initOverlay(uc,x,I,U).openOn(this),this},closePopup:function(x){return x=arguments.length?x:this._popup,x&&x.close(),this}}),nn.include({bindPopup:function(x,I){return this._popup=this._initOverlay(uc,this._popup,x,I),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(x){return this._popup&&(this instanceof ns||(this._popup._source=this),this._popup._prepareOpen(x||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(x){return this._popup&&this._popup.setContent(x),this},getPopup:function(){return this._popup},_openPopup:function(x){if(!(!this._popup||!this._map)){rc(x);var I=x.layer||x.target;if(this._popup._source===I&&!(I instanceof Eo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(x.latlng);return}this._popup._source=I,this.openPopup(x.latlng)}},_movePopup:function(x){this._popup.setLatLng(x.latlng)},_onKeyPress:function(x){x.originalEvent.keyCode===13&&this._openPopup(x)}});var Ah=Uo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(x){Uo.prototype.onAdd.call(this,x),this.setOpacity(this.options.opacity),x.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(x){Uo.prototype.onRemove.call(this,x),x.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var x=Uo.prototype.getEvents.call(this);return this.options.permanent||(x.preclick=this.close),x},_initLayout:function(){var x="leaflet-tooltip",I=x+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=kr("div",I),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(x){var I,U,ne=this._map,pe=this._container,Oe=ne.latLngToContainerPoint(ne.getCenter()),lt=ne.layerPointToContainerPoint(x),Rt=this.options.direction,Ht=pe.offsetWidth,bn=pe.offsetHeight,Yn=at(this.options.offset),Ir=this._getAnchor();Rt==="top"?(I=Ht/2,U=bn):Rt==="bottom"?(I=Ht/2,U=0):Rt==="center"?(I=Ht/2,U=bn/2):Rt==="right"?(I=0,U=bn/2):Rt==="left"?(I=Ht,U=bn/2):lt.x<Oe.x?(Rt="right",I=0,U=bn/2):(Rt="left",I=Ht+(Yn.x+Ir.x)*2,U=bn/2),x=x.subtract(at(I,U,!0)).add(Yn).add(Ir),co(pe,"leaflet-tooltip-right"),co(pe,"leaflet-tooltip-left"),co(pe,"leaflet-tooltip-top"),co(pe,"leaflet-tooltip-bottom"),Wr(pe,"leaflet-tooltip-"+Rt),ro(pe,x)},_updatePosition:function(){var x=this._map.latLngToLayerPoint(this._latlng);this._setPosition(x)},setOpacity:function(x){this.options.opacity=x,this._container&&Mo(this._container,x)},_animateZoom:function(x){var I=this._map._latLngToNewLayerPoint(this._latlng,x.zoom,x.center);this._setPosition(I)},_getAnchor:function(){return at(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Rf=function(x,I){return new Ah(x,I)};Ei.include({openTooltip:function(x,I,U){return this._initOverlay(Ah,x,I,U).openOn(this),this},closeTooltip:function(x){return x.close(),this}}),nn.include({bindTooltip:function(x,I){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ah,this._tooltip,x,I),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(x){if(!(!x&&this._tooltipHandlersAdded)){var I=x?"off":"on",U={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?U.add=this._openTooltip:(U.mouseover=this._openTooltip,U.mouseout=this.closeTooltip,U.click=this._openTooltip,this._map?this._addFocusListeners():U.add=this._addFocusListeners),this._tooltip.options.sticky&&(U.mousemove=this._moveTooltip),this[I](U),this._tooltipHandlersAdded=!x}},openTooltip:function(x){return this._tooltip&&(this instanceof ns||(this._tooltip._source=this),this._tooltip._prepareOpen(x)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(x){return this._tooltip&&this._tooltip.setContent(x),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(x){var I=typeof x.getElement=="function"&&x.getElement();I&&(Fr(I,"focus",function(){this._tooltip._source=x,this.openTooltip()},this),Fr(I,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(x){var I=typeof x.getElement=="function"&&x.getElement();I&&I.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(x){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var I=this;this._map.once("moveend",function(){I._openOnceFlag=!1,I._openTooltip(x)});return}this._tooltip._source=x.layer||x.target,this.openTooltip(this._tooltip.options.sticky?x.latlng:void 0)}},_moveTooltip:function(x){var I=x.latlng,U,ne;this._tooltip.options.sticky&&x.originalEvent&&(U=this._map.mouseEventToContainerPoint(x.originalEvent),ne=this._map.containerPointToLayerPoint(U),I=this._map.layerPointToLatLng(ne)),this._tooltip.setLatLng(I)}});var ms=Fn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(x){var I=x&&x.tagName==="DIV"?x:document.createElement("div"),U=this.options;if(U.html instanceof Element?(Il(I),I.appendChild(U.html)):I.innerHTML=U.html!==!1?U.html:"",U.bgPos){var ne=at(U.bgPos);I.style.backgroundPosition=-ne.x+"px "+-ne.y+"px"}return this._setIconStyles(I,"icon"),I},createShadow:function(){return null}});function Df(x){return new ms(x)}Fn.Default=rs;var Kt=nn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:$e.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(x){N(this,x)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(x){x._addZoomLimit(this)},onRemove:function(x){this._removeAllTiles(),Gi(this._container),x._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ml(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rl(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(x){return this.options.opacity=x,this._updateOpacity(),this},setZIndex:function(x){return this.options.zIndex=x,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var x=this._clampZoom(this._map.getZoom());x!==this._tileZoom&&(this._tileZoom=x,this._updateLevels()),this._update()}return this},getEvents:function(){var x={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=b(this._onMoveEnd,this.options.updateInterval,this)),x.move=this._onMove),this._zoomAnimated&&(x.zoomanim=this._animateZoom),x},createTile:function(){return document.createElement("div")},getTileSize:function(){var x=this.options.tileSize;return x instanceof Be?x:new Be(x,x)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(x){for(var I=this.getPane().children,U=-x(-1/0,1/0),ne=0,pe=I.length,Oe;ne<pe;ne++)Oe=I[ne].style.zIndex,I[ne]!==this._container&&Oe&&(U=x(U,+Oe));isFinite(U)&&(this.options.zIndex=U+x(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!$e.ielt9){Mo(this._container,this.options.opacity);var x=+new Date,I=!1,U=!1;for(var ne in this._tiles){var pe=this._tiles[ne];if(!(!pe.current||!pe.loaded)){var Oe=Math.min(1,(x-pe.loaded)/200);Mo(pe.el,Oe),Oe<1?I=!0:(pe.active?U=!0:this._onOpaqueTile(pe),pe.active=!0)}}U&&!this._noPrune&&this._pruneTiles(),I&&(Le(this._fadeFrame),this._fadeFrame=Fe(this._updateOpacity,this))}},_onOpaqueTile:A,_initContainer:function(){this._container||(this._container=kr("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var x=this._tileZoom,I=this.options.maxZoom;if(x!==void 0){for(var U in this._levels)U=Number(U),this._levels[U].el.children.length||U===x?(this._levels[U].el.style.zIndex=I-Math.abs(x-U),this._onUpdateLevel(U)):(Gi(this._levels[U].el),this._removeTilesAtZoom(U),this._onRemoveLevel(U),delete this._levels[U]);var ne=this._levels[x],pe=this._map;return ne||(ne=this._levels[x]={},ne.el=kr("div","leaflet-tile-container leaflet-zoom-animated",this._container),ne.el.style.zIndex=I,ne.origin=pe.project(pe.unproject(pe.getPixelOrigin()),x).round(),ne.zoom=x,this._setZoomTransform(ne,pe.getCenter(),pe.getZoom()),A(ne.el.offsetWidth),this._onCreateLevel(ne)),this._level=ne,ne}},_onUpdateLevel:A,_onRemoveLevel:A,_onCreateLevel:A,_pruneTiles:function(){if(this._map){var x,I,U=this._map.getZoom();if(U>this.options.maxZoom||U<this.options.minZoom){this._removeAllTiles();return}for(x in this._tiles)I=this._tiles[x],I.retain=I.current;for(x in this._tiles)if(I=this._tiles[x],I.current&&!I.active){var ne=I.coords;this._retainParent(ne.x,ne.y,ne.z,ne.z-5)||this._retainChildren(ne.x,ne.y,ne.z,ne.z+2)}for(x in this._tiles)this._tiles[x].retain||this._removeTile(x)}},_removeTilesAtZoom:function(x){for(var I in this._tiles)this._tiles[I].coords.z===x&&this._removeTile(I)},_removeAllTiles:function(){for(var x in this._tiles)this._removeTile(x)},_invalidateAll:function(){for(var x in this._levels)Gi(this._levels[x].el),this._onRemoveLevel(Number(x)),delete this._levels[x];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(x,I,U,ne){var pe=Math.floor(x/2),Oe=Math.floor(I/2),lt=U-1,Rt=new Be(+pe,+Oe);Rt.z=+lt;var Ht=this._tileCoordsToKey(Rt),bn=this._tiles[Ht];return bn&&bn.active?(bn.retain=!0,!0):(bn&&bn.loaded&&(bn.retain=!0),lt>ne?this._retainParent(pe,Oe,lt,ne):!1)},_retainChildren:function(x,I,U,ne){for(var pe=2*x;pe<2*x+2;pe++)for(var Oe=2*I;Oe<2*I+2;Oe++){var lt=new Be(pe,Oe);lt.z=U+1;var Rt=this._tileCoordsToKey(lt),Ht=this._tiles[Rt];if(Ht&&Ht.active){Ht.retain=!0;continue}else Ht&&Ht.loaded&&(Ht.retain=!0);U+1<ne&&this._retainChildren(pe,Oe,U+1,ne)}},_resetView:function(x){var I=x&&(x.pinch||x.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),I,I)},_animateZoom:function(x){this._setView(x.center,x.zoom,!0,x.noUpdate)},_clampZoom:function(x){var I=this.options;return I.minNativeZoom!==void 0&&x<I.minNativeZoom?I.minNativeZoom:I.maxNativeZoom!==void 0&&I.maxNativeZoom<x?I.maxNativeZoom:x},_setView:function(x,I,U,ne){var pe=Math.round(I);this.options.maxZoom!==void 0&&pe>this.options.maxZoom||this.options.minZoom!==void 0&&pe<this.options.minZoom?pe=void 0:pe=this._clampZoom(pe);var Oe=this.options.updateWhenZooming&&pe!==this._tileZoom;(!ne||Oe)&&(this._tileZoom=pe,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),pe!==void 0&&this._update(x),U||this._pruneTiles(),this._noPrune=!!U),this._setZoomTransforms(x,I)},_setZoomTransforms:function(x,I){for(var U in this._levels)this._setZoomTransform(this._levels[U],x,I)},_setZoomTransform:function(x,I,U){var ne=this._map.getZoomScale(U,x.zoom),pe=x.origin.multiplyBy(ne).subtract(this._map._getNewPixelOrigin(I,U)).round();$e.any3d?Ca(x.el,pe,ne):ro(x.el,pe)},_resetGrid:function(){var x=this._map,I=x.options.crs,U=this._tileSize=this.getTileSize(),ne=this._tileZoom,pe=this._map.getPixelWorldBounds(this._tileZoom);pe&&(this._globalTileRange=this._pxBoundsToTileRange(pe)),this._wrapX=I.wrapLng&&!this.options.noWrap&&[Math.floor(x.project([0,I.wrapLng[0]],ne).x/U.x),Math.ceil(x.project([0,I.wrapLng[1]],ne).x/U.y)],this._wrapY=I.wrapLat&&!this.options.noWrap&&[Math.floor(x.project([I.wrapLat[0],0],ne).y/U.x),Math.ceil(x.project([I.wrapLat[1],0],ne).y/U.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(x){var I=this._map,U=I._animatingZoom?Math.max(I._animateToZoom,I.getZoom()):I.getZoom(),ne=I.getZoomScale(U,this._tileZoom),pe=I.project(x,this._tileZoom).floor(),Oe=I.getSize().divideBy(ne*2);return new Mt(pe.subtract(Oe),pe.add(Oe))},_update:function(x){var I=this._map;if(I){var U=this._clampZoom(I.getZoom());if(x===void 0&&(x=I.getCenter()),this._tileZoom!==void 0){var ne=this._getTiledPixelBounds(x),pe=this._pxBoundsToTileRange(ne),Oe=pe.getCenter(),lt=[],Rt=this.options.keepBuffer,Ht=new Mt(pe.getBottomLeft().subtract([Rt,-Rt]),pe.getTopRight().add([Rt,-Rt]));if(!(isFinite(pe.min.x)&&isFinite(pe.min.y)&&isFinite(pe.max.x)&&isFinite(pe.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var bn in this._tiles){var Yn=this._tiles[bn].coords;(Yn.z!==this._tileZoom||!Ht.contains(new Be(Yn.x,Yn.y)))&&(this._tiles[bn].current=!1)}if(Math.abs(U-this._tileZoom)>1){this._setView(x,U);return}for(var Ir=pe.min.y;Ir<=pe.max.y;Ir++)for(var Yr=pe.min.x;Yr<=pe.max.x;Yr++){var va=new Be(Yr,Ir);if(va.z=this._tileZoom,!!this._isValidTile(va)){var Yo=this._tiles[this._tileCoordsToKey(va)];Yo?Yo.current=!0:lt.push(va)}}if(lt.sort(function(Ga,mc){return Ga.distanceTo(Oe)-mc.distanceTo(Oe)}),lt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ds=document.createDocumentFragment();for(Yr=0;Yr<lt.length;Yr++)this._addTile(lt[Yr],Ds);this._level.el.appendChild(Ds)}}}},_isValidTile:function(x){var I=this._map.options.crs;if(!I.infinite){var U=this._globalTileRange;if(!I.wrapLng&&(x.x<U.min.x||x.x>U.max.x)||!I.wrapLat&&(x.y<U.min.y||x.y>U.max.y))return!1}if(!this.options.bounds)return!0;var ne=this._tileCoordsToBounds(x);return un(this.options.bounds).overlaps(ne)},_keyToBounds:function(x){return this._tileCoordsToBounds(this._keyToTileCoords(x))},_tileCoordsToNwSe:function(x){var I=this._map,U=this.getTileSize(),ne=x.scaleBy(U),pe=ne.add(U),Oe=I.unproject(ne,x.z),lt=I.unproject(pe,x.z);return[Oe,lt]},_tileCoordsToBounds:function(x){var I=this._tileCoordsToNwSe(x),U=new rn(I[0],I[1]);return this.options.noWrap||(U=this._map.wrapLatLngBounds(U)),U},_tileCoordsToKey:function(x){return x.x+":"+x.y+":"+x.z},_keyToTileCoords:function(x){var I=x.split(":"),U=new Be(+I[0],+I[1]);return U.z=+I[2],U},_removeTile:function(x){var I=this._tiles[x];I&&(Gi(I.el),delete this._tiles[x],this.fire("tileunload",{tile:I.el,coords:this._keyToTileCoords(x)}))},_initTile:function(x){Wr(x,"leaflet-tile");var I=this.getTileSize();x.style.width=I.x+"px",x.style.height=I.y+"px",x.onselectstart=A,x.onmousemove=A,$e.ielt9&&this.options.opacity<1&&Mo(x,this.options.opacity)},_addTile:function(x,I){var U=this._getTilePos(x),ne=this._tileCoordsToKey(x),pe=this.createTile(this._wrapCoords(x),d(this._tileReady,this,x));this._initTile(pe),this.createTile.length<2&&Fe(d(this._tileReady,this,x,null,pe)),ro(pe,U),this._tiles[ne]={el:pe,coords:x,current:!0},I.appendChild(pe),this.fire("tileloadstart",{tile:pe,coords:x})},_tileReady:function(x,I,U){I&&this.fire("tileerror",{error:I,tile:U,coords:x});var ne=this._tileCoordsToKey(x);U=this._tiles[ne],U&&(U.loaded=+new Date,this._map._fadeAnimated?(Mo(U.el,0),Le(this._fadeFrame),this._fadeFrame=Fe(this._updateOpacity,this)):(U.active=!0,this._pruneTiles()),I||(Wr(U.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:U.el,coords:x})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),$e.ielt9||!this._map._fadeAnimated?Fe(this._pruneTiles,this):setTimeout(d(this._pruneTiles,this),250)))},_getTilePos:function(x){return x.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(x){var I=new Be(this._wrapX?T(x.x,this._wrapX):x.x,this._wrapY?T(x.y,this._wrapY):x.y);return I.z=x.z,I},_pxBoundsToTileRange:function(x){var I=this.getTileSize();return new Mt(x.min.unscaleBy(I).floor(),x.max.unscaleBy(I).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var x in this._tiles)if(!this._tiles[x].loaded)return!1;return!0}});function jm(x){return new Kt(x)}var hc=Kt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(x,I){this._url=x,I=N(this,I),I.detectRetina&&$e.retina&&I.maxZoom>0?(I.tileSize=Math.floor(I.tileSize/2),I.zoomReverse?(I.zoomOffset--,I.minZoom=Math.min(I.maxZoom,I.minZoom+1)):(I.zoomOffset++,I.maxZoom=Math.max(I.minZoom,I.maxZoom-1)),I.minZoom=Math.max(0,I.minZoom)):I.zoomReverse?I.minZoom=Math.min(I.maxZoom,I.minZoom):I.maxZoom=Math.max(I.minZoom,I.maxZoom),typeof I.subdomains=="string"&&(I.subdomains=I.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(x,I){return this._url===x&&I===void 0&&(I=!0),this._url=x,I||this.redraw(),this},createTile:function(x,I){var U=document.createElement("img");return Fr(U,"load",d(this._tileOnLoad,this,I,U)),Fr(U,"error",d(this._tileOnError,this,I,U)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(U.referrerPolicy=this.options.referrerPolicy),U.alt="",U.src=this.getTileUrl(x),U},getTileUrl:function(x){var I={r:$e.retina?"@2x":"",s:this._getSubdomain(x),x:x.x,y:x.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var U=this._globalTileRange.max.y-x.y;this.options.tms&&(I.y=U),I["-y"]=U}return G(this._url,a(I,this.options))},_tileOnLoad:function(x,I){$e.ielt9?setTimeout(d(x,this,null,I),0):x(null,I)},_tileOnError:function(x,I,U){var ne=this.options.errorTileUrl;ne&&I.getAttribute("src")!==ne&&(I.src=ne),x(U,I)},_onTileRemove:function(x){x.tile.onload=null},_getZoomForUrl:function(){var x=this._tileZoom,I=this.options.maxZoom,U=this.options.zoomReverse,ne=this.options.zoomOffset;return U&&(x=I-x),x+ne},_getSubdomain:function(x){var I=Math.abs(x.x+x.y)%this.options.subdomains.length;return this.options.subdomains[I]},_abortLoading:function(){var x,I;for(x in this._tiles)if(this._tiles[x].coords.z!==this._tileZoom&&(I=this._tiles[x].el,I.onload=A,I.onerror=A,!I.complete)){I.src=te;var U=this._tiles[x].coords;Gi(I),delete this._tiles[x],this.fire("tileabort",{tile:I,coords:U})}},_removeTile:function(x){var I=this._tiles[x];if(I)return I.el.setAttribute("src",te),Kt.prototype._removeTile.call(this,x)},_tileReady:function(x,I,U){if(!(!this._map||U&&U.getAttribute("src")===te))return Kt.prototype._tileReady.call(this,x,I,U)}});function bd(x,I){return new hc(x,I)}var Lf=hc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(x,I){this._url=x;var U=a({},this.defaultWmsParams);for(var ne in I)ne in this.options||(U[ne]=I[ne]);I=N(this,I);var pe=I.detectRetina&&$e.retina?2:1,Oe=this.getTileSize();U.width=Oe.x*pe,U.height=Oe.y*pe,this.wmsParams=U},onAdd:function(x){this._crs=this.options.crs||x.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var I=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[I]=this._crs.code,hc.prototype.onAdd.call(this,x)},getTileUrl:function(x){var I=this._tileCoordsToNwSe(x),U=this._crs,ne=Nt(U.project(I[0]),U.project(I[1])),pe=ne.min,Oe=ne.max,lt=(this._wmsVersion>=1.3&&this._crs===Ra?[pe.y,pe.x,Oe.y,Oe.x]:[pe.x,pe.y,Oe.x,Oe.y]).join(","),Rt=hc.prototype.getTileUrl.call(this,x);return Rt+V(this.wmsParams,Rt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+lt},setParams:function(x,I){return a(this.wmsParams,x),I||this.redraw(),this}});function Pu(x,I){return new Lf(x,I)}hc.WMS=Lf,bd.wms=Pu;var Ko=nn.extend({options:{padding:.1},initialize:function(x){N(this,x),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Wr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var x={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(x.zoomanim=this._onAnimZoom),x},_onAnimZoom:function(x){this._updateTransform(x.center,x.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(x,I){var U=this._map.getZoomScale(I,this._zoom),ne=this._map.getSize().multiplyBy(.5+this.options.padding),pe=this._map.project(this._center,I),Oe=ne.multiplyBy(-U).add(pe).subtract(this._map._getNewPixelOrigin(x,I));$e.any3d?Ca(this._container,Oe,U):ro(this._container,Oe)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var x in this._layers)this._layers[x]._reset()},_onZoomEnd:function(){for(var x in this._layers)this._layers[x]._project()},_updatePaths:function(){for(var x in this._layers)this._layers[x]._update()},_update:function(){var x=this.options.padding,I=this._map.getSize(),U=this._map.containerPointToLayerPoint(I.multiplyBy(-x)).round();this._bounds=new Mt(U,U.add(I.multiplyBy(1+x*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Cu=Ko.extend({options:{tolerance:0},getEvents:function(){var x=Ko.prototype.getEvents.call(this);return x.viewprereset=this._onViewPreReset,x},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ko.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var x=this._container=document.createElement("canvas");Fr(x,"mousemove",this._onMouseMove,this),Fr(x,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Fr(x,"mouseout",this._handleMouseOut,this),x._leaflet_disable_events=!0,this._ctx=x.getContext("2d")},_destroyContainer:function(){Le(this._redrawRequest),delete this._ctx,Gi(this._container),Hn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var x;this._redrawBounds=null;for(var I in this._layers)x=this._layers[I],x._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ko.prototype._update.call(this);var x=this._bounds,I=this._container,U=x.getSize(),ne=$e.retina?2:1;ro(I,x.min),I.width=ne*U.x,I.height=ne*U.y,I.style.width=U.x+"px",I.style.height=U.y+"px",$e.retina&&this._ctx.scale(2,2),this._ctx.translate(-x.min.x,-x.min.y),this.fire("update")}},_reset:function(){Ko.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(x){this._updateDashArray(x),this._layers[_(x)]=x;var I=x._order={layer:x,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=I),this._drawLast=I,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(x){this._requestRedraw(x)},_removePath:function(x){var I=x._order,U=I.next,ne=I.prev;U?U.prev=ne:this._drawLast=ne,ne?ne.next=U:this._drawFirst=U,delete x._order,delete this._layers[_(x)],this._requestRedraw(x)},_updatePath:function(x){this._extendRedrawBounds(x),x._project(),x._update(),this._requestRedraw(x)},_updateStyle:function(x){this._updateDashArray(x),this._requestRedraw(x)},_updateDashArray:function(x){if(typeof x.options.dashArray=="string"){var I=x.options.dashArray.split(/[, ]+/),U=[],ne,pe;for(pe=0;pe<I.length;pe++){if(ne=Number(I[pe]),isNaN(ne))return;U.push(ne)}x.options._dashArray=U}else x.options._dashArray=x.options.dashArray},_requestRedraw:function(x){this._map&&(this._extendRedrawBounds(x),this._redrawRequest=this._redrawRequest||Fe(this._redraw,this))},_extendRedrawBounds:function(x){if(x._pxBounds){var I=(x.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Mt,this._redrawBounds.extend(x._pxBounds.min.subtract([I,I])),this._redrawBounds.extend(x._pxBounds.max.add([I,I]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var x=this._redrawBounds;if(x){var I=x.getSize();this._ctx.clearRect(x.min.x,x.min.y,I.x,I.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var x,I=this._redrawBounds;if(this._ctx.save(),I){var U=I.getSize();this._ctx.beginPath(),this._ctx.rect(I.min.x,I.min.y,U.x,U.y),this._ctx.clip()}this._drawing=!0;for(var ne=this._drawFirst;ne;ne=ne.next)x=ne.layer,(!I||x._pxBounds&&x._pxBounds.intersects(I))&&x._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(x,I){if(this._drawing){var U,ne,pe,Oe,lt=x._parts,Rt=lt.length,Ht=this._ctx;if(Rt){for(Ht.beginPath(),U=0;U<Rt;U++){for(ne=0,pe=lt[U].length;ne<pe;ne++)Oe=lt[U][ne],Ht[ne?"lineTo":"moveTo"](Oe.x,Oe.y);I&&Ht.closePath()}this._fillStroke(Ht,x)}}},_updateCircle:function(x){if(!(!this._drawing||x._empty())){var I=x._point,U=this._ctx,ne=Math.max(Math.round(x._radius),1),pe=(Math.max(Math.round(x._radiusY),1)||ne)/ne;pe!==1&&(U.save(),U.scale(1,pe)),U.beginPath(),U.arc(I.x,I.y/pe,ne,0,Math.PI*2,!1),pe!==1&&U.restore(),this._fillStroke(U,x)}},_fillStroke:function(x,I){var U=I.options;U.fill&&(x.globalAlpha=U.fillOpacity,x.fillStyle=U.fillColor||U.color,x.fill(U.fillRule||"evenodd")),U.stroke&&U.weight!==0&&(x.setLineDash&&x.setLineDash(I.options&&I.options._dashArray||[]),x.globalAlpha=U.opacity,x.lineWidth=U.weight,x.strokeStyle=U.color,x.lineCap=U.lineCap,x.lineJoin=U.lineJoin,x.stroke())},_onClick:function(x){for(var I=this._map.mouseEventToLayerPoint(x),U,ne,pe=this._drawFirst;pe;pe=pe.next)U=pe.layer,U.options.interactive&&U._containsPoint(I)&&(!(x.type==="click"||x.type==="preclick")||!this._map._draggableMoved(U))&&(ne=U);this._fireEvent(ne?[ne]:!1,x)},_onMouseMove:function(x){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var I=this._map.mouseEventToLayerPoint(x);this._handleMouseHover(x,I)}},_handleMouseOut:function(x){var I=this._hoveredLayer;I&&(co(this._container,"leaflet-interactive"),this._fireEvent([I],x,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(x,I){if(!this._mouseHoverThrottled){for(var U,ne,pe=this._drawFirst;pe;pe=pe.next)U=pe.layer,U.options.interactive&&U._containsPoint(I)&&(ne=U);ne!==this._hoveredLayer&&(this._handleMouseOut(x),ne&&(Wr(this._container,"leaflet-interactive"),this._fireEvent([ne],x,"mouseover"),this._hoveredLayer=ne)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,x),this._mouseHoverThrottled=!0,setTimeout(d(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(x,I,U){this._map._fireDOMEvent(I,U||I.type,x)},_bringToFront:function(x){var I=x._order;if(I){var U=I.next,ne=I.prev;if(U)U.prev=ne;else return;ne?ne.next=U:U&&(this._drawFirst=U),I.prev=this._drawLast,this._drawLast.next=I,I.next=null,this._drawLast=I,this._requestRedraw(x)}},_bringToBack:function(x){var I=x._order;if(I){var U=I.next,ne=I.prev;if(ne)ne.next=U;else return;U?U.prev=ne:ne&&(this._drawLast=ne),I.prev=null,I.next=this._drawFirst,this._drawFirst.prev=I,this._drawFirst=I,this._requestRedraw(x)}}});function dc(x){return $e.canvas?new Cu(x):null}var fc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(x){return document.createElement("<lvml:"+x+' class="lvml">')}}catch{}return function(x){return document.createElement("<"+x+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Iu={_initContainer:function(){this._container=kr("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ko.prototype._update.call(this),this.fire("update"))},_initPath:function(x){var I=x._container=fc("shape");Wr(I,"leaflet-vml-shape "+(this.options.className||"")),I.coordsize="1 1",x._path=fc("path"),I.appendChild(x._path),this._updateStyle(x),this._layers[_(x)]=x},_addPath:function(x){var I=x._container;this._container.appendChild(I),x.options.interactive&&x.addInteractiveTarget(I)},_removePath:function(x){var I=x._container;Gi(I),x.removeInteractiveTarget(I),delete this._layers[_(x)]},_updateStyle:function(x){var I=x._stroke,U=x._fill,ne=x.options,pe=x._container;pe.stroked=!!ne.stroke,pe.filled=!!ne.fill,ne.stroke?(I||(I=x._stroke=fc("stroke")),pe.appendChild(I),I.weight=ne.weight+"px",I.color=ne.color,I.opacity=ne.opacity,ne.dashArray?I.dashStyle=q(ne.dashArray)?ne.dashArray.join(" "):ne.dashArray.replace(/( *, *)/g," "):I.dashStyle="",I.endcap=ne.lineCap.replace("butt","flat"),I.joinstyle=ne.lineJoin):I&&(pe.removeChild(I),x._stroke=null),ne.fill?(U||(U=x._fill=fc("fill")),pe.appendChild(U),U.color=ne.fillColor||ne.color,U.opacity=ne.fillOpacity):U&&(pe.removeChild(U),x._fill=null)},_updateCircle:function(x){var I=x._point.round(),U=Math.round(x._radius),ne=Math.round(x._radiusY||U);this._setPath(x,x._empty()?"M0 0":"AL "+I.x+","+I.y+" "+U+","+ne+" 0,"+65535*360)},_setPath:function(x,I){x._path.v=I},_bringToFront:function(x){Ml(x._container)},_bringToBack:function(x){rl(x._container)}},pc=$e.vml?fc:Ar,xr=Ko.extend({_initContainer:function(){this._container=pc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Gi(this._container),Hn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ko.prototype._update.call(this);var x=this._bounds,I=x.getSize(),U=this._container;(!this._svgSize||!this._svgSize.equals(I))&&(this._svgSize=I,U.setAttribute("width",I.x),U.setAttribute("height",I.y)),ro(U,x.min),U.setAttribute("viewBox",[x.min.x,x.min.y,I.x,I.y].join(" ")),this.fire("update")}},_initPath:function(x){var I=x._path=pc("path");x.options.className&&Wr(I,x.options.className),x.options.interactive&&Wr(I,"leaflet-interactive"),this._updateStyle(x),this._layers[_(x)]=x},_addPath:function(x){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(x._path),x.addInteractiveTarget(x._path)},_removePath:function(x){Gi(x._path),x.removeInteractiveTarget(x._path),delete this._layers[_(x)]},_updatePath:function(x){x._project(),x._update()},_updateStyle:function(x){var I=x._path,U=x.options;I&&(U.stroke?(I.setAttribute("stroke",U.color),I.setAttribute("stroke-opacity",U.opacity),I.setAttribute("stroke-width",U.weight),I.setAttribute("stroke-linecap",U.lineCap),I.setAttribute("stroke-linejoin",U.lineJoin),U.dashArray?I.setAttribute("stroke-dasharray",U.dashArray):I.removeAttribute("stroke-dasharray"),U.dashOffset?I.setAttribute("stroke-dashoffset",U.dashOffset):I.removeAttribute("stroke-dashoffset")):I.setAttribute("stroke","none"),U.fill?(I.setAttribute("fill",U.fillColor||U.color),I.setAttribute("fill-opacity",U.fillOpacity),I.setAttribute("fill-rule",U.fillRule||"evenodd")):I.setAttribute("fill","none"))},_updatePoly:function(x,I){this._setPath(x,_r(x._parts,I))},_updateCircle:function(x){var I=x._point,U=Math.max(Math.round(x._radius),1),ne=Math.max(Math.round(x._radiusY),1)||U,pe="a"+U+","+ne+" 0 1,0 ",Oe=x._empty()?"M0 0":"M"+(I.x-U)+","+I.y+pe+U*2+",0 "+pe+-U*2+",0 ";this._setPath(x,Oe)},_setPath:function(x,I){x._path.setAttribute("d",I)},_bringToFront:function(x){Ml(x._path)},_bringToBack:function(x){rl(x._path)}});$e.vml&&xr.include(Iu);function zf(x){return $e.svg||$e.vml?new xr(x):null}Ei.include({getRenderer:function(x){var I=x.options.renderer||this._getPaneRenderer(x.options.pane)||this.options.renderer||this._renderer;return I||(I=this._renderer=this._createRenderer()),this.hasLayer(I)||this.addLayer(I),I},_getPaneRenderer:function(x){if(x==="overlayPane"||x===void 0)return!1;var I=this._paneRenderers[x];return I===void 0&&(I=this._createRenderer({pane:x}),this._paneRenderers[x]=I),I},_createRenderer:function(x){return this.options.preferCanvas&&dc(x)||zf(x)}});var F_=Ll.extend({initialize:function(x,I){Ll.prototype.initialize.call(this,this._boundsToLatLngs(x),I)},setBounds:function(x){return this.setLatLngs(this._boundsToLatLngs(x))},_boundsToLatLngs:function(x){return x=un(x),[x.getSouthWest(),x.getNorthWest(),x.getNorthEast(),x.getSouthEast()]}});function B_(x,I){return new F_(x,I)}xr.create=pc,xr.pointsToPath=_r,La.geometryToLayer=Sh,La.coordsToLatLng=yd,La.coordsToLatLngs=cl,La.latLngToCoords=zm,La.latLngsToCoords=kf,La.getFeature=Au,La.asFeature=vd,Ei.mergeOptions({boxZoom:!0});var Nf=ks.extend({initialize:function(x){this._map=x,this._container=x._container,this._pane=x._panes.overlayPane,this._resetStateTimeout=0,x.on("unload",this._destroy,this)},addHooks:function(){Fr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Hn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Gi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(x){if(!x.shiftKey||x.which!==1&&x.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Is(),il(),this._startPoint=this._map.mouseEventToContainerPoint(x),Fr(document,{contextmenu:rc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(x){this._moved||(this._moved=!0,this._box=kr("div","leaflet-zoom-box",this._container),Wr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(x);var I=new Mt(this._point,this._startPoint),U=I.getSize();ro(this._box,I.min),this._box.style.width=U.x+"px",this._box.style.height=U.y+"px"},_finish:function(){this._moved&&(Gi(this._box),co(this._container,"leaflet-crosshair")),Va(),yu(),Hn(document,{contextmenu:rc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(x){if(!(x.which!==1&&x.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(d(this._resetState,this),0);var I=new rn(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(I).fire("boxzoomend",{boxZoomBounds:I})}},_onKeyDown:function(x){x.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ei.addInitHook("addHandler","boxZoom",Nf),Ei.mergeOptions({doubleClickZoom:!0});var Ff=ks.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(x){var I=this._map,U=I.getZoom(),ne=I.options.zoomDelta,pe=x.originalEvent.shiftKey?U-ne:U+ne;I.options.doubleClickZoom==="center"?I.setZoom(pe):I.setZoomAround(x.containerPoint,pe)}});Ei.addInitHook("addHandler","doubleClickZoom",Ff),Ei.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Fi=ks.extend({addHooks:function(){if(!this._draggable){var x=this._map;this._draggable=new ps(x._mapPane,x._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),x.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),x.on("zoomend",this._onZoomEnd,this),x.whenReady(this._onZoomEnd,this))}Wr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){co(this._map._container,"leaflet-grab"),co(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var x=this._map;if(x._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var I=un(this._map.options.maxBounds);this._offsetLimit=Nt(this._map.latLngToContainerPoint(I.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(I.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;x.fire("movestart").fire("dragstart"),x.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(x){if(this._map.options.inertia){var I=this._lastTime=+new Date,U=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(U),this._times.push(I),this._prunePositions(I)}this._map.fire("move",x).fire("drag",x)},_prunePositions:function(x){for(;this._positions.length>1&&x-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var x=this._map.getSize().divideBy(2),I=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=I.subtract(x).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(x,I){return x-(x-I)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var x=this._draggable._newPos.subtract(this._draggable._startPos),I=this._offsetLimit;x.x<I.min.x&&(x.x=this._viscousLimit(x.x,I.min.x)),x.y<I.min.y&&(x.y=this._viscousLimit(x.y,I.min.y)),x.x>I.max.x&&(x.x=this._viscousLimit(x.x,I.max.x)),x.y>I.max.y&&(x.y=this._viscousLimit(x.y,I.max.y)),this._draggable._newPos=this._draggable._startPos.add(x)}},_onPreDragWrap:function(){var x=this._worldWidth,I=Math.round(x/2),U=this._initialWorldOffset,ne=this._draggable._newPos.x,pe=(ne-I+U)%x+I-U,Oe=(ne+I+U)%x-I-U,lt=Math.abs(pe+U)<Math.abs(Oe+U)?pe:Oe;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=lt},_onDragEnd:function(x){var I=this._map,U=I.options,ne=!U.inertia||x.noInertia||this._times.length<2;if(I.fire("dragend",x),ne)I.fire("moveend");else{this._prunePositions(+new Date);var pe=this._lastPos.subtract(this._positions[0]),Oe=(this._lastTime-this._times[0])/1e3,lt=U.easeLinearity,Rt=pe.multiplyBy(lt/Oe),Ht=Rt.distanceTo([0,0]),bn=Math.min(U.inertiaMaxSpeed,Ht),Yn=Rt.multiplyBy(bn/Ht),Ir=bn/(U.inertiaDeceleration*lt),Yr=Yn.multiplyBy(-Ir/2).round();!Yr.x&&!Yr.y?I.fire("moveend"):(Yr=I._limitOffset(Yr,I.options.maxBounds),Fe(function(){I.panBy(Yr,{duration:Ir,easeLinearity:lt,noMoveStart:!0,animate:!0})}))}}});Ei.addInitHook("addHandler","dragging",Fi),Ei.mergeOptions({keyboard:!0,keyboardPanDelta:80});var j_=ks.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(x){this._map=x,this._setPanDelta(x.options.keyboardPanDelta),this._setZoomDelta(x.options.zoomDelta)},addHooks:function(){var x=this._map._container;x.tabIndex<=0&&(x.tabIndex="0"),Fr(x,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Hn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var x=document.body,I=document.documentElement,U=x.scrollTop||I.scrollTop,ne=x.scrollLeft||I.scrollLeft;this._map._container.focus(),window.scrollTo(ne,U)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(x){var I=this._panKeys={},U=this.keyCodes,ne,pe;for(ne=0,pe=U.left.length;ne<pe;ne++)I[U.left[ne]]=[-1*x,0];for(ne=0,pe=U.right.length;ne<pe;ne++)I[U.right[ne]]=[x,0];for(ne=0,pe=U.down.length;ne<pe;ne++)I[U.down[ne]]=[0,x];for(ne=0,pe=U.up.length;ne<pe;ne++)I[U.up[ne]]=[0,-1*x]},_setZoomDelta:function(x){var I=this._zoomKeys={},U=this.keyCodes,ne,pe;for(ne=0,pe=U.zoomIn.length;ne<pe;ne++)I[U.zoomIn[ne]]=x;for(ne=0,pe=U.zoomOut.length;ne<pe;ne++)I[U.zoomOut[ne]]=-x},_addHooks:function(){Fr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Hn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(x){if(!(x.altKey||x.ctrlKey||x.metaKey)){var I=x.keyCode,U=this._map,ne;if(I in this._panKeys){if(!U._panAnim||!U._panAnim._inProgress)if(ne=this._panKeys[I],x.shiftKey&&(ne=at(ne).multiplyBy(3)),U.options.maxBounds&&(ne=U._limitOffset(at(ne),U.options.maxBounds)),U.options.worldCopyJump){var pe=U.wrapLatLng(U.unproject(U.project(U.getCenter()).add(ne)));U.panTo(pe)}else U.panBy(ne)}else if(I in this._zoomKeys)U.setZoom(U.getZoom()+(x.shiftKey?3:1)*this._zoomKeys[I]);else if(I===27&&U._popup&&U._popup.options.closeOnEscapeKey)U.closePopup();else return;rc(x)}}});Ei.addInitHook("addHandler","keyboard",j_),Ei.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var $_=ks.extend({addHooks:function(){Fr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Hn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(x){var I=hd(x),U=this._map.options.wheelDebounceTime;this._delta+=I,this._lastMousePos=this._map.mouseEventToContainerPoint(x),this._startTime||(this._startTime=+new Date);var ne=Math.max(U-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d(this._performZoom,this),ne),rc(x)},_performZoom:function(){var x=this._map,I=x.getZoom(),U=this._map.options.zoomSnap||0;x._stop();var ne=this._delta/(this._map.options.wheelPxPerZoomLevel*4),pe=4*Math.log(2/(1+Math.exp(-Math.abs(ne))))/Math.LN2,Oe=U?Math.ceil(pe/U)*U:pe,lt=x._limitZoom(I+(this._delta>0?Oe:-Oe))-I;this._delta=0,this._startTime=null,lt&&(x.options.scrollWheelZoom==="center"?x.setZoom(I+lt):x.setZoomAround(this._lastMousePos,I+lt))}});Ei.addInitHook("addHandler","scrollWheelZoom",$_);var fx=600;Ei.mergeOptions({tapHold:$e.touchNative&&$e.safari&&$e.mobile,tapTolerance:15});var $m=ks.extend({addHooks:function(){Fr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Hn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(x){if(clearTimeout(this._holdTimeout),x.touches.length===1){var I=x.touches[0];this._startPos=this._newPos=new Be(I.clientX,I.clientY),this._holdTimeout=setTimeout(d(function(){this._cancel(),this._isTapValid()&&(Fr(document,"touchend",ya),Fr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",I))},this),fx),Fr(document,"touchend touchcancel contextmenu",this._cancel,this),Fr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function x(){Hn(document,"touchend",ya),Hn(document,"touchend touchcancel",x)},_cancel:function(){clearTimeout(this._holdTimeout),Hn(document,"touchend touchcancel contextmenu",this._cancel,this),Hn(document,"touchmove",this._onMove,this)},_onMove:function(x){var I=x.touches[0];this._newPos=new Be(I.clientX,I.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(x,I){var U=new MouseEvent(x,{bubbles:!0,cancelable:!0,view:window,screenX:I.screenX,screenY:I.screenY,clientX:I.clientX,clientY:I.clientY});U._simulated=!0,I.target.dispatchEvent(U)}});Ei.addInitHook("addHandler","tapHold",$m),Ei.mergeOptions({touchZoom:$e.touch,bounceAtZoomLimits:!0});var U_=ks.extend({addHooks:function(){Wr(this._map._container,"leaflet-touch-zoom"),Fr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){co(this._map._container,"leaflet-touch-zoom"),Hn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(x){var I=this._map;if(!(!x.touches||x.touches.length!==2||I._animatingZoom||this._zooming)){var U=I.mouseEventToContainerPoint(x.touches[0]),ne=I.mouseEventToContainerPoint(x.touches[1]);this._centerPoint=I.getSize()._divideBy(2),this._startLatLng=I.containerPointToLatLng(this._centerPoint),I.options.touchZoom!=="center"&&(this._pinchStartLatLng=I.containerPointToLatLng(U.add(ne)._divideBy(2))),this._startDist=U.distanceTo(ne),this._startZoom=I.getZoom(),this._moved=!1,this._zooming=!0,I._stop(),Fr(document,"touchmove",this._onTouchMove,this),Fr(document,"touchend touchcancel",this._onTouchEnd,this),ya(x)}},_onTouchMove:function(x){if(!(!x.touches||x.touches.length!==2||!this._zooming)){var I=this._map,U=I.mouseEventToContainerPoint(x.touches[0]),ne=I.mouseEventToContainerPoint(x.touches[1]),pe=U.distanceTo(ne)/this._startDist;if(this._zoom=I.getScaleZoom(pe,this._startZoom),!I.options.bounceAtZoomLimits&&(this._zoom<I.getMinZoom()&&pe<1||this._zoom>I.getMaxZoom()&&pe>1)&&(this._zoom=I._limitZoom(this._zoom)),I.options.touchZoom==="center"){if(this._center=this._startLatLng,pe===1)return}else{var Oe=U._add(ne)._divideBy(2)._subtract(this._centerPoint);if(pe===1&&Oe.x===0&&Oe.y===0)return;this._center=I.unproject(I.project(this._pinchStartLatLng,this._zoom).subtract(Oe),this._zoom)}this._moved||(I._moveStart(!0,!1),this._moved=!0),Le(this._animRequest);var lt=d(I._move,I,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Fe(lt,this,!0),ya(x)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Le(this._animRequest),Hn(document,"touchmove",this._onTouchMove,this),Hn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ei.addInitHook("addHandler","touchZoom",U_),Ei.BoxZoom=Nf,Ei.DoubleClickZoom=Ff,Ei.Drag=Fi,Ei.Keyboard=j_,Ei.ScrollWheelZoom=$_,Ei.TapHold=$m,Ei.TouchZoom=U_,n.Bounds=Mt,n.Browser=$e,n.CRS=Vt,n.Canvas=Cu,n.Circle=lc,n.CircleMarker=sc,n.Class=He,n.Control=fs,n.DivIcon=ms,n.DivOverlay=Uo,n.DomEvent=ds,n.DomUtil=R_,n.Draggable=ps,n.Evented=rt,n.FeatureGroup=ns,n.GeoJSON=La,n.GridLayer=Kt,n.Handler=ks,n.Icon=Fn,n.ImageOverlay=ul,n.LatLng=en,n.LatLngBounds=rn,n.Layer=nn,n.LayerGroup=Dl,n.LineUtil=sl,n.Map=Ei,n.Marker=Tu,n.Mixin=pd,n.Path=Eo,n.Point=Be,n.PolyUtil=Gr,n.Polygon=Ll,n.Polyline=bo,n.Popup=uc,n.PosAnimation=ic,n.Projection=bh,n.Rectangle=F_,n.Renderer=Ko,n.SVG=xr,n.SVGOverlay=Th,n.TileLayer=hc,n.Tooltip=Ah,n.Transformation=hn,n.Util=Ze,n.VideoOverlay=Fm,n.bind=d,n.bounds=Nt,n.canvas=dc,n.circle=Eu,n.circleMarker=$c,n.control=ol,n.divIcon=Df,n.extend=a,n.featureGroup=wh,n.geoJSON=xd,n.geoJson=z_,n.gridLayer=jm,n.icon=L_,n.imageOverlay=N_,n.latLng=sn,n.latLngBounds=un,n.layerGroup=Un,n.map=km,n.marker=Da,n.point=at,n.polygon=dx,n.polyline=_d,n.popup=Eh,n.rectangle=B_,n.setOptions=N,n.stamp=_,n.svg=zf,n.svgOverlay=Bm,n.tileLayer=bd,n.tooltip=Rf,n.transformation=yt,n.version=r,n.videoOverlay=cc;var Bf=window.L;n.noConflict=function(){return window.L=Bf,this},window.L=n})})(Fz,Fz.exports);var hx=Fz.exports;const pQe=lo(hx);function UI(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function VI(e,t){return t==null?function(r,a){const c=X.useRef(void 0);return c.current||(c.current=e(r,a)),c}:function(r,a){const c=X.useRef(void 0);c.current||(c.current=e(r,a));const d=X.useRef(r),{instance:i}=c.current;return X.useEffect(function(){d.current!==r&&(t(i,r,d.current),d.current=r)},[i,r,t]),c}}function wne(e,t){X.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var c;(c=t.layerContainer)==null||c.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Sne(e){return function(n){const r=jI(),a=e($I(n,r),r);return vne(r.map,n.attribution),uB(a.current,n.eventHandlers),wne(a.current,r),a}}function BGe(e,t){const n=X.useRef(void 0);X.useEffect(function(){if(t.pathOptions!==n.current){const a=t.pathOptions??{};e.instance.setStyle(a),n.current=a}},[e,t])}function jGe(e){return function(n){const r=jI(),a=e($I(n,r),r);return uB(a.current,n.eventHandlers),wne(a.current,r),BGe(a.current,n),a}}function $Ge(e,t){const n=VI(e,t),r=Sne(n);return bne(r)}function UGe(e,t){const n=VI(e),r=FGe(n,t);return zGe(r)}function VGe(e,t){const n=VI(e,t),r=jGe(n);return bne(r)}function WGe(e,t){const n=VI(e,t),r=Sne(n);return NGe(r)}function GGe(e,t,n){const{opacity:r,zIndex:a}=t;r!=null&&r!==n.opacity&&e.setOpacity(r),a!=null&&a!==n.zIndex&&e.setZIndex(a)}function mQe(){return jI().map}function HGe({bounds:e,boundsOptions:t,center:n,children:r,className:a,id:c,placeholder:d,style:i,whenReady:_,zoom:b,...T},A){const[k]=X.useState({className:a,id:c,style:i}),[R,B]=X.useState(null),N=X.useRef(void 0);X.useImperativeHandle(A,()=>(R==null?void 0:R.map)??null,[R]);const V=X.useCallback(G=>{if(G!==null&&!N.current){const q=new hx.Map(G,T);N.current=q,n!=null&&b!=null?q.setView(n,b):e!=null&&q.fitBounds(e,t),_!=null&&q.whenReady(_),B(LGe(q))}},[]);X.useEffect(()=>()=>{R==null||R.map.remove()},[R]);const H=R?Ce.createElement(cB,{value:R},r):d??null;return Ce.createElement("div",{...k,ref:V},H)}const gQe=X.forwardRef(HGe),_Qe=$Ge(function({position:t,...n},r){const a=new hx.Marker(t,n);return UI(a,xne(r,{overlayContainer:a}))},function(t,n,r){n.position!==r.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),yQe=VGe(function({positions:t,...n},r){const a=new hx.Polyline(t,n);return UI(a,xne(r,{overlayContainer:a}))},function(t,n,r){n.positions!==r.positions&&t.setLatLngs(n.positions)}),vQe=UGe(function(t,n){const r=new hx.Popup(t,n.overlayContainer);return UI(r,n)},function(t,n,{position:r},a){X.useEffect(function(){const{instance:d}=t;function i(b){b.popup===d&&(d.update(),a(!0))}function _(b){b.popup===d&&a(!1)}return n.map.on({popupopen:i,popupclose:_}),n.overlayContainer==null?(r!=null&&d.setLatLng(r),d.openOn(n.map)):n.overlayContainer.bindPopup(d),function(){var T;n.map.off({popupopen:i,popupclose:_}),(T=n.overlayContainer)==null||T.unbindPopup(),n.map.removeLayer(d)}},[t,n,a,r])}),xQe=WGe(function({url:t,...n},r){const a=new hx.TileLayer(t,$I(n,r));return UI(a,r)},function(t,n,r){GGe(t,n,r);const{url:a}=n;a!=null&&a!==r.url&&t.setUrl(a)});var[WI,bQe]=Al("Tooltip",[xm]),GI=xm(),Tne="TooltipProvider",qGe=700,Bz="tooltip.open",[ZGe,hB]=WI(Tne),Ene=e=>{const{__scopeTooltip:t,delayDuration:n=qGe,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:c}=e,[d,i]=X.useState(!0),_=X.useRef(!1),b=X.useRef(0);return X.useEffect(()=>{const T=b.current;return()=>window.clearTimeout(T)},[]),_e.jsx(ZGe,{scope:t,isOpenDelayed:d,delayDuration:n,onOpen:X.useCallback(()=>{window.clearTimeout(b.current),i(!1)},[]),onClose:X.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>i(!0),r)},[r]),isPointerInTransitRef:_,onPointerInTransitChange:X.useCallback(T=>{_.current=T},[]),disableHoverableContent:a,children:c})};Ene.displayName=Tne;var HI="Tooltip",[XGe,qI]=WI(HI),Ane=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:c,disableHoverableContent:d,delayDuration:i}=e,_=hB(HI,e.__scopeTooltip),b=GI(t),[T,A]=X.useState(null),k=el(),R=X.useRef(0),B=d??_.disableHoverableContent,N=i??_.delayDuration,V=X.useRef(!1),[H=!1,G]=Sl({prop:r,defaultProp:a,onChange:fe=>{fe?(_.onOpen(),document.dispatchEvent(new CustomEvent(Bz))):_.onClose(),c==null||c(fe)}}),q=X.useMemo(()=>H?V.current?"delayed-open":"instant-open":"closed",[H]),Q=X.useCallback(()=>{window.clearTimeout(R.current),R.current=0,V.current=!1,G(!0)},[G]),te=X.useCallback(()=>{window.clearTimeout(R.current),R.current=0,G(!1)},[G]),ue=X.useCallback(()=>{window.clearTimeout(R.current),R.current=window.setTimeout(()=>{V.current=!0,G(!0),R.current=0},N)},[N,G]);return X.useEffect(()=>()=>{R.current&&(window.clearTimeout(R.current),R.current=0)},[]),_e.jsx(TC,{...b,children:_e.jsx(XGe,{scope:t,contentId:k,open:H,stateAttribute:q,trigger:T,onTriggerChange:A,onTriggerEnter:X.useCallback(()=>{_.isOpenDelayed?ue():Q()},[_.isOpenDelayed,ue,Q]),onTriggerLeave:X.useCallback(()=>{B?te():(window.clearTimeout(R.current),R.current=0)},[te,B]),onOpen:Q,onClose:te,disableHoverableContent:B,children:n})})};Ane.displayName=HI;var jz="TooltipTrigger",Pne=X.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=qI(jz,n),c=hB(jz,n),d=GI(n),i=X.useRef(null),_=Xr(t,i,a.onTriggerChange),b=X.useRef(!1),T=X.useRef(!1),A=X.useCallback(()=>b.current=!1,[]);return X.useEffect(()=>()=>document.removeEventListener("pointerup",A),[A]),_e.jsx(TS,{asChild:!0,...d,children:_e.jsx(Qn.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:_,onPointerMove:On(e.onPointerMove,k=>{k.pointerType!=="touch"&&!T.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),T.current=!0)}),onPointerLeave:On(e.onPointerLeave,()=>{a.onTriggerLeave(),T.current=!1}),onPointerDown:On(e.onPointerDown,()=>{b.current=!0,document.addEventListener("pointerup",A,{once:!0})}),onFocus:On(e.onFocus,()=>{b.current||a.onOpen()}),onBlur:On(e.onBlur,a.onClose),onClick:On(e.onClick,a.onClose)})})});Pne.displayName=jz;var KGe="TooltipPortal",[wQe,YGe]=WI(KGe,{forceMount:void 0}),I0="TooltipContent",Cne=X.forwardRef((e,t)=>{const n=YGe(I0,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...c}=e,d=qI(I0,e.__scopeTooltip);return _e.jsx(Aa,{present:r||d.open,children:d.disableHoverableContent?_e.jsx(Ine,{side:a,...c,ref:t}):_e.jsx(JGe,{side:a,...c,ref:t})})}),JGe=X.forwardRef((e,t)=>{const n=qI(I0,e.__scopeTooltip),r=hB(I0,e.__scopeTooltip),a=X.useRef(null),c=Xr(t,a),[d,i]=X.useState(null),{trigger:_,onClose:b}=n,T=a.current,{onPointerInTransitChange:A}=r,k=X.useCallback(()=>{i(null),A(!1)},[A]),R=X.useCallback((B,N)=>{const V=B.currentTarget,H={x:B.clientX,y:B.clientY},G=nHe(H,V.getBoundingClientRect()),q=rHe(H,G),Q=iHe(N.getBoundingClientRect()),te=aHe([...q,...Q]);i(te),A(!0)},[A]);return X.useEffect(()=>()=>k(),[k]),X.useEffect(()=>{if(_&&T){const B=V=>R(V,T),N=V=>R(V,_);return _.addEventListener("pointerleave",B),T.addEventListener("pointerleave",N),()=>{_.removeEventListener("pointerleave",B),T.removeEventListener("pointerleave",N)}}},[_,T,R,k]),X.useEffect(()=>{if(d){const B=N=>{const V=N.target,H={x:N.clientX,y:N.clientY},G=(_==null?void 0:_.contains(V))||(T==null?void 0:T.contains(V)),q=!oHe(H,d);G?k():q&&(k(),b())};return document.addEventListener("pointermove",B),()=>document.removeEventListener("pointermove",B)}},[_,T,d,b,k]),_e.jsx(Ine,{...e,ref:c})}),[QGe,eHe]=WI(HI,{isInside:!1}),Ine=X.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:d,...i}=e,_=qI(I0,n),b=GI(n),{onClose:T}=_;return X.useEffect(()=>(document.addEventListener(Bz,T),()=>document.removeEventListener(Bz,T)),[T]),X.useEffect(()=>{if(_.trigger){const A=k=>{const R=k.target;R!=null&&R.contains(_.trigger)&&T()};return window.addEventListener("scroll",A,{capture:!0}),()=>window.removeEventListener("scroll",A,{capture:!0})}},[_.trigger,T]),_e.jsx(T_,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:A=>A.preventDefault(),onDismiss:T,children:_e.jsxs(EC,{"data-state":_.stateAttribute,...b,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[_e.jsx(H3,{children:r}),_e.jsx(QGe,{scope:n,isInside:!0,children:_e.jsx(MX,{id:_.contentId,role:"tooltip",children:a||r})})]})})});Cne.displayName=I0;var Mne="TooltipArrow",tHe=X.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=GI(n);return eHe(Mne,n).isInside?null:_e.jsx(AC,{...a,...r,ref:t})});tHe.displayName=Mne;function nHe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),c=Math.abs(t.left-e.x);switch(Math.min(n,r,a,c)){case c:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function rHe(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function iHe(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function oHe(e,t){const{x:n,y:r}=e;let a=!1;for(let c=0,d=t.length-1;c<t.length;d=c++){const i=t[c].x,_=t[c].y,b=t[d].x,T=t[d].y;_>r!=T>r&&n<(b-i)*(r-_)/(T-_)+i&&(a=!a)}return a}function aHe(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),sHe(t)}function sHe(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const c=t[t.length-1],d=t[t.length-2];if((c.x-d.x)*(a.y-d.y)>=(c.y-d.y)*(a.x-d.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const c=n[n.length-1],d=n[n.length-2];if((c.x-d.x)*(a.y-d.y)>=(c.y-d.y)*(a.x-d.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var SQe=Ene,TQe=Ane,EQe=Pne,AQe=Cne,dB="Dialog",[One,kne]=Al(dB),[lHe,fh]=One(dB),Rne=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:d=!0}=e,i=X.useRef(null),_=X.useRef(null),[b=!1,T]=Sl({prop:r,defaultProp:a,onChange:c});return _e.jsx(lHe,{scope:t,triggerRef:i,contentRef:_,contentId:el(),titleId:el(),descriptionId:el(),open:b,onOpenChange:T,onOpenToggle:X.useCallback(()=>T(A=>!A),[T]),modal:d,children:n})};Rne.displayName=dB;var Dne="DialogTrigger",Lne=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fh(Dne,n),c=Xr(t,a.triggerRef);return _e.jsx(Qn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":mB(a.open),...r,ref:c,onClick:On(e.onClick,a.onOpenToggle)})});Lne.displayName=Dne;var fB="DialogPortal",[cHe,zne]=One(fB,{forceMount:void 0}),Nne=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,c=fh(fB,t);return _e.jsx(cHe,{scope:t,forceMount:n,children:X.Children.map(r,d=>_e.jsx(Aa,{present:n||c.open,children:_e.jsx(ES,{asChild:!0,container:a,children:d})}))})};Nne.displayName=fB;var $P="DialogOverlay",Fne=X.forwardRef((e,t)=>{const n=zne($P,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=fh($P,e.__scopeDialog);return c.modal?_e.jsx(Aa,{present:r||c.open,children:_e.jsx(uHe,{...a,ref:t})}):null});Fne.displayName=$P;var uHe=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fh($P,n);return _e.jsx(PS,{as:rm,allowPinchZoom:!0,shards:[a.contentRef],children:_e.jsx(Qn.div,{"data-state":mB(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),m_="DialogContent",Bne=X.forwardRef((e,t)=>{const n=zne(m_,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=fh(m_,e.__scopeDialog);return _e.jsx(Aa,{present:r||c.open,children:c.modal?_e.jsx(hHe,{...a,ref:t}):_e.jsx(dHe,{...a,ref:t})})});Bne.displayName=m_;var hHe=X.forwardRef((e,t)=>{const n=fh(m_,e.__scopeDialog),r=X.useRef(null),a=Xr(t,n.contentRef,r);return X.useEffect(()=>{const c=r.current;if(c)return AS(c)},[]),_e.jsx(jne,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:On(e.onCloseAutoFocus,c=>{var d;c.preventDefault(),(d=n.triggerRef.current)==null||d.focus()}),onPointerDownOutside:On(e.onPointerDownOutside,c=>{const d=c.detail.originalEvent,i=d.button===0&&d.ctrlKey===!0;(d.button===2||i)&&c.preventDefault()}),onFocusOutside:On(e.onFocusOutside,c=>c.preventDefault())})}),dHe=X.forwardRef((e,t)=>{const n=fh(m_,e.__scopeDialog),r=X.useRef(!1),a=X.useRef(!1);return _e.jsx(jne,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d,i;(d=e.onCloseAutoFocus)==null||d.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(d))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),jne=X.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,...d}=e,i=fh(m_,n),_=X.useRef(null),b=Xr(t,_);return xC(),_e.jsxs(_e.Fragment,{children:[_e.jsx(wS,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:_e.jsx(T_,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":mB(i.open),...d,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),_e.jsxs(_e.Fragment,{children:[_e.jsx(pHe,{titleId:i.titleId}),_e.jsx(gHe,{contentRef:_,descriptionId:i.descriptionId})]})]})}),pB="DialogTitle",$ne=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fh(pB,n);return _e.jsx(Qn.h2,{id:a.titleId,...r,ref:t})});$ne.displayName=pB;var Une="DialogDescription",Vne=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fh(Une,n);return _e.jsx(Qn.p,{id:a.descriptionId,...r,ref:t})});Vne.displayName=Une;var Wne="DialogClose",Gne=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fh(Wne,n);return _e.jsx(Qn.button,{type:"button",...r,ref:t,onClick:On(e.onClick,()=>a.onOpenChange(!1))})});Gne.displayName=Wne;function mB(e){return e?"open":"closed"}var Hne="DialogTitleWarning",[fHe,qne]=ame(Hne,{contentName:m_,titleName:pB,docsSlug:"dialog"}),pHe=({titleId:e})=>{const t=qne(Hne),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return X.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},mHe="DialogDescriptionWarning",gHe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${qne(mHe).contentName}}.`;return X.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},_He=Rne,yHe=Lne,vHe=Nne,xHe=Fne,bHe=Bne,wHe=$ne,SHe=Vne,Zne=Gne,Xne="AlertDialog",[THe,PQe]=Al(Xne,[kne]),Ef=kne(),Kne=e=>{const{__scopeAlertDialog:t,...n}=e,r=Ef(t);return _e.jsx(_He,{...r,...n,modal:!0})};Kne.displayName=Xne;var EHe="AlertDialogTrigger",Yne=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ef(n);return _e.jsx(yHe,{...a,...r,ref:t})});Yne.displayName=EHe;var AHe="AlertDialogPortal",Jne=e=>{const{__scopeAlertDialog:t,...n}=e,r=Ef(t);return _e.jsx(vHe,{...r,...n})};Jne.displayName=AHe;var PHe="AlertDialogOverlay",Qne=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ef(n);return _e.jsx(xHe,{...a,...r,ref:t})});Qne.displayName=PHe;var Dv="AlertDialogContent",[CHe,IHe]=THe(Dv),ere=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,c=Ef(n),d=X.useRef(null),i=Xr(t,d),_=X.useRef(null);return _e.jsx(fHe,{contentName:Dv,titleName:tre,docsSlug:"alert-dialog",children:_e.jsx(CHe,{scope:n,cancelRef:_,children:_e.jsxs(bHe,{role:"alertdialog",...c,...a,ref:i,onOpenAutoFocus:On(a.onOpenAutoFocus,b=>{var T;b.preventDefault(),(T=_.current)==null||T.focus({preventScroll:!0})}),onPointerDownOutside:b=>b.preventDefault(),onInteractOutside:b=>b.preventDefault(),children:[_e.jsx(H3,{children:r}),_e.jsx(OHe,{contentRef:d})]})})})});ere.displayName=Dv;var tre="AlertDialogTitle",nre=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ef(n);return _e.jsx(wHe,{...a,...r,ref:t})});nre.displayName=tre;var rre="AlertDialogDescription",ire=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ef(n);return _e.jsx(SHe,{...a,...r,ref:t})});ire.displayName=rre;var MHe="AlertDialogAction",ore=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ef(n);return _e.jsx(Zne,{...a,...r,ref:t})});ore.displayName=MHe;var are="AlertDialogCancel",sre=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=IHe(are,n),c=Ef(n),d=Xr(t,a);return _e.jsx(Zne,{...c,...r,ref:d})});sre.displayName=are;var OHe=({contentRef:e})=>{const t=`\`${Dv}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Dv}\` by passing a \`${rre}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Dv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return X.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},CQe=Kne,IQe=Yne,MQe=Jne,OQe=Qne,kQe=ere,RQe=ore,DQe=sre,LQe=nre,zQe=ire,gB="Switch",[kHe,NQe]=Al(gB),[RHe,DHe]=kHe(gB),lre=X.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:a,defaultChecked:c,required:d,disabled:i,value:_="on",onCheckedChange:b,form:T,...A}=e,[k,R]=X.useState(null),B=Xr(t,q=>R(q)),N=X.useRef(!1),V=k?T||!!k.closest("form"):!0,[H=!1,G]=Sl({prop:a,defaultProp:c,onChange:b});return _e.jsxs(RHe,{scope:n,checked:H,disabled:i,children:[_e.jsx(Qn.button,{type:"button",role:"switch","aria-checked":H,"aria-required":d,"data-state":hre(H),"data-disabled":i?"":void 0,disabled:i,value:_,...A,ref:B,onClick:On(e.onClick,q=>{G(Q=>!Q),V&&(N.current=q.isPropagationStopped(),N.current||q.stopPropagation())})}),V&&_e.jsx(LHe,{control:k,bubbles:!N.current,name:r,value:_,checked:H,required:d,disabled:i,form:T,style:{transform:"translateX(-100%)"}})]})});lre.displayName=gB;var cre="SwitchThumb",ure=X.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,a=DHe(cre,n);return _e.jsx(Qn.span,{"data-state":hre(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});ure.displayName=cre;var LHe=e=>{const{control:t,checked:n,bubbles:r=!0,...a}=e,c=X.useRef(null),d=kC(n),i=sN(t);return X.useEffect(()=>{const _=c.current,b=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(b,"checked").set;if(d!==n&&A){const k=new Event("click",{bubbles:r});A.call(_,n),_.dispatchEvent(k)}},[d,n,r]),_e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:c,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function hre(e){return e?"checked":"unchecked"}var FQe=lre,BQe=ure;function zHe(e){return e}var xR=1,bR=2,$z=3,db=4,PH=1e-6;function NHe(e){return"translate("+e+",0)"}function FHe(e){return"translate(0,"+e+")"}function BHe(e){return t=>+e(t)}function jHe(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function $He(){return!this.__axis}function dre(e,t){var n=[],r=null,a=null,c=6,d=6,i=3,_=typeof window<"u"&&window.devicePixelRatio>1?0:.5,b=e===xR||e===db?-1:1,T=e===db||e===bR?"x":"y",A=e===xR||e===$z?NHe:FHe;function k(R){var B=r??(t.ticks?t.ticks.apply(t,n):t.domain()),N=a??(t.tickFormat?t.tickFormat.apply(t,n):zHe),V=Math.max(c,0)+i,H=t.range(),G=+H[0]+_,q=+H[H.length-1]+_,Q=(t.bandwidth?jHe:BHe)(t.copy(),_),te=R.selection?R.selection():R,ue=te.selectAll(".domain").data([null]),fe=te.selectAll(".tick").data(B,t).order(),ye=fe.exit(),De=fe.enter().append("g").attr("class","tick"),Ne=fe.select("line"),Fe=fe.select("text");ue=ue.merge(ue.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),fe=fe.merge(De),Ne=Ne.merge(De.append("line").attr("stroke","currentColor").attr(T+"2",b*c)),Fe=Fe.merge(De.append("text").attr("fill","currentColor").attr(T,b*V).attr("dy",e===xR?"0em":e===$z?"0.71em":"0.32em")),R!==te&&(ue=ue.transition(R),fe=fe.transition(R),Ne=Ne.transition(R),Fe=Fe.transition(R),ye=ye.transition(R).attr("opacity",PH).attr("transform",function(Le){return isFinite(Le=Q(Le))?A(Le+_):this.getAttribute("transform")}),De.attr("opacity",PH).attr("transform",function(Le){var Ze=this.parentNode.__axis;return A((Ze&&isFinite(Ze=Ze(Le))?Ze:Q(Le))+_)})),ye.remove(),ue.attr("d",e===db||e===bR?d?"M"+b*d+","+G+"H"+_+"V"+q+"H"+b*d:"M"+_+","+G+"V"+q:d?"M"+G+","+b*d+"V"+_+"H"+q+"V"+b*d:"M"+G+","+_+"H"+q),fe.attr("opacity",1).attr("transform",function(Le){return A(Q(Le)+_)}),Ne.attr(T+"2",b*c),Fe.attr(T,b*V).text(N),te.filter($He).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===bR?"start":e===db?"end":"middle"),te.each(function(){this.__axis=Q})}return k.scale=function(R){return arguments.length?(t=R,k):t},k.ticks=function(){return n=Array.from(arguments),k},k.tickArguments=function(R){return arguments.length?(n=R==null?[]:Array.from(R),k):n.slice()},k.tickValues=function(R){return arguments.length?(r=R==null?null:Array.from(R),k):r&&r.slice()},k.tickFormat=function(R){return arguments.length?(a=R,k):a},k.tickSize=function(R){return arguments.length?(c=d=+R,k):c},k.tickSizeInner=function(R){return arguments.length?(c=+R,k):c},k.tickSizeOuter=function(R){return arguments.length?(d=+R,k):d},k.tickPadding=function(R){return arguments.length?(i=+R,k):i},k.offset=function(R){return arguments.length?(_=+R,k):_},k}function jQe(e){return dre($z,e)}function $Qe(e){return dre(db,e)}var UHe={value:()=>{}};function fre(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new D2(n)}function D2(e){this._=e}function VHe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}D2.prototype=fre.prototype={constructor:D2,on:function(e,t){var n=this._,r=VHe(e+"",n),a,c=-1,d=r.length;if(arguments.length<2){for(;++c<d;)if((a=(e=r[c]).type)&&(a=WHe(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++c<d;)if(a=(e=r[c]).type)n[a]=CH(n[a],e.name,t);else if(t==null)for(a in n)n[a]=CH(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new D2(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,c;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(c=this._[e],r=0,a=c.length;r<a;++r)c[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,c=r.length;a<c;++a)r[a].value.apply(t,n)}};function WHe(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function CH(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=UHe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Uz="http://www.w3.org/1999/xhtml";const IH={svg:"http://www.w3.org/2000/svg",xhtml:Uz,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ZI(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),IH.hasOwnProperty(t)?{space:IH[t],local:e}:e}function GHe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Uz&&t.documentElement.namespaceURI===Uz?t.createElement(e):t.createElementNS(n,e)}}function HHe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pre(e){var t=ZI(e);return(t.local?HHe:GHe)(t)}function qHe(){}function _B(e){return e==null?qHe:function(){return this.querySelector(e)}}function ZHe(e){typeof e!="function"&&(e=_B(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],d=c.length,i=r[a]=new Array(d),_,b,T=0;T<d;++T)(_=c[T])&&(b=e.call(_,_.__data__,T,c))&&("__data__"in _&&(b.__data__=_.__data__),i[T]=b);return new Lc(r,this._parents)}function XHe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function KHe(){return[]}function mre(e){return e==null?KHe:function(){return this.querySelectorAll(e)}}function YHe(e){return function(){return XHe(e.apply(this,arguments))}}function JHe(e){typeof e=="function"?e=YHe(e):e=mre(e);for(var t=this._groups,n=t.length,r=[],a=[],c=0;c<n;++c)for(var d=t[c],i=d.length,_,b=0;b<i;++b)(_=d[b])&&(r.push(e.call(_,_.__data__,b,d)),a.push(_));return new Lc(r,a)}function gre(e){return function(){return this.matches(e)}}function _re(e){return function(t){return t.matches(e)}}var QHe=Array.prototype.find;function e9e(e){return function(){return QHe.call(this.children,e)}}function t9e(){return this.firstElementChild}function n9e(e){return this.select(e==null?t9e:e9e(typeof e=="function"?e:_re(e)))}var r9e=Array.prototype.filter;function i9e(){return Array.from(this.children)}function o9e(e){return function(){return r9e.call(this.children,e)}}function a9e(e){return this.selectAll(e==null?i9e:o9e(typeof e=="function"?e:_re(e)))}function s9e(e){typeof e!="function"&&(e=gre(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],d=c.length,i=r[a]=[],_,b=0;b<d;++b)(_=c[b])&&e.call(_,_.__data__,b,c)&&i.push(_);return new Lc(r,this._parents)}function yre(e){return new Array(e.length)}function l9e(){return new Lc(this._enter||this._groups.map(yre),this._parents)}function UP(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}UP.prototype={constructor:UP,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function c9e(e){return function(){return e}}function u9e(e,t,n,r,a,c){for(var d=0,i,_=t.length,b=c.length;d<b;++d)(i=t[d])?(i.__data__=c[d],r[d]=i):n[d]=new UP(e,c[d]);for(;d<_;++d)(i=t[d])&&(a[d]=i)}function h9e(e,t,n,r,a,c,d){var i,_,b=new Map,T=t.length,A=c.length,k=new Array(T),R;for(i=0;i<T;++i)(_=t[i])&&(k[i]=R=d.call(_,_.__data__,i,t)+"",b.has(R)?a[i]=_:b.set(R,_));for(i=0;i<A;++i)R=d.call(e,c[i],i,c)+"",(_=b.get(R))?(r[i]=_,_.__data__=c[i],b.delete(R)):n[i]=new UP(e,c[i]);for(i=0;i<T;++i)(_=t[i])&&b.get(k[i])===_&&(a[i]=_)}function d9e(e){return e.__data__}function f9e(e,t){if(!arguments.length)return Array.from(this,d9e);var n=t?h9e:u9e,r=this._parents,a=this._groups;typeof e!="function"&&(e=c9e(e));for(var c=a.length,d=new Array(c),i=new Array(c),_=new Array(c),b=0;b<c;++b){var T=r[b],A=a[b],k=A.length,R=p9e(e.call(T,T&&T.__data__,b,r)),B=R.length,N=i[b]=new Array(B),V=d[b]=new Array(B),H=_[b]=new Array(k);n(T,A,N,V,H,R,t);for(var G=0,q=0,Q,te;G<B;++G)if(Q=N[G]){for(G>=q&&(q=G+1);!(te=V[q])&&++q<B;);Q._next=te||null}}return d=new Lc(d,r),d._enter=i,d._exit=_,d}function p9e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function m9e(){return new Lc(this._exit||this._groups.map(yre),this._parents)}function g9e(e,t,n){var r=this.enter(),a=this,c=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?c.remove():n(c),r&&a?r.merge(a).order():a}function _9e(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,c=r.length,d=Math.min(a,c),i=new Array(a),_=0;_<d;++_)for(var b=n[_],T=r[_],A=b.length,k=i[_]=new Array(A),R,B=0;B<A;++B)(R=b[B]||T[B])&&(k[B]=R);for(;_<a;++_)i[_]=n[_];return new Lc(i,this._parents)}function y9e(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,c=r[a],d;--a>=0;)(d=r[a])&&(c&&d.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(d,c),c=d);return this}function v9e(e){e||(e=x9e);function t(A,k){return A&&k?e(A.__data__,k.__data__):!A-!k}for(var n=this._groups,r=n.length,a=new Array(r),c=0;c<r;++c){for(var d=n[c],i=d.length,_=a[c]=new Array(i),b,T=0;T<i;++T)(b=d[T])&&(_[T]=b);_.sort(t)}return new Lc(a,this._parents).order()}function x9e(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function b9e(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function w9e(){return Array.from(this)}function S9e(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,c=r.length;a<c;++a){var d=r[a];if(d)return d}return null}function T9e(){let e=0;for(const t of this)++e;return e}function E9e(){return!this.node()}function A9e(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],c=0,d=a.length,i;c<d;++c)(i=a[c])&&e.call(i,i.__data__,c,a);return this}function P9e(e){return function(){this.removeAttribute(e)}}function C9e(e){return function(){this.removeAttributeNS(e.space,e.local)}}function I9e(e,t){return function(){this.setAttribute(e,t)}}function M9e(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function O9e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function k9e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function R9e(e,t){var n=ZI(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?C9e:P9e:typeof t=="function"?n.local?k9e:O9e:n.local?M9e:I9e)(n,t))}function vre(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function D9e(e){return function(){this.style.removeProperty(e)}}function L9e(e,t,n){return function(){this.style.setProperty(e,t,n)}}function z9e(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function N9e(e,t,n){return arguments.length>1?this.each((t==null?D9e:typeof t=="function"?z9e:L9e)(e,t,n??"")):M0(this.node(),e)}function M0(e,t){return e.style.getPropertyValue(t)||vre(e).getComputedStyle(e,null).getPropertyValue(t)}function F9e(e){return function(){delete this[e]}}function B9e(e,t){return function(){this[e]=t}}function j9e(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function $9e(e,t){return arguments.length>1?this.each((t==null?F9e:typeof t=="function"?j9e:B9e)(e,t)):this.node()[e]}function xre(e){return e.trim().split(/^|\s+/)}function yB(e){return e.classList||new bre(e)}function bre(e){this._node=e,this._names=xre(e.getAttribute("class")||"")}bre.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function wre(e,t){for(var n=yB(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Sre(e,t){for(var n=yB(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function U9e(e){return function(){wre(this,e)}}function V9e(e){return function(){Sre(this,e)}}function W9e(e,t){return function(){(t.apply(this,arguments)?wre:Sre)(this,e)}}function G9e(e,t){var n=xre(e+"");if(arguments.length<2){for(var r=yB(this.node()),a=-1,c=n.length;++a<c;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?W9e:t?U9e:V9e)(n,t))}function H9e(){this.textContent=""}function q9e(e){return function(){this.textContent=e}}function Z9e(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function X9e(e){return arguments.length?this.each(e==null?H9e:(typeof e=="function"?Z9e:q9e)(e)):this.node().textContent}function K9e(){this.innerHTML=""}function Y9e(e){return function(){this.innerHTML=e}}function J9e(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Q9e(e){return arguments.length?this.each(e==null?K9e:(typeof e=="function"?J9e:Y9e)(e)):this.node().innerHTML}function e7e(){this.nextSibling&&this.parentNode.appendChild(this)}function t7e(){return this.each(e7e)}function n7e(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function r7e(){return this.each(n7e)}function i7e(e){var t=typeof e=="function"?e:pre(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function o7e(){return null}function a7e(e,t){var n=typeof e=="function"?e:pre(e),r=t==null?o7e:typeof t=="function"?t:_B(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function s7e(){var e=this.parentNode;e&&e.removeChild(this)}function l7e(){return this.each(s7e)}function c7e(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function u7e(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function h7e(e){return this.select(e?u7e:c7e)}function d7e(e){return arguments.length?this.property("__data__",e):this.node().__data__}function f7e(e){return function(t){e.call(this,t,this.__data__)}}function p7e(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function m7e(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,c;n<a;++n)c=t[n],(!e.type||c.type===e.type)&&c.name===e.name?this.removeEventListener(c.type,c.listener,c.options):t[++r]=c;++r?t.length=r:delete this.__on}}}function g7e(e,t,n){return function(){var r=this.__on,a,c=f7e(t);if(r){for(var d=0,i=r.length;d<i;++d)if((a=r[d]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=c,a.options=n),a.value=t;return}}this.addEventListener(e.type,c,n),a={type:e.type,name:e.name,value:t,listener:c,options:n},r?r.push(a):this.__on=[a]}}function _7e(e,t,n){var r=p7e(e+""),a,c=r.length,d;if(arguments.length<2){var i=this.node().__on;if(i){for(var _=0,b=i.length,T;_<b;++_)for(a=0,T=i[_];a<c;++a)if((d=r[a]).type===T.type&&d.name===T.name)return T.value}return}for(i=t?g7e:m7e,a=0;a<c;++a)this.each(i(r[a],t,n));return this}function Tre(e,t,n){var r=vre(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function y7e(e,t){return function(){return Tre(this,e,t)}}function v7e(e,t){return function(){return Tre(this,e,t.apply(this,arguments))}}function x7e(e,t){return this.each((typeof t=="function"?v7e:y7e)(e,t))}function*b7e(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,c=r.length,d;a<c;++a)(d=r[a])&&(yield d)}var Ere=[null];function Lc(e,t){this._groups=e,this._parents=t}function GS(){return new Lc([[document.documentElement]],Ere)}function w7e(){return this}Lc.prototype=GS.prototype={constructor:Lc,select:ZHe,selectAll:JHe,selectChild:n9e,selectChildren:a9e,filter:s9e,data:f9e,enter:l9e,exit:m9e,join:g9e,merge:_9e,selection:w7e,order:y9e,sort:v9e,call:b9e,nodes:w9e,node:S9e,size:T9e,empty:E9e,each:A9e,attr:R9e,style:N9e,property:$9e,classed:G9e,text:X9e,html:Q9e,raise:t7e,lower:r7e,append:i7e,insert:a7e,remove:l7e,clone:h7e,datum:d7e,on:_7e,dispatch:x7e,[Symbol.iterator]:b7e};function UQe(e){return typeof e=="string"?new Lc([[document.querySelector(e)]],[document.documentElement]):new Lc([[e]],Ere)}var O0=0,fb=0,tb=0,Are=1e3,VP,pb,WP=0,g_=0,XI=0,sS=typeof performance=="object"&&performance.now?performance:Date,Pre=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vB(){return g_||(Pre(S7e),g_=sS.now()+XI)}function S7e(){g_=0}function GP(){this._call=this._time=this._next=null}GP.prototype=Cre.prototype={constructor:GP,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vB():+n)+(t==null?0:+t),!this._next&&pb!==this&&(pb?pb._next=this:VP=this,pb=this),this._call=e,this._time=n,Vz()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vz())}};function Cre(e,t,n){var r=new GP;return r.restart(e,t,n),r}function T7e(){vB(),++O0;for(var e=VP,t;e;)(t=g_-e._time)>=0&&e._call.call(void 0,t),e=e._next;--O0}function MH(){g_=(WP=sS.now())+XI,O0=fb=0;try{T7e()}finally{O0=0,A7e(),g_=0}}function E7e(){var e=sS.now(),t=e-WP;t>Are&&(XI-=t,WP=e)}function A7e(){for(var e,t=VP,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:VP=n);pb=e,Vz(r)}function Vz(e){if(!O0){fb&&(fb=clearTimeout(fb));var t=e-g_;t>24?(e<1/0&&(fb=setTimeout(MH,e-sS.now()-XI)),tb&&(tb=clearInterval(tb))):(tb||(WP=sS.now(),tb=setInterval(E7e,Are)),O0=1,Pre(MH))}}function OH(e,t,n){var r=new GP;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var P7e=fre("start","end","cancel","interrupt"),C7e=[],Ire=0,kH=1,Wz=2,L2=3,RH=4,Gz=5,z2=6;function KI(e,t,n,r,a,c){var d=e.__transition;if(!d)e.__transition={};else if(n in d)return;I7e(e,n,{name:t,index:r,group:a,on:P7e,tween:C7e,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:Ire})}function xB(e,t){var n=ph(e,t);if(n.state>Ire)throw new Error("too late; already scheduled");return n}function cd(e,t){var n=ph(e,t);if(n.state>L2)throw new Error("too late; already running");return n}function ph(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function I7e(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=Cre(c,0,n.time);function c(b){n.state=kH,n.timer.restart(d,n.delay,n.time),n.delay<=b&&d(b-n.delay)}function d(b){var T,A,k,R;if(n.state!==kH)return _();for(T in r)if(R=r[T],R.name===n.name){if(R.state===L2)return OH(d);R.state===RH?(R.state=z2,R.timer.stop(),R.on.call("interrupt",e,e.__data__,R.index,R.group),delete r[T]):+T<t&&(R.state=z2,R.timer.stop(),R.on.call("cancel",e,e.__data__,R.index,R.group),delete r[T])}if(OH(function(){n.state===L2&&(n.state=RH,n.timer.restart(i,n.delay,n.time),i(b))}),n.state=Wz,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Wz){for(n.state=L2,a=new Array(k=n.tween.length),T=0,A=-1;T<k;++T)(R=n.tween[T].value.call(e,e.__data__,n.index,n.group))&&(a[++A]=R);a.length=A+1}}function i(b){for(var T=b<n.duration?n.ease.call(null,b/n.duration):(n.timer.restart(_),n.state=Gz,1),A=-1,k=a.length;++A<k;)a[A].call(e,T);n.state===Gz&&(n.on.call("end",e,e.__data__,n.index,n.group),_())}function _(){n.state=z2,n.timer.stop(),delete r[t];for(var b in r)return;delete e.__transition}}function M7e(e,t){var n=e.__transition,r,a,c=!0,d;if(n){t=t==null?null:t+"";for(d in n){if((r=n[d]).name!==t){c=!1;continue}a=r.state>Wz&&r.state<Gz,r.state=z2,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[d]}c&&delete e.__transition}}function O7e(e){return this.each(function(){M7e(this,e)})}function k7e(e,t){var n,r;return function(){var a=cd(this,e),c=a.tween;if(c!==n){r=n=c;for(var d=0,i=r.length;d<i;++d)if(r[d].name===t){r=r.slice(),r.splice(d,1);break}}a.tween=r}}function R7e(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var c=cd(this,e),d=c.tween;if(d!==r){a=(r=d).slice();for(var i={name:t,value:n},_=0,b=a.length;_<b;++_)if(a[_].name===t){a[_]=i;break}_===b&&a.push(i)}c.tween=a}}function D7e(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ph(this.node(),n).tween,a=0,c=r.length,d;a<c;++a)if((d=r[a]).name===e)return d.value;return null}return this.each((t==null?k7e:R7e)(n,e,t))}function bB(e,t,n){var r=e._id;return e.each(function(){var a=cd(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return ph(a,r).value[t]}}function Mre(e,t){var n;return(typeof t=="number"?Ku:t instanceof h_?tP:(n=h_(t))?(t=n,tP):ZQ)(e,t)}function L7e(e){return function(){this.removeAttribute(e)}}function z7e(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N7e(e,t,n){var r,a=n+"",c;return function(){var d=this.getAttribute(e);return d===a?null:d===r?c:c=t(r=d,n)}}function F7e(e,t,n){var r,a=n+"",c;return function(){var d=this.getAttributeNS(e.space,e.local);return d===a?null:d===r?c:c=t(r=d,n)}}function B7e(e,t,n){var r,a,c;return function(){var d,i=n(this),_;return i==null?void this.removeAttribute(e):(d=this.getAttribute(e),_=i+"",d===_?null:d===r&&_===a?c:(a=_,c=t(r=d,i)))}}function j7e(e,t,n){var r,a,c;return function(){var d,i=n(this),_;return i==null?void this.removeAttributeNS(e.space,e.local):(d=this.getAttributeNS(e.space,e.local),_=i+"",d===_?null:d===r&&_===a?c:(a=_,c=t(r=d,i)))}}function $7e(e,t){var n=ZI(e),r=n==="transform"?l3e:Mre;return this.attrTween(e,typeof t=="function"?(n.local?j7e:B7e)(n,r,bB(this,"attr."+e,t)):t==null?(n.local?z7e:L7e)(n):(n.local?F7e:N7e)(n,r,t))}function U7e(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function V7e(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function W7e(e,t){var n,r;function a(){var c=t.apply(this,arguments);return c!==r&&(n=(r=c)&&V7e(e,c)),n}return a._value=t,a}function G7e(e,t){var n,r;function a(){var c=t.apply(this,arguments);return c!==r&&(n=(r=c)&&U7e(e,c)),n}return a._value=t,a}function H7e(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ZI(e);return this.tween(n,(r.local?W7e:G7e)(r,t))}function q7e(e,t){return function(){xB(this,e).delay=+t.apply(this,arguments)}}function Z7e(e,t){return t=+t,function(){xB(this,e).delay=t}}function X7e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?q7e:Z7e)(t,e)):ph(this.node(),t).delay}function K7e(e,t){return function(){cd(this,e).duration=+t.apply(this,arguments)}}function Y7e(e,t){return t=+t,function(){cd(this,e).duration=t}}function J7e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?K7e:Y7e)(t,e)):ph(this.node(),t).duration}function Q7e(e,t){if(typeof t!="function")throw new Error;return function(){cd(this,e).ease=t}}function eqe(e){var t=this._id;return arguments.length?this.each(Q7e(t,e)):ph(this.node(),t).ease}function tqe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;cd(this,e).ease=n}}function nqe(e){if(typeof e!="function")throw new Error;return this.each(tqe(this._id,e))}function rqe(e){typeof e!="function"&&(e=gre(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],d=c.length,i=r[a]=[],_,b=0;b<d;++b)(_=c[b])&&e.call(_,_.__data__,b,c)&&i.push(_);return new vf(r,this._parents,this._name,this._id)}function iqe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,c=Math.min(r,a),d=new Array(r),i=0;i<c;++i)for(var _=t[i],b=n[i],T=_.length,A=d[i]=new Array(T),k,R=0;R<T;++R)(k=_[R]||b[R])&&(A[R]=k);for(;i<r;++i)d[i]=t[i];return new vf(d,this._parents,this._name,this._id)}function oqe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function aqe(e,t,n){var r,a,c=oqe(t)?xB:cd;return function(){var d=c(this,e),i=d.on;i!==r&&(a=(r=i).copy()).on(t,n),d.on=a}}function sqe(e,t){var n=this._id;return arguments.length<2?ph(this.node(),n).on.on(e):this.each(aqe(n,e,t))}function lqe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function cqe(){return this.on("end.remove",lqe(this._id))}function uqe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_B(e));for(var r=this._groups,a=r.length,c=new Array(a),d=0;d<a;++d)for(var i=r[d],_=i.length,b=c[d]=new Array(_),T,A,k=0;k<_;++k)(T=i[k])&&(A=e.call(T,T.__data__,k,i))&&("__data__"in T&&(A.__data__=T.__data__),b[k]=A,KI(b[k],t,n,k,b,ph(T,n)));return new vf(c,this._parents,t,n)}function hqe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=mre(e));for(var r=this._groups,a=r.length,c=[],d=[],i=0;i<a;++i)for(var _=r[i],b=_.length,T,A=0;A<b;++A)if(T=_[A]){for(var k=e.call(T,T.__data__,A,_),R,B=ph(T,n),N=0,V=k.length;N<V;++N)(R=k[N])&&KI(R,t,n,N,k,B);c.push(k),d.push(T)}return new vf(c,d,t,n)}var dqe=GS.prototype.constructor;function fqe(){return new dqe(this._groups,this._parents)}function pqe(e,t){var n,r,a;return function(){var c=M0(this,e),d=(this.style.removeProperty(e),M0(this,e));return c===d?null:c===n&&d===r?a:a=t(n=c,r=d)}}function Ore(e){return function(){this.style.removeProperty(e)}}function mqe(e,t,n){var r,a=n+"",c;return function(){var d=M0(this,e);return d===a?null:d===r?c:c=t(r=d,n)}}function gqe(e,t,n){var r,a,c;return function(){var d=M0(this,e),i=n(this),_=i+"";return i==null&&(_=i=(this.style.removeProperty(e),M0(this,e))),d===_?null:d===r&&_===a?c:(a=_,c=t(r=d,i))}}function _qe(e,t){var n,r,a,c="style."+t,d="end."+c,i;return function(){var _=cd(this,e),b=_.on,T=_.value[c]==null?i||(i=Ore(t)):void 0;(b!==n||a!==T)&&(r=(n=b).copy()).on(d,a=T),_.on=r}}function yqe(e,t,n){var r=(e+="")=="transform"?s3e:Mre;return t==null?this.styleTween(e,pqe(e,r)).on("end.style."+e,Ore(e)):typeof t=="function"?this.styleTween(e,gqe(e,r,bB(this,"style."+e,t))).each(_qe(this._id,e)):this.styleTween(e,mqe(e,r,t),n).on("end.style."+e,null)}function vqe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function xqe(e,t,n){var r,a;function c(){var d=t.apply(this,arguments);return d!==a&&(r=(a=d)&&vqe(e,d,n)),r}return c._value=t,c}function bqe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,xqe(e,t,n??""))}function wqe(e){return function(){this.textContent=e}}function Sqe(e){return function(){var t=e(this);this.textContent=t??""}}function Tqe(e){return this.tween("text",typeof e=="function"?Sqe(bB(this,"text",e)):wqe(e==null?"":e+""))}function Eqe(e){return function(t){this.textContent=e.call(this,t)}}function Aqe(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Eqe(a)),t}return r._value=e,r}function Pqe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Aqe(e))}function Cqe(){for(var e=this._name,t=this._id,n=kre(),r=this._groups,a=r.length,c=0;c<a;++c)for(var d=r[c],i=d.length,_,b=0;b<i;++b)if(_=d[b]){var T=ph(_,t);KI(_,e,n,b,d,{time:T.time+T.delay+T.duration,delay:0,duration:T.duration,ease:T.ease})}return new vf(r,this._parents,e,n)}function Iqe(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(c,d){var i={value:d},_={value:function(){--a===0&&c()}};n.each(function(){var b=cd(this,r),T=b.on;T!==e&&(t=(e=T).copy(),t._.cancel.push(i),t._.interrupt.push(i),t._.end.push(_)),b.on=t}),a===0&&c()})}var Mqe=0;function vf(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function kre(){return++Mqe}var Wd=GS.prototype;vf.prototype={constructor:vf,select:uqe,selectAll:hqe,selectChild:Wd.selectChild,selectChildren:Wd.selectChildren,filter:rqe,merge:iqe,selection:fqe,transition:Cqe,call:Wd.call,nodes:Wd.nodes,node:Wd.node,size:Wd.size,empty:Wd.empty,each:Wd.each,on:sqe,attr:$7e,attrTween:H7e,style:yqe,styleTween:bqe,text:Tqe,textTween:Pqe,remove:cqe,tween:D7e,delay:X7e,duration:J7e,ease:eqe,easeVarying:nqe,end:Iqe,[Symbol.iterator]:Wd[Symbol.iterator]};function Oqe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var kqe={time:null,delay:0,duration:250,ease:Oqe};function Rqe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Dqe(e){var t,n;e instanceof vf?(t=e._id,e=e._name):(t=kre(),(n=kqe).time=vB(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,c=0;c<a;++c)for(var d=r[c],i=d.length,_,b=0;b<i;++b)(_=d[b])&&KI(_,e,t,b,d,n||Rqe(_,t));return new vf(r,this._parents,e,t)}GS.prototype.interrupt=O7e;GS.prototype.transition=Dqe;function Lqe(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const VQe=Lqe("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function mb(e,t,n){this.k=e,this.x=t,this.y=n}mb.prototype={constructor:mb,scale:function(e){return e===1?this:new mb(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new mb(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};mb.prototype;const zqe={active:!0,breakpoints:{},delay:4e3,jump:!1,playOnInit:!0,stopOnFocusIn:!0,stopOnInteraction:!0,stopOnMouseEnter:!1,stopOnLastSnap:!1,rootNode:null};function Nqe(e,t){const n=e.scrollSnapList();return typeof t=="number"?n.map(()=>t):t(n,e)}function Fqe(e,t){const n=e.rootNode();return t&&t(n)||n}function Rre(e={}){let t,n,r,a,c=null,d=0,i=!1,_=!1,b=!1,T=!1;function A(He,ct){n=He;const{mergeOptions:ot,optionsAtMedia:rt}=ct,Be=ot(zqe,Rre.globalOptions),nt=ot(Be,e);if(t=rt(nt),n.scrollSnapList().length<=1)return;T=t.jump,r=!1,a=Nqe(n,t.delay);const{eventStore:at,ownerDocument:Mt}=n.internalEngine(),Nt=!!n.internalEngine().options.watchDrag,rn=Fqe(n,t.rootNode);at.add(Mt,"visibilitychange",H),Nt&&n.on("pointerDown",q),Nt&&!t.stopOnInteraction&&n.on("pointerUp",Q),t.stopOnMouseEnter&&at.add(rn,"mouseenter",te),t.stopOnMouseEnter&&!t.stopOnInteraction&&at.add(rn,"mouseleave",ue),t.stopOnFocusIn&&n.on("slideFocusStart",V),t.stopOnFocusIn&&!t.stopOnInteraction&&at.add(n.containerNode(),"focusout",N),t.playOnInit&&N()}function k(){n.off("pointerDown",q).off("pointerUp",Q).off("slideFocusStart",V),V(),r=!0,i=!1}function R(){const{ownerWindow:He}=n.internalEngine();He.clearTimeout(d),d=He.setTimeout(Fe,a[n.selectedScrollSnap()]),c=new Date().getTime(),n.emit("autoplay:timerset")}function B(){const{ownerWindow:He}=n.internalEngine();He.clearTimeout(d),d=0,c=null,n.emit("autoplay:timerstopped")}function N(){if(!r){if(G()){b=!0;return}i||n.emit("autoplay:play"),R(),i=!0}}function V(){r||(i&&n.emit("autoplay:stop"),B(),i=!1)}function H(){if(G())return b=i,V();b&&N()}function G(){const{ownerDocument:He}=n.internalEngine();return He.visibilityState==="hidden"}function q(){_||V()}function Q(){_||N()}function te(){_=!0,V()}function ue(){_=!1,N()}function fe(He){typeof He<"u"&&(T=He),N()}function ye(){i&&V()}function De(){i&&N()}function Ne(){return i}function Fe(){const{index:He}=n.internalEngine(),ct=He.clone().add(1).get(),ot=n.scrollSnapList().length-1,rt=t.stopOnLastSnap&&ct===ot;if(n.canScrollNext()?n.scrollNext(T):n.scrollTo(0,T),n.emit("autoplay:select"),rt)return V();N()}function Le(){if(!c)return null;const He=a[n.selectedScrollSnap()],ct=new Date().getTime()-c;return He-ct}return{name:"autoplay",options:e,init:A,destroy:k,play:fe,stop:ye,reset:De,isPlaying:Ne,timeUntilNext:Le}}Rre.globalOptions=void 0;function Bqe(e){return Object.prototype.toString.call(e)==="[object Object]"}function DH(e){return Bqe(e)||Array.isArray(e)}function jqe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function wB(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const a=JSON.stringify(Object.keys(e.breakpoints||{})),c=JSON.stringify(Object.keys(t.breakpoints||{}));return a!==c?!1:n.every(d=>{const i=e[d],_=t[d];return typeof i=="function"?`${i}`==`${_}`:!DH(i)||!DH(_)?i===_:wB(i,_)})}function LH(e){return e.concat().sort((t,n)=>t.name>n.name?1:-1).map(t=>t.options)}function $qe(e,t){if(e.length!==t.length)return!1;const n=LH(e),r=LH(t);return n.every((a,c)=>{const d=r[c];return wB(a,d)})}function SB(e){return typeof e=="number"}function Hz(e){return typeof e=="string"}function YI(e){return typeof e=="boolean"}function zH(e){return Object.prototype.toString.call(e)==="[object Object]"}function ua(e){return Math.abs(e)}function TB(e){return Math.sign(e)}function Ub(e,t){return ua(e-t)}function Uqe(e,t){if(e===0||t===0||ua(e)<=ua(t))return 0;const n=Ub(ua(e),ua(t));return ua(n/e)}function lS(e){return cS(e).map(Number)}function oh(e){return e[HS(e)]}function HS(e){return Math.max(0,e.length-1)}function EB(e,t){return t===HS(e)}function NH(e,t=0){return Array.from(Array(e),(n,r)=>t+r)}function cS(e){return Object.keys(e)}function Dre(e,t){return[e,t].reduce((n,r)=>(cS(r).forEach(a=>{const c=n[a],d=r[a],i=zH(c)&&zH(d);n[a]=i?Dre(c,d):d}),n),{})}function qz(e,t){return typeof t.MouseEvent<"u"&&e instanceof t.MouseEvent}function Vqe(e,t){const n={start:r,center:a,end:c};function r(){return 0}function a(_){return c(_)/2}function c(_){return t-_}function d(_,b){return Hz(e)?n[e](_):e(t,_,b)}return{measure:d}}function uS(){let e=[];function t(a,c,d,i={passive:!0}){let _;if("addEventListener"in a)a.addEventListener(c,d,i),_=()=>a.removeEventListener(c,d,i);else{const b=a;b.addListener(d),_=()=>b.removeListener(d)}return e.push(_),r}function n(){e=e.filter(a=>a())}const r={add:t,clear:n};return r}function Wqe(e,t,n,r){const a=uS(),c=1e3/60;let d=null,i=0,_=0;function b(){a.add(e,"visibilitychange",()=>{e.hidden&&B()})}function T(){R(),a.clear()}function A(V){if(!_)return;d||(d=V);const H=V-d;for(d=V,i+=H;i>=c;)n(c),i-=c;const G=i/c;r(G),_&&t.requestAnimationFrame(A)}function k(){_||(_=t.requestAnimationFrame(A))}function R(){t.cancelAnimationFrame(_),d=null,i=0,_=0}function B(){d=null,i=0}return{init:b,destroy:T,start:k,stop:R,update:()=>n(c),render:r}}function Gqe(e,t){const n=t==="rtl",r=e==="y",a=r?"y":"x",c=r?"x":"y",d=!r&&n?-1:1,i=T(),_=A();function b(B){const{height:N,width:V}=B;return r?N:V}function T(){return r?"top":n?"right":"left"}function A(){return r?"bottom":n?"left":"right"}function k(B){return B*d}return{scroll:a,cross:c,startEdge:i,endEdge:_,measureSize:b,direction:k}}function __(e=0,t=0){const n=ua(e-t);function r(b){return b<e}function a(b){return b>t}function c(b){return r(b)||a(b)}function d(b){return c(b)?r(b)?e:t:b}function i(b){return n?b-n*Math.ceil((b-t)/n):b}return{length:n,max:t,min:e,constrain:d,reachedAny:c,reachedMax:a,reachedMin:r,removeOffset:i}}function Lre(e,t,n){const{constrain:r}=__(0,e),a=e+1;let c=d(t);function d(k){return n?ua((a+k)%a):r(k)}function i(){return c}function _(k){return c=d(k),A}function b(k){return T().set(i()+k)}function T(){return Lre(e,i(),n)}const A={get:i,set:_,add:b,clone:T};return A}function Hqe(e,t,n,r,a,c,d,i,_,b,T,A,k,R,B,N,V,H,G){const{cross:q,direction:Q}=e,te=["INPUT","SELECT","TEXTAREA"],ue={passive:!1},fe=uS(),ye=uS(),De=__(50,225).constrain(R.measure(20)),Ne={mouse:300,touch:400},Fe={mouse:500,touch:600},Le=B?43:25;let Ze=!1,He=0,ct=0,ot=!1,rt=!1,Be=!1,nt=!1;function at(yt){if(!G)return;function In(Ar){(YI(G)||G(yt,Ar))&&sn(Ar)}const Kn=t;fe.add(Kn,"dragstart",Ar=>Ar.preventDefault(),ue).add(Kn,"touchmove",()=>{},ue).add(Kn,"touchend",()=>{}).add(Kn,"touchstart",In).add(Kn,"mousedown",In).add(Kn,"touchcancel",$n).add(Kn,"contextmenu",$n).add(Kn,"click",Gt,!0)}function Mt(){fe.clear(),ye.clear()}function Nt(){const yt=nt?n:t;ye.add(yt,"touchmove",Vt,ue).add(yt,"touchend",$n).add(yt,"mousemove",Vt,ue).add(yt,"mouseup",$n)}function rn(yt){const In=yt.nodeName||"";return te.includes(In)}function un(){return(B?Fe:Ne)[nt?"mouse":"touch"]}function en(yt,In){const Kn=A.add(TB(yt)*-1),Ar=T.byDistance(yt,!B).distance;return B||ua(yt)<De?Ar:V&&In?Ar*.5:T.byIndex(Kn.get(),0).distance}function sn(yt){const In=qz(yt,r);nt=In,Be=B&&In&&!yt.buttons&&Ze,Ze=Ub(a.get(),d.get())>=2,!(In&&yt.button!==0)&&(rn(yt.target)||(ot=!0,c.pointerDown(yt),b.useFriction(0).useDuration(0),a.set(d),Nt(),He=c.readPoint(yt),ct=c.readPoint(yt,q),k.emit("pointerDown")))}function Vt(yt){if(!qz(yt,r)&&yt.touches.length>=2)return $n(yt);const Kn=c.readPoint(yt),Ar=c.readPoint(yt,q),_r=Ub(Kn,He),Vr=Ub(Ar,ct);if(!rt&&!nt&&(!yt.cancelable||(rt=_r>Vr,!rt)))return $n(yt);const it=c.pointerMove(yt);_r>N&&(Be=!0),b.useFriction(.3).useDuration(.75),i.start(),a.add(Q(it)),yt.preventDefault()}function $n(yt){const Kn=T.byDistance(0,!1).index!==A.get(),Ar=c.pointerUp(yt)*un(),_r=en(Q(Ar),Kn),Vr=Uqe(Ar,_r),it=Le-10*Vr,Pt=H+Vr/50;rt=!1,ot=!1,ye.clear(),b.useDuration(it).useFriction(Pt),_.distance(_r,!B),nt=!1,k.emit("pointerUp")}function Gt(yt){Be&&(yt.stopPropagation(),yt.preventDefault(),Be=!1)}function Tn(){return ot}return{init:at,destroy:Mt,pointerDown:Tn}}function qqe(e,t){let r,a;function c(A){return A.timeStamp}function d(A,k){const B=`client${(k||e.scroll)==="x"?"X":"Y"}`;return(qz(A,t)?A:A.touches[0])[B]}function i(A){return r=A,a=A,d(A)}function _(A){const k=d(A)-d(a),R=c(A)-c(r)>170;return a=A,R&&(r=A),k}function b(A){if(!r||!a)return 0;const k=d(a)-d(r),R=c(A)-c(r),B=c(A)-c(a)>170,N=k/R;return R&&!B&&ua(N)>.1?N:0}return{pointerDown:i,pointerMove:_,pointerUp:b,readPoint:d}}function Zqe(){function e(n){const{offsetTop:r,offsetLeft:a,offsetWidth:c,offsetHeight:d}=n;return{top:r,right:a+c,bottom:r+d,left:a,width:c,height:d}}return{measure:e}}function Xqe(e){function t(r){return e*(r/100)}return{measure:t}}function Kqe(e,t,n,r,a,c,d){const i=[e].concat(r);let _,b,T=[],A=!1;function k(V){return a.measureSize(d.measure(V))}function R(V){if(!c)return;b=k(e),T=r.map(k);function H(G){for(const q of G){if(A)return;const Q=q.target===e,te=r.indexOf(q.target),ue=Q?b:T[te],fe=k(Q?e:r[te]);if(ua(fe-ue)>=.5){V.reInit(),t.emit("resize");break}}}_=new ResizeObserver(G=>{(YI(c)||c(V,G))&&H(G)}),n.requestAnimationFrame(()=>{i.forEach(G=>_.observe(G))})}function B(){A=!0,_&&_.disconnect()}return{init:R,destroy:B}}function Yqe(e,t,n,r,a,c){let d=0,i=0,_=a,b=c,T=e.get(),A=0;function k(ue){const fe=ue/1e3,ye=_*fe,De=r.get()-e.get(),Ne=!_;let Fe=0;return Ne?(d=0,n.set(r),e.set(r),Fe=De):(n.set(e),d+=De/ye,d*=b,T+=d,e.add(d*fe),Fe=T-A),i=TB(Fe),A=T,te}function R(){const ue=r.get()-t.get();return ua(ue)<.001}function B(){return _}function N(){return i}function V(){return d}function H(){return q(a)}function G(){return Q(c)}function q(ue){return _=ue,te}function Q(ue){return b=ue,te}const te={direction:N,duration:B,velocity:V,seek:k,settled:R,useBaseFriction:G,useBaseDuration:H,useFriction:Q,useDuration:q};return te}function Jqe(e,t,n,r,a){const c=a.measure(10),d=a.measure(50),i=__(.1,.99);let _=!1;function b(){return!(_||!e.reachedAny(n.get())||!e.reachedAny(t.get()))}function T(R){if(!b())return;const B=e.reachedMin(t.get())?"min":"max",N=ua(e[B]-t.get()),V=n.get()-t.get(),H=i.constrain(N/d);n.subtract(V*H),!R&&ua(V)<c&&(n.set(e.constrain(n.get())),r.useDuration(25).useBaseFriction())}function A(R){_=!R}return{shouldConstrain:b,constrain:T,toggleActive:A}}function Qqe(e,t,n,r,a){const c=__(-t+e,0),d=A(),i=T(),_=k();function b(B,N){return Ub(B,N)<1}function T(){const B=d[0],N=oh(d),V=d.lastIndexOf(B),H=d.indexOf(N)+1;return __(V,H)}function A(){return n.map((B,N)=>{const{min:V,max:H}=c,G=c.constrain(B),q=!N,Q=EB(n,N);return q?H:Q||b(V,G)?V:b(H,G)?H:G}).map(B=>parseFloat(B.toFixed(3)))}function k(){if(t<=e+a)return[c.max];if(r==="keepSnaps")return d;const{min:B,max:N}=i;return d.slice(B,N)}return{snapsContained:_,scrollContainLimit:i}}function eZe(e,t,n){const r=t[0],a=n?r-e:oh(t);return{limit:__(a,r)}}function tZe(e,t,n,r){const c=t.min+.1,d=t.max+.1,{reachedMin:i,reachedMax:_}=__(c,d);function b(k){return k===1?_(n.get()):k===-1?i(n.get()):!1}function T(k){if(!b(k))return;const R=e*(k*-1);r.forEach(B=>B.add(R))}return{loop:T}}function nZe(e){const{max:t,length:n}=e;function r(c){const d=c-t;return n?d/-n:0}return{get:r}}function rZe(e,t,n,r,a){const{startEdge:c,endEdge:d}=e,{groupSlides:i}=a,_=A().map(t.measure),b=k(),T=R();function A(){return i(r).map(N=>oh(N)[d]-N[0][c]).map(ua)}function k(){return r.map(N=>n[c]-N[c]).map(N=>-ua(N))}function R(){return i(b).map(N=>N[0]).map((N,V)=>N+_[V])}return{snaps:b,snapsAligned:T}}function iZe(e,t,n,r,a,c){const{groupSlides:d}=a,{min:i,max:_}=r,b=T();function T(){const k=d(c),R=!e||t==="keepSnaps";return n.length===1?[c]:R?k:k.slice(i,_).map((B,N,V)=>{const H=!N,G=EB(V,N);if(H){const q=oh(V[0])+1;return NH(q)}if(G){const q=HS(c)-oh(V)[0]+1;return NH(q,oh(V)[0])}return B})}return{slideRegistry:b}}function oZe(e,t,n,r,a){const{reachedAny:c,removeOffset:d,constrain:i}=r;function _(B){return B.concat().sort((N,V)=>ua(N)-ua(V))[0]}function b(B){const N=e?d(B):i(B),V=t.map((G,q)=>({diff:T(G-N,0),index:q})).sort((G,q)=>ua(G.diff)-ua(q.diff)),{index:H}=V[0];return{index:H,distance:N}}function T(B,N){const V=[B,B+n,B-n];if(!e)return B;if(!N)return _(V);const H=V.filter(G=>TB(G)===N);return H.length?_(H):oh(V)-n}function A(B,N){const V=t[B]-a.get(),H=T(V,N);return{index:B,distance:H}}function k(B,N){const V=a.get()+B,{index:H,distance:G}=b(V),q=!e&&c(V);if(!N||q)return{index:H,distance:B};const Q=t[H]-G,te=B+T(Q,0);return{index:H,distance:te}}return{byDistance:k,byIndex:A,shortcut:T}}function aZe(e,t,n,r,a,c,d){function i(A){const k=A.distance,R=A.index!==t.get();c.add(k),k&&(r.duration()?e.start():(e.update(),e.render(1),e.update())),R&&(n.set(t.get()),t.set(A.index),d.emit("select"))}function _(A,k){const R=a.byDistance(A,k);i(R)}function b(A,k){const R=t.clone().set(A),B=a.byIndex(R.get(),k);i(B)}return{distance:_,index:b}}function sZe(e,t,n,r,a,c,d,i){const _={passive:!0,capture:!0};let b=0;function T(R){if(!i)return;function B(N){if(new Date().getTime()-b>10)return;d.emit("slideFocusStart"),e.scrollLeft=0;const G=n.findIndex(q=>q.includes(N));SB(G)&&(a.useDuration(0),r.index(G,0),d.emit("slideFocus"))}c.add(document,"keydown",A,!1),t.forEach((N,V)=>{c.add(N,"focus",H=>{(YI(i)||i(R,H))&&B(V)},_)})}function A(R){R.code==="Tab"&&(b=new Date().getTime())}return{init:T}}function gb(e){let t=e;function n(){return t}function r(_){t=d(_)}function a(_){t+=d(_)}function c(_){t-=d(_)}function d(_){return SB(_)?_:_.get()}return{get:n,set:r,add:a,subtract:c}}function zre(e,t){const n=e.scroll==="x"?c:d,r=t.style;let a=!1;function c(A){return`translate3d(${A}px,0px,0px)`}function d(A){return`translate3d(0px,${A}px,0px)`}function i(A){a||(r.transform=n(e.direction(A)))}function _(A){a=!A}function b(){a||(r.transform="",t.getAttribute("style")||t.removeAttribute("style"))}return{clear:b,to:i,toggleActive:_}}function lZe(e,t,n,r,a,c,d,i,_){const T=lS(a),A=lS(a).reverse(),k=H().concat(G());function R(fe,ye){return fe.reduce((De,Ne)=>De-a[Ne],ye)}function B(fe,ye){return fe.reduce((De,Ne)=>R(De,ye)>0?De.concat([Ne]):De,[])}function N(fe){return c.map((ye,De)=>({start:ye-r[De]+.5+fe,end:ye+t-.5+fe}))}function V(fe,ye,De){const Ne=N(ye);return fe.map(Fe=>{const Le=De?0:-n,Ze=De?n:0,He=De?"end":"start",ct=Ne[Fe][He];return{index:Fe,loopPoint:ct,slideLocation:gb(-1),translate:zre(e,_[Fe]),target:()=>i.get()>ct?Le:Ze}})}function H(){const fe=d[0],ye=B(A,fe);return V(ye,n,!1)}function G(){const fe=t-d[0]-1,ye=B(T,fe);return V(ye,-n,!0)}function q(){return k.every(({index:fe})=>{const ye=T.filter(De=>De!==fe);return R(ye,t)<=.1})}function Q(){k.forEach(fe=>{const{target:ye,translate:De,slideLocation:Ne}=fe,Fe=ye();Fe!==Ne.get()&&(De.to(Fe),Ne.set(Fe))})}function te(){k.forEach(fe=>fe.translate.clear())}return{canLoop:q,clear:te,loop:Q,loopPoints:k}}function cZe(e,t,n){let r,a=!1;function c(_){if(!n)return;function b(T){for(const A of T)if(A.type==="childList"){_.reInit(),t.emit("slidesChanged");break}}r=new MutationObserver(T=>{a||(YI(n)||n(_,T))&&b(T)}),r.observe(e,{childList:!0})}function d(){r&&r.disconnect(),a=!0}return{init:c,destroy:d}}function uZe(e,t,n,r){const a={};let c=null,d=null,i,_=!1;function b(){i=new IntersectionObserver(B=>{_||(B.forEach(N=>{const V=t.indexOf(N.target);a[V]=N}),c=null,d=null,n.emit("slidesInView"))},{root:e.parentElement,threshold:r}),t.forEach(B=>i.observe(B))}function T(){i&&i.disconnect(),_=!0}function A(B){return cS(a).reduce((N,V)=>{const H=parseInt(V),{isIntersecting:G}=a[H];return(B&&G||!B&&!G)&&N.push(H),N},[])}function k(B=!0){if(B&&c)return c;if(!B&&d)return d;const N=A(B);return B&&(c=N),B||(d=N),N}return{init:b,destroy:T,get:k}}function hZe(e,t,n,r,a,c){const{measureSize:d,startEdge:i,endEdge:_}=e,b=n[0]&&a,T=B(),A=N(),k=n.map(d),R=V();function B(){if(!b)return 0;const G=n[0];return ua(t[i]-G[i])}function N(){if(!b)return 0;const G=c.getComputedStyle(oh(r));return parseFloat(G.getPropertyValue(`margin-${_}`))}function V(){return n.map((G,q,Q)=>{const te=!q,ue=EB(Q,q);return te?k[q]+T:ue?k[q]+A:Q[q+1][i]-G[i]}).map(ua)}return{slideSizes:k,slideSizesWithGaps:R,startGap:T,endGap:A}}function dZe(e,t,n,r,a,c,d,i,_){const{startEdge:b,endEdge:T,direction:A}=e,k=SB(n);function R(H,G){return lS(H).filter(q=>q%G===0).map(q=>H.slice(q,q+G))}function B(H){return H.length?lS(H).reduce((G,q,Q)=>{const te=oh(G)||0,ue=te===0,fe=q===HS(H),ye=a[b]-c[te][b],De=a[b]-c[q][T],Ne=!r&&ue?A(d):0,Fe=!r&&fe?A(i):0,Le=ua(De-Fe-(ye+Ne));return Q&&Le>t+_&&G.push(q),fe&&G.push(H.length),G},[]).map((G,q,Q)=>{const te=Math.max(Q[q-1]||0);return H.slice(te,G)}):[]}function N(H){return k?R(H,n):B(H)}return{groupSlides:N}}function fZe(e,t,n,r,a,c,d){const{align:i,axis:_,direction:b,startIndex:T,loop:A,duration:k,dragFree:R,dragThreshold:B,inViewThreshold:N,slidesToScroll:V,skipSnaps:H,containScroll:G,watchResize:q,watchSlides:Q,watchDrag:te,watchFocus:ue}=c,fe=2,ye=Zqe(),De=ye.measure(t),Ne=n.map(ye.measure),Fe=Gqe(_,b),Le=Fe.measureSize(De),Ze=Xqe(Le),He=Vqe(i,Le),ct=!A&&!!G,ot=A||!!G,{slideSizes:rt,slideSizesWithGaps:Be,startGap:nt,endGap:at}=hZe(Fe,De,Ne,n,ot,a),Mt=dZe(Fe,Le,V,A,De,Ne,nt,at,fe),{snaps:Nt,snapsAligned:rn}=rZe(Fe,He,De,Ne,Mt),un=-oh(Nt)+oh(Be),{snapsContained:en,scrollContainLimit:sn}=Qqe(Le,un,rn,G,fe),Vt=ct?en:rn,{limit:$n}=eZe(un,Vt,A),Gt=Lre(HS(Vt),T,A),Tn=Gt.clone(),hn=lS(n),yt=({dragHandler:to,scrollBody:uo,scrollBounds:ja,options:{loop:Bo}},fo)=>{Bo||ja.constrain(to.pointerDown()),uo.seek(fo)},In=({scrollBody:to,translate:uo,location:ja,offsetLocation:Bo,scrollLooper:fo,slideLooper:$a,dragHandler:Ua,animation:Es,eventHandler:ci,scrollBounds:Qa,options:{loop:As}},pa)=>{const Ps=to.settled(),es=!Qa.shouldConstrain(),Cl=As?Ps:Ps&&es;Cl&&!Ua.pointerDown()&&(Es.stop(),ci.emit("settle")),Cl||ci.emit("scroll");const Tt=ja.get()*pa+it.get()*(1-pa);Bo.set(Tt),As&&(fo.loop(to.direction()),$a.loop()),uo.to(Bo.get())},Kn=Wqe(r,a,to=>yt(fa,to),to=>In(fa,to)),Ar=.68,_r=Vt[Gt.get()],Vr=gb(_r),it=gb(_r),Pt=gb(_r),jt=gb(_r),Cn=Yqe(Vr,Pt,it,jt,k,Ar),Mn=oZe(A,Vt,un,$n,jt),_n=aZe(Kn,Gt,Tn,Cn,Mn,jt,d),Gn=nZe($n),vr=uS(),ni=uZe(t,n,d,N),{slideRegistry:vi}=iZe(ct,G,Vt,sn,Mt,hn),na=sZe(e,n,vi,_n,Cn,vr,d,ue),fa={ownerDocument:r,ownerWindow:a,eventHandler:d,containerRect:De,slideRects:Ne,animation:Kn,axis:Fe,dragHandler:Hqe(Fe,e,r,a,jt,qqe(Fe,a),Vr,Kn,_n,Cn,Mn,Gt,d,Ze,R,B,H,Ar,te),eventStore:vr,percentOfView:Ze,index:Gt,indexPrevious:Tn,limit:$n,location:Vr,offsetLocation:Pt,previousLocation:it,options:c,resizeHandler:Kqe(t,d,a,n,Fe,q,ye),scrollBody:Cn,scrollBounds:Jqe($n,Pt,jt,Cn,Ze),scrollLooper:tZe(un,$n,Pt,[Vr,Pt,it,jt]),scrollProgress:Gn,scrollSnapList:Vt.map(Gn.get),scrollSnaps:Vt,scrollTarget:Mn,scrollTo:_n,slideLooper:lZe(Fe,Le,un,rt,Be,Nt,Vt,Pt,n),slideFocus:na,slidesHandler:cZe(t,d,Q),slidesInView:ni,slideIndexes:hn,slideRegistry:vi,slidesToScroll:Mt,target:jt,translate:zre(Fe,t)};return fa}function pZe(){let e={},t;function n(b){t=b}function r(b){return e[b]||[]}function a(b){return r(b).forEach(T=>T(t,b)),_}function c(b,T){return e[b]=r(b).concat([T]),_}function d(b,T){return e[b]=r(b).filter(A=>A!==T),_}function i(){e={}}const _={init:n,emit:a,off:d,on:c,clear:i};return _}const mZe={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function gZe(e){function t(c,d){return Dre(c,d||{})}function n(c){const d=c.breakpoints||{},i=cS(d).filter(_=>e.matchMedia(_).matches).map(_=>d[_]).reduce((_,b)=>t(_,b),{});return t(c,i)}function r(c){return c.map(d=>cS(d.breakpoints||{})).reduce((d,i)=>d.concat(i),[]).map(e.matchMedia)}return{mergeOptions:t,optionsAtMedia:n,optionsMediaQueries:r}}function _Ze(e){let t=[];function n(c,d){return t=d.filter(({options:i})=>e.optionsAtMedia(i).active!==!1),t.forEach(i=>i.init(c,e)),d.reduce((i,_)=>Object.assign(i,{[_.name]:_}),{})}function r(){t=t.filter(c=>c.destroy())}return{init:n,destroy:r}}function HP(e,t,n){const r=e.ownerDocument,a=r.defaultView,c=gZe(a),d=_Ze(c),i=uS(),_=pZe(),{mergeOptions:b,optionsAtMedia:T,optionsMediaQueries:A}=c,{on:k,off:R,emit:B}=_,N=Fe;let V=!1,H,G=b(mZe,HP.globalOptions),q=b(G),Q=[],te,ue,fe;function ye(){const{container:hn,slides:yt}=q;ue=(Hz(hn)?e.querySelector(hn):hn)||e.children[0];const Kn=Hz(yt)?ue.querySelectorAll(yt):yt;fe=[].slice.call(Kn||ue.children)}function De(hn){const yt=fZe(e,ue,fe,r,a,hn,_);if(hn.loop&&!yt.slideLooper.canLoop()){const In=Object.assign({},hn,{loop:!1});return De(In)}return yt}function Ne(hn,yt){V||(G=b(G,hn),q=T(G),Q=yt||Q,ye(),H=De(q),A([G,...Q.map(({options:In})=>In)]).forEach(In=>i.add(In,"change",Fe)),q.active&&(H.translate.to(H.location.get()),H.animation.init(),H.slidesInView.init(),H.slideFocus.init(Tn),H.eventHandler.init(Tn),H.resizeHandler.init(Tn),H.slidesHandler.init(Tn),H.options.loop&&H.slideLooper.loop(),ue.offsetParent&&fe.length&&H.dragHandler.init(Tn),te=d.init(Tn,Q)))}function Fe(hn,yt){const In=Mt();Le(),Ne(b({startIndex:In},hn),yt),_.emit("reInit")}function Le(){H.dragHandler.destroy(),H.eventStore.clear(),H.translate.clear(),H.slideLooper.clear(),H.resizeHandler.destroy(),H.slidesHandler.destroy(),H.slidesInView.destroy(),H.animation.destroy(),d.destroy(),i.clear()}function Ze(){V||(V=!0,i.clear(),Le(),_.emit("destroy"),_.clear())}function He(hn,yt,In){!q.active||V||(H.scrollBody.useBaseFriction().useDuration(yt===!0?0:q.duration),H.scrollTo.index(hn,In||0))}function ct(hn){const yt=H.index.add(1).get();He(yt,hn,-1)}function ot(hn){const yt=H.index.add(-1).get();He(yt,hn,1)}function rt(){return H.index.add(1).get()!==Mt()}function Be(){return H.index.add(-1).get()!==Mt()}function nt(){return H.scrollSnapList}function at(){return H.scrollProgress.get(H.location.get())}function Mt(){return H.index.get()}function Nt(){return H.indexPrevious.get()}function rn(){return H.slidesInView.get()}function un(){return H.slidesInView.get(!1)}function en(){return te}function sn(){return H}function Vt(){return e}function $n(){return ue}function Gt(){return fe}const Tn={canScrollNext:rt,canScrollPrev:Be,containerNode:$n,internalEngine:sn,destroy:Ze,off:R,on:k,emit:B,plugins:en,previousScrollSnap:Nt,reInit:N,rootNode:Vt,scrollNext:ct,scrollPrev:ot,scrollProgress:at,scrollSnapList:nt,scrollTo:He,selectedScrollSnap:Mt,slideNodes:Gt,slidesInView:rn,slidesNotInView:un};return Ne(t,n),setTimeout(()=>_.emit("init"),0),Tn}HP.globalOptions=void 0;function Nre(e={},t=[]){const n=X.useRef(e),r=X.useRef(t),[a,c]=X.useState(),[d,i]=X.useState(),_=X.useCallback(()=>{a&&a.reInit(n.current,r.current)},[a]);return X.useEffect(()=>{wB(n.current,e)||(n.current=e,_())},[e,_]),X.useEffect(()=>{$qe(r.current,t)||(r.current=t,_())},[t,_]),X.useEffect(()=>{if(jqe()&&d){HP.globalOptions=Nre.globalOptions;const b=HP(d,n.current,r.current);return c(b),()=>b.destroy()}else c(void 0)},[d,c]),[i,a]}Nre.globalOptions=void 0;var AB="Collapsible",[yZe,Fre]=Al(AB),[vZe,PB]=yZe(AB),Bre=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:c,onOpenChange:d,...i}=e,[_=!1,b]=Sl({prop:r,defaultProp:a,onChange:d});return _e.jsx(vZe,{scope:n,disabled:c,contentId:el(),open:_,onOpenToggle:X.useCallback(()=>b(T=>!T),[b]),children:_e.jsx(Qn.div,{"data-state":IB(_),"data-disabled":c?"":void 0,...i,ref:t})})});Bre.displayName=AB;var jre="CollapsibleTrigger",$re=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=PB(jre,n);return _e.jsx(Qn.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":IB(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:On(e.onClick,a.onOpenToggle)})});$re.displayName=jre;var CB="CollapsibleContent",Ure=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=PB(CB,e.__scopeCollapsible);return _e.jsx(Aa,{present:n||a.open,children:({present:c})=>_e.jsx(xZe,{...r,ref:t,present:c})})});Ure.displayName=CB;var xZe=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...c}=e,d=PB(CB,n),[i,_]=X.useState(r),b=X.useRef(null),T=Xr(t,b),A=X.useRef(0),k=A.current,R=X.useRef(0),B=R.current,N=d.open||i,V=X.useRef(N),H=X.useRef();return X.useEffect(()=>{const G=requestAnimationFrame(()=>V.current=!1);return()=>cancelAnimationFrame(G)},[]),Ea(()=>{const G=b.current;if(G){H.current=H.current||{transitionDuration:G.style.transitionDuration,animationName:G.style.animationName},G.style.transitionDuration="0s",G.style.animationName="none";const q=G.getBoundingClientRect();A.current=q.height,R.current=q.width,V.current||(G.style.transitionDuration=H.current.transitionDuration,G.style.animationName=H.current.animationName),_(r)}},[d.open,r]),_e.jsx(Qn.div,{"data-state":IB(d.open),"data-disabled":d.disabled?"":void 0,id:d.contentId,hidden:!N,...c,ref:T,style:{"--radix-collapsible-content-height":k?`${k}px`:void 0,"--radix-collapsible-content-width":B?`${B}px`:void 0,...e.style},children:N&&a})});function IB(e){return e?"open":"closed"}var bZe=Bre,wZe=$re,SZe=Ure,Af="Accordion",TZe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[MB,EZe,AZe]=$0(Af),[JI,WQe]=Al(Af,[AZe,Fre]),OB=Fre(),Vre=Ce.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,c=r;return _e.jsx(MB.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?_e.jsx(MZe,{...c,ref:t}):_e.jsx(IZe,{...a,ref:t})})});Vre.displayName=Af;var[Wre,PZe]=JI(Af),[Gre,CZe]=JI(Af,{collapsible:!1}),IZe=Ce.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:c=!1,...d}=e,[i,_]=Sl({prop:n,defaultProp:r,onChange:a});return _e.jsx(Wre,{scope:e.__scopeAccordion,value:i?[i]:[],onItemOpen:_,onItemClose:Ce.useCallback(()=>c&&_(""),[c,_]),children:_e.jsx(Gre,{scope:e.__scopeAccordion,collapsible:c,children:_e.jsx(Hre,{...d,ref:t})})})}),MZe=Ce.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...c}=e,[d=[],i]=Sl({prop:n,defaultProp:r,onChange:a}),_=Ce.useCallback(T=>i((A=[])=>[...A,T]),[i]),b=Ce.useCallback(T=>i((A=[])=>A.filter(k=>k!==T)),[i]);return _e.jsx(Wre,{scope:e.__scopeAccordion,value:d,onItemOpen:_,onItemClose:b,children:_e.jsx(Gre,{scope:e.__scopeAccordion,collapsible:!0,children:_e.jsx(Hre,{...c,ref:t})})})}),[OZe,QI]=JI(Af),Hre=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:c="vertical",...d}=e,i=Ce.useRef(null),_=Xr(i,t),b=EZe(n),A=S_(a)==="ltr",k=On(e.onKeyDown,R=>{var ye;if(!TZe.includes(R.key))return;const B=R.target,N=b().filter(De=>{var Ne;return!((Ne=De.ref.current)!=null&&Ne.disabled)}),V=N.findIndex(De=>De.ref.current===B),H=N.length;if(V===-1)return;R.preventDefault();let G=V;const q=0,Q=H-1,te=()=>{G=V+1,G>Q&&(G=q)},ue=()=>{G=V-1,G<q&&(G=Q)};switch(R.key){case"Home":G=q;break;case"End":G=Q;break;case"ArrowRight":c==="horizontal"&&(A?te():ue());break;case"ArrowDown":c==="vertical"&&te();break;case"ArrowLeft":c==="horizontal"&&(A?ue():te());break;case"ArrowUp":c==="vertical"&&ue();break}const fe=G%H;(ye=N[fe].ref.current)==null||ye.focus()});return _e.jsx(OZe,{scope:n,disabled:r,direction:a,orientation:c,children:_e.jsx(MB.Slot,{scope:n,children:_e.jsx(Qn.div,{...d,"data-orientation":c,ref:_,onKeyDown:r?void 0:k})})})}),qP="AccordionItem",[kZe,kB]=JI(qP),qre=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,c=QI(qP,n),d=PZe(qP,n),i=OB(n),_=el(),b=r&&d.value.includes(r)||!1,T=c.disabled||e.disabled;return _e.jsx(kZe,{scope:n,open:b,disabled:T,triggerId:_,children:_e.jsx(bZe,{"data-orientation":c.orientation,"data-state":Qre(b),...i,...a,ref:t,disabled:T,open:b,onOpenChange:A=>{A?d.onItemOpen(r):d.onItemClose(r)}})})});qre.displayName=qP;var Zre="AccordionHeader",Xre=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=QI(Af,n),c=kB(Zre,n);return _e.jsx(Qn.h3,{"data-orientation":a.orientation,"data-state":Qre(c.open),"data-disabled":c.disabled?"":void 0,...r,ref:t})});Xre.displayName=Zre;var Zz="AccordionTrigger",Kre=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=QI(Af,n),c=kB(Zz,n),d=CZe(Zz,n),i=OB(n);return _e.jsx(MB.ItemSlot,{scope:n,children:_e.jsx(wZe,{"aria-disabled":c.open&&!d.collapsible||void 0,"data-orientation":a.orientation,id:c.triggerId,...i,...r,ref:t})})});Kre.displayName=Zz;var Yre="AccordionContent",Jre=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=QI(Af,n),c=kB(Yre,n),d=OB(n);return _e.jsx(SZe,{role:"region","aria-labelledby":c.triggerId,"data-orientation":a.orientation,...d,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});Jre.displayName=Yre;function Qre(e){return e?"open":"closed"}var GQe=Vre,HQe=qre,qQe=Xre,ZQe=Kre,XQe=Jre,FH;(function(e){e[e.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",e[e.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",e[e.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(FH||(FH={}));var BH;(function(e){e[e.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",e[e.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",e[e.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(BH||(BH={}));/*! Capacitor: https://capacitorjs.com/ - MIT License */var k0;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(k0||(k0={}));class wR extends Error{constructor(t,n,r){super(t),this.message=t,this.code=n,this.data=r}}const RZe=e=>{var t,n;return e!=null&&e.androidBridge?"android":!((n=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},DZe=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},r=n.Plugins=n.Plugins||{},a=()=>t!==null?t.name:RZe(e),c=()=>a()!=="web",d=A=>{const k=b.get(A);return!!(k!=null&&k.platforms.has(a())||i(A))},i=A=>{var k;return(k=n.PluginHeaders)===null||k===void 0?void 0:k.find(R=>R.name===A)},_=A=>e.console.error(A),b=new Map,T=(A,k={})=>{const R=b.get(A);if(R)return console.warn(`Capacitor plugin "${A}" already registered. Cannot register plugins twice.`),R.proxy;const B=a(),N=i(A);let V;const H=async()=>(!V&&B in k?V=typeof k[B]=="function"?V=await k[B]():V=k[B]:t!==null&&!V&&"web"in k&&(V=typeof k.web=="function"?V=await k.web():V=k.web),V),G=(ye,De)=>{var Ne,Fe;if(N){const Le=N==null?void 0:N.methods.find(Ze=>De===Ze.name);if(Le)return Le.rtype==="promise"?Ze=>n.nativePromise(A,De.toString(),Ze):(Ze,He)=>n.nativeCallback(A,De.toString(),Ze,He);if(ye)return(Ne=ye[De])===null||Ne===void 0?void 0:Ne.bind(ye)}else{if(ye)return(Fe=ye[De])===null||Fe===void 0?void 0:Fe.bind(ye);throw new wR(`"${A}" plugin is not implemented on ${B}`,k0.Unimplemented)}},q=ye=>{let De;const Ne=(...Fe)=>{const Le=H().then(Ze=>{const He=G(Ze,ye);if(He){const ct=He(...Fe);return De=ct==null?void 0:ct.remove,ct}else throw new wR(`"${A}.${ye}()" is not implemented on ${B}`,k0.Unimplemented)});return ye==="addListener"&&(Le.remove=async()=>De()),Le};return Ne.toString=()=>`${ye.toString()}() { [capacitor code] }`,Object.defineProperty(Ne,"name",{value:ye,writable:!1,configurable:!1}),Ne},Q=q("addListener"),te=q("removeListener"),ue=(ye,De)=>{const Ne=Q({eventName:ye},De),Fe=async()=>{const Ze=await Ne;te({eventName:ye,callbackId:Ze},De)},Le=new Promise(Ze=>Ne.then(()=>Ze({remove:Fe})));return Le.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Fe()},Le},fe=new Proxy({},{get(ye,De){switch(De){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return N?ue:Q;case"removeListener":return te;default:return q(De)}}});return r[A]=fe,b.set(A,{name:A,proxy:fe,platforms:new Set([...Object.keys(k),...N?[B]:[]])}),fe};return n.convertFileSrc||(n.convertFileSrc=A=>A),n.getPlatform=a,n.handleError=_,n.isNativePlatform=c,n.isPluginAvailable=d,n.registerPlugin=T,n.Exception=wR,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},LZe=e=>e.Capacitor=DZe(e),Lv=LZe(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),RB=Lv.registerPlugin;class DB{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let r=!1;this.listeners[t]||(this.listeners[t]=[],r=!0),this.listeners[t].push(n);const c=this.windowListeners[t];c&&!c.registered&&this.addWindowListener(c),r&&this.sendRetainedArgumentsForEvent(t);const d=async()=>this.removeListener(t,n);return Promise.resolve({remove:d})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,r){const a=this.listeners[t];if(!a){if(r){let c=this.retainedEventArguments[t];c||(c=[]),c.push(n),this.retainedEventArguments[t]=c}return}a.forEach(c=>c(n))}hasListeners(t){var n;return!!(!((n=this.listeners[t])===null||n===void 0)&&n.length)}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(t="not implemented"){return new Lv.Exception(t,k0.Unimplemented)}unavailable(t="not available"){return new Lv.Exception(t,k0.Unavailable)}async removeListener(t,n){const r=this.listeners[t];if(!r)return;const a=r.indexOf(n);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(r=>{this.notifyListeners(t,r)}))}}const jH=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),$H=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class zZe extends DB{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(r=>{if(r.length<=0)return;let[a,c]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=$H(a).trim(),c=$H(c).trim(),n[a]=c}),n}async setCookie(t){try{const n=jH(t.key),r=jH(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,c=(t.path||"/").replace("path=",""),d=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${r||""}${a}; path=${c}; ${d};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}RB("CapacitorCookies",{web:()=>new zZe});const NZe=async e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const a=r.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>n(a),r.readAsDataURL(e)}),FZe=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(a=>a.toLocaleLowerCase()).reduce((a,c,d)=>(a[c]=e[t[d]],a),{})},BZe=(e,t=!0)=>e?Object.entries(e).reduce((r,a)=>{const[c,d]=a;let i,_;return Array.isArray(d)?(_="",d.forEach(b=>{i=t?encodeURIComponent(b):b,_+=`${c}=${i}&`}),_.slice(0,-1)):(i=t?encodeURIComponent(d):d,_=`${c}=${i}`),`${r}&${_}`},"").substr(1):null,jZe=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),a=FZe(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const c=new URLSearchParams;for(const[d,i]of Object.entries(e.data||{}))c.set(d,i);n.body=c.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const c=new FormData;if(e.data instanceof FormData)e.data.forEach((i,_)=>{c.append(_,i)});else for(const i of Object.keys(e.data))c.append(i,e.data[i]);n.body=c;const d=new Headers(n.headers);d.delete("content-type"),n.headers=d}else(a.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class $Ze extends DB{async request(t){const n=jZe(t,t.webFetchExtra),r=BZe(t.params,t.shouldEncodeUrlParams),a=r?`${t.url}?${r}`:t.url,c=await fetch(a,n),d=c.headers.get("content-type")||"";let{responseType:i="text"}=c.ok?t:{};d.includes("application/json")&&(i="json");let _,b;switch(i){case"arraybuffer":case"blob":b=await c.blob(),_=await NZe(b);break;case"json":_=await c.json();break;case"document":case"text":default:_=await c.text()}const T={};return c.headers.forEach((A,k)=>{T[k]=A}),{data:_,headers:T,status:c.status,url:c.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}RB("CapacitorHttp",{web:()=>new $Ze});function UZe(e){return new DataView(Uint8Array.from(e).buffer)}function VZe(e){return Array.from(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function WZe(e){return`0000${e.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function N2(e){const t=[];let n,r,a=1,c=0;for(n=0;n<e.length;n++)r=e.charCodeAt(n),(r>47&&r<58||r>64&&r<71||r>96&&r<103)&&(c=c<<4^(r>64?r+9:r)&15,(a^=1)&&t.push(c&255));return UZe(t)}function SR(e){return VZe(e).map(t=>{let n=t.toString(16);return n.length==1&&(n="0"+n),n}).join("")}function GZe(e){if(typeof e=="string")return e;if(typeof e=="number")return WZe(e);throw new Error("Invalid UUID")}function UH(e){const t={};if(e)return e.forEach((n,r)=>{t[r.toString()]=n}),t}const Ni=RB("BluetoothLe",{web:()=>z0(()=>Promise.resolve().then(()=>YZe),void 0).then(e=>new e.BluetoothLeWeb)}),HZe=()=>{let e=Promise.resolve();return t=>new Promise((n,r)=>{e=e.then(()=>t()).then(n).catch(r)})};function TR(e){return e?HZe():t=>t()}function os(e){if(typeof e!="string")throw new Error(`Invalid UUID type ${typeof e}. Expected string.`);if(e=e.toLowerCase(),!(e.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${e}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return e}class qZe{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=TR(!0)}enableQueue(){this.queue=TR(!0)}disableQueue(){this.queue=TR(!1)}async initialize(t){await this.queue(async()=>{await Ni.initialize(t)})}async isEnabled(){return await this.queue(async()=>(await Ni.isEnabled()).value)}async requestEnable(){await this.queue(async()=>{await Ni.requestEnable()})}async enable(){await this.queue(async()=>{await Ni.enable()})}async disable(){await this.queue(async()=>{await Ni.disable()})}async startEnabledNotifications(t){await this.queue(async()=>{var n;const r="onEnabledChanged";await((n=this.eventListeners.get(r))===null||n===void 0?void 0:n.remove());const a=await Ni.addListener(r,c=>{t(c.value)});this.eventListeners.set(r,a),await Ni.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var t;const n="onEnabledChanged";await((t=this.eventListeners.get(n))===null||t===void 0?void 0:t.remove()),this.eventListeners.delete(n),await Ni.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await Ni.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await Ni.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await Ni.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await Ni.openAppSettings()})}async setDisplayStrings(t){await this.queue(async()=>{await Ni.setDisplayStrings(t)})}async requestDevice(t){return t=t?this.validateRequestBleDeviceOptions(t):void 0,await this.queue(async()=>await Ni.requestDevice(t))}async requestLEScan(t,n){t=this.validateRequestBleDeviceOptions(t),await this.queue(async()=>{var r;await((r=this.scanListener)===null||r===void 0?void 0:r.remove()),this.scanListener=await Ni.addListener("onScanResult",a=>{const c=Object.assign(Object.assign({},a),{manufacturerData:this.convertObject(a.manufacturerData),serviceData:this.convertObject(a.serviceData),rawAdvertisement:a.rawAdvertisement?this.convertValue(a.rawAdvertisement):void 0});n(c)}),await Ni.requestLEScan(t)})}async stopLEScan(){await this.queue(async()=>{var t;await((t=this.scanListener)===null||t===void 0?void 0:t.remove()),this.scanListener=null,await Ni.stopLEScan()})}async getDevices(t){if(!Array.isArray(t))throw new Error("deviceIds must be an array");return this.queue(async()=>(await Ni.getDevices({deviceIds:t})).devices)}async getConnectedDevices(t){if(!Array.isArray(t))throw new Error("services must be an array");return t=t.map(os),this.queue(async()=>(await Ni.getConnectedDevices({services:t})).devices)}async getBondedDevices(){return this.queue(async()=>(await Ni.getBondedDevices()).devices)}async connect(t,n,r){await this.queue(async()=>{var a;if(n){const c=`disconnected|${t}`;await((a=this.eventListeners.get(c))===null||a===void 0?void 0:a.remove());const d=await Ni.addListener(c,()=>{n(t)});this.eventListeners.set(c,d)}await Ni.connect(Object.assign({deviceId:t},r))})}async createBond(t,n){await this.queue(async()=>{await Ni.createBond(Object.assign({deviceId:t},n))})}async isBonded(t){return await this.queue(async()=>(await Ni.isBonded({deviceId:t})).value)}async disconnect(t){await this.queue(async()=>{await Ni.disconnect({deviceId:t})})}async getServices(t){return await this.queue(async()=>(await Ni.getServices({deviceId:t})).services)}async discoverServices(t){await this.queue(async()=>{await Ni.discoverServices({deviceId:t})})}async getMtu(t){return await this.queue(async()=>(await Ni.getMtu({deviceId:t})).value)}async requestConnectionPriority(t,n){await this.queue(async()=>{await Ni.requestConnectionPriority({deviceId:t,connectionPriority:n})})}async readRssi(t){return await this.queue(async()=>{const r=await Ni.readRssi({deviceId:t});return parseFloat(r.value)})}async read(t,n,r,a){return n=os(n),r=os(r),await this.queue(async()=>{const d=await Ni.read(Object.assign({deviceId:t,service:n,characteristic:r},a));return this.convertValue(d.value)})}async write(t,n,r,a,c){return n=os(n),r=os(r),this.queue(async()=>{if(!(a!=null&&a.buffer))throw new Error("Invalid data.");let d=a;Lv.getPlatform()!=="web"&&(d=SR(a)),await Ni.write(Object.assign({deviceId:t,service:n,characteristic:r,value:d},c))})}async writeWithoutResponse(t,n,r,a,c){n=os(n),r=os(r),await this.queue(async()=>{if(!(a!=null&&a.buffer))throw new Error("Invalid data.");let d=a;Lv.getPlatform()!=="web"&&(d=SR(a)),await Ni.writeWithoutResponse(Object.assign({deviceId:t,service:n,characteristic:r,value:d},c))})}async readDescriptor(t,n,r,a,c){return n=os(n),r=os(r),a=os(a),await this.queue(async()=>{const i=await Ni.readDescriptor(Object.assign({deviceId:t,service:n,characteristic:r,descriptor:a},c));return this.convertValue(i.value)})}async writeDescriptor(t,n,r,a,c,d){return n=os(n),r=os(r),a=os(a),this.queue(async()=>{if(!(c!=null&&c.buffer))throw new Error("Invalid data.");let i=c;Lv.getPlatform()!=="web"&&(i=SR(c)),await Ni.writeDescriptor(Object.assign({deviceId:t,service:n,characteristic:r,descriptor:a,value:i},d))})}async startNotifications(t,n,r,a){n=os(n),r=os(r),await this.queue(async()=>{var c;const d=`notification|${t}|${n}|${r}`;await((c=this.eventListeners.get(d))===null||c===void 0?void 0:c.remove());const i=await Ni.addListener(d,_=>{a(this.convertValue(_==null?void 0:_.value))});this.eventListeners.set(d,i),await Ni.startNotifications({deviceId:t,service:n,characteristic:r})})}async stopNotifications(t,n,r){n=os(n),r=os(r),await this.queue(async()=>{var a;const c=`notification|${t}|${n}|${r}`;await((a=this.eventListeners.get(c))===null||a===void 0?void 0:a.remove()),this.eventListeners.delete(c),await Ni.stopNotifications({deviceId:t,service:n,characteristic:r})})}validateRequestBleDeviceOptions(t){return t.services&&(t.services=t.services.map(os)),t.optionalServices&&(t.optionalServices=t.optionalServices.map(os)),t}convertValue(t){return typeof t=="string"?N2(t):t===void 0?new DataView(new ArrayBuffer(0)):t}convertObject(t){if(t===void 0)return;const n={};for(const r of Object.keys(t))n[r]=this.convertValue(t[r]);return n}}const KQe=new qZe;var eie={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(ws,function(){var n,r,a;function c(i,_){if(!n)n=_;else if(!r)r=_;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",T={};n(T),a=_(T),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}c(["exports"],function(i){var _=1e-6,b=typeof Float32Array<"u"?Float32Array:Array;function T(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=l*y-p*f;return v?(u[0]=y*(v=1/v),u[1]=-f*v,u[2]=-p*v,u[3]=l*v,u):null}function A(){var u=new b(9);return b!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function k(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=o[4],E=o[5],C=o[6],O=o[7],z=o[8];return u[0]=v*z-E*O,u[1]=p*O-f*z,u[2]=f*E-p*v,u[3]=E*C-y*z,u[4]=l*z-p*C,u[5]=p*y-l*E,u[6]=y*O-v*C,u[7]=f*C-l*O,u[8]=l*v-f*y,u}function R(u,o,l){var f=o[0],p=o[1],y=o[2],v=o[3],E=o[4],C=o[5],O=o[6],z=o[7],F=o[8],$=l[0],Y=l[1],J=l[2],re=l[3],ce=l[4],de=l[5],we=l[6],ve=l[7],ie=l[8];return u[0]=$*f+Y*v+J*O,u[1]=$*p+Y*E+J*z,u[2]=$*y+Y*C+J*F,u[3]=re*f+ce*v+de*O,u[4]=re*p+ce*E+de*z,u[5]=re*y+ce*C+de*F,u[6]=we*f+ve*v+ie*O,u[7]=we*p+ve*E+ie*z,u[8]=we*y+ve*C+ie*F,u}function B(){var u=new b(16);return b!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function N(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function V(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=o[4],E=o[5],C=o[6],O=o[7],z=o[8],F=o[9],$=o[10],Y=o[11],J=o[12],re=o[13],ce=o[14],de=o[15],we=l*E-f*v,ve=l*C-p*v,ie=l*O-y*v,ge=f*C-p*E,be=f*O-y*E,Ee=p*O-y*C,Ue=z*re-F*J,qe=z*ce-$*J,Ke=z*de-Y*J,Qe=F*ce-$*re,xt=F*de-Y*re,Dt=$*de-Y*ce,Ct=we*Dt-ve*xt+ie*Qe+ge*Ke-be*qe+Ee*Ue;return Ct?(u[0]=(E*Dt-C*xt+O*Qe)*(Ct=1/Ct),u[1]=(p*xt-f*Dt-y*Qe)*Ct,u[2]=(re*Ee-ce*be+de*ge)*Ct,u[3]=($*be-F*Ee-Y*ge)*Ct,u[4]=(C*Ke-v*Dt-O*qe)*Ct,u[5]=(l*Dt-p*Ke+y*qe)*Ct,u[6]=(ce*ie-J*Ee-de*ve)*Ct,u[7]=(z*Ee-$*ie+Y*ve)*Ct,u[8]=(v*xt-E*Ke+O*Ue)*Ct,u[9]=(f*Ke-l*xt-y*Ue)*Ct,u[10]=(J*be-re*ie+de*we)*Ct,u[11]=(F*ie-z*be-Y*we)*Ct,u[12]=(E*qe-v*Qe-C*Ue)*Ct,u[13]=(l*Qe-f*qe+p*Ue)*Ct,u[14]=(re*ve-J*ge-ce*we)*Ct,u[15]=(z*ge-F*ve+$*we)*Ct,u):null}function H(u,o,l){var f=o[0],p=o[1],y=o[2],v=o[3],E=o[4],C=o[5],O=o[6],z=o[7],F=o[8],$=o[9],Y=o[10],J=o[11],re=o[12],ce=o[13],de=o[14],we=o[15],ve=l[0],ie=l[1],ge=l[2],be=l[3];return u[0]=ve*f+ie*E+ge*F+be*re,u[1]=ve*p+ie*C+ge*$+be*ce,u[2]=ve*y+ie*O+ge*Y+be*de,u[3]=ve*v+ie*z+ge*J+be*we,u[4]=(ve=l[4])*f+(ie=l[5])*E+(ge=l[6])*F+(be=l[7])*re,u[5]=ve*p+ie*C+ge*$+be*ce,u[6]=ve*y+ie*O+ge*Y+be*de,u[7]=ve*v+ie*z+ge*J+be*we,u[8]=(ve=l[8])*f+(ie=l[9])*E+(ge=l[10])*F+(be=l[11])*re,u[9]=ve*p+ie*C+ge*$+be*ce,u[10]=ve*y+ie*O+ge*Y+be*de,u[11]=ve*v+ie*z+ge*J+be*we,u[12]=(ve=l[12])*f+(ie=l[13])*E+(ge=l[14])*F+(be=l[15])*re,u[13]=ve*p+ie*C+ge*$+be*ce,u[14]=ve*y+ie*O+ge*Y+be*de,u[15]=ve*v+ie*z+ge*J+be*we,u}function G(u,o,l){var f,p,y,v,E,C,O,z,F,$,Y,J,re=l[0],ce=l[1],de=l[2];return o===u?(u[12]=o[0]*re+o[4]*ce+o[8]*de+o[12],u[13]=o[1]*re+o[5]*ce+o[9]*de+o[13],u[14]=o[2]*re+o[6]*ce+o[10]*de+o[14],u[15]=o[3]*re+o[7]*ce+o[11]*de+o[15]):(p=o[1],y=o[2],v=o[3],E=o[4],C=o[5],O=o[6],z=o[7],F=o[8],$=o[9],Y=o[10],J=o[11],u[0]=f=o[0],u[1]=p,u[2]=y,u[3]=v,u[4]=E,u[5]=C,u[6]=O,u[7]=z,u[8]=F,u[9]=$,u[10]=Y,u[11]=J,u[12]=f*re+E*ce+F*de+o[12],u[13]=p*re+C*ce+$*de+o[13],u[14]=y*re+O*ce+Y*de+o[14],u[15]=v*re+z*ce+J*de+o[15]),u}function q(u,o,l){var f=l[0],p=l[1],y=l[2];return u[0]=o[0]*f,u[1]=o[1]*f,u[2]=o[2]*f,u[3]=o[3]*f,u[4]=o[4]*p,u[5]=o[5]*p,u[6]=o[6]*p,u[7]=o[7]*p,u[8]=o[8]*y,u[9]=o[9]*y,u[10]=o[10]*y,u[11]=o[11]*y,u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15],u}function Q(u,o,l){var f=Math.sin(l),p=Math.cos(l),y=o[4],v=o[5],E=o[6],C=o[7],O=o[8],z=o[9],F=o[10],$=o[11];return o!==u&&(u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[3],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[4]=y*p+O*f,u[5]=v*p+z*f,u[6]=E*p+F*f,u[7]=C*p+$*f,u[8]=O*p-y*f,u[9]=z*p-v*f,u[10]=F*p-E*f,u[11]=$*p-C*f,u}function te(u,o,l){var f=Math.sin(l),p=Math.cos(l),y=o[0],v=o[1],E=o[2],C=o[3],O=o[8],z=o[9],F=o[10],$=o[11];return o!==u&&(u[4]=o[4],u[5]=o[5],u[6]=o[6],u[7]=o[7],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=y*p-O*f,u[1]=v*p-z*f,u[2]=E*p-F*f,u[3]=C*p-$*f,u[8]=y*f+O*p,u[9]=v*f+z*p,u[10]=E*f+F*p,u[11]=C*f+$*p,u}function ue(u,o,l){var f=Math.sin(l),p=Math.cos(l),y=o[0],v=o[1],E=o[2],C=o[3],O=o[4],z=o[5],F=o[6],$=o[7];return o!==u&&(u[8]=o[8],u[9]=o[9],u[10]=o[10],u[11]=o[11],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=y*p+O*f,u[1]=v*p+z*f,u[2]=E*p+F*f,u[3]=C*p+$*f,u[4]=O*p-y*f,u[5]=z*p-v*f,u[6]=F*p-E*f,u[7]=$*p-C*f,u}function fe(u,o){return u[0]=o[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=o[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=o[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ye(u,o,l){var f,p,y,v=l[0],E=l[1],C=l[2],O=Math.hypot(v,E,C);return O<_?null:(v*=O=1/O,E*=O,C*=O,f=Math.sin(o),p=Math.cos(o),u[0]=v*v*(y=1-p)+p,u[1]=E*v*y+C*f,u[2]=C*v*y-E*f,u[3]=0,u[4]=v*E*y-C*f,u[5]=E*E*y+p,u[6]=C*E*y+v*f,u[7]=0,u[8]=v*C*y+E*f,u[9]=E*C*y-v*f,u[10]=C*C*y+p,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}function De(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=l+l,E=f+f,C=p+p,O=l*v,z=f*v,F=f*E,$=p*v,Y=p*E,J=p*C,re=y*v,ce=y*E,de=y*C;return u[0]=1-F-J,u[1]=z+de,u[2]=$-ce,u[3]=0,u[4]=z-de,u[5]=1-O-J,u[6]=Y+re,u[7]=0,u[8]=$+ce,u[9]=Y-re,u[10]=1-O-F,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}Math.hypot||(Math.hypot=function(){for(var u=0,o=arguments.length;o--;)u+=arguments[o]*arguments[o];return Math.sqrt(u)});var Ne=H;function Fe(){var u=new b(3);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function Le(u){var o=new b(3);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o}function Ze(u){return Math.hypot(u[0],u[1],u[2])}function He(u,o,l){var f=new b(3);return f[0]=u,f[1]=o,f[2]=l,f}function ct(u,o,l){return u[0]=o[0]+l[0],u[1]=o[1]+l[1],u[2]=o[2]+l[2],u}function ot(u,o,l){return u[0]=o[0]-l[0],u[1]=o[1]-l[1],u[2]=o[2]-l[2],u}function rt(u,o,l){return u[0]=o[0]*l[0],u[1]=o[1]*l[1],u[2]=o[2]*l[2],u}function Be(u,o,l){return u[0]=Math.min(o[0],l[0]),u[1]=Math.min(o[1],l[1]),u[2]=Math.min(o[2],l[2]),u}function nt(u,o,l){return u[0]=Math.max(o[0],l[0]),u[1]=Math.max(o[1],l[1]),u[2]=Math.max(o[2],l[2]),u}function at(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u[2]=o[2]*l,u}function Mt(u,o,l,f){return u[0]=o[0]+l[0]*f,u[1]=o[1]+l[1]*f,u[2]=o[2]+l[2]*f,u}function Nt(u,o){var l=o[0]-u[0],f=o[1]-u[1],p=o[2]-u[2];return l*l+f*f+p*p}function rn(u){var o=u[0],l=u[1],f=u[2];return o*o+l*l+f*f}function un(u,o){return u[0]=-o[0],u[1]=-o[1],u[2]=-o[2],u}function en(u,o){var l=o[0],f=o[1],p=o[2],y=l*l+f*f+p*p;return y>0&&(y=1/Math.sqrt(y)),u[0]=o[0]*y,u[1]=o[1]*y,u[2]=o[2]*y,u}function sn(u,o){return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]}function Vt(u,o,l){var f=o[0],p=o[1],y=o[2],v=l[0],E=l[1],C=l[2];return u[0]=p*C-y*E,u[1]=y*v-f*C,u[2]=f*E-p*v,u}function $n(u,o,l,f){var p=o[0],y=o[1],v=o[2];return u[0]=p+f*(l[0]-p),u[1]=y+f*(l[1]-y),u[2]=v+f*(l[2]-v),u}function Gt(u,o,l){var f=o[0],p=o[1],y=o[2],v=l[3]*f+l[7]*p+l[11]*y+l[15];return u[0]=(l[0]*f+l[4]*p+l[8]*y+l[12])/(v=v||1),u[1]=(l[1]*f+l[5]*p+l[9]*y+l[13])/v,u[2]=(l[2]*f+l[6]*p+l[10]*y+l[14])/v,u}function Tn(u,o,l){var f=o[0],p=o[1],y=o[2];return u[0]=f*l[0]+p*l[3]+y*l[6],u[1]=f*l[1]+p*l[4]+y*l[7],u[2]=f*l[2]+p*l[5]+y*l[8],u}function hn(u,o,l){var f=l[0],p=l[1],y=l[2],v=o[0],E=o[1],C=o[2],O=p*C-y*E,z=y*v-f*C,F=f*E-p*v,$=p*F-y*z,Y=y*O-f*F,J=f*z-p*O,re=2*l[3];return z*=re,F*=re,Y*=2,J*=2,u[0]=v+(O*=re)+($*=2),u[1]=E+z+Y,u[2]=C+F+J,u}function yt(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]}var In=ot,Kn=rt,Ar=Ze;function _r(){var u=new b(4);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function Vr(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u[2]=o[2]*l,u[3]=o[3]*l,u}function it(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=l*l+f*f+p*p+y*y;return v>0&&(v=1/Math.sqrt(v)),u[0]=l*v,u[1]=f*v,u[2]=p*v,u[3]=y*v,u}function Pt(u,o,l){var f=o[0],p=o[1],y=o[2],v=o[3];return u[0]=l[0]*f+l[4]*p+l[8]*y+l[12]*v,u[1]=l[1]*f+l[5]*p+l[9]*y+l[13]*v,u[2]=l[2]*f+l[6]*p+l[10]*y+l[14]*v,u[3]=l[3]*f+l[7]*p+l[11]*y+l[15]*v,u}function jt(){var u=new b(4);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function Cn(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function Mn(u,o,l){l*=.5;var f=o[0],p=o[1],y=o[2],v=o[3],E=Math.sin(l),C=Math.cos(l);return u[0]=f*C+v*E,u[1]=p*C+y*E,u[2]=y*C-p*E,u[3]=v*C-f*E,u}function _n(u,o,l){l*=.5;var f=o[0],p=o[1],y=o[2],v=o[3],E=Math.sin(l),C=Math.cos(l);return u[0]=f*C-y*E,u[1]=p*C+v*E,u[2]=y*C+f*E,u[3]=v*C-p*E,u}Fe(),_r();var Gn,vr,ni,vi,na,fa=it,to=(Gn=Fe(),vr=He(1,0,0),ni=He(0,1,0),function(u,o,l){var f=sn(o,l);return f<-.999999?(Vt(Gn,vr,o),Ar(Gn)<1e-6&&Vt(Gn,ni,o),en(Gn,Gn),function(p,y,v){v*=.5;var E=Math.sin(v);p[0]=E*y[0],p[1]=E*y[1],p[2]=E*y[2],p[3]=Math.cos(v)}(u,Gn,Math.PI),u):f>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(Vt(Gn,o,l),u[0]=Gn[0],u[1]=Gn[1],u[2]=Gn[2],u[3]=1+f,fa(u,u))});function uo(){var u=new b(2);return b!=Float32Array&&(u[0]=0,u[1]=0),u}function ja(u,o){var l=new b(2);return l[0]=u,l[1]=o,l}function Bo(u,o,l){return u[0]=o[0]+l[0],u[1]=o[1]+l[1],u}function fo(u,o,l){return u[0]=o[0]-l[0],u[1]=o[1]-l[1],u}function $a(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u}function Ua(u){return Math.hypot(u[0],u[1])}function Es(u,o){var l=o[0],f=o[1],p=l*l+f*f;return p>0&&(p=1/Math.sqrt(p)),u[0]=o[0]*p,u[1]=o[1]*p,u}function ci(u,o){return u[0]*o[0]+u[1]*o[1]}function Qa(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}jt(),jt(),A(),uo();var As,pa,Ps=function(){if(na)return vi;function u(o,l,f,p){this.cx=3*o,this.bx=3*(f-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=l,this.p2x=f,this.p2y=p}return na=1,vi=u,u.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,l){if(l===void 0&&(l=1e-6),o<0)return 0;if(o>1)return 1;for(var f=o,p=0;p<8;p++){var y=this.sampleCurveX(f)-o;if(Math.abs(y)<l)return f;var v=this.sampleCurveDerivativeX(f);if(Math.abs(v)<1e-6)break;f-=y/v}var E=0,C=1;for(f=o,p=0;p<20&&(y=this.sampleCurveX(f),!(Math.abs(y-o)<l));p++)o>y?E=f:C=f,f=.5*(C-E)+E;return f},solve:function(o,l){return this.sampleCurveY(this.solveCurveX(o,l))}},vi}(),es=Qa(Ps);function Cl(){if(pa)return As;function u(o,l){this.x=o,this.y=l}return pa=1,As=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,l){return this.clone()._rotateAround(o,l)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var l=o.x-this.x,f=o.y-this.y;return l*l+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,l){return Math.atan2(this.x*l-this.y*o,this.x*o+this.y*l)},_matMult:function(o){var l=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=l,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var l=Math.cos(o),f=Math.sin(o),p=f*this.x+l*this.y;return this.x=l*this.x-f*this.y,this.y=p,this},_rotateAround:function(o,l){var f=Math.cos(o),p=Math.sin(o),y=l.y+p*(this.x-l.x)+f*(this.y-l.y);return this.x=l.x+f*(this.x-l.x)-p*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(o){return o instanceof u?o:Array.isArray(o)?new u(o[0],o[1]):o},As}var Tt=Qa(Cl());function pi(u,o){if(Array.isArray(u)){if(!Array.isArray(o)||u.length!==o.length)return!1;for(let l=0;l<u.length;l++)if(!pi(u[l],o[l]))return!1;return!0}if(typeof u=="object"&&u!==null&&o!==null){if(typeof o!="object"||Object.keys(u).length!==Object.keys(o).length)return!1;for(const l in u)if(!pi(u[l],o[l]))return!1;return!0}return u===o}const Yi=Math.PI/180,mt=180/Math.PI;function ae(u){return u*Yi}function me(u){return u*mt}const Me=[[0,0],[1,0],[1,1],[0,1]];function We(u){if(u<=0)return 0;if(u>=1)return 1;const o=u*u,l=o*u;return 4*(u<.5?l:3*(u-o)+l-.75)}function je(u,o,l,f){const p=new es(u,o,l,f);return function(y){return p.solve(y)}}const Xe=je(.25,.1,.25,1);function $e(u,o,l){return Math.min(l,Math.max(o,u))}function Ye(u,o,l){return(l=$e((l-u)/(o-u),0,1))*l*(3-2*l)}function ft(u,o,l){const f=l-o,p=((u-o)%f+f)%f+o;return p===o?l:p}function St(u,o,l){if(!u.length)return l(null,[]);let f=u.length;const p=new Array(u.length);let y=null;u.forEach((v,E)=>{o(v,(C,O)=>{C&&(y=C),p[E]=O,--f==0&&l(y,p)})})}function ut(u,...o){for(const l of o)for(const f in l)u[f]=l[f];return u}let Yt=1;function an(){return Yt++}function pn(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function Zn(u,o){u.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function er(u,o,l){const f={};for(const p in u)f[p]=o.call(this,u[p],p,u);return f}function or(u,o,l){const f={};for(const p in u)o.call(this,u[p],p,u)&&(f[p]=u[p]);return f}function pr(u){return Array.isArray(u)?u.map(pr):typeof u=="object"&&u?er(u,pr):u}const Wi={};function mr(u){Wi[u]||(typeof console<"u"&&console.warn(u),Wi[u]=!0)}function ui(u,o,l){return(l.y-u.y)*(o.x-u.x)>(o.y-u.y)*(l.x-u.x)}function Cr(u){let o=0;for(let l,f,p=0,y=u.length,v=y-1;p<y;v=p++)l=u[p],f=u[v],o+=(f.x-l.x)*(l.y+f.y);return o}function hi([u,o,l]){const f=ae(o+90),p=ae(l);return{x:u*Math.cos(f)*Math.sin(p),y:u*Math.sin(f)*Math.sin(p),z:u*Math.cos(p),azimuthal:o,polar:l}}function mi(u){return(typeof self<"u"||u!==void 0)&&typeof WorkerGlobalScope<"u"&&(u!==void 0?u:self)instanceof WorkerGlobalScope}function no(u){const o={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,f,p,y)=>{const v=p||y;return o[f]=!v||v.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let vo=null;function jo(u,o){return[u[4*o],u[4*o+1],u[4*o+2],u[4*o+3]]}function $o(u,o,l,f){for(;o<l;){const p=o+l>>1;u[p]<f?o=p+1:l=p}return o}function Cs(u,o,l,f){for(;o<l;){const p=o+l>>1;u[p]<=f?o=p+1:l=p}return o}function ma(u){return u>0?1/(1.001-u):1+u}function ga(u){return u>0?1-1/(1.001-u):-u}function xo(u,o,l){return(u-o.min)*(l.max-l.min)/(o.max-o.min)+l.min}const kr={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!kr.API_URL)return null;try{const u=new URL(kr.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Gi(u){return kr.API_URL_REGEX.test(u)}function Il(u){return kr.API_SPRITE_REGEX.test(u)}let Ml,rl,mh,Wr,co,mu;function gh(){return Ml==null&&(Ml=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ml}const Mo={now:()=>Wr!==void 0?Wr:performance.now(),setNow(u){Wr=u},restoreNow(){Wr=void 0},frame(u){const o=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(u,o=0){const{width:l,height:f}=u;co||(co=document.createElement("canvas"));const p=co.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>co.width||f>co.height)&&(co.width=l,co.height=f),p.clearRect(-o,-o,l+2*o,f+2*o),p.drawImage(u,0,0,l,f),p.getImageData(-o,-o,l+2*o,f+2*o)},resolveURL:u=>(rl||(rl=document.createElement("a")),rl.href=u,rl.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(mh==null&&(mh=window.matchMedia("(prefers-reduced-motion: reduce)")),mh.matches)},hasCanvasFingerprintNoise(){if(mu!==void 0)return mu;if(!gh())return mu=!1,!1;const u=new OffscreenCanvas(85,1),o=u.getContext("2d",{willReadFrequently:!0});let l=0;for(let p=0;p<u.width;++p)o.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,o.fillRect(p,0,1,1);const f=o.getImageData(0,0,u.width,u.height);l=0;for(let p=0;p<f.data.length;++p)if(p%4!=3&&l++!==f.data[p])return mu=!0,!0;return mu=!1,!1}};function Mm(u,o){const l=u.indexOf("?");if(l<0)return`${u}?${new URLSearchParams(o).toString()}`;const f=new URLSearchParams(u.slice(l));for(const p in o)f.set(p,o[p]);return`${u.slice(0,l)}?${f.toString()}`}function Pa(u,o={persistentParams:[]}){const l=u.indexOf("?");if(l<0)return u;const f=new URLSearchParams,p=new URLSearchParams(u.slice(l));for(const v of o.persistentParams){const E=p.get(v);E&&f.set(v,E)}const y=f.toString();return`${u.slice(0,l)}${y.length>0?`?${y}`:""}`}const Ca="mapbox-tiles";let ro=500,Ia=50;const Is=["language","worldview","jobid"];let Va,gu;function _u(){try{return caches}catch{}}function il(){const u=_u();u&&Va==null&&(Va=u.open(Ca))}let yu=1/0;const _h={supported:!1,testSupport:function(u){!xu&&_a&&(ud?R_(u):vu=u)}};let vu,_a,xu=!1,ud=!1;const Fc=typeof self<"u"?self:{};function R_(u){const o=u.createTexture();u.bindTexture(u.TEXTURE_2D,o);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,_a),u.isContextLost())return;_h.supported=!0}catch{}u.deleteTexture(o),xu=!0}Fc.document&&(_a=Fc.document.createElement("img"),_a.onload=function(){vu&&R_(vu),vu=null,ud=!0},_a.onerror=function(){xu=!0,vu=null},_a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Fr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Fr);class Ms extends Error{constructor(o,l,f){l===401&&Gi(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Hn=mi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,bu=function(u,o){if(!(/^file:/.test(l=u.url)||/^file:/.test(Hn())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,p){const y=new AbortController,v=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Hn(),referrerPolicy:f.referrerPolicy,signal:y.signal});let E=!1,C=!1;const O=(z=v.url).indexOf("sku=")>0&&Gi(z);var z;f.type==="json"&&v.headers.set("Accept","application/json");const F=(Y,J,re)=>{if(C)return;if(Y&&Y.message!=="SecurityError"&&mr(Y.toString()),J&&re)return $(J);const ce=Date.now();fetch(v).then(de=>{if(de.ok){const we=O?de.clone():null;return $(de,we,ce)}return p(new Ms(de.statusText,de.status,f.url))}).catch(de=>{de.name!=="AbortError"&&p(new Error(`${de.message} ${f.url}`))})},$=(Y,J,re)=>{(f.type==="arrayBuffer"?Y.arrayBuffer():f.type==="json"?Y.json():Y.text()).then(ce=>{C||(J&&re&&function(de,we,ve){if(il(),Va==null)return;const ie=no(we.headers.get("Cache-Control")||"");if(ie["no-store"])return;const ge={status:we.status,statusText:we.statusText,headers:new Headers};we.headers.forEach((Ue,qe)=>ge.headers.set(qe,Ue)),ie["max-age"]&&ge.headers.set("Expires",new Date(ve+1e3*ie["max-age"]).toUTCString());const be=ge.headers.get("Expires");if(!be||new Date(be).getTime()-ve<42e4)return;let Ee=Pa(de.url,{persistentParams:Is});if(we.status===206){const Ue=de.headers.get("Range");if(!Ue)return;ge.status=200,Ee=Mm(Ee,{range:Ue})}(function(Ue,qe){if(gu===void 0)try{new Response(new ReadableStream),gu=!0}catch{gu=!1}gu?qe(Ue.body):Ue.blob().then(qe).catch(Ke=>mr(Ke.message))})(we,Ue=>{const qe=new Response((Ke=we.status)!==200&&Ke!==404&&[101,103,204,205,304].includes(Ke)?null:Ue,ge);var Ke;il(),Va!=null&&Va.then(Qe=>Qe.put(Ee,qe)).catch(Qe=>mr(Qe.message))})}(v,J,re),E=!0,p(null,ce,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(ce=>{C||p(new Error(ce.message))})};return O?function(Y,J){if(il(),Va==null)return J(null);Va.then(re=>{let ce=Pa(Y.url,{persistentParams:Is});const de=Y.headers.get("Range");de&&(ce=Mm(ce,{range:de})),re.match(ce).then(we=>{const ve=function(ie){if(!ie)return!1;const ge=new Date(ie.headers.get("Expires")||0),be=no(ie.headers.get("Cache-Control")||"");return Number(ge)>Date.now()&&!be["no-cache"]}(we);re.delete(ce).catch(J),ve&&re.put(ce,we.clone()).catch(J),J(null,we,ve)}).catch(J)}).catch(J)}(v,F):F(null,null),{cancel:()=>{C=!0,E||y.abort()}}}(u,o);if(mi(self)&&self.worker.actor)return self.worker.actor.send("getResource",u,o,void 0,!0)}var l;return function(f,p){const y=new XMLHttpRequest;y.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const v in f.headers)y.setRequestHeader(v,f.headers[v]);return f.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=f.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let v=y.response;if(f.type==="json")try{v=JSON.parse(y.response)}catch(E){return p(E)}p(null,v,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else p(new Ms(y.statusText,y.status,f.url))},y.send(f.body),{cancel:()=>y.abort()}}(u,o)},Bc=function(u,o){return bu(ut(u,{type:"arrayBuffer"}),o)};function Om(u){const o=document.createElement("a");return o.href=u,o.protocol===location.protocol&&o.host===location.host}const Pf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Os,Ol;Os=[],Ol=0;const kl=function(u,o){if(_h.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Ol>=kr.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:u,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Os.push(y),y}Ol++;let l=!1;const f=()=>{if(!l)for(l=!0,Ol--;Os.length&&Ol<kr.MAX_PARALLEL_IMAGE_REQUESTS;){const y=Os.shift(),{requestParameters:v,callback:E,cancelled:C}=y;C||(y.cancel=kl(v,E).cancel)}},p=Bc(u,(y,v,E,C)=>{f(),y?o(y):v&&(self.createImageBitmap?function(O,z){const F=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(F).then($=>{z(null,$)}).catch($=>{z(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(O,z)=>o(O,z,E,C)):function(O,z){const F=new Image;F.onload=()=>{z(null,F),URL.revokeObjectURL(F.src),F.onload=null,requestAnimationFrame(()=>{F.src=Pf})},F.onerror=()=>z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const $=new Blob([new Uint8Array(O)],{type:"image/png"});F.src=O.byteLength?URL.createObjectURL($):Pf}(v,(O,z)=>o(O,z,E,C)))});return{cancel:()=>{p.cancel(),f()}}};var ya,rc,jc,yh={exports:{}},vh={exports:{}},hd={exports:{}},dd=function(){if(jc)return yh.exports;jc=1;var u=(ya||(ya=1,vh.exports=function(l,f){var p,y,v,E,C,O,z,F;for(y=l.length-(p=3&l.length),v=f,C=3432918353,O=461845907,F=0;F<y;)z=255&l.charCodeAt(F)|(255&l.charCodeAt(++F))<<8|(255&l.charCodeAt(++F))<<16|(255&l.charCodeAt(++F))<<24,++F,v=27492+(65535&(E=5*(65535&(v=(v^=z=(65535&(z=(z=(65535&z)*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*O+(((z>>>16)*O&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(z=0,p){case 3:z^=(255&l.charCodeAt(F+2))<<16;case 2:z^=(255&l.charCodeAt(F+1))<<8;case 1:v^=z=(65535&(z=(z=(65535&(z^=255&l.charCodeAt(F)))*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*O+(((z>>>16)*O&65535)<<16)&4294967295}return v^=l.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),vh.exports),o=(rc||(rc=1,hd.exports=function(l,f){for(var p,y=l.length,v=f^y,E=0;y>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:v^=(255&l.charCodeAt(E+2))<<16;case 2:v^=(255&l.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&l.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),hd.exports);return yh.exports=u,yh.exports.murmur3=u,yh.exports.murmur2=o,yh.exports}(),ds=Qa(dd);class ic{constructor(o,...l){ut(this,l[0]||{}),this.type=o}}class Ei extends ic{constructor(o,l={}){super("error",ut({error:o},l))}}function km(u,o,l){l[u]&&l[u].indexOf(o)!==-1||(l[u]=l[u]||[],l[u].push(o))}function fs(u,o,l){if(l&&l[u]){const f=l[u].indexOf(o);f!==-1&&l[u].splice(f,1)}}class ol{on(o,l){return this._listeners=this._listeners||{},km(o,l,this._listeners),this}off(o,l){return fs(o,l,this._listeners),fs(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},km(o,l,this._oneTimeListeners),this):new Promise(f=>{this.once(o,f)})}fire(o,l){const f=typeof o=="string"?new ic(o,l):o,p=f.type;if(this.listens(p)){f.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const C of y)C.call(this,f);const v=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const C of v)fs(p,C,this._oneTimeListeners),C.call(this,f);const E=this._eventedParent;E&&(ut(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(f))}else f instanceof Ei&&console.error(f.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}class ts{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new ts(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){const[l,f]=o.split("");return new ts({name:l,iconsetId:f})}static isEqual(o,l){return o.name===l.name&&o.iconsetId===l.iconsetId}toString(){return ts.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Rm,xh={},fd=function(){if(Rm)return xh;Rm=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(y){return(y=Math.round(y))<0?0:y>255?255:y}function l(y){return o(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function f(y){return(v=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:v>1?1:v;var v}function p(y,v,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?y+(v-y)*E*6:2*E<1?v:3*E<2?y+(v-y)*(2/3-E)*6:y}try{xh.parseCSSColor=function(y){var v,E=y.replace(/ /g,"").toLowerCase();if(E in u)return u[E].slice();if(E[0]==="#")return E.length===4?(v=parseInt(E.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:E.length===7&&(v=parseInt(E.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var C=E.indexOf("("),O=E.indexOf(")");if(C!==-1&&O+1===E.length){var z=E.substr(0,C),F=E.substr(C+1,O-(C+1)).split(","),$=1;switch(z){case"rgba":if(F.length!==4)return null;$=f(F.pop());case"rgb":return F.length!==3?null:[l(F[0]),l(F[1]),l(F[2]),$];case"hsla":if(F.length!==4)return null;$=f(F.pop());case"hsl":if(F.length!==3)return null;var Y=(parseFloat(F[0])%360+360)%360/360,J=f(F[1]),re=f(F[2]),ce=re<=.5?re*(J+1):re+J-re*J,de=2*re-ce;return[o(255*p(de,ce,Y+1/3)),o(255*p(de,ce,Y)),o(255*p(de,ce,Y-1/3)),$];default:return null}}return null}}catch{}return xh}();class Dr{constructor(o,l,f,p=1){this.r=o,this.g=l,this.b=f,this.a=p}static parse(o){if(!o)return;if(o instanceof Dr)return o;if(typeof o!="string")return;const l=fd.parseCSSColor(o);return l?new Dr(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toStringPremultipliedAlpha(){const[o,l,f,p]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(f)},${p})`}toString(){const[o,l,f,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*l)},${Math.round(255*f)},${p})`}toRenderColor(o){const{r:l,g:f,b:p,a:y}=this;return new D_(o,l,f,p,y)}clone(){return new Dr(this.r,this.g,this.b,this.a)}}class D_{constructor(o,l,f,p,y){if(o){const v=o.image.height,E=v*v;l=y===0?0:l/y*(v-1),f=y===0?0:f/y*(v-1),p=y===0?0:p/y*(v-1);const C=Math.floor(l),O=Math.floor(f),z=Math.floor(p),F=Math.ceil(l),$=Math.ceil(f),Y=Math.ceil(p),J=l-C,re=f-O,ce=p-z,de=o.image.data,we=4*(C+O*E+z*v),ve=4*(C+O*E+Y*v),ie=4*(C+$*E+z*v),ge=4*(C+$*E+Y*v),be=4*(F+O*E+z*v),Ee=4*(F+O*E+Y*v),Ue=4*(F+$*E+z*v),qe=4*(F+$*E+Y*v);if(we<0||qe>=de.length)throw new Error("out of range");this.r=kn(kn(kn(de[we],de[ve],ce),kn(de[ie],de[ge],ce),re),kn(kn(de[be],de[Ee],ce),kn(de[Ue],de[qe],ce),re),J)/255*y,this.g=kn(kn(kn(de[we+1],de[ve+1],ce),kn(de[ie+1],de[ge+1],ce),re),kn(kn(de[be+1],de[Ee+1],ce),kn(de[Ue+1],de[qe+1],ce),re),J)/255*y,this.b=kn(kn(kn(de[we+2],de[ve+2],ce),kn(de[ie+2],de[ge+2],ce),re),kn(kn(de[be+2],de[Ee+2],ce),kn(de[Ue+2],de[qe+2],ce),re),J)/255*y,this.a=y}else this.r=l,this.g=f,this.b=p,this.a=y}toArray(){const{r:o,g:l,b:f,a:p}=this;return p===0?[0,0,0,0]:[255*o/p,255*l/p,255*f/p,p]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:l,b:f,a:p}=this,y=Math.min(Math.max(o/p,0),1),v=Math.min(Math.max(l/p,0),1),E=Math.min(Math.max(f/p,0),1),C=Math.min(y,v,E),O=Math.max(y,v,E),z=(C+O)/2;if(C===O)return[0,0,100*z,p];const F=O-C,$=z>.5?F/(2-O-C):F/(O+C);let Y=0;return O===y?Y=(v-E)/F+(v<E?6:0):O===v?Y=(E-y)/F+2:O===E&&(Y=(y-v)/F+4),Y*=60,[Math.min(Math.max(Y,0),360),Math.min(Math.max(100*$,0),100),Math.min(Math.max(100*z,0),100),p]}toArray01(){const{r:o,g:l,b:f,a:p}=this;return p===0?[0,0,0,0]:[o/p,l/p,f/p,p]}toArray01Scaled(o){const{r:l,g:f,b:p,a:y}=this;return y===0?[0,0,0]:[l/y*o,f/y*o,p/y*o]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:f,a:p}=this;return[o,l,f,p]}toArray01Linear(){const{r:o,g:l,b:f,a:p}=this;return p===0?[0,0,0,0]:[Math.pow(o/p,2.2),Math.pow(l/p,2.2),Math.pow(f/p,2.2),p]}}function kn(u,o,l){return u*(1-l)+o*l}function Cf(u,o,l){return u.map((f,p)=>kn(f,o[p],l))}function If(u){return u*u*u*u*u}Dr.black=new Dr(0,0,0,1),Dr.white=new Dr(1,1,1,1),Dr.transparent=new Dr(0,0,0,0),Dr.red=new Dr(1,0,0,1),Dr.blue=new Dr(0,0,1,1);var ks=Object.freeze({__proto__:null,array:Cf,color:function(u,o,l){return new Dr(kn(u.r,o.r,l),kn(u.g,o.g,l),kn(u.b,o.b,l),kn(u.a,o.a,l))},easeIn:If,number:kn});function pd(u,...o){for(const l of o)for(const f in l)u[f]=l[f];return u}class Rs extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}class ps{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[f,p]of l)this.bindings[f]=p}concat(o){return new ps(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const oc={kind:"null"},An={kind:"number"},Kr={kind:"string"},Gr={kind:"boolean"},Wa={kind:"color"},ac={kind:"object"},Br={kind:"value"},wu={kind:"collator"},Su={kind:"formatted"},md={kind:"resolvedImage"};function Ma(u,o){return{kind:"array",itemType:u,N:o}}function po(u){if(u.kind==="array"){const o=po(u.itemType);return typeof u.N=="number"?`array<${o}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${o}>`}return u.kind}const Mf=[oc,An,Kr,Gr,Wa,Su,ac,Ma(Br),md];function al(u,o){if(o.kind==="error")return null;if(u.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!al(u.itemType,o.itemType))&&(typeof u.N!="number"||u.N===o.N))return null}else{if(u.kind===o.kind)return null;if(u.kind==="value"){for(const l of Mf)if(!al(l,o))return null}}return`Expected ${po(u)} but found ${po(o)} instead.`}function Dm(u,o){return o.some(l=>l.kind===u.kind)}function Rl(u,o){return o.some(l=>l==="null"?u===null:l==="array"?Array.isArray(u):l==="object"?u&&!Array.isArray(u)&&typeof u=="object":l===typeof u)}class ra{constructor(o,l,f){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class gd{constructor(o,l,f,p,y){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=f,this.fontStack=p,this.textColor=y}}class Oa{constructor(o){this.sections=o}static fromString(o){return new Oa([new gd(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof Oa?o:Oa.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){const p=l.image.getPrimary().id.toString();o.push(["image",p]);continue}o.push(l.text);const f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),o.push(f)}return o}}class sl{constructor(o,l={}){if(this.id=ts.from(o),this.options=Object.assign({},l),l.transform){const{a:f,b:p,c:y,d:v,e:E,f:C}=l.transform;this.options.transform=new DOMMatrix([f,p,y,v,E,C])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:o,b:l,c:f,d:p,e:y,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:l,c:f,d:p,e:y,f:v}})}static parse(o){let l,f,p,y;try{({name:l,iconsetId:f,params:p,transform:y}=JSON.parse(o)||{})}catch{return null}if(!l)return null;const{a:v,b:E,c:C,d:O,e:z,f:F}=y||{};return new sl({name:l,iconsetId:f},{params:p,transform:new DOMMatrix([v,E,C,O,z,F])})}scaleSelf(o,l){return this.options.transform.scaleSelf(o,l),this}}class ka{constructor(o,l,f,p,y=!1){this.primaryId=ts.from(o),this.primaryOptions=l,f&&(this.secondaryId=ts.from(f)),this.secondaryOptions=p,this.available=y}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new sl(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new sl(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?ka.build({name:o}):o}static build(o,l,f,p){return!o||typeof o=="object"&&!("name"in o)?null:new ka(o,f,l,p)}}function Of(u,o,l,f){return typeof u=="number"&&u>=0&&u<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof l=="number"&&l>=0&&l<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,o,l,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,o,l,f]:[u,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function bh(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Dr||u instanceof ra||u instanceof Oa||u instanceof ka)return!0;if(Array.isArray(u)){for(const o of u)if(!bh(o))return!1;return!0}if(typeof u=="object"){for(const o in u)if(!bh(u[o]))return!1;return!0}return!1}function Oo(u){if(u===null)return oc;if(typeof u=="string")return Kr;if(typeof u=="boolean")return Gr;if(typeof u=="number")return An;if(u instanceof Dr)return Wa;if(u instanceof ra)return wu;if(u instanceof Oa)return Su;if(u instanceof ka)return md;if(Array.isArray(u)){const o=u.length;let l;for(const f of u){const p=Oo(f);if(l){if(l===p)continue;l=Br;break}l=p}return Ma(l||Br,o)}return ac}function Ra(u){const o=typeof u;return u===null?"":o==="string"||o==="number"||o==="boolean"?String(u):u instanceof Dr?u.toStringPremultipliedAlpha():u instanceof Oa||u instanceof ka?u.toString():JSON.stringify(u)}class ar{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(o.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!bh(o[1]))return l.error("invalid value");const f=o[1];let p=Oo(f);const y=l.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new ar(p,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Dr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Oa?this.value.serialize():this.value}}class nn{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Dl={string:Kr,number:An,boolean:Gr,object:ac};class Un{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let f,p=1;const y=o[0];if(y==="array"){let E,C;if(o.length>2){const O=o[1];if(typeof O!="string"||!(O in Dl)||O==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);E=Dl[O],p++}else E=Br;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);C=o[2],p++}f=Ma(E,C)}else f=Dl[y];const v=[];for(;p<o.length;p++){const E=l.parse(o[p],p,Br);if(!E)return null;v.push(E)}return new Un(f,v)}evaluate(o){for(let l=0;l<this.args.length;l++){const f=this.args[l].evaluate(o);if(!al(this.type,Oo(f)))return f;if(l===this.args.length-1)throw new nn(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${po(Oo(f))} but was expected to be of type ${po(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if(o.kind==="array"){const f=o.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){l.push(f.kind);const p=o.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(f=>f.serialize()))}}class ns{constructor(o){this.type=Su,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return l.error("First argument must be an image or text section.");const p=[];let y=!1;for(let v=1;v<=o.length-1;++v){const E=o[v];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let C=null;if(E["font-scale"]&&(C=l.parseObjectValue(E["font-scale"],v,"font-scale",An),!C))return null;let O=null;if(E["text-font"]&&(O=l.parseObjectValue(E["text-font"],v,"text-font",Ma(Kr)),!O))return null;let z=null;if(E["text-color"]&&(z=l.parseObjectValue(E["text-color"],v,"text-color",Wa),!z))return null;const F=p[p.length-1];F.scale=C,F.font=O,F.textColor=z}else{const C=l.parse(o[v],v,Br);if(!C)return null;const O=C.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:C,scale:null,font:null,textColor:null})}}return new ns(p)}evaluate(o){return new Oa(this.sections.map(l=>{const f=l.content.evaluate(o);return Oo(f)===md?new gd("",f,null,null,null):new gd(Ra(f),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),o.push(f)}return o}}class wh{constructor(o,l,f,p){this._imageWarnHistory={},this.type=md,this.namePrimary=o,this.nameSecondary=l,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(o,l){if(o.length<2)return l.error("Expected two or more arguments.");let f=1;const p=[];function y(){if(f<o.length){const E=l.parse(o[f],f++,Kr);return E?(p.push({image:E,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(f<o.length){const C=o[f];if((E=C)===null||typeof E!="object"||Array.isArray(E))return!0;const O=C.params,z=C.iconset,F=l.concat(f);if(!O&&!z)return f++,!0;if(O){if(typeof O!="object"||O.constructor!==Object)return F.error('Image options "params" should be an object'),!1;const $={},Y=F.concat(void 0,"params");for(const J in O){if(!J)return Y.error("Image parameter name should be non-empty"),!1;const re=Y.concat(void 0,J).parse(O[J],void 0,Wa,void 0,{typeAnnotation:"coerce"});if(!re)return!1;$[J]=re}p[p.length-1].options.params=$}if(z){if(typeof z!="object"||z.constructor!==Object)return F.error('Image options "iconset" should be an object'),!1;if(!z.id)return F.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=z}return f++,!0}var E;return!0}for(let E=0;E<2;E++)if(!y()||!v())return;return new wh(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(o,l){const f={};if(l){for(const p in l)if(l[p])try{f[p]=l[p].evaluate(o)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(o){const l={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,p=ka.build(l,f,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(p&&o.availableImages){const y=p.getPrimary().id;if(p.available=o.availableImages.some(v=>ts.isEqual(v,y)),p.available){const v=p.getSecondary()?p.getSecondary().id:null;v&&(p.available=o.availableImages.some(E=>ts.isEqual(E,v)))}}return p}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&o(this.paramsPrimary[l]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&o(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(o,l){const f={};if(l&&(f.iconset={id:l}),o){f.params={};for(const p in o)o[p]&&(f.params[p]=o[p].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&o.push(l)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&o.push(l)}return o}}function Fn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const L_={"to-boolean":Gr,"to-color":Wa,"to-number":An,"to-string":Kr};class rs{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const f=o[0],p=[];let y=oc;if(f==="to-array"){if(!Array.isArray(o[1]))return null;const v=o[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);y=Ma(l.expectedType.itemType,v)}else{if(!(v>0&&bh(o[1][0])))return null;y=Ma(Oo(o[1][0]),v)}for(let E=0;E<v;E++){const C=o[1][E];let O;if(Fn(C)==="array")O=l.parse(C,void 0,y.itemType);else{const z=Fn(C);if(z!==y.itemType.kind)return l.error(`Expected ${y.itemType.kind} but found ${z}.`);O=l.registry.literal.parse(["literal",C===void 0?null:C],l)}if(!O)return null;p.push(O)}}else{if((f==="to-boolean"||f==="to-string")&&o.length!==2)return l.error("Expected one argument.");y=L_[f];for(let v=1;v<o.length;v++){const E=l.parse(o[v],v,Br);if(!E)return null;p.push(E)}}return new rs(y,p)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let l,f;for(const p of this.args){if(l=p.evaluate(o),f=null,l instanceof Dr)return l;if(typeof l=="string"){const y=o.parseColor(l);if(y)return y}else if(Array.isArray(l)&&(f=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Of(l[0],l[1],l[2],l[3]),!f))return new Dr(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new nn(f||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const f of this.args){if(l=f.evaluate(o),l===null)return 0;const p=Number(l);if(!isNaN(p))return p}throw new nn(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?Oa.fromString(Ra(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?ka.build(Ra(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(l=>l.evaluate(o)):Ra(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ns([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new wh(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}const Lm=["Unknown","Point","LineString","Polygon"];class Tu{constructor(o,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:f,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*l-o[0])+this.featureDistanceData.bearing[1]*(p*l-o[1])}return 0}parseColor(o){let l=this._parseColorCache[o];return l||(l=this._parseColorCache[o]=Dr.parse(o)),l}getConfig(o){return this.options?this.options.get(o):null}}class Da{constructor(o,l,f,p,y){this.name=o,this.type=l,this._evaluate=f,this.args=p,this._overloadIndex=y}evaluate(o){if(!this._evaluate){const l=Da.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const f=o[0],p=Da.definitions[f];if(!p)return l.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=[];let C=null,O=-1;for(const[z,F]of v){if(Array.isArray(z)&&z.length!==o.length-1)continue;E.push(z),O++,C=new Ds(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const $=[];let Y=!1;for(let J=1;J<o.length;J++){const re=o[J],ce=Array.isArray(z)?z[J-1]:z.type,de=C.parse(re,1+$.length,ce);if(!de){Y=!0;break}$.push(de)}if(!Y)if(Array.isArray(z)&&z.length!==$.length)C.error(`Expected ${z.length} arguments, but found ${$.length} instead.`);else{for(let J=0;J<$.length;J++){const re=Array.isArray(z)?z[J]:z.type,ce=$[J];C.concat(J+1).checkSubtype(re,ce.type)}if(C.errors.length===0)return new Da(f,y,F,$,O)}}if(E.length===1)l.errors.push(...C.errors);else{const z=(E.length?E:v.map(([$])=>$)).map(Eo).join(" | "),F=[];for(let $=1;$<o.length;$++){const Y=l.parse(o[$],1+F.length);if(!Y)return null;F.push(po(Y.type))}l.error(`Expected arguments of type ${z}, but found (${F.join(", ")}) instead.`)}return null}static register(o,l){Da.definitions=l;for(const f in l)o[f]=Da}}function Eo(u){return Array.isArray(u)?`(${u.map(po).join(", ")})`:`(${po(u.type)}...)`}class sc{constructor(o,l,f){this.type=wu,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(o.length!==2)return l.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return l.error("Collator options argument must be an object.");const p=f["case-sensitive"]===void 0?l.parse(!1,1,Gr):l.parseObjectValue(f["case-sensitive"],1,"case-sensitive",Gr);if(!p)return null;const y=f["diacritic-sensitive"]===void 0?l.parse(!1,1,Gr):l.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",Gr);if(!y)return null;let v=null;return f.locale&&(v=l.parseObjectValue(f.locale,1,"locale",Kr),!v)?null:new sc(p,y,v)}evaluate(o){return new ra(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function $c(u,o,l=0,f=u.length-1,p=Eu){for(;f>l;){if(f-l>600){const C=f-l+1,O=o-l+1,z=Math.log(C),F=.5*Math.exp(2*z/3),$=.5*Math.sqrt(z*F*(C-F)/C)*(O-C/2<0?-1:1);$c(u,o,Math.max(l,Math.floor(o-O*F/C+$)),Math.min(f,Math.floor(o+(C-O)*F/C+$)),p)}const y=u[o];let v=l,E=f;for(lc(u,l,o),p(u[f],y)>0&&lc(u,l,f);v<E;){for(lc(u,v,E),v++,E--;p(u[v],y)<0;)v++;for(;p(u[E],y)>0;)E--}p(u[l],y)===0?lc(u,l,E):(E++,lc(u,E,f)),E<=o&&(l=E+1),o<=E&&(f=E-1)}}function lc(u,o,l){const f=u[o];u[o]=u[l],u[l]=f}function Eu(u,o){return u<o?-1:u>o?1:0}function bo(u){let o=0;for(let l,f,p=0,y=u.length,v=y-1;p<y;v=p++)l=u[p],f=u[v],o+=(f.x-l.x)*(l.y+f.y);return o}function _d(u,o){u[0]=Math.min(u[0],o[0]),u[1]=Math.min(u[1],o[1]),u[2]=Math.max(u[2],o[0]),u[3]=Math.max(u[3],o[1])}function Ll(u,o){return!(u[0]<=o[0]||u[2]>=o[2]||u[1]<=o[1]||u[3]>=o[3])}function dx(u,o,l){const f=u[0]-o[0],p=u[1]-o[1],y=u[0]-l[0],v=u[1]-l[1];return f*v-y*p==0&&f*y<=0&&p*v<=0}function La(u,o,l=!1){let f=!1;for(let E=0,C=o.length;E<C;E++){const O=o[E];for(let z=0,F=O.length,$=F-1;z<F;$=z++){const Y=O[$],J=O[z];if(dx(u,Y,J))return l;(y=Y)[1]>(p=u)[1]!=(v=J)[1]>p[1]&&p[0]<(v[0]-y[0])*(p[1]-y[1])/(v[1]-y[1])+y[0]&&(f=!f)}}var p,y,v;return f}function Sh(u,o,l,f){const p=f[0]-l[0],y=f[1]-l[1],v=(u[0]-l[0])*y-p*(u[1]-l[1]),E=(o[0]-l[0])*y-p*(o[1]-l[1]);return v>0&&E<0||v<0&&E>0}function ll(u,o,l,f){return(p=[f[0]-l[0],f[1]-l[1]])[0]*(y=[o[0]-u[0],o[1]-u[1]])[1]-p[1]*y[0]!=0&&!(!Sh(u,o,l,f)||!Sh(l,f,u,o));var p,y}function yd(u){const o=new Tt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new Tt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const f of u[0])o.x>f.x&&(o.x=f.x),o.y>f.y&&(o.y=f.y),l.x<f.x&&(l.x=f.x),l.y<f.y&&(l.y=f.y);return{min:o,max:l}}const cl=8192;function zm(u,o){const l=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,p=Math.pow(2,o.z);return[Math.round(l*p*cl),Math.round(f*p*cl)]}function kf(u,o){for(let l=0;l<o.length;l++)if(La(u,o[l]))return!0;return!1}function Au(u,o,l){for(const f of l)for(let p=0,y=f.length,v=y-1;p<y;v=p++)if(ll(u,o,f[v],f[p]))return!0;return!1}function vd(u,o){for(let l=0;l<u.length;++l)if(!La(u[l],o))return!1;for(let l=0;l<u.length-1;++l)if(Au(u[l],u[l+1],o))return!1;return!0}function Nm(u,o){for(let l=0;l<o.length;l++)if(vd(u,o[l]))return!0;return!1}function xd(u,o,l){const f=[];for(let p=0;p<u.length;p++){const y=[];for(let v=0;v<u[p].length;v++){const E=zm(u[p][v],l);_d(o,E),y.push(E)}f.push(y)}return f}function z_(u,o,l){const f=[];for(let p=0;p<u.length;p++){const y=xd(u[p],o,l);f.push(y)}return f}function ul(u,o,l,f){if(u[0]<l[0]||u[0]>l[2]){const p=.5*f;let y=u[0]-l[0]>p?-f:l[0]-u[0]>p?f:0;y===0&&(y=u[0]-l[2]>p?-f:l[2]-u[0]>p?f:0),u[0]+=y}_d(o,u)}function N_(u,o,l,f){const p=Math.pow(2,f.z)*cl,y=[f.x*cl,f.y*cl],v=[];if(!u)return v;for(const E of u)for(const C of E){const O=[C.x+y[0],C.y+y[1]];ul(O,o,l,p),v.push(O)}return v}function Fm(u,o,l,f){const p=Math.pow(2,f.z)*cl,y=[f.x*cl,f.y*cl],v=[];if(!u)return v;for(const C of u){const O=[];for(const z of C){const F=[z.x+y[0],z.y+y[1]];_d(o,F),O.push(F)}v.push(O)}if(o[2]-o[0]<=p/2){(E=o)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const C of v)for(const O of C)ul(O,o,l,p)}var E;return v}class cc{constructor(o,l){this.type=Gr,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(bh(o[1])){const f=o[1];if(f.type==="FeatureCollection")for(let p=0;p<f.features.length;++p){const y=f.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new cc(f,f.features[p].geometry)}else if(f.type==="Feature"){const p=f.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new cc(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new cc(f,f)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(l,f){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=l.canonicalID();if(!v)return!1;if(f.type==="Polygon"){const E=xd(f.coordinates,y,v),C=N_(l.geometry(),p,y,v);if(!Ll(p,y))return!1;for(const O of C)if(!La(O,E))return!1}if(f.type==="MultiPolygon"){const E=z_(f.coordinates,y,v),C=N_(l.geometry(),p,y,v);if(!Ll(p,y))return!1;for(const O of C)if(!kf(O,E))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(l,f){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=l.canonicalID();if(!v)return!1;if(f.type==="Polygon"){const E=xd(f.coordinates,y,v),C=Fm(l.geometry(),p,y,v);if(!Ll(p,y))return!1;for(const O of C)if(!vd(O,E))return!1}if(f.type==="MultiPolygon"){const E=z_(f.coordinates,y,v),C=Fm(l.geometry(),p,y,v);if(!Ll(p,y))return!1;for(const O of C)if(!Nm(O,E))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Th={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Bm=1/298.257223563,Uo=Bm*(2-Bm),uc=Math.PI/180;class Eh{static fromTile(o,l,f){const p=Math.PI*(1-2*(o+.5)/Math.pow(2,l)),y=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/uc;return new Eh(y,f)}static get units(){return Th}constructor(o,l){if(o===void 0)throw new Error("No latitude given.");if(l&&!Th[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(Th).join(", ")}`);const f=6378.137*uc*(l?Th[l]:1),p=Math.cos(o*uc),y=1/(1-Uo*(1-p*p)),v=Math.sqrt(y);this.kx=f*v*p,this.ky=f*v*y*(1-Uo)}distance(o,l){const f=ms(o[0]-l[0])*this.kx,p=(o[1]-l[1])*this.ky;return Math.sqrt(f*f+p*p)}bearing(o,l){const f=ms(l[0]-o[0])*this.kx;return Math.atan2(f,(l[1]-o[1])*this.ky)/uc}destination(o,l,f){const p=f*uc;return this.offset(o,Math.sin(p)*l,Math.cos(p)*l)}offset(o,l,f){return[o[0]+l/this.kx,o[1]+f/this.ky]}lineDistance(o){let l=0;for(let f=0;f<o.length-1;f++)l+=this.distance(o[f],o[f+1]);return l}area(o){let l=0;for(let f=0;f<o.length;f++){const p=o[f];for(let y=0,v=p.length,E=v-1;y<v;E=y++)l+=ms(p[y][0]-p[E][0])*(p[y][1]+p[E][1])*(f?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(o,l){let f=0;if(l<=0)return o[0];for(let p=0;p<o.length-1;p++){const y=o[p],v=o[p+1],E=this.distance(y,v);if(f+=E,f>l)return Rf(y,v,(l-(f-E))/E)}return o[o.length-1]}pointToSegmentDistance(o,l,f){let[p,y]=l,v=ms(f[0]-p)*this.kx,E=(f[1]-y)*this.ky;if(v!==0||E!==0){const C=(ms(o[0]-p)*this.kx*v+(o[1]-y)*this.ky*E)/(v*v+E*E);C>1?(p=f[0],y=f[1]):C>0&&(p+=v/this.kx*C,y+=E/this.ky*C)}return v=ms(o[0]-p)*this.kx,E=(o[1]-y)*this.ky,Math.sqrt(v*v+E*E)}pointOnLine(o,l){let f=1/0,p=o[0][0],y=o[0][1],v=0,E=0;for(let C=0;C<o.length-1;C++){let O=o[C][0],z=o[C][1],F=ms(o[C+1][0]-O)*this.kx,$=(o[C+1][1]-z)*this.ky,Y=0;F===0&&$===0||(Y=(ms(l[0]-O)*this.kx*F+(l[1]-z)*this.ky*$)/(F*F+$*$),Y>1?(O=o[C+1][0],z=o[C+1][1]):Y>0&&(O+=F/this.kx*Y,z+=$/this.ky*Y)),F=ms(l[0]-O)*this.kx,$=(l[1]-z)*this.ky;const J=F*F+$*$;J<f&&(f=J,p=O,y=z,v=C,E=Y)}return{point:[p,y],index:v,t:Math.max(0,Math.min(1,E))}}lineSlice(o,l,f){let p=this.pointOnLine(f,o),y=this.pointOnLine(f,l);if(p.index>y.index||p.index===y.index&&p.t>y.t){const O=p;p=y,y=O}const v=[p.point],E=p.index+1,C=y.index;!Ah(f[E],v[0])&&E<=C&&v.push(f[E]);for(let O=E+1;O<=C;O++)v.push(f[O]);return Ah(f[C],y.point)||v.push(y.point),v}lineSliceAlong(o,l,f){let p=0;const y=[];for(let v=0;v<f.length-1;v++){const E=f[v],C=f[v+1],O=this.distance(E,C);if(p+=O,p>o&&y.length===0&&y.push(Rf(E,C,(o-(p-O))/O)),p>=l)return y.push(Rf(E,C,(l-(p-O))/O)),y;p>o&&y.push(C)}return y}bufferPoint(o,l){const f=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-f,o[0]+p,o[1]+f]}bufferBBox(o,l){const f=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-f,o[2]+p,o[3]+f]}insideBBox(o,l){return ms(o[0]-l[0])>=0&&ms(o[0]-l[2])<=0&&o[1]>=l[1]&&o[1]<=l[3]}}function Ah(u,o){return u[0]===o[0]&&u[1]===o[1]}function Rf(u,o,l){const f=ms(o[0]-u[0]);return[u[0]+f*l,u[1]+(o[1]-u[1])*l]}function ms(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class Df{constructor(o=[],l=(f,p)=>f<p?-1:f>p?1:0){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:f}=this,p=l[o];for(;o>0;){const y=o-1>>1,v=l[y];if(f(p,v)>=0)break;l[o]=v,o=y}l[o]=p}_down(o){const{data:l,compare:f}=this,p=this.length>>1,y=l[o];for(;o<p;){let v=1+(o<<1);const E=v+1;if(E<this.length&&f(l[E],l[v])<0&&(v=E),f(l[v],y)>=0)break;l[o]=l[v],o=v}l[o]=y}}var Kt=8192;function jm(u,o){return o.dist-u.dist}const hc=100,bd=50;function Lf(u){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==u.length)return!1;for(let l=0;l<o.length;l++)if(o[l]!==u[l])return!1;return!0}function Pu(u){return u[1]-u[0]+1}function Ko(u,o){const l=u[1]>=u[0]&&u[1]<o;return l||console.warn("Distance Expression: Index is out of range"),l}function Cu(u,o){if(u[0]>u[1])return[null,null];const l=Pu(u);if(o){if(l===2)return[u,null];const f=Math.floor(l/2);return[[u[0],u[0]+f],[u[0]+f,u[1]]]}{if(l===1)return[u,null];const f=Math.floor(l/2)-1;return[[u[0],u[0]+f],[u[0]+f+1,u[1]]]}}function dc(u,o){const l=[1/0,1/0,-1/0,-1/0];if(!Ko(o,u.length))return l;for(let f=o[0];f<=o[1];++f)_d(l,u[f]);return l}function fc(u){const o=[1/0,1/0,-1/0,-1/0];for(let l=0;l<u.length;++l)for(let f=0;f<u[l].length;++f)_d(o,u[l][f]);return o}function Iu(u,o,l){if(Lf(u)||Lf(o))return NaN;let f=0,p=0;return u[2]<o[0]&&(f=o[0]-u[2]),u[0]>o[2]&&(f=u[0]-o[2]),u[1]>o[3]&&(p=u[1]-o[3]),u[3]<o[1]&&(p=o[1]-u[3]),l.distance([0,0],[f,p])}function pc(u){return 360*u-180}function xr(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function zf(u,o){const l=Math.pow(2,o.z),f=(u.y/Kt+o.y)/l;return[pc((u.x/Kt+o.x)/l),xr(f)]}function F_(u,o){const l=[];for(let f=0;f<u.length;++f)l.push(zf(u[f],o));return l}function B_(u,o,l){const f=l.pointOnLine(o,u).point;return l.distance(u,f)}function Nf(u,o,l,f,p){const y=l.slice(f[0],f[1]+1);let v=1/0;for(let E=o[0];E<=o[1];++E)if((v=Math.min(v,B_(u[E],y,p)))===0)return 0;return v}function Ff(u,o,l,f,p){const y=Math.min(p.pointToSegmentDistance(u,l,f),p.pointToSegmentDistance(o,l,f)),v=Math.min(p.pointToSegmentDistance(l,u,o),p.pointToSegmentDistance(f,u,o));return Math.min(y,v)}function Fi(u,o,l,f,p){if(!Ko(o,u.length)||!Ko(f,l.length))return NaN;let y=1/0;for(let v=o[0];v<o[1];++v)for(let E=f[0];E<f[1];++E){if(ll(u[v],u[v+1],l[E],l[E+1]))return 0;y=Math.min(y,Ff(u[v],u[v+1],l[E],l[E+1],p))}return y}function j_(u,o,l,f,p){if(!Ko(o,u.length)||!Ko(f,l.length))return NaN;let y=1/0;for(let v=o[0];v<=o[1];++v)for(let E=f[0];E<=f[1];++E)if((y=Math.min(y,p.distance(u[v],l[E])))===0)return y;return y}function $_(u,o,l){if(La(u,o,!0))return 0;let f=1/0;for(const p of o){const y=p.length;if(y<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[y-1]&&(f=Math.min(f,l.pointToSegmentDistance(u,p[y-1],p[0])))===0||(f=Math.min(f,B_(u,p,l)))===0)return f}return f}function fx(u,o,l,f){if(!Ko(o,u.length))return NaN;for(let y=o[0];y<=o[1];++y)if(La(u[y],l,!0))return 0;let p=1/0;for(let y=o[0];y<o[1];++y)for(const v of l)for(let E=0,C=v.length,O=C-1;E<C;O=E++){if(ll(u[y],u[y+1],v[O],v[E]))return 0;p=Math.min(p,Ff(u[y],u[y+1],v[O],v[E],f))}return p}function $m(u,o){for(const l of u)for(let f=0;f<=l.length-1;++f)if(La(l[f],o,!0))return!0;return!1}function U_(u,o,l,f=1/0){const p=fc(u),y=fc(o);if(f!==1/0&&Iu(p,y,l)>=f)return f;if(Ll(p,y)){if($m(u,o))return 0}else if($m(o,u))return 0;let v=f;for(const E of u)for(let C=0,O=E.length,z=O-1;C<O;z=C++)for(const F of o)for(let $=0,Y=F.length,J=Y-1;$<Y;J=$++){if(ll(E[z],E[C],F[J],F[$]))return 0;v=Math.min(v,Ff(E[z],E[C],F[J],F[$],l))}return v}function Bf(u,o,l,f,p,y,v){if(y===null||v===null)return;const E=Iu(dc(f,y),dc(p,v),l);E<o&&u.push({dist:E,range1:y,range2:v})}function x(u,o,l,f,p=1/0){let y=Math.min(f.distance(u[0],l[0][0]),p);if(y===0)return y;const v=new Df([{dist:0,range1:[0,u.length-1],range2:[0,0]}],jm),E=o?bd:hc,C=fc(l);for(;v.length;){const O=v.pop();if(O.dist>=y)continue;const z=O.range1;if(Pu(z)<=E){if(!Ko(z,u.length))return NaN;if(o){const F=fx(u,z,l,f);if((y=Math.min(y,F))===0)return y}else for(let F=z[0];F<=z[1];++F){const $=$_(u[F],l,f);if((y=Math.min(y,$))===0)return y}}else{const F=Cu(z,o);if(F[0]!==null){const $=Iu(dc(u,F[0]),C,f);$<y&&v.push({dist:$,range1:F[0],range2:[0,0]})}if(F[1]!==null){const $=Iu(dc(u,F[1]),C,f);$<y&&v.push({dist:$,range1:F[1],range2:[0,0]})}}}return y}function I(u,o,l,f,p,y=1/0){let v=Math.min(y,p.distance(u[0],l[0]));if(v===0)return v;const E=new Df([{dist:0,range1:[0,u.length-1],range2:[0,l.length-1]}],jm),C=o?bd:hc,O=f?bd:hc;for(;E.length;){const z=E.pop();if(z.dist>=v)continue;const F=z.range1,$=z.range2;if(Pu(F)<=C&&Pu($)<=O){if(!Ko(F,u.length)||!Ko($,l.length))return NaN;if(o&&f?v=Math.min(v,Fi(u,F,l,$,p)):o||f?o&&!f?v=Math.min(v,Nf(l,$,u,F,p)):!o&&f&&(v=Math.min(v,Nf(u,F,l,$,p))):v=Math.min(v,j_(u,F,l,$,p)),v===0)return v}else{const Y=Cu(F,o),J=Cu($,f);Bf(E,v,p,u,l,Y[0],J[0]),Bf(E,v,p,u,l,Y[0],J[1]),Bf(E,v,p,u,l,Y[1],J[0]),Bf(E,v,p,u,l,Y[1],J[1])}}return v}function U(u,o,l,f,p=1/0){let y=p;const v=dc(u,[0,u.length-1]);for(const E of l)if(!(y!==1/0&&Iu(v,dc(E,[0,E.length-1]),f)>=y)&&(y=Math.min(y,I(u,o,E,!0,f,y)),y===0))return y;return y}function ne(u,o,l,f,p=1/0){let y=p;const v=dc(u,[0,u.length-1]);for(const E of l){if(y!==1/0&&Iu(v,fc(E),f)>=y)continue;const C=x(u,o,E,f,y);if(isNaN(C))return C;if((y=Math.min(y,C))===0)return y}return y}function pe(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class Oe{constructor(o,l){this.type=An,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(bh(o[1])){const f=o[1];if(f.type==="FeatureCollection"){for(let p=0;p<f.features.length;++p)if(pe(f.features[p].geometry.type))return new Oe(f,f.features[p].geometry)}else if(f.type==="Feature"){if(pe(f.geometry.type))return new Oe(f,f.geometry)}else if(pe(f.type))return new Oe(f,f)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const l=o.geometry(),f=o.canonicalID();if(l!=null&&f!=null){if(o.geometryType()==="Point")return function(p,y,v){const E=[];for(const O of p)for(const z of O)E.push(zf(z,y));const C=new Eh(E[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?I(E,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C):v.type==="MultiLineString"?U(E,!1,v.coordinates,C):v.type==="Polygon"||v.type==="MultiPolygon"?ne(E,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,C):null}(l,f,this.geometries);if(o.geometryType()==="LineString")return function(p,y,v){const E=[];for(const O of p){const z=[];for(const F of O)z.push(zf(F,y));E.push(z)}const C=new Eh(E[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return U(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",E,C);if(v.type==="MultiLineString"){let O=1/0;for(let z=0;z<v.coordinates.length;z++){const F=U(v.coordinates[z],!0,E,C,O);if(isNaN(F))return F;if((O=Math.min(O,F))===0)return O}return O}if(v.type==="Polygon"||v.type==="MultiPolygon"){let O=1/0;for(let z=0;z<E.length;z++){const F=ne(E[z],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,C,O);if(isNaN(F))return F;if((O=Math.min(O,F))===0)return O}return O}return null}(l,f,this.geometries);if(o.geometryType()==="Polygon")return function(p,y,v){const E=[];for(const O of function(z,F){const $=z.length;if($<=1)return[z];const Y=[];let J,re;for(let ce=0;ce<$;ce++){const de=bo(z[ce]);de!==0&&(z[ce].area=Math.abs(de),re===void 0&&(re=de<0),re===de<0?(J&&Y.push(J),J=[z[ce]]):J.push(z[ce]))}return J&&Y.push(J),Y}(p)){const z=[];for(let F=0;F<O.length;++F)z.push(F_(O[F],y));E.push(z)}const C=new Eh(E[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return ne(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",E,C);if(v.type==="MultiLineString"){let O=1/0;for(let z=0;z<v.coordinates.length;z++){const F=ne(v.coordinates[z],!0,E,C,O);if(isNaN(F))return F;if((O=Math.min(O,F))===0)return O}return O}return v.type==="Polygon"||v.type==="MultiPolygon"?function(O,z,F){let $=1/0;for(const Y of O)for(const J of z){const re=U_(Y,J,F,$);if(isNaN(re))return re;if(($=Math.min($,re))===0)return $}return $}(v.type==="Polygon"?[v.coordinates]:v.coordinates,E,C):null}(l,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function lt(u,o){switch(u){case"string":return Ra(o);case"number":return+o;case"boolean":return!!o;case"color":return Dr.parse(o);case"formatted":return Oa.fromString(Ra(o));case"resolvedImage":return ka.build(Ra(o))}return o}function Rt(u,o,l,f){return f!==void 0&&(u=f*Math.round(u/f)),o!==void 0&&u<o&&(u=o),l!==void 0&&u>l&&(u=l),u}class Ht{constructor(o,l,f){this.type=o,this.key=l,this.scope=f}static parse(o,l){let f=l.expectedType;if(f==null&&(f=Br),o.length<2||o.length>3)return l.error("Invalid number of arguments for 'config' expression.");const p=l.parse(o[1],1);if(!(p instanceof ar))return l.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const y=l.parse(o[2],2);return y instanceof ar?new Ht(f,Ra(p.value),Ra(y.value)):l.error("Scope of 'config' expression must be a string literal.")}return new Ht(f,Ra(p.value))}evaluate(o){const l=[this.key,this.scope,o.scope].filter(Boolean).join(""),f=o.getConfig(l);if(!f)return null;const{type:p,value:y,values:v,minValue:E,maxValue:C,stepValue:O}=f,z=f.default.evaluate(o);let F=z;if(y){const $=o.scope;o.scope=($||"").split("").slice(1).join(""),F=y.evaluate(o),o.scope=$}return p&&(F=lt(p,F)),F===void 0||E===void 0&&C===void 0&&O===void 0||(typeof F=="number"?F=Rt(F,E,C,O):Array.isArray(F)&&(F=F.map($=>typeof $=="number"?Rt($,E,C,O):$))),y!==void 0&&F!==void 0&&v&&!v.includes(F)&&(F=z,p&&(F=lt(p,F))),(p&&p!==this.type||F!==void 0&&Oo(F)!==this.type)&&(F=lt(this.type.kind,F)),F}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function bn(u){if(u instanceof Da&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof cc||u instanceof Oe)return!1;let o=!0;return u.eachChild(l=>{o&&!bn(l)&&(o=!1)}),o}function Yn(u){if(u instanceof Da&&u.name==="feature-state")return!1;let o=!0;return u.eachChild(l=>{o&&!Yn(l)&&(o=!1)}),o}function Ir(u){if(u instanceof Ht)return new Set([u.key]);let o=new Set;return u.eachChild(l=>{o=new Set([...o,...Ir(l)])}),o}function Yr(u,o){if(u instanceof Da&&o.indexOf(u.name)>=0)return!1;let l=!0;return u.eachChild(f=>{l&&!Yr(f,o)&&(l=!1)}),l}class va{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(o.length!==2||typeof o[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const f=o[1];return l.scope.has(f)?new va(f,l.scope.get(f)):l.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Yo{constructor(o,l=[],f,p=new ps,y=[],v,E){this.registry=o,this.path=l,this.key=l.map(C=>typeof C=="string"?`['${C}']`:`[${C}]`).join(""),this.scope=p,this.errors=y,this.expectedType=f,this._scope=v,this.options=E}parse(o,l,f,p,y={}){return l||f?this.concat(l,null,f,p)._parse(o,y):this._parse(o,y)}parseObjectValue(o,l,f,p,y,v={}){return this.concat(l,f,p,y)._parse(o,v)}_parse(o,l){function f(p,y,v){return v==="assert"?new Un(y,[p]):v==="coerce"?new rs(y,[p]):p}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(p){let y=p.parse(o,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,E=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||E.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(v,E))return null}else y=f(y,v,l.typeAnnotation||"coerce");else y=f(y,v,l.typeAnnotation||"assert")}if(!(y instanceof ar)&&y.type.kind!=="resolvedImage"&&Ga(y)){const v=new Tu(this._scope,this.options);try{y=new ar(y.type,y.evaluate(v))}catch(E){return this.error(E.message),null}}return y}return rs.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,f,p){let y=typeof o=="number"?this.path.concat(o):this.path;y=typeof l=="string"?y.concat(l):y;const v=p?this.scope.concat(p):this.scope;return new Yo(this.registry,y,f||null,v,this.errors,this._scope,this.options)}error(o,...l){const f=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new Rs(f,o))}checkSubtype(o,l){const f=al(o,l);return f&&this.error(f),f}}var Ds=Yo;function Ga(u){if(u instanceof va)return Ga(u.boundExpression);if(u instanceof Da&&u.name==="error"||u instanceof sc||u instanceof cc||u instanceof Oe||u instanceof Ht)return!1;const o=u instanceof rs||u instanceof Un;let l=!0;return u.eachChild(f=>{l=o?l&&Ga(f):l&&f instanceof ar}),!!l&&bn(u)&&Yr(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function mc(u,o){const l=u.length-1;let f,p,y=0,v=l,E=0;for(;y<=v;)if(E=Math.floor((y+v)/2),f=u[E],p=u[E+1],f<=o){if(E===l||o<p)return E;y=E+1}else{if(!(f>o))throw new nn("Input is not a number.");v=E-1}return 0}class wd{constructor(o,l,f){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[p,y]of f)this.labels.push(p),this.outputs.push(y)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const f=l.parse(o[1],1,An);if(!f)return null;const p=[];let y=null;l.expectedType&&l.expectedType.kind!=="value"&&(y=l.expectedType);for(let v=1;v<o.length;v+=2){const E=v===1?-1/0:o[v],C=o[v+1],O=v,z=v+1;if(typeof E!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(p.length&&p[p.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const F=l.parse(C,z,y);if(!F)return null;y=y||F.type,p.push([E,F])}return new wd(y,f,p)}evaluate(o){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return f[0].evaluate(o);const y=l.length;return p>=l[y-1]?f[y-1].evaluate(o):f[mc(l,p)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}const V_=.95047,W_=1.08883,Um=4/29,Ph=6/29,Vm=3*Ph*Ph,Jo=Ph*Ph*Ph,Ch=Math.PI/180,px=180/Math.PI;function jf(u){return u>Jo?Math.pow(u,1/3):u/Vm+Um}function Wm(u){return u>Ph?u*u*u:Vm*(u-Um)}function Sd(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function $f(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Gm(u){const o=$f(u.r),l=$f(u.g),f=$f(u.b),p=jf((.4124564*o+.3575761*l+.1804375*f)/V_),y=jf((.2126729*o+.7151522*l+.072175*f)/1);return{l:116*y-16,a:500*(p-y),b:200*(y-jf((.0193339*o+.119192*l+.9503041*f)/W_)),alpha:u.a}}function mx(u){let o=(u.l+16)/116,l=isNaN(u.a)?o:o+u.a/500,f=isNaN(u.b)?o:o-u.b/200;return o=1*Wm(o),l=V_*Wm(l),f=W_*Wm(f),new Dr(Sd(3.2404542*l-1.5371385*o-.4985314*f),Sd(-.969266*l+1.8760108*o+.041556*f),Sd(.0556434*l-.2040259*o+1.0572252*f),u.alpha)}function Uf(u,o,l){const f=o-u;return u+l*(f>180||f<-180?f-360*Math.round(f/360):f)}const Vf={forward:Gm,reverse:mx,interpolate:function(u,o,l){return{l:kn(u.l,o.l,l),a:kn(u.a,o.a,l),b:kn(u.b,o.b,l),alpha:kn(u.alpha,o.alpha,l)}}},Wf={forward:function(u){const{l:o,a:l,b:f}=Gm(u),p=Math.atan2(f,l)*px;return{h:p<0?p+360:p,c:Math.sqrt(l*l+f*f),l:o,alpha:u.a}},reverse:function(u){const o=u.h*Ch,l=u.c;return mx({l:u.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:u.alpha})},interpolate:function(u,o,l){return{h:Uf(u.h,o.h,l),c:kn(u.c,o.c,l),l:kn(u.l,o.l,l),alpha:kn(u.alpha,o.alpha,l)}}};var qS=Object.freeze({__proto__:null,hcl:Wf,lab:Vf});class Ls{constructor(o,l,f,p,y){this.type=o,this.operator=l,this.interpolation=f,this.input=p,this.labels=[],this.outputs=[];for(const[v,E]of y)this.labels.push(v),this.outputs.push(E)}static interpolationFactor(o,l,f,p){let y=0;if(o.name==="exponential")y=Hm(l,o.base,f,p);else if(o.name==="linear")y=Hm(l,1,f,p);else if(o.name==="cubic-bezier"){const v=o.controlPoints;y=new es(v[0],v[1],v[2],v[3]).solve(Hm(l,1,f,p))}return y}static parse(o,l){let[f,p,y,...v]=o;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const O=p[1];if(typeof O!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:O}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const O=p.slice(1);if(O.length!==4||O.some(z=>typeof z!="number"||z<0||z>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:O}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(y=l.parse(y,2,An),!y)return null;const E=[];let C=null;f==="interpolate-hcl"||f==="interpolate-lab"?C=Wa:l.expectedType&&l.expectedType.kind!=="value"&&(C=l.expectedType);for(let O=0;O<v.length;O+=2){const z=v[O],F=v[O+1],$=O+3,Y=O+4;if(typeof z!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(E.length&&E[E.length-1][0]>=z)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const J=l.parse(F,Y,C);if(!J)return null;C=C||J.type,E.push([z,J])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new Ls(C,f,p,y,E):l.error(`Type ${po(C)} is not interpolatable.`)}evaluate(o){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return f[0].evaluate(o);const y=l.length;if(p>=l[y-1])return f[y-1].evaluate(o);const v=mc(l,p),E=Ls.interpolationFactor(this.interpolation,p,l[v],l[v+1]),C=f[v].evaluate(o),O=f[v+1].evaluate(o);return this.operator==="interpolate"?ks[this.type.kind.toLowerCase()](C,O,E):this.operator==="interpolate-hcl"?Wf.reverse(Wf.interpolate(Wf.forward(C),Wf.forward(O),E)):Vf.reverse(Vf.interpolate(Vf.forward(C),Vf.forward(O),E))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)l.push(this.labels[f],this.outputs[f].serialize());return l}}function Hm(u,o,l,f){const p=f-l,y=u-l;return p===0?0:o===1?y/p:(Math.pow(o,y)-1)/(Math.pow(o,p)-1)}class G_{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let f=null;const p=l.expectedType;p&&p.kind!=="value"&&(f=p);const y=[];for(const E of o.slice(1)){const C=l.parse(E,1+y.length,f,void 0,{typeAnnotation:"omit"});if(!C)return null;f=f||C.type,y.push(C)}const v=p&&y.some(E=>al(p,E.type));return new G_(v?Br:f,y)}evaluate(o){let l,f=null,p=0;for(const y of this.args){if(p++,f=y.evaluate(o),f&&f instanceof ka&&!f.available&&(l||(l=f),f=null,p===this.args.length))return l;if(f!==null)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class H_{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let y=1;y<o.length-1;y+=2){const v=o[y];if(typeof v!="string")return l.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return l.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=l.parse(o[y+1],y+1);if(!E)return null;f.push([v,E])}const p=l.parse(o[o.length-1],o.length-1,l.expectedType,f);return p?new H_(f,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,f]of this.bindings)o.push(l,f.serialize());return o.push(this.result.serialize()),o}}class q_{constructor(o,l,f){this.type=o,this.index=l,this.input=f}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=l.parse(o[1],1,An),p=l.parse(o[2],2,Ma(l.expectedType||Br));return f&&p?new q_(p.type.itemType,f,p):null}evaluate(o){const l=this.index.evaluate(o),f=this.input.evaluate(o);if(l<0)throw new nn(`Array index out of bounds: ${l} < 0.`);if(l>=f.length)throw new nn(`Array index out of bounds: ${l} > ${f.length-1}.`);if(l!==Math.floor(l))throw new nn(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return f[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Z_{constructor(o,l,f){this.type=o,this.index=l,this.input=f}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=l.parse(o[1],1,An),p=l.parse(o[2],2,Ma(l.expectedType||Br));return f&&p?new Z_(p.type.itemType,f,p):null}evaluate(o){const l=this.index.evaluate(o),f=this.input.evaluate(o);if(l<0)throw new nn(`Array index out of bounds: ${l} < 0.`);if(l>f.length-1)throw new nn(`Array index out of bounds: ${l} > ${f.length-1}.`);if(l===Math.floor(l))return f[l];const p=Math.floor(l),y=Math.ceil(l),v=f[p],E=f[y];if(typeof v!="number"||typeof E!="number")throw new nn(`Cannot interpolate between non-number values at index ${l}.`);const C=l-p;return v*(1-C)+E*C}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class gx{constructor(o,l){this.type=Gr,this.needle=o,this.haystack=l}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=l.parse(o[1],1,Br),p=l.parse(o[2],2,Br);return f&&p?Dm(f.type,[Gr,Kr,An,oc,Br])?new gx(f,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${po(f.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(f==null)return!1;if(!Rl(l,["boolean","string","number","null"]))throw new nn(`Expected first argument to be of type boolean, string, number or null, but found ${po(Oo(l))} instead.`);if(!Rl(f,["string","array"]))throw new nn(`Expected second argument to be of type array or string, but found ${po(Oo(f))} instead.`);return f.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class X_{constructor(o,l,f){this.type=An,this.needle=o,this.haystack=l,this.fromIndex=f}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=l.parse(o[1],1,Br),p=l.parse(o[2],2,Br);if(!f||!p)return null;if(!Dm(f.type,[Gr,Kr,An,oc,Br]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${po(f.type)} instead`);if(o.length===4){const y=l.parse(o[3],3,An);return y?new X_(f,p,y):null}return new X_(f,p)}evaluate(o){const l=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Rl(l,["boolean","string","number","null"]))throw new nn(`Expected first argument to be of type boolean, string, number or null, but found ${po(Oo(l))} instead.`);if(!Rl(f,["string","array"]))throw new nn(`Expected second argument to be of type array or string, but found ${po(Oo(f))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(o);return f.indexOf(l,p)}return f.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class _x{constructor(o,l,f,p,y,v){this.inputType=o,this.type=l,this.input=f,this.cases=p,this.outputs=y,this.otherwise=v}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let f,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const y={},v=[];for(let O=2;O<o.length-1;O+=2){let z=o[O];const F=o[O+1];Array.isArray(z)||(z=[z]);const $=l.concat(O);if(z.length===0)return $.error("Expected at least one branch label.");for(const J of z){if(typeof J!="number"&&typeof J!="string")return $.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return $.error("Numeric branch labels must be integer values.");if(f){if($.checkSubtype(f,Oo(J)))return null}else f=Oo(J);if(y[String(J)]!==void 0)return $.error("Branch labels must be unique.");y[String(J)]=v.length}const Y=l.parse(F,O,p);if(!Y)return null;p=p||Y.type,v.push(Y)}const E=l.parse(o[1],1,Br);if(!E)return null;const C=l.parse(o[o.length-1],o.length-1,p);return C?E.type.kind!=="value"&&l.concat(1).checkSubtype(f,E.type)?null:new _x(f,p,E,y,v,C):null}evaluate(o){const l=this.input.evaluate(o);return(Oo(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),f=[],p={};for(const v of l){const E=p[this.cases[v]];E===void 0?(p[this.cases[v]]=f.length,f.push([this.cases[v],[v]])):f[E][1].push(v)}const y=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,E]of f)o.push(E.length===1?y(E[0]):E.map(y)),o.push(this.outputs[v].serialize());return o.push(this.otherwise.serialize()),o}}class K_{constructor(o,l,f){this.type=o,this.branches=l,this.otherwise=f}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let f;l.expectedType&&l.expectedType.kind!=="value"&&(f=l.expectedType);const p=[];for(let v=1;v<o.length-1;v+=2){const E=l.parse(o[v],v,Gr);if(!E)return null;const C=l.parse(o[v+1],v+1,f);if(!C)return null;p.push([E,C]),f=f||C.type}const y=l.parse(o[o.length-1],o.length-1,f);return y?new K_(f,p,y):null}evaluate(o){for(const[l,f]of this.branches)if(l.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,f]of this.branches)o(l),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class qm{constructor(o,l,f,p){this.type=o,this.input=l,this.beginIndex=f,this.endIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=l.parse(o[1],1,Br),p=l.parse(o[2],2,An);if(!f||!p)return null;if(!Dm(f.type,[Ma(Br),Kr,Br]))return l.error(`Expected first argument to be of type array or string, but found ${po(f.type)} instead`);if(o.length===4){const y=l.parse(o[3],3,An);return y?new qm(f.type,f,p,y):null}return new qm(f.type,f,p)}evaluate(o){const l=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!Rl(l,["string","array"]))throw new nn(`Expected first argument to be of type array or string, but found ${po(Oo(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(o);return l.slice(f,p)}return l.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Zm(u,o){return u==="=="||u==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function ZS(u,o,l,f){return f.compare(o,l)===0}function Td(u,o,l){const f=u!=="=="&&u!=="!=";return class tie{constructor(y,v,E){this.type=Gr,this.lhs=y,this.rhs=v,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const E=y[0];let C=v.parse(y[1],1,Br);if(!C)return null;if(!Zm(E,C.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${po(C.type)}'.`);let O=v.parse(y[2],2,Br);if(!O)return null;if(!Zm(E,O.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${po(O.type)}'.`);if(C.type.kind!==O.type.kind&&C.type.kind!=="value"&&O.type.kind!=="value")return v.error(`Cannot compare types '${po(C.type)}' and '${po(O.type)}'.`);f&&(C.type.kind==="value"&&O.type.kind!=="value"?C=new Un(O.type,[C]):C.type.kind!=="value"&&O.type.kind==="value"&&(O=new Un(C.type,[O])));let z=null;if(y.length===4){if(C.type.kind!=="string"&&O.type.kind!=="string"&&C.type.kind!=="value"&&O.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(z=v.parse(y[3],3,wu),!z)return null}return new tie(C,O,z)}evaluate(y){const v=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(f&&this.hasUntypedArgument){const C=Oo(v),O=Oo(E);if(C.kind!==O.kind||C.kind!=="string"&&C.kind!=="number")throw new nn(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${C.kind}, ${O.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const C=Oo(v),O=Oo(E);if(C.kind!=="string"||O.kind!=="string")return o(y,v,E)}return this.collator?l(y,v,E,this.collator.evaluate(y)):o(y,v,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[u];return this.eachChild(v=>{y.push(v.serialize())}),y}}}const eM=Td("==",function(u,o,l){return o===l},ZS),tM=Td("!=",function(u,o,l){return o!==l},function(u,o,l,f){return!ZS(0,o,l,f)}),XS=Td("<",function(u,o,l){return o<l},function(u,o,l,f){return f.compare(o,l)<0}),KS=Td(">",function(u,o,l){return o>l},function(u,o,l,f){return f.compare(o,l)>0}),nM=Td("<=",function(u,o,l){return o<=l},function(u,o,l,f){return f.compare(o,l)<=0}),rM=Td(">=",function(u,o,l){return o>=l},function(u,o,l,f){return f.compare(o,l)>=0});class yx{constructor(o,l,f,p,y,v){this.type=Kr,this.number=o,this.locale=l,this.currency=f,this.unit=p,this.minFractionDigits=y,this.maxFractionDigits=v}static parse(o,l){if(o.length!==3)return l.error("Expected two arguments.");const f=l.parse(o[1],1,An);if(!f)return null;const p=o[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=l.parseObjectValue(p.locale,2,"locale",Kr),!y))return null;let v=null;if(p.currency&&(v=l.parseObjectValue(p.currency,2,"currency",Kr),!v))return null;let E=null;if(p.unit&&(E=l.parseObjectValue(p.unit,2,"unit",Kr),!E))return null;let C=null;if(p["min-fraction-digits"]&&(C=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",An),!C))return null;let O=null;return p["max-fraction-digits"]&&(O=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",An),!O)?null:new yx(f,y,v,E,C,O)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Xm{constructor(o){this.type=An,this.input=o}static parse(o,l){if(o.length!==2)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=l.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${po(f.type)} instead.`):new Xm(f):null}evaluate(o){const l=this.input.evaluate(o);if(typeof l=="string"||Array.isArray(l))return l.length;throw new nn(`Expected value to be of type string or array, but found ${po(Oo(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}function YS(u){return function(){u=1831565813+(u|=0)|0;let o=Math.imul(u^u>>>15,1|u);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const Ed={"==":eM,"!=":tM,">":KS,"<":XS,">=":rM,"<=":nM,array:Un,at:q_,"at-interpolated":Z_,boolean:Un,case:K_,coalesce:G_,collator:sc,format:ns,image:wh,in:gx,"index-of":X_,interpolate:Ls,"interpolate-hcl":Ls,"interpolate-lab":Ls,length:Xm,let:H_,literal:ar,match:_x,number:Un,"number-format":yx,object:Un,slice:qm,step:wd,string:Un,"to-boolean":rs,"to-color":rs,"to-number":rs,"to-string":rs,var:va,within:cc,distance:Oe,config:Ht};function JS(u,[o,l,f,p]){o=o.evaluate(u),l=l.evaluate(u),f=f.evaluate(u);const y=p?p.evaluate(u):1,v=Of(o,l,f,y);if(v)throw new nn(v);return new Dr(o/255*y,l/255*y,f/255*y,y)}function QS(u,[o,l,f,p]){o=o.evaluate(u),l=l.evaluate(u),f=f.evaluate(u);const y=p?p.evaluate(u):1,v=function(O,z,F,$){return typeof O=="number"&&O>=0&&O<=360?typeof z=="number"&&z>=0&&z<=100&&typeof F=="number"&&F>=0&&F<=100?$===void 0||typeof $=="number"&&$>=0&&$<=1?null:`Invalid hsla value [${[O,z,F,$].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof $=="number"?[O,z,F,$]:[O,z,F]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof $=="number"?[O,z,F,$]:[O,z,F]).join(", ")}]: 'h' must be between 0 and 360.`}(o,l,f,y);if(v)throw new nn(v);const E=`hsla(${o}, ${l}%, ${f}%, ${y})`,C=Dr.parse(E);if(!C)throw new nn(`Failed to parse HSLA color: ${E}`);return C}function vx(u,o){return u in o}function Y_(u,o){const l=o[u];return l===void 0?null:l}function Ih(u){return{type:u}}function eT(u){return{result:"success",value:u}}function hl(u){return{result:"error",value:u}}function xx(u,o){return!!u&&!!u.parameters&&u.parameters.indexOf(o)>-1}function J_(u){return u["property-type"]==="data-driven"}function tT(u){return xx(u.expression,"measure-light")}function bx(u){return xx(u.expression,"zoom")}function Q_(u){return!!u.expression&&u.expression.interpolated}function ey(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function nT(u){return u}function ty(u,o){const l=o.type==="color",f=u.stops&&typeof u.stops[0][0]=="object",p=f||!(f||u.property!==void 0),y=u.type||(Q_(o)?"exponential":"interval");if(l&&((u=pd({},u)).stops&&(u.stops=u.stops.map(O=>[O[0],Dr.parse(O[1])])),u.default=Dr.parse(u.default?u.default:o.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!qS[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let v,E,C;if(y==="exponential")v=Mu;else if(y==="interval")v=iM;else if(y==="categorical"){v=rT,E=Object.create(null);for(const O of u.stops)E[O[0]]=O[1];C=typeof u.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);v=oM}if(f){const O={},z=[];for(let Y=0;Y<u.stops.length;Y++){const J=u.stops[Y],re=J[0].zoom;O[re]===void 0&&(O[re]={zoom:re,type:u.type,property:u.property,default:u.default,stops:[]},z.push(re)),O[re].stops.push([J[0].value,J[1]])}const F=[];for(const Y of z)F.push([O[Y].zoom,ty(O[Y],o)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Ls.interpolationFactor.bind(void 0,$),zoomStops:F.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>Mu({stops:F,base:u.base},o,Y).evaluate(Y,J)}}if(p){const O=y==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Ls.interpolationFactor.bind(void 0,O),zoomStops:u.stops.map(z=>z[0]),evaluate:({zoom:z})=>v(u,o,z,E,C)}}return{kind:"source",evaluate(O,z){const F=z&&z.properties?z.properties[u.property]:void 0;return F===void 0?Ad(u.default,o.default):v(u,o,F,E,C)}}}function Ad(u,o,l){return u!==void 0?u:o!==void 0?o:l!==void 0?l:void 0}function rT(u,o,l,f,p){return Ad(typeof l===p?f[l]:void 0,u.default,o.default)}function iM(u,o,l){if(Fn(l)!=="number")return Ad(u.default,o.default);const f=u.stops.length;if(f===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[f-1][0])return u.stops[f-1][1];const p=mc(u.stops.map(y=>y[0]),l);return u.stops[p][1]}function Mu(u,o,l){const f=u.base!==void 0?u.base:1;if(Fn(l)!=="number")return Ad(u.default,o.default);const p=u.stops.length;if(p===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[p-1][0])return u.stops[p-1][1];const y=mc(u.stops.map(z=>z[0]),l),v=function(z,F,$,Y){const J=Y-$,re=z-$;return J===0?0:F===1?re/J:(Math.pow(F,re)-1)/(Math.pow(F,J)-1)}(l,f,u.stops[y][0],u.stops[y+1][0]),E=u.stops[y][1],C=u.stops[y+1][1];let O=ks[o.type]||nT;if(u.colorSpace&&u.colorSpace!=="rgb"){const z=qS[u.colorSpace];O=(F,$)=>z.reverse(z.interpolate(z.forward(F),z.forward($),v))}return typeof E.evaluate=="function"?{evaluate(...z){const F=E.evaluate.apply(void 0,z),$=C.evaluate.apply(void 0,z);if(F!==void 0&&$!==void 0)return O(F,$,v)}}:O(E,C,v)}function oM(u,o,l){return o.type==="color"?l=Dr.parse(l):o.type==="formatted"?l=Oa.fromString(l.toString()):o.type==="resolvedImage"?l=ka.build(l.toString()):Fn(l)===o.type||o.type==="enum"&&o.values[l]||(l=void 0),Ad(l,u.default,o.default)}Da.register(Ed,{error:[{kind:"error"},[Kr],(u,[o])=>{throw new nn(o.evaluate(u))}],typeof:[Kr,[Br],(u,[o])=>po(Oo(o.evaluate(u)))],"to-rgba":[Ma(An,4),[Wa],(u,[o])=>o.evaluate(u).toRenderColor(null).toArray()],"to-hsla":[Ma(An,4),[Wa],(u,[o])=>o.evaluate(u).toRenderColor(null).toHslaArray()],rgb:[Wa,[An,An,An],JS],rgba:[Wa,[An,An,An,An],JS],hsl:[Wa,[An,An,An],QS],hsla:[Wa,[An,An,An,An],QS],has:{type:Gr,overloads:[[[Kr],(u,[o])=>vx(o.evaluate(u),u.properties())],[[Kr,ac],(u,[o,l])=>vx(o.evaluate(u),l.evaluate(u))]]},get:{type:Br,overloads:[[[Kr],(u,[o])=>Y_(o.evaluate(u),u.properties())],[[Kr,ac],(u,[o,l])=>Y_(o.evaluate(u),l.evaluate(u))]]},"feature-state":[Br,[Kr],(u,[o])=>Y_(o.evaluate(u),u.featureState||{})],properties:[ac,[],u=>u.properties()],"geometry-type":[Kr,[],u=>u.geometryType()],id:[Br,[],u=>u.id()],zoom:[An,[],u=>u.globals.zoom],pitch:[An,[],u=>u.globals.pitch||0],"distance-from-center":[An,[],u=>u.distanceFromCenter()],"measure-light":[An,[Kr],(u,[o])=>u.measureLight(o.evaluate(u))],"heatmap-density":[An,[],u=>u.globals.heatmapDensity||0],"line-progress":[An,[],u=>u.globals.lineProgress||0],"raster-value":[An,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[An,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[An,[],u=>u.globals.skyRadialProgress||0],accumulated:[Br,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[An,Ih(An),(u,o)=>{let l=0;for(const f of o)l+=f.evaluate(u);return l}],"*":[An,Ih(An),(u,o)=>{let l=1;for(const f of o)l*=f.evaluate(u);return l}],"-":{type:An,overloads:[[[An,An],(u,[o,l])=>o.evaluate(u)-l.evaluate(u)],[[An],(u,[o])=>-o.evaluate(u)]]},"/":[An,[An,An],(u,[o,l])=>o.evaluate(u)/l.evaluate(u)],"%":[An,[An,An],(u,[o,l])=>o.evaluate(u)%l.evaluate(u)],ln2:[An,[],()=>Math.LN2],pi:[An,[],()=>Math.PI],e:[An,[],()=>Math.E],"^":[An,[An,An],(u,[o,l])=>Math.pow(o.evaluate(u),l.evaluate(u))],sqrt:[An,[An],(u,[o])=>Math.sqrt(o.evaluate(u))],log10:[An,[An],(u,[o])=>Math.log(o.evaluate(u))/Math.LN10],ln:[An,[An],(u,[o])=>Math.log(o.evaluate(u))],log2:[An,[An],(u,[o])=>Math.log(o.evaluate(u))/Math.LN2],sin:[An,[An],(u,[o])=>Math.sin(o.evaluate(u))],cos:[An,[An],(u,[o])=>Math.cos(o.evaluate(u))],tan:[An,[An],(u,[o])=>Math.tan(o.evaluate(u))],asin:[An,[An],(u,[o])=>Math.asin(o.evaluate(u))],acos:[An,[An],(u,[o])=>Math.acos(o.evaluate(u))],atan:[An,[An],(u,[o])=>Math.atan(o.evaluate(u))],min:[An,Ih(An),(u,o)=>Math.min(...o.map(l=>l.evaluate(u)))],max:[An,Ih(An),(u,o)=>Math.max(...o.map(l=>l.evaluate(u)))],abs:[An,[An],(u,[o])=>Math.abs(o.evaluate(u))],round:[An,[An],(u,[o])=>{const l=o.evaluate(u);return l<0?-Math.round(-l):Math.round(l)}],floor:[An,[An],(u,[o])=>Math.floor(o.evaluate(u))],ceil:[An,[An],(u,[o])=>Math.ceil(o.evaluate(u))],"filter-==":[Gr,[Kr,Br],(u,[o,l])=>u.properties()[o.value]===l.value],"filter-id-==":[Gr,[Br],(u,[o])=>u.id()===o.value],"filter-type-==":[Gr,[Kr],(u,[o])=>u.geometryType()===o.value],"filter-<":[Gr,[Kr,Br],(u,[o,l])=>{const f=u.properties()[o.value],p=l.value;return typeof f==typeof p&&f<p}],"filter-id-<":[Gr,[Br],(u,[o])=>{const l=u.id(),f=o.value;return typeof l==typeof f&&l<f}],"filter->":[Gr,[Kr,Br],(u,[o,l])=>{const f=u.properties()[o.value],p=l.value;return typeof f==typeof p&&f>p}],"filter-id->":[Gr,[Br],(u,[o])=>{const l=u.id(),f=o.value;return typeof l==typeof f&&l>f}],"filter-<=":[Gr,[Kr,Br],(u,[o,l])=>{const f=u.properties()[o.value],p=l.value;return typeof f==typeof p&&f<=p}],"filter-id-<=":[Gr,[Br],(u,[o])=>{const l=u.id(),f=o.value;return typeof l==typeof f&&l<=f}],"filter->=":[Gr,[Kr,Br],(u,[o,l])=>{const f=u.properties()[o.value],p=l.value;return typeof f==typeof p&&f>=p}],"filter-id->=":[Gr,[Br],(u,[o])=>{const l=u.id(),f=o.value;return typeof l==typeof f&&l>=f}],"filter-has":[Gr,[Br],(u,[o])=>o.value in u.properties()],"filter-has-id":[Gr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Gr,[Ma(Kr)],(u,[o])=>o.value.indexOf(u.geometryType())>=0],"filter-id-in":[Gr,[Ma(Br)],(u,[o])=>o.value.indexOf(u.id())>=0],"filter-in-small":[Gr,[Kr,Ma(Br)],(u,[o,l])=>l.value.indexOf(u.properties()[o.value])>=0],"filter-in-large":[Gr,[Kr,Ma(Br)],(u,[o,l])=>function(f,p,y,v){for(;y<=v;){const E=y+v>>1;if(p[E]===f)return!0;p[E]>f?v=E-1:y=E+1}return!1}(u.properties()[o.value],l.value,0,l.value.length-1)],all:{type:Gr,overloads:[[[Gr,Gr],(u,[o,l])=>o.evaluate(u)&&l.evaluate(u)],[Ih(Gr),(u,o)=>{for(const l of o)if(!l.evaluate(u))return!1;return!0}]]},any:{type:Gr,overloads:[[[Gr,Gr],(u,[o,l])=>o.evaluate(u)||l.evaluate(u)],[Ih(Gr),(u,o)=>{for(const l of o)if(l.evaluate(u))return!0;return!1}]]},"!":[Gr,[Gr],(u,[o])=>!o.evaluate(u)],"is-supported-script":[Gr,[Kr],(u,[o])=>{const l=u.globals&&u.globals.isSupportedScript;return!l||l(o.evaluate(u))}],upcase:[Kr,[Kr],(u,[o])=>o.evaluate(u).toUpperCase()],downcase:[Kr,[Kr],(u,[o])=>o.evaluate(u).toLowerCase()],concat:[Kr,Ih(Br),(u,o)=>o.map(l=>Ra(l.evaluate(u))).join("")],"resolved-locale":[Kr,[wu],(u,[o])=>o.evaluate(u).resolvedLocale()],random:[An,[An,An,Br],(u,o)=>{const[l,f,p]=o.map(v=>v.evaluate(u));if(l>f||l===f)return l;let y;if(typeof p=="string")y=function(v){let E=0;if(v.length===0)return E;for(let C=0;C<v.length;C++)E=(E<<5)-E+v.charCodeAt(C),E|=0;return E}(p);else{if(typeof p!="number")throw new nn(`Invalid seed input: ${p}`);y=p}return l+YS(y)()*(f-l)}]});class wx{constructor(o,l,f,p){this.expression=o,this._warningHistory={},this._evaluator=new Tu(f,p),this._defaultValue=l?function(y){return y.type==="color"&&(ey(y.default)||Array.isArray(y.default))?new Dr(0,0,0,0):y.type==="color"?Dr.parse(y.default)||null:y.default===void 0?null:y.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Ir(o)}evaluateWithoutErrorHandling(o,l,f,p,y,v,E,C){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=f,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,f,p,y,v,E,C){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=f||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=C||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new nn(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function ny(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Ed}function Gf(u,o,l,f){const p=new Ds(Ed,[],o?function(v){const E={color:Wa,string:Kr,number:An,enum:Kr,boolean:Gr,formatted:Su,resolvedImage:md};return v.type==="array"?Ma(E[v.value]||Br,v.length):E[v.type]}(o):void 0,void 0,void 0,l,f),y=p.parse(u,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?eT(new wx(y,o,l,f)):hl(p.errors)}class Pd{constructor(o,l,f,p){this.kind=o,this._styleExpression=l,this.isLightConstant=f,this.isLineProgressConstant=p,this.isStateDependent=o!=="constant"&&!Yn(l.expression),this.configDependencies=Ir(l.expression)}evaluateWithoutErrorHandling(o,l,f,p,y,v){return this._styleExpression.evaluateWithoutErrorHandling(o,l,f,p,y,v)}evaluate(o,l,f,p,y,v){return this._styleExpression.evaluate(o,l,f,p,y,v)}}class Hf{constructor(o,l,f,p,y,v){this.kind=o,this.zoomStops=f,this._styleExpression=l,this.isStateDependent=o!=="camera"&&!Yn(l.expression),this.isLightConstant=y,this.isLineProgressConstant=v,this.configDependencies=Ir(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(o,l,f,p,y,v){return this._styleExpression.evaluateWithoutErrorHandling(o,l,f,p,y,v)}evaluate(o,l,f,p,y,v){return this._styleExpression.evaluate(o,l,f,p,y,v)}interpolationFactor(o,l,f){return this.interpolationType?Ls.interpolationFactor(this.interpolationType,o,l,f):0}}function Km(u,o,l,f){if((u=Gf(u,o,l,f)).result==="error")return u;const p=u.value.expression,y=bn(p);if(!y&&!J_(o))return hl([new Rs("","data expressions not supported")]);const v=Yr(p,["zoom","pitch","distance-from-center"]);if(!v&&!bx(o))return hl([new Rs("","zoom expressions not supported")]);const E=Yr(p,["measure-light"]);if(!E&&!tT(o))return hl([new Rs("","measure-light expression not supported")]);const C=Yr(p,["line-progress"]);if(!C&&!function(F){return xx(F.expression,"line-progress")}(o))return hl([new Rs("","line-progress expression not supported")]);const O=o.expression&&o.expression.relaxZoomRestriction,z=ry(p);return z||v||O?z instanceof Rs?hl([z]):z instanceof Ls&&!Q_(o)?hl([new Rs("",'"interpolate" expressions cannot be used with this property')]):eT(z?new Hf(y&&C?"camera":"composite",u.value,z.labels,z instanceof Ls?z.interpolation:void 0,E,C):new Pd(y&&C?"constant":"source",u.value,E,C)):hl([new Rs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Ym{constructor(o,l){this._parameters=o,this._specification=l,pd(this,ty(this._parameters,this._specification))}static deserialize(o){return new Ym(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function ry(u){let o=null;if(u instanceof H_)o=ry(u.result);else if(u instanceof G_){for(const l of u.args)if(o=ry(l),o)break}else(u instanceof wd||u instanceof Ls)&&u.input instanceof Da&&u.input.name==="zoom"&&(o=u);return o instanceof Rs||u.eachChild(l=>{const f=ry(l);f instanceof Rs?o=f:o&&f&&o!==f&&(o=new Rs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var Sx,iy,Tx=function(){if(iy)return Sx;iy=1,Sx=o;var u=3;function o(l,f,p){var y=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var v=new Int32Array(this.arrayBuffer);l=v[0],this.d=(f=v[1])+2*(p=v[2]);for(var E=0;E<this.d*this.d;E++){var C=v[u+E],O=v[u+E+1];y.push(C===O?null:v.subarray(C,O))}var z=v[u+y.length+1];this.keys=v.subarray(v[u+y.length],z),this.bboxes=v.subarray(z),this.insert=this._insertReadonly}else{this.d=f+2*p;for(var F=0;F<this.d*this.d;F++)y.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=l,this.padding=p,this.scale=f/l,this.uid=0;var $=p/f*l;this.min=-$,this.max=l+$}return o.prototype.insert=function(l,f,p,y,v){this._forEachCell(f,p,y,v,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(v)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(l,f,p,y,v,E){this.cells[v].push(E)},o.prototype.query=function(l,f,p,y,v){var E=this.min,C=this.max;if(l<=E&&f<=E&&C<=p&&C<=y&&!v)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(l,f,p,y,this._queryCell,O,{},v),O},o.prototype._queryCell=function(l,f,p,y,v,E,C,O){var z=this.cells[v];if(z!==null)for(var F=this.keys,$=this.bboxes,Y=0;Y<z.length;Y++){var J=z[Y];if(C[J]===void 0){var re=4*J;(O?O($[re+0],$[re+1],$[re+2],$[re+3]):l<=$[re+2]&&f<=$[re+3]&&p>=$[re+0]&&y>=$[re+1])?(C[J]=!0,E.push(F[J])):C[J]=!1}}},o.prototype._forEachCell=function(l,f,p,y,v,E,C,O){for(var z=this._convertToCellCoord(l),F=this._convertToCellCoord(f),$=this._convertToCellCoord(p),Y=this._convertToCellCoord(y),J=z;J<=$;J++)for(var re=F;re<=Y;re++){var ce=this.d*re+J;if((!O||O(this._convertFromCellCoord(J),this._convertFromCellCoord(re),this._convertFromCellCoord(J+1),this._convertFromCellCoord(re+1)))&&v.call(this,l,f,p,y,ce,E,C,O))return}},o.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},o.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,f=u+this.cells.length+1+1,p=0,y=0;y<this.cells.length;y++)p+=this.cells[y].length;var v=new Int32Array(f+p+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var E=f,C=0;C<l.length;C++){var O=l[C];v[u+C]=E,v.set(O,E),E+=O.length}return v[u+l.length]=E,v.set(this.keys,E),v[u+l.length+1]=E+=this.keys.length,v.set(this.bboxes,E),E+=this.bboxes.length,v.buffer},Sx}(),qf=Qa(Tx);const Jm={};function dn(u,o,l={}){Object.defineProperty(u,"_classRegistryKey",{value:o,writable:!1}),Jm[o]={klass:u,omit:l.omit||[]}}dn(Object,"Object"),qf.serialize=function(u,o){const l=u.toArrayBuffer();return o&&o.add(l),{buffer:l}},qf.deserialize=function(u){return new qf(u.buffer)},Object.defineProperty(qf,"name",{value:"Grid"}),dn(qf,"Grid"),typeof DOMMatrix<"u"&&dn(DOMMatrix,"DOMMatrix"),dn(Dr,"Color"),dn(Error,"Error"),dn(Oa,"Formatted"),dn(gd,"FormattedSection"),dn(Ms,"AJAXError"),dn(ka,"ResolvedImage"),dn(Ym,"StylePropertyFunction"),dn(wx,"StyleExpression",{omit:["_evaluator"]}),dn(ts,"ImageId"),dn(sl,"ImageVariant"),dn(Hf,"ZoomDependentExpression"),dn(Pd,"ZoomConstantExpression"),dn(Da,"CompoundExpression",{omit:["_evaluate"]});for(const u in Ed)Jm[Ed[u]._classRegistryKey]||dn(Ed[u],`Expression${u}`);function Qm(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Cd(u){return self.ImageBitmap&&u instanceof ImageBitmap}function Mh(u,o){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(Qm(u)||Cd(u))return o&&o.add(u),u;if(ArrayBuffer.isView(u))return o&&o.add(u.buffer),u;if(u instanceof ImageData)return o&&o.add(u.data.buffer),u;if(Array.isArray(u)){const l=[];for(const f of u)l.push(Mh(f,o));return l}if(u instanceof Map){const l={$name:"Map",entries:[]};for(const[f,p]of u.entries())l.entries.push(Mh(f),Mh(p,o));return l}if(u instanceof Set){const l={$name:"Set"};let f=0;for(const p of u.values())l[++f]=Mh(p);return l}if(u instanceof DOMMatrix){const l={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of f)l[p]=u[p];return l}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){const l=u.constructor,f=l._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const p=l.serialize?l.serialize(u,o):{};if(!l.serialize){for(const y in u)u.hasOwnProperty(y)&&(Jm[f].omit.indexOf(y)>=0||(p[y]=Mh(u[y],o)));u instanceof Error&&(p.message=u.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(p.$name=f),p}throw new Error("can't serialize object of type "+typeof u)}function Oh(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||Qm(u)||Cd(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Oh);if(typeof u=="object"){const o=u.$name||"Object";if(o==="Map"){const p=u.entries||[],y=new Map;for(let v=0;v<p.length;v+=2)y.set(Oh(p[v]),Oh(p[v+1]));return y}if(o==="Set"){const p=new Set;for(const y of Object.keys(u))y!=="$name"&&p.add(Oh(u[y]));return p}if(o==="DOMMatrix"){let p;return p=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(p)}if(o==="BigInt")return BigInt(u.value);const{klass:l}=Jm[o];if(!l)throw new Error(`Can't deserialize unregistered class "${o}".`);if(l.deserialize)return l.deserialize(u);const f=Object.create(l.prototype);for(const p of Object.keys(u))p!=="$name"&&(f[p]=Oh(u[p]));return f}throw new Error("can't deserialize object of type "+typeof u)}const Ln={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function Ex(u){for(const o of u)if(eg(o.charCodeAt(0)))return!0;return!1}function aM(u){for(const o of u)if(!iT(o.charCodeAt(0)))return!1;return!0}function iT(u){return!(Ln.Arabic(u)||Ln["Arabic Supplement"](u)||Ln["Arabic Extended-A"](u)||Ln["Arabic Presentation Forms-A"](u)||Ln["Arabic Presentation Forms-B"](u))}function eg(u){return!(u!==746&&u!==747&&(u<4352||!(Ln["Bopomofo Extended"](u)||Ln.Bopomofo(u)||Ln["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Ln["CJK Compatibility Ideographs"](u)||Ln["CJK Compatibility"](u)||Ln["CJK Radicals Supplement"](u)||Ln["CJK Strokes"](u)||!(!Ln["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Ln["CJK Unified Ideographs Extension A"](u)||Ln["CJK Unified Ideographs"](u)||Ln["Enclosed CJK Letters and Months"](u)||Ln["Hangul Compatibility Jamo"](u)||Ln["Hangul Jamo Extended-A"](u)||Ln["Hangul Jamo Extended-B"](u)||Ln["Hangul Jamo"](u)||Ln["Hangul Syllables"](u)||Ln.Hiragana(u)||Ln["Ideographic Description Characters"](u)||Ln.Kanbun(u)||Ln["Kangxi Radicals"](u)||Ln["Katakana Phonetic Extensions"](u)||Ln.Katakana(u)&&u!==12540||!(!Ln["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Ln["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Ln["Unified Canadian Aboriginal Syllabics"](u)||Ln["Unified Canadian Aboriginal Syllabics Extended"](u)||Ln["Vertical Forms"](u)||Ln["Yijing Hexagram Symbols"](u)||Ln["Yi Syllables"](u)||Ln["Yi Radicals"](u))))}function oT(u){return!(eg(u)||function(o){return!!(Ln["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Ln["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Ln["Letterlike Symbols"](o)||Ln["Number Forms"](o)||Ln["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Ln["Control Pictures"](o)&&o!==9251||Ln["Optical Character Recognition"](o)||Ln["Enclosed Alphanumerics"](o)||Ln["Geometric Shapes"](o)||Ln["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Ln["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Ln["CJK Symbols and Punctuation"](o)||Ln.Katakana(o)||Ln["Private Use Area"](o)||Ln["CJK Compatibility Forms"](o)||Ln["Small Form Variants"](o)||Ln["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(u))}function sM(u){return Ln.Arabic(u)||Ln["Arabic Supplement"](u)||Ln["Arabic Extended-A"](u)||Ln["Arabic Presentation Forms-A"](u)||Ln["Arabic Presentation Forms-B"](u)}function aT(u){return u>=1424&&u<=2303||Ln["Arabic Presentation Forms-A"](u)||Ln["Arabic Presentation Forms-B"](u)}function lM(u,o){return!(!o&&aT(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Ln.Khmer(u))}function cM(u){for(const o of u)if(aT(o.charCodeAt(0)))return!0;return!1}const Ax="deferred",Px="loading",Cx="loaded";let Ix=null,Us="unavailable",kh=null;const Id=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Us="error"),Ix&&Ix(u)};function oy(){ay.fire(new ic("pluginStateChange",{pluginStatus:Us,pluginURL:kh}))}const ay=new ol,Zf=function(){return Us},sT=function(){if(Us!==Ax||!kh)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Us=Px,oy(),kh&&Bc({url:kh},u=>{u?Id(u):(Us=Cx,oy())})},zl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Us===Cx||zl.applyArabicShaping!=null,isLoading:()=>Us===Px,setState(u){Us=u.pluginStatus,kh=u.pluginURL},isParsed:()=>zl.applyArabicShaping!=null&&zl.processBidirectionalText!=null&&zl.processStyledBidirectionalText!=null,getPluginURL:()=>kh};class ii{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(l,f){for(const p of l)if(!lM(p.charCodeAt(0),f))return!1;return!0}(o,zl.isLoaded())}}class tg{constructor(o,l,f,p){this.property=o,this.value=l,this.expression=function(y,v,E,C){if(ey(y))return new Ym(y,v);if(ny(y)||Array.isArray(y)&&y.length>0){const O=Km(y,v,E,C);if(O.result==="error")throw new Error(O.value.map(z=>`${z.key}: ${z.message}`).join(", "));return O.value}{let O=y;return typeof y=="string"&&v.type==="color"&&(O=Dr.parse(y)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(l===void 0?o.specification.default:l,o.specification,f,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,l,f){return this.property.possiblyEvaluate(this,o,l,f)}}class Rh{constructor(o,l,f){this.property=o,this.value=new tg(o,void 0,l,f)}transitioned(o,l){return new cT(this.property,this.value,l,ut({},o.transition,this.transition),o.now)}untransitioned(){return new cT(this.property,this.value,null,{},0)}}class lT{constructor(o,l,f){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=l,this._options=f,this.configDependencies=new Set}getValue(o){return pr(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new Rh(this._values[o].property,this._scope,this._options)),this._values[o].value=new tg(this._values[o].property,l===null?void 0:pr(l),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,l){l&&(this._options=l);const f=this._properties.properties;if(o)for(const p in o){const y=o[p];if(p.endsWith("-transition")){const v=p.slice(0,-11);f[v]&&this.setTransition(v,y)}else f.hasOwnProperty(p)&&this.setValue(p,y)}}getTransition(o){return pr(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new Rh(this._values[o].property)),this._values[o].transition=pr(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(o[l]=f);const p=this.getTransition(l);p!==void 0&&(o[`${l}-transition`]=p)}return o}transitioned(o,l){const f=new uT(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].transitioned(o,l._values[p]);return f}untransitioned(){const o=new uT(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class cT{constructor(o,l,f,p,y){const v=p.delay||0,E=p.duration||0;y=y||0,this.property=o,this.value=l,this.begin=y+v,this.end=this.begin+E,o.specification.transition&&(p.delay||p.duration)&&(this.prior=f)}possiblyEvaluate(o,l,f){const p=o.now||0,y=this.value.possiblyEvaluate(o,l,f),v=this.prior;if(v){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return v.possiblyEvaluate(o,l,f);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(o,l,f),y,We(E))}}return y}}class uT{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,f){const p=new Md(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(o,l,f);return p}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class uM{constructor(o,l,f){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=l,this._options=f,this.configDependencies=new Set}getValue(o){return pr(this._values[o].value)}setValue(o,l){this._values[o]=new tg(this._values[o].property,l===null?void 0:pr(l),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(o[l]=f)}return o}possiblyEvaluate(o,l,f){const p=new Md(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(o,l,f);return p}}class Xf{constructor(o,l,f){this.property=o,this.value=l,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,l,f,p){return this.property.evaluate(this.value,this.parameters,o,l,f,p)}}class Md{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Zt{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,f){const p=ks[this.specification.type];return p?p(o,l,f):o}}class cn{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,f,p){return new Xf(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(l,null,{},f,p)}:o.expression,l)}interpolate(o,l,f){if(o.value.kind!=="constant"||l.value.kind!=="constant")return o;if(o.value.value===void 0||l.value.value===void 0)return new Xf(this,{kind:"constant",value:void 0},o.parameters);const p=ks[this.specification.type];return p?new Xf(this,{kind:"constant",value:p(o.value.value,l.value.value,f)},o.parameters):o}evaluate(o,l,f,p,y,v){return o.kind==="constant"?o.value:o.evaluate(l,f,p,y,v)}}class Od{constructor(o){this.specification=o}possiblyEvaluate(o,l,f,p){return!!o.expression.evaluate(l,null,{},f,p)}interpolate(){return!1}}class io{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new ii(0,{});for(const f in o){const p=o[f];p.specification.overridable&&this.overridableProperties.push(f);const y=this.defaultPropertyValues[f]=new tg(p,void 0),v=this.defaultTransitionablePropertyValues[f]=new Rh(p);this.defaultTransitioningPropertyValues[f]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=y.possiblyEvaluate(l)}}}dn(cn,"DataDrivenProperty"),dn(Zt,"DataConstantProperty"),dn(Od,"ColorRampProperty");var st=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white"},"sky-atmosphere-color":{"type":"color","default":"white"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function gc(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function sy(u){if(Array.isArray(u))return u.map(sy);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const o={};for(const l in u)o[l]=sy(u[l]);return o}return gc(u)}function ly(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const o of u.slice(1))if(!ly(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function Mx(u,o="",l=null,f="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ly(u)||(u=cy(u));const p=u;let y=!0;try{y=function(z){if(!Kf(z))return z;let F=sy(z);return dT(F),F=hT(F),F}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let v=null,E=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){E=st[`filter_${f}`];const z=Gf(y,E,o,l);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));v=(F,$,Y)=>z.value.evaluate(F,$,{},Y)}let C=null,O=null;if(y!==p){const z=Gf(p,E,o,l);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));C=(F,$,Y,J,re)=>z.value.evaluate(F,$,{},Y,void 0,void 0,J,re),O=!bn(z.value.expression)}return{filter:v,dynamicFilter:C||void 0,needGeometry:fT(y),needFeature:!!O}}function hT(u){if(!Array.isArray(u))return u;const o=function(l){if(hM.has(l[0])){for(let f=1;f<l.length;f++)if(Kf(l[f]))return!0}return l}(u);return o===!0?o:o.map(l=>hT(l))}function dT(u){let o=!1;const l=[];if(u[0]==="case"){for(let f=1;f<u.length-1;f+=2)o=o||Kf(u[f]),l.push(u[f+1]);l.push(u[u.length-1])}else if(u[0]==="match"){o=o||Kf(u[1]);for(let f=2;f<u.length-1;f+=2)l.push(u[f+1]);l.push(u[u.length-1])}else if(u[0]==="step"){o=o||Kf(u[1]);for(let f=1;f<u.length-1;f+=2)l.push(u[f+1])}o&&(u.length=0,u.push("any",...l));for(let f=1;f<u.length;f++)dT(u[f])}function Kf(u){if(!Array.isArray(u))return!1;if((o=u[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let l=1;l<u.length;l++)if(Kf(u[l]))return!0;return!1}const hM=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function dM(u,o){return u<o?-1:u>o?1:0}function fT(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let o=1;o<u.length;o++)if(fT(u[o]))return!0;return!1}function cy(u){if(!u)return!0;const o=u[0];return u.length<=1?o!=="any":o==="=="?Ox(u[1],u[2],"=="):o==="!="?uy(Ox(u[1],u[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Ox(u[1],u[2],o):o==="any"?(l=u.slice(1),["any"].concat(l.map(cy))):o==="all"?["all"].concat(u.slice(1).map(cy)):o==="none"?["all"].concat(u.slice(1).map(cy).map(uy)):o==="in"?kx(u[1],u.slice(2)):o==="!in"?uy(kx(u[1],u.slice(2))):o==="has"?pT(u[1]):o!=="!has"||uy(pT(u[1]));var l}function Ox(u,o,l){switch(u){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,u,o]}}function kx(u,o){if(o.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",u,["literal",o.sort(dM)]]:["filter-in-small",u,["literal",o]]}}function pT(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function uy(u){return["!",u]}const ng="";function kd(u,o){return o?`${u}${ng}${o}`:u}const Rx="-transition",Dh=new Set(["fill","line","background","hillshade","raster"]);class gs extends ol{constructor(o,l,f,p,y){if(super(),this.id=o.id,this.fqid=kd(this.id,f),this.type=o.type,this.scope=f,this.lut=p,this.options=y,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const v=Gf(this.filter,st[`filter_${o.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),l.layout&&(this._unevaluatedLayout=new uM(l.layout,this.scope,y),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new lT(l.paint,this.scope,y);for(const v in o.paint)this.setPaintProperty(v,o.paint[v]);for(const v in o.layout)this.setLayoutProperty(v,o.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Md(l.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&Dh.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l){if(this.type==="custom"&&o==="visibility")return void(this.visibility=l);const f=this._unevaluatedLayout;f._properties.properties[o]&&(f.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(Rx)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l){const f=this._transitionablePaint,p=f._properties.properties;if(o.endsWith(Rx)){const F=o.slice(0,-11);return p[F]&&f.setTransition(F,l||void 0),!1}if(!p[o])return!1;const y=f._values[o],v=y.value.isDataDriven(),E=y.value;f.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const C=f._values[o].value,O=C.isDataDriven(),z=o.endsWith("pattern")||o==="line-dasharray";return O||v||z||this._handleOverridablePaintPropertyUpdate(o,E,C)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,l,f){return null}_handleOverridablePaintPropertyUpdate(o,l,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){return or({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}is3D(o){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof Xf&&J_(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=Mx(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,l,f,p,y,v,E,C,O){}}const fM={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rg{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function zr(u,o=1){let l=0,f=0;return{members:u.map(p=>{const y=fM[p.type].BYTES_PER_ELEMENT,v=l=Dx(l,Math.max(o,y)),E=p.components||1;return f=Math.max(f,y),l+=y*E,{name:p.name,type:p.type,components:E,offset:v}}),size:Dx(l,Math.max(f,o)),alignment:o}}function Dx(u,o){return Math.ceil(u/o)*o}class Ou extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const f=this.length;return this.resize(f+1),this.emplace(f,o,l)}emplace(o,l,f){const p=2*o;return this.int16[p+0]=l,this.int16[p+1]=f,o}}Ou.prototype.bytesPerElement=4,dn(Ou,"StructArrayLayout2i4");class hy extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,f)}emplace(o,l,f,p){const y=3*o;return this.int16[y+0]=l,this.int16[y+1]=f,this.int16[y+2]=p,o}}hy.prototype.bytesPerElement=6,dn(hy,"StructArrayLayout3i6");class Rd extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,f,p)}emplace(o,l,f,p,y){const v=4*o;return this.int16[v+0]=l,this.int16[v+1]=f,this.int16[v+2]=p,this.int16[v+3]=y,o}}Rd.prototype.bytesPerElement=8,dn(Rd,"StructArrayLayout4i8");class Yf extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}Yf.prototype.bytesPerElement=4,dn(Yf,"StructArrayLayout1f4");class dy extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,f)}emplace(o,l,f,p){const y=4*o,v=2*o;return this.int16[y+0]=l,this.int16[y+1]=f,this.float32[v+1]=p,o}}dy.prototype.bytesPerElement=8,dn(dy,"StructArrayLayout2i1f8");class Jf extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,f)}emplace(o,l,f,p){const y=4*o;return this.int16[y+0]=l,this.int16[y+1]=f,this.int16[y+2]=p,o}}Jf.prototype.bytesPerElement=8,dn(Jf,"StructArrayLayout3i8");class Lx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,f,p,y)}emplace(o,l,f,p,y,v){const E=5*o;return this.int16[E+0]=l,this.int16[E+1]=f,this.int16[E+2]=p,this.int16[E+3]=y,this.int16[E+4]=v,o}}Lx.prototype.bytesPerElement=10,dn(Lx,"StructArrayLayout5i10");class zx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E){const C=this.length;return this.resize(C+1),this.emplace(C,o,l,f,p,y,v,E)}emplace(o,l,f,p,y,v,E,C){const O=6*o,z=12*o,F=3*o;return this.int16[O+0]=l,this.int16[O+1]=f,this.uint8[z+4]=p,this.uint8[z+5]=y,this.uint8[z+6]=v,this.uint8[z+7]=E,this.float32[F+2]=C,o}}zx.prototype.bytesPerElement=12,dn(zx,"StructArrayLayout2i4ub1f12");class Uc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,f)}emplace(o,l,f,p){const y=3*o;return this.float32[y+0]=l,this.float32[y+1]=f,this.float32[y+2]=p,o}}Uc.prototype.bytesPerElement=12,dn(Uc,"StructArrayLayout3f12");class ku extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,f,p,y)}emplace(o,l,f,p,y,v){const E=6*o,C=3*o;return this.uint16[E+0]=l,this.uint16[E+1]=f,this.uint16[E+2]=p,this.uint16[E+3]=y,this.float32[C+2]=v,o}}ku.prototype.bytesPerElement=12,dn(ku,"StructArrayLayout4ui1f12");class fy extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,f,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,f,p)}emplace(o,l,f,p,y){const v=4*o;return this.uint16[v+0]=l,this.uint16[v+1]=f,this.uint16[v+2]=p,this.uint16[v+3]=y,o}}fy.prototype.bytesPerElement=8,dn(fy,"StructArrayLayout4ui8");class Dd extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,f,p,y,v)}emplace(o,l,f,p,y,v,E){const C=6*o;return this.int16[C+0]=l,this.int16[C+1]=f,this.int16[C+2]=p,this.int16[C+3]=y,this.int16[C+4]=v,this.int16[C+5]=E,o}}Dd.prototype.bytesPerElement=12,dn(Dd,"StructArrayLayout6i12");class Qf extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F,$){const Y=this.length;return this.resize(Y+1),this.emplace(Y,o,l,f,p,y,v,E,C,O,z,F,$)}emplace(o,l,f,p,y,v,E,C,O,z,F,$,Y){const J=12*o;return this.int16[J+0]=l,this.int16[J+1]=f,this.int16[J+2]=p,this.int16[J+3]=y,this.uint16[J+4]=v,this.uint16[J+5]=E,this.uint16[J+6]=C,this.uint16[J+7]=O,this.int16[J+8]=z,this.int16[J+9]=F,this.int16[J+10]=$,this.int16[J+11]=Y,o}}Qf.prototype.bytesPerElement=24,dn(Qf,"StructArrayLayout4i4ui4i24");class zs extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,f,p,y,v)}emplace(o,l,f,p,y,v,E){const C=10*o,O=5*o;return this.int16[C+0]=l,this.int16[C+1]=f,this.int16[C+2]=p,this.float32[O+2]=y,this.float32[O+3]=v,this.float32[O+4]=E,o}}zs.prototype.bytesPerElement=20,dn(zs,"StructArrayLayout3i3f20");class Vc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,f,p)}emplace(o,l,f,p,y){const v=4*o;return this.float32[v+0]=l,this.float32[v+1]=f,this.float32[v+2]=p,this.float32[v+3]=y,o}}Vc.prototype.bytesPerElement=16,dn(Vc,"StructArrayLayout4f16");class Nx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}Nx.prototype.bytesPerElement=4,dn(Nx,"StructArrayLayout1ul4");class Lh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const f=this.length;return this.resize(f+1),this.emplace(f,o,l)}emplace(o,l,f){const p=2*o;return this.uint16[p+0]=l,this.uint16[p+1]=f,o}}Lh.prototype.bytesPerElement=4,dn(Lh,"StructArrayLayout2ui4");class Fx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F,$,Y){const J=this.length;return this.resize(J+1),this.emplace(J,o,l,f,p,y,v,E,C,O,z,F,$,Y)}emplace(o,l,f,p,y,v,E,C,O,z,F,$,Y,J){const re=20*o,ce=10*o;return this.int16[re+0]=l,this.int16[re+1]=f,this.int16[re+2]=p,this.int16[re+3]=y,this.int16[re+4]=v,this.float32[ce+3]=E,this.float32[ce+4]=C,this.float32[ce+5]=O,this.float32[ce+6]=z,this.int16[re+14]=F,this.uint32[ce+8]=$,this.uint16[re+18]=Y,this.uint16[re+19]=J,o}}Fx.prototype.bytesPerElement=40,dn(Fx,"StructArrayLayout5i4f1i1ul2ui40");class py extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E){const C=this.length;return this.resize(C+1),this.emplace(C,o,l,f,p,y,v,E)}emplace(o,l,f,p,y,v,E,C){const O=8*o;return this.int16[O+0]=l,this.int16[O+1]=f,this.int16[O+2]=p,this.int16[O+4]=y,this.int16[O+5]=v,this.int16[O+6]=E,this.int16[O+7]=C,o}}py.prototype.bytesPerElement=16,dn(py,"StructArrayLayout3i2i2i16");class ig extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,f,p,y)}emplace(o,l,f,p,y,v){const E=4*o,C=8*o;return this.float32[E+0]=l,this.float32[E+1]=f,this.float32[E+2]=p,this.int16[C+6]=y,this.int16[C+7]=v,o}}ig.prototype.bytesPerElement=16,dn(ig,"StructArrayLayout2f1f2i16");class Bx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,f,p,y,v)}emplace(o,l,f,p,y,v,E){const C=20*o,O=5*o;return this.uint8[C+0]=l,this.uint8[C+1]=f,this.float32[O+1]=p,this.float32[O+2]=y,this.float32[O+3]=v,this.float32[O+4]=E,o}}Bx.prototype.bytesPerElement=20,dn(Bx,"StructArrayLayout2ub4f20");class ia extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,f)}emplace(o,l,f,p){const y=3*o;return this.uint16[y+0]=l,this.uint16[y+1]=f,this.uint16[y+2]=p,o}}ia.prototype.bytesPerElement=6,dn(ia,"StructArrayLayout3ui6");class jx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge){const be=this.length;return this.resize(be+1),this.emplace(be,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge)}emplace(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge,be){const Ee=30*o,Ue=15*o,qe=60*o;return this.int16[Ee+0]=l,this.int16[Ee+1]=f,this.int16[Ee+2]=p,this.float32[Ue+2]=y,this.float32[Ue+3]=v,this.uint16[Ee+8]=E,this.uint16[Ee+9]=C,this.uint32[Ue+5]=O,this.uint32[Ue+6]=z,this.uint32[Ue+7]=F,this.uint16[Ee+16]=$,this.uint16[Ee+17]=Y,this.uint16[Ee+18]=J,this.float32[Ue+10]=re,this.float32[Ue+11]=ce,this.uint8[qe+48]=de,this.uint8[qe+49]=we,this.uint8[qe+50]=ve,this.uint32[Ue+13]=ie,this.int16[Ee+28]=ge,this.uint8[qe+58]=be,o}}jx.prototype.bytesPerElement=60,dn(jx,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class $x extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt,Ct,kt,Bt,_t){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt,Ct,kt,Bt,_t)}emplace(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve,ie,ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt,Ct,kt,Bt,_t,Ot){const pt=20*o,vt=40*o,Ut=80*o;return this.float32[pt+0]=l,this.float32[pt+1]=f,this.int16[vt+4]=p,this.int16[vt+5]=y,this.int16[vt+6]=v,this.int16[vt+7]=E,this.int16[vt+8]=C,this.int16[vt+9]=O,this.int16[vt+10]=z,this.int16[vt+11]=F,this.int16[vt+12]=$,this.uint16[vt+13]=Y,this.uint16[vt+14]=J,this.uint16[vt+15]=re,this.uint16[vt+16]=ce,this.uint16[vt+17]=de,this.uint16[vt+18]=we,this.uint16[vt+19]=ve,this.uint16[vt+20]=ie,this.uint16[vt+21]=ge,this.uint16[vt+22]=be,this.uint16[vt+23]=Ee,this.uint16[vt+24]=Ue,this.uint16[vt+25]=qe,this.uint16[vt+26]=Ke,this.uint16[vt+27]=Qe,this.uint32[pt+14]=xt,this.float32[pt+15]=Dt,this.float32[pt+16]=Ct,this.float32[pt+17]=kt,this.float32[pt+18]=Bt,this.uint8[Ut+76]=_t,this.uint16[vt+39]=Ot,o}}$x.prototype.bytesPerElement=80,dn($x,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class zh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,f,p,y)}emplace(o,l,f,p,y,v){const E=5*o;return this.float32[E+0]=l,this.float32[E+1]=f,this.float32[E+2]=p,this.float32[E+3]=y,this.float32[E+4]=v,o}}zh.prototype.bytesPerElement=20,dn(zh,"StructArrayLayout5f20");class og extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E){const C=this.length;return this.resize(C+1),this.emplace(C,o,l,f,p,y,v,E)}emplace(o,l,f,p,y,v,E,C){const O=7*o;return this.float32[O+0]=l,this.float32[O+1]=f,this.float32[O+2]=p,this.float32[O+3]=y,this.float32[O+4]=v,this.float32[O+5]=E,this.float32[O+6]=C,o}}og.prototype.bytesPerElement=28,dn(og,"StructArrayLayout7f28");class Ux extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F){const $=this.length;return this.resize($+1),this.emplace($,o,l,f,p,y,v,E,C,O,z,F)}emplace(o,l,f,p,y,v,E,C,O,z,F,$){const Y=11*o;return this.float32[Y+0]=l,this.float32[Y+1]=f,this.float32[Y+2]=p,this.float32[Y+3]=y,this.float32[Y+4]=v,this.float32[Y+5]=E,this.float32[Y+6]=C,this.float32[Y+7]=O,this.float32[Y+8]=z,this.float32[Y+9]=F,this.float32[Y+10]=$,o}}Ux.prototype.bytesPerElement=44,dn(Ux,"StructArrayLayout11f44");class my extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O){const z=this.length;return this.resize(z+1),this.emplace(z,o,l,f,p,y,v,E,C,O)}emplace(o,l,f,p,y,v,E,C,O,z){const F=9*o;return this.float32[F+0]=l,this.float32[F+1]=f,this.float32[F+2]=p,this.float32[F+3]=y,this.float32[F+4]=v,this.float32[F+5]=E,this.float32[F+6]=C,this.float32[F+7]=O,this.float32[F+8]=z,o}}my.prototype.bytesPerElement=36,dn(my,"StructArrayLayout9f36");class Ld extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const f=this.length;return this.resize(f+1),this.emplace(f,o,l)}emplace(o,l,f){const p=2*o;return this.float32[p+0]=l,this.float32[p+1]=f,o}}Ld.prototype.bytesPerElement=8,dn(Ld,"StructArrayLayout2f8");class Vx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,f,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,f,p)}emplace(o,l,f,p,y){const v=6*o;return this.uint32[3*o+0]=l,this.uint16[v+2]=f,this.uint16[v+3]=p,this.uint16[v+4]=y,o}}Vx.prototype.bytesPerElement=12,dn(Vx,"StructArrayLayout1ul3ui12");class ag extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}ag.prototype.bytesPerElement=2,dn(ag,"StructArrayLayout1ui2");class ep extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce){const de=this.length;return this.resize(de+1),this.emplace(de,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce)}emplace(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de){const we=16*o;return this.float32[we+0]=l,this.float32[we+1]=f,this.float32[we+2]=p,this.float32[we+3]=y,this.float32[we+4]=v,this.float32[we+5]=E,this.float32[we+6]=C,this.float32[we+7]=O,this.float32[we+8]=z,this.float32[we+9]=F,this.float32[we+10]=$,this.float32[we+11]=Y,this.float32[we+12]=J,this.float32[we+13]=re,this.float32[we+14]=ce,this.float32[we+15]=de,o}}ep.prototype.bytesPerElement=64,dn(ep,"StructArrayLayout16f64");class sg extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,f,p,y,v,E){const C=this.length;return this.resize(C+1),this.emplace(C,o,l,f,p,y,v,E)}emplace(o,l,f,p,y,v,E,C){const O=10*o,z=5*o;return this.uint16[O+0]=l,this.uint16[O+1]=f,this.uint16[O+2]=p,this.uint16[O+3]=y,this.float32[z+2]=v,this.float32[z+3]=E,this.float32[z+4]=C,o}}sg.prototype.bytesPerElement=20,dn(sg,"StructArrayLayout4ui3f20");class Wx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.int16[1*o+0]=l,o}}Wx.prototype.bytesPerElement=2,dn(Wx,"StructArrayLayout1i2");class gy extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint8[1*o+0]=l,o}}gy.prototype.bytesPerElement=1,dn(gy,"StructArrayLayout1ub1");class mT extends rg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}mT.prototype.size=40;class _y extends Fx{get(o){return new mT(this,o)}}dn(_y,"CollisionBoxArray");class gT extends rg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}gT.prototype.size=60;class _T extends jx{get(o){return new gT(this,o)}}dn(_T,"PlacedSymbolArray");class yT extends rg{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}yT.prototype.size=80;class vT extends $x{get(o){return new yT(this,o)}}dn(vT,"SymbolInstanceArray");class Gx extends Yf{getoffsetX(o){return this.float32[1*o+0]}}dn(Gx,"GlyphOffsetArray");class xT extends Ou{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}dn(xT,"SymbolLineVertexArray");class bT extends rg{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}bT.prototype.size=12;class wT extends Vx{get(o){return new bT(this,o)}}dn(wT,"FeatureIndexArray");class ST extends Lh{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}dn(ST,"FillExtrusionCentroidArray");class TT extends rg{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}TT.prototype.size=6;class ET extends hy{get(o){return new TT(this,o)}}dn(ET,"FillExtrusionWallArray");const pM=zr([{name:"a_pos",components:2,type:"Int16"}],4),mM=zr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class qi{constructor(o=[]){this.segments=o}_prepareSegment(o,l,f,p){let y=this.segments[this.segments.length-1];return o>qi.MAX_VERTEX_ARRAY_LENGTH&&mr(`Max vertices per segment is ${qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!y||y.vertexLength+o>qi.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:l,primitiveOffset:f,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}prepareSegment(o,l,f,p){return this._prepareSegment(o,l.length,f.length,p)}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,f,p){return new qi([{vertexOffset:o,primitiveOffset:l,vertexLength:f,primitiveLength:p,vaos:{},sortKey:0}])}}function AT(u,o){return 256*(u=$e(Math.floor(u),0,255))+$e(Math.floor(o),0,255)}qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(qi,"SegmentVector");const gM=zr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),tp=zr([{name:"a_pattern_b",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),_M=zr([{name:"a_dash",components:4,type:"Uint16"}]);class np{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,l,f,p){this.ids.push(PT(o)),this.positions.push(l,f,p)}eachPosition(o,l){const f=PT(o);let p=0,y=this.ids.length-1;for(;p<y;){const v=p+y>>1;this.ids[v]>=f?y=v:p=v+1}for(;this.ids[p]===f;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(o,l){const f=new Float64Array(o.ids),p=new Uint32Array(o.positions);return yy(f,p,0,f.length-1),l&&(l.add(f.buffer),l.add(p.buffer)),{ids:f,positions:p}}static deserialize(o){const l=new np;let f;l.ids=o.ids,l.positions=o.positions;for(const p of l.ids)p!==f&&l.uniqueIds.push(p),f=p;return l.indexed=!0,l}}function PT(u){const o=+u;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:ds(String(u))}function yy(u,o,l,f){for(;l<f;){const p=u[l+f>>1];let y=l-1,v=f+1;for(;;){do y++;while(u[y]<p);do v--;while(u[v]>p);if(y>=v)break;lg(u,y,v),lg(o,3*y,3*v),lg(o,3*y+1,3*v+1),lg(o,3*y+2,3*v+2)}v-l<f-v?(yy(u,o,l,v),l=v+1):(yy(u,o,v+1,f),f=v)}}function lg(u,o,l){const f=u[o];u[o]=u[l],u[l]=f}dn(np,"FeaturePositionMap");class Wc{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}set(o,l,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class vy extends Wc{constructor(o){super(o),this.current=0}set(o,l,f){this.fetchUniformLocation(o,l)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class wo extends Wc{constructor(o){super(o),this.current=0}set(o,l,f){this.fetchUniformLocation(o,l)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class _c extends Wc{constructor(o){super(o),this.current=[0,0]}set(o,l,f){this.fetchUniformLocation(o,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class cg extends Wc{constructor(o){super(o),this.current=[0,0,0]}set(o,l,f){this.fetchUniformLocation(o,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class xy extends Wc{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,f){this.fetchUniformLocation(o,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class CT extends Wc{constructor(o){super(o),this.current=Dr.transparent.toRenderColor(null)}set(o,l,f){this.fetchUniformLocation(o,l)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const yM=new Float32Array(16);class ug extends Wc{constructor(o){super(o),this.current=yM}set(o,l,f){if(this.fetchUniformLocation(o,l)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let p=1;p<16;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const IT=new Float32Array(9),Hx=new Float32Array(4);class Nl extends Wc{constructor(o){super(o),this.current=Hx}set(o,l,f){if(this.fetchUniformLocation(o,l)){for(let p=0;p<4;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function hg(u){return[AT(255*u.r,255*u.g),AT(255*u.b,255*u.a)]}class dg{constructor(o,l,f,p){this.value=o,this.uniformNames=l.map(y=>`u_${y}`),this.type=f,this.context=p}setUniform(o,l,f,p,y){const v=p.constantOr(this.value);l.set(o,y,v instanceof Dr?v.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(o,l){return this.type==="color"?new CT(o):new wo(o)}}class rp{constructor(o,l){this.uniformNames=l.map(f=>`u_${f}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(o,l){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(o,l,f,p,y){let v=null;y!=="u_pattern"&&y!=="u_dash"||(v=this.pattern),y==="u_pattern_b"&&(v=this.patternTransition),y==="u_pixel_ratio"&&(v=this.pixelRatio),v&&l.set(o,y,v)}getBinding(o,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new xy(o):new wo(o)}}class Ru{constructor(o,l,f,p){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=l.map(y=>({name:`a_${y}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(o,l,f,p,y,v,E){const C=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ii(0,{brightness:v}),l,{},y,p,E):this.expression.kind==="constant"&&this.expression.value,z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ii(0,{brightness:v}),l,{},y,p,E):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(C,o,O,z?null:this.context.lut)}updatePaintArray(o,l,f,p,y,v,E){const C=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:E},f,p,void 0,y):this.expression.kind==="constant"&&this.expression.value,O=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ii(0,{brightness:E}),f,p,void 0,y):this.lutExpression.value)==="none";this._setPaintValue(o,l,C,O?null:this.context.lut)}_setPaintValue(o,l,f,p){if(this.type==="color"){const y=hg(f.toRenderColor(p));for(let v=o;v<l;v++)this.paintVertexArray.emplace(v,y[0],y[1])}else{for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class yc{constructor(o,l,f,p,y,v){this.expression=o,this.uniformNames=l.map(E=>`u_${E}_t`),this.type=f,this.useIntegerZoom=p,this.context=y,this.maxValue=0,this.paintVertexAttributes=l.map(E=>({name:`a_${E}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(o,l,f,p,y,v,E){const C=this.expression.evaluate(new ii(this.context.zoom,{brightness:v}),l,{},y,p,E),O=this.expression.evaluate(new ii(this.context.zoom+1,{brightness:v}),l,{},y,p,E),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ii(0,{brightness:v}),l,{},y,p,E):this.lutExpression.value)==="none",F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,C,O,z?null:this.context.lut)}updatePaintArray(o,l,f,p,y,v,E){const C=this.expression.evaluate({zoom:this.context.zoom,brightness:E},f,p,void 0,y),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E},f,p,void 0,y),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ii(0,{brightness:E}),f,p,void 0,y):this.lutExpression.value)==="none";this._setPaintValue(o,l,C,O,z?null:this.context.lut)}_setPaintValue(o,l,f,p,y){if(this.type==="color"){const v=hg(f.toRenderColor(y)),E=hg(f.toRenderColor(y));for(let C=o;C<l;C++)this.paintVertexArray.emplace(C,v[0],v[1],E[0],E[1])}else{for(let v=o;v<l;v++)this.paintVertexArray.emplace(v,f,p);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,f,p,y){const v=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,E=$e(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);l.set(o,y,E)}getBinding(o,l){return new wo(o)}}class vc{constructor(o,l,f,p,y){this.expression=o,this.layerId=y,this.paintVertexAttributes=(f==="array"?_M:gM).members;for(let v=0;v<l.length;++v);this.paintVertexArray=new p,this.paintTransitionVertexArray=new ku}populatePaintArray(o,l,f,p){const y=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(y,o,l.patterns&&l.patterns[this.layerId],f)}updatePaintArray(o,l,f,p,y,v,E){this._setPaintValues(o,l,f.patterns&&f.patterns[this.layerId],v)}_setPaintValues(o,l,f,p){if(!p||!f)return;const y=p[f[0]],v=p[f[1]];if(y){if(y){const{tl:E,br:C,pixelRatio:O}=y;for(let z=o;z<l;z++)this.paintVertexArray.emplace(z,E[0],E[1],C[0],C[1],O)}if(v){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:E,br:C,pixelRatio:O}=v;for(let z=o;z<l;z++)this.paintTransitionVertexArray.emplace(z,E[0],E[1],C[0],C[1],O)}}}upload(o){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=o.createVertexBuffer(this.paintTransitionVertexArray,tp.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Nh{constructor(o,l,f=()=>!0){this.binders={},this._buffers=[],this.context=l;const p=[];for(const y in o.paint._values){const v=o.paint.get(y);if(y.endsWith("-use-theme")||!f(y)||!(v instanceof Xf&&J_(v.property.specification)))continue;const E=s(y,o.type),C=v.value,O=v.property.specification.type,z=!!v.property.useIntegerZoom,F=y==="line-dasharray"||y.endsWith("pattern"),$=o.paint.get(`${y}-use-theme`),Y=y==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||$&&$.value.kind!=="constant";if(C.kind!=="constant"||Y)if(C.kind==="source"||Y||F){const J=w(y,O,"source");this.binders[y]=F?new vc(C,E,O,J,o.id):new Ru(C,E,O,J),p.push(`/a_${y}`)}else{const J=w(y,O,"composite");this.binders[y]=new yc(C,E,O,z,l,J),p.push(`/z_${y}`)}else this.binders[y]=F?new rp(C.value,E):new dg(C.value,E,O,l),p.push(`/u_${y}`);$&&(this.binders[y].lutExpression=$.value)}this.cacheKey=p.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof Ru||l instanceof yc?l.maxValue:0}populatePaintArrays(o,l,f,p,y,v,E){for(const C in this.binders){const O=this.binders[C];O.context=this.context,(O instanceof Ru||O instanceof yc||O instanceof vc)&&O.populatePaintArray(o,l,f,p,y,v,E)}}setConstantPatternPositions(o,l){for(const f in this.binders){const p=this.binders[f];p instanceof rp&&p.setConstantPatternPositions(o,l)}}getPatternTransitionVertexBuffer(o){const l=this.binders[o];return l instanceof vc?l.paintTransitionVertexBuffer:null}updatePaintArrays(o,l,f,p,y,v,E,C,O){let z=!1;const F=Object.keys(o),$=F.length!==0&&!C,Y=$?F:l.uniqueIds;this.context.lut=y.lut;for(const J in this.binders){const re=this.binders[J];if(re.context=this.context,(re instanceof Ru||re instanceof yc||re instanceof vc)&&re.expression&&re.expression.kind&&re.expression.kind!=="constant"&&(re.expression.isStateDependent===!0||re.expression.isLightConstant===!1)){const ce=y.paint.get(J);re.expression=ce.value;for(const de of Y){const we=o[de.toString()];l.eachPosition(de,(ve,ie,ge)=>{const be=p.feature(ve);re.updatePaintArray(ie,ge,be,we,v,E,O)})}if(!$)for(const de of f.uniqueIds){const we=o[de.toString()];f.eachPosition(de,(ve,ie,ge)=>{const be=p.feature(ve);re.updatePaintArray(ie,ge,be,we,v,E,O)})}z=!0}}return z}defines(){const o=[];for(const l in this.binders){const f=this.binders[l];(f instanceof dg||f instanceof rp)&&o.push(...f.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof Ru||f instanceof yc||f instanceof vc)for(let p=0;p<f.paintVertexAttributes.length;p++)o.push(f.paintVertexAttributes[p].name);if(f instanceof vc)for(let p=0;p<tp.members.length;p++)o.push(tp.members[p].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof dg||f instanceof rp||f instanceof yc)for(const p of f.uniformNames)o.push(p)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof dg||p instanceof rp||p instanceof yc)for(const y of p.uniformNames)l.push({name:y,property:f,binding:p.getBinding(o,y)})}return l}setUniforms(o,l,f,p,y){for(const{name:v,property:E,binding:C}of f)this.binders[E].setUniform(o,C,y,p.get(E),v)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof Ru||l instanceof yc||l instanceof vc)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof vc&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(o){for(const l in this.binders){const f=this.binders[l];(f instanceof Ru||f instanceof yc||f instanceof vc)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof Ru||l instanceof yc||l instanceof vc)&&l.destroy()}}}class zd{constructor(o,l,f=()=>!0){this.programConfigurations={};for(const p of o)this.programConfigurations[p.id]=new Nh(p,l,f);this.needsUpload=!1,this._featureMap=new np,this._featureMapWithoutIds=new np,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,l,f,p,y,v,E,C){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(o,l,p,y,v,E,C);l.id!==void 0?this._featureMap.add(l.id,f,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,f,p,y,v,E){for(const C of f)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,l,C,p,y,v,E||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const m={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"]};function s(u,o){return m[u]||[u.replace(`${o}-`,"").replace(/-/g,"_")]}const h={"line-pattern":{source:ku,composite:ku},"fill-pattern":{source:ku,composite:ku},"fill-extrusion-pattern":{source:ku,composite:ku},"line-dasharray":{source:fy,composite:fy}},g={color:{source:Ld,composite:Vc},number:{source:Yf,composite:Ld}};function w(u,o,l){const f=h[u];return f&&f[l]||g[o][l]}dn(dg,"ConstantBinder"),dn(rp,"PatternConstantBinder"),dn(Ru,"SourceExpressionBinder"),dn(vc,"PatternCompositeBinder"),dn(yc,"CompositeExpressionBinder"),dn(Nh,"ProgramConfiguration",{omit:["_buffers"]}),dn(zd,"ProgramConfigurationSet");const S=Kt/Math.PI/2,P=5,M=6,D=16383,j=64,W=[j,32,16],K=-S,Z=S;function ee(u,o,l,f=S){return l=ae(l),[u*Math.sin(l)*f,-o*f,u*Math.cos(l)*f]}function se(u,o,l){return ee(Math.cos(ae(u)),Math.sin(ae(u)),o,l)}const oe=63710088e-1,he=2*Math.PI*oe;class le{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new le(ft(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,f=this.lat*l,p=o.lat*l,y=Math.sin(f)*Math.sin(p)+Math.cos(f)*Math.cos(p)*Math.cos((o.lng-this.lng)*l);return oe*Math.acos(Math.min(y,1))}toBounds(o=0){const l=360*o/40075017,f=l/Math.cos(Math.PI/180*this.lat);return new xe({lng:this.lng-f,lat:this.lat-l},{lng:this.lng+f,lat:this.lat+l})}toEcef(o){return se(this.lat,this.lng,S+o*S/oe)}static convert(o){if(o instanceof le)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new le(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new le(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class xe{constructor(o,l){if(o)if(l)this.setSouthWest(o).setNorthEast(l);else if(o.length===4){const f=o;this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]])}else{const f=o;this.setSouthWest(f[0]).setNorthEast(f[1])}}setNorthEast(o){return this._ne=o instanceof le?new le(o.lng,o.lat):le.convert(o),this}setSouthWest(o){return this._sw=o instanceof le?new le(o.lng,o.lat):le.convert(o),this}extend(o){const l=this._sw,f=this._ne;let p,y;if(o instanceof le)p=o,y=o;else{if(!(o instanceof xe))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(xe.convert(o)):this.extend(le.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(le.convert(o)):this;if(p=o._sw,y=o._ne,!p||!y)return this}return l||f?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),f.lng=Math.max(y.lng,f.lng),f.lat=Math.max(y.lat,f.lat)):(this._sw=new le(p.lng,p.lat),this._ne=new le(y.lng,y.lat)),this}getCenter(){return new le((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new le(this.getWest(),this.getNorth())}getSouthEast(){return new le(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:f}=le.convert(o);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&p}static convert(o){if(o)return o instanceof xe?o:new xe(o)}}const Te=0,Pe=25.5;function ze(u){return he*Math.cos(u*Math.PI/180)}function ke(u){return(180+u)/360}function Re(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Ie(u,o){return u/ze(o)}function Ve(u){return 360*u-180}function Ge(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function ht(u,o){return u*ze(Ge(o))}const et=85.051129;function Et(u){return Math.cos(ae($e(u,-et,et)))}function wt(u,o){const l=$e(o,Te,Pe),f=Math.pow(2,l);return Et(u)*he/(512*f)}function qt(u){return 1/Math.cos(u*Math.PI/180)}function tt(u,o=0){const l=Math.exp(Math.PI*(1-(u.y+o/Kt)/(1<<u.z)*2));return 80150034*l/(l*l+1)/Kt/(1<<u.z)}class dt{constructor(o,l,f=0){this.x=+o,this.y=+l,this.z=+f}static fromLngLat(o,l=0){const f=le.convert(o);return new dt(ke(f.lng),Re(f.lat),Ie(l,f.lat))}toLngLat(){return new le(Ve(this.x),Ge(this.y))}toAltitude(){return ht(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/he*qt(Ge(this.y))}}function Je(u,o,l,f,p,y,v,E,C){const O=(o+f)/2,z=(l+p)/2,F=new Tt(O,z);E(F),function($,Y,J,re,ce,de){const we=J-ce,ve=re-de;return Math.abs((re-Y)*we-(J-$)*ve)/Math.hypot(we,ve)}(F.x,F.y,y.x,y.y,v.x,v.y)>=C?(Je(u,o,l,O,z,y,F,E,C),Je(u,O,z,f,p,F,v,E,C)):u.push(v)}function It(u,o,l){let f=u[0],p=f.x,y=f.y;o(f);const v=[f];for(let E=1;E<u.length;E++){const C=u[E],{x:O,y:z}=C;o(C),Je(v,p,y,O,z,f,C,o,l),p=O,y=z,f=C}return v}function gt(u,o,l,f){if(f(o,l)){const p=o.add(l)._mult(.5);gt(u,o,p,f),gt(u,p,l,f)}else u.push(l)}function Lt(u,o){let l=u[0];const f=[l];for(let p=1;p<u.length;p++){const y=u[p];gt(f,l,y,o),l=y}return f}const At=Math.pow(2,14)-1,zt=-At-1;function Ft(u,o){const l=Math.round(u.x*o),f=Math.round(u.y*o);return u.x=$e(l,zt,At),u.y=$e(f,zt,At),(l<u.x||l>u.x+1||f<u.y||f>u.y+1)&&mr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function gn(u,o,l){const f=u.loadGeometry(),p=u.extent,y=Kt/p;if(o&&l&&l.projection.isReprojectedInTileSpace){const v=1<<o.z,{scale:E,x:C,y:O,projection:z}=l,F=$=>{const Y=Ve((o.x+$.x/p)/v),J=Ge((o.y+$.y/p)/v),re=z.project(Y,J);$.x=(re.x*E-C)*p,$.y=(re.y*E-O)*p};for(let $=0;$<f.length;$++)if(u.type!==1)f[$]=It(f[$],F,1);else{const Y=[];for(const J of f[$])J.x<0||J.x>=p||J.y<0||J.y>=p||(F(J),Y.push(J));f[$]=Y}}for(const v of f)for(const E of v)Ft(E,y);return f}function En(u,o){return{type:u.type,id:u.id,properties:u.properties,geometry:o?gn(u):[]}}function fn(u,o,l,f,p){u.emplaceBack(2*o+(f+1)/2,2*l+(p+1)/2)}function Pn(u,o,l){u.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class yn{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Ou,this.indexArray=new ia,this.segments=new qi,this.programConfigurations=new zd(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(o,l){}populate(o,l,f,p){const y=this.layers[0],v=[];let E=null;y.type==="circle"&&(E=y.layout.get("circle-sort-key"));for(const{feature:O,id:z,index:F,sourceLayerIndex:$}of o){const Y=this.layers[0]._featureFilter.needGeometry,J=En(O,Y);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),J,f))continue;const re=E?E.evaluate(J,{},f):void 0,ce={id:z,properties:O.properties,type:O.type,sourceLayerIndex:$,index:F,geometry:Y?J.geometry:gn(O,f,p),patterns:{},sortKey:re};v.push(ce)}E&&v.sort((O,z)=>O.sortKey-z.sortKey);let C=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Dd,C=p.projection);for(const O of v){const{geometry:z,index:F,sourceLayerIndex:$}=O,Y=o[F].feature;this.addFeature(O,z,F,l.availableImages,f,C,l.brightness),l.featureIndex.insert(Y,z,F,$,this.index)}}update(o,l,f,p,y,v,E){this.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,pM.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,mM.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,f,p,y,v,E){for(const C of l)for(const O of C){const z=O.x,F=O.y;if(z<0||z>=Kt||F<0||F>=Kt)continue;if(v){const J=v.projectTilePoint(z,F,y),re=v.upVector(y,z,F),ce=this.globeExtVertexArray;Pn(ce,J,re),Pn(ce,J,re),Pn(ce,J,re),Pn(ce,J,re)}const $=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),Y=$.vertexLength;fn(this.layoutVertexArray,z,F,-1,-1),fn(this.layoutVertexArray,z,F,1,-1),fn(this.layoutVertexArray,z,F,1,1),fn(this.layoutVertexArray,z,F,-1,1),this.indexArray.emplaceBack(Y,Y+1,Y+2),this.indexArray.emplaceBack(Y,Y+2,Y+3),$.vertexLength+=4,$.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},p,y,E)}}function Nn(u,o){for(let l=0;l<u.length;l++)if(ai(o,u[l]))return!0;for(let l=0;l<o.length;l++)if(ai(u,o[l]))return!0;return!!Qr(u,o)}function Xn(u,o,l){return!!ai(u,o)||!!tr(o,u,l)}function yr(u,o){if(u.length===1)return Lr(o,u[0]);for(let l=0;l<o.length;l++){const f=o[l];for(let p=0;p<f.length;p++)if(ai(u,f[p]))return!0}for(let l=0;l<u.length;l++)if(Lr(o,u[l]))return!0;for(let l=0;l<o.length;l++)if(Qr(u,o[l]))return!0;return!1}function oi(u,o,l){if(u.length>1){if(Qr(u,o))return!0;for(let f=0;f<o.length;f++)if(tr(o[f],u,l))return!0}for(let f=0;f<u.length;f++)if(tr(u[f],o,l))return!0;return!1}function Qr(u,o){if(u.length===0||o.length===0)return!1;for(let l=0;l<u.length-1;l++){const f=u[l],p=u[l+1];for(let y=0;y<o.length-1;y++)if(br(f,p,o[y],o[y+1]))return!0}return!1}function br(u,o,l,f){return ui(u,l,f)!==ui(o,l,f)&&ui(u,o,l)!==ui(u,o,f)}function Ji(u,o,l){return(u.x-l.x)*(o.y-l.y)-(u.y-l.y)*(o.x-l.x)}function Hi(u,o,l,f){const p=Ji(u,o,f),y=Ji(u,o,l);if(Math.sign(p)===Math.sign(y))return;const v=Ji(l,f,u),E=v+y-p;return Math.sign(v)!==Math.sign(E)?[v/(v-E),y/(y-p)]:void 0}function tr(u,o,l){const f=l*l;if(o.length===1)return u.distSqr(o[0])<f;for(let p=1;p<o.length;p++)if(Mr(u,o[p-1],o[p])<f)return!0;return!1}function Mr(u,o,l){const f=o.distSqr(l);if(f===0)return u.distSqr(o);const p=((u.x-o.x)*(l.x-o.x)+(u.y-o.y)*(l.y-o.y))/f;return u.distSqr(p<0?o:p>1?l:l.sub(o)._mult(p)._add(o))}function Lr(u,o){let l,f,p,y=!1;for(let v=0;v<u.length;v++){l=u[v];for(let E=0,C=l.length-1;E<l.length;C=E++)f=l[E],p=l[C],f.y>o.y!=p.y>o.y&&o.x<(p.x-f.x)*(o.y-f.y)/(p.y-f.y)+f.x&&(y=!y)}return y}function ai(u,o){let l=!1;for(let f=0,p=u.length-1;f<u.length;p=f++){const y=u[f],v=u[p];y.y>o.y!=v.y>o.y&&o.x<(v.x-y.x)*(o.y-y.y)/(v.y-y.y)+y.x&&(l=!l)}return l}function Ao(u,o,l,f,p){for(const v of u)if(o<=v.x&&l<=v.y&&f>=v.x&&p>=v.y)return!0;const y=[new Tt(o,l),new Tt(o,p),new Tt(f,p),new Tt(f,l)];if(u.length>2){for(const v of y)if(ai(u,v))return!0}for(let v=0;v<u.length-1;v++)if(oo(u[v],u[v+1],y))return!0;return!1}function oo(u,o,l){const f=l[0],p=l[2];if(u.x<f.x&&o.x<f.x||u.x>p.x&&o.x>p.x||u.y<f.y&&o.y<f.y||u.y>p.y&&o.y>p.y)return!1;const y=ui(u,o,l[0]);return y!==ui(u,o,l[1])||y!==ui(u,o,l[2])||y!==ui(u,o,l[3])}function So(u,o,l,f,p,y){let v=o.y-u.y,E=u.x-o.x;if(y=y||0){const C=v*v+E*E;if(C===0)return!0;const O=Math.sqrt(C);v/=O,E/=O}return!((l.x-u.x)*v+(l.y-u.y)*E-y<0||(f.x-u.x)*v+(f.y-u.y)*E-y<0||(p.x-u.x)*v+(p.y-u.y)*E-y<0)}function ji(u,o,l,f,p,y,v){return!(So(u,o,f,p,y,v)||So(o,l,f,p,y,v)||So(l,u,f,p,y,v)||So(f,p,u,o,l,v)||So(p,y,u,o,l,v)||So(y,f,u,o,l,v))}function sr(u,o,l){const f=o.paint.get(u).value;return f.kind==="constant"?f.value:l.programConfigurations.get(o.id).getMaxValue(u)}function Ri(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Rr(u,o,l,f,p){if(!o[0]&&!o[1])return u;const y=Tt.convert(o)._mult(p);l==="viewport"&&y._rotate(-f);const v=[];for(let E=0;E<u.length;E++)v.push(u[E].sub(y));return v}function Di(u,o,l,f){const p=Tt.convert(u)._mult(f);return o==="viewport"&&p._rotate(-l),p}let jr,$i;function oa(u,o,l){var f=2*Math.PI*6378137/256/Math.pow(2,l);return[u*f-2*Math.PI*6378137/2,o*f-2*Math.PI*6378137/2]}dn(yn,"CircleBucket",{omit:["layers"]});class Ai{constructor(o,l,f){this.z=o,this.x=l,this.y=f,this.key=za(0,o,o,l,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const f=function(y,v,E){var C=oa(256*y,256*(v=Math.pow(2,E)-v-1),E),O=oa(256*(y+1),256*(v+1),E);return C[0]+","+C[1]+","+O[0]+","+O[1]}(this.x,this.y,this.z),p=function(y,v,E){let C,O="";for(let z=y;z>0;z--)C=1<<z-1,O+=(v&C?1:0)+(E&C?2:0);return O}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xa{constructor(o,l){this.wrap=o,this.canonical=l,this.key=za(o,l.z,l.z,l.x,l.y)}}class mo{constructor(o,l,f,p,y){this.overscaledZ=o,this.wrap=l,this.canonical=new Ai(f,+p,+y),this.key=l===0&&o===f?this.canonical.key:za(l,o,f,p,y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new mo(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mo(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return za(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return za(this.wrap*+l,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new mo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,f=2*this.canonical.x,p=2*this.canonical.y;return[new mo(l,this.wrap,l,f,p),new mo(l,this.wrap,l,f+1,p),new mo(l,this.wrap,l,f,p+1),new mo(l,this.wrap,l,f+1,p+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new mo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new mo(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xa(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function za(u,o,l,f,p){const y=1<<Math.min(l,22);let v=y*(p%y)+f%y;return u&&l<22&&(v+=y*y*((u<0?-2*u-1:2*u)%(1<<2*(22-l)))),16*(32*v+l)+(o-l)}const xc=[u=>{let o=u.canonical.x-1,l=u.wrap;return o<0&&(o=(1<<u.canonical.z)-1,l--),new mo(u.overscaledZ,l,u.canonical.z,o,u.canonical.y)},u=>{let o=u.canonical.x+1,l=u.wrap;return o===1<<u.canonical.z&&(o=0,l++),new mo(u.overscaledZ,l,u.canonical.z,o,u.canonical.y)},u=>new mo(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new mo(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];dn(Ai,"CanonicalTileID"),dn(mo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Du=zr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Vs}=Du,Fl=zr([{name:"a_pos_3",components:3,type:"Int16"}]);var Gc=zr([{name:"a_pos",type:"Int16",components:2}]);class Hc{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,f){const p=ci(l,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1])/p;return f[0]=this.pos[0]+this.dir[0]*y,f[1]=this.pos[1]+this.dir[1]*y,!0}}class bc{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,f){const p=sn(l,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/p;return f[0]=this.pos[0]+this.dir[0]*y,f[1]=this.pos[1]+this.dir[1]*y,f[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(o,l,f){if(function(Y,J){var re=Y[0],ce=Y[1],de=Y[2],we=J[0],ve=J[1],ie=J[2];return Math.abs(re-we)<=_*Math.max(1,Math.abs(re),Math.abs(we))&&Math.abs(ce-ve)<=_*Math.max(1,Math.abs(ce),Math.abs(ve))&&Math.abs(de-ie)<=_*Math.max(1,Math.abs(de),Math.abs(ie))}(this.pos,o)||l===0)return f[0]=f[1]=f[2]=0,!1;const[p,y,v]=this.dir,E=this.pos[0]-o[0],C=this.pos[1]-o[1],O=this.pos[2]-o[2],z=p*p+y*y+v*v,F=2*(E*p+C*y+O*v),$=F*F-4*z*(E*E+C*C+O*O-l*l);if($<0){const Y=Math.max(-F/2,0),J=E+p*Y,re=C+y*Y,ce=O+v*Y,de=Math.hypot(J,re,ce);return f[0]=J*l/de,f[1]=re*l/de,f[2]=ce*l/de,!1}{const Y=(-F-Math.sqrt($))/(2*z);if(Y<0){const J=Math.hypot(E,C,O);return f[0]=E*l/J,f[1]=C*l/J,f[2]=O*l/J,!1}return f[0]=E+p*Y,f[1]=C+y*Y,f[2]=O+v*Y,!0}}}class ip{constructor(o,l,f,p,y){this.TL=o,this.TR=l,this.BR=f,this.BL=p,this.horizon=y}static fromInvProjectionMatrix(o,l,f){const p=[-1,1,1],y=[1,1,1],v=[1,-1,1],E=[-1,-1,1],C=Gt(p,p,o),O=Gt(y,y,o),z=Gt(v,v,o),F=Gt(E,E,o);return new ip(C,O,z,F,l/f)}}function Nd(u,o,l){let f=1/0,p=-1/0;const y=[];for(const v of u){In(y,v,o);const E=sn(y,l);f=Math.min(f,E),p=Math.max(p,E)}return[f,p]}function by(u,o){let l=!0;for(let f=0;f<u.planes.length;f++){const p=u.planes[f];let y=0;for(let v=0;v<o.length;v++)y+=sn(p,o[v])+p[3]>=0;if(y===0)return 0;y!==o.length&&(l=!1)}return l?2:1}function wy(u,o){for(const l of u.projections){const f=Nd(o,u.points[0],l.axis);if(l.projection[1]<f[0]||l.projection[0]>f[1])return 0}return 1}function Sy(u,o){let l=0;const f=[0,0,0,0];for(let v=0;v<u.length;v++)f[0]=u[v][0],f[1]=u[v][1],f[2]=u[v][2],f[3]=1,(p=f)[0]*(y=o)[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3]>=0&&l++;var p,y;return l}class fg{constructor(o,l){this.points=o||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=Li.fromPoints(this.points),this.projections=[],this.frustumEdges=[In([],this.points[2],this.points[3]),In([],this.points[0],this.points[3]),In([],this.points[4],this.points[0]),In([],this.points[5],this.points[1]),In([],this.points[6],this.points[2]),In([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const p=[0,-f[2],f[1]],y=[f[2],0,-f[0]];this.projections.push({axis:p,projection:Nd(this.points,this.points[0],p)}),this.projections.push({axis:y,projection:Nd(this.points,this.points[0],y)})}}static fromInvProjectionMatrix(o,l,f,p){const y=Math.pow(2,f),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const z=Pt([],O,o),F=1/z[3]/l*y;return($=z)[0]=(Y=z)[0]*(J=[F,F,p?1/z[3]:F,F])[0],$[1]=Y[1]*J[1],$[2]=Y[2]*J[2],$[3]=Y[3]*J[3],$;var $,Y,J}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const z=en([],Vt([],In([],v[O[0]],v[O[1]]),In([],v[O[2]],v[O[1]]))),F=-sn(z,v[O[1]]);return z.concat(F)}),C=[];for(let O=0;O<v.length;O++)C.push([v[O][0],v[O][1],v[O][2]]);return new fg(C,E)}intersectsPrecise(o,l,f){for(let p=0;p<l.length;p++)if(!Sy(o,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!Sy(o,this.planes[p]))return 0;for(const p of f)for(const y of this.frustumEdges){const v=Vt([],p,y),E=Ze(v);if(E===0)continue;at(v,v,1/E);const C=Nd(this.points,this.points[0],v),O=Nd(o,this.points[0],v);if(C[0]>O[1]||O[0]>C[1])return 0}return 1}containsPoint(o){for(const l of this.planes){const f=l[3];if(sn([l[0],l[1],l[2]],o)+f<0)return!1}return!0}}class Li{static fromPoints(o){const l=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const p of o)Be(l,l,p),nt(f,f,p);return new Li(l,f)}static fromTileIdAndHeight(o,l,f){const p=1<<o.canonical.z,y=o.canonical.x,v=o.canonical.y;return new Li([y/p,v/p,l],[(y+1)/p,(v+1)/p,f])}static applyTransform(o,l){const f=o.getCorners();for(let p=0;p<f.length;++p)Gt(f[p],f[p],l);return Li.fromPoints(f)}static applyTransformFast(o,l){const f=[l[12],l[13],l[14]],p=[...f];for(let y=0;y<3;y++)for(let v=0;v<3;v++){const E=l[4*v+y],C=E*o.min[v],O=E*o.max[v];f[y]+=Math.min(C,O),p[y]+=Math.max(C,O)}return new Li(f,p)}static projectAabbCorners(o,l){const f=o.getCorners();for(let p=0;p<f.length;++p)Gt(f[p],f[p],l);return f}constructor(o,l){this.min=o,this.max=l,this.center=at([],ct([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],f=Le(this.min),p=Le(this.max);for(let y=0;y<l.length;y++)f[y]=l[y]?this.min[y]:this.center[y],p[y]=l[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new Li(f,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?by(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?by(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,l){return l||this.intersects(o)?wy(o,this.getCorners()):0}intersectsPreciseFlat(o,l){return l||this.intersectsFlat(o)?wy(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let l=0;l<3;++l)if(this.min[l]>o.max[l]||o.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o.min[l]),this.max[l]=Math.max(this.max[l],o.max[l])}encapsulatePoint(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o[l]),this.max[l]=Math.max(this.max[l],o[l])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function op(u){return u*S/oe}dn(Li,"Aabb");const qx=[new Li([K,K,K],[Z,Z,Z]),new Li([K,K,K],[0,0,Z]),new Li([0,K,K],[Z,0,Z]),new Li([K,0,K],[0,Z,Z]),new Li([0,0,K],[Z,Z,Z])];function LB(u,o,l,f=!0){const p=at([],u._camera.position,u.worldSize),y=[o,l,1,1];Pt(y,y,u.pixelMatrixInverse),Vr(y,y,1/y[3]);const v=en([],In([],y,p)),E=u.globeMatrix,C=[E[12],E[13],E[14]],O=In([],C,p),z=Ze(O),F=en([],O),$=u.worldSize/(2*Math.PI),Y=sn(F,v),J=Math.asin($/z);if(J<Math.acos(Y)){if(!f)return null;const Ke=[],Qe=[];at(Ke,v,z/Y),en(Qe,In(Qe,Ke,O)),en(v,ct(v,O,at(v,Qe,Math.tan(J)*z)))}const re=[];new bc(p,v).closestPointOnSphere(C,$,re);const ce=en([],jo(E,0)),de=en([],jo(E,1)),we=en([],jo(E,2)),ve=sn(ce,re),ie=sn(de,re),ge=sn(we,re),be=me(Math.asin(-ie/$));let Ee=me(Math.atan2(ve,ge));Ee=u.center.lng+function(Ke,Qe){const xt=(Qe-Ke+180)%360-180;return xt<-180?xt+360:xt}(u.center.lng,Ee);const Ue=ke(Ee),qe=$e(Re(be),0,1);return new dt(Ue,qe)}class rie{constructor(o,l,f){this.a=In([],o,f),this.b=In([],l,f),this.center=f;const p=en([],this.a),y=en([],this.b);this.angle=Math.acos(sn(p,y))}}function vM(u,o){if(u.angle===0)return null;let l;return l=u.a[o]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[o]/u.a[o]/Math.sin(u.angle)-1/Math.tan(u.angle)),l<0||l>1?null:function(f,p,y,v){const E=Math.sin(y);return f*(Math.sin((1-v)*y)/E)+p*(Math.sin(v*y)/E)}(u.a[o],u.b[o],u.angle,$e(l,0,1))+u.center[o]}function Fh(u){if(u.z<=1)return qx[u.z+2*u.y+u.x];const o=xM(MT(u));return Li.fromPoints(o)}function Fd(u,o,l){return at(u,u,1-l),Mt(u,u,o,l)}function zB(u,o,l){for(const f of u)Gt(f,f,o),at(f,f,l)}function NB(u,o,l,f){const p=o/u.worldSize,y=u.globeMatrix;if(l.z<=1){const qe=Fh(l).getCorners();return zB(qe,y,p),Li.fromPoints(qe)}const v=MT(l,f),E=xM(v,S+op(u._tileCoverLift));zB(E,y,p);const C=Number.MAX_VALUE,O=[-C,-C,-C],z=[C,C,C];if(v.contains(u.center)){for(const Qe of E)Be(z,z,Qe),nt(O,O,Qe);O[2]=0;const qe=u.point,Ke=[qe.x*p,qe.y*p,0];return Be(z,z,Ke),nt(O,O,Ke),new Li(z,O)}if(u._tileCoverLift>0){for(const qe of E)Be(z,z,qe),nt(O,O,qe);return new Li(z,O)}const F=[y[12]*p,y[13]*p,y[14]*p],$=v.getCenter(),Y=$e(u.center.lat,-et,et),J=$e($.lat,-et,et),re=ke(u.center.lng),ce=Re(Y);let de=re-ke($.lng);const we=ce-Re(J);de>.5?de-=1:de<-.5&&(de+=1);let ve=0;Math.abs(de)>Math.abs(we)?ve=de>=0?1:3:(ve=we>=0?0:2,Mt(F,F,[y[4]*p,y[5]*p,y[6]*p],-Math.sin(ae(we>=0?v.getSouth():v.getNorth()))*S));const ie=E[ve],ge=E[(ve+1)%4],be=new rie(ie,ge,F),Ee=[vM(be,0)||ie[0],vM(be,1)||ie[1],vM(be,2)||ie[2]],Ue=ap(u.zoom);if(Ue>0){const qe=function({x:Qe,y:xt,z:Dt},Ct,kt,Bt,_t){const Ot=1/(1<<Dt);let pt=Qe*Ot,vt=pt+Ot,Ut=xt*Ot,Wt=Ut+Ot,Sn=0;const mn=(pt+vt)/2-Bt;return mn>.5?Sn=-1:mn<-.5&&(Sn=1),pt=((pt+Sn)*Ct-(Bt*=Ct))*kt+Bt,vt=((vt+Sn)*Ct-Bt)*kt+Bt,Ut=(Ut*Ct-(_t*=Ct))*kt+_t,Wt=(Wt*Ct-_t)*kt+_t,[[pt,Wt,0],[vt,Wt,0],[vt,Ut,0],[pt,Ut,0]]}(l,o,u._pixelsPerMercatorPixel,re,ce);for(let Qe=0;Qe<E.length;Qe++)Fd(E[Qe],qe[Qe],Ue);const Ke=ct([],qe[ve],qe[(ve+1)%4]);at(Ke,Ke,.5),Fd(Ee,Ke,Ue)}for(const qe of E)Be(z,z,qe),nt(O,O,qe);return z[2]=Math.min(ie[2],ge[2]),Be(z,z,Ee),nt(O,O,Ee),new Li(z,O)}function MT({x:u,y:o,z:l},f=!1){const p=1/(1<<l),y=new le(Ve(u*p),o===(1<<l)-1&&f?-90:Ge((o+1)*p)),v=new le(Ve((u+1)*p),o===0&&f?90:Ge(o*p));return new xe(y,v)}function xM(u,o=S){const l=ae(u.getNorth()),f=ae(u.getSouth()),p=Math.cos(l),y=Math.cos(f),v=Math.sin(l),E=Math.sin(f),C=u.getWest(),O=u.getEast();return[ee(y,E,C,o),ee(y,E,O,o),ee(p,v,O,o),ee(p,v,C,o)]}function Zx(u,o,l,f){const p=1<<l.z,y=(u/Kt+l.x)/p;return se(Ge((o/Kt+l.y)/p),Ve(y),f)}function OT({min:u,max:o}){return D/Math.max(o[0]-u[0],o[1]-u[1],o[2]-u[2])}const FB=new Float64Array(16);function kT(u){const o=OT(u),l=fe(FB,[o,o,o]);return G(l,l,un([],u.min))}function bM(u){const o=(f=u.min,(l=FB)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=f[0],l[13]=f[1],l[14]=f[2],l[15]=1,l);var l,f;const p=1/OT(u);return q(o,o,[p,p,p])}function wM(u){const o=Kt/(2*Math.PI);return u/(2*Math.PI)/o}function BB(u,o){return Kt/(512*Math.pow(2,u))*OT(Fh(o))}function jB(u,o,l,f,p){const y=wM(l),v=[u,o,-l/(2*Math.PI)],E=N(new Float64Array(16));return G(E,E,v),q(E,E,[y,y,y]),Q(E,E,ae(-p)),te(E,E,ae(-f)),E}function ap(u){return Ye(P,M,u)}function $B(u,o){const l=se(o.lat,o.lng),f=function(J){const re=se(J._center.lat,J._center.lng);let ce=Vt([],He(0,1,0),re);const de=ye([],-J.angle,re);ce=Gt(ce,ce,de),ye(de,-J._pitch,ce);const we=en([],re);return at(we,we,op(J.cameraToCenterDistance/J.pixelsPerMeter)),Gt(we,we,de),ct([],re,we)}(u);return v=(p=ot([],f,l))[0],E=p[1],C=p[2],O=(y=l)[0],z=y[1],F=y[2],Y=($=Math.sqrt(v*v+E*E+C*C)*Math.sqrt(O*O+z*z+F*F))&&sn(p,y)/$,Math.acos(Math.min(Math.max(Y,-1),1));var p,y,v,E,C,O,z,F,$,Y}function SM(u,o){return $B(u,o)>Math.PI/2*1.01}const UB=ae(85),iie=Math.cos(UB),oie=Math.sin(UB),aie=B(),VB=u=>{const o=[];return u.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function WB(u,o,l,f,p,y,v,E,C){if(y&&u.queryGeometry.isAboveHorizon)return!1;y&&(C*=u.pixelToTileUnitsFactor);const O=u.tileID.canonical,z=l.projection.upVectorScale(O,l.center.lat,l.worldSize).metersToTile;for(const F of o)for(const $ of F){const Y=$.add(E),J=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(Y.x,Y.y,!0):0,re=l.projection.projectTilePoint(Y.x,Y.y,O);if(J>0){const ve=l.projection.upVector(O,Y.x,Y.y);re.x+=ve[0]*z*J,re.y+=ve[1]*z*J,re.z+=ve[2]*z*J}const ce=y?Y:sie(re.x,re.y,re.z,f),de=y?u.tilespaceRays.map(ve=>cie(ve,J)):u.queryGeometry.screenGeometry,we=Pt([],[re.x,re.y,re.z,1],f);if(!v&&y?C*=we[3]/l.cameraToCenterDistance:v&&!y&&(C*=l.cameraToCenterDistance/we[3]),y){const ve=Ge(($.y/Kt+O.y)/(1<<O.z));C/=l.projection.pixelsPerMeter(ve,1)/Ie(1,ve)}if(Xn(de,ce,C))return!0}return!1}function sie(u,o,l,f){const p=Pt([],[u,o,l,1],f);return new Tt(p[0]/p[3],p[1]/p[3])}const GB=He(0,0,0),lie=He(0,0,1);function cie(u,o){const l=Fe();return GB[2]=o,u.intersectsPlane(GB,lie,l),new Tt(l[0],l[1])}class HB extends yn{}let qB,ZB,XB,KB;function YB(u,{width:o,height:l},f,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==o*l*f)throw new RangeError("mismatched image size")}else p=new Uint8Array(o*l*f);return u.width=o,u.height=l,u.data=p,u}function JB(u,o,l){const{width:f,height:p}=o;f===u.width&&p===u.height||(TM(u,o,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,f),height:Math.min(u.height,p)},l,null),u.width=f,u.height=p,u.data=o.data)}function TM(u,o,l,f,p,y,v,E){if(p.width===0||p.height===0)return o;if(p.width>u.width||p.height>u.height||l.x>u.width-p.width||l.y>u.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>o.width||p.height>o.height||f.x>o.width-p.width||f.y>o.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const C=u.data,O=o.data,z=y===4&&E;for(let F=0;F<p.height;F++){const $=((l.y+F)*u.width+l.x)*y,Y=((f.y+F)*o.width+f.x)*y;if(z)for(let J=0;J<p.width;J++){const re=$+J*y+3,ce=Y+J*y;O[ce+0]=255,O[ce+1]=255,O[ce+2]=255,O[ce+3]=C[re]}else if(v)for(let J=0;J<p.width;J++){const re=$+J*y,ce=Y+J*y,de=C[re+3],we=new Dr(C[re+0]/255*de,C[re+1]/255*de,C[re+2]/255*de,de).toRenderColor(v).toArray();O[ce+0]=we[0],O[ce+1]=we[1],O[ce+2]=we[2],O[ce+3]=we[3]}else for(let J=0;J<p.width*y;J++)O[Y+J]=C[$+J]}return o}dn(HB,"HeatmapBucket",{omit:["layers"]});class sp{constructor(o,l){YB(this,o,1,l)}resize(o){JB(this,new sp(o),1)}clone(){return new sp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,f,p,y){TM(o,l,f,p,y,1,null)}}class Ha{constructor(o,l){YB(this,o,4,l)}resize(o){JB(this,new Ha(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,f,p,y,v,E){TM(o,l,f,p,y,4,v,E)}}class QB{constructor(o,l){this.width=o.width,this.height=o.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function Xx(u){const o={},l=u.resolution||256,f=u.clips?u.clips.length:1,p=u.image||new Ha({width:l,height:f}),y=(v,E,C)=>{o[u.evaluationKey]=C;const O=u.expression.evaluate(o);O&&(p.data[v+E+0]=Math.floor(255*O.r/O.a),p.data[v+E+1]=Math.floor(255*O.g/O.a),p.data[v+E+2]=Math.floor(255*O.b/O.a),p.data[v+E+3]=Math.floor(255*O.a))};if(u.clips)for(let v=0,E=0;v<f;++v,E+=4*l)for(let C=0,O=0;C<l;C++,O+=4){const z=C/(l-1),{start:F,end:$}=u.clips[v];y(E,O,F*(1-z)+$*z)}else for(let v=0,E=0;v<l;v++,E+=4)y(0,E,v/(l-1));return p}dn(sp,"AlphaImage"),dn(Ha,"RGBAImage");const uie=zr([{name:"a_pos",components:2,type:"Int16"}],4),hie=zr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),die=zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),fie=zr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Kx(u,o,l=2){const f=o&&o.length,p=f?o[0]*l:u.length;let y=ej(u,0,p,l,!0);const v=[];if(!y||y.next===y.prev)return v;let E,C,O;if(f&&(y=function(z,F,$,Y){const J=[];for(let re=0,ce=F.length;re<ce;re++){const de=ej(z,F[re]*Y,re<ce-1?F[re+1]*Y:z.length,Y,!1);de===de.next&&(de.steiner=!0),J.push(bie(de))}J.sort(yie);for(let re=0;re<J.length;re++)$=vie(J[re],$);return $}(u,o,y,l)),u.length>80*l){E=1/0,C=1/0;let z=-1/0,F=-1/0;for(let $=l;$<p;$+=l){const Y=u[$],J=u[$+1];Y<E&&(E=Y),J<C&&(C=J),Y>z&&(z=Y),J>F&&(F=J)}O=Math.max(z-E,F-C),O=O!==0?32767/O:0}return Yx(y,v,l,E,C,O,0),v}function ej(u,o,l,f,p){let y;if(p===function(v,E,C,O){let z=0;for(let F=E,$=C-O;F<C;F+=O)z+=(v[$]-v[F])*(v[F+1]+v[$+1]),$=F;return z}(u,o,l,f)>0)for(let v=o;v<l;v+=f)y=ij(v/f|0,u[v],u[v+1],y);else for(let v=l-f;v>=o;v-=f)y=ij(v/f|0,u[v],u[v+1],y);return y&&Ty(y,y.next)&&(e1(y),y=y.next),y}function pg(u,o){if(!u)return u;o||(o=u);let l,f=u;do if(l=!1,f.steiner||!Ty(f,f.next)&&aa(f.prev,f,f.next)!==0)f=f.next;else{if(e1(f),f=o=f.prev,f===f.next)break;l=!0}while(l||f!==o);return o}function Yx(u,o,l,f,p,y,v){if(!u)return;!v&&y&&function(C,O,z,F){let $=C;do $.z===0&&($.z=EM($.x,$.y,O,z,F)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==C);$.prevZ.nextZ=null,$.prevZ=null,function(Y){let J,re=1;do{let ce,de=Y;Y=null;let we=null;for(J=0;de;){J++;let ve=de,ie=0;for(let be=0;be<re&&(ie++,ve=ve.nextZ,ve);be++);let ge=re;for(;ie>0||ge>0&&ve;)ie!==0&&(ge===0||!ve||de.z<=ve.z)?(ce=de,de=de.nextZ,ie--):(ce=ve,ve=ve.nextZ,ge--),we?we.nextZ=ce:Y=ce,ce.prevZ=we,we=ce;de=ve}we.nextZ=null,re*=2}while(J>1)}($)}(u,f,p,y);let E=u;for(;u.prev!==u.next;){const C=u.prev,O=u.next;if(y?mie(u,f,p,y):pie(u))o.push(C.i,u.i,O.i),e1(u),u=O.next,E=O.next;else if((u=O)===E){v?v===1?Yx(u=gie(pg(u),o),o,l,f,p,y,2):v===2&&_ie(u,o,l,f,p,y):Yx(pg(u),o,l,f,p,y,1);break}}}function pie(u){const o=u.prev,l=u,f=u.next;if(aa(o,l,f)>=0)return!1;const p=o.x,y=l.x,v=f.x,E=o.y,C=l.y,O=f.y,z=Math.min(p,y,v),F=Math.min(E,C,O),$=Math.max(p,y,v),Y=Math.max(E,C,O);let J=f.next;for(;J!==o;){if(J.x>=z&&J.x<=$&&J.y>=F&&J.y<=Y&&Jx(p,E,y,C,v,O,J.x,J.y)&&aa(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function mie(u,o,l,f){const p=u.prev,y=u,v=u.next;if(aa(p,y,v)>=0)return!1;const E=p.x,C=y.x,O=v.x,z=p.y,F=y.y,$=v.y,Y=Math.min(E,C,O),J=Math.min(z,F,$),re=Math.max(E,C,O),ce=Math.max(z,F,$),de=EM(Y,J,o,l,f),we=EM(re,ce,o,l,f);let ve=u.prevZ,ie=u.nextZ;for(;ve&&ve.z>=de&&ie&&ie.z<=we;){if(ve.x>=Y&&ve.x<=re&&ve.y>=J&&ve.y<=ce&&ve!==p&&ve!==v&&Jx(E,z,C,F,O,$,ve.x,ve.y)&&aa(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,ie.x>=Y&&ie.x<=re&&ie.y>=J&&ie.y<=ce&&ie!==p&&ie!==v&&Jx(E,z,C,F,O,$,ie.x,ie.y)&&aa(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;ve&&ve.z>=de;){if(ve.x>=Y&&ve.x<=re&&ve.y>=J&&ve.y<=ce&&ve!==p&&ve!==v&&Jx(E,z,C,F,O,$,ve.x,ve.y)&&aa(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;ie&&ie.z<=we;){if(ie.x>=Y&&ie.x<=re&&ie.y>=J&&ie.y<=ce&&ie!==p&&ie!==v&&Jx(E,z,C,F,O,$,ie.x,ie.y)&&aa(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function gie(u,o){let l=u;do{const f=l.prev,p=l.next.next;!Ty(f,p)&&nj(f,l,l.next,p)&&Qx(f,p)&&Qx(p,f)&&(o.push(f.i,l.i,p.i),e1(l),e1(l.next),l=u=p),l=l.next}while(l!==u);return pg(l)}function _ie(u,o,l,f,p,y){let v=u;do{let E=v.next.next;for(;E!==v.prev;){if(v.i!==E.i&&wie(v,E)){let C=rj(v,E);return v=pg(v,v.next),C=pg(C,C.next),Yx(v,o,l,f,p,y,0),void Yx(C,o,l,f,p,y,0)}E=E.next}v=v.next}while(v!==u)}function yie(u,o){let l=u.x-o.x;return l===0&&(l=u.y-o.y,l===0)&&(l=(u.next.y-u.y)/(u.next.x-u.x)-(o.next.y-o.y)/(o.next.x-o.x)),l}function vie(u,o){const l=function(p,y){let v=y;const E=p.x,C=p.y;let O,z=-1/0;if(Ty(p,v))return v;do{if(Ty(p,v.next))return v.next;if(C<=v.y&&C>=v.next.y&&v.next.y!==v.y){const re=v.x+(C-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(re<=E&&re>z&&(z=re,O=v.x<v.next.x?v:v.next,re===E))return O}v=v.next}while(v!==y);if(!O)return null;const F=O,$=O.x,Y=O.y;let J=1/0;v=O;do{if(E>=v.x&&v.x>=$&&E!==v.x&&tj(C<Y?E:z,C,$,Y,C<Y?z:E,C,v.x,v.y)){const re=Math.abs(C-v.y)/(E-v.x);Qx(v,p)&&(re<J||re===J&&(v.x>O.x||v.x===O.x&&xie(O,v)))&&(O=v,J=re)}v=v.next}while(v!==F);return O}(u,o);if(!l)return o;const f=rj(l,u);return pg(f,f.next),pg(l,l.next)}function xie(u,o){return aa(u.prev,u,o.prev)<0&&aa(o.next,u,u.next)<0}function EM(u,o,l,f,p){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-l)*p|0)|u<<8))|u<<4))|u<<2))|u<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function bie(u){let o=u,l=u;do(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next;while(o!==u);return l}function tj(u,o,l,f,p,y,v,E){return(p-v)*(o-E)>=(u-v)*(y-E)&&(u-v)*(f-E)>=(l-v)*(o-E)&&(l-v)*(y-E)>=(p-v)*(f-E)}function Jx(u,o,l,f,p,y,v,E){return!(u===v&&o===E)&&tj(u,o,l,f,p,y,v,E)}function wie(u,o){return u.next.i!==o.i&&u.prev.i!==o.i&&!function(l,f){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==f.i&&p.next.i!==f.i&&nj(p,p.next,l,f))return!0;p=p.next}while(p!==l);return!1}(u,o)&&(Qx(u,o)&&Qx(o,u)&&function(l,f){let p=l,y=!1;const v=(l.x+f.x)/2,E=(l.y+f.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&v<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==l);return y}(u,o)&&(aa(u.prev,u,o.prev)||aa(u,o.prev,o))||Ty(u,o)&&aa(u.prev,u,u.next)>0&&aa(o.prev,o,o.next)>0)}function aa(u,o,l){return(o.y-u.y)*(l.x-o.x)-(o.x-u.x)*(l.y-o.y)}function Ty(u,o){return u.x===o.x&&u.y===o.y}function nj(u,o,l,f){const p=DT(aa(u,o,l)),y=DT(aa(u,o,f)),v=DT(aa(l,f,u)),E=DT(aa(l,f,o));return p!==y&&v!==E||!(p!==0||!RT(u,l,o))||!(y!==0||!RT(u,f,o))||!(v!==0||!RT(l,u,f))||!(E!==0||!RT(l,o,f))}function RT(u,o,l){return o.x<=Math.max(u.x,l.x)&&o.x>=Math.min(u.x,l.x)&&o.y<=Math.max(u.y,l.y)&&o.y>=Math.min(u.y,l.y)}function DT(u){return u>0?1:u<0?-1:0}function Qx(u,o){return aa(u.prev,u,u.next)<0?aa(u,o,u.next)>=0&&aa(u,u.prev,o)>=0:aa(u,o,u.prev)<0||aa(u,u.next,o)<0}function rj(u,o){const l=AM(u.i,u.x,u.y),f=AM(o.i,o.x,o.y),p=u.next,y=o.prev;return u.next=o,o.prev=u,l.next=p,p.prev=l,f.next=l,l.prev=f,y.next=f,f.prev=y,f}function ij(u,o,l,f){const p=AM(u,o,l);return f?(p.next=f.next,p.prev=f,f.next.prev=p,f.next=p):(p.prev=p,p.next=p),p}function e1(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function AM(u,o,l){return{i:u,x:o,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function LT(u,o){const l=u.length;if(l<=1)return[u];const f=[];let p,y;for(let v=0;v<l;v++){const E=Cr(u[v]);E!==0&&(u[v].area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(p&&f.push(p),p=[u[v]]):p.push(u[v]))}if(p&&f.push(p),o>1)for(let v=0;v<f.length;v++)f[v].length<=o||($c(f[v],o,1,f[v].length-1,Sie),f[v]=f[v].slice(0,o));return f}function Sie(u,o){return o.area-u.area}function oj(u,o,l=1){if(!u)return null;const f=typeof u=="string"?ka.from(u).getPrimary():u.getPrimary(),p=typeof u=="string"?null:u.getSecondary();for(const y of[f,p]){if(!y)continue;const v=y.id.toString();o.has(v)||o.set(v,[]),y.scaleSelf(l),o.get(v).push(y)}return{primary:f.toString(),secondary:p?p.toString():null}}function PM(u,o,l,f){const p=f.patternDependencies;let y=!1;for(const v of o){const E=v.paint.get(`${u}-pattern`);E.isConstant()||(y=!0),oj(E.constantOr(null),p,l)&&(y=!0)}return y}function CM(u,o,l,f,p,y){const v=y.patternDependencies;for(const E of o){const C=E.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let O=C.evaluate({zoom:f},l,{},y.availableImages);O=O&&O.name?O.name:O;const z=oj(O,v,p);if(!z)continue;const{primary:F,secondary:$}=z;F&&(l.patterns[E.id]=[F,$].filter(Boolean))}}return l}var IM,aj,MM,sj,OM,lj,cj,zT={};function uj(){if(aj)return IM;aj=1;var u=Cl();function o(p,y,v,E,C){this.properties={},this.extent=v,this.type=0,this._pbf=p,this._geometry=-1,this._keys=E,this._values=C,p.readFields(l,this,y)}function l(p,y,v){p==1?y.id=v.readVarint():p==2?function(E,C){for(var O=E.readVarint()+E.pos;E.pos<O;){var z=C._keys[E.readVarint()],F=C._values[E.readVarint()];C.properties[z]=F}}(v,y):p==3?y.type=v.readVarint():p==4&&(y._geometry=v.pos)}function f(p){for(var y,v,E=0,C=0,O=p.length,z=O-1;C<O;z=C++)E+=((v=p[z]).x-(y=p[C]).x)*(y.y+v.y);return E}return IM=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var y,v=p.readVarint()+p.pos,E=1,C=0,O=0,z=0,F=[];p.pos<v;){if(C<=0){var $=p.readVarint();E=7&$,C=$>>3}if(C--,E===1||E===2)O+=p.readSVarint(),z+=p.readSVarint(),E===1&&(y&&F.push(y),y=[]),y.push(new u(O,z));else{if(E!==7)throw new Error("unknown command "+E);y&&y.push(y[0].clone())}}return y&&F.push(y),F},o.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var y=p.readVarint()+p.pos,v=1,E=0,C=0,O=0,z=1/0,F=-1/0,$=1/0,Y=-1/0;p.pos<y;){if(E<=0){var J=p.readVarint();v=7&J,E=J>>3}if(E--,v===1||v===2)(C+=p.readSVarint())<z&&(z=C),C>F&&(F=C),(O+=p.readSVarint())<$&&($=O),O>Y&&(Y=O);else if(v!==7)throw new Error("unknown command "+v)}return[z,$,F,Y]},o.prototype.toGeoJSON=function(p,y,v){var E,C,O=this.extent*Math.pow(2,v),z=this.extent*p,F=this.extent*y,$=this.loadGeometry(),Y=o.types[this.type];function J(de){for(var we=0;we<de.length;we++){var ve=de[we];de[we]=[360*(ve.x+z)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(ve.y+F)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var re=[];for(E=0;E<$.length;E++)re[E]=$[E][0];J($=re);break;case 2:for(E=0;E<$.length;E++)J($[E]);break;case 3:for($=function(de){var we=de.length;if(we<=1)return[de];for(var ve,ie,ge=[],be=0;be<we;be++){var Ee=f(de[be]);Ee!==0&&(ie===void 0&&(ie=Ee<0),ie===Ee<0?(ve&&ge.push(ve),ve=[de[be]]):ve.push(de[be]))}return ve&&ge.push(ve),ge}($),E=0;E<$.length;E++)for(C=0;C<$[E].length;C++)J($[E][C])}$.length===1?$=$[0]:Y="Multi"+Y;var ce={type:"Feature",geometry:{type:Y,coordinates:$},properties:this.properties};return"id"in this&&(ce.id=this.id),ce},IM}function hj(){if(sj)return MM;sj=1;var u=uj();function o(f,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(l,this,p),this.length=this._features.length}function l(f,p,y){f===15?p.version=y.readVarint():f===1?p.name=y.readString():f===5?p.extent=y.readVarint():f===2?p._features.push(y.pos):f===3?p._keys.push(y.readString()):f===4&&p._values.push(function(v){for(var E=null,C=v.readVarint()+v.pos;v.pos<C;){var O=v.readVarint()>>3;E=O===1?v.readString():O===2?v.readFloat():O===3?v.readDouble():O===4?v.readVarint64():O===5?v.readVarint():O===6?v.readSVarint():O===7?v.readBoolean():null}return E}(y))}return MM=o,o.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var p=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,p,this.extent,this._keys,this._values)},MM}function dj(){return cj||(cj=1,zT.VectorTile=function(){if(lj)return OM;lj=1;var u=hj();function o(l,f,p){if(l===3){var y=new u(p,p.readVarint()+p.pos);y.length&&(f[y.name]=y)}}return OM=function(l,f){this.layers=l.readFields(o,{},f)},OM}(),zT.VectorTileFeature=uj(),zT.VectorTileLayer=hj()),zT}var lp=dj();const mg="3d_elevation_id",fj="level";class Tie{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,l){return this._valid&&o(l(this._geometry)),this}require(o,l,f){return this.get(o,!0,l,f)}optional(o,l,f){return this.get(o,!1,l,f)}success(){return this._valid}get(o,l,f,p){const y=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&y!==void 0&&!Number.isNaN(y)?f(p?p(y):y):l&&(this._valid=!1),this}}class pj{constructor(o,l){this.featureFunc=o,this.vertexFunc=l}parseFeature(o,l,f){return this.featureFunc(o,l,f)}parseVertex(o,l,f){return this.vertexFunc(o,l,f)}}const Eie=new pj((u,o,l)=>u.reset(o).require(mg,f=>{l.id=f}).optional("fixed_height_relative",f=>{l.constantHeight=f},gg.decodeRelativeHeight).geometry(f=>{l.bounds=f},yd).success(),(u,o,l)=>u.reset(o).require(mg,f=>{l.id=f}).require("elevation_idx",f=>{l.idx=f}).require("extent",f=>{l.extent=f}).require("height_relative",f=>{l.height=f},gg.decodeRelativeHeight).geometry(f=>{l.position=f},gg.getPoint).success()),Aie=new pj((u,o,l)=>u.reset(o).require(mg,f=>{l.id=f}).optional("fixed_height",f=>{l.constantHeight=f},gg.decodeMetricHeight).geometry(f=>{l.bounds=f},yd).success(),(u,o,l)=>u.reset(o).require(mg,f=>{l.id=f}).require("elevation_idx",f=>{l.idx=f}).require("extent",f=>{l.extent=f}).require("height",f=>{l.height=f},gg.decodeMetricHeight).geometry(f=>{l.position=f},gg.getPoint).success());class gg{static getPoint(o){return ja(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){const l=[],f=[],p=o.length,y=new Tie;for(let E=0;E<p;E++){const C=o.feature(E),O=C.properties.hasOwnProperty("version")?String(C.properties.version):void 0,z=(v=O)?v==="1.0.1"?Aie:void 0:Eie;if(z===void 0){mr(`Unknown elevation feature version number ${O||"(unknown)"}`);continue}const F=C.properties.hasOwnProperty("type")?C.properties.type:void 0;if(F){if(lp.VectorTileFeature.types[C.type]==="Point"&&F==="curve_point"){const $={};z.parseVertex(y,C,$)&&l.push($)}else if(lp.VectorTileFeature.types[C.type]==="Polygon"&&F==="curve_meta"){const $={};z.parseFeature(y,C,$)&&f.push($)}}}var v;return{vertices:l,features:f}}}class mj{constructor(o,l){this.feature=o,this.metersToTile=l,this.index=0}get(){const o=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,f=l[1],p=-l[0],y=(o.extent+1)*this.metersToTile;return[new Tt(Math.trunc(o.position[0]+f*y),Math.trunc(o.position[1]+p*y)),new Tt(Math.trunc(o.position[0]-f*y),Math.trunc(o.position[1]-p*y))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class kM{constructor(o,l,f,p,y,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:f,max:f},this.safeArea=l,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=y,this.edges=this.edges.filter(E=>{return E.a<this.vertices.length&&E.b<this.vertices.length&&!((C=this.vertices[E.a].position)[0]===(O=this.vertices[E.b].position)[0]&&C[1]===O[1]);var C,O}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const E of this.vertices)this.vertexProps.push({dir:ja(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,E.height),this.heightRange.max=Math.max(this.heightRange.max,E.height);for(const E of this.edges){const C=this.vertices[E.a].position,O=this.vertices[E.b].position,z=fo(uo(),O,C),F=Ua(z),$=$a(uo(),z,1/F);this.edgeProps.push({vec:z,dir:$,len:F});const Y=this.vertexProps[E.a].dir,J=this.vertexProps[E.b].dir;Bo(Y,Y,$),Bo(J,J,$)}for(const E of this.vertexProps)E.dir[0]===0&&E.dir[1]===0||Es(E.dir,E.dir);this.tessellate(v)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(o);if(l==null)return 0;const[f,p]=l;return((y,v,E)=>(1-E)*y+E*v)(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,p)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let l=0,f=Number.POSITIVE_INFINITY,p=0;const y=ja(o.x,o.y);for(let v=0;v<this.edges.length;v++){const E=this.edges[v],C=this.edgeProps[v].dir,O=new Hc(y,this.edgeProps[v].dir),z=this.vertices[E.a].position,F=this.vertices[E.b].position,$=uo(),Y=uo(),J=O.intersectsPlane(z,this.vertexProps[E.a].dir,$),re=O.intersectsPlane(F,this.vertexProps[E.b].dir,Y);if(!J||!re)continue;const ce=fo(uo(),Y,$),de=fo(uo(),y,$),we=ci(ce,ce),ve=we>0?ci(de,ce)/we:0,ie=$e(ve,0,1),ge=Math.abs((ve-ie)*this.edgeProps[v].len),be=fo(uo(),y,z),Ee=ge+Math.abs(ci(be,ja(C[1],-C[0])));Ee<f&&(l=v,f=Ee,p=ie)}return[l,p]}tessellate(o){for(let l=this.edges.length-1;l>=0;--l){const f=this.edges[l].a,p=this.edges[l].b,{position:y,height:v,extent:E}=this.vertices[f],{position:C,height:O,extent:z}=this.vertices[p],F=this.vertexProps[f].dir,$=this.vertexProps[p].dir,Y=He(y[0]/o,y[1]/o,v),J=He(C[0]/o,C[1]/o,O),re=He(F[1],-F[0],0);at(re,re,E);const ce=He($[1],-$[0],0);if(at(ce,ce,z),this.distSqLines(He(Y[0]+.5*re[0],Y[1]+.5*re[1],Y[2]+.5*re[2]),He(J[0]-.5*ce[0],J[1]-.5*ce[1],J[2]-.5*ce[2]),He(Y[0]-.5*re[0],Y[1]-.5*re[1],Y[2]-.5*re[2]),He(J[0]+.5*ce[0],J[1]+.5*ce[1],J[2]+.5*ce[2]))<=.0025000000000000005)continue;const de=this.vertices.length,we=Bo(uo(),y,C);this.vertices.push({position:$a(we,we,.5),height:.5*(v+O),extent:.5*(E+z)});const ve=Bo(uo(),F,$);this.vertexProps.push({dir:Es(ve,ve)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:f,b:de}),this.edges.push({a:de,b:p});const ie=fo(uo(),this.vertices[de].position,y),ge=Ua(ie),be={vec:ie,dir:$a(uo(),ie,1/ge),len:ge};this.edgeProps.push(be),this.edgeProps.push(be)}}distSqLines(o,l,f,p){const y=ot(Fe(),l,o),v=ot(Fe(),p,f),E=ot(Fe(),o,f),C=sn(y,y),O=sn(y,v),z=sn(y,E),F=sn(v,v),$=sn(v,E),Y=C*F-O*O;if(Y===0){const ce=sn(E,v)/sn(v,v);return Nt($n(Fe(),f,p,ce),o)}const J=(O*$-z*F)/Y,re=(C*$-O*z)/Y;return Nt($n(Fe(),o,l,J),$n(Fe(),f,p,re))}}class RM{static parseFrom(o,l){const f=gg.parse(o);if(!f)return[];let{vertices:p,features:y}=f;const v=1/tt(l);y.sort((z,F)=>z.id-F.id),p.sort((z,F)=>z.id-F.id||z.idx-F.idx),p=p.filter((z,F,$)=>F===$.findIndex(Y=>Y.id===z.id&&Y.idx===z.idx));const E=new Array;let C=0;const O=p.length;for(const z of y){if(z.constantHeight){E.push(new kM(z.id,z.bounds,z.constantHeight));continue}for(;C!==O&&p[C].id<z.id;)C++;if(C===O||p[C].id!==z.id)continue;const F=new Array,$=new Array,Y=C;for(;C!==O&&p[C].id===z.id;){const J=p[C];if(F.push({position:J.position,height:J.height,extent:J.extent}),C!==Y&&p[C-1].idx===J.idx-1){const re=C-Y;$.push({a:re-1,b:re})}C++}E.push(new kM(z.id,z.bounds,void 0,F,$,v))}return E}static getElevationFeature(o,l){if(!l)return;const f=+o.properties[mg];return Number.isNaN(f)?void 0:l.find(p=>p.id===f)}}class gj{constructor(o,l){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(l)||(this.zScale=Math.pow(2,l.z-o.z),this.xOffset=(o.x*this.zScale-l.x)*Kt,this.yOffset=(o.y*this.zScale-l.y)*Kt)}constantElevation(o,l){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,l)}pointElevation(o,l,f){const p=this.constantElevation(l,f);return p??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(o),f))}computeBiasedHeight(o,l){return l<=0?o:o+l*Ye(0,l,o>=0?o:Math.abs(.5*o))}}dn(kM,"ElevationFeature");class _j{constructor(){this.polygons=new Map}add(o,...l){this.polygons.has(o)?this.polygons.get(o).push(...l):this.polygons.set(o,l)}merge(o){for(const[l,f]of o.polygons)this.add(l,...f)}}class _g{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new _g;let l=[];for(const O of o)l.push(...O.portals);if(l.length===0)return new _g;const f=(O,z)=>O<=0&&z<=0||O>=Kt&&z>=Kt;for(const O of l){const z=O.va,F=O.vb;(f(z.x,F.x)||f(z.y,F.y))&&(O.type="border")}const p=l.filter(O=>O.type!=="unevaluated"),y=l.filter(O=>O.type==="unevaluated");if(y.length===0)return new _g;y.sort((O,z)=>O.hash===z.hash?O.isTunnel===z.isTunnel?0:O.isTunnel?-1:1:O.hash<z.hash?1:-1),l=p.concat(y);let v=p.length,E=v,C=v;do if(E++,E===l.length||l[v].hash!==l[E].hash){if(E-v==2){C<v&&(l[C]=l[v],l[v]=null);const O=l[C],z=l[E-1];O.type=O.isTunnel!==z.isTunnel?"tunnel":"polygon",O.connection={a:O.connection.a,b:z.connection.a},C++}v=E}while(v!==l.length);return l.splice(C),l.sort((O,z)=>O.hash<z.hash?1:-1),{portals:l}}}dn(_g,"ElevationPortalGraph"),dn(_j,"ElevationPolygons");class Pie{constructor(o,l,f){this.outPositions=o,this.outNormals=l,this.outIndices=f,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,l,f){let p=o[2];f!=null&&(p*=f);const y=this.getVec3Bits(o)<<96n|this.getVec3Bits(l),v=this.vertexLookup.get(y);if(v!=null)return v;const E=this.outPositions.length;this.vertexLookup.set(y,E);const C=Math.trunc(16384*l[0]),O=Math.trunc(16384*l[1]),z=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(o[0],o[1],p),this.outNormals.emplaceBack(C,O,z),E}addVertices(o,l,...f){const p=[];for(const y of f){const v=this.addVertex(y,o,l);p.push(v)}return p}addTriangles(o,l,f){if(l&&f){const p=f.length===1,y=He(0,0,0);for(let v=0;v<o.length;v+=3){const E=l[o[v+0]],C=l[o[v+1]],O=l[o[v+2]],z=p?f[0]:f[o[v+1]],F=p?f[0]:f[o[v+2]],$=this.addVertex(He(E.x,E.y,p?f[0]:f[o[v+0]]),y),Y=this.addVertex(He(C.x,C.y,z),y),J=this.addVertex(He(O.x,O.y,F),y);this.outIndices.emplaceBack($,Y,J)}}else for(let p=0;p<o.length;p+=3)this.outIndices.emplaceBack(o[p+0],o[p+1],o[p+2])}addQuad(o,l){const f=this.addVertices(l,void 0,...o.map(C=>He(C.coord.x,C.coord.y,C.height))),[p,y,v,E]=f;this.addTriangles([p,y,v,v,E,p])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class Bl{constructor(o){this.unevaluatedPortals=new _g,this.portalPolygons=new _j,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new dy,this.vertexNormals=new Jf,this.indexArray=new ia,this.tileToMeters=tt(o)}addVertices(o,l){const f=this.unevalVertices.length;for(let p=0;p<o.length;p++)this.unevalVertices.push(o[p]),this.unevalHeights.push(l[p]);return f}addTriangles(o,l,f){const p=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const y of o)p.push(y+l)}addRenderableRing(o,l,f,p,y){const v=[new Tt(y.min.x,y.min.y),new Tt(y.max.x,y.min.y),new Tt(y.max.x,y.max.y),new Tt(y.min.x,y.max.y)];for(let E=0;E<f-1;E++){const C=l+E,O=C+1,z=this.unevalVertices[C],F=this.unevalVertices[O];if(!(z.x>=y.min.x&&z.x<=y.max.x&&z.y>=y.min.y&&z.y<=y.max.y||F.x>=y.min.x&&F.x<=y.max.x&&F.y>=y.min.y&&F.y<=y.max.y||oo(z,F,v))||this.isOnBorder(z.x,F.x)||this.isOnBorder(z.y,F.y))continue;const $=Bl.computeEdgeHash(this.unevalVertices[C],this.unevalVertices[O]);let Y,J=this.vertexHashLookup.get(Bl.computePosHash(z));J!=null?Y=J.next:(J=this.vertexHashLookup.get(Bl.computePosHash(F)),Y=J!=null?J.prev:$),this.unevalEdges.push({polygonIdx:o,a:C,b:O,hash:$,portalHash:Y,isTunnel:p,type:"unevaluated"})}}addPortalCandidates(o,l,f,p,y){if(l.length===0)return;this.portalPolygons.add(o,{geometry:l,zLevel:y});const v=l[0];this.vertexHashLookup.clear();let E=Bl.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let C=0;C<v.length-1;C++){const O=v[C+0],z=v[C+1],F=ja(z.x-O.x,z.y-O.y),$=Ua(F);if($===0)continue;let Y="unevaluated";const J=p.pointElevation(O),re=p.pointElevation(z);Math.abs(J)<.01&&Math.abs(re)<.01?Y="entrance":(this.isOnBorder(O.x,z.x)||this.isOnBorder(O.y,z.y))&&(Y="border");const ce=Bl.computeEdgeHash(O,z);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:O,vb:z,vab:F,length:$,hash:ce,isTunnel:f,type:Y});const de=Bl.computePosHash(O);this.vertexHashLookup.set(de,{prev:E,next:ce}),E=ce}}construct(o){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=F=>{F.primitiveLength=this.indexArray.length-F.primitiveOffset},p=new Pie(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);const y=l(),v=l(),E=l(),C=(F,$)=>{F.sort((J,re)=>J.type===$&&re.type!==$?-1:J.type!==$&&re.type===$?1:0);const Y=F.findIndex(J=>J.type!==$);return Y>=0?Y:F.length};let O=0;this.unevalEdges.length>0&&(O=C(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},this.tileToMeters));const z=l();if(this.unevalEdges.length>0){const F=this.unevalEdges.splice(O),$=C(F,"tunnel")+O;this.unevalEdges.push(...F),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},{min:O,max:$})}f(E),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(z),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(v),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(y),this.maskSegments=qi.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=qi.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableSegments=qi.simpleSegment(0,E.primitiveOffset,0,E.primitiveLength),this.shadowCasterSegments=qi.simpleSegment(0,y.primitiveOffset,0,y.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,die.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,fie.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,l,f,p,y){const v=new Map;for(let E=p;E<y;E++){const C=f[E],O=C.a,z=C.b,F=Bl.computePosHash(o[O]),$=Bl.computePosHash(o[z]);v.has(F)||v.set(F,{}),v.has($)||v.set($,{});const Y=v.get(F),J=v.get($);l[O]<=0&&l[z]<=0||(Y.to=z,J.from=O)}return v}constructBridgeStructures(o,l,f,p,y,v){const E=this.computeVertexConnections(l,f,p,y.min,y.max),C=1/v,O=.5*C,z=$=>He(l[$].x,l[$].y,f[$]*C),F=$=>{const Y=E.get(Bl.computePosHash(l[$])),J=Y.from,re=Y.to;if(!J||!re)return;const ce=z(J),de=z($),we=z(re),ve=He(0,0,0);if(!yt(ce,de)){const ge=In(Fe(),de,ce);ct(ve,ve,en(ge,ge))}if(!yt(we,de)){const ge=In(Fe(),we,de);ct(ve,ve,en(ge,ge))}const ie=Ar(ve);return ie>0?at(ve,ve,1/ie):void 0};for(let $=y.min;$<y.max;$++){const Y=p[$],J=this.prepareEdgePoints(l,f,Y,($t,qn)=>$t>qn);if(J==null)continue;const re=J[0],ce=J[1],de=He(re.coord.x,re.coord.y,C*re.height),we=He(ce.coord.x,ce.coord.y,C*ce.height);if(yt(de,we))continue;const ve=In(Fe(),we,de);en(ve,ve);const ie=$t=>en($t,$t),ge=F(Y.a)||ve,be=F(Y.b)||ve,Ee=ie(He(ge[1],-ge[0],0)),Ue=ie(He(be[1],-be[0],0)),qe=ie(Vt(Fe(),Ee,ge)),Ke=ie(Vt(Fe(),Ue,be)),Qe=Fe(),xt=[ct(Fe(),de,at(Qe,In(Qe,Ee,qe),O)),ct(Fe(),de,at(Qe,ct(Qe,Ee,qe),O)),ct(Fe(),de,at(Qe,qe,O)),de],Dt=[ct(Fe(),we,at(Qe,In(Qe,Ue,Ke),O)),ct(Fe(),we,at(Qe,ct(Qe,Ue,Ke),O)),ct(Fe(),we,at(Qe,Ke,O)),we],[Ct,kt]=o.addVertices(Ee,v,xt[0],xt[1]),[Bt,_t]=o.addVertices(Ue,v,Dt[0],Dt[1]);o.addTriangles([Ct,kt,Bt,kt,_t,Bt]);const[Ot,pt]=o.addVertices(qe,v,xt[1],xt[2]),[vt,Ut]=o.addVertices(Ke,v,Dt[1],Dt[2]);o.addTriangles([Ot,pt,vt,pt,Ut,vt]);const[Wt,Sn]=o.addVertices(un(Ee,Ee),v,xt[2],xt[3]),[mn,Jt]=o.addVertices(un(Ue,Ue),v,Dt[2],Dt[3]);o.addTriangles([Wt,Sn,mn,Sn,Jt,mn])}}constructTunnelStructures(o,l,f,p,y,v){const E=C=>en(C,C);for(let C=y.min;C<y.max;C++){const O=this.prepareEdgePoints(l,f,p[C],(Y,J)=>Y<J);if(O==null)continue;const[z,F]=O,$=E(He(F.coord.y-z.coord.y,-(F.coord.x-z.coord.x),0));o.addQuad([z,F,{coord:F.coord,height:p[C].isTunnel?-.1:0},{coord:z.coord,height:p[C].isTunnel?-.1:0}],$)}for(let C=v.min;C<v.max;C++){const O=p[C],z=l[O.a],F=l[O.b],$=E(He(F.y-z.y,-(F.x-z.x),0));o.addQuad([{coord:F,height:0},{coord:z,height:0},{coord:z,height:f[O.a]+4},{coord:F,height:f[O.b]+4}],$),o.addQuad([{coord:z,height:0},{coord:F,height:0},{coord:F,height:f[O.b]+4},{coord:z,height:f[O.a]+4}],$)}}prepareEdgePoints(o,l,f,p){let y=l[f.a],v=l[f.b];const E=p(y,0),C=p(v,0);if(E&&C)return[{coord:o[f.a],height:y},{coord:o[f.b],height:v}];if(!E&&!C)return;const O=o[f.a].clone(),z=o[f.b].clone();if(E){if(!C){const F=v/(v-y);z.x=kn(z.x,O.x,F),z.y=kn(z.y,O.y,F),v=kn(v,y,F)}}else{const F=y/(y-v);O.x=kn(O.x,z.x,F),O.y=kn(O.y,z.y,F),y=kn(y,v,F)}return[{coord:O,height:y},{coord:z,height:v}]}prepareEdges(o,l){if(l.length===0)return;l.sort((E,C)=>E.hash===C.hash?C.polygonIdx-E.polygonIdx:C.hash>E.hash?1:-1);let f=0,p=0,y=0,v=l[f].polygonIdx;do p++,(p===l.length||l[f].hash!==l[p].hash)&&((p-f==1||l[p-1].polygonIdx!==v)&&(y<f&&(l[y]=l[f],l[f]=null),l[y].type="none",y++),f=p,f!==l.length&&(v=l[f].polygonIdx));while(f!==l.length);if(l.splice(y),l.length!==0&&o.length!==0){l.sort((O,z)=>O.portalHash<z.portalHash?1:-1);let E=0,C=0;for(;E!==l.length&&C!==o.length;){const O=l[E],z=o[C];O.portalHash>z.hash?E++:z.hash>O.portalHash?C++:(O.type=z.type,E++)}}}isOnBorder(o,l){return o<=0&&l<=0||o>=Kt&&l>=Kt}static computeEdgeHash(o,l){return(o.y===l.y&&o.x>l.x||o.y>l.y)&&([o,l]=[l,o]),BigInt(Bl.computePosHash(o))<<32n|BigInt(Bl.computePosHash(l))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}var yj,vj={exports:{}},xj=(yj||(yj=1,function(u,o){(function(l){function f(Se,Ae){return Se>Ae?1:Se<Ae?-1:0}var p=function(Se,Ae){Se===void 0&&(Se=f),Ae===void 0&&(Ae=!1),this._compare=Se,this._root=null,this._size=0,this._noDuplicates=!!Ae},y={size:{configurable:!0}};function v(Se,Ae,bt,Xt,tn){var Qt=tn-Xt;if(Qt>0){var wn=Xt+Math.floor(Qt/2),jn={key:Ae[wn],data:bt[wn],parent:Se};return jn.left=v(jn,Ae,bt,Xt,wn),jn.right=v(jn,Ae,bt,wn+1,tn),jn}return null}function E(Se,Ae,bt,Xt,tn){if(!(bt>=Xt)){for(var Qt=Se[bt+Xt>>1],wn=bt-1,jn=Xt+1;;){do wn++;while(tn(Se[wn],Qt)<0);do jn--;while(tn(Se[jn],Qt)>0);if(wn>=jn)break;var Sr=Se[wn];Se[wn]=Se[jn],Se[jn]=Sr,Sr=Ae[wn],Ae[wn]=Ae[jn],Ae[jn]=Sr}E(Se,Ae,bt,jn,tn),E(Se,Ae,jn+1,Xt,tn)}}p.prototype.rotateLeft=function(Se){var Ae=Se.right;Ae&&(Se.right=Ae.left,Ae.left&&(Ae.left.parent=Se),Ae.parent=Se.parent),Se.parent?Se===Se.parent.left?Se.parent.left=Ae:Se.parent.right=Ae:this._root=Ae,Ae&&(Ae.left=Se),Se.parent=Ae},p.prototype.rotateRight=function(Se){var Ae=Se.left;Ae&&(Se.left=Ae.right,Ae.right&&(Ae.right.parent=Se),Ae.parent=Se.parent),Se.parent?Se===Se.parent.left?Se.parent.left=Ae:Se.parent.right=Ae:this._root=Ae,Ae&&(Ae.right=Se),Se.parent=Ae},p.prototype._splay=function(Se){for(;Se.parent;){var Ae=Se.parent;Ae.parent?Ae.left===Se&&Ae.parent.left===Ae?(this.rotateRight(Ae.parent),this.rotateRight(Ae)):Ae.right===Se&&Ae.parent.right===Ae?(this.rotateLeft(Ae.parent),this.rotateLeft(Ae)):Ae.left===Se&&Ae.parent.right===Ae?(this.rotateRight(Ae),this.rotateLeft(Ae)):(this.rotateLeft(Ae),this.rotateRight(Ae)):Ae.left===Se?this.rotateRight(Ae):this.rotateLeft(Ae)}},p.prototype.splay=function(Se){for(var Ae,bt,Xt,tn,Qt;Se.parent;)(bt=(Ae=Se.parent).parent)&&bt.parent?((Xt=bt.parent).left===bt?Xt.left=Se:Xt.right=Se,Se.parent=Xt):(Se.parent=null,this._root=Se),tn=Se.left,Qt=Se.right,Se===Ae.left?(bt&&(bt.left===Ae?(Ae.right?(bt.left=Ae.right,bt.left.parent=bt):bt.left=null,Ae.right=bt,bt.parent=Ae):(tn?(bt.right=tn,tn.parent=bt):bt.right=null,Se.left=bt,bt.parent=Se)),Qt?(Ae.left=Qt,Qt.parent=Ae):Ae.left=null,Se.right=Ae,Ae.parent=Se):(bt&&(bt.right===Ae?(Ae.left?(bt.right=Ae.left,bt.right.parent=bt):bt.right=null,Ae.left=bt,bt.parent=Ae):(Qt?(bt.left=Qt,Qt.parent=bt):bt.left=null,Se.right=bt,bt.parent=Se)),tn?(Ae.right=tn,tn.parent=Ae):Ae.right=null,Se.left=Ae,Ae.parent=Se)},p.prototype.replace=function(Se,Ae){Se.parent?Se===Se.parent.left?Se.parent.left=Ae:Se.parent.right=Ae:this._root=Ae,Ae&&(Ae.parent=Se.parent)},p.prototype.minNode=function(Se){if(Se===void 0&&(Se=this._root),Se)for(;Se.left;)Se=Se.left;return Se},p.prototype.maxNode=function(Se){if(Se===void 0&&(Se=this._root),Se)for(;Se.right;)Se=Se.right;return Se},p.prototype.insert=function(Se,Ae){var bt=this._root,Xt=null,tn=this._compare;if(this._noDuplicates)for(;bt;){if(Xt=bt,tn(bt.key,Se)===0)return;bt=tn(bt.key,Se)<0?bt.right:bt.left}else for(;bt;)Xt=bt,bt=tn(bt.key,Se)<0?bt.right:bt.left;return bt={key:Se,data:Ae,left:null,right:null,parent:Xt},Xt?tn(Xt.key,bt.key)<0?Xt.right=bt:Xt.left=bt:this._root=bt,this.splay(bt),this._size++,bt},p.prototype.find=function(Se){for(var Ae=this._root,bt=this._compare;Ae;){var Xt=bt(Ae.key,Se);if(Xt<0)Ae=Ae.right;else{if(!(Xt>0))return Ae;Ae=Ae.left}}return null},p.prototype.contains=function(Se){for(var Ae=this._root,bt=this._compare;Ae;){var Xt=bt(Se,Ae.key);if(Xt===0)return!0;Ae=Xt<0?Ae.left:Ae.right}return!1},p.prototype.remove=function(Se){var Ae=this.find(Se);if(!Ae)return!1;if(this.splay(Ae),Ae.left)if(Ae.right){var bt=this.minNode(Ae.right);bt.parent!==Ae&&(this.replace(bt,bt.right),bt.right=Ae.right,bt.right.parent=bt),this.replace(Ae,bt),bt.left=Ae.left,bt.left.parent=bt}else this.replace(Ae,Ae.left);else this.replace(Ae,Ae.right);return this._size--,!0},p.prototype.removeNode=function(Se){if(!Se)return!1;if(this.splay(Se),Se.left)if(Se.right){var Ae=this.minNode(Se.right);Ae.parent!==Se&&(this.replace(Ae,Ae.right),Ae.right=Se.right,Ae.right.parent=Ae),this.replace(Se,Ae),Ae.left=Se.left,Ae.left.parent=Ae}else this.replace(Se,Se.left);else this.replace(Se,Se.right);return this._size--,!0},p.prototype.erase=function(Se){var Ae=this.find(Se);if(Ae){this.splay(Ae);var bt=Ae.left,Xt=Ae.right,tn=null;bt&&(bt.parent=null,tn=this.maxNode(bt),this.splay(tn),this._root=tn),Xt&&(bt?tn.right=Xt:this._root=Xt,Xt.parent=tn),this._size--}},p.prototype.pop=function(){var Se=this._root,Ae=null;if(Se){for(;Se.left;)Se=Se.left;Ae={key:Se.key,data:Se.data},this.remove(Se.key)}return Ae},p.prototype.next=function(Se){var Ae=Se;if(Ae)if(Ae.right)for(Ae=Ae.right;Ae&&Ae.left;)Ae=Ae.left;else for(Ae=Se.parent;Ae&&Ae.right===Se;)Se=Ae,Ae=Ae.parent;return Ae},p.prototype.prev=function(Se){var Ae=Se;if(Ae)if(Ae.left)for(Ae=Ae.left;Ae&&Ae.right;)Ae=Ae.right;else for(Ae=Se.parent;Ae&&Ae.left===Se;)Se=Ae,Ae=Ae.parent;return Ae},p.prototype.forEach=function(Se){for(var Ae=this._root,bt=[],Xt=!1,tn=0;!Xt;)Ae?(bt.push(Ae),Ae=Ae.left):bt.length>0?(Se(Ae=bt.pop(),tn++),Ae=Ae.right):Xt=!0;return this},p.prototype.range=function(Se,Ae,bt,Xt){for(var tn=[],Qt=this._compare,wn=this._root;tn.length!==0||wn;)if(wn)tn.push(wn),wn=wn.left;else{if(Qt((wn=tn.pop()).key,Ae)>0)break;if(Qt(wn.key,Se)>=0&&bt.call(Xt,wn))return this;wn=wn.right}return this},p.prototype.keys=function(){for(var Se=this._root,Ae=[],bt=[],Xt=!1;!Xt;)Se?(Ae.push(Se),Se=Se.left):Ae.length>0?(Se=Ae.pop(),bt.push(Se.key),Se=Se.right):Xt=!0;return bt},p.prototype.values=function(){for(var Se=this._root,Ae=[],bt=[],Xt=!1;!Xt;)Se?(Ae.push(Se),Se=Se.left):Ae.length>0?(Se=Ae.pop(),bt.push(Se.data),Se=Se.right):Xt=!0;return bt},p.prototype.at=function(Se){for(var Ae=this._root,bt=[],Xt=!1,tn=0;!Xt;)if(Ae)bt.push(Ae),Ae=Ae.left;else if(bt.length>0){if(Ae=bt.pop(),tn===Se)return Ae;tn++,Ae=Ae.right}else Xt=!0;return null},p.prototype.load=function(Se,Ae,bt){if(Se===void 0&&(Se=[]),Ae===void 0&&(Ae=[]),bt===void 0&&(bt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Xt=Se.length;return bt&&E(Se,Ae,0,Xt-1,this._compare),this._root=v(null,Se,Ae,0,Xt),this._size=Xt,this},p.prototype.min=function(){var Se=this.minNode(this._root);return Se?Se.key:null},p.prototype.max=function(){var Se=this.maxNode(this._root);return Se?Se.key:null},p.prototype.isEmpty=function(){return this._root===null},y.size.get=function(){return this._size},p.createTree=function(Se,Ae,bt,Xt,tn){return new p(bt,tn).load(Se,Ae,Xt)},Object.defineProperties(p.prototype,y);var C=0,O=1,z=2,F=3,$=0,Y=1,J=2,re=3;function ce(Se,Ae,bt){Ae===null?(Se.inOut=!1,Se.otherInOut=!0):(Se.isSubject===Ae.isSubject?(Se.inOut=!Ae.inOut,Se.otherInOut=Ae.otherInOut):(Se.inOut=!Ae.otherInOut,Se.otherInOut=Ae.isVertical()?!Ae.inOut:Ae.inOut),Ae&&(Se.prevInResult=!de(Ae,bt)||Ae.isVertical()?Ae.prevInResult:Ae));var Xt=de(Se,bt);Se.resultTransition=Xt?function(tn,Qt){var wn,jn=!tn.inOut,Sr=!tn.otherInOut;switch(Qt){case $:wn=jn&&Sr;break;case Y:wn=jn||Sr;break;case re:wn=jn^Sr;break;case J:wn=tn.isSubject?jn&&!Sr:Sr&&!jn}return wn?1:-1}(Se,bt):0}function de(Se,Ae){switch(Se.type){case C:switch(Ae){case $:return!Se.otherInOut;case Y:return Se.otherInOut;case J:return Se.isSubject&&Se.otherInOut||!Se.isSubject&&!Se.otherInOut;case re:return!0}break;case z:return Ae===$||Ae===Y;case F:return Ae===J;case O:return!1}return!1}var we=function(Se,Ae,bt,Xt,tn){this.left=Ae,this.point=Se,this.otherEvent=bt,this.isSubject=Xt,this.type=tn||C,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},ve={inResult:{configurable:!0}};function ie(Se,Ae){return Se[0]===Ae[0]&&Se[1]===Ae[1]}we.prototype.isBelow=function(Se){var Ae=this.point,bt=this.otherEvent.point;return this.left?(Ae[0]-Se[0])*(bt[1]-Se[1])-(bt[0]-Se[0])*(Ae[1]-Se[1])>0:(bt[0]-Se[0])*(Ae[1]-Se[1])-(Ae[0]-Se[0])*(bt[1]-Se[1])>0},we.prototype.isAbove=function(Se){return!this.isBelow(Se)},we.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},ve.inResult.get=function(){return this.resultTransition!==0},we.prototype.clone=function(){var Se=new we(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Se.contourId=this.contourId,Se.resultTransition=this.resultTransition,Se.prevInResult=this.prevInResult,Se.isExteriorRing=this.isExteriorRing,Se.inOut=this.inOut,Se.otherInOut=this.otherInOut,Se},Object.defineProperties(we.prototype,ve);var ge=11102230246251565e-32,be=134217729,Ee=(3+8*ge)*ge;function Ue(Se,Ae,bt,Xt,tn){var Qt,wn,jn,Sr,Tr=Ae[0],cr=Xt[0],ei=0,xi=0;cr>Tr==cr>-Tr?(Qt=Tr,Tr=Ae[++ei]):(Qt=cr,cr=Xt[++xi]);var Er=0;if(ei<Se&&xi<bt)for(cr>Tr==cr>-Tr?(jn=Qt-((wn=Tr+Qt)-Tr),Tr=Ae[++ei]):(jn=Qt-((wn=cr+Qt)-cr),cr=Xt[++xi]),Qt=wn,jn!==0&&(tn[Er++]=jn);ei<Se&&xi<bt;)cr>Tr==cr>-Tr?(jn=Qt-((wn=Qt+Tr)-(Sr=wn-Qt))+(Tr-Sr),Tr=Ae[++ei]):(jn=Qt-((wn=Qt+cr)-(Sr=wn-Qt))+(cr-Sr),cr=Xt[++xi]),Qt=wn,jn!==0&&(tn[Er++]=jn);for(;ei<Se;)jn=Qt-((wn=Qt+Tr)-(Sr=wn-Qt))+(Tr-Sr),Tr=Ae[++ei],Qt=wn,jn!==0&&(tn[Er++]=jn);for(;xi<bt;)jn=Qt-((wn=Qt+cr)-(Sr=wn-Qt))+(cr-Sr),cr=Xt[++xi],Qt=wn,jn!==0&&(tn[Er++]=jn);return Qt===0&&Er!==0||(tn[Er++]=Qt),Er}function qe(Se){return new Float64Array(Se)}var Ke=33306690738754716e-32,Qe=22204460492503146e-32,xt=11093356479670487e-47,Dt=qe(4),Ct=qe(8),kt=qe(12),Bt=qe(16),_t=qe(4);function Ot(Se,Ae,bt){var Xt=function(tn,Qt,wn,jn,Sr,Tr){var cr=(Qt-Tr)*(wn-Sr),ei=(tn-Sr)*(jn-Tr),xi=cr-ei;if(cr===0||ei===0||cr>0!=ei>0)return xi;var Er=Math.abs(cr+ei);return Math.abs(xi)>=Ke*Er?xi:-function(Zi,Ci,Jr,ao,Oi,bi,Ii){var ri,hr,si,Xi,Bn,Or,ki,Qi,zi,ko,fi,Po,Ws,qa,Na,Gs,$h,Ro,Qo=Zi-Oi,Za=Jr-Oi,_s=Ci-bi,is=ao-bi;Dt[0]=(Na=(Qi=Qo-(ki=(Or=be*Qo)-(Or-Qo)))*(ko=is-(zi=(Or=be*is)-(Or-is)))-((qa=Qo*is)-ki*zi-Qi*zi-ki*ko))-((fi=Na-($h=(Qi=_s-(ki=(Or=be*_s)-(Or-_s)))*(ko=Za-(zi=(Or=be*Za)-(Or-Za)))-((Gs=_s*Za)-ki*zi-Qi*zi-ki*ko)))+(Bn=Na-fi))+(Bn-$h),Dt[1]=(Ws=qa-((Po=qa+fi)-(Bn=Po-qa))+(fi-Bn))-((fi=Ws-Gs)+(Bn=Ws-fi))+(Bn-Gs),Dt[2]=Po-((Ro=Po+fi)-(Bn=Ro-Po))+(fi-Bn),Dt[3]=Ro;var mp=function(JZe,E$){for(var A$=E$[0],NO=1;NO<4;NO++)A$+=E$[NO];return A$}(0,Dt),I1=Qe*Ii;if(mp>=I1||-mp>=I1||(ri=Zi-(Qo+(Bn=Zi-Qo))+(Bn-Oi),si=Jr-(Za+(Bn=Jr-Za))+(Bn-Oi),hr=Ci-(_s+(Bn=Ci-_s))+(Bn-bi),Xi=ao-(is+(Bn=ao-is))+(Bn-bi),ri===0&&hr===0&&si===0&&Xi===0)||(I1=xt*Ii+Ee*Math.abs(mp),(mp+=Qo*Xi+is*ri-(_s*si+Za*hr))>=I1||-mp>=I1))return mp;_t[0]=(Na=(Qi=ri-(ki=(Or=be*ri)-(Or-ri)))*(ko=is-(zi=(Or=be*is)-(Or-is)))-((qa=ri*is)-ki*zi-Qi*zi-ki*ko))-((fi=Na-($h=(Qi=hr-(ki=(Or=be*hr)-(Or-hr)))*(ko=Za-(zi=(Or=be*Za)-(Or-Za)))-((Gs=hr*Za)-ki*zi-Qi*zi-ki*ko)))+(Bn=Na-fi))+(Bn-$h),_t[1]=(Ws=qa-((Po=qa+fi)-(Bn=Po-qa))+(fi-Bn))-((fi=Ws-Gs)+(Bn=Ws-fi))+(Bn-Gs),_t[2]=Po-((Ro=Po+fi)-(Bn=Ro-Po))+(fi-Bn),_t[3]=Ro;var use=Ue(4,Dt,4,_t,Ct);_t[0]=(Na=(Qi=Qo-(ki=(Or=be*Qo)-(Or-Qo)))*(ko=Xi-(zi=(Or=be*Xi)-(Or-Xi)))-((qa=Qo*Xi)-ki*zi-Qi*zi-ki*ko))-((fi=Na-($h=(Qi=_s-(ki=(Or=be*_s)-(Or-_s)))*(ko=si-(zi=(Or=be*si)-(Or-si)))-((Gs=_s*si)-ki*zi-Qi*zi-ki*ko)))+(Bn=Na-fi))+(Bn-$h),_t[1]=(Ws=qa-((Po=qa+fi)-(Bn=Po-qa))+(fi-Bn))-((fi=Ws-Gs)+(Bn=Ws-fi))+(Bn-Gs),_t[2]=Po-((Ro=Po+fi)-(Bn=Ro-Po))+(fi-Bn),_t[3]=Ro;var hse=Ue(use,Ct,4,_t,kt);_t[0]=(Na=(Qi=ri-(ki=(Or=be*ri)-(Or-ri)))*(ko=Xi-(zi=(Or=be*Xi)-(Or-Xi)))-((qa=ri*Xi)-ki*zi-Qi*zi-ki*ko))-((fi=Na-($h=(Qi=hr-(ki=(Or=be*hr)-(Or-hr)))*(ko=si-(zi=(Or=be*si)-(Or-si)))-((Gs=hr*si)-ki*zi-Qi*zi-ki*ko)))+(Bn=Na-fi))+(Bn-$h),_t[1]=(Ws=qa-((Po=qa+fi)-(Bn=Po-qa))+(fi-Bn))-((fi=Ws-Gs)+(Bn=Ws-fi))+(Bn-Gs),_t[2]=Po-((Ro=Po+fi)-(Bn=Ro-Po))+(fi-Bn),_t[3]=Ro;var dse=Ue(hse,kt,4,_t,Bt);return Bt[dse-1]}(tn,Qt,wn,jn,Sr,Tr,Er)}(Se[0],Se[1],Ae[0],Ae[1],bt[0],bt[1]);return Xt>0?-1:Xt<0?1:0}function pt(Se,Ae){var bt=Se.point,Xt=Ae.point;return bt[0]>Xt[0]?1:bt[0]<Xt[0]?-1:bt[1]!==Xt[1]?bt[1]>Xt[1]?1:-1:function(tn,Qt,wn,jn){return tn.left!==Qt.left?tn.left?1:-1:Ot(wn,tn.otherEvent.point,Qt.otherEvent.point)!==0?tn.isBelow(Qt.otherEvent.point)?-1:1:!tn.isSubject&&Qt.isSubject?1:-1}(Se,Ae,bt)}function vt(Se,Ae,bt){var Xt=new we(Ae,!1,Se,Se.isSubject),tn=new we(Ae,!0,Se.otherEvent,Se.isSubject);return ie(Se.point,Se.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Se),Xt.contourId=tn.contourId=Se.contourId,pt(tn,Se.otherEvent)>0&&(Se.otherEvent.left=!0,tn.left=!1),Se.otherEvent.otherEvent=tn,Se.otherEvent=Xt,bt.push(tn),bt.push(Xt),bt}function Ut(Se,Ae){return Se[0]*Ae[1]-Se[1]*Ae[0]}function Wt(Se,Ae){return Se[0]*Ae[0]+Se[1]*Ae[1]}function Sn(Se,Ae,bt){var Xt=function(Sr,Tr,cr,ei,xi){var Er=[Tr[0]-Sr[0],Tr[1]-Sr[1]],Zi=[ei[0]-cr[0],ei[1]-cr[1]];function Ci(Or,ki,Qi){return[Or[0]+ki*Qi[0],Or[1]+ki*Qi[1]]}var Jr=[cr[0]-Sr[0],cr[1]-Sr[1]],ao=Ut(Er,Zi),Oi=ao*ao,bi=Wt(Er,Er);if(Oi>0){var Ii=Ut(Jr,Zi)/ao;if(Ii<0||Ii>1)return null;var ri=Ut(Jr,Er)/ao;return ri<0||ri>1?null:Ii===0||Ii===1?[Ci(Sr,Ii,Er)]:ri===0||ri===1?[Ci(cr,ri,Zi)]:[Ci(Sr,Ii,Er)]}if((Oi=(ao=Ut(Jr,Er))*ao)>0)return null;var hr=Wt(Er,Jr)/bi,si=hr+Wt(Er,Zi)/bi,Xi=Math.min(hr,si),Bn=Math.max(hr,si);return Xi<=1&&Bn>=0?Xi===1?[Ci(Sr,Xi>0?Xi:0,Er)]:Bn===0?[Ci(Sr,Bn<1?Bn:1,Er)]:[Ci(Sr,Xi>0?Xi:0,Er),Ci(Sr,Bn<1?Bn:1,Er)]:null}(Se.point,Se.otherEvent.point,Ae.point,Ae.otherEvent.point),tn=Xt?Xt.length:0;if(tn===0||tn===1&&(ie(Se.point,Ae.point)||ie(Se.otherEvent.point,Ae.otherEvent.point))||tn===2&&Se.isSubject===Ae.isSubject)return 0;if(tn===1)return ie(Se.point,Xt[0])||ie(Se.otherEvent.point,Xt[0])||vt(Se,Xt[0],bt),ie(Ae.point,Xt[0])||ie(Ae.otherEvent.point,Xt[0])||vt(Ae,Xt[0],bt),1;var Qt=[],wn=!1,jn=!1;return ie(Se.point,Ae.point)?wn=!0:pt(Se,Ae)===1?Qt.push(Ae,Se):Qt.push(Se,Ae),ie(Se.otherEvent.point,Ae.otherEvent.point)?jn=!0:pt(Se.otherEvent,Ae.otherEvent)===1?Qt.push(Ae.otherEvent,Se.otherEvent):Qt.push(Se.otherEvent,Ae.otherEvent),wn&&jn||wn?(Ae.type=O,Se.type=Ae.inOut===Se.inOut?z:F,wn&&!jn&&vt(Qt[1].otherEvent,Qt[0].point,bt),2):jn?(vt(Qt[0],Qt[1].point,bt),3):Qt[0]!==Qt[3].otherEvent?(vt(Qt[0],Qt[1].point,bt),vt(Qt[1],Qt[2].point,bt),3):(vt(Qt[0],Qt[1].point,bt),vt(Qt[3].otherEvent,Qt[2].point,bt),3)}function mn(Se,Ae){if(Se===Ae)return 0;if(Ot(Se.point,Se.otherEvent.point,Ae.point)!==0||Ot(Se.point,Se.otherEvent.point,Ae.otherEvent.point)!==0)return ie(Se.point,Ae.point)?Se.isBelow(Ae.otherEvent.point)?-1:1:Se.point[0]===Ae.point[0]?Se.point[1]<Ae.point[1]?-1:1:pt(Se,Ae)===1?Ae.isAbove(Se.point)?-1:1:Se.isBelow(Ae.point)?-1:1;if(Se.isSubject!==Ae.isSubject)return Se.isSubject?-1:1;var bt=Se.point,Xt=Ae.point;return bt[0]===Xt[0]&&bt[1]===Xt[1]?(bt=Se.otherEvent.point)[0]===(Xt=Ae.otherEvent.point)[0]&&bt[1]===Xt[1]?0:Se.contourId>Ae.contourId?1:-1:pt(Se,Ae)===1?1:-1}var Jt=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function $t(Se,Ae,bt,Xt){var tn,Qt=Se+1,wn=Ae[Se].point,jn=Ae.length;for(Qt<jn&&(tn=Ae[Qt].point);Qt<jn&&tn[0]===wn[0]&&tn[1]===wn[1];){if(!bt[Qt])return Qt;++Qt<jn&&(tn=Ae[Qt].point)}for(Qt=Se-1;bt[Qt]&&Qt>Xt;)Qt--;return Qt}Jt.prototype.isExterior=function(){return this.holeOf==null};var qn=xn,vn=xn;function xn(Se,Ae){if(!(this instanceof xn))return new xn(Se,Ae);if(this.data=Se||[],this.length=this.data.length,this.compare=Ae||Vn,this.length>0)for(var bt=(this.length>>1)-1;bt>=0;bt--)this._down(bt)}function Vn(Se,Ae){return Se<Ae?-1:Se>Ae?1:0}xn.prototype={push:function(Se){this.data.push(Se),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Se=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Se}},peek:function(){return this.data[0]},_up:function(Se){for(var Ae=this.data,bt=this.compare,Xt=Ae[Se];Se>0;){var tn=Se-1>>1,Qt=Ae[tn];if(bt(Xt,Qt)>=0)break;Ae[Se]=Qt,Se=tn}Ae[Se]=Xt},_down:function(Se){for(var Ae=this.data,bt=this.compare,Xt=this.length>>1,tn=Ae[Se];Se<Xt;){var Qt=1+(Se<<1),wn=Qt+1,jn=Ae[Qt];if(wn<this.length&&bt(Ae[wn],jn)<0&&(Qt=wn,jn=Ae[wn]),bt(jn,tn)>=0)break;Ae[Se]=jn,Se=Qt}Ae[Se]=tn}},qn.default=vn;var nr=Math.max,rr=Math.min,gr=0;function ur(Se,Ae,bt,Xt,tn,Qt){var wn,jn,Sr,Tr,cr,ei;for(wn=0,jn=Se.length-1;wn<jn;wn++)if(Tr=Se[wn+1],cr=new we(Sr=Se[wn],!1,void 0,Ae),ei=new we(Tr,!1,cr,Ae),cr.otherEvent=ei,Sr[0]!==Tr[0]||Sr[1]!==Tr[1]){cr.contourId=ei.contourId=bt,Qt||(cr.isExteriorRing=!1,ei.isExteriorRing=!1),pt(cr,ei)>0?ei.left=!0:cr.left=!0;var xi=Sr[0],Er=Sr[1];tn[0]=rr(tn[0],xi),tn[1]=rr(tn[1],Er),tn[2]=nr(tn[2],xi),tn[3]=nr(tn[3],Er),Xt.push(cr),Xt.push(ei)}}var lr=[];function di(Se,Ae,bt){typeof Se[0][0][0]=="number"&&(Se=[Se]),typeof Ae[0][0][0]=="number"&&(Ae=[Ae]);var Xt=function(Er,Zi,Ci){var Jr=null;return Er.length*Zi.length==0&&(Ci===$?Jr=lr:Ci===J?Jr=Er:Ci!==Y&&Ci!==re||(Jr=Er.length===0?Zi:Er)),Jr}(Se,Ae,bt);if(Xt)return Xt===lr?null:Xt;var tn=[1/0,1/0,-1/0,-1/0],Qt=[1/0,1/0,-1/0,-1/0],wn=function(Er,Zi,Ci,Jr,ao){var Oi,bi,Ii,ri,hr,si,Xi=new qn(null,pt);for(Ii=0,ri=Er.length;Ii<ri;Ii++)for(hr=0,si=(Oi=Er[Ii]).length;hr<si;hr++)(bi=hr===0)&&gr++,ur(Oi[hr],!0,gr,Xi,Ci,bi);for(Ii=0,ri=Zi.length;Ii<ri;Ii++)for(hr=0,si=(Oi=Zi[Ii]).length;hr<si;hr++)bi=hr===0,ao===J&&(bi=!1),bi&&gr++,ur(Oi[hr],!1,gr,Xi,Jr,bi);return Xi}(Se,Ae,tn,Qt,bt);if(Xt=function(Er,Zi,Ci,Jr,ao){var Oi=null;return(Ci[0]>Jr[2]||Jr[0]>Ci[2]||Ci[1]>Jr[3]||Jr[1]>Ci[3])&&(ao===$?Oi=lr:ao===J?Oi=Er:ao!==Y&&ao!==re||(Oi=Er.concat(Zi))),Oi}(Se,Ae,tn,Qt,bt))return Xt===lr?null:Xt;for(var jn=function(Er){var Zi,Ci,Jr=function(Ii){var ri,hr,si,Xi,Bn=[];for(hr=0,si=Ii.length;hr<si;hr++)((ri=Ii[hr]).left&&ri.inResult||!ri.left&&ri.otherEvent.inResult)&&Bn.push(ri);for(var Or=!1;!Or;)for(Or=!0,hr=0,si=Bn.length;hr<si;hr++)hr+1<si&&pt(Bn[hr],Bn[hr+1])===1&&(Xi=Bn[hr],Bn[hr]=Bn[hr+1],Bn[hr+1]=Xi,Or=!1);for(hr=0,si=Bn.length;hr<si;hr++)(ri=Bn[hr]).otherPos=hr;for(hr=0,si=Bn.length;hr<si;hr++)(ri=Bn[hr]).left||(Xi=ri.otherPos,ri.otherPos=ri.otherEvent.otherPos,ri.otherEvent.otherPos=Xi);return Bn}(Er),ao={},Oi=[],bi=function(){if(!ao[Zi]){var Ii=Oi.length,ri=function(Bn,Or,ki){var Qi=new Jt;if(Bn.prevInResult!=null){var zi=Bn.prevInResult,ko=zi.outputContourId;if(zi.resultTransition>0){var fi=Or[ko];if(fi.holeOf!=null){var Po=fi.holeOf;Or[Po].holeIds.push(ki),Qi.holeOf=Po,Qi.depth=Or[ko].depth}else Or[ko].holeIds.push(ki),Qi.holeOf=ko,Qi.depth=Or[ko].depth+1}else Qi.holeOf=null,Qi.depth=Or[ko].depth}else Qi.holeOf=null,Qi.depth=0;return Qi}(Jr[Zi],Oi,Ii),hr=function(Bn){ao[Bn]=!0,Bn<Jr.length&&Jr[Bn]&&(Jr[Bn].outputContourId=Ii)},si=Zi,Xi=Zi;for(ri.points.push(Jr[Zi].point);hr(si),hr(si=Jr[si].otherPos),ri.points.push(Jr[si].point),!((si=$t(si,Jr,ao,Xi))==Xi||si>=Jr.length)&&Jr[si];);Oi.push(ri)}};for(Zi=0,Ci=Jr.length;Zi<Ci;Zi++)bi();return Oi}(function(Er,Zi,Ci,Jr,ao,Oi){for(var bi,Ii,ri,hr=new p(mn),si=[],Xi=Math.min(Jr[2],ao[2]);Er.length!==0;){var Bn=Er.pop();if(si.push(Bn),Oi===$&&Bn.point[0]>Xi||Oi===J&&Bn.point[0]>Jr[2])break;if(Bn.left){Ii=bi=hr.insert(Bn),bi=bi!==(ri=hr.minNode())?hr.prev(bi):null,Ii=hr.next(Ii);var Or=bi?bi.key:null;if(ce(Bn,Or,Oi),Ii&&Sn(Bn,Ii.key,Er)===2&&(ce(Bn,Or,Oi),ce(Ii.key,Bn,Oi)),bi&&Sn(bi.key,Bn,Er)===2){var ki=bi;ce(Or,(ki=ki!==ri?hr.prev(ki):null)?ki.key:null,Oi),ce(Bn,Or,Oi)}}else Ii=bi=hr.find(Bn=Bn.otherEvent),bi&&Ii&&(bi=bi!==ri?hr.prev(bi):null,Ii=hr.next(Ii),hr.remove(Bn),Ii&&bi&&Sn(bi.key,Ii.key,Er))}return si}(wn,0,0,tn,Qt,bt)),Sr=[],Tr=0;Tr<jn.length;Tr++){var cr=jn[Tr];if(cr.isExterior()){for(var ei=[cr.points],xi=0;xi<cr.holeIds.length;xi++)ei.push(jn[cr.holeIds[xi]].points);Sr.push(ei)}}return Sr}var Pi={UNION:Y,DIFFERENCE:J,INTERSECTION:$,XOR:re};l.diff=function(Se,Ae){return di(Se,Ae,J)},l.intersection=function(Se,Ae){return di(Se,Ae,$)},l.operations=Pi,l.union=function(Se,Ae){return di(Se,Ae,Y)},l.xor=function(Se,Ae){return di(Se,Ae,re)},Object.defineProperty(l,"__esModule",{value:!0})})(o)}(0,vj.exports)),vj.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function NT(u,o,l,f){const p=[],y=f===0?(v,E,C,O,z,F)=>{v.push(new Tt(F,C+(F-E)/(O-E)*(z-C)))}:(v,E,C,O,z,F)=>{v.push(new Tt(E+(F-C)/(z-C)*(O-E),F))};for(const v of u){const E=[];for(const C of v){if(C.length<=2)continue;const O=[];for(let $=0;$<C.length-1;$++){const Y=C[$].x,J=C[$].y,re=C[$+1].x,ce=C[$+1].y,de=f===0?Y:J,we=f===0?re:ce;de<o?we>o&&y(O,Y,J,re,ce,o):de>l?we<l&&y(O,Y,J,re,ce,l):O.push(C[$]),we<o&&de>=o&&y(O,Y,J,re,ce,o),we>l&&de<=l&&y(O,Y,J,re,ce,l)}let z=C[C.length-1];const F=f===0?z.x:z.y;F>=o&&F<=l&&O.push(z),O.length&&(z=O[O.length-1],O[0].x===z.x&&O[0].y===z.y||O.push(O[0]),E.push(O))}E.length&&p.push(E)}return p}function Cie(u,o){const l=DM(u),f=DM([o]),p=xj.intersection(l,f);return p==null?[]:bj(p)}function Iie(u,o){let f=DM(u,65536);for(;o.valid();o.next()){const[p,y]=o.get(),v=p.x*65536,E=p.y*65536,C=y.x*65536,O=y.y*65536,z=C-v,F=O-E,$=Math.hypot(z,F),Y=Math.trunc(F/$*3),J=-Math.trunc(z/$*3);f=xj.diff(f,[[[v,E],[C,O],[C+Y,O+J],[v+Y,E+J],[v,E]]])}return bj(f,1/65536)}function DM(u,o=1){return[u.map(l=>l.map(f=>[f.x*o,f.y*o]))]}function bj(u,o=1){return u.map(l=>l.map((f,p)=>{const y=f.map(v=>new Tt(v[0]*o,v[1]*o).round());return p>0&&y.reverse(),y}))}class LM{constructor(o,l){this.layoutVertexArray=new Ou,this.indexArray=new ia,this.lineIndexArray=new Lh,this.triangleSegments=new qi,this.lineSegments=new qi,this.programConfigurations=new zd(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new Yf)}update(o,l,f,p,y,v,E){this.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,uie.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,hie.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,l,f,p,y,v){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,l,f,p,y,v)}}class zM{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new LM(o,!1),this.elevationBufferData=new LM(o,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,l){}populate(o,l,f,p){this.hasPattern=PM("fill",this.layers,this.pixelRatio,l);const y=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:E,id:C,index:O,sourceLayerIndex:z}of o){const F=this.layers[0]._featureFilter.needGeometry,$=En(E,F);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),$,f))continue;const Y=y?y.evaluate($,{},f,l.availableImages):void 0,J={id:C,properties:E.properties,type:E.type,sourceLayerIndex:z,index:O,geometry:F?$.geometry:gn(E,f,p),patterns:{},sortKey:Y};v.push(J)}y&&v.sort((E,C)=>E.sortKey-C.sortKey);for(const E of v){const{geometry:C,index:O,sourceLayerIndex:z}=E;if(this.hasPattern){const F=CM("fill",this.layers,E,this.zoom,this.pixelRatio,l);this.patternFeatures.push(F)}else this.addFeature(E,C,O,f,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(o[O].feature,C,O,z,this.index)}}update(o,l,f,p,y,v,E){this.bufferData.update(o,l,f,p,y,v,E),this.elevationBufferData.update(o,l,f,p,y,v,E)}addFeatures(o,l,f,p,y,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,f,p,v,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,l,f,p,y,v=[],E,C){const O=LT(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,O,p,f,C):this.addGeometry(O,this.bufferData),this.bufferData.populatePaintArrays(o,f,y,v,p,E),this.elevationBufferData.populatePaintArrays(o,f,y,v,p,E)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,l,f,p,y){const v=new Array,E=RM.getElevationFeature(o,y);if(E){{const C=this.clipPolygonsToTile(l,1);C.length>0&&v.push({polygons:C,elevationFeature:E,elevationTileID:f})}for(const C of v)if(C.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Bl(C.elevationTileID));const z=C.elevationFeature.isTunnel();let F=0;o.properties.hasOwnProperty(fj)&&(F=+o.properties[fj]);for(const $ of C.polygons)this.elevatedStructures.addPortalCandidates(C.elevationFeature.id,$,z,C.elevationFeature,F)}C.elevationFeature.constantHeight==null&&(C.polygons=this.prepareElevatedPolygons(C.polygons,C.elevationFeature,C.elevationTileID));const O=new gj(f,C.elevationTileID);this.addElevatedGeometry(C.polygons,O,C.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p)}}else this.addGeometry(l,this.bufferData)}addElevatedGeometry(o,l,f,p,y){const v={elevation:f,elevationSampler:l,bias:p,index:y},[E,C]=this.addGeometry(o,this.elevationBufferData,v);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:E,max:C}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,E),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,C))}addGeometry(o,l,f){let p=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,v=null;f&&(v=f.elevationSampler.constantElevation(f.elevation,f.bias),v!=null&&(p=v,y=v));const E=(C,O,z)=>{if(f!=null)if(O.push(C),v!=null)l.elevatedLayoutVertexArray.emplaceBack(v),z.push(v);else{const F=f.elevationSampler.pointElevation(C,f.elevation,f.bias);l.elevatedLayoutVertexArray.emplaceBack(F),z.push(F),p=Math.min(p,F),y=Math.max(y,F)}};for(const C of o){let O=0;for(const ve of C)O+=ve.length;const z=l.triangleSegments.prepareSegment(O,l.layoutVertexArray,l.indexArray),F=z.vertexLength,$=[],Y=[],J=[],re=[],ce=[],de=l.layoutVertexArray.length;for(const ve of C){if(ve.length===0)continue;ve!==C[0]&&Y.push($.length/2);const ie=l.lineSegments.prepareSegment(ve.length,l.layoutVertexArray,l.lineIndexArray),ge=ie.vertexLength;f&&ce.push(l.layoutVertexArray.length-de),E(ve[0],J,re),l.layoutVertexArray.emplaceBack(ve[0].x,ve[0].y),l.lineIndexArray.emplaceBack(ge+ve.length-1,ge),$.push(ve[0].x),$.push(ve[0].y);for(let be=1;be<ve.length;be++)E(ve[be],J,re),l.layoutVertexArray.emplaceBack(ve[be].x,ve[be].y),l.lineIndexArray.emplaceBack(ge+be-1,ge+be),$.push(ve[be].x),$.push(ve[be].y);ie.vertexLength+=ve.length,ie.primitiveLength+=ve.length}const we=Kx($,Y);for(let ve=0;ve<we.length;ve+=3)l.indexArray.emplaceBack(F+we[ve],F+we[ve+1],F+we[ve+2]);if(we.length>0&&f&&this.elevationMode==="hd-road-base"){const ve=f.elevation.isTunnel(),ie=f.elevation.safeArea,ge=this.elevatedStructures.addVertices(J,re);this.elevatedStructures.addTriangles(we,ge,ve);const be=ce.length;if(be>0){for(let Ee=0;Ee<be-1;Ee++)this.elevatedStructures.addRenderableRing(f.index,ce[Ee]+ge,ce[Ee+1]-ce[Ee],ve,ie);this.elevatedStructures.addRenderableRing(f.index,ce[be-1]+ge,J.length-ce[be-1],ve,ie)}}z.vertexLength+=O,z.primitiveLength+=we.length/3}return[p,y]}prepareElevatedPolygons(o,l,f){const p=1/tt(f),y=[];for(const v of o){const E=Iie(v,new mj(l,p));y.push(...E)}return y}clipPolygonsToTile(o,l){const f=-l,p=-l,y=Kt+l,v=Kt+l;let E=0;const C=[],O=[];for(;E<o.length;E++){const $=o[E],Y=yd($);(Y.min.x>=f&&Y.max.x<=y&&Y.min.y>=p&&Y.max.y<=v?C:O).push($)}if(C.length===o.length)return o;const z=[new Tt(f,p),new Tt(y,p),new Tt(y,v),new Tt(f,v),new Tt(f,p)],F=C;for(const $ of O)F.push(...Cie($,z));return F}}let wj,Sj,Tj,Ej;dn(zM,"FillBucket",{omit:["layers","patternFeatures"]}),dn(LM,"FillBufferData"),dn(Bl,"ElevatedStructures");class NM{constructor(o,l,f,p){if(this.triangleCount=l.length/3,this.min=new Tt(0,0),this.max=new Tt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[y,v]=[o[0].clone(),o[0].clone()];for(let F=1;F<o.length;++F){const $=o[F];y.x=Math.min(y.x,$.x),y.y=Math.min(y.y,$.y),v.x=Math.max(v.x,$.x),v.y=Math.max(v.y,$.y)}if(p){const F=Math.ceil(Math.max(v.x-y.x,v.y-y.y)/p);f=Math.max(f,F)}if(f===0)return;this.min=y,this.max=v;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const C=Math.max(E.x,E.y)/f;this.cellsX=Math.max(1,Math.ceil(E.x/C)),this.cellsY=Math.max(1,Math.ceil(E.y/C)),this.xScale=1/C,this.yScale=1/C;const O=[];for(let F=0;F<this.triangleCount;F++){const $=o[l[3*F+0]].sub(this.min),Y=o[l[3*F+1]].sub(this.min),J=o[l[3*F+2]].sub(this.min),re=Bh(Math.floor(Math.min($.x,Y.x,J.x)),this.xScale,this.cellsX),ce=Bh(Math.floor(Math.max($.x,Y.x,J.x)),this.xScale,this.cellsX),de=Bh(Math.floor(Math.min($.y,Y.y,J.y)),this.yScale,this.cellsY),we=Bh(Math.floor(Math.max($.y,Y.y,J.y)),this.yScale,this.cellsY),ve=new Tt(0,0),ie=new Tt(0,0),ge=new Tt(0,0),be=new Tt(0,0);for(let Ee=de;Ee<=we;++Ee){ve.y=ie.y=Ee*C,ge.y=be.y=(Ee+1)*C;for(let Ue=re;Ue<=ce;++Ue)ve.x=ge.x=Ue*C,ie.x=be.x=(Ue+1)*C,(ji($,Y,J,ve,ie,be)||ji($,Y,J,ve,be,ge))&&O.push({cellIdx:Ee*this.cellsX+Ue,triIdx:F})}}if(O.length===0)return;O.sort((F,$)=>F.cellIdx-$.cellIdx||F.triIdx-$.triIdx);let z=0;for(;z<O.length;){const F=O[z].cellIdx,$={start:this.payload.length,len:0};for(;z<O.length&&O[z].cellIdx===F;)++$.len,this.payload.push(O[z++].triIdx);this.cells[F]=$}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,l){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const f=Bh(o.x-this.min.x,this.xScale,this.cellsX),p=Bh(o.y-this.min.y,this.yScale,this.cellsY),y=this.cells[p*this.cellsX+f];if(y){this._lazyInitLookup();for(let v=0;v<y.len;v++){const E=this.payload[y.start+v],C=Math.floor(E/8),O=1<<E%8;if(!(this.lookup[C]&O)&&(this.lookup[C]|=O,l.push(E),l.length===this.triangleCount))return}}}query(o,l,f){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>l.x||o.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const p=Bh(o.x-this.min.x,this.xScale,this.cellsX),y=Bh(l.x-this.min.x,this.xScale,this.cellsX),v=Bh(o.y-this.min.y,this.yScale,this.cellsY),E=Bh(l.y-this.min.y,this.yScale,this.cellsY);for(let C=v;C<=E;C++)for(let O=p;O<=y;O++){const z=this.cells[C*this.cellsX+O];if(z)for(let F=0;F<z.len;F++){const $=this.payload[z.start+F],Y=Math.floor($/8),J=1<<$%8;if(!(this.lookup[Y]&J)&&(this.lookup[Y]|=J,f.push($),f.length===this.triangleCount))return}}}}function Bh(u,o,l){return Math.max(0,Math.min(l-1,Math.floor(u*o)))}dn(NM,"TriangleGridIndex");class Aj{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(o,l){for(const f of this.footprints)l.push({footprint:f,id:o})}populate(o,l,f,p){const y=[];for(const{feature:v,id:E,index:C,sourceLayerIndex:O}of o){const z=this.layers[0]._featureFilter.needGeometry,F=En(v,z);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),F,f))continue;const $={id:E,properties:v.properties,type:v.type,sourceLayerIndex:O,index:C,geometry:z?F.geometry:gn(v,f,p),patterns:{}};y.push($)}for(const v of y){const{geometry:E,index:C,sourceLayerIndex:O}=v;this.addFeature(v,E,C,f,{},l.availableImages,l.brightness),l.featureIndex.insert(o[C].feature,E,C,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,l,f,p,y,v,E){}destroy(){}addFeature(o,l,f,p,y,v=[],E){for(const C of LT(l,2)){const O=[],z=[],F=[],$=new Tt(1/0,1/0),Y=new Tt(-1/0,-1/0);for(const ce of C)if(ce.length!==0){ce!==C[0]&&F.push(z.length/2);for(let de=0;de<ce.length;de++)z.push(ce[de].x),z.push(ce[de].y),O.push(ce[de]),$.x=Math.min($.x,ce[de].x),$.y=Math.min($.y,ce[de].y),Y.x=Math.max(Y.x,ce[de].x),Y.y=Math.max(Y.y,ce[de].y)}const J=Kx(z,F),re=new NM(O,J,8,256);this.footprints.push({vertices:O,indices:J,grid:re,min:$,max:Y})}}}dn(Aj,"ClipBucket",{omit:["layers"]});const Mie=zr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Oie=zr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),kie=zr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Rie=zr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Die=zr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Lie=zr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:zie}=Mie,FT=Number.MAX_SAFE_INTEGER;function Pj(u,o,l,f){return u.order<o||u.order===FT||!(u.clipMask&l)||function(p,y){return y.length!==0&&y.find(v=>v===p)===void 0}(f,u.clipScope)}function BT(u,o){return u.x-o.x||u.y-o.y}function Cj(u,o){return BT(u.min,o.min)===0&&BT(u.max,o.max)===0}function FM(u,o){return!(u.min.x>o.max.x||u.max.x<o.min.x||u.min.y>o.max.y||u.max.y<o.min.y)}function BM(u,o){if(u.length!==o.length)return!1;for(let l=0;l<u.length;l++)if(u[l].sourceId!==o[l].sourceId||!Cj(u[l],o[l])||u[l].order!==o[l].order||u[l].clipMask!==o[l].clipMask||!pi(u[l].clipScope,o[l].clipScope))return!1;return!0}function Ij(u,o,l){const f=1/Kt,p=1/(1<<l.canonical.z),y=(o.x*f+l.canonical.x)*p+l.wrap,v=(o.y*f+l.canonical.y)*p;return{min:new Tt((u.x*f+l.canonical.x)*p+l.wrap,(u.y*f+l.canonical.y)*p),max:new Tt(y,v)}}function Nie(u,o,l){const f=1<<l.canonical.z,p=((o.x-l.wrap)*f-l.canonical.x)*Kt,y=(o.y*f-l.canonical.y)*Kt;return{min:new Tt(((u.x-l.wrap)*f-l.canonical.x)*Kt,(u.y*f-l.canonical.y)*Kt),max:new Tt(p,y)}}function Mj(u,o,l,f,p,y,v){const E=u.indices,C=u.vertices,O=[];for(let z=f;z<f+p;z+=3){const F=o[l[z+0]+y],$=o[l[z+1]+y],Y=o[l[z+2]+y],J=Math.min(F.x,$.x,Y.x),re=Math.max(F.x,$.x,Y.x),ce=Math.min(F.y,$.y,Y.y),de=Math.max(F.y,$.y,Y.y);O.length=0,u.grid.query(new Tt(J,ce),new Tt(re,de),O);for(let we=0;we<O.length;we++){const ve=O[we];if(ji(C[E[3*ve+0]],C[E[3*ve+1]],C[E[3*ve+2]],F,$,Y,v))return!0}}return!1}function Oj(u,o,l,f){if(!u||!l)return!1;let p=u.vertices;if(!o.canonical.equals(f.canonical)||o.wrap!==f.wrap){if(l.vertices.length<u.vertices.length)return Oj(l,f,u,o);const y=o.canonical,v=f.canonical,E=Math.pow(2,v.z-y.z);p=u.vertices.map(C=>new Tt((C.x+y.x*Kt)*E-v.x*Kt,(C.y+y.y*Kt)*E-v.y*Kt))}return Mj(l,p,u.indices,0,u.indices.length,0,0)}function kj(u,o,l,f){const p=Math.pow(2,f.z-l.z);return new Tt((u+l.x*Kt)*p-f.x*Kt,(o+l.y*Kt)*p-f.y*Kt)}function Rj(u,o){const l=[];o.grid.queryPoint(u,l);const f=o.indices,p=o.vertices;for(let y=0;y<l.length;y++){const v=l[y];if(ai([p[f[3*v+0]],p[f[3*v+1]],p[f[3*v+2]]],u))return!0}return!1}const jM=[new Tt(0,0),new Tt(Kt,0),new Tt(Kt,Kt),new Tt(0,Kt)];function Dj(u,o){const l=[];let f=[];if(!o||u.length<2)return[u];if(u.length===2)return oo(u[0],u[1],jM)?[u]:[];for(let p=0;p<u.length+2;p++){const y=u[p%u.length],v=u[(p+1)%u.length],E=oo(p===0?u[u.length-1]:u[(p-1)%u.length],y,jM),C=oo(y,v,jM),O=E||C;O&&f.push(y),O&&C||f.length>0&&(f.length>1&&l.push(f),f=[])}return f.length>1&&l.push(f),l}const $M=lp.VectorTileFeature.types,Fie=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Bie=["fill-extrusion-flood-light-ground-radius"],jie=Math.pow(2,13),$ie=Math.pow(2,15)-1,Lj=new Tt(0,1),cp=2147483648;function t1(u,o,l,f,p,y,v,E){u.emplaceBack((o<<1)+v,(l<<1)+y,(Math.floor(f*jie)<<1)+p,Math.round(E))}function n1(u,o,l){u.emplaceBack(o.x*Kt,o.y*Kt,l?1:0)}function jT(u,o,l,f,p,y){u.emplaceBack(o.x,o.y,(l.x<<1)+f,(l.y<<1)+p,y)}function r1(u,o,l){u.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class zj{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Nj{constructor(){this.centroidXY=new Tt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Tt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Tt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Tt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Fj{constructor(){this.acc=new Tt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,l){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=l.x,o.min.y=o.max.y=l.y)}appendEdge(o,l,f){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<o.min.x?(o.min.x=l.x,p=!0):l.x>o.max.x&&(o.max.x=l.x,p=!0),l.y<o.min.y?(o.min.y=l.y,p=!0):l.y>o.max.y&&(o.max.y=l.y,p=!0),((l.x===0||l.x===Kt)&&l.x===f.x)!=((l.y===0||l.y===Kt)&&l.y===f.y)&&this.processBorderOverlap(l,f),p&&this.checkBorderIntersection(l,f)}checkBorderIntersection(o,l){l.x<0!=o.x<0&&this.addBorderIntersection(0,kn(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>Kt!=o.x>Kt&&this.addBorderIntersection(1,kn(l.y,o.y,(Kt-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,kn(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>Kt!=o.y>Kt&&this.addBorderIntersection(3,kn(l.x,o.x,(Kt-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];l<f[0]&&(f[0]=l),l>f[1]&&(f[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const f=o.x===0?0:1;this.addBorderIntersection(f,l.y),this.addBorderIntersection(f,o.y)}else{const f=o.y===0?2:3;this.addBorderIntersection(f,l.x),this.addBorderIntersection(f,o.x)}}centroid(){return this.accCount===0?new Tt(0,0):new Tt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0):0}}function Bj(u,o){const l=u.add(o)._unit(),f=$e(u.x*l.x+u.y*l.y,-1,1);var p,y,v;return p=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(p)))/4*$ie*((y=u).x*(v=o).y-y.y*v.x<0?-1:1)}const Uie=[u=>u.x<0,u=>u.x>Kt,u=>u.y<0,u=>u.y>Kt];function Vie(u,o,l,f){const p=[4];if(f===0)return p;l._mult(f);const y=u.sub(l),v=o.sub(l),E=[u,o,y,v];for(let C=0;C<4;C++)for(const O of E)if(Uie[C](O)){p.push(C);break}return p}class jj{constructor(o){this.vertexArray=new Lx,this.indexArray=new ia,this.programConfigurations=new zd(o.layers,{zoom:o.zoom,lut:o.lut},l=>Bie.includes(l)),this._segments=new qi,this.hiddenByLandmarkVertexArray=new gy,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new qi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,l,f,p=!1){const y=o.length;if(y>2){let v=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*y,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let C;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const O=o[0],z=o[1];C=Bj(O.sub(o[y-1])._perp()._unit(),z.sub(O)._perp()._unit())}for(let O=0;O<y;O++){const z=O===y-1?0:O+1,F=o[O],$=o[z],Y=o[z===y-1?0:z+1],J=$.sub(F)._perp()._unit(),re=Bj(J,Y.sub($)._perp()._unit()),ce=C,de=re;if(UM(F,$,l)||p&&Vj(F,l)&&Vj($,l)){C=re;continue}const we=E.vertexLength;jT(this.vertexArray,F,$,1,1,ce),jT(this.vertexArray,F,$,1,0,ce),jT(this.vertexArray,F,$,0,1,de),jT(this.vertexArray,F,$,0,0,de),E.vertexLength+=4;const ve=Vie(F,$,J,f);for(const ie of ve)this._segmentToGroundQuads[v].push({id:we,region:ie}),this._segmentToRegionTriCounts[v][ie]+=2,E.primitiveLength+=2;C=re}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),l=o.length;for(let f=0;f<l;f++)this._segmentToGroundQuads[f].sort((p,y)=>p.region-y.region);for(let f=0;f<l;f++){const p=this._segmentToGroundQuads[f],y=o[f],v=this._segmentToRegionTriCounts[f];v.reduce((C,O)=>C+O,0);let E=0;for(let C=0;C<=4;C++){const O=v[C];if(O!==0){let z=this.regionSegments[C];z||(z=this.regionSegments[C]=new qi);const F={vertexOffset:y.vertexOffset,primitiveOffset:y.primitiveOffset+E,vertexLength:y.vertexLength,primitiveLength:O};z.get().push(F)}E+=O}for(let C=0;C<p.length;C++){const O=p[C].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,l,f,p,y,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,l,f,p,y,v)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Oie.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,l,f,p,y,v,E){this.hasData()&&this.programConfigurations.updatePaintArrays(o,l,f,p,y,v,E)}updateHiddenByLandmark(o){if(!this.hasData())return;const l=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const f=o.flags&cp?1:0;for(let p=o.groundVertexArrayOffset;p<l;++p)this.hiddenByLandmarkVertexArray.emplace(p,f);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,Die.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const l=this.regionSegments[o];l&&l.destroy()}}}}class $T{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ia,this.footprintVertices=new Ou,this.footprintSegments=[],this.layoutVertexArray=new Rd,this.centroidVertexArray=new ST,this.wallVertexArray=new ET,this.indexArray=new ia,this.programConfigurations=new zd(o.layers,{zoom:o.zoom,lut:o.lut},l=>Fie.includes(l)),this.segments=new qi,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new jj(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,l){}populate(o,l,f,p){this.features=[],this.hasPattern=PM("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=tt(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:y,id:v,index:E,sourceLayerIndex:C}of o){const O=this.layers[0]._featureFilter.needGeometry,z=En(y,O);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),z,f))continue;const F={id:v,sourceLayerIndex:C,index:E,geometry:O?z.geometry:gn(y,f,p),properties:y.properties,type:y.type,patterns:{}},$=this.layoutVertexArray.length,Y=$M[F.type]==="Polygon";if(this.hasPattern)this.features.push(CM("fill-extrusion",this.layers,F,this.zoom,this.pixelRatio,l));else if(this.wallMode)for(const J of F.geometry)for(const re of Dj(J,Y))this.addFeature(F,[re],E,f,{},l.availableImages,p,l.brightness);else this.addFeature(F,F.geometry,E,f,{},l.availableImages,p,l.brightness);l.featureIndex.insert(y,F.geometry,E,C,this.index,$)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,l,f,p,y,v){for(const E of this.features){const C=$M[E.type]==="Polygon",{geometry:O}=E;if(this.wallMode)for(const z of O)for(const F of Dj(z,C))this.addFeature(E,[F],E.index,l,f,p,y,v);else this.addFeature(E,O,E.index,l,f,p,y,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,l,f,p,y,v,E){this.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E),this.groundEffect.update(o,l,y,f,p,v,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,zie),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,Rie.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Lie.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,kie.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,f,p,y,v,E,C){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,z=[new Tt(0,0),new Tt(Kt,Kt)],F=E.projection,$=F.name==="globe",Y=this.wallMode||$M[o.type]==="Polygon",J=new Fj;J.centroidDataIndex=this.centroidData.length;const re=new Nj,ce=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},p)<=0,de=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},p);let we;if(re.height=de,re.vertexArrayOffset=this.layoutVertexArray.length,re.groundVertexArrayOffset=this.groundEffect.vertexArray.length,$&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Dd),this.wallMode){if($)return void mr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;we=function(Ke){const Qe=Ke[0].x===Ke[Ke.length-1].x&&Ke[0].y===Ke[Ke.length-1].y;(function(Jt){let $t=0;const qn=Jt.length;for(let vn=0;vn<qn;vn++)$t+=(Jt[(vn+1)%qn].x-Jt[vn].x)*(Jt[(vn+1)%qn].y+Jt[vn].y);return $t>=0})(Ke)||(Ke=Ke.reverse());const Dt={geometry:[],joinNormals:[],indices:[]},Ct=[],kt=[],Bt=[];let _t=Ke.length;for(;_t>=2&&Ke[_t-1].equals(Ke[_t-2]);)_t--;if(_t<(Qe?3:2))return Dt;let Ot,pt,vt,Ut,Wt,Sn=0;for(;Sn<_t-1&&Ke[Sn].equals(Ke[Sn+1]);)Sn++;Qe&&(Ot=Ke[_t-2],Wt=Ke[Sn].sub(Ot)._unit()._perp());for(let Jt=Sn;Jt<_t;Jt++){if(vt=Jt===_t-1?Qe?Ke[Sn+1]:void 0:Ke[Jt+1],vt&&Ke[Jt].equals(vt))continue;Wt&&(Ut=Wt),Ot&&(pt=Ot),Ot=Ke[Jt],Wt=vt?vt.sub(Ot)._unit()._perp():Ut,Ut=Ut||Wt;let $t=Ut.add(Wt);$t.x===0&&$t.y===0||$t._unit();const qn=$t.x*Wt.x+$t.y*Wt.y,vn=qn!==0?1/qn:1/0,xn=Ut.x*Wt.y-Ut.y*Wt.x>0;let Vn="miter";const nr=2;Vn==="miter"&&vn>nr&&(Vn="bevel"),Vn==="bevel"&&(vn>100&&(Vn="flipbevel"),vn<nr&&(Vn="miter"));const rr=(gr,ur,lr,di)=>{const Pi=new Tt(gr.x,gr.y),Se=new Tt(gr.x,gr.y);Pi.x+=ur.x*di,Pi.y+=ur.y*di,Se.x-=ur.x*Math.max(lr,1),Se.y-=ur.y*Math.max(lr,1),Bt.push(ur),Ct.push(Pi),kt.push(Se)};if(Vn==="miter")$t._mult(vn),rr(Ot,$t,0,0);else if(Vn==="flipbevel")$t=Wt.mult(-1),rr(Ot,$t,0,0),rr(Ot,$t.mult(-1),0,0);else{const gr=-Math.sqrt(vn*vn-1),ur=xn?gr:0,lr=xn?0:gr;pt&&rr(Ot,Ut,ur,lr),vt&&rr(Ot,Wt,ur,lr)}}Dt.geometry=[...Ct,...kt.reverse(),Ct[0]],Dt.joinNormals=[...Bt,...Bt.reverse(),Bt[Bt.length-1]];const mn=Dt.geometry.length-1;for(let Jt=0;Jt<mn/2;Jt++)if(Jt+1<mn/2){let $t=Jt,qn=Jt+1,vn=mn-1-Jt,xn=mn-2-Jt;$t=$t===0?mn-1:$t-1,qn=qn===0?mn-1:qn-1,vn=vn===0?mn-1:vn-1,xn=xn===0?mn-1:xn-1,Dt.indices.push(vn),Dt.indices.push(qn),Dt.indices.push($t),Dt.indices.push(vn),Dt.indices.push(xn),Dt.indices.push(qn)}return Dt}(l[0]),l=[we.geometry]}const ve=(Ke,Qe)=>Ke<(Qe.length-1)/2||Ke===Qe.length-1,ie=this.wallMode?[l]:LT(l,500);for(let Ke=ie.length-1;Ke>=0;Ke--){const Qe=ie[Ke];(Qe.length===0||(ge=Qe[0]).every(xt=>xt.x<=0)||ge.every(xt=>xt.x>=Kt)||ge.every(xt=>xt.y<=0)||ge.every(xt=>xt.y>=Kt))&&ie.splice(Ke,1)}var ge;let be;if($)be=qj(ie,z,p);else{be=[];for(const Ke of ie)be.push({polygon:Ke,bounds:z})}const Ee=Y?this.edgeRadius:0,Ue=Ee>0&&this.zoom<17,qe=(Ke,Qe)=>{if(Ke.length===0)return!1;const xt=Ke[Ke.length-1];return Qe.x===xt.x&&Qe.y===xt.y};for(const{polygon:Ke,bounds:Qe}of be){let xt=0,Dt=0;for(const _t of Ke)Y&&!_t[0].equals(_t[_t.length-1])&&_t.push(_t[0]),Dt+=Y?_t.length-1:_t.length;const Ct=this.segments.prepareSegment((Y?5:4)*Dt,this.layoutVertexArray,this.indexArray);re.footprintSegIdx<0&&(re.footprintSegIdx=this.footprintSegments.length),re.polygonSegIdx<0&&(re.polygonSegIdx=this.polygonSegments.length);const kt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Bt=new zj;if(Bt.vertexOffset=this.footprintVertices.length,Bt.indexOffset=3*this.footprintIndices.length,Bt.ringIndices=[],Y){const _t=[],Ot=[];xt=Ct.vertexLength;for(let vt=0;vt<Ke.length;vt++){const Ut=Ke[vt];Ut.length&&vt!==0&&Ot.push(_t.length/2);const Wt=[];let Sn,mn;Sn=Ut[1].sub(Ut[0])._perp()._unit(),Bt.ringIndices.push(Ut.length-1);for(let Jt=1;Jt<Ut.length;Jt++){const $t=Ut[Jt],qn=Ut[Jt===Ut.length-1?1:Jt+1],vn=$t.clone();if(Ee){mn=qn.sub($t)._perp()._unit();const xn=Sn.add(mn)._unit(),Vn=Ee*Math.min(4,1/(Sn.x*xn.x+Sn.y*xn.y));vn.x+=Vn*xn.x,vn.y+=Vn*xn.y,vn.x=Math.round(vn.x),vn.y=Math.round(vn.y),Sn=mn}if(!ce||Ee!==0&&!Ue||qe(Wt,vn)||Wt.push(vn),t1(this.layoutVertexArray,vn.x,vn.y,0,0,1,1,0),this.wallMode){const xn=ve(Jt,Ut);n1(this.wallVertexArray,we.joinNormals[Jt],!xn)}Ct.vertexLength++,this.footprintVertices.emplaceBack($t.x,$t.y),_t.push($t.x,$t.y),$&&r1(this.layoutVertexExtArray,F.projectTilePoint(vn.x,vn.y,p),F.upVector(p,vn.x,vn.y))}ce&&(Ee===0||Ue)&&(Wt.length!==0&&qe(Wt,Wt[0])&&Wt.pop(),this.groundEffect.addData(Wt,Qe,O))}const pt=this.wallMode?we.indices:Kx(_t,Ot);for(let vt=0;vt<pt.length;vt+=3)this.footprintIndices.emplaceBack(Bt.vertexOffset+pt[vt+0],Bt.vertexOffset+pt[vt+1],Bt.vertexOffset+pt[vt+2]),this.indexArray.emplaceBack(xt+pt[vt],xt+pt[vt+2],xt+pt[vt+1]),Ct.primitiveLength++;Bt.indexCount+=pt.length,Bt.vertexCount+=this.footprintVertices.length-Bt.vertexOffset}for(let _t=0;_t<Ke.length;_t++){const Ot=Ke[_t];J.startRing(re,Ot[0]);let pt=Ot.length>4&&Wj(Ot[Ot.length-2],Ot[0],Ot[1]),vt=Ee?Wie(Ot[Ot.length-2],Ot[0],Ot[1],Ee):0;const Ut=[];let Wt,Sn,mn;Sn=Ot[1].sub(Ot[0])._perp()._unit();let Jt=!0;for(let $t=1,qn=0;$t<Ot.length;$t++){let vn=Ot[$t-1],xn=Ot[$t];const Vn=Ot[$t===Ot.length-1?1:$t+1];if(J.appendEdge(re,xn,vn),UM(xn,vn,Qe)){Ee&&(Sn=Vn.sub(xn)._perp()._unit(),Jt=!Jt);continue}const nr=xn.sub(vn)._perp(),rr=nr.x/(Math.abs(nr.x)+Math.abs(nr.y)),gr=nr.y>0?1:0,ur=vn.dist(xn);if(qn+ur>32768&&(qn=0),Ee){mn=Vn.sub(xn)._perp()._unit();let Se=Uj(vn,xn,Vn,$j(Sn,mn),Ee);isNaN(Se)&&(Se=0);const Ae=xn.sub(vn)._unit();vn=vn.add(Ae.mult(vt))._round(),xn=xn.add(Ae.mult(-Se))._round(),vt=Se,Sn=mn,ce&&this.zoom>=17&&(qe(Ut,vn)||Ut.push(vn),qe(Ut,xn)||Ut.push(xn))}const lr=Ct.vertexLength,di=Ot.length>4&&Wj(vn,xn,Vn);let Pi=Gj(qn,pt,Jt);if(t1(this.layoutVertexArray,vn.x,vn.y,rr,gr,0,0,Pi),t1(this.layoutVertexArray,vn.x,vn.y,rr,gr,0,1,Pi),this.wallMode){const Se=ve($t-1,Ot),Ae=we.joinNormals[$t-1];n1(this.wallVertexArray,Ae,Se),n1(this.wallVertexArray,Ae,Se)}if(qn+=ur,Pi=Gj(qn,di,!Jt),pt=di,t1(this.layoutVertexArray,xn.x,xn.y,rr,gr,0,0,Pi),t1(this.layoutVertexArray,xn.x,xn.y,rr,gr,0,1,Pi),this.wallMode){const Se=ve($t,Ot),Ae=we.joinNormals[$t];n1(this.wallVertexArray,Ae,Se),n1(this.wallVertexArray,Ae,Se)}if(Ct.vertexLength+=4,this.indexArray.emplaceBack(lr+0,lr+1,lr+2),this.indexArray.emplaceBack(lr+1,lr+3,lr+2),Ct.primitiveLength+=2,Ee){const Se=xt+($t===1?Ot.length-2:$t-2),Ae=$t===1?xt:Se+1;if(this.indexArray.emplaceBack(lr+1,Se,lr+3),this.indexArray.emplaceBack(Se,Ae,lr+3),Ct.primitiveLength+=2,Wt===void 0&&(Wt=lr),!UM(Vn,Ot[$t],Qe)){const bt=$t===Ot.length-1?Wt:Ct.vertexLength;this.indexArray.emplaceBack(lr+2,lr+3,bt),this.indexArray.emplaceBack(lr+3,bt+1,bt),this.indexArray.emplaceBack(lr+3,Ae,bt+1),Ct.primitiveLength+=3}Jt=!Jt}if($){const Se=this.layoutVertexExtArray,Ae=F.projectTilePoint(vn.x,vn.y,p),bt=F.projectTilePoint(xn.x,xn.y,p),Xt=F.upVector(p,vn.x,vn.y),tn=F.upVector(p,xn.x,xn.y);r1(Se,Ae,Xt),r1(Se,Ae,Xt),r1(Se,bt,tn),r1(Se,bt,tn)}}Y&&(xt+=Ot.length-1),ce&&Ee&&this.zoom>=17&&(Ut.length!==0&&qe(Ut,Ut[0])&&Ut.pop(),this.groundEffect.addData(Ut,Qe,O,Ee>0))}this.footprintSegments.push(Bt),kt.triangleCount=this.indexArray.length-kt.triangleArrayOffset,this.polygonSegments.push(kt),++re.footprintSegLen,++re.polygonSegLen}if(re.vertexCount=this.layoutVertexArray.length-re.vertexArrayOffset,re.groundVertexCount=this.groundEffect.vertexArray.length-re.groundVertexArrayOffset,re.vertexCount!==0){if(re.centroidXY=J.borders?Lj:this.encodeCentroid(J,re),this.centroidData.push(re),J.borders){this.featuresOnBorder.push(J);const Ke=this.featuresOnBorder.length-1;for(let Qe=0;Qe<J.borders.length;Qe++)J.borders[Qe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Qe].push(Ke)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,y,v,p,C),this.groundEffect.addPaintPropertiesData(o,f,y,v,p,C),this.maxHeight=Math.max(this.maxHeight,de)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((l,f)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}splitToSubtiles(){const o=[];for(let E=0;E<this.centroidData.length;E++){const C=this.centroidData[E],O=+(C.min.y+C.max.y>Kt),z=2*O+(+(C.min.x+C.max.x>Kt)^O);for(let F=0;F<C.polygonSegLen;F++){const $=C.polygonSegIdx+F;o.push({centroidIdx:E,subtile:z,polygonSegmentIdx:$,triangleSegmentIdx:this.polygonSegments[$].triangleSegIdx})}}const l=new ia;o.sort((E,C)=>E.triangleSegmentIdx===C.triangleSegmentIdx?E.subtile-C.subtile:E.triangleSegmentIdx-C.triangleSegmentIdx);let f=0,p=0,y=0;for(const E of o){if(E.triangleSegmentIdx!==f)break;y++}const v=o.length;for(;p!==o.length;){f=o[p].triangleSegmentIdx;let E=0,C=p,O=p;for(let z=C;z<y&&o[z].subtile===E;z++)O++;for(;C!==y;){const z=o[C];E=z.subtile;const F=this.centroidData[z.centroidIdx].min.clone(),$=this.centroidData[z.centroidIdx].max.clone(),Y={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let J=C;J<O;J++){const re=o[J],ce=this.polygonSegments[re.polygonSegmentIdx],de=this.centroidData[re.centroidIdx].min,we=this.centroidData[re.centroidIdx].max,ve=this.indexArray.uint16;for(let ie=ce.triangleArrayOffset;ie<ce.triangleArrayOffset+ce.triangleCount;ie++)l.emplaceBack(ve[3*ie],ve[3*ie+1],ve[3*ie+2]);Y.primitiveLength+=ce.triangleCount,F.x=Math.min(F.x,de.x),F.y=Math.min(F.y,de.y),$.x=Math.max($.x,we.x),$.y=Math.max($.y,we.y)}Y.primitiveLength>0&&this.triangleSubSegments.push({segment:Y,min:F,max:$}),C=O;for(let J=C;J<y&&o[J].subtile===o[C].subtile;J++)O++}p=y;for(let z=p;z<v&&o[z].triangleSegmentIdx===o[p].triangleSegmentIdx;z++)y++}l._trim(),this.indexArray=l}getVisibleSegments(o,l,f){const p=new qi;if(this.wallMode){for(const re of this.triangleSubSegments)p.segments.push(re.segment);return p}let y=0,v=0;const E=1<<o.canonical.z;if(l){const re=l.getMinMaxForTile(o);re&&(y=re.min,v=re.max)}v+=this.maxHeight;const C=o.toUnwrapped();let O;const z=[C.canonical.x/E+C.wrap,C.canonical.y/E],F=[(C.canonical.x+1)/E+C.wrap,(C.canonical.y+1)/E],$=(re,ce,de)=>[re[0]*(1-de[0])+ce[0]*de[0],re[1]*(1-de[1])+ce[1]*de[1]],Y=[],J=[];for(const re of this.triangleSubSegments){Y[0]=re.min.x/Kt,Y[1]=re.min.y/Kt,J[0]=re.max.x/Kt,J[1]=re.max.y/Kt;const ce=$(z,F,Y),de=$(z,F,J);if(new Li([ce[0],ce[1],y],[de[0],de[1],v]).intersectsPrecise(f)===0){O&&(p.segments.push(O),O=void 0);continue}const we=re.segment;O&&O.vertexOffset!==we.vertexOffset&&(p.segments.push(O),O=void 0),O?(O.vertexLength+=we.vertexLength,O.primitiveLength+=we.primitiveLength):O={vertexOffset:we.vertexOffset,primitiveLength:we.primitiveLength,vertexLength:we.vertexLength,primitiveOffset:we.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&p.segments.push(O),p}encodeCentroid(o,l){const f=o.centroid(),p=l.span(),y=Math.min(7,Math.round(p.x*this.tileToMeter/10)),v=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new Tt($e(f.x,1,Kt-1)<<3|y,$e(f.y,1,Kt-1)<<3|v)}encodeBorderCentroid(o){if(!o.borders)return new Tt(0,0);const l=o.borders,f=Number.MAX_VALUE;if(l[0][0]!==f||l[1][0]!==f){const p=l[0][0]!==f?0:1;return new Tt(6|(l[0][0]!==f?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{const p=l[2][0]!==f?2:3;return new Tt((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==f?0:65528))}}showCentroid(o){const l=this.centroidData[o.centroidDataIndex];l.flags&=cp,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const l=o.vertexArrayOffset,f=o.vertexCount+o.vertexArrayOffset,p=o.flags&cp?Lj:o.centroidXY,y=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||y!==p.x){for(let v=l;v<f;++v)this.centroidVertexArray.emplace(v,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,l,f){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(o.toUnwrapped());if(BM(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const y=[];for(const v of this.activeReplacements){if(v.order<f)continue;const E=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-o.canonical.z));for(const C of this.centroidData)if(!(C.flags&cp||v.min.x>C.max.x||C.min.x>v.max.x||v.min.y>C.max.y||C.min.y>v.max.y))for(let O=0;O<C.footprintSegLen;O++){const z=this.footprintSegments[C.footprintSegIdx+O];if(y.length=0,Gie(this.footprintVertices,z.vertexOffset,z.vertexCount,v.footprintTileId.canonical,o.canonical,y),Mj(v.footprint,y,this.footprintIndices.uint16,z.indexOffset,z.indexCount,-z.vertexOffset,-E)){C.flags|=cp;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,l,f){let p=!1;for(let y=0;y<f.footprintSegLen;y++){const v=this.footprintSegments[f.footprintSegIdx+y];let E=0;for(const C of v.ringIndices){for(let O=E,z=C+E-1;O<C+E;z=O++){const F=this.footprintVertices.int16[2*(O+v.vertexOffset)+0],$=this.footprintVertices.int16[2*(O+v.vertexOffset)+1],Y=this.footprintVertices.int16[2*(z+v.vertexOffset)+1];$>l!=Y>l&&o<(this.footprintVertices.int16[2*(z+v.vertexOffset)+0]-F)*(l-$)/(Y-$)+F&&(p=!p)}E=C}}return p}getHeightAtTileCoord(o,l){let f=Number.NEGATIVE_INFINITY,p=!0;const y=4*(o+Kt)*Kt+(l+Kt);if(this.partLookup.hasOwnProperty(y)){const v=this.partLookup[y];return v?{height:v.height,hidden:!!(v.flags&cp)}:void 0}for(const v of this.centroidData)o>v.max.x||v.min.x>o||l>v.max.y||v.min.y>l||this.footprintContainsPoint(o,l,v)&&v&&v.height>f&&(f=v.height,this.partLookup[y]=v,p=!!(v.flags&cp));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:p};this.partLookup[y]=void 0}}function $j(u,o){const l=u.add(o)._unit();return u.x*l.x+u.y*l.y}function Wie(u,o,l,f){const p=o.sub(u)._perp()._unit(),y=l.sub(o)._perp()._unit();return Uj(u,o,l,$j(p,y),f)}function Uj(u,o,l,f,p){const y=Math.sqrt(1-f*f);return Math.min(u.dist(o)/3,o.dist(l)/3,p*y/f)}function UM(u,o,l){return u.x<l[0].x&&o.x<l[0].x||u.x>l[1].x&&o.x>l[1].x||u.y<l[0].y&&o.y<l[0].y||u.y>l[1].y&&o.y>l[1].y}function Vj(u,o){return u.x<o[0].x||u.x>o[1].x||u.y<o[0].y||u.y>o[1].y}function Wj(u,o,l){if(u.x<0||u.x>=Kt||o.x<0||o.x>=Kt||l.x<0||l.x>=Kt)return!1;const f=l.sub(o),p=f.perp(),y=u.sub(o);return(f.x*y.x+f.y*y.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(y.x*y.x+y.y*y.y))>-.866&&p.x*y.x+p.y*y.y<0}function Gj(u,o,l){const f=o?2|u:-3&u;return l?1|f:-2&f}function Hj(){const u=Math.PI/32,o=Math.tan(u),l=oe;return l*Math.sqrt(1+2*o*o)-l}function qj(u,o,l){const f=1<<l.z,p=Ve(l.x/f),y=Ve((l.x+1)/f),v=Ge(l.y/f),E=Ge((l.y+1)/f);return function(C,O,z,F,$=0,Y){const J=[];if(!C.length||!z||!F)return J;const re=(be,Ee)=>{for(const Ue of be)J.push({polygon:Ue,bounds:Ee})},ce=Math.ceil(Math.log2(z)),de=Math.ceil(Math.log2(F)),we=ce-de,ve=[];for(let be=0;be<Math.abs(we);be++)ve.push(we>0?0:1);for(let be=0;be<Math.min(ce,de);be++)ve.push(0),ve.push(1);let ie=C;if(ie=NT(ie,O[0].y-$,O[1].y+$,1),ie=NT(ie,O[0].x-$,O[1].x+$,0),!ie.length)return J;const ge=[];for(ve.length?ge.push({polygons:ie,bounds:O,depth:0}):re(ie,O);ge.length;){const be=ge.pop(),Ee=be.depth,Ue=ve[Ee],qe=be.bounds[0],Ke=be.bounds[1],Qe=Ue===0?qe.x:qe.y,xt=Ue===0?Ke.x:Ke.y,Dt=Y?Y(Ue,Qe,xt):.5*(Qe+xt),Ct=NT(be.polygons,Qe-$,Dt+$,Ue),kt=NT(be.polygons,Dt-$,xt+$,Ue);if(Ct.length){const Bt=[qe,new Tt(Ue===0?Dt:Ke.x,Ue===1?Dt:Ke.y)];ve.length>Ee+1?ge.push({polygons:Ct,bounds:Bt,depth:Ee+1}):re(Ct,Bt)}if(kt.length){const Bt=[new Tt(Ue===0?Dt:qe.x,Ue===1?Dt:qe.y),Ke];ve.length>Ee+1?ge.push({polygons:kt,bounds:Bt,depth:Ee+1}):re(kt,Bt)}}return J}(u,o,Math.ceil((y-p)/11.25),Math.ceil((v-E)/11.25),1,(C,O,z)=>{if(C===0)return .5*(O+z);{const F=Ge((l.y+O/Kt)/f);return(Re(.5*(Ge((l.y+z/Kt)/f)+F))*f-l.y)*Kt}})}function Gie(u,o,l,f,p,y){const v=Math.pow(2,f.z-p.z);for(let E=0;E<l;E++){let C=u.int16[2*(E+o)+0],O=u.int16[2*(E+o)+1];C=(C+p.x*Kt)*v-f.x*Kt,O=(O+p.y*Kt)*v-f.y*Kt,y.push(new Tt(C,O))}}let Zj,Xj;dn($T,"FillExtrusionBucket",{omit:["layers","features"]}),dn(Nj,"PartData"),dn(zj,"FootprintSegment"),dn(Fj,"BorderCentroidData"),dn(jj,"GroundEffect");class yg extends Tt{constructor(o,l,f){super(o,l),this.z=f}}class Kj extends yg{constructor(o,l,f,p){super(o,l,f),this.w=p}}function Yj(u,o,l,f){const p=l==="x"?"y":"x",y=(f-u[l])/(o[l]-u[l]);u[p]=Math.round(u[p]+(o[p]-u[p])*y),u[l]=f,u.hasOwnProperty("z")&&(u.z=kn(u.z,o.z,y)),u.hasOwnProperty("w")&&(u.w=kn(u.w,o.w,y))}function Jj(u,o,l,f){const p=l,y=f;for(const v of["x","y"]){let E=u,C=o;E[v]>=C[v]&&(E=o,C=u),E[v]<p&&C[v]>p&&Yj(E,C,v,p),E[v]<y&&C[v]>y&&Yj(C,E,v,y)}}function UT(u,o,l,f,p,y){const v=[];for(let E=0;E<u.length;E++){const C=u[E];let O;const z=v.length;let F=0;for(let $=0;$<C.length-1;$++){let Y=C[$],J=C[$+1],re=0;const ce=F;let de,we;y&&(re=Math.hypot(J.x-Y.x,J.y-Y.y),F+=re,de=Y,we=J),Y.x<o&&J.x<o||(Y.x<o?Y=new Tt(o,Y.y+(o-Y.x)/(J.x-Y.x)*(J.y-Y.y))._round():J.x<o&&(J=new Tt(o,Y.y+(o-Y.x)/(J.x-Y.x)*(J.y-Y.y))._round()),Y.y<l&&J.y<l||(Y.y<l?Y=new Tt(Y.x+(l-Y.y)/(J.y-Y.y)*(J.x-Y.x),l)._round():J.y<l&&(J=new Tt(Y.x+(l-Y.y)/(J.y-Y.y)*(J.x-Y.x),l)._round()),Y.x>=f&&J.x>=f||(Y.x>=f?Y=new Tt(f,Y.y+(f-Y.x)/(J.x-Y.x)*(J.y-Y.y))._round():J.x>=f&&(J=new Tt(f,Y.y+(f-Y.x)/(J.x-Y.x)*(J.y-Y.y))._round()),Y.y>=p&&J.y>=p||(Y.y>=p?Y=new Tt(Y.x+(p-Y.y)/(J.y-Y.y)*(J.x-Y.x),p)._round():J.y>=p&&(J=new Tt(Y.x+(p-Y.y)/(J.y-Y.y)*(J.x-Y.x),p)._round()),O&&Y.equals(O[O.length-1])||(O=[Y],v.push(O),y&&y.push({progress:{min:ce+Qj(de,we,Y)*re,max:1},parentIndex:E,prevPoint:de,nextPoint:we})),O.push(J),y&&(y[y.length-1].progress.max=ce+Qj(de,we,J)*re,y[y.length-1].nextPoint=we)))))}if(y&&F>0)for(let $=z;$<v.length;$++)y[$].progress.min/=F,y[$].progress.max/=F}return v}function Hie(u,o,l,f,p){if(u.length<2)return void f.push(u);const y=[];for(;o.valid();){const[O,z]=o.get();for(let F=0;F<u.length-1;F++){const $=u[F],Y=u[F+1],J=Hi($,Y,O,z);if(J){const[re]=J,ce=new Tt(kn($.x,Y.x,re),kn($.y,Y.y,re));y.push({t:F+re,distance:0,point:ce})}}o.next()}if(y.length===0)return void f.push(u);y.sort((O,z)=>O.t-z.t);let v=0,E=0,C=[];for(f.push(C);v!==u.length;){if(E===y.length){for(;v!==u.length;)C.length!==0&&C[C.length-1].equals(u[v])||C.push(u[v]),v++;break}y[E].t<=v?(C.length!==0&&C[C.length-1].equals(y[E].point)||C.push(y[E].point),Math.trunc(y[E].t),E++):(C.length!==0&&C[C.length-1].equals(u[v])||C.push(u[v]),v++)}}function Qj(u,o,l){return u.x!==o.x?(l.x-u.x)/(o.x-u.x):u.y!==o.y?(l.y-u.y)/(o.y-u.y):0}function i1(u,o){return u.x*o.x+u.y*o.y}function e4(u,o){if(u.length===1){let l=0;const f=o[l++];let p;for(;!p||f.equals(p);)if(p=o[l++],!p)return 1/0;for(;l<o.length;l++){const y=o[l],v=u[0],E=p.sub(f),C=y.sub(f),O=v.sub(f),z=i1(E,E),F=i1(E,C),$=i1(C,C),Y=i1(O,E),J=i1(O,C),re=z*$-F*F,ce=($*Y-F*J)/re,de=(z*J-F*Y)/re,we=f.z*(1-ce-de)+p.z*ce+y.z*de;if(isFinite(we))return we}return 1/0}{let l=1/0;for(const f of o)l=Math.min(l,f.z);return l}}function t4(u,o,l,f,p,y,v,E){const C=v*p.getElevationAt(u,o,!0,!0),O=y[0]!==0,z=O?y[1]===0?v*(y[0]/7-450):v*function(F,$,Y){const J=Math.floor($[0]/8),re=Math.floor($[1]/8),ce=10*($[0]-8*J),de=10*($[1]-8*re),we=F.getElevationAt(J,re,!0,!0),ve=F.getMeterToDEM(Y),ie=Math.floor(.5*(ce*ve-1)),ge=Math.floor(.5*(de*ve-1)),be=F.tileCoordToPixel(J,re),Ee=2*ie+1,Ue=2*ge+1,qe=function(kt,Bt,_t,Ot,pt){return[kt.getElevationAtPixel(Bt,_t,!0),kt.getElevationAtPixel(Bt+pt,_t,!0),kt.getElevationAtPixel(Bt,_t+pt,!0),kt.getElevationAtPixel(Bt+Ot,_t+pt,!0)]}(F,be.x-ie,be.y-ge,Ee,Ue),Ke=Math.abs(qe[0]-qe[1]),Qe=Math.abs(qe[2]-qe[3]),xt=Math.abs(qe[0]-qe[2])+Math.abs(qe[1]-qe[3]),Dt=Math.min(.25,.5*ve*(Ke+Qe)/Ee),Ct=Math.min(.25,.5*ve*xt/Ue);return we+Math.max(Dt*ce,Ct*de)}(p,y,E):C;return{base:C+(l===0?-1:l),top:O?Math.max(z+f,C+l+2):C+f}}const qie=zr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Zie=zr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Xie}=qie,Kie=zr([{name:"a_packed",components:3,type:"Float32"}]),{members:Yie}=Kie,Jie=zr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Qie}=Jie;class n4{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new sp({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const f=this.getKey(o,l);return this.positions[f]}trim(){const o=this.width,l=this.height=pn(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,f){const p=[];let y=o.length%2==1?-o[o.length-1]*f:0,v=o[0]*f,E=!0;p.push({left:y,right:v,isDash:E,zeroLength:o[0]===0});let C=o[0];for(let O=1;O<o.length;O++){E=!E;const z=o[O];y=C*f,C+=z,v=C*f,p.push({left:y,right:v,isDash:E,zeroLength:z===0})}return p}addRoundDash(o,l,f){const p=l/2;for(let y=-f;y<=f;y++){const v=this.width*(this.nextRow+f+y);let E=0,C=o[E];for(let O=0;O<this.width;O++){O/C.right>1&&(C=o[++E]);const z=Math.abs(O-C.left),F=Math.abs(O-C.right),$=Math.min(z,F);let Y;const J=y/f*(p+1);if(C.isDash){const re=p-Math.abs(J);Y=Math.sqrt($*$+re*re)}else Y=p-Math.sqrt($*$+J*J);this.image.data[v+O]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(o,l){for(let C=o.length-1;C>=0;--C){const O=o[C],z=o[C+1];O.zeroLength?o.splice(C,1):z&&z.isDash===O.isDash&&(z.left=O.left,o.splice(C,1))}const f=o[0],p=o[o.length-1];f.isDash===p.isDash&&(f.left=p.left-this.width,p.right=f.right+this.width);const y=this.width*this.nextRow;let v=0,E=o[v];for(let C=0;C<this.width;C++){C/E.right>1&&(E=o[++v]);const O=Math.abs(C-E.left),z=Math.abs(C-E.right),F=Math.min(O,z);this.image.data[y+C]=Math.max(0,Math.min(255,(E.isDash?F:-F)+l+128))}}addDash(o,l){const f=this.getKey(o,l);if(this.positions[f])return this.positions[f];const p=l==="round",y=p?7:0,v=2*y+1;if(this.nextRow+v>this.height)return mr("LineAtlas out of space"),null;o.length===0&&o.push(1);let E=0;for(let z=0;z<o.length;z++)o[z]<0&&(mr("Negative value is found in line dasharray, replacing values with 0"),o[z]=0),E+=o[z];if(E!==0){const z=this.width/E,F=this.getDashRanges(o,this.width,z);p?this.addRoundDash(F,z,y):this.addRegularDash(F,l==="square"?.5*z:0)}const C=this.nextRow+y;this.nextRow+=v;const O={tl:[C,y],br:[E,0]};return this.positions[f]=O,O}}dn(n4,"LineAtlas");const eoe=lp.VectorTileFeature.types,toe=Math.cos(Math.PI/180*37.5),noe=Math.cos(Math.PI/180*5);class VM{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new zx,this.layoutVertexArray2=new Uc,this.patternVertexArray=new Uc,this.indexArray=new ia,this.programConfigurations=new zd(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new qi,this.maxLineLength=0,this.zOffsetVertexArray=new Uc,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:Kt/64}updateFootprints(o,l){}populate(o,l,f,p){this.hasPattern=PM("line",this.layers,this.pixelRatio,l);const y=this.layers[0].layout.get("line-sort-key");this.tileToMeter=tt(f);const v=this.layers[0].layout.get("line-elevation-reference");if(v==="hd-road-markup")this.elevationType="road";else{const $=this.layers[0].layout.get("line-z-offset"),Y=$.isConstant()&&!$.constantOr(0);this.elevationType=v!=="sea"&&v!=="ground"&&Y?"none":"offset",this.elevationType==="offset"&&v==="none"&&mr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const E=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&E!==void 0;const C=[];for(const{feature:$,id:Y,index:J,sourceLayerIndex:re}of o){const ce=this.layers[0]._featureFilter.needGeometry,de=En($,ce);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),de,f))continue;const we=y?y.evaluate(de,{},f):void 0,ve={id:Y,properties:$.properties,type:$.type,sourceLayerIndex:re,index:J,geometry:ce?de.geometry:gn($,f,p),patterns:{},sortKey:we};C.push(ve)}y&&C.sort(($,Y)=>$.sortKey-Y.sortKey);const{lineAtlas:O,featureIndex:z}=l,F=this.addConstantDashes(O);for(const $ of C){const{geometry:Y,index:J,sourceLayerIndex:re}=$;if(F&&this.addFeatureDashes($,O),this.hasPattern){const ce=CM("line",this.layers,$,this.zoom,this.pixelRatio,l);this.patternFeatures.push(ce)}else this.addFeature($,Y,J,f,O.positions,l.availableImages,l.brightness,l.elevationFeatures);z.insert(o[J].feature,Y,J,re,this.index)}}addConstantDashes(o){let l=!1;for(const f of this.layers){const p=f.paint.get("line-dasharray").value,y=f.layout.get("line-cap").value;if(p.kind!=="constant"||y.kind!=="constant")l=!0;else{const v=y.value,E=p.value;if(!E)continue;o.addDash(E,v)}}return l}addFeatureDashes(o,l){const f=this.zoom;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if(y.kind==="constant"&&v.kind==="constant")continue;let E,C;if(y.kind==="constant"){if(E=y.value,!E)continue}else E=y.evaluate({zoom:f},o);C=v.kind==="constant"?v.value:v.evaluate({zoom:f},o),l.addDash(E,C),o.patterns[p.id]=[l.getKey(E,C)]}}update(o,l,f,p,y,v,E){this.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E)}addFeatures(o,l,f,p,y,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,f,p,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Yie)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Qie)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Zie.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Xie),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,f,p,y,v,E,C){const O=this.layers[0].layout,z=O.get("line-join").evaluate(o,{}),F=O.get("line-cap").evaluate(o,{}),$=O.get("line-miter-limit"),Y=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=O.get("line-z-offset").value;const J=this.layers[0].paint.get("line-width").value;if(J.kind!=="constant"&&J.isLineProgressConstant===!1&&(this.variableWidthValue=J),this.elevationType==="road"){const re=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(o,l,p,C,z,F,$,Y)){const[ce,de]=this.clipRuntimeLinesToTile(l,1);for(let we=0;we<ce.length;we++){const ve=ce[we],ie=de[we],ge={progress:{min:ie.progress.min,max:ie.progress.max},nextDir:this.computeSegNextDir(ie,ve),prevDir:this.computeSegPrevDir(ie,ve)};this.addLine(ve,o,p,z,F,$,Y,ge)}this.fillNonElevatedRoadSegment(re)}}else for(const re of l)this.addLine(re,o,p,z,F,$,Y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,y,v,p,E)}computeSegNextDir(o,l){return o.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(o,l){return l[1].sub(o.prevPoint).unit()}clipLinesToTile(o,l){return UT(o,-l,-l,Kt+l,Kt+l)}clipRuntimeLinesToTile(o,l){const f=[];return[UT(o,-l,-l,Kt+l,Kt+l,f),f]}addElevatedRoadFeature(o,l,f,p,y,v,E,C){const O=[],z=RM.getElevationFeature(o,p);if(z){const F=this.clipLinesToTile(l,1),$=this.prepareElevatedLines(F,z,f);for(const Y of $)O.push({geometry:Y,elevation:z,elevationTileID:f,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(O.length===0)return!1;for(const F of O){const $=this.layoutVertexArray.length;this.addLine(F.geometry,o,f,y,v,E,C);const Y=new gj(f,F.elevationTileID);if(F.elevation)for(let J=$;J<this.layoutVertexArray.length;J++){const re=new Tt(this.layoutVertexArray.int16[6*J]>>1,this.layoutVertexArray.int16[6*J+1]>>1),ce=Y.pointElevation(re,F.elevation,.05);this.updateHeightRange(ce),this.zOffsetVertexArray.emplaceBack(ce,0,0)}else this.fillNonElevatedRoadSegment($)}return!0}prepareElevatedLines(o,l,f){if(l.constantHeight!=null)return o;const p=[],y=1/tt(f);for(const v of o)Hie(v,new mj(l,y),0,p);return p}fillNonElevatedRoadSegment(o){for(let l=o;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(o){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,o),this.heightRange.max=Math.max(this.heightRange.max,o)):this.heightRange={min:o,max:o}}addLine(o,l,f,p,y,v,E,C){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=p==="none";this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const z=C&&C.progress.min>0,F=C&&C.progress.max<1;if(this.lineClips){let Ue={min:this.lineClips.start,max:this.lineClips.end},qe=1;if(C){const xt=this.lineClips.end-this.lineClips.start;Ue=function(Dt,Ct,kt){return{min:xo(Dt.min,Ct,kt),max:xo(Dt.max,Ct,kt)}}(C.progress,{min:0,max:1},Ue),xt>0&&(qe=(Ue.max-Ue.min)/xt)}const Ke=+l.properties.mapbox_clip_feature_len,Qe=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(Ke)||Number.isNaN(Qe)){for(let Dt=0;Dt<o.length-1;Dt++)this.totalDistance+=o[Dt].dist(o[Dt+1]);const xt=this.totalDistance/(Ue.max-Ue.min);this.totalFeatureLength=Number.isFinite(xt)?xt:0,this.lineClips.start=Ue.min,this.lineClips.end=Ue.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ke,this.distance=Qe*qe,this.lineClips.start=Ue.min,this.lineClips.end=Ue.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const $=eoe[l.type]==="Polygon";let Y=o.length;for(;Y>=2&&o[Y-1].equals(o[Y-2]);)Y--;let J=0;for(;J<Y-1&&o[J].equals(o[J+1]);)J++;if(Y<($?3:2))return;p==="bevel"&&(v=1.05);const re=this.segments.prepareSegment(10*Y,this.layoutVertexArray,this.indexArray);let ce,de,we,ve,ie,ge,be,Ee;C&&C.prevDir&&(ge=C.prevDir.perp()),C&&C.nextDir&&(be=C.nextDir.perp()),this.e1=this.e2=-1,$&&(ce=o[Y-2],ie=o[J].sub(ce)._unit()._perp());for(let Ue=J;Ue<Y;Ue++){if(we=Ue===Y-1?$?o[J+1]:void 0:o[Ue+1],we&&o[Ue].equals(we))continue;ie&&(ve=ie),ce&&(de=ce),ce=o[Ue],Ee=this.evaluateLineProgressFeatures(de?de.dist(ce):0),ie=we?we.sub(ce)._unit()._perp():ve,ve=ve||ie;const qe=de&&we;let Ke=qe?p:$||O?"butt":y;const Qe=ve.x*ie.x+ve.y*ie.y;if(O){const pt=function(vt){if(vt.patternJoinNone){const Ut=vt.segmentPoints.length/2,Wt=vt.lineSoFar-vt.segmentStart;for(let Sn=0;Sn<Ut;++Sn){const mn=vt.segmentPoints[2*Sn+1],Jt=Math.round(vt.segmentPoints[2*Sn])+.5+.25*mn;vt.patternVertexArray.emplaceBack(Jt,Wt,vt.segmentStart),vt.patternVertexArray.emplaceBack(Jt,Wt,vt.segmentStart)}vt.segmentPoints.length=0}vt.e1=vt.e2=-1};if(qe&&Qe<noe){this.updateDistance(de,ce),this.addCurrentVertex(ce,ve,1,1,re,Ee),pt(this),this.addCurrentVertex(ce,ie,-1,-1,re,Ee);continue}if(de){if(!we){this.updateDistance(de,ce),this.addCurrentVertex(ce,ve,1,1,re,Ee),pt(this);continue}Ke="miter"}}let xt=ve.add(ie);xt.x===0&&xt.y===0||xt._unit();const Dt=xt.x*ie.x+xt.y*ie.y,Ct=Dt!==0?1/Dt:1/0,kt=2*Math.sqrt(2-2*Dt),Bt=Dt<toe&&de&&we,_t=ve.x*ie.y-ve.y*ie.x>0,Ot=this.overscaling<=16?15*Kt/(512*this.overscaling):0;if(qe&&Ke==="round"){if(Ct<E)Ke="miter";else if(Ct<=2){const pt=WM(ce,-10,Kt+10);Ke=this.elevationType==="offset"&&(pt||this.hasCrossSlope)?"miter":"fakeround"}}if(Ke==="miter"&&Ct>v&&(Ke="bevel"),Ke==="bevel"&&(Ct>2&&(Ke="flipbevel"),Ct<v&&(Ke="miter")),de&&!(Ke==="miter"&&Bt)&&this.updateDistance(de,ce),Ke==="miter")if(Bt){const pt=ce.dist(de);if(pt>2*Ot){const Ut=ce.sub(ce.sub(de)._mult(Ot/pt)._round());this.updateDistance(de,Ut),this.addCurrentVertex(Ut,ve,0,0,re,Ee),de=Ut}this.updateDistance(de,ce),xt._mult(Ct),this.addCurrentVertex(ce,xt,0,0,re,Ee);const vt=ce.dist(we);if(vt>2*Ot){const Ut=ce.add(we.sub(ce)._mult(Ot/vt)._round());this.updateDistance(ce,Ut),this.addCurrentVertex(Ut,ie,0,0,re,Ee),ce=Ut}}else xt._mult(Ct),this.addCurrentVertex(ce,xt,0,0,re,Ee);else if(Ke==="flipbevel"){if(Ct>100)xt=ie.mult(-1);else{const pt=Ct*ve.add(ie).mag()/ve.sub(ie).mag();xt._perp()._mult(pt*(_t?-1:1))}this.addCurrentVertex(ce,xt,0,0,re,Ee),this.addCurrentVertex(ce,xt.mult(-1),0,0,re,Ee)}else if(Ke==="bevel"||Ke==="fakeround"){Ee!=null&&de&&this.addCurrentVertex(ce,be||ve,-1,-1,re,Ee);const pt=ce.dist(de)<=2*Ot&&Ke!=="bevel",vt=xt.mult(_t?1:-1);vt._mult(Ct);const Ut=ie.mult(_t?-1:1),Wt=ve.mult(_t?-1:1),Sn=this.evaluateLineProgressFeatures(this.distance);if(Ee==null&&(this.addHalfVertex(ce,vt.x,vt.y,!1,!_t,0,re,Sn),pt||this.addHalfVertex(ce,vt.x+2*Wt.x,vt.y+2*Wt.y,!1,_t,0,re,Sn)),Ke==="fakeround"){const mn=Math.round(180*kt/Math.PI/20);this.addHalfVertex(ce,Wt.x,Wt.y,!1,_t,0,re,Sn);for(let Jt=0;Jt<mn;Jt++){let $t=Jt/mn;if($t!==.5){const vn=$t-.5;$t+=$t*vn*($t-1)*((1.0904+Qe*(Qe*(3.55645-1.43519*Qe)-3.2452))*vn*vn+(.848013+Qe*(.215638*Qe-1.06021)))}const qn=Ut.sub(Wt)._mult($t)._add(Wt)._unit();this.addHalfVertex(ce,qn.x,qn.y,!1,_t,0,re,Sn)}this.addHalfVertex(ce,Ut.x,Ut.y,!1,_t,0,re,Sn)}pt||Ee!=null||this.addHalfVertex(ce,vt.x+2*Ut.x,vt.y+2*Ut.y,!1,_t,0,re,Sn),Ee!=null&&we&&this.addCurrentVertex(ce,ge||ie,1,1,re,Ee)}else if(Ke==="butt")this.addCurrentVertex(ce,xt,0,0,re,Ee);else if(Ke==="square"){if(!de){const pt=z?0:-1;this.addCurrentVertex(ce,xt,pt,pt,re,Ee)}if(this.addCurrentVertex(ce,xt,0,0,re,Ee),de){const pt=F?0:1;this.addCurrentVertex(ce,xt,pt,pt,re,Ee)}}else if(Ke==="round"){if(de){const pt=!qe&&be?be:ve;this.addCurrentVertex(ce,pt,0,0,re,Ee),!qe&&F||this.addCurrentVertex(ce,pt,1,1,re,Ee,!0)}if(we){const pt=!qe&&ge?ge:ie;!qe&&z||this.addCurrentVertex(ce,pt,-1,-1,re,Ee,!0),this.addCurrentVertex(ce,pt,0,0,re,Ee)}}}}addVerticesTo(o,l,f,p,y,v,E,C,O,z){const F=(l.w-o.w)/this.tessellationStep|0;let $=0;const Y=this.scaledDistance;if(F>1){this.lineSoFar=o.w;const re=(l.x-o.x)/F,ce=(l.y-o.y)/F,de=(l.z-o.z)/F,we=(l.w-o.w)/F;for(let ve=1;ve<F;++ve){o.x+=re,o.y+=ce,o.z+=de,this.lineSoFar+=we,$+=we;const ie=this.evaluateLineProgressFeatures(this.prevDistance+$);this.scaledDistance=(this.prevDistance+$)/this.totalDistance,this.addHalfVertex(o,f,p,z,!1,E,O,ie),this.addHalfVertex(o,y,v,z,!0,-C,O,ie)}}this.lineSoFar=l.w,this.scaledDistance=Y;const J=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,f,p,z,!1,E,O,J),this.addHalfVertex(l,y,v,z,!0,-C,O,J)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):mr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(o,l,f,p,y,v,E=!1){const C=l.x+l.y*f,O=l.y-l.x*f,z=l.y*p-l.x,F=-l.y-l.x*p;if(v!=null){const $=this.elevationType==="offset",Y=-10,J=Kt+10,re=v.zOffset,ce=new Kj(o.x,o.y,re,this.lineSoFar),de=!!$&&WM(o,Y,J),we=this.lineSoFar,ve=this.distance;if(this.currentVertex)if(de){const ie=this.currentVertexIsOutside,ge=this.currentVertex,be=new Kj(o.x,o.y,re,this.lineSoFar);if(Jj(ge,be,Y,J),!WM(be,Y,J)){if(ie){this.e1=this.e2=-1,this.distance-=ge.dist(ce),this.lineSoFar=ge.w;const Ee=this.evaluateLineProgressFeatures(ge.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ge,C,O,E,!1,f,y,Ee),this.addHalfVertex(ge,z,F,E,!0,-p,y,Ee),this.prevDistance=this.distance}this.distance=this.prevDistance+ge.dist(be),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ge,be,C,O,z,F,f,p,y,E),this.distance=ve,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){Jj(ie,ce,Y,J),this.e1=this.e2=-1,this.distance-=ie.dist(ce),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const ge=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,C,O,E,!1,f,y,ge),this.addHalfVertex(ie,z,F,E,!0,-p,y,ge),this.prevDistance=this.distance,this.distance=ve,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,ce,C,O,z,F,f,p,y,E)}else de||(this.addHalfVertex(o,C,O,E,!1,f,y,v),this.addHalfVertex(o,z,F,E,!0,-p,y,v));this.currentVertex=ce,this.currentVertexIsOutside=de,this.lineSoFar=we}else this.addHalfVertex(o,C,O,E,!1,f,y,v),this.addHalfVertex(o,z,F,E,!0,-p,y,v)}addHalfVertex({x:o,y:l},f,p,y,v,E,C,O){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((o<<1)+(y?1:0),(l<<1)+(v?1:0),Math.round(63*f)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const F=kn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,F)}const z=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),C.primitiveLength++),v?this.e2=z:this.e1=z,O!=null&&this.zOffsetVertexArray.emplaceBack(O.zOffset,O.variableWidth,O.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,l){this.prevDistance=this.distance,this.distance+=o.dist(l),this.updateScaledDistance()}}function WM(u,o,l){return u.x<o||u.x>l||u.y<o||u.y>l}let r4,i4;function o4(u,o,l){return o*(Kt/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}dn(VM,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const a4=(u,o,l)=>(1-l)*u+l*o;function s4(u,o){return 1/o4(u,1,o.tileZoom)}function l4(u,o,l,f){return u.translatePosMatrix(f||o.tileID.projMatrix,o,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const c4=u=>{const o=[];u4(u)&&o.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const l=u.paint.get("line-trim-offset");l[0]===0&&l[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const f=u.layout.get("line-join").constantOr("miter")==="none",p=!!u.paint.get("line-pattern").constantOr(1);return f&&p&&o.push("LINE_JOIN_NONE"),o};function u4(u){const o=u.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let GM;const h4=()=>GM||(GM={layout:r4||(r4=new io({"line-cap":new cn(st.layout_line["line-cap"]),"line-join":new cn(st.layout_line["line-join"]),"line-miter-limit":new Zt(st.layout_line["line-miter-limit"]),"line-round-limit":new Zt(st.layout_line["line-round-limit"]),"line-sort-key":new cn(st.layout_line["line-sort-key"]),"line-z-offset":new cn(st.layout_line["line-z-offset"]),"line-elevation-reference":new Zt(st.layout_line["line-elevation-reference"]),"line-cross-slope":new Zt(st.layout_line["line-cross-slope"]),visibility:new Zt(st.layout_line.visibility),"line-width-unit":new Zt(st.layout_line["line-width-unit"])})),paint:i4||(i4=new io({"line-opacity":new cn(st.paint_line["line-opacity"]),"line-color":new cn(st.paint_line["line-color"]),"line-translate":new Zt(st.paint_line["line-translate"]),"line-translate-anchor":new Zt(st.paint_line["line-translate-anchor"]),"line-width":new cn(st.paint_line["line-width"]),"line-gap-width":new cn(st.paint_line["line-gap-width"]),"line-offset":new cn(st.paint_line["line-offset"]),"line-blur":new cn(st.paint_line["line-blur"]),"line-dasharray":new cn(st.paint_line["line-dasharray"]),"line-pattern":new cn(st.paint_line["line-pattern"]),"line-pattern-cross-fade":new Zt(st.paint_line["line-pattern-cross-fade"]),"line-gradient":new Od(st.paint_line["line-gradient"]),"line-trim-offset":new Zt(st.paint_line["line-trim-offset"]),"line-trim-fade-range":new Zt(st.paint_line["line-trim-fade-range"]),"line-trim-color":new Zt(st.paint_line["line-trim-color"]),"line-emissive-strength":new Zt(st.paint_line["line-emissive-strength"]),"line-border-width":new cn(st.paint_line["line-border-width"]),"line-border-color":new cn(st.paint_line["line-border-color"]),"line-occlusion-opacity":new Zt(st.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},GM);class roe extends cn{possiblyEvaluate(o,l){return l=new ii(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(o,l)}evaluate(o,l,f,p){return l=ut({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(o,l,f,p)}}let o1;function d4(u,o){return o>0?o+2*u:u}const ioe=zr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ooe=zr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),aoe=zr([{name:"a_projected_pos",components:4,type:"Float32"}],4);zr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const soe=zr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),loe=zr([{name:"a_texb",components:2,type:"Uint16"}]),coe=zr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),uoe=zr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);zr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const f4=zr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hoe=zr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);zr([{name:"triangle",components:3,type:"Uint16"}]),zr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),zr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),zr([{type:"Float32",name:"offsetX"}]),zr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ba=24;function doe(u,o,l){return u.sections.forEach(f=>{f.text=function(p,y,v){const E=y.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),zl.applyArabicShaping&&(p=zl.applyArabicShaping(p)),p}(f.text,o,l)}),u}const a1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function foe(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function poe(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var p4,HM,m4,qM={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function moe(){return p4||(p4=1,qM.read=function(u,o,l,f,p){var y,v,E=8*p-f-1,C=(1<<E)-1,O=C>>1,z=-7,F=l?p-1:0,$=l?-1:1,Y=u[o+F];for(F+=$,y=Y&(1<<-z)-1,Y>>=-z,z+=E;z>0;y=256*y+u[o+F],F+=$,z-=8);for(v=y&(1<<-z)-1,y>>=-z,z+=f;z>0;v=256*v+u[o+F],F+=$,z-=8);if(y===0)y=1-O;else{if(y===C)return v?NaN:1/0*(Y?-1:1);v+=Math.pow(2,f),y-=O}return(Y?-1:1)*v*Math.pow(2,y-f)},qM.write=function(u,o,l,f,p,y){var v,E,C,O=8*y-p-1,z=(1<<O)-1,F=z>>1,$=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:y-1,J=f?1:-1,re=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(E=isNaN(o)?1:0,v=z):(v=Math.floor(Math.log(o)/Math.LN2),o*(C=Math.pow(2,-v))<1&&(v--,C*=2),(o+=v+F>=1?$/C:$*Math.pow(2,1-F))*C>=2&&(v++,C/=2),v+F>=z?(E=0,v=z):v+F>=1?(E=(o*C-1)*Math.pow(2,p),v+=F):(E=o*Math.pow(2,F-1)*Math.pow(2,p),v=0));p>=8;u[l+Y]=255&E,Y+=J,E/=256,p-=8);for(v=v<<p|E,O+=p;O>0;u[l+Y]=255&v,Y+=J,v/=256,O-=8);u[l+Y-J]|=128*re}),qM}function g4(){if(m4)return HM;m4=1,HM=o;var u=moe();function o(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var l=4294967296,f=1/l,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function y(ie){return ie.type===o.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function v(ie,ge,be){return be?4294967296*ge+(ie>>>0):4294967296*(ge>>>0)+(ie>>>0)}function E(ie,ge,be){var Ee=ge<=16383?1:ge<=2097151?2:ge<=268435455?3:Math.floor(Math.log(ge)/(7*Math.LN2));be.realloc(Ee);for(var Ue=be.pos-1;Ue>=ie;Ue--)be.buf[Ue+Ee]=be.buf[Ue]}function C(ie,ge){for(var be=0;be<ie.length;be++)ge.writeVarint(ie[be])}function O(ie,ge){for(var be=0;be<ie.length;be++)ge.writeSVarint(ie[be])}function z(ie,ge){for(var be=0;be<ie.length;be++)ge.writeFloat(ie[be])}function F(ie,ge){for(var be=0;be<ie.length;be++)ge.writeDouble(ie[be])}function $(ie,ge){for(var be=0;be<ie.length;be++)ge.writeBoolean(ie[be])}function Y(ie,ge){for(var be=0;be<ie.length;be++)ge.writeFixed32(ie[be])}function J(ie,ge){for(var be=0;be<ie.length;be++)ge.writeSFixed32(ie[be])}function re(ie,ge){for(var be=0;be<ie.length;be++)ge.writeFixed64(ie[be])}function ce(ie,ge){for(var be=0;be<ie.length;be++)ge.writeSFixed64(ie[be])}function de(ie,ge){return(ie[ge]|ie[ge+1]<<8|ie[ge+2]<<16)+16777216*ie[ge+3]}function we(ie,ge,be){ie[be]=ge,ie[be+1]=ge>>>8,ie[be+2]=ge>>>16,ie[be+3]=ge>>>24}function ve(ie,ge){return(ie[ge]|ie[ge+1]<<8|ie[ge+2]<<16)+(ie[ge+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(ie,ge,be){for(be=be||this.length;this.pos<be;){var Ee=this.readVarint(),Ue=Ee>>3,qe=this.pos;this.type=7&Ee,ie(Ue,ge,this),this.pos===qe&&this.skip(Ee)}return ge},readMessage:function(ie,ge){return this.readFields(ie,ge,this.readVarint()+this.pos)},readFixed32:function(){var ie=de(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=ve(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=de(this.buf,this.pos)+de(this.buf,this.pos+4)*l;return this.pos+=8,ie},readSFixed64:function(){var ie=de(this.buf,this.pos)+ve(this.buf,this.pos+4)*l;return this.pos+=8,ie},readFloat:function(){var ie=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var ge,be,Ee=this.buf;return ge=127&(be=Ee[this.pos++]),be<128?ge:(ge|=(127&(be=Ee[this.pos++]))<<7,be<128?ge:(ge|=(127&(be=Ee[this.pos++]))<<14,be<128?ge:(ge|=(127&(be=Ee[this.pos++]))<<21,be<128?ge:function(Ue,qe,Ke){var Qe,xt,Dt=Ke.buf;if(Qe=(112&(xt=Dt[Ke.pos++]))>>4,xt<128||(Qe|=(127&(xt=Dt[Ke.pos++]))<<3,xt<128)||(Qe|=(127&(xt=Dt[Ke.pos++]))<<10,xt<128)||(Qe|=(127&(xt=Dt[Ke.pos++]))<<17,xt<128)||(Qe|=(127&(xt=Dt[Ke.pos++]))<<24,xt<128)||(Qe|=(1&(xt=Dt[Ke.pos++]))<<31,xt<128))return v(Ue,Qe,qe);throw new Error("Expected varint not more than 10 bytes")}(ge|=(15&(be=Ee[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,ge=this.pos;return this.pos=ie,ie-ge>=12&&p?function(be,Ee,Ue){return p.decode(be.subarray(Ee,Ue))}(this.buf,ge,ie):function(be,Ee,Ue){for(var qe="",Ke=Ee;Ke<Ue;){var Qe,xt,Dt,Ct=be[Ke],kt=null,Bt=Ct>239?4:Ct>223?3:Ct>191?2:1;if(Ke+Bt>Ue)break;Bt===1?Ct<128&&(kt=Ct):Bt===2?(192&(Qe=be[Ke+1]))==128&&(kt=(31&Ct)<<6|63&Qe)<=127&&(kt=null):Bt===3?(xt=be[Ke+2],(192&(Qe=be[Ke+1]))==128&&(192&xt)==128&&((kt=(15&Ct)<<12|(63&Qe)<<6|63&xt)<=2047||kt>=55296&&kt<=57343)&&(kt=null)):Bt===4&&(xt=be[Ke+2],Dt=be[Ke+3],(192&(Qe=be[Ke+1]))==128&&(192&xt)==128&&(192&Dt)==128&&((kt=(15&Ct)<<18|(63&Qe)<<12|(63&xt)<<6|63&Dt)<=65535||kt>=1114112)&&(kt=null)),kt===null?(kt=65533,Bt=1):kt>65535&&(kt-=65536,qe+=String.fromCharCode(kt>>>10&1023|55296),kt=56320|1023&kt),qe+=String.fromCharCode(kt),Ke+=Bt}return qe}(this.buf,ge,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,ge=this.buf.subarray(this.pos,ie);return this.pos=ie,ge},readPackedVarint:function(ie,ge){if(this.type!==o.Bytes)return ie.push(this.readVarint(ge));var be=y(this);for(ie=ie||[];this.pos<be;)ie.push(this.readVarint(ge));return ie},readPackedSVarint:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSVarint());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==o.Bytes)return ie.push(this.readBoolean());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFloat());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==o.Bytes)return ie.push(this.readDouble());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFixed32());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSFixed32());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFixed64());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSFixed64());var ge=y(this);for(ie=ie||[];this.pos<ge;)ie.push(this.readSFixed64());return ie},skip:function(ie){var ge=7&ie;if(ge===o.Varint)for(;this.buf[this.pos++]>127;);else if(ge===o.Bytes)this.pos=this.readVarint()+this.pos;else if(ge===o.Fixed32)this.pos+=4;else{if(ge!==o.Fixed64)throw new Error("Unimplemented type: "+ge);this.pos+=8}},writeTag:function(ie,ge){this.writeVarint(ie<<3|ge)},realloc:function(ie){for(var ge=this.length||16;ge<this.pos+ie;)ge*=2;if(ge!==this.length){var be=new Uint8Array(ge);be.set(this.buf),this.buf=be,this.length=ge}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),we(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),we(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),we(this.buf,-1&ie,this.pos),we(this.buf,Math.floor(ie*f),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),we(this.buf,-1&ie,this.pos),we(this.buf,Math.floor(ie*f),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(ge,be){var Ee,Ue;if(ge>=0?(Ee=ge%4294967296|0,Ue=ge/4294967296|0):(Ue=~(-ge/4294967296),4294967295^(Ee=~(-ge%4294967296))?Ee=Ee+1|0:(Ee=0,Ue=Ue+1|0)),ge>=18446744073709552e3||ge<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");be.realloc(10),function(qe,Ke,Qe){Qe.buf[Qe.pos++]=127&qe|128,qe>>>=7,Qe.buf[Qe.pos++]=127&qe|128,qe>>>=7,Qe.buf[Qe.pos++]=127&qe|128,qe>>>=7,Qe.buf[Qe.pos++]=127&qe|128,Qe.buf[Qe.pos]=127&(qe>>>=7)}(Ee,0,be),function(qe,Ke){var Qe=(7&qe)<<4;Ke.buf[Ke.pos++]|=Qe|((qe>>>=3)?128:0),qe&&(Ke.buf[Ke.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Ke.buf[Ke.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Ke.buf[Ke.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Ke.buf[Ke.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Ke.buf[Ke.pos++]=127&qe)))))}(Ue,be)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var ge=this.pos;this.pos=function(Ee,Ue,qe){for(var Ke,Qe,xt=0;xt<Ue.length;xt++){if((Ke=Ue.charCodeAt(xt))>55295&&Ke<57344){if(!Qe){Ke>56319||xt+1===Ue.length?(Ee[qe++]=239,Ee[qe++]=191,Ee[qe++]=189):Qe=Ke;continue}if(Ke<56320){Ee[qe++]=239,Ee[qe++]=191,Ee[qe++]=189,Qe=Ke;continue}Ke=Qe-55296<<10|Ke-56320|65536,Qe=null}else Qe&&(Ee[qe++]=239,Ee[qe++]=191,Ee[qe++]=189,Qe=null);Ke<128?Ee[qe++]=Ke:(Ke<2048?Ee[qe++]=Ke>>6|192:(Ke<65536?Ee[qe++]=Ke>>12|224:(Ee[qe++]=Ke>>18|240,Ee[qe++]=Ke>>12&63|128),Ee[qe++]=Ke>>6&63|128),Ee[qe++]=63&Ke|128)}return qe}(this.buf,ie,this.pos);var be=this.pos-ge;be>=128&&E(ge,be,this),this.pos=ge-1,this.writeVarint(be),this.pos+=be},writeFloat:function(ie){this.realloc(4),u.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),u.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var ge=ie.length;this.writeVarint(ge),this.realloc(ge);for(var be=0;be<ge;be++)this.buf[this.pos++]=ie[be]},writeRawMessage:function(ie,ge){this.pos++;var be=this.pos;ie(ge,this);var Ee=this.pos-be;Ee>=128&&E(be,Ee,this),this.pos=be-1,this.writeVarint(Ee),this.pos+=Ee},writeMessage:function(ie,ge,be){this.writeTag(ie,o.Bytes),this.writeRawMessage(ge,be)},writePackedVarint:function(ie,ge){ge.length&&this.writeMessage(ie,C,ge)},writePackedSVarint:function(ie,ge){ge.length&&this.writeMessage(ie,O,ge)},writePackedBoolean:function(ie,ge){ge.length&&this.writeMessage(ie,$,ge)},writePackedFloat:function(ie,ge){ge.length&&this.writeMessage(ie,z,ge)},writePackedDouble:function(ie,ge){ge.length&&this.writeMessage(ie,F,ge)},writePackedFixed32:function(ie,ge){ge.length&&this.writeMessage(ie,Y,ge)},writePackedSFixed32:function(ie,ge){ge.length&&this.writeMessage(ie,J,ge)},writePackedFixed64:function(ie,ge){ge.length&&this.writeMessage(ie,re,ge)},writePackedSFixed64:function(ie,ge){ge.length&&this.writeMessage(ie,ce,ge)},writeBytesField:function(ie,ge){this.writeTag(ie,o.Bytes),this.writeBytes(ge)},writeFixed32Field:function(ie,ge){this.writeTag(ie,o.Fixed32),this.writeFixed32(ge)},writeSFixed32Field:function(ie,ge){this.writeTag(ie,o.Fixed32),this.writeSFixed32(ge)},writeFixed64Field:function(ie,ge){this.writeTag(ie,o.Fixed64),this.writeFixed64(ge)},writeSFixed64Field:function(ie,ge){this.writeTag(ie,o.Fixed64),this.writeSFixed64(ge)},writeVarintField:function(ie,ge){this.writeTag(ie,o.Varint),this.writeVarint(ge)},writeSVarintField:function(ie,ge){this.writeTag(ie,o.Varint),this.writeSVarint(ge)},writeStringField:function(ie,ge){this.writeTag(ie,o.Bytes),this.writeString(ge)},writeFloatField:function(ie,ge){this.writeTag(ie,o.Fixed32),this.writeFloat(ge)},writeDoubleField:function(ie,ge){this.writeTag(ie,o.Fixed64),this.writeDouble(ge)},writeBooleanField:function(ie,ge){this.writeVarintField(ie,!!ge)}},HM}var VT=Qa(g4());const ZM=3;function goe(u,o,l){o.glyphs=[],u===1&&l.readMessage(_oe,o)}function _oe(u,o,l){if(u===3){const{id:f,bitmap:p,width:y,height:v,left:E,top:C,advance:O}=l.readMessage(yoe,{});o.glyphs.push({id:f,bitmap:new sp({width:y+2*ZM,height:v+2*ZM},p),metrics:{width:y,height:v,left:E,top:C,advance:O}})}else u===4?o.ascender=l.readSVarint():u===5&&(o.descender=l.readSVarint())}function yoe(u,o,l){u===1?o.id=l.readVarint():u===2?o.bitmap=l.readBytes():u===3?o.width=l.readVarint():u===4?o.height=l.readVarint():u===5?o.left=l.readSVarint():u===6?o.top=l.readSVarint():u===7&&(o.advance=l.readVarint())}const _4=ZM,dl={horizontal:1,vertical:2,horizontalOnly:3};class s1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,l){const f=new s1;return f.scale=o||1,f.fontStack=l,f}static forImage(o){const l=new s1;return l.image=o,l}}class Ey{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l,f){const p=new Ey;for(let y=0;y<o.sections.length;y++){const v=o.sections[y];v.image?p.addImageSection(v,f):p.addTextSection(v,l)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(l,f){let p="";for(let y=0;y<l.length;y++){const v=l.charCodeAt(y+1)||null,E=l.charCodeAt(y-1)||null;p+=!f&&(v&&oT(v)&&!a1[l[y+1]]||E&&oT(E)&&!a1[l[y-1]])||!a1[l[y]]?l[y]:a1[l[y]]}return p}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&WT[this.text.charCodeAt(f)];f++)o++;let l=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&WT[this.text.charCodeAt(f)];f--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const f=new Ey;return f.text=this.text.substring(o,l),f.sectionIndex=this.sectionIndex.slice(o,l),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(s1.forText(o.scale,o.fontStack||l));const f=this.sections.length-1;for(let p=0;p<o.text.length;++p)this.sectionIndex.push(f)}addImageSection(o,l){const f=o.image?o.image.getPrimary():null;if(!f)return void mr("Can't add FormattedSection with an empty image.");f.scaleSelf(l);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(s1.forImage(f)),this.sectionIndex.push(this.sections.length-1)):mr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function XM(u,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re=1){const ce=Ey.fromFeature(u,p,re);F===dl.vertical&&ce.verticalizePunctuation($);let de=[];const we=function(Ee,Ue,qe,Ke,Qe,xt){if(!Ee)return[];const Dt=[],Ct=function(Ot,pt,vt,Ut,Wt,Sn){let mn=0;for(let Jt=0;Jt<Ot.length();Jt++){const $t=Ot.getSection(Jt);mn+=y4(Ot.getCodePoint(Jt),$t,Ut,Wt,pt,Sn)}return mn/Math.max(1,Math.ceil(mn/vt))}(Ee,Ue,qe,Ke,Qe,xt),kt=Ee.text.indexOf("")>=0;let Bt=0;for(let Ot=0;Ot<Ee.length();Ot++){const pt=Ee.getSection(Ot),vt=Ee.getCodePoint(Ot);if(WT[vt]||(Bt+=y4(vt,pt,Ke,Qe,Ue,xt)),Ot<Ee.length()-1){const Ut=!((_t=vt)<11904||!(Ln["Bopomofo Extended"](_t)||Ln.Bopomofo(_t)||Ln["CJK Compatibility Forms"](_t)||Ln["CJK Compatibility Ideographs"](_t)||Ln["CJK Compatibility"](_t)||Ln["CJK Radicals Supplement"](_t)||Ln["CJK Strokes"](_t)||Ln["CJK Symbols and Punctuation"](_t)||Ln["CJK Unified Ideographs Extension A"](_t)||Ln["CJK Unified Ideographs"](_t)||Ln["Enclosed CJK Letters and Months"](_t)||Ln["Halfwidth and Fullwidth Forms"](_t)||Ln.Hiragana(_t)||Ln["Ideographic Description Characters"](_t)||Ln["Kangxi Radicals"](_t)||Ln["Katakana Phonetic Extensions"](_t)||Ln.Katakana(_t)||Ln["Vertical Forms"](_t)||Ln["Yi Radicals"](_t)||Ln["Yi Syllables"](_t)));(voe[vt]||Ut||pt.image)&&Dt.push(x4(Ot+1,Bt,Ct,Dt,xoe(vt,Ee.getCodePoint(Ot+1),Ut&&kt),!1))}}var _t;return b4(x4(Ee.length(),Bt,Ct,Dt,0,!0))}(ce,O,y,o,f,Y),{processBidirectionalText:ve,processStyledBidirectionalText:ie}=zl;if(ve&&ce.sections.length===1){const Ee=ve(ce.toString(),we);for(const Ue of Ee){const qe=new Ey;qe.text=Ue,qe.sections=ce.sections;for(let Ke=0;Ke<Ue.length;Ke++)qe.sectionIndex.push(0);de.push(qe)}}else if(ie){const Ee=ie(ce.text,ce.sectionIndex,we);for(const Ue of Ee){const qe=new Ey;qe.text=Ue[0],qe.sectionIndex=Ue[1],qe.sections=ce.sections,de.push(qe)}}else de=function(Ee,Ue){const qe=[],Ke=Ee.text;let Qe=0;for(const xt of Ue)qe.push(Ee.substring(Qe,xt)),Qe=xt;return Qe<Ke.length&&qe.push(Ee.substring(Qe,Ke.length)),qe}(ce,we);const ge=[],be={positionedLines:ge,text:ce.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Ee,Ue,qe,Ke,Qe,xt,Dt,Ct,kt,Bt,_t,Ot){let pt=0,vt=0,Ut=0;const Wt=Ct==="right"?1:Ct==="left"?0:.5;let Sn=!1;for(const xn of Qe){const Vn=xn.getSections();for(const nr of Vn){if(nr.image)continue;const rr=Ue[nr.fontStack];if(rr&&(Sn=rr.ascender!==void 0&&rr.descender!==void 0,!Sn))break}if(!Sn)break}let mn=0;for(const xn of Qe){xn.trim();const Vn=xn.getMaxScale(),nr=(Vn-1)*ba,rr={positionedGlyphs:[],lineOffset:0};Ee.positionedLines[mn]=rr;const gr=rr.positionedGlyphs;let ur=0;if(!xn.length()){vt+=xt,++mn;continue}let lr=0,di=0;for(let Se=0;Se<xn.length();Se++){const Ae=xn.getSection(Se),bt=xn.getSectionIndex(Se),Xt=xn.getCodePoint(Se);let tn=Ae.scale,Qt=null,wn=null,jn=null,Sr=ba,Tr=0;kt===dl.vertical&&((Jt=Xt)===12312||Jt===12313||Jt===12316||Jt===12540||Jt===12448)&&(kt=dl.horizontal);const cr=!(kt===dl.horizontal||!_t&&!eg(Xt)||_t&&(WT[Xt]||sM(Xt)));if(Ae.image){const ei=Ke.get(Ae.image.toString());if(!ei)continue;jn=Ae.image,Ee.iconsInText=Ee.iconsInText||!0,wn=ei.paddedRect;const xi=ei.displaySize;tn=tn*ba/Ot,Qt={width:xi[0],height:xi[1],left:0,top:-_4,advance:cr?xi[1]:xi[0],localGlyph:!1},Tr=Sn?-Qt.height*tn:Vn*ba-17-xi[1]*tn,Sr=Qt.advance;const Er=(cr?xi[0]:xi[1])*tn-ba*Vn;Er>0&&Er>ur&&(ur=Er)}else{const ei=qe[Ae.fontStack];if(!ei)continue;ei[Xt]&&(wn=ei[Xt]);const xi=Ue[Ae.fontStack];if(!xi)continue;const Er=xi.glyphs[Xt];if(!Er)continue;if(Qt=Er.metrics,Sr=Xt!==8203?ba:0,Sn){const Zi=xi.ascender!==void 0?Math.abs(xi.ascender):0,Ci=xi.descender!==void 0?Math.abs(xi.descender):0,Jr=(Zi+Ci)*tn;lr<Jr&&(lr=Jr,di=(Zi-Ci)/2*tn),Tr=-Zi*tn}else Tr=(Vn-tn)*ba-17}cr?(Ee.verticalizable=!0,gr.push({glyph:Xt,image:jn,x:pt,y:vt+Tr,vertical:cr,scale:tn,localGlyph:Qt.localGlyph,fontStack:Ae.fontStack,sectionIndex:bt,metrics:Qt,rect:wn}),pt+=Sr*tn+Bt):(gr.push({glyph:Xt,image:jn,x:pt,y:vt+Tr,vertical:cr,scale:tn,localGlyph:Qt.localGlyph,fontStack:Ae.fontStack,sectionIndex:bt,metrics:Qt,rect:wn}),pt+=Qt.advance*tn+Bt)}gr.length!==0&&(Ut=Math.max(pt-Bt,Ut),Sn?w4(gr,Wt,ur,di,xt*Vn/2):w4(gr,Wt,ur,0,xt/2)),pt=0;const Pi=xt*Vn+ur;rr.lineOffset=Math.max(ur,nr),vt+=Pi,++mn}var Jt;const $t=vt,{horizontalAlign:qn,verticalAlign:vn}=KM(Dt);(function(xn,Vn,nr,rr,gr,ur){const lr=(Vn-nr)*gr,di=-ur*rr;for(const Pi of xn)for(const Se of Pi.positionedGlyphs)Se.x+=lr,Se.y+=di})(Ee.positionedLines,Wt,qn,vn,Ut,$t),Ee.top+=-vn*$t,Ee.bottom=Ee.top+$t,Ee.left+=-qn*Ut,Ee.right=Ee.left+Ut,Ee.hasBaseline=Sn}(be,o,l,f,de,v,E,C,F,O,$,J),!function(Ee){for(const Ue of Ee)if(Ue.positionedGlyphs.length!==0)return!1;return!0}(ge))return be}const WT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},voe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function y4(u,o,l,f,p,y){if(o.image){const v=f.get(o.image.toString());return v?v.displaySize[0]*o.scale*ba/y+p:0}{const v=l[o.fontStack],E=v&&v.glyphs[u];return E?E.metrics.advance*o.scale+p:0}}function v4(u,o,l,f){const p=Math.pow(u-o,2);return f?u<o?p/2:2*p:p+Math.abs(l)*l}function xoe(u,o,l){let f=0;return u===10&&(f-=1e4),l&&(f+=150),u!==40&&u!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function x4(u,o,l,f,p,y){let v=null,E=v4(o,l,p,y);for(const C of f){const O=v4(o-C.x,l,p,y)+C.badness;O<=E&&(v=C,E=O)}return{index:u,x:o,priorBreak:v,badness:E}}function b4(u){return u?b4(u.priorBreak).concat(u.index):[]}function KM(u){let o=.5,l=.5;switch(u){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function w4(u,o,l,f,p){if(!(o||l||f||p))return;const y=u.length-1,v=u[y],E=(v.x+v.metrics.advance*v.scale)*o;for(let C=0;C<=y;C++)u[C].x-=E,u[C].y+=l+f+p}function S4(u){return u.imagePrimary!==void 0&&u.top!==void 0&&u.bottom!==void 0&&u.left!==void 0&&u.right!==void 0}function boe(u,o,l,f){const{horizontalAlign:p,verticalAlign:y}=KM(f),v=l[0]-u.displaySize[0]*p,E=l[1]-u.displaySize[1]*y;return{imagePrimary:u,imageSecondary:o,top:E,bottom:E+u.displaySize[1],left:v,right:v+u.displaySize[0]}}function T4(u,o,l,f,p,y){const v=u.imagePrimary;let E;if(v.content){const ce=v.content,de=v.pixelRatio||1;E=[ce[0]/de,ce[1]/de,v.displaySize[0]-ce[2]/de,v.displaySize[1]-ce[3]/de]}const C=o.left*y,O=o.right*y;let z,F,$,Y;l==="width"||l==="both"?(Y=p[0]+C-f[3],F=p[0]+O+f[1]):(Y=p[0]+(C+O-v.displaySize[0])/2,F=Y+v.displaySize[0]);const J=o.top*y,re=o.bottom*y;return l==="height"||l==="both"?(z=p[1]+J-f[0],$=p[1]+re+f[2]):(z=p[1]+(J+re-v.displaySize[1])/2,$=z+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:z,right:F,bottom:$,left:Y,collisionPadding:E}}function E4(u){return!u.imagePrimary.stretchX}function A4(u){return!u.imagePrimary.stretchY}function P4(u){return{width:u.right-u.left,height:u.bottom-u.top}}const jh=128;function C4(u,o){const{expression:l}=o;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new ii(u+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:p}=l;let y=0;for(;y<f.length&&f[y]<=u;)y++;y=Math.max(0,y-1);let v=y;for(;v<f.length&&f[v]<u+1;)v++;v=Math.min(f.length-1,v);const E=f[y],C=f[v];return l.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:C,minSize:l.evaluate(new ii(E)),maxSize:l.evaluate(new ii(C)),interpolationType:p}}}function YM(u,{uSize:o,uSizeT:l},{lowerSize:f,upperSize:p}){return u.kind==="source"?f/jh:u.kind==="composite"?kn(f/jh,p/jh,l):o}function l1(u,o,l=1){let f=0,p=0;if(u.kind==="constant")p=u.layoutSize*l;else if(u.kind!=="source"){const{interpolationType:y,minZoom:v,maxZoom:E}=u,C=y?$e(Ls.interpolationFactor(y,o,v,E),0,1):0;u.kind==="camera"?p=kn(u.minSize,u.maxSize,C)*l:f=C*l}return{uSizeT:f,uSize:p}}class Bd extends Tt{constructor(o,l,f,p,y){super(o,l),this.angle=p,this.z=f,y!==void 0&&(this.segment=y)}clone(){return new Bd(this.x,this.y,this.z,this.angle,this.segment)}}function I4(u,o,l,f,p){if(o.segment===void 0)return!0;let y=o,v=o.segment+1,E=0;for(;E>-l/2;){if(v--,v<0)return!1;E-=u[v].dist(y),y=u[v]}E+=u[v].dist(u[v+1]),v++;const C=[];let O=0;for(;E<l/2;){const z=u[v],F=u[v+1];if(!F)return!1;let $=u[v-1].angleTo(z)-z.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:E,angleDelta:$}),O+=$;E-C[0].distance>f;)O-=C.shift().angleDelta;if(O>p)return!1;v++,E+=z.dist(F)}return!0}function M4(u){let o=0;for(let l=0;l<u.length-1;l++)o+=u[l].dist(u[l+1]);return o}function O4(u,o,l){return u?.6*o*l:0}function k4(u,o){return Math.max(u?u.right-u.left:0,o?o.right-o.left:0)}function woe(u,o,l,f,p,y){const v=O4(l,p,y),E=k4(l,f)*y;let C=0;const O=M4(u)/2;for(let z=0;z<u.length-1;z++){const F=u[z],$=u[z+1],Y=F.dist($);if(C+Y>O){const J=(O-C)/Y,re=kn(F.x,$.x,J),ce=kn(F.y,$.y,J),de=new Bd(re,ce,0,$.angleTo(F),z);return!v||I4(u,de,E,v,o)?de:void 0}C+=Y}}function Soe(u,o,l,f,p,y,v,E,C){const O=O4(f,y,v),z=k4(f,p),F=z*v,$=u[0].x===0||u[0].x===C||u[0].y===0||u[0].y===C;return o-F<o/4&&(o=F+o/4),R4(u,$?o/2*E%o:(z/2+2*y)*v*E%o,o,O,l,F,$,!1,C)}function R4(u,o,l,f,p,y,v,E,C){const O=y/2,z=M4(u);let F=0,$=o-l,Y=[];for(let J=0;J<u.length-1;J++){const re=u[J],ce=u[J+1],de=re.dist(ce),we=ce.angleTo(re);for(;$+l<F+de;){$+=l;const ve=($-F)/de,ie=kn(re.x,ce.x,ve),ge=kn(re.y,ce.y,ve);if(ie>=0&&ie<C&&ge>=0&&ge<C&&$-O>=0&&$+O<=z){const be=new Bd(ie,ge,0,we,J);f&&!I4(u,be,y,f,p)||Y.push(be)}}F+=de}return E||Y.length||v||(Y=R4(u,F/2,l,f,p,y,v,!0,C)),Y}function D4(u){let o=0,l=0;for(const v of u)o+=v.w*v.h,l=Math.max(l,v.w);u.sort((v,E)=>E.h-v.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let p=0,y=0;for(const v of u)for(let E=f.length-1;E>=0;E--){const C=f[E];if(!(v.w>C.w||v.h>C.h)){if(v.x=C.x,v.y=C.y,y=Math.max(y,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===C.w&&v.h===C.h){const O=f.pop();E<f.length&&(f[E]=O)}else v.h===C.h?(C.x+=v.w,C.w-=v.w):v.w===C.w?(C.y+=v.h,C.h-=v.h):(f.push({x:C.x+v.w,y:C.y,w:C.w-v.w,h:v.h}),C.y+=v.h,C.h-=v.h);break}}return{w:p,h:y,fill:o/(p*y)||0}}dn(Bd,"Anchor");const vg=1;class c1{static getImagePositionScale(o,l,f){if(l&&o&&o.options&&o.options.transform){const p=o.options.transform;return{x:p.a,y:p.d}}return{x:f,y:f}}constructor(o,l,f,p){this.paddedRect=o;const{pixelRatio:y,version:v,stretchX:E,stretchY:C,content:O,sdf:z,usvg:F}=l;this.pixelRatio=y,this.stretchX=E,this.stretchY=C,this.content=O,this.version=v,this.padding=f,this.sdf=z,this.scale=c1.getImagePositionScale(p,F,y)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function JM(u,o,l){const f=sl.parse(u),p=function(y,v,E=[1,1]){return{x:0,y:0,w:(y.data?y.data.width:y.width*E[0])+2*v,h:(y.data?y.data.height:y.height*E[1])+2*v}}(o,l,[f.options.transform.a,f.options.transform.d]);return{bin:p,imagePosition:new c1(p,o,l,f),imageVariant:f}}class L4{constructor(o,l,f){const p=new Map,y=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(o,p,vg,v),this.addImages(l,y,2,v);const{w:E,h:C}=D4(v),O=new Ha({width:E||1,height:C||1});for(const[z,F]of o.entries()){const $=p.get(z).paddedRect;Ha.copy(F.data,O,{x:0,y:0},{x:$.x+vg,y:$.y+vg},F.data,f,F.sdf)}for(const[z,F]of l.entries()){const $=y.get(z),Y=$.paddedRect;let J=$.padding;const re=Y.x+J,ce=Y.y+J,de=F.data.width,we=F.data.height;J=J>1?J-1:J,Ha.copy(F.data,O,{x:0,y:0},{x:re,y:ce},F.data,f),Ha.copy(F.data,O,{x:0,y:we-J},{x:re,y:ce-J},{width:de,height:J},f),Ha.copy(F.data,O,{x:0,y:0},{x:re,y:ce+we},{width:de,height:J},f),Ha.copy(F.data,O,{x:de-J,y:0},{x:re-J,y:ce},{width:J,height:we},f),Ha.copy(F.data,O,{x:0,y:0},{x:re+de,y:ce},{width:J,height:we},f),Ha.copy(F.data,O,{x:de-J,y:we-J},{x:re-J,y:ce-J},{width:J,height:J},f),Ha.copy(F.data,O,{x:0,y:we-J},{x:re+de,y:ce-J},{width:J,height:J},f),Ha.copy(F.data,O,{x:0,y:0},{x:re+de,y:ce+we},{width:J,height:J},f),Ha.copy(F.data,O,{x:de-J,y:0},{x:re-J,y:ce+we},{width:J,height:J},f)}this.lut=f,this.image=O,this.iconPositions=p,this.patternPositions=y}addImages(o,l,f,p){for(const[y,v]of o.entries()){const{bin:E,imagePosition:C,imageVariant:O}=JM(y,v,f);l.set(y,C),p.push(E),v.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(o,l,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>o.hasImage(p,f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const p of o.getUpdatedImages(f)){for(const y of this.iconPositions.keys()){const v=sl.parse(y);if(ts.isEqual(v.id,p)){const E=o.getImage(p,f);this.patchUpdatedImage(this.iconPositions.get(y),E,l)}}for(const y of this.patternPositions.keys()){const v=sl.parse(y);if(ts.isEqual(v.id,p)){const E=o.getImage(p,f);this.patchUpdatedImage(this.patternPositions.get(y),E,l)}}}}patchUpdatedImage(o,l,f){if(!o||!l||o.version===l.version)return;o.version=l.version;const[p,y]=o.tl,v=o.sdf;if(this.lut||v){const E={width:l.data.width,height:l.data.height},C=new Ha(E);Ha.copy(l.data,C,{x:0,y:0},{x:0,y:0},E,this.lut,v),f.update(C,{position:{x:p,y}})}else f.update(l.data,{position:{x:p,y}})}}dn(c1,"ImagePosition"),dn(L4,"ImageAtlas");const u1=1e20;function z4(u,o,l,f,p,y,v,E,C){for(let O=o;O<o+f;O++)N4(u,l*y+O,y,p,v,E,C);for(let O=l;O<l+p;O++)N4(u,O*y+o,1,f,v,E,C)}function N4(u,o,l,f,p,y,v){y[0]=0,v[0]=-u1,v[1]=u1,p[0]=u[o];for(let E=1,C=0,O=0;E<f;E++){p[E]=u[o+E*l];const z=E*E;do{const F=y[C];O=(p[E]-p[F]+z-F*F)/(E-F)/2}while(O<=v[C]&&--C>-1);C++,y[C]=E,v[C]=O,v[C+1]=u1}for(let E=0,C=0;E<f;E++){for(;v[C+1]<E;)C++;const O=y[C],z=E-O;u[o+E*l]=p[O]+z*z}}const Lu=2,QM={none:0,ideographs:1,all:2};class Ay{constructor(o,l,f){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=f,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,l){this.urls[l]=o}getGlyphs(o,l,f){const p=[],y=this.urls[l]||kr.GLYPHS_URL;for(const v in o)for(const E of o[v])p.push({stack:v,id:E});St(p,({stack:v,id:E},C)=>{let O=this.entries[v];O||(O=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let z=O.glyphs[E];if(z!==void 0)return void C(null,{stack:v,id:E,glyph:z});if(z=this._tinySDF(O,v,E),z)return O.glyphs[E]=z,void C(null,{stack:v,id:E,glyph:z});const F=Math.floor(E/256);if(256*F>65535)return mr("glyphs > 65535 not supported"),void C(null,{stack:v,id:E,glyph:z});if(O.ranges[F])return void C(null,{stack:v,id:E,glyph:z});let $=O.requests[F];$||($=O.requests[F]=[],Ay.loadGlyphRange(v,F,y,this.requestManager,(Y,J)=>{if(J){O.ascender=J.ascender,O.descender=J.descender;for(const re in J.glyphs)this._doesCharSupportLocalGlyph(+re)||(O.glyphs[+re]=J.glyphs[+re]);O.ranges[F]=!0}for(const re of $)re(Y,J);delete O.requests[F]})),$.push((Y,J)=>{Y?C(Y):J&&C(null,{stack:v,id:E,glyph:J.glyphs[E]||null})})},(v,E)=>{if(v)f(v);else if(E){const C={};for(const{stack:O,id:z,glyph:F}of E)C[O]===void 0&&(C[O]={}),C[O].glyphs===void 0&&(C[O].glyphs={}),C[O].glyphs[z]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},C[O].ascender=this.entries[O].ascender,C[O].descender=this.entries[O].descender;f(null,C)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==QM.none&&(this.localGlyphMode===QM.all?!!this.localFontFamily:!!this.localFontFamily&&(Ln["CJK Unified Ideographs"](o)||Ln["Hangul Syllables"](o)||Ln.Hiragana(o)||Ln.Katakana(o)||Ln["CJK Symbols and Punctuation"](o)||Ln["CJK Unified Ideographs Extension A"](o)||Ln["CJK Unified Ideographs Extension B"](o)||Ln.Osage(o)))}_tinySDF(o,l,f){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(f))return;let y=o.tinySDF;if(!y){let re="400";/bold/i.test(l)?re="900":/medium/i.test(l)?re="500":/light/i.test(l)&&(re="200"),y=o.tinySDF=new Ay.TinySDF({fontFamily:p,fontWeight:re,fontSize:24*Lu,buffer:3*Lu,radius:8*Lu}),y.fontWeight=re}if(this.localGlyphs[y.fontWeight][f])return this.localGlyphs[y.fontWeight][f];const v=String.fromCodePoint(f),{data:E,width:C,height:O,glyphWidth:z,glyphHeight:F,glyphLeft:$,glyphTop:Y,glyphAdvance:J}=y.draw(v);return this.localGlyphs[y.fontWeight][f]={id:f,bitmap:new sp({width:C,height:O},E),metrics:{width:z/Lu,height:F/Lu,left:$/Lu,top:Y/Lu-27,advance:J/Lu,localGlyph:!0}}}}Ay.loadGlyphRange=function(u,o,l,f,p){const y=256*o,v=y+255,E=f.transformRequest(f.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",`${y}-${v}`),Fr.Glyphs);Bc(E,(C,O)=>{if(C)p(C);else if(O){const z={},F=function($){return new VT($).readFields(goe,{})}(O);for(const $ of F.glyphs)z[$.id]=$;p(null,{glyphs:z,ascender:F.ascender,descender:F.descender})}})},Ay.TinySDF=class{constructor({fontSize:u=24,buffer:o=3,radius:l=8,cutoff:f=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:v="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=l;const E=this.size=u+4*o,C=this._createCanvas(E),O=this.ctx=C.getContext("2d",{willReadFrequently:!0});O.font=`${v} ${y} ${u}px ${p}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(u){const o=document.createElement("canvas");return o.width=o.height=u,o}draw(u){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:f,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(u),v=Math.ceil(l),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),C=Math.min(this.size-this.buffer,v+Math.ceil(f)),O=E+2*this.buffer,z=C+2*this.buffer,F=Math.max(O*z,0),$=new Uint8ClampedArray(F),Y={data:$,width:O,height:z,glyphWidth:E,glyphHeight:C,glyphTop:v,glyphLeft:0,glyphAdvance:o};if(E===0||C===0)return Y;const{ctx:J,buffer:re,gridInner:ce,gridOuter:de}=this;J.clearRect(re,re,E,C),J.fillText(u,re,re+v);const we=J.getImageData(re,re,E,C);de.fill(u1,0,F),ce.fill(0,0,F);for(let ve=0;ve<C;ve++)for(let ie=0;ie<E;ie++){const ge=we.data[4*(ve*E+ie)+3]/255;if(ge===0)continue;const be=(ve+re)*O+ie+re;if(ge===1)de[be]=0,ce[be]=u1;else{const Ee=.5-ge;de[be]=Ee>0?Ee*Ee:0,ce[be]=Ee<0?Ee*Ee:0}}z4(de,0,0,O,z,O,this.f,this.v,this.z),z4(ce,re,re,E,C,O,this.f,this.v,this.z);for(let ve=0;ve<F;ve++){const ie=Math.sqrt(de[ve])-Math.sqrt(ce[ve]);$[ve]=Math.round(255-255*(ie/this.radius+this.cutoff))}return Y}};const up=vg;function F4(u,o){return u+o[1]-o[0]}function B4(u,o,l,f,p=1){const y=[],v=u.imagePrimary,E=v.pixelRatio,C=v.paddedRect.w-2*up,O=v.paddedRect.h-2*up,z=(u.right-u.left)*p,F=(u.bottom-u.top)*p,$=v.stretchX||[[0,C]],Y=v.stretchY||[[0,O]],J=$.reduce(F4,0),re=Y.reduce(F4,0),ce=C-J,de=O-re;let we=0,ve=J,ie=0,ge=re,be=0,Ee=ce,Ue=0,qe=de;if(v.content&&f){const Qe=v.content;we=GT($,0,Qe[0]),ie=GT(Y,0,Qe[1]),ve=GT($,Qe[0],Qe[2]),ge=GT(Y,Qe[1],Qe[3]),be=Qe[0]-we,Ue=Qe[1]-ie,Ee=Qe[2]-Qe[0]-ve,qe=Qe[3]-Qe[1]-ge}const Ke=(Qe,xt,Dt,Ct)=>{const kt=HT(Qe.stretch-we,ve,z,u.left*p),Bt=qT(Qe.fixed-be,Ee,Qe.stretch,J),_t=HT(xt.stretch-ie,ge,F,u.top*p),Ot=qT(xt.fixed-Ue,qe,xt.stretch,re),pt=HT(Dt.stretch-we,ve,z,u.left*p),vt=qT(Dt.fixed-be,Ee,Dt.stretch,J),Ut=HT(Ct.stretch-ie,ge,F,u.top*p),Wt=qT(Ct.fixed-Ue,qe,Ct.stretch,re),Sn=new Tt(kt,_t),mn=new Tt(pt,_t),Jt=new Tt(pt,Ut),$t=new Tt(kt,Ut),qn=new Tt(Bt/E,Ot/E),vn=new Tt(vt/E,Wt/E),xn=o*Math.PI/180;if(xn){const lr=Math.sin(xn),di=Math.cos(xn),Pi=[di,-lr,lr,di];Sn._matMult(Pi),mn._matMult(Pi),$t._matMult(Pi),Jt._matMult(Pi)}const Vn=Qe.stretch+Qe.fixed,nr=Dt.stretch+Dt.fixed,rr=xt.stretch+xt.fixed,gr=Ct.stretch+Ct.fixed,ur=u.imageSecondary;return{tl:Sn,tr:mn,bl:$t,br:Jt,texPrimary:{x:v.paddedRect.x+up+Vn,y:v.paddedRect.y+up+rr,w:nr-Vn,h:gr-rr},texSecondary:ur?{x:ur.paddedRect.x+up+Vn,y:ur.paddedRect.y+up+rr,w:nr-Vn,h:gr-rr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qn,pixelOffsetBR:vn,minFontScaleX:Ee/E/z,minFontScaleY:qe/E/F,isSDF:l}};if(f&&(v.stretchX||v.stretchY)){const Qe=j4($,ce,J),xt=j4(Y,de,re);for(let Dt=0;Dt<Qe.length-1;Dt++){const Ct=Qe[Dt],kt=Qe[Dt+1];for(let Bt=0;Bt<xt.length-1;Bt++)y.push(Ke(Ct,xt[Bt],kt,xt[Bt+1]))}}else y.push(Ke({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:O+1}));return y}function GT(u,o,l){let f=0;for(const p of u)f+=Math.max(o,Math.min(l,p[1]))-Math.max(o,Math.min(l,p[0]));return f}function j4(u,o,l){const f=[{fixed:-up,stretch:0}];for(const[p,y]of u){const v=f[f.length-1];f.push({fixed:p-v.stretch,stretch:v.stretch}),f.push({fixed:p-v.stretch,stretch:v.stretch+(y-p)})}return f.push({fixed:o+up,stretch:l}),f}function HT(u,o,l,f){return u/o*l+f}function qT(u,o,l,f){return u-o*l/f}function Toe(u,o,l,f){const p=o+u.positionedLines[f].lineOffset;return f===0?l+p/2:l+(p+(o+u.positionedLines[f-1].lineOffset))/2}function Eoe(u,o=1,l=!1){let f=1/0,p=1/0,y=-1/0,v=-1/0;const E=u[0];for(let Y=0;Y<E.length;Y++){const J=E[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<p)&&(p=J.y),(!Y||J.x>y)&&(y=J.x),(!Y||J.y>v)&&(v=J.y)}const C=Math.min(y-f,v-p);let O=C/2;const z=new Df([],Aoe);if(C===0)return new Tt(f,p);for(let Y=f;Y<y;Y+=C)for(let J=p;J<v;J+=C)z.push(new Py(Y+O,J+O,O,u));let F=function(Y){let J=0,re=0,ce=0;const de=Y[0];for(let we=0,ve=de.length,ie=ve-1;we<ve;ie=we++){const ge=de[we],be=de[ie],Ee=ge.x*be.y-be.x*ge.y;re+=(ge.x+be.x)*Ee,ce+=(ge.y+be.y)*Ee,J+=3*Ee}return new Py(re/J,ce/J,0,Y)}(u),$=z.length;for(;z.length;){const Y=z.pop();(Y.d>F.d||!F.d)&&(F=Y,l&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,$)),Y.max-F.d<=o||(O=Y.h/2,z.push(new Py(Y.p.x-O,Y.p.y-O,O,u)),z.push(new Py(Y.p.x+O,Y.p.y-O,O,u)),z.push(new Py(Y.p.x-O,Y.p.y+O,O,u)),z.push(new Py(Y.p.x+O,Y.p.y+O,O,u)),$+=4)}return l&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function Aoe(u,o){return o.max-u.max}class Py{constructor(o,l,f,p){this.p=new Tt(o,l),this.h=f,this.d=function(y,v){let E=!1,C=1/0;for(let O=0;O<v.length;O++){const z=v[O];for(let F=0,$=z.length,Y=$-1;F<$;Y=F++){const J=z[F],re=z[Y];J.y>y.y!=re.y>y.y&&y.x<(re.x-J.x)*(y.y-J.y)/(re.y-J.y)+J.x&&(E=!E),C=Math.min(C,Mr(y,J,re))}}return(E?1:-1)*Math.sqrt(C)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Poe=Object.keys,eO=Number.POSITIVE_INFINITY,Coe=Math.sqrt(2);function $4(u,[o,l]){let f=0,p=0;if(l===eO){o<0&&(o=0);const y=o/Coe;switch(u){case"top-right":case"top-left":p=y-7;break;case"bottom-right":case"bottom-left":p=7-y;break;case"bottom":p=7-o;break;case"top":p=o-7}switch(u){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),u){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(u){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,p]}function ZT(u,o,l,f,p,y,v,E,C){if(!o||!o.usvg)return;const O=P4(f),z=P4(p),F=y!=="both"&&y!=="width"||!E4(f)?1:Math.max(1,z.width/O.width),$=y!=="both"&&y!=="height"||!A4(f)?1:Math.max(1,z.height/O.height);l.scaleSelf(F,$);const Y=l.toString();v.set(Y,l),E.set(Y,o);const{imagePosition:J}=JM(Y,o,vg);C.set(Y,J)}function U4(u,o,l,f,p,y,v,E){if(!u)return;const C=function(O,z,F,$,Y){if(O.kind==="camera")return O.maxSize;if(O.kind==="composite"){const J=z.possiblyEvaluate(new ii(O.maxZoom),F).evaluate(Y,{},F),re=z.possiblyEvaluate(new ii(O.minZoom),F).evaluate(Y,{},F);return Math.max(J,re)}return z.possiblyEvaluate(new ii($)).evaluate(Y,{},F)}(o,l,f,p,y);return u.scaleSelf(C*E*v)}function V4(u,o,l,f,p,y,v,E){return{iconPrimary:U4(u.getPrimary(),o,l,f,p,y,v,E),iconSecondary:U4(u.getSecondary(),o,l,f,p,y,v,E)}}function W4(u,o,l,f){if(!u)return;const p=o.get(l.toString());if(u.imagePrimary=p,f){const y=o.get(f.toString());u.imageSecondary=y}}function Ioe(u,o){for(const l in u.horizontal)G4(u.horizontal[l],o);G4(u.vertical,o)}function G4(u,o){if(u){for(const l of u.positionedLines)for(const f of l.positionedGlyphs)if(f.image!==null){const p=f.image.toString();f.rect=o.get(p).paddedRect}}}function tO(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Moe(u,o,l,f,p,y,v,E,C){const O=nO(y.horizontal)||y.vertical,z=l.get("icon-text-fit-padding").evaluate(f,{},p);let F,$=o;return o&&C!=="none"&&(u.allowVerticalPlacement&&y.vertical&&(F=T4(o,y.vertical,C,z,E,v)),O&&($=T4(o,O,C,z,E,v))),{defaultShapedIcon:$,verticallyShapedIcon:F}}function Ooe(u,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de,we,ve){let ie=v.textMaxSize.evaluate(o,{},$);ie===void 0?ie=E*v.textScaleFactor:ie*=v.textScaleFactor;const ge=u.layers[0].layout,be=nO(l.horizontal)||l.vertical,Ee=Y.name==="globe",Ue=ba,qe=u.tilePixelRatio*ie/Ue,Ke=(Bt=u.overscaling,u.zoom>18&&Bt>2&&(Bt>>=1),Math.max(Kt/(512*Bt),1)*ge.get("symbol-spacing")),Qe=ge.get("text-padding")*u.tilePixelRatio,xt=ge.get("icon-padding")*u.tilePixelRatio,Dt=ae(ge.get("text-max-angle")),Ct=ge.get("icon-rotation-alignment")==="map"&&ve!=="point",kt=Ke/2;var Bt;u.hasAnyIconTextFit===!1&&ce!=="none"&&(u.hasAnyIconTextFit=!0);const _t=o.properties?+o.properties[mg]:null,Ot=_t&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(_t):65535,pt=(vt,Ut,Wt)=>{if(Ut.x<0||Ut.x>=Kt||Ut.y<0||Ut.y>=Kt)return;let Sn=null;if(Ee){const{x:mn,y:Jt,z:$t}=Y.projectTilePoint(Ut.x,Ut.y,Wt);Sn={anchor:new Bd(mn,Jt,$t,0,void 0),up:Y.upVector(Wt,Ut.x,Ut.y)}}(function(mn,Jt,$t,qn,vn,xn,Vn,nr,rr,gr,ur,lr,di,Pi,Se,Ae,bt,Xt,tn,Qt,wn,jn,Sr,Tr,cr,ei,xi,Er,Zi){const Ci=mn.addToLineVertexArray(Jt,qn);let Jr,ao,Oi,bi,Ii,ri,hr,si=0,Xi=0,Bn=0,Or=0,ki=-1,Qi=-1;const zi={};let ko=ds("");const fi=$t?$t.anchor:Jt,Po=Er!=="none";let Ws=0,qa=0;if(rr._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Ro=rr.layout.get("text-offset").evaluate(wn,{},cr);Ws=Ro[0]*ba,qa=Ro[1]*ba}else Ws=rr.layout.get("text-radial-offset").evaluate(wn,{},cr)*ba,qa=eO;if(mn.allowVerticalPlacement&&vn.vertical){const Ro=vn.vertical;if(Se)ri=rO(Ro),nr&&(hr=rO(nr));else{const Qo=rr.layout.get("text-rotate").evaluate(wn,{},cr)+90;Oi=XT(gr,fi,Jt,ur,lr,di,Ro,Pi,Qo,Ae),nr&&(bi=XT(gr,fi,Jt,ur,lr,di,nr,Xt,Qo))}}if(xn){const Ro=mn.iconSizeData,Qo=rr.layout.get("icon-rotate").evaluate(wn,{},cr),Za=B4(xn,Qo,Sr,Po,jn.iconScaleFactor),_s=nr?B4(nr,Qo,Sr,Po,jn.iconScaleFactor):void 0;ao=XT(gr,fi,Jt,ur,lr,di,xn,Xt,Qo,null),si=4*Za.length;let is=null;Ro.kind==="source"?(is=[jh*rr.layout.get("icon-size").evaluate(wn,{},cr)*jn.iconScaleFactor],is[0]>hp&&mr(`${mn.layerIds[0]}: Value for "icon-size" is >= ${h1}. Reduce your "icon-size".`)):Ro.kind==="composite"&&(is=[jh*jn.compositeIconSizes[0].evaluate(wn,{},cr)*jn.iconScaleFactor,jh*jn.compositeIconSizes[1].evaluate(wn,{},cr)*jn.iconScaleFactor],(is[0]>hp||is[1]>hp)&&mr(`${mn.layerIds[0]}: Value for "icon-size" is >= ${h1}. Reduce your "icon-size".`)),mn.addSymbols(mn.icon,Za,is,Qt,tn,wn,void 0,$t,Jt,Ci.lineStartIndex,Ci.lineLength,-1,Tr,cr,ei,xi),ki=mn.icon.placedSymbolArray.length-1,_s&&(Xi=4*_s.length,mn.addSymbols(mn.icon,_s,is,Qt,tn,wn,dl.vertical,$t,Jt,Ci.lineStartIndex,Ci.lineLength,-1,Tr,cr,ei,xi),Qi=mn.icon.placedSymbolArray.length-1)}for(const Ro in vn.horizontal){const Qo=Ro,Za=vn.horizontal[Qo];Jr||(ko=ds(Za.text),Se?Ii=rO(Za):Jr=XT(gr,fi,Jt,ur,lr,di,Za,Pi,rr.layout.get("text-rotate").evaluate(wn,{},cr),Ae));const _s=Za.positionedLines.length===1;if(Bn+=H4(mn,$t,Jt,Za,Vn,rr,Se,wn,Ae,Ci,vn.vertical?dl.horizontal:dl.horizontalOnly,_s?Poe(vn.horizontal):[Qo],zi,ki,jn,Tr,cr,ei),_s)break}vn.vertical&&(Or+=H4(mn,$t,Jt,vn.vertical,Vn,rr,Se,wn,Ae,Ci,dl.vertical,["vertical"],zi,Qi,jn,Tr,cr,ei));let Na=-1;const Gs=(Ro,Qo)=>Ro?Math.max(Ro,Qo):Qo;Na=Gs(Ii,Na),Na=Gs(ri,Na),Na=Gs(hr,Na);const $h=Na>-1?1:0;mn.glyphOffsetArray.length>=65535&&mr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wn.sortKey!==void 0&&mn.addToSortKeyRanges(mn.symbolInstances.length,wn.sortKey),mn.symbolInstances.emplaceBack(Jt.x,Jt.y,fi.x,fi.y,fi.z,zi.right>=0?zi.right:-1,zi.center>=0?zi.center:-1,zi.left>=0?zi.left:-1,zi.vertical>=0?zi.vertical:-1,ki,Qi,ko,Jr!==void 0?Jr:mn.collisionBoxArray.length,Jr!==void 0?Jr+1:mn.collisionBoxArray.length,Oi!==void 0?Oi:mn.collisionBoxArray.length,Oi!==void 0?Oi+1:mn.collisionBoxArray.length,ao!==void 0?ao:mn.collisionBoxArray.length,ao!==void 0?ao+1:mn.collisionBoxArray.length,bi||mn.collisionBoxArray.length,bi?bi+1:mn.collisionBoxArray.length,ur,Bn,Or,si,Xi,$h,0,Ws,qa,Na,0,Po?1:0,Zi)})(u,Ut,Sn,vt,l,f,y,p,u.layers[0],u.collisionBoxArray,o.index,o.sourceLayerIndex,u.index,Qe,we,O,0,xt,Ct,de,o,v,z,F,$,J,re,ce,Ot)};if(ve==="line")for(const vt of UT(o.geometry,0,0,Kt,Kt)){const Ut=Soe(vt,Ke,Dt,l.vertical||be,f,Ue,qe,u.overscaling,Kt);for(const Wt of Ut)be&&koe(u,be.text,kt,Wt)||pt(vt,Wt,$)}else if(ve==="line-center"){for(const vt of o.geometry)if(vt.length>1){const Ut=woe(vt,Dt,l.vertical||be,f,Ue,qe);Ut&&pt(vt,Ut,$)}}else if(o.type==="Polygon")for(const vt of LT(o.geometry,0)){const Ut=Eoe(vt,16);pt(vt[0],new Bd(Ut.x,Ut.y,0,0,void 0),$)}else if(o.type==="LineString")for(const vt of o.geometry)pt(vt,new Bd(vt[0].x,vt[0].y,0,0,void 0),$);else if(o.type==="Point")for(const vt of o.geometry)for(const Ut of vt)pt([Ut],new Bd(Ut.x,Ut.y,0,0,void 0),$)}const h1=255,hp=h1*jh;function H4(u,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce,de){const we=function(ge,be,Ee,Ue,qe,Ke,Qe,xt){const Dt=[];if(be.positionedLines.length===0)return Dt;const Ct=Ue.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,kt=function(vt){const Ut=vt[0],Wt=vt[1],Sn=Ut*Wt;return Sn>0?[Ut,-Wt]:Sn<0?[-Ut,Wt]:Ut===0?[Wt,Ut]:[Wt,-Ut]}(Ee);let Bt=Math.abs(be.top-be.bottom);for(const vt of be.positionedLines)Bt-=vt.lineOffset;const _t=be.positionedLines.length,Ot=Bt/_t;let pt=be.top-Ee[1];for(let vt=0;vt<_t;++vt){const Ut=be.positionedLines[vt];pt=Toe(be,Ot,pt,vt);for(const Wt of Ut.positionedGlyphs){if(!Wt.rect)continue;const Sn=Wt.rect||{};let mn=_4+1,Jt=!0,$t=1,qn=0;if(Wt.image){const wn=Qe.get(Wt.image.toString());if(!wn)continue;if(wn.sdf){mr("SDF images are not supported in formatted text and will be ignored.");continue}Jt=!1,$t=wn.pixelRatio,mn=vg/$t}const vn=(qe||xt)&&Wt.vertical,xn=Wt.metrics.advance*Wt.scale/2,Vn=Wt.metrics,nr=Wt.rect;if(nr===null)continue;xt&&be.verticalizable&&(qn=Wt.image?xn-Wt.metrics.width*Wt.scale/2:0);const rr=qe?[Wt.x+xn,Wt.y]:[0,0];let gr=[0,0],ur=[0,0],lr=!1;qe||(vn?(ur=[Wt.x+xn+kt[0],Wt.y+kt[1]-qn],lr=!0):gr=[Wt.x+xn+Ee[0],Wt.y+Ee[1]-qn]);const di=nr.w*Wt.scale/($t*(Wt.localGlyph?Lu:1)),Pi=nr.h*Wt.scale/($t*(Wt.localGlyph?Lu:1));let Se,Ae,bt,Xt;if(vn){const wn=Wt.y-pt,jn=new Tt(-xn,xn-wn),Sr=-Math.PI/2,Tr=new Tt(...ur);Se=new Tt(-xn+gr[0],gr[1]),Se._rotateAround(Sr,jn)._add(Tr),Se.x+=-wn+xn,Se.y-=(Vn.left-mn)*Wt.scale;const cr=Wt.image?Vn.advance*Wt.scale:ba*Wt.scale,ei=String.fromCodePoint(Wt.glyph);foe(ei)?Se.x+=(1-mn)*Wt.scale:poe(ei)?Se.x+=cr-Vn.height*Wt.scale+(-mn-1)*Wt.scale:Se.x+=Wt.image||Vn.width+2*mn===nr.w&&Vn.height+2*mn===nr.h?(cr-Pi)/2:(cr-(Vn.height+2*mn)*Wt.scale)/2,Ae=new Tt(Se.x,Se.y-di),bt=new Tt(Se.x+Pi,Se.y),Xt=new Tt(Se.x+Pi,Se.y-di)}else{const wn=(Vn.left-mn)*Wt.scale-xn+gr[0],jn=(-Vn.top-mn)*Wt.scale+gr[1],Sr=wn+di,Tr=jn+Pi;Se=new Tt(wn,jn),Ae=new Tt(Sr,jn),bt=new Tt(wn,Tr),Xt=new Tt(Sr,Tr)}if(Ct){let wn;wn=qe?new Tt(0,0):lr?new Tt(kt[0],kt[1]):new Tt(Ee[0],Ee[1]),Se._rotateAround(Ct,wn),Ae._rotateAround(Ct,wn),bt._rotateAround(Ct,wn),Xt._rotateAround(Ct,wn)}const tn=new Tt(0,0),Qt=new Tt(0,0);Dt.push({tl:Se,tr:Ae,bl:bt,br:Xt,texPrimary:Sn,texSecondary:void 0,writingMode:be.writingMode,glyphOffset:rr,sectionIndex:Wt.sectionIndex,isSDF:Jt,pixelOffsetTL:tn,pixelOffsetBR:Qt,minFontScaleX:0,minFontScaleY:0})}}return Dt}(0,f,C,y,v,E,p,u.allowVerticalPlacement),ve=u.textSizeData;let ie=null;ve.kind==="source"?(ie=[jh*y.layout.get("text-size").evaluate(E,{},ce)*J.textScaleFactor],ie[0]>hp&&mr(`${u.layerIds[0]}: Value for "text-size" is >= ${h1}. Reduce your "text-size".`)):ve.kind==="composite"&&(ie=[jh*J.compositeTextSizes[0].evaluate(E,{},ce)*J.textScaleFactor,jh*J.compositeTextSizes[1].evaluate(E,{},ce)*J.textScaleFactor],(ie[0]>hp||ie[1]>hp)&&mr(`${u.layerIds[0]}: Value for "text-size" is >= ${h1}. Reduce your "text-size".`)),u.addSymbols(u.text,we,ie,C,v,E,z,o,l,O.lineStartIndex,O.lineLength,Y,re,ce,de,!1);for(const ge of F)$[ge]=u.text.placedSymbolArray.length-1;return 4*we.length}function nO(u){for(const o in u)return u[o];return null}function XT(u,o,l,f,p,y,v,E,C,O){let z=v.top,F=v.bottom,$=v.left,Y=v.right;if(S4(v)&&v.collisionPadding){const J=v.collisionPadding;$-=J[0],z-=J[1],Y+=J[2],F+=J[3]}if(C){const J=new Tt($,z),re=new Tt(Y,z),ce=new Tt($,F),de=new Tt(Y,F),we=ae(C);let ve=new Tt(0,0);O&&(ve=new Tt(O[0],O[1])),J._rotateAround(we,ve),re._rotateAround(we,ve),ce._rotateAround(we,ve),de._rotateAround(we,ve),$=Math.min(J.x,re.x,ce.x,de.x),Y=Math.max(J.x,re.x,ce.x,de.x),z=Math.min(J.y,re.y,ce.y,de.y),F=Math.max(J.y,re.y,ce.y,de.y)}return u.emplaceBack(o.x,o.y,o.z,l.x,l.y,$,z,Y,F,E,f,p,y),u.length-1}function rO(u){S4(u)&&u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const o=u.bottom-u.top;return o>0?Math.max(10,o):null}function koe(u,o,l,f){const p=u.compareText;if(o in p){const y=p[o];for(let v=y.length-1;v>=0;v--)if(f.dist(y[v])<l)return!0}else p[o]=[];return p[o].push(f),!1}function q4(u,o){const l=u.fovAboveCenter,f=u.elevation?u.elevation.getMinElevationBelowMSL()*o:0,p=(u._camera.position[2]*u.worldSize-f)/Math.cos(u._pitch),y=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-u._pitch-l,.01));let v=Math.sin(u._pitch)*y+p;const E=p*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let C=Math.max(u.zoom-17,0);u.isOrthographic&&(C/=10),v*=1+C}return Math.min(1.01*v,E)}function d1(u,o){if(!o.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:o};const l=Math.pow(2,-u.z),f=u.x*l,p=(u.x+1)*l,y=u.y*l,v=(u.y+1)*l,E=Ve(f),C=Ve(p),O=Ge(y),z=Ge(v),F=o.project(E,O),$=o.project(C,O),Y=o.project(C,z),J=o.project(E,z);let re=Math.min(F.x,$.x,Y.x,J.x),ce=Math.min(F.y,$.y,Y.y,J.y),de=Math.max(F.x,$.x,Y.x,J.x),we=Math.max(F.y,$.y,Y.y,J.y);const ve=l/16;function ie(be,Ee,Ue,qe,Ke,Qe){const xt=(Ue+Ke)/2,Dt=(qe+Qe)/2,Ct=o.project(Ve(xt),Ge(Dt)),kt=Math.max(0,re-Ct.x,ce-Ct.y,Ct.x-de,Ct.y-we);re=Math.min(re,Ct.x),de=Math.max(de,Ct.x),ce=Math.min(ce,Ct.y),we=Math.max(we,Ct.y),kt>ve&&(ie(be,Ct,Ue,qe,xt,Dt),ie(Ct,Ee,xt,Dt,Ke,Qe))}ie(F,$,f,y,p,y),ie($,Y,p,y,p,v),ie(Y,J,p,v,f,v),ie(J,F,f,v,f,y),re-=ve,ce-=ve,de+=ve,we+=ve;const ge=1/Math.max(de-re,we-ce);return{scale:ge,x:re*ge,y:ce*ge,x2:de*ge,y2:we*ge,projection:o}}function Z4(u,{x:o,y:l},f=0){return new Tt(((o-f)*u.scale-u.x)*Kt,(l*u.scale-u.y)*Kt)}const Roe=N(new Float32Array(16));class dp{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new le(0,0)}projectTilePoint(o,l,f){return{x:o,y:l,z:0}}locationPoint(o,l,f,p=!0){return o._coordinatePoint(o.locationCoordinate(l,f),p)}pixelsPerMeter(o,l){return Ie(1,o)*l}pixelSpaceConversion(o,l,f){return 1}farthestPixelDistance(o){return q4(o,o.pixelsPerMeter)}pointCoordinate(o,l,f,p){const y=o.horizonLineFromTop(!1),v=new Tt(l,Math.max(y,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(v,p))}pointCoordinate3D(o,l,f){const p=new Tt(l,f);if(o.elevation)return o.elevation.pointCoordinate(p);{const y=this.pointCoordinate(o,p.x,p.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(o,l){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,l.x,l.y);const f=o.horizonLineFromTop();return l.y<f}createInversionMatrix(o,l){return Roe}createTileMatrix(o,l,f){let p,y,v;const E=f.canonical,C=N(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=d1(E,this);p=1,y=O.x+f.wrap*O.scale,v=O.y,q(C,C,[p/O.scale,p/O.scale,o.pixelsPerMeter/l])}else p=l/o.zoomScale(E.z),y=(E.x+Math.pow(2,E.z)*f.wrap)*p,v=E.y*p;return G(C,C,[y,v,0]),q(C,C,[p/Kt,p/Kt,1]),C}upVector(o,l,f){return[0,0,1]}upVectorScale(o,l,f){return{metersToTile:1}}}class Doe extends dp{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,f]=this.parallels=o.parallels||[29.5,45.5],p=Math.sin(ae(l));this.n=(p+Math.sin(ae(f)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:f,c:p,r0:y}=this,v=ae(o-this.center[0]),E=ae(l),C=Math.sqrt(p-2*f*Math.sin(E))/f;return{x:C*Math.sin(v*f),y:C*Math.cos(v*f)-y,z:0}}unproject(o,l){const{n:f,c:p,r0:y}=this,v=y+l;let E=Math.atan2(o,Math.abs(v))*Math.sign(v);v*f<0&&(E-=Math.PI*Math.sign(o)*Math.sign(v));const C=ae(this.center[0])*f;E=ft(E,-Math.PI-C,Math.PI-C);const O=$e(me(E/f)+this.center[0],-180,180),z=Math.asin($e((p-(o*o+v*v)*f*f)/(2*f),-1,1)),F=$e(me(z),-et,et);return new le(O,F)}}const f1=1.340264,p1=-.081106,m1=893e-6,g1=.003796,KT=Math.sqrt(3)/2;class Loe extends dp{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const f=Math.asin(KT*Math.sin(l)),p=f*f,y=p*p*p;return{x:.5*(o*Math.cos(f)/(KT*(f1+3*p1*p+y*(7*m1+9*g1*p)))/Math.PI+.5),y:1-.5*(f*(f1+p1*p+y*(m1+g1*p))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let f=l=(2*(1-l)-1)*Math.PI,p=f*f,y=p*p*p;for(let z,F,$,Y=0;Y<12&&(F=f*(f1+p1*p+y*(m1+g1*p))-l,$=f1+3*p1*p+y*(7*m1+9*g1*p),z=F/$,f=$e(f-z,-Math.PI/3,Math.PI/3),p=f*f,y=p*p*p,!(Math.abs(z)<1e-12));++Y);const v=KT*o*(f1+3*p1*p+y*(7*m1+9*g1*p))/Math.cos(f),E=Math.asin(Math.sin(f)/KT),C=$e(180*v/Math.PI,-180,180),O=$e(180*E/Math.PI,-et,et);return new le(C,O)}}class zoe extends dp{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const f=360*(o-.5),p=$e(360*(.5-l),-et,et);return new le(f,p)}}const Cy=Math.PI/2;function YT(u){return Math.tan((Cy+u)/2)}class Noe extends dp{constructor(o){super(o),this.center=o.center||[0,30];const[l,f]=this.parallels=o.parallels||[30,30];let p=ae(l),y=ae(f);this.southernCenter=p+y<0,this.southernCenter&&(p=-p,y=-y);const v=Math.cos(p),E=YT(p);this.n=p===y?Math.sin(p):Math.log(v/Math.cos(y))/Math.log(YT(y)/E),this.f=v*Math.pow(YT(p),this.n)/this.n}project(o,l){l=ae(l),this.southernCenter&&(l=-l),o=ae(o-this.center[0]);const f=1e-6,{n:p,f:y}=this;y>0?l<-Cy+f&&(l=-Cy+f):l>Cy-f&&(l=Cy-f);const v=y/Math.pow(YT(l),p);let E=v*Math.sin(p*o),C=y-v*Math.cos(p*o);return E=.5*(E/Math.PI+.5),C=.5*(C/Math.PI+.5),{x:E,y:this.southernCenter?C:1-C,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:f,f:p}=this,y=p-l,v=Math.sign(y),E=Math.sign(f)*Math.sqrt(o*o+y*y);let C=Math.atan2(o,Math.abs(y))*v;y*f<0&&(C-=Math.PI*Math.sign(o)*v);const O=$e(me(C/f)+this.center[0],-180,180),z=$e(me(2*Math.atan(Math.pow(p/E,1/f))-Cy),-et,et);return new le(O,this.southernCenter?-z:z)}}class X4 extends dp{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:ke(o),y:Re(l),z:0}}unproject(o,l){const f=Ve(o),p=Ge(l);return new le(f,p)}}const K4=ae(et);class Foe extends dp{project(o,l){const f=(l=ae(l))*l,p=f*f;return{x:.5*((o=ae(o))*(.8707-.131979*f+p*(p*(.003971*f-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+f*(.015085+p*(.028874*f-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let f=l=(2*(1-l)-1)*Math.PI,p=25,y=0,v=f*f;do{v=f*f;const O=v*v;y=(f*(1.007226+v*(.015085+O*(.028874*v-.044475-.005916*O)))-l)/(1.007226+v*(.045255+O*(.259866*v-.311325-.005916*11*O))),f=$e(f-y,-K4,K4)}while(Math.abs(y)>1e-6&&--p>0);v=f*f;const E=$e(me(o/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),C=me(f);return new le(E,C)}}const Y4=ae(et);class Boe extends dp{project(o,l){l=ae(l),o=ae(o);const f=Math.cos(l),p=2/Math.PI,y=Math.acos(f*Math.cos(o/2)),v=Math.sin(y)/y,E=.5*(o*p+2*f*Math.sin(o/2)/v)||0,C=.5*(l+Math.sin(l)/v)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(o,l){let f=o=(2*o-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,y=25;const v=1e-6;let E=0,C=0;do{const O=Math.cos(p),z=Math.sin(p),F=2*z*O,$=z*z,Y=O*O,J=Math.cos(f/2),re=Math.sin(f/2),ce=2*J*re,de=re*re,we=1-Y*J*J,ve=we?1/we:0,ie=we?Math.acos(O*J)*Math.sqrt(1/we):0,ge=.5*(2*ie*O*re+2*f/Math.PI)-o,be=.5*(ie*z+p)-l,Ee=.5*ve*(Y*de+ie*O*J*$)+1/Math.PI,Ue=ve*(ce*F/4-ie*z*re),qe=.125*ve*(F*re-ie*z*Y*ce),Ke=.5*ve*($*J+ie*de*O)+.5,Qe=Ue*qe-Ke*Ee;E=(be*Ue-ge*Ke)/Qe,C=(ge*qe-be*Ee)/Qe,f=$e(f-E,-Math.PI,Math.PI),p=$e(p-C,-Y4,Y4)}while((Math.abs(E)>v||Math.abs(C)>v)&&--y>0);return new le(me(f),me(p))}}class J4 extends dp{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ae(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:f,cosPhi:p}=this;return{x:ae(o)*p*f+.5,y:-Math.sin(ae(l))/p*f+.5,z:0}}unproject(o,l){const{scale:f,cosPhi:p}=this,y=-(l-.5)/f,v=$e(me((o-.5)/f)/p,-180,180),E=Math.asin($e(y*p,-1,1)),C=$e(me(E),-et,et);return new le(v,C)}}class joe extends X4{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,f){const p=Zx(o,l,f);return Gt(p,p,kT(Fh(f))),{x:p[0],y:p[1],z:p[2]}}locationPoint(o,l,f){const p=se(l.lat,l.lng),y=en([],p),v=f?o._centerAltitude+f:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;Mt(p,p,y,Ie(1,0)*Kt*v);const E=N(new Float64Array(16));return H(E,o.pixelMatrix,o.globeMatrix),Gt(p,p,E),new Tt(p[0],p[1])}pixelsPerMeter(o,l){return Ie(1,0)*l}pixelSpaceConversion(o,l,f){const p=Ie(1,o)*l,y=kn(Ie(1,45)*l,p,f);return this.pixelsPerMeter(o,l)/y}createTileMatrix(o,l,f){const p=bM(Fh(f.canonical));return H(new Float64Array(16),o.globeMatrix,p)}createInversionMatrix(o,l){const{center:f}=o,p=kT(Fh(l));return te(p,p,ae(f.lng)),Q(p,p,ae(f.lat)),q(p,p,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(o,l,f,p){return LB(o,l,f,!0)||new dt(0,0)}pointCoordinate3D(o,l,f){const p=this.pointCoordinate(o,l,f,0);return[p.x,p.y,p.z]}isPointAboveHorizon(o,l){return!LB(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(p,y){const v=p.cameraToCenterDistance,E=p._centerAltitude*y,C=p._camera,O=p._camera.forward(),z=ct([],at([],O,-v),[0,0,E]),F=p.worldSize/(2*Math.PI),$=[0,0,-F],Y=p.width/p.height,J=Math.tan(p.fovAboveCenter),re=at([],C.up(),J),ce=at([],C.right(),J*Y),de=en([],ct([],ct([],O,re),ce)),we=[];let ve;if(new bc(z,de).closestPointOnSphere($,F,we)){const ie=ct([],we,$),ge=In([],ie,z);ve=Math.cos(p.fovAboveCenter)*Ze(ge)}else{const ie=In([],z,$),ge=In([],$,z);en(ge,ge);const be=Ze(ie)-F;ve=Math.sqrt(be*(be+2*F));const Ee=Math.acos(ve/(F+be))-Math.acos(sn(O,ge));ve*=Math.cos(Ee)}return 1.01*ve}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=ap(o.zoom);if(f>0){const p=q4(o,Ie(1,o.center.lat)*o.worldSize),y=o.worldSize/(2*Math.PI),v=Math.max(o.width,o.height)/o.worldSize*Math.PI;return kn(l,p+y*(1-Math.cos(v)),Math.pow(f,10))}return l}upVector(o,l,f){return Zx(l,f,o,1)}upVectorScale(o){return{metersToTile:op(OT(Fh(o)))}}}function Q4(u){const o=u.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(u.name){case"mercator":return new X4(u);case"equirectangular":return new zoe(u);case"naturalEarth":return new Foe(u);case"equalEarth":return new Loe(u);case"winkelTripel":return new Boe(u);case"albers":return l?new J4(u):new Doe(u);case"lambertConformalConic":return l?new J4(u):new Noe(u);case"globe":return new joe(u)}throw new Error(`Invalid projection name: ${u.name}`)}const $oe=lp.VectorTileFeature.types,Uoe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function JT(u,o,l,f,p,y,v,E,C,O,z,F,$){const Y=E?Math.min(hp,Math.round(E[0])):0,J=E?Math.min(hp,Math.round(E[1])):0;u.emplaceBack(o,l,Math.round(32*f),Math.round(32*p),y,v,(Y<<1)+(C?1:0),J,16*O,16*z,256*F,256*$)}function QT(u,o,l){u.emplaceBack(o,l)}function eE(u,o,l,f,p,y,v){u.emplaceBack(o,l,f,p,y,v)}function tE(u,o,l,f,p){u.emplaceBack(o,l,f,p),u.emplaceBack(o,l,f,p),u.emplaceBack(o,l,f,p),u.emplaceBack(o,l,f,p)}function Voe(u){for(const o of u.sections)if(cM(o.text))return!0;return!1}class iO{constructor(o){this.layoutVertexArray=new Qf,this.indexArray=new ia,this.programConfigurations=o,this.segments=new qi,this.dynamicLayoutVertexArray=new Vc,this.opacityVertexArray=new Nx,this.placedSymbolArray=new _T,this.iconTransitioningVertexArray=new Lh,this.globeExtVertexArray=new zs,this.zOffsetVertexArray=new Yf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,l,f,p,y){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,ioe.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,aoe.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Uoe,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,loe.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,ooe.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||y)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,soe.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||p)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}dn(iO,"SymbolBuffers");class oO{constructor(o,l,f){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new f,this.segments=new qi,this.collisionVertexArray=new Bx,this.collisionVertexArrayExt=new Vc}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,coe.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,uoe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(oO,"CollisionBuffers");class nE{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=N([]),this.placementViewportMatrix=N([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=C4(this.zoom,l["text-size"]),this.iconSizeData=C4(this.zoom,l["icon-size"]);const f=this.layers[0].layout,p=f.get("symbol-sort-key"),y=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(v=>dl[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new iO(new zd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new iO(new zd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new Gx,this.lineVertexArray=new xT,this.symbolInstances=new vT}calculateGlyphDependencies(o,l,f,p,y){for(const v of o){const E=v.codePointAt(0);if(E===void 0)break;if(l[E]=!0,p&&y&&E<=65535){const C=a1[v];C&&(l[C.charCodeAt(0)]=!0)}}}updateFootprints(o,l){}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const f=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!BM(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(o,l,f,p){const y=this.layers[0],v=y.layout,E=this.projection.name==="globe",C=v.get("text-font"),O=v.get("text-field"),z=v.get("icon-image"),[F,$]=v.get("icon-size-scale-range"),Y=$e(l.scaleFactor||1,F,$),J=(O.value.kind!=="constant"||O.value.value instanceof Oa&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),re=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,ce=v.get("symbol-sort-key");if(this.features=[],!J&&!re)return;const de=l.iconDependencies,we=l.glyphDependencies,ve=l.availableImages,ie=new ii(this.zoom);for(const{feature:ge,id:be,index:Ee,sourceLayerIndex:Ue}of o){const qe=y._featureFilter.needGeometry,Ke=En(ge,qe);if(!y._featureFilter.filter(ie,Ke,f))continue;if(qe||(Ke.geometry=gn(ge,f,p)),E&&ge.type!==1&&f.z<=5){const kt=Ke.geometry,Bt=.98078528056,_t=(Ot,pt)=>sn(Zx(Ot.x,Ot.y,f,1),Zx(pt.x,pt.y,f,1))<Bt;for(let Ot=0;Ot<kt.length;Ot++)kt[Ot]=Lt(kt[Ot],_t)}let Qe,xt;if(J){const kt=y.getValueAndResolveTokens("text-field",Ke,f,ve),Bt=Oa.factory(kt);Voe(Bt)&&(this.hasRTLText=!0),(!this.hasRTLText||Zf()==="unavailable"||this.hasRTLText&&zl.isParsed())&&(Qe=doe(Bt,y,Ke))}if(re){const kt=y.getValueAndResolveTokens("icon-image",Ke,f,ve);xt=typeof kt=="string"?ka.build(kt):kt}if(!Qe&&!xt)continue;const Dt=this.sortFeaturesByKey?ce.evaluate(Ke,{},f):void 0,Ct={id:be,text:Qe,icon:xt,index:Ee,sourceLayerIndex:Ue,geometry:Ke.geometry,properties:ge.properties,type:$oe[ge.type],sortKey:Dt};if(this.features.push(Ct),xt){const kt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Bt,iconSecondary:_t}=V4(xt,this.iconSizeData,kt["icon-size"],f,this.zoom,Ct,this.pixelRatio,Y),Ot=Bt.id.toString();if(de.has(Ot)?de.get(Ot).push(Bt):de.set(Ot,[Bt]),_t){const pt=_t.id.toString();de.has(pt)?de.get(pt).push(_t):de.set(pt,[_t])}}if(Qe){const kt=C.evaluate(Ke,{},f).join(","),Bt=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dl.vertical)>=0;for(const _t of Qe.sections)if(_t.image){const Ot=_t.image.getPrimary().scaleSelf(this.pixelRatio),pt=Ot.id.toString(),vt=de.get(pt)||[];vt.push(Ot),de.set(pt,vt)}else{const Ot=Ex(Qe.toString()),pt=_t.fontStack||kt,vt=we[pt]=we[pt]||{};this.calculateGlyphDependencies(_t.text,vt,Bt,this.allowVerticalPlacement,Ot)}}}if(v.get("symbol-placement")==="line"&&(this.features=function(ge){const be={},Ee={},Ue=[];let qe=0;function Ke(Ct){Ue.push(ge[Ct]),qe++}function Qe(Ct,kt,Bt){const _t=Ee[Ct];return delete Ee[Ct],Ee[kt]=_t,Ue[_t].geometry[0].pop(),Ue[_t].geometry[0]=Ue[_t].geometry[0].concat(Bt[0]),_t}function xt(Ct,kt,Bt){const _t=be[kt];return delete be[kt],be[Ct]=_t,Ue[_t].geometry[0].shift(),Ue[_t].geometry[0]=Bt[0].concat(Ue[_t].geometry[0]),_t}function Dt(Ct,kt,Bt){const _t=Bt?kt[0][kt[0].length-1]:kt[0][0];return`${Ct}:${_t.x}:${_t.y}`}for(let Ct=0;Ct<ge.length;Ct++){const kt=ge[Ct],Bt=kt.geometry,_t=kt.text?kt.text.toString():null;if(!_t){Ke(Ct);continue}const Ot=Dt(_t,Bt),pt=Dt(_t,Bt,!0);if(Ot in Ee&&pt in be&&Ee[Ot]!==be[pt]){const vt=xt(Ot,pt,Bt),Ut=Qe(Ot,pt,Ue[vt].geometry);delete be[Ot],delete Ee[pt],Ee[Dt(_t,Ue[Ut].geometry,!0)]=Ut,Ue[vt].geometry=null}else Ot in Ee?Qe(Ot,pt,Bt):pt in be?xt(Ot,pt,Bt):(Ke(Ct),be[Ot]=qe-1,Ee[pt]=qe-1)}return Ue.filter(Ct=>Ct.geometry)}(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ge of l.elevationFeatures)this.elevationFeatureIdToIndex.set(ge.id,this.elevationFeatures.length),this.elevationFeatures.push(ge)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ge,be)=>ge.sortKey-be.sortKey)}update(o,l,f,p,y,v,E){this.text.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E),this.icon.programConfigurations.updatePaintArrays(o,l,y,f,p,v,E)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);if(f.elevationFeatureIndex===65535)continue;const p=this.elevationFeatures[f.elevationFeatureIndex];if(p){const y=.05+p.pointElevation(new Tt(f.tileAnchorX,f.tileAnchorY));f.zOffset!==y&&(o=!0,f.zOffset=y)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const o=(y,v,E)=>{f+=v,f>y.length&&y.resize(f);for(let C=-v;C<0;C++)y.emplace(C+f,E)},l=(y,v,E)=>{p+=v,p>y.length&&y.resize(p);for(let C=-v;C<0;C++)y.emplace(C+p,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,p=0;for(let y=0;y<this.symbolInstances.length;y++){const v=this.symbolInstances.get(y),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:C,numIconVertices:O}=v,z=v.zOffset,F=O>0;if((E>0||C>0)&&(o(this.text.zOffsetVertexArray,E,z),o(this.text.zOffsetVertexArray,C,z)),F){const{placedIconSymbolIndex:$,verticalPlacedIconSymbolIndex:Y}=v;$>=0&&l(this.icon.zOffsetVertexArray,O,z),Y>=0&&l(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,z)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Q4(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const f=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:p,y}of l)this.lineVertexArray.emplaceBack(p,y);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re,ce){const de=o.indexArray,we=o.layoutVertexArray,ve=o.globeExtVertexArray,ie=o.segments.prepareSegment(4*l.length,we,de,this.canOverlap?v.sortKey:void 0),ge=this.glyphOffsetArray.length,be=ie.vertexLength,Ee=this.allowVerticalPlacement&&E===dl.vertical?Math.PI/2:0,Ue=v.text&&v.text.sections;for(let Ke=0;Ke<l.length;Ke++){const{tl:Qe,tr:xt,bl:Dt,br:Ct,texPrimary:kt,texSecondary:Bt,pixelOffsetTL:_t,pixelOffsetBR:Ot,minFontScaleX:pt,minFontScaleY:vt,glyphOffset:Ut,isSDF:Wt,sectionIndex:Sn}=l[Ke],mn=ie.vertexLength,Jt=Ut[1];if(JT(we,O.x,O.y,Qe.x,Jt+Qe.y,kt.x,kt.y,f,Wt,_t.x,_t.y,pt,vt),JT(we,O.x,O.y,xt.x,Jt+xt.y,kt.x+kt.w,kt.y,f,Wt,Ot.x,_t.y,pt,vt),JT(we,O.x,O.y,Dt.x,Jt+Dt.y,kt.x,kt.y+kt.h,f,Wt,_t.x,Ot.y,pt,vt),JT(we,O.x,O.y,Ct.x,Jt+Ct.y,kt.x+kt.w,kt.y+kt.h,f,Wt,Ot.x,Ot.y,pt,vt),C){const{x:$t,y:qn,z:vn}=C.anchor,[xn,Vn,nr]=C.up;eE(ve,$t,qn,vn,xn,Vn,nr),eE(ve,$t,qn,vn,xn,Vn,nr),eE(ve,$t,qn,vn,xn,Vn,nr),eE(ve,$t,qn,vn,xn,Vn,nr),tE(o.dynamicLayoutVertexArray,$t,qn,vn,Ee)}else tE(o.dynamicLayoutVertexArray,O.x,O.y,O.z,Ee);if(ce){const $t=Bt||kt;QT(o.iconTransitioningVertexArray,$t.x,$t.y),QT(o.iconTransitioningVertexArray,$t.x+$t.w,$t.y),QT(o.iconTransitioningVertexArray,$t.x,$t.y+$t.h),QT(o.iconTransitioningVertexArray,$t.x+$t.w,$t.y+$t.h)}de.emplaceBack(mn,mn+1,mn+2),de.emplaceBack(mn+1,mn+2,mn+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ut[0]),Ke!==l.length-1&&Sn===l[Ke+1].sectionIndex||o.programConfigurations.populatePaintArrays(we.length,v,v.index,{},Y,J,re,Ue&&Ue[Sn])}const qe=C?C.anchor:O;o.placedSymbolArray.emplaceBack(qe.x,qe.y,qe.z,O.x,O.y,ge,this.glyphOffsetArray.length-ge,be,z,F,O.segment,f?f[0]:0,f?f[1]:0,p[0],p[1],E,0,0,0,$,0)}_commitLayoutVertex(o,l,f,p,y,v,E){o.emplaceBack(l,f,p,y,v,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(o,l,f,p,y,v,E){const C=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),O=C.vertexLength,z=E.tileAnchorX,F=E.tileAnchorY;for(let Y=0;Y<4;Y++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,l,o.padding,E.zOffset),this._commitLayoutVertex(f.layoutVertexArray,p,y,v,z,F,new Tt(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,y,v,z,F,new Tt(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,y,v,z,F,new Tt(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,p,y,v,z,F,new Tt(o.x1,o.y2)),C.vertexLength+=4;const $=f.indexArray;$.emplaceBack(O,O+1),$.emplaceBack(O+1,O+2),$.emplaceBack(O+2,O+3),$.emplaceBack(O+3,O),C.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,f,p,y,v){for(let E=p;E<y;E++){const C=f.get(E),O=this.getSymbolInstanceTextSize(o,v,l,E);this._addCollisionDebugVertices(C,O,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(o,l,f,p,y,v){for(let E=p;E<y;E++){const C=f.get(E),O=this.getSymbolInstanceIconSize(o,l,v.placedIconSymbolIndex);this._addCollisionDebugVertices(C,O,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,v)}}generateCollisionDebugBuffers(o,l,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oO(py,f4.members,Lh),this.iconCollisionBox=new oO(py,f4.members,Lh);const p=l1(this.iconSizeData,o),y=l1(this.textSizeData,o,f);for(let v=0;v<this.symbolInstances.length;v++){const E=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(o,l,f,p){const y=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),v=YM(this.textSizeData,o,y)/ba;return this.tilePixelRatio*v}getSymbolInstanceIconSize(o,l,f){const p=this.icon.placedSymbolArray.get(f),y=YM(this.iconSizeData,o,p);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(o,l,f,p){o.emplaceBack(l,-f,-f,p),o.emplaceBack(l,f,-f,p),o.emplaceBack(l,f,f,p),o.emplaceBack(l,-f,f,p)}_updateTextDebugCollisionBoxes(o,l,f,p,y,v,E){for(let C=p;C<y;C++){const O=f.get(C),z=this.getSymbolInstanceTextSize(o,v,l,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,z,O.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(o,l,f,p,y,v,E){for(let C=p;C<y;C++){const O=f.get(C),z=this.getSymbolInstanceIconSize(o,l,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,z,O.padding,v.zOffset)}}updateCollisionDebugBuffers(o,l,f,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const y=l1(this.iconSizeData,o,p),v=l1(this.textSizeData,o,f);for(let E=0;E<this.symbolInstances.length;E++){const C=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(v,o,l,C.textBoxStartIndex,C.textBoxEndIndex,C,f),this._updateTextDebugCollisionBoxes(v,o,l,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C,f),this._updateIconDebugCollisionBoxes(y,o,l,C.iconBoxStartIndex,C.iconBoxEndIndex,C,p),this._updateIconDebugCollisionBoxes(y,o,l,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,f,p,y,v,E,C,O){const z={};if(l<f){const{x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie,featureIndex:ge}=o.get(l);z.textBox={x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie},z.textFeatureIndex=ge}if(p<y){const{x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie,featureIndex:ge}=o.get(p);z.verticalTextBox={x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie},z.verticalTextFeatureIndex=ge}if(v<E){const{x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie,featureIndex:ge}=o.get(v);z.iconBox={x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie},z.iconFeatureIndex=ge}if(C<O){const{x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie,featureIndex:ge}=o.get(C);z.verticalIconBox={x1:F,y1:$,x2:Y,y2:J,padding:re,projectedAnchorX:ce,projectedAnchorY:de,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ie},z.verticalIconFeatureIndex=ge}return z}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,l){const f=o.placedSymbolArray.get(l),p=f.vertexStartIndex+4*f.numGlyphs;for(let y=f.vertexStartIndex;y<p;y+=4)o.indexArray.emplaceBack(y,y+1,y+2),o.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(o),f=Math.cos(o),p=[],y=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const C=this.symbolInstances.get(E);p.push(0|Math.round(l*C.tileAnchorX+f*C.tileAnchorY)),y.push(C.featureIndex)}return v.sort((E,C)=>p[E]-p[C]||y[C]-y[E]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,l){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===l?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const f=this.symbolInstances.get(l);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:O}=f;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),y>=0&&y!==p&&this.addIndicesForPlacedSymbol(this.text,y),v>=0&&v!==y&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let e5,t5,aO;dn(nE,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nE.addDynamicAttributes=tE;class n5{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:oc,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(n5,"FormatSectionOverride",{omit:["defaultValue"]});const sO=()=>aO||(aO={layout:e5||(e5=new io({"symbol-placement":new Zt(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cn(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(st.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Zt(st.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Zt(st.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Zt(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Zt(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new cn(st.layout_symbol["icon-size"]),"icon-size-scale-range":new Zt(st.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new cn(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cn(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new cn(st.layout_symbol["icon-image"]),"icon-rotate":new cn(st.layout_symbol["icon-rotate"]),"icon-padding":new Zt(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(st.layout_symbol["icon-keep-upright"]),"icon-offset":new cn(st.layout_symbol["icon-offset"]),"icon-anchor":new cn(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(st.layout_symbol["text-rotation-alignment"]),"text-field":new cn(st.layout_symbol["text-field"]),"text-font":new cn(st.layout_symbol["text-font"]),"text-size":new cn(st.layout_symbol["text-size"]),"text-size-scale-range":new Zt(st.layout_symbol["text-size-scale-range"]),"text-max-width":new cn(st.layout_symbol["text-max-width"]),"text-line-height":new cn(st.layout_symbol["text-line-height"]),"text-letter-spacing":new cn(st.layout_symbol["text-letter-spacing"]),"text-justify":new cn(st.layout_symbol["text-justify"]),"text-radial-offset":new cn(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(st.layout_symbol["text-variable-anchor"]),"text-anchor":new cn(st.layout_symbol["text-anchor"]),"text-max-angle":new Zt(st.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(st.layout_symbol["text-writing-mode"]),"text-rotate":new cn(st.layout_symbol["text-rotate"]),"text-padding":new Zt(st.layout_symbol["text-padding"]),"text-keep-upright":new Zt(st.layout_symbol["text-keep-upright"]),"text-transform":new cn(st.layout_symbol["text-transform"]),"text-offset":new cn(st.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Zt(st.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(st.layout_symbol["text-optional"]),visibility:new Zt(st.layout_symbol.visibility)})),paint:t5||(t5=new io({"icon-opacity":new cn(st.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new cn(st.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new cn(st.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new cn(st.paint_symbol["text-emissive-strength"]),"icon-color":new cn(st.paint_symbol["icon-color"]),"icon-halo-color":new cn(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new cn(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cn(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(st.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Zt(st.paint_symbol["icon-image-cross-fade"]),"text-opacity":new cn(st.paint_symbol["text-opacity"]),"text-occlusion-opacity":new cn(st.paint_symbol["text-occlusion-opacity"]),"text-color":new cn(st.paint_symbol["text-color"],{runtimeType:Wa,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new cn(st.paint_symbol["text-halo-color"]),"text-halo-width":new cn(st.paint_symbol["text-halo-width"]),"text-halo-blur":new cn(st.paint_symbol["text-halo-blur"]),"text-translate":new Zt(st.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(st.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Zt(st.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Zt(st.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Zt(st.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Zt(st.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new cn(st.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},aO);class rE extends gs{constructor(o,l,f,p){super(o,sO(),l,f,p),this._colorAdjustmentMatrix=N([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,l){super.recalculate(o,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const p=[];for(const y of f)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,l,f,p){return this._saturation===o&&this._contrast===l&&this._brightnessMin===f&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(y,v,E,C){y=ga(y),v=ma(v);const O=B(),z=y/3,F=1-2*z,$=[F,z,z,0,z,F,z,0,z,z,F,0,0,0,0,1],Y=.5-.5*v,J=C-E;return H(O,[J,0,0,0,0,J,0,0,0,0,J,0,E,E,E,1],[v,0,0,0,0,v,0,0,0,0,v,0,Y,Y,Y,1]),H(O,O,$),O}(o,l,f,p),this._saturation=o,this._contrast=l,this._brightnessMin=f,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,l,f,p){const y=this.layout.get(o).evaluate(l,{},f,p),v=this._unevaluatedLayout._values[o];return v.isDataDriven()||ny(v.value)||!y?y:function(E,C){return C.replace(/{([^{}]+)}/g,(O,z)=>z in E?String(E[z]):"")}(l.properties,y)}createBucket(o){return new nE(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of sO().paint.overridableProperties){if(!rE.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),f=new n5(l),p=new wx(f,l.property.specification,this.scope,this.options);let y=null;y=l.value.kind==="constant"||l.value.kind==="source"?new Pd("source",p):new Hf("composite",p,l.value.zoomStops,l.value.interpolationType),this.paint._values[o]=new Xf(l.property,y,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&rE.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const f=o.get("text-field"),p=sO().paint.properties[l];let y=!1;const v=E=>{for(const C of E)if(p.overrides&&p.overrides.hasOverride(C))return void(y=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Oa)v(f.value.value.sections);else if(f.value.kind==="source"){const E=O=>{y||(O instanceof ar&&Oo(O.value)===Su?v(O.value.sections):O instanceof ns?v(O.sections):O.eachChild(E))},C=f.value;C._styleExpression&&E(C._styleExpression.expression)}return y}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,l,f){return{config:new Nh(this,{zoom:l,lut:f}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let r5,i5,o5,a5;var lO=zr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function cO(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function uO(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class hO{constructor(o,l,f,p){this.context=o,this.format=f,this.useMipmap=p&&p.useMipmap,this.texture=o.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(o,l){const f=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,p=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:y}=this,{gl:v}=y,{x:E,y:C}=l&&l.position?l.position:{x:0,y:0},O=E+f,z=C+p;!this.size||this.size[0]===O&&this.size[1]===z||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!l||l.premultiply!==!1));const F=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&O>0&&z>0){const $=this.useMipmap?Math.floor(Math.log2(Math.max(O,z)))+1:1;v.texStorage2D(v.TEXTURE_2D,$,this.format,O,z),this.size=[O,z]}if(this.size)if(F)v.texSubImage2D(v.TEXTURE_2D,0,E,C,cO(this.format),uO(this.format),o);else{const $=o.data;$&&v.texSubImage2D(v.TEXTURE_2D,0,E,C,f,p,cO(this.format),uO(this.format),$)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(o,l,f=!1){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap&&!f?o===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),l!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(o,l,f,p){const{context:y}=this,{gl:v}=y;v.bindTexture(v.TEXTURE_2D,this.texture),l!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,l),this.magFilter=l),o!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?o===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),f!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,f),this.wrapS=f),p!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,p),this.wrapT=p)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class iE{constructor(o,l){this.context=o,this.texture=l}bind(o,l){const{context:f}=this,{gl:p}=f;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,o),this.minFilter=o),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}function oE(u,o,l,f,p,y,v,E){const C=[u,o,1,l,f,1,p,y,1],O=[v,E,1],z=k([],C),[F,$,Y]=Tn(O,O,z);return R(C,C,[F,0,0,0,$,0,0,0,Y])}function s5(u,o,l,f,p,y,v,E){const C=function(O,z,F,$,Y,J,re,ce){const de=oE(0,0,1,0,1,1,0,1),we=oE(O,z,F,$,Y,J,re,ce);return R(we,we,k([],de))}(u,o,l,f,p,y,v,E);return[C[2]/C[8]/Kt,C[5]/C[8]/Kt]}function aE(u){return[u[0],Math.min(Math.max(u[1],-et),et)]}class l5 extends ol{constructor(o,l,f,p){super(),this.id=o,this.dispatcher=f,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(o,l){if(this._loaded=l||!1,this.fire(new ic("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=kl(this.map._requestManager.transformRequest(this.url,Fr.Image),(f,p)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new Ei(f)):p&&(this.image=p instanceof HTMLImageElement?Mo.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new iE(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ic("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof iE||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=o[0][1],f=o[0][1];for(const y of o)y[1]>f&&(f=y[1]),y[1]<l&&(l=y[1]);const p=(f+l)/2;if(p>et?this.onNorthPole=!0:p<-et&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const y=o.map(dt.fromLngLat);this.tileID=function(v){let E=1/0,C=1/0,O=-1/0,z=-1/0;for(const re of v)E=Math.min(E,re.x),C=Math.min(C,re.y),O=Math.max(O,re.x),z=Math.max(z,re.y);const F=Math.max(O-E,z-C),$=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),Y=Math.pow(2,$);let J=Math.floor((E+O)/2*Y);return J>1&&(J-=1),new Ai($,J,Math.floor((C+z)/2*Y))}(y),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new ic("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const de in this.tiles){const we=this.tiles[de];we.state!=="loaded"&&(we.state="loaded",we.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=d1(new Ai(0,0,0),this.map.transform.projection),f=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(de){const we=de[1].x-de[0].x,ve=de[1].y-de[0].y,ie=de[2].x-de[1].x,ge=de[2].y-de[1].y,be=de[3].x-de[2].x,Ee=de[3].y-de[2].y,Ue=de[0].x-de[3].x,qe=de[0].y-de[3].y,Ke=we*ge-ie*ve,Qe=ie*Ee-be*ge,xt=be*qe-Ue*Ee,Dt=Ue*ve-we*qe;return Ke>0&&Qe>0&&xt>0&&Dt>0||Ke<0&&Qe<0&&xt<0&&Dt<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=d1(this.tileID,this.map.transform.projection),[y,v,E,C]=this.coordinates.map(de=>{const we=p.projection.project(de[0],de[1]);return Z4(p,we)._round()});this.perspectiveTransform=s5(y.x,y.y,v.x,v.y,E.x,E.y,C.x,C.y);const O=this._boundsArray=new Rd;O.emplaceBack(y.x,y.y,0,0),O.emplaceBack(v.x,v.y,Kt,0),O.emplaceBack(C.x,C.y,0,Kt),O.emplaceBack(E.x,E.y,Kt,Kt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(O,lO.members),this.boundsSegments=qi.simpleSegment(0,0,4,2);const z=[],F=[aE(($=this.coordinates)[0]),aE($[1]),aE($[2]),aE($[3])];var $;const[Y,J,re,ce]=function(de){let we=de[0][0],ve=we,ie=de[0][1],ge=ie;for(let be=1;be<de.length;be++)de[be][0]<we?we=de[be][0]:de[be][0]>ve&&(ve=de[be][0]),de[be][1]<ie?ie=de[be][1]:de[be][1]>ge&&(ge=de[be][1]);return[we,ie,ve-we,ge-ie]}(F);{const de=new Rd,[we,ve,ie,ge]=function(_t){let Ot=_t[0].x,pt=Ot,vt=_t[0].y,Ut=vt;for(let Wt=1;Wt<_t.length;Wt++)_t[Wt].x<Ot?Ot=_t[Wt].x:_t[Wt].x>pt&&(pt=_t[Wt].x),_t[Wt].y<vt?vt=_t[Wt].y:_t[Wt].y>Ut&&(Ut=_t[Wt].y);return[Ot,vt,pt-Ot,Ut-vt]}(f),be=_t=>[(_t.x-we)/ie,(_t.y-ve)/ge],[Ee,Ue,qe,Ke]=f.map(be),Qe=function(_t,Ot,pt,vt,Ut,Wt,Sn,mn){const Jt=oE(0,0,1,0,1,1,0,1);return R(Jt,Jt,k([],oE(_t,Ot,pt,vt,Ut,Wt,Sn,mn)))}(Ee[0],Ee[1],Ue[0],Ue[1],qe[0],qe[1],Ke[0],Ke[1]);this.elevatedGlobePerspectiveTransform=s5(Ee[0],Ee[1],Ue[0],Ue[1],qe[0],qe[1],Ke[0],Ke[1]);const xt=(_t,Ot)=>{z.push(_t.lng);const pt=Math.round((_t.lng-Y)/re*Kt),vt=Math.round((_t.lat-J)/ce*Kt),Ut=be(Ot),Wt=Tn([],[Ut[0],Ut[1],1],Qe),Sn=Math.round(Wt[0]/Wt[2]*Kt),mn=Math.round(Wt[1]/Wt[2]*Kt);de.emplaceBack(pt,vt,Sn,mn)},Dt=f[3].x-f[0].x,Ct=f[3].y-f[0].y,kt=f[2].x-f[1].x,Bt=f[2].y-f[1].y;for(let _t=0;_t<65;_t++){const Ot=_t/64,pt=[f[0].x+Ot*Dt,f[0].y+Ot*Ct],vt=[f[1].x+Ot*kt,f[1].y+Ot*Bt],Ut=vt[0]-pt[0],Wt=vt[1]-pt[1];for(let Sn=0;Sn<65;Sn++){const mn=Sn/64,Jt={x:pt[0]+Ut*mn,y:pt[1]+Wt*mn,z:0};xt(l.projection.unproject(Jt.x,Jt.y),Jt)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(de,lO.members)}{this.maxLongitudeTriangleSize=0;let de=[],we=new ia;const ve=(ie,ge,be)=>{we.emplaceBack(ie,ge,be);const Ee=z[ie],Ue=z[ge],qe=z[be],Ke=Math.min(Math.min(Ee,Ue),qe),Qe=Math.max(Math.max(Ee,Ue),qe)-Ke;Qe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Qe),de.push(Ke+Qe/2)};for(let ie=0;ie<64;ie++)for(let ge=0;ge<64;ge++){const be=65*ie+ge,Ee=be+1,Ue=be+65,qe=Ue+1;ve(be,Ue,Ee),ve(Ee,Ue,qe)}[de,we]=function(ie,ge){const be=Array.from({length:ie.length},(qe,Ke)=>Ke);be.sort((qe,Ke)=>ie[qe]-ie[Ke]);const Ee=[],Ue=new ia;for(let qe=0;qe<be.length;qe++){const Ke=be[qe];Ee.push(ie[Ke]);const Qe=3*Ke,xt=Qe+1;Ue.emplaceBack(ge.uint16[Qe],ge.uint16[xt],ge.uint16[xt+1])}return[Ee,Ue]}(de,we),this.elevatedGlobeTrianglesCenterLongitudes=de,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(we)}this.elevatedGlobeSegments=qi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,re/Kt,0,ce/Kt,0,0,J,Y,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const l=this.map.painter.context,f=l.gl;!this._dirty||this.texture instanceof iE||(this.texture?this.texture.update(this.image):(this.texture=new hO(l,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(l)}loadTile(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let p=(y=o+180)+360*Math.round((f[0]-y)/360);var y;const v=new qi,E=(F,$)=>{v.segments.push({vertexOffset:0,primitiveOffset:F,vertexLength:l.segments[0].vertexLength,primitiveLength:$,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-p)<=C){const F=Cs(f,0,f.length,p+C);return F===f.length||E(F,$o(f,F+1,f.length,p+360-C)-F),v}p<f[0]&&(p+=360);const O=$o(f,0,f.length,p-C);if(O===f.length)return E(0,f.length),v;E(0,O-0);const z=Cs(f,O+1,f.length,p+C);return z!==f.length&&E(z,f.length-z),v}}const Woe=(Math.pow(256,2)-1)/16907520;class c5 extends gs{constructor(o,l,f,p){super(o,{layout:o5||(o5=new io({visibility:new Zt(st.layout_raster.visibility)})),paint:a5||(a5=new io({"raster-opacity":new Zt(st.paint_raster["raster-opacity"]),"raster-color":new Od(st.paint_raster["raster-color"]),"raster-color-mix":new Zt(st.paint_raster["raster-color-mix"]),"raster-color-range":new Zt(st.paint_raster["raster-color-range"]),"raster-hue-rotate":new Zt(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(st.paint_raster["raster-saturation"]),"raster-contrast":new Zt(st.paint_raster["raster-contrast"]),"raster-resampling":new Zt(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(st.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Zt(st.paint_raster["raster-emissive-strength"]),"raster-array-band":new Zt(st.paint_raster["raster-array-band"]),"raster-elevation":new Zt(st.paint_raster["raster-elevation"]),"raster-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},l,f,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof l5&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[f,p]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(p)||f===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=Xx({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,p])}}let u5,h5,d5,f5,p5;class m5 extends gs{constructor(o,l,f,p){super(o,{layout:u5||(u5=new io({visibility:new Zt(st["layout_raster-particle"].visibility)})),paint:h5||(h5=new io({"raster-particle-array-band":new Zt(st["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Zt(st["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Od(st["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Zt(st["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Zt(st["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Zt(st["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Zt(st["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Zt(st["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},l,f,p),this._updateColorRamp(),this.lastInvalidatedAt=Mo.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Xx({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Mo.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Goe extends gs{constructor(o,l){super(o,{},l,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function dO(u,o,l){const f=[0,0,1],p=Cn([]);return _n(p,p,l?-ae(u)+Math.PI:ae(u)),Mn(p,p,-ae(o)),hn(f,f,p),en(f,f)}function g5(u,o){const l=sE(u.projection,u.zoom,u.width,u.height),f=function(y,v,E,C,O){const z=new le(E.lng-180*fp,E.lat),F=new le(E.lng+180*fp,E.lat),$=y.project(z.lng,z.lat),Y=y.project(F.lng,F.lat),J=-Math.atan2(Y.y-$.y,Y.x-$.x),re=dt.fromLngLat(E);re.y=$e(re.y,-1+fp,1-fp);const ce=re.toLngLat(),de=y.project(ce.lng,ce.lat),we=dt.fromLngLat(ce);we.x+=fp;const ve=we.toLngLat(),ie=y.project(ve.lng,ve.lat),ge=y5(ie.x-de.x,ie.y-de.y,J),be=dt.fromLngLat(ce);be.y+=fp;const Ee=be.toLngLat(),Ue=y.project(Ee.lng,Ee.lat),qe=y5(Ue.x-de.x,Ue.y-de.y,J),Ke=Math.abs(ge.x)/Math.abs(qe.y),Qe=N([]);ue(Qe,Qe,-J*(1-(O?0:C)));const xt=N([]);return q(xt,xt,[1,1-(1-Ke)*C,1]),xt[4]=-qe.x/qe.y*C,ue(xt,xt,J),H(xt,Qe,xt),xt}(u.projection,0,u.center,l,o),p=_5(u);return q(f,f,[p,p,1]),f}function _5(u){const o=u.projection,l=sE(u.projection,u.zoom,u.width,u.height),f=fO(o,u.center),p=fO(o,le.convert(o.center));return Math.pow(2,f*l+(1-l)*p)}function sE(u,o,l,f,p=1/0){const y=u.range;if(!y)return 0;const v=Math.min(p,Math.max(l,f)),E=Math.log(v/1024)/Math.LN2;return Ye(y[0]+E,y[1]+E,o)}const fp=1/4e4;function fO(u,o){const l=$e(o.lat,-et,et),f=new le(o.lng-180*fp,l),p=new le(o.lng+180*fp,l),y=u.project(f.lng,l),v=u.project(p.lng,l),E=dt.fromLngLat(f),C=dt.fromLngLat(p),O=v.x-y.x,z=v.y-y.y,F=C.x-E.x,$=C.y-E.y,Y=Math.sqrt((F*F+$*$)/(O*O+z*z));return Math.log(Y)/Math.LN2}function y5(u,o,l){const f=Math.cos(l),p=Math.sin(l);return{x:u*f-o*p,y:u*p+o*f}}function v5(u,o,l){N(u),ue(u,u,ae(o[2])),Q(u,u,ae(o[0])),te(u,u,ae(o[1])),q(u,u,l),H(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function lE(u,o,l,f,p,y,v,E){const C=[l[0]-o[0],l[1]-o[1],0],O=[f[0]-o[0],f[1]-o[1],0];if(Ze(C)<1e-12||Ze(O)<1e-12)return Cn(u);const z=Vt([],C,O);en(z,z),ot(O,f,o),C[2]=(y-p)*E,O[2]=(v-p)*E;const F=C;return Vt(F,C,O),en(F,F),to(u,z,F)}function pO(u,o,l=!1){const f=ap(o.zoom),p=function(y,v,E){const C=v.worldSize,O=[y[12],y[13],y[14]],z=Ge(O[1]/C),F=Ve(O[0]/C),$=N([]),Y=Ie(1,z)*C,J=Ie(1,0)*C*wt(z,v.zoom),re=1/wM(C);let ce=J*re;if(E){const ie=sE(v.projection,v.zoom,v.width,v.height,1024);ce=re*v.projection.pixelSpaceConversion(v.center.lat,C,ie)}const de=se(z,F);ct(de,de,at([],en([],de),Y*ce*O[2]));const we=function(ie){const ge=[ie[0],ie[1],ie[2]];let be=[0,1,0];const Ee=Vt([],be,ge);return Vt(be,ge,Ee),rn(be)===0&&(be=[0,1,0],Vt(Ee,ge,be)),en(Ee,Ee),en(be,be),en(ge,ge),[Ee[0],Ee[1],Ee[2],0,be[0],be[1],be[2],0,ge[0],ge[1],ge[2],0,ie[0],ie[1],ie[2],1]}(de);q($,$,[ce,ce,ce*Y]),G($,$,[-O[0],-O[1],-O[2]]);const ve=H([],v.globeMatrix,we);return H(ve,ve,$),H(ve,ve,y),ve}(u,o,l);if(f>0){const y=function(v,E){const C=E.worldSize,O=Ie(1,0)*C*wt(E.center.lat,E.zoom)/wM(C),z=Ie(1,E.center.lat)*C,F=N([]);return te(F,F,ae(E.center.lng)),Q(F,F,ae(E.center.lat)),G(F,F,[0,0,S]),q(F,F,[O,O,O*z]),G(F,F,[E.point.x-.5*C,E.point.y-.5*C,0]),H(F,F,v),H(F,E.globeMatrix,F)}(u,o);return function(v,E,C){const O=(J,re,ce)=>{const de=Ze(J),we=Ze(re),ve=Fd(J,re,ce);return at(ve,ve,1/Ze(ve)*kn(de,we,ce))},z=O([v[0],v[1],v[2]],[E[0],E[1],E[2]],C),F=O([v[4],v[5],v[6]],[E[4],E[5],E[6]],C),$=O([v[8],v[9],v[10]],[E[8],E[9],E[10]],C),Y=Fd([v[12],v[13],v[14]],[E[12],E[13],E[14]],C);return[z[0],z[1],z[2],0,F[0],F[1],F[2],0,$[0],$[1],$[2],0,Y[0],Y[1],Y[2],1]}(p,y,f)}return p}function x5(u,o,l,f){const p=Li.projectAabbCorners(f,l);let y=Number.MAX_VALUE,v=-1;for(let O=0;O<p.length;++O){const z=p[O];z[0]=(.5*z[0]+.5)*o.width,z[1]=(.5-.5*z[1])*o.height,z[2]<y&&(v=O,y=z[2])}const E=O=>new Tt(p[O][0],p[O][1]);let C;switch(v){case 0:case 6:C=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:C=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:C=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:C=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(Nn(u,C))return y}const Hoe=zr([{name:"a_pos_3f",components:3,type:"Float32"}]),qoe=zr([{name:"a_color_3f",components:3,type:"Float32"}]),Zoe=zr([{name:"a_color_4f",components:4,type:"Float32"}]),Xoe=zr([{name:"a_uv_2f",components:2,type:"Float32"}]),Koe=zr([{name:"a_normal_3f",components:3,type:"Float32"}]),Yoe=zr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Joe=zr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),b5={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class cE{constructor(o,l,f,p){this.message=(o?`${o}: `:"")+f,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function mO(u,o){const l=u.indexOf("://")===-1;try{return new URL(u,l&&o?"http://example.com":void 0),!0}catch{return!1}}class w5{constructor(o,l){this.feature=o,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class S5{constructor(){this.instancedDataArray=new ep,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class gO{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=o.styleDefinedModelURLs}updateFootprints(o,l){}populate(o,l,f,p){this.tileToMeter=tt(f);const y=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:E,index:C,sourceLayerIndex:O}of o){const z=E??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),F=En(v,y);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),F,f))continue;const $={id:z,sourceLayerIndex:O,index:C,geometry:y?F.geometry:gn(v,f,p),properties:v.properties,type:v.type,patterns:{}},Y=this.addFeature($,$.geometry,F);Y&&l.featureIndex.insert(v,$.geometry,C,O,this.index,this.instancesPerModel[Y].instancedDataArray.length,Kt/32)}this.lookup=null}update(o,l,f,p){for(const y in this.instancesPerModel){const v=this.instancesPerModel[y];for(const E in o)v.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(v.features[v.idToFeaturesIndex[E]],o[E],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];for(const p of f.features){const y=this.layers[0],v=p.feature,E=this.canonical,C=y.paint.get("model-rotation").evaluate(v,{},E),O=y.paint.get("model-scale").evaluate(v,{},E),z=y.paint.get("model-translation").evaluate(v,{},E);yt(p.rotation,C)&&yt(p.scale,O)&&yt(p.translation,z)||(this.evaluate(p,p.featureStates,f,!0),o=!0)}}return o}updateReplacement(o,l,f,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const y=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(BM(this.activeReplacements,y))return!1;this.activeReplacements=y;let v=!1;for(const E in this.instancesPerModel){const C=this.instancesPerModel[E],O=C.instancedDataArray;for(const z of C.features){const F=z.instancedDataOffset,$=z.instancedDataCount;for(let Y=0;Y<$;Y++){const J=16*(Y+F);let re=O.float32[J+0];const ce=re>Kt;re=ce?re-Kt:re;const de=Math.floor(re),we=O.float32[J+1];let ve=!1;for(const ie of this.activeReplacements)if(!Pj(ie,f,b5.Model,p)&&!(ie.min.x>de||de>ie.max.x||ie.min.y>we||we>ie.max.y)&&(ve=Rj(kj(de,we,o.canonical,ie.footprintTileId.canonical),ie.footprint),ve))break;O.float32[J]=ve?re+Kt:re,v=v||ve!==ce}}}return v}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=o.createVertexBuffer(f.instancedDataArray,Yoe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)o.removeModel(l,"",!0)}addFeature(o,l,f){const p=this.layers[0],y=p.layout.get("model-id").evaluate(f,{},this.canonical);if(!y)return mr(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),y;(mO(y,!1)||this.styleDefinedModelURLs[y]!==void 0)&&(this.modelUris.includes(y)||this.modelUris.push(y)),this.instancesPerModel[y]||(this.instancesPerModel[y]=new S5);const v=this.instancesPerModel[y],E=v.instancedDataArray,C=new w5(f,E.length);for(const O of l)for(const z of O){if(z.x<0||z.x>=Kt||z.y<0||z.y>=Kt)continue;const F=(this.lookupDim-1)/Kt,$=this.lookupDim*(z.y*F|0)+z.x*F|0;if(this.lookup){if(this.lookup[$]!==0)continue;this.lookup[$]=1}this.instanceCount++;const Y=E.length;E.resize(Y+1),v.instancesEvaluatedElevation.push(0),E.float32[16*Y]=z.x,E.float32[16*Y+1]=z.y}return C.instancedDataCount=v.instancedDataArray.length-C.instancedDataOffset,C.instancedDataCount>0&&(o.id&&(v.idToFeaturesIndex[o.id]=v.features.length),v.features.push(C),this.evaluate(C,{},v,!1)),y}getModelUris(){return this.modelUris}evaluate(o,l,f,p){const y=this.layers[0],v=o.feature,E=this.canonical,C=o.rotation=y.paint.get("model-rotation").evaluate(v,l,E),O=o.scale=y.paint.get("model-scale").evaluate(v,l,E),z=o.translation=y.paint.get("model-translation").evaluate(v,l,E),F=y.paint.get("model-color").evaluate(v,l,E);F.a=y.paint.get("model-color-mix-intensity").evaluate(v,l,E);const $=[];this.maxVerticalOffset<z[2]&&(this.maxVerticalOffset=z[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),v5($,C,O);const Y=Math.round(100*F.a)+F.b/1.05;for(let J=0;J<o.instancedDataCount;++J){const re=o.instancedDataOffset+J,ce=16*re,de=f.instancedDataArray.float32;let we=0;p&&(we=de[ce+6]-f.instancesEvaluatedElevation[re]);const ve=0|de[ce+1];de[ce]=(0|de[ce])+F.r/1.05,de[ce+1]=ve+F.g/1.05,de[ce+2]=Y,de[ce+3]=1/(E.z>10?this.tileToMeter:tt(E,ve)),de[ce+4]=z[0],de[ce+5]=z[1],de[ce+6]=z[2]+we,de[ce+7]=$[0],de[ce+8]=$[1],de[ce+9]=$[2],de[ce+10]=$[4],de[ce+11]=$[5],de[ce+12]=$[6],de[ce+13]=$[8],de[ce+14]=$[9],de[ce+15]=$[10],f.instancesEvaluatedElevation[re]=z[2]}}}let T5,E5;dn(gO,"ModelBucket",{omit:["layers"]}),dn(S5,"PerModelAttributes"),dn(w5,"ModelFeature");const xg=64,Iy={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function A5(u,o,l,f,p,y,v,E,C,O=!1){const z=l.zoom,F=l.project(f),$=wt(f.lat,z),Y=1/$;N(u),G(u,u,[F.x+v[0]*Y,F.y+v[1]*Y,v[2]]);let J=1,re=1;const ce=l.worldSize;if(O){if(l.projection.name==="mercator"){let ie=0;l.elevation&&(ie=l.elevation.getAtPointOrZero(new dt(F.x/ce,F.y/ce),0));const ge=Pt([],[F.x,F.y,ie,1],l.projMatrix)[3]/l.cameraToCenterDistance;J=ge,re=ge*wt(l.center.lat,z)}else if(l.projection.name==="globe"){const ie=pO(u,l),ge=[0,0,0,1];Pt(ge,ge,H([],l.projMatrix,ie));const be=ge[3]/l.cameraToCenterDistance,Ee=ap(z),Ue=l.projection.pixelsPerMeter(f.lat,ce)*wt(f.lat,z),qe=l.projection.pixelsPerMeter(l.center.lat,ce)*wt(l.center.lat,z);J=be/kn(Ue,Et(l.center.lat),Ee),re=be*$/Ue,J*=qe,re*=qe}}else J=Y;q(u,u,[J,J,re]);const de=[...u],we=o.orientation,ve=[];if(v5(ve,[we[0]+p[0],we[1]+p[1],we[2]+p[2]],y),H(u,de,ve),E&&l.elevation){let ie=0;const ge=[];if(C&&l.elevation){ie=function(Ee,Ue,qe,Ke,Qe){const xt=Ue.elevation;if(!xt)return 0;const Dt=Li.projectAabbCorners(qe,Ke),Ct=Ie(1,Qe.lat)*Ue.worldSize,kt=function($t,qn){const vn=[0,0,1],xn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Vn of xn){const nr=$t[Vn.corners[0]],rr=$t[Vn.corners[1]],gr=$t[Vn.corners[2]],ur=[rr[0]-nr[0],rr[1]-nr[1],qn*(rr[2]-nr[2])],lr=Vt(ur,ur,[gr[0]-nr[0],gr[1]-nr[1],qn*(gr[2]-nr[2])]);en(lr,lr),Vn.dotProductWithUp=sn(lr,vn)}return xn.sort((Vn,nr)=>Vn.dotProductWithUp-nr.dotProductWithUp),xn[0].corners}(Dt,Ct),Bt=Dt[kt[0]],_t=Dt[kt[1]],Ot=Dt[kt[2]],pt=Dt[kt[3]],vt=xt.getAtPointOrZero(new dt(Bt[0]/Ue.worldSize,Bt[1]/Ue.worldSize),0),Ut=xt.getAtPointOrZero(new dt(_t[0]/Ue.worldSize,_t[1]/Ue.worldSize),0),Wt=xt.getAtPointOrZero(new dt(Ot[0]/Ue.worldSize,Ot[1]/Ue.worldSize),0),Sn=xt.getAtPointOrZero(new dt(pt[0]/Ue.worldSize,pt[1]/Ue.worldSize),0),mn=(vt+Sn)/2,Jt=(Ut+Wt)/2;return mn>Jt?Ut<Wt?lE(Ee,_t,pt,Bt,Ut,Sn,vt,Ct):lE(Ee,Ot,Bt,pt,Wt,vt,Sn,Ct):vt<Sn?lE(Ee,Bt,_t,Ot,vt,Ut,Wt,Ct):lE(Ee,pt,Ot,_t,Sn,Wt,Ut,Ct),Math.max(mn,Jt)}(ge,l,o.aabb,u,f);const be=H([],De([],ge),ve);H(u,de,be)}else ie=l.elevation.getAtPointOrZero(new dt(F.x/ce,F.y/ce),0);ie!==0&&(u[14]+=ie)}}function _1(u,o,l=!1){u.uploaded||(u.gfxTexture=new hO(o,u.image,l?o.gl.R8:o.gl.RGBA8,{useMipmap:u.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function Qoe(u,o,l){u.indexBuffer=o.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=o.createVertexBuffer(u.vertexArray,Hoe.members,!1,!0),u.normalArray&&(u.normalBuffer=o.createVertexBuffer(u.normalArray,Koe.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=o.createVertexBuffer(u.texcoordArray,Xoe.members,!1,!0)),u.colorArray&&(u.colorBuffer=o.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?qoe:Zoe).members,!1,!0)),u.featureArray&&(u.pbrBuffer=o.createVertexBuffer(u.featureArray,Joe.members,!0)),u.segments=qi.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const f=u.material;f.pbrMetallicRoughness.baseColorTexture&&_1(f.pbrMetallicRoughness.baseColorTexture,o),f.pbrMetallicRoughness.metallicRoughnessTexture&&_1(f.pbrMetallicRoughness.metallicRoughnessTexture,o),f.normalTexture&&_1(f.normalTexture,o),f.occlusionTexture&&_1(f.occlusionTexture,o,l),f.emissionTexture&&_1(f.emissionTexture,o)}function _O(u,o,l){if(u.meshes)for(const f of u.meshes)Qoe(f,o,l);if(u.children)for(const f of u.children)_O(f,o,l)}function uE(u){if(u.meshes)for(const o of u.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(u.children)for(const o of u.children)uE(o)}function yO(u){if(u.meshes)for(const l of u.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((o=l.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(u.children)for(const l of u.children)yO(l)}class My{constructor(o,l,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=f}static create(o,l,f){const p=f||o.findDEMTileFor(l);if(!p||!p.dem)return;const y=p.dem,v=p.tileID,E=1<<l.canonical.z-v.canonical.z;return new My(p,y.dim/Kt/E,[(l.canonical.x/E-v.canonical.x)*y.dim,(l.canonical.y/E-v.canonical.y)*y.dim])}tileCoordToPixel(o,l){const f=l*this._scale+this._offset[1],p=Math.floor(o*this._scale+this._offset[0]),y=Math.floor(f);return new Tt(p,y)}getElevationAt(o,l,f,p){const y=o*this._scale+this._offset[0],v=l*this._scale+this._offset[1],E=Math.floor(y),C=Math.floor(v),O=this._dem;return p=!!p,f?kn(kn(O.get(E,C,p),O.get(E,C+1,p),v-C),kn(O.get(E+1,C,p),O.get(E+1,C+1,p),v-C),y-E):O.get(E,C,p)}getElevationAtPixel(o,l,f){return this._dem.get(o,l,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Ie(1,o)*this._dem.stride}}const vO=new Float32Array(262144),bg=new Uint8Array(262144);function P5(u){let o=0;if(u.meshes)for(const l of u.meshes)o=Math.max(o,l.aabb.max[2]);if(u.children)for(const l of u.children)o=Math.max(o,P5(l));return o}function C5(u,o,l){if(u.meshes)for(const f of u.meshes){if(f.aabb.min[0]===1/0)continue;const p=Li.applyTransform(f.aabb,u.matrix);l.insert(o,p.min[0],p.min[1],p.max[0],p.max[1])}if(u.children)for(const f of u.children)C5(f,o,l)}const I5=["","wall","door","roof","window","lamp","logo"];class M5{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:P5(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const l=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==o&&(f.transformedAabb=Li.applyTransformFast(f.aabb,this.node.matrix),l.encapsulate(f.transformedAabb)),o++;this.aabb=l}return this.aabb}}class hE{constructor(o,l,f,p,y,v,E){this.id=f,this.layers=o,this.layerIds=this.layers.map(C=>C.fqid),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.modelTraits|=Iy.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=Iy.HasMapboxMeshFeatures),y&&(this.modelTraits|=Iy.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const C of l)this.nodesInfo.push(new M5(C)),C5(C,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,l){for(const f of this.getNodesInfo()){const p=f.node;p.footprint&&l.push({footprint:p.footprint,id:o})}}update(o){const l=Object.keys(o).length!==0;if(l&&!this.stateDependentLayers.length)return;const f=l?this.stateDependentLayers:this.layers;if(!pi(o,this.states))for(const p of f)this.evaluate(p,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const f of l){const p=f.node;this.uploaded?this.updatePbrBuffer(p):_O(p,o,!0)}for(const f of l)uE(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let l=!1;if(!o.meshes)return l;for(const f of o.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),l=!0);return l}needsReEvaluation(o,l,f){const p=o.transform.projectionOptions,y=o.style.getBrightness(),v=this.brightness!==y;if(!this.uploaded||this.dirty||p.name!==this.projection.name||y1(f.paint.get("model-color").value,v)||y1(f.paint.get("model-color-mix-intensity").value,v)||y1(f.paint.get("model-roughness").value,v)||y1(f.paint.get("model-emissive-strength").value,v)||y1(f.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=p,this.brightness=y;const E=this.getNodesInfo();for(const C of E)C.state=null;return!0}return!1}evaluateScale(o,l){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const f=this.getNodesInfo(),p=this.id.canonical;for(const y of f){const v=y.feature;y.evaluatedScale=l.paint.get("model-scale").evaluate(v,{},p)}}evaluate(o,l){const f=this.getNodesInfo();for(const p of f){if(!p.node.meshes)continue;const y=p.feature,v=l&&l[y.id];if(pi(v,p.state))continue;p.state=structuredClone(v);const E=p.node.meshes&&p.node.meshes[0].featureData,C=p.evaluatedColor[2],O=p.evaluatedRMEA[2],z=this.id.canonical;if(p.hasTranslucentParts=!1,E){for(let F=0;F<I5.length;F++){const $=I5[F];$.length&&(y.properties.part=$);const Y=o.paint.get("model-color").evaluate(y,v,z).toRenderColor(null),J=o.paint.get("model-color-mix-intensity").evaluate(y,v,z);p.evaluatedColor[F]=[Y.r,Y.g,Y.b,J],p.evaluatedRMEA[F][0]=o.paint.get("model-roughness").evaluate(y,v,z),p.evaluatedRMEA[F][2]=o.paint.get("model-emissive-strength").evaluate(y,v,z),p.evaluatedRMEA[F][3]=Y.a,p.emissionHeightBasedParams[F]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(y,v,z),!p.hasTranslucentParts&&Y.a<1&&(p.hasTranslucentParts=!0)}delete y.properties.part,tae(p,C!==p.evaluatedColor[2]||O!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(y,v,z);p.evaluatedScale=o.paint.get("model-scale").evaluate(y,v,z),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,l,f,p){const y=o.findDEMTileFor(f);if(y&&(y.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(y.dem&&y.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=y.tileID.overscaledZ;const v=My.create(o,f,y);if(!v)return;this.modelTraits&Iy.HasMapboxMeshFeatures&&this.updateDEM(o,v,f,p);for(const E of this.getNodesInfo()){const C=E.node;if(!C.footprint||!C.footprint.vertices||!C.footprint.vertices.length)continue;const O=C.footprint.vertices;let z=v.getElevationAt(O[0].x,O[0].y,!0,!0);for(let F=1;F<O.length;F++)z=Math.min(z,v.getElevationAt(O[F].x,O[F].y,!0,!0));C.elevation=z}}this.terrainTile=y.tileID.canonical,this.terrainExaggeration=l}}updateDEM(o,l,f,p){let y=l._dem._modifiedForSources[p];if(y===void 0&&(l._dem._modifiedForSources[p]=[],y=l._dem._modifiedForSources[p]),y.includes(f.canonical))return;const v=l._dem.dim;y.push(f.canonical);let E=!1;for(const C of this.getNodesInfo()){const O=C.node;if(!O.footprint||!O.footprint.grid)continue;const z=O.footprint.grid,F=l.tileCoordToPixel(z.min.x,z.min.y),$=l.tileCoordToPixel(z.max.x,z.max.y),Y=Math.min(Math.min(v-$.y,F.x),Math.min(F.y,v-$.x));if(Y<0)continue;const J=$e(Y,2,5);let re=Math.max(0,F.x-J),ce=Math.max(0,F.y-J),de=Math.min($.x+J,v-1),we=Math.min($.y+J,v-1);for(let be=ce;be<=we;++be)for(let Ee=re;Ee<=de;++Ee)bg[be*v+Ee]=255;let ve=0,ie=0;for(let be=0;be<z.cellsY;++be)for(let Ee=0;Ee<z.cellsX;++Ee){if(!z.cells[be*z.cellsX+Ee])continue;const Ue=l.tileCoordToPixel(z.min.x+Ee/z.xScale,z.min.y+be/z.yScale),qe=l.tileCoordToPixel(z.min.x+(Ee+1)/z.xScale,z.min.y+(be+1)/z.yScale);for(let Ke=Ue.y;Ke<=Math.min(qe.y+1,v-1);++Ke)for(let Qe=Ue.x;Qe<=Math.min(qe.x+1,v-1);++Qe)bg[Ke*v+Qe]===255&&(bg[Ke*v+Qe]=0,ve+=l.getElevationAtPixel(Qe,Ke),ie++)}const ge=ve/ie;re=Math.max(1,F.x-J),ce=Math.max(1,F.y-J),de=Math.min($.x+J,v-2),we=Math.min($.y+J,v-2),E=!0;for(let be=ce;be<=we;++be)for(let Ee=re;Ee<=de;++Ee)bg[be*v+Ee]===0&&(vO[be*v+Ee]=l._dem.set(Ee,be,ge));for(let be=1;be<J;++be){re=Math.max(1,F.x-be),ce=Math.max(1,F.y-be),de=Math.min($.x+be,v-2),we=Math.min($.y+be,v-2);for(let Ee=ce;Ee<=we;++Ee)for(let Ue=re;Ue<=de;++Ue){const qe=Ee*v+Ue;if(bg[qe]===255){let Ke=0,Qe=0,xt=-1,Dt=-1;for(let Ct=-1;Ct<=1;++Ct)for(let kt=-1;kt<=1;++kt){const Bt=(Ee+Ct)*v+Ue+kt;if(bg[Bt]>=be)continue;const _t=vO[Bt],Ot=Math.abs(_t);Ot>Qe&&(Ke=_t,Qe=Ot,xt=kt,Dt=Ct)}if(Qe>.1){const Ct=1-(be+.5*Math.abs(xt*Dt))/J;let kt=l._dem.get(Ue,Ee)+Ke*Ct;const Bt=l._dem.get(Ue+xt,Ee+Dt),_t=l._dem.get(Ue-xt,Ee-Dt,!0);(kt-Bt)*(kt-_t)>0&&(kt=(Bt+_t)/2),vO[qe]=l._dem.set(Ue,Ee,kt),bg[qe]=be}}}}}E&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=Mo.now())}setFilter(o){this.filter=o?Mx(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new ii(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const l of o)uE(l.node),yO(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const f=l.getReplacementRegionsForTile(o.toUnwrapped()),p=this.getNodesInfo();for(let y=0;y<this.nodesInfo.length;y++){const v=p[y].node;p[y].hiddenByReplacement=!!v.footprint&&!f.find(E=>E.footprint===v.footprint)}}getHeightAtTileCoord(o,l){const f=this.getNodesInfo(),p=[],y=[0,0,0],v=N([]);for(let E=0;E<this.nodesInfo.length;E++){const C=f[E],O=C.node.meshes[0],z=O.transformedAabb;if(o<z.min[0]||l<z.min[1]||o>z.max[0]||l>z.max[1])continue;if(C.node.hidden===!0)return{height:1/0,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};V(v,C.node.matrix),y[0]=o,y[1]=l,Gt(y,y,v);const F=(y[0]-O.aabb.min[0])/(O.aabb.max[0]-O.aabb.min[0])*xg|0,$=Math.min(63,(y[1]-O.aabb.min[1])/(O.aabb.max[1]-O.aabb.min[1])*xg|0)*xg+Math.min(63,F),Y=O.heightmap[$];if(!(Y<0&&C.node.footprint))return C.hiddenByReplacement?void 0:{height:Y,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};if(C.node.footprint.grid.query(new Tt(o,l),new Tt(o,l),p),p.length>0)return{height:void 0,maxHeight:C.feature.properties.height,hidden:C.hiddenByReplacement,verticalScale:C.evaluatedScale[2]}}}}function y1(u,o){return u instanceof Pd&&!u.isLightConstant&&o}function eae(u,o,l,f,p,y,v,E){let C=(61440&o|(61440&o)>>4)>>8,O=(3840&o|(3840&o)>>4)>>4,z=240&o|(240&o)>>4;l[3]>0&&(C=kn(C,255*l[0],l[3]),O=kn(O,255*l[1],l[3]),z=kn(z,255*l[2],l[3]));const F=C<<8|O,$=z<<8|Math.floor(255*f[3]),Y=function(be){const Ee=$e(be,0,2);return Math.min(Math.round(.5*Ee*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],J=$e(p[0],0,1),re=$e(p[1],0,1),ce=$e(p[2],0,1),de=$e(p[3],0,1);let we,ve,ie,ge;if(J!==re&&v!==y&&re!==J){const be=v-y;ve=1/(be*(re-J)),ie=-(y+be*J)/(be*(re-J));const Ee=$e(p[4],-1,1);ge=Math.pow(10,Ee),we=255*ce<<8|255*de}else we=65535,ve=0,ie=1,ge=1;if(u.emplaceBack(F,$,Y,we,ve,ie,ge),E){const be=E.length;E.clear();for(let Ee=0;Ee<be;Ee++)E.emplaceBack(F,$,Y,we,ve,ie,ge)}}function tae(u,o,l){const f=u.node;let p=0;const y=l&Iy.HasMeshoptCompression;for(const v of f.meshes){if(f.lights&&f.lightMeshIndex===p||!v.featureData)continue;v.featureArray=new sg,v.featureArray.reserve(v.featureData.length);let E=o;for(const C of v.featureData){const O=y?65535&C:C>>16&65535,z=y?C>>16&65535:65535&C,F=(15&z)<8?15&z:0,$=u.evaluatedRMEA[F],Y=u.evaluatedColor[F],J=u.emissionHeightBasedParams[F];let re;if(E&&F===2&&f.lights&&(re=new sg,re.resize(10*f.lights.length)),eae(v.featureArray,O,Y,$,J,v.aabb.min[2],v.aabb.max[2],re),re&&E){E=!1;const ce=f.meshes[f.lightMeshIndex];ce.featureArray=re,ce.featureArray._trim()}}v.featureArray._trim(),p++}}function O5(u,o,l,f){const p=1<<u.z;o.lat=Ge((f/Kt+u.y)/p),o.lng=Ve((l/Kt+u.x)/p)}dn(hE,"Tiled3dModelBucket",{omit:["layers"]}),dn(M5,"Tiled3dModelFeature");const nae={circle:class extends gs{constructor(u,o,l,f){super(u,{layout:jr||(jr=new io({"circle-sort-key":new cn(st.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Zt(st.layout_circle["circle-elevation-reference"]),visibility:new Zt(st.layout_circle.visibility)})),paint:$i||($i=new io({"circle-radius":new cn(st.paint_circle["circle-radius"]),"circle-color":new cn(st.paint_circle["circle-color"]),"circle-blur":new cn(st.paint_circle["circle-blur"]),"circle-opacity":new cn(st.paint_circle["circle-opacity"]),"circle-translate":new Zt(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cn(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cn(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cn(st.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Zt(st.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f)}createBucket(u){return new yn(u)}queryRadius(u){const o=u;return sr("circle-radius",this,o)+sr("circle-stroke-width",this,o)+Ri(this.paint.get("circle-translate"))}queryIntersectsFeature(u,o,l,f,p,y,v,E){const C=Di(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return WB(u,f,y,v,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,o,l){const f=VB(this);return{config:new Nh(this,{zoom:o,lut:l}),defines:f,overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends gs{createBucket(u){return new HB(u)}constructor(u,o,l,f){super(u,{layout:qB||(qB=new io({visibility:new Zt(st.layout_heatmap.visibility)})),paint:ZB||(ZB=new io({"heatmap-radius":new cn(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cn(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Od(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(st.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return sr("heatmap-radius",this,u)}queryIntersectsFeature(u,o,l,f,p,y,v,E){const C=this.paint.get("heatmap-radius").evaluate(o,l);return WB(u,f,y,v,E,!0,!0,new Tt(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,o,l){return u==="heatmap"?{config:new Nh(this,{zoom:o,lut:l}),overrideFog:!1}:{}}},hillshade:class extends gs{constructor(u,o,l,f){super(u,{layout:XB||(XB=new io({visibility:new Zt(st.layout_hillshade.visibility)})),paint:KB||(KB=new io({"hillshade-illumination-direction":new Zt(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(st.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Zt(st.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,o,l){return{overrideFog:!1}}},fill:class extends gs{constructor(u,o,l,f){super(u,{layout:wj||(wj=new io({"fill-sort-key":new cn(st.layout_fill["fill-sort-key"]),visibility:new Zt(st.layout_fill.visibility),"fill-elevation-reference":new Zt(st.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new cn(st.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Sj||(Sj=new io({"fill-antialias":new Zt(st.paint_fill["fill-antialias"]),"fill-opacity":new cn(st.paint_fill["fill-opacity"]),"fill-color":new cn(st.paint_fill["fill-color"]),"fill-outline-color":new cn(st.paint_fill["fill-outline-color"]),"fill-translate":new Zt(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(st.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Zt(st.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Zt(st.paint_fill["fill-emissive-strength"]),"fill-z-offset":new cn(st.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new cn(st.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new cn(st.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f)}getProgramIds(){const u=this.paint.get("fill-pattern"),o=u&&u.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(u,o,l){return{config:new Nh(this,{zoom:o,lut:l}),overrideFog:!1}}recalculate(u,o){super.recalculate(u,o);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new zM(u)}queryRadius(){return Ri(this.paint.get("fill-translate"))}queryIntersectsFeature(u,o,l,f,p,y){return!u.queryGeometry.isAboveHorizon&&yr(Rr(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?o&&!u:o}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends gs{constructor(u,o,l,f){super(u,{layout:Zj||(Zj=new io({visibility:new Zt(st["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Zt(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:Xj||(Xj=new io({"fill-extrusion-opacity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cn(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Zt(st["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new cn(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cn(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Zt(st["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Zt(st["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Zt(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Zt(st["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Zt(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Zt(st["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new cn(st["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new cn(st["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Zt(st["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new $T(u)}queryRadius(){return Ri(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,o,l,f,p,y,v,E,C){const O=Di(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),z=this.paint.get("fill-extrusion-height").evaluate(o,l),F=this.paint.get("fill-extrusion-base").evaluate(o,l),$=[0,0],Y=E&&y.elevation,J=y.elevation?y.elevation.exaggeration():1,re=u.tile.getBucket(this);if(Y&&re instanceof $T){const ie=re.centroidVertexArray,ge=C+1;ge<ie.length&&($[0]=ie.geta_centroid_pos0(ge),$[1]=ie.geta_centroid_pos1(ge))}if($[0]===0&&$[1]===1)return!1;y.projection.name==="globe"&&(f=qj([f],[new Tt(0,0),new Tt(Kt,Kt)],u.tileID.canonical).map(ie=>ie.polygon).flat());const ce=Y?E:null,[de,we]=function(ie,ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt,Ct){return ie.projection.name==="globe"?function(kt,Bt,_t,Ot,pt,vt,Ut,Wt,Sn,mn,Jt){const $t=[],qn=[],vn=kt.projection.upVectorScale(Jt,kt.center.lat,kt.worldSize).metersToTile,xn=[0,0,0,1],Vn=[0,0,0,1],nr=(gr,ur,lr,di)=>{gr[0]=ur,gr[1]=lr,gr[2]=di,gr[3]=1},rr=Hj();_t>0&&(_t+=rr),Ot+=rr;for(const gr of Bt){const ur=[],lr=[];for(const di of gr){const Pi=di.x+pt.x,Se=di.y+pt.y,Ae=kt.projection.projectTilePoint(Pi,Se,Jt),bt=kt.projection.upVector(Jt,di.x,di.y);let Xt=_t,tn=Ot;if(Ut){const Qt=t4(Pi,Se,_t,Ot,Ut,Wt,Sn,mn);Xt+=Qt.base,tn+=Qt.top}_t!==0?nr(xn,Ae.x+bt[0]*vn*Xt,Ae.y+bt[1]*vn*Xt,Ae.z+bt[2]*vn*Xt):nr(xn,Ae.x,Ae.y,Ae.z),nr(Vn,Ae.x+bt[0]*vn*tn,Ae.y+bt[1]*vn*tn,Ae.z+bt[2]*vn*tn),Gt(xn,xn,vt),Gt(Vn,Vn,vt),ur.push(new yg(xn[0],xn[1],xn[2])),lr.push(new yg(Vn[0],Vn[1],Vn[2]))}$t.push(ur),qn.push(lr)}return[$t,qn]}(ie,ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt,Ct):Ke?function(kt,Bt,_t,Ot,pt,vt,Ut,Wt,Sn){const mn=[],Jt=[],$t=[0,0,0,1];for(const qn of kt){const vn=[],xn=[];for(const Vn of qn){const nr=Vn.x+Ot.x,rr=Vn.y+Ot.y,gr=t4(nr,rr,Bt,_t,vt,Ut,Wt,Sn);$t[0]=nr,$t[1]=rr,$t[2]=gr.base,$t[3]=1,Pt($t,$t,pt),$t[3]=Math.max($t[3],1e-5);const ur=new yg($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);$t[0]=nr,$t[1]=rr,$t[2]=gr.top,$t[3]=1,Pt($t,$t,pt),$t[3]=Math.max($t[3],1e-5);const lr=new yg($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);vn.push(ur),xn.push(lr)}mn.push(vn),Jt.push(xn)}return[mn,Jt]}(ge,be,Ee,Ue,qe,Ke,Qe,xt,Dt):function(kt,Bt,_t,Ot,pt){const vt=[],Ut=[],Wt=pt[8]*Bt,Sn=pt[9]*Bt,mn=pt[10]*Bt,Jt=pt[11]*Bt,$t=pt[8]*_t,qn=pt[9]*_t,vn=pt[10]*_t,xn=pt[11]*_t;for(const Vn of kt){const nr=[],rr=[];for(const gr of Vn){const ur=gr.x+Ot.x,lr=gr.y+Ot.y,di=pt[0]*ur+pt[4]*lr+pt[12],Pi=pt[1]*ur+pt[5]*lr+pt[13],Se=pt[2]*ur+pt[6]*lr+pt[14],Ae=pt[3]*ur+pt[7]*lr+pt[15],bt=di+Wt,Xt=Pi+Sn,tn=Se+mn,Qt=Math.max(Ae+Jt,1e-5),wn=di+$t,jn=Pi+qn,Sr=Se+vn,Tr=Math.max(Ae+xn,1e-5);nr.push(new yg(bt/Qt,Xt/Qt,tn/Qt)),rr.push(new yg(wn/Tr,jn/Tr,Sr/Tr))}vt.push(nr),Ut.push(rr)}return[vt,Ut]}(ge,be,Ee,Ue,qe)}(y,f,F,z,O,v,ce,$,J,y.center.lat,u.tileID.canonical),ve=u.queryGeometry;return function(ie,ge,be){let Ee=1/0;yr(be,ge)&&(Ee=e4(be,ge[0]));for(let Ue=0;Ue<ge.length;Ue++){const qe=ge[Ue],Ke=ie[Ue];for(let Qe=0;Qe<qe.length-1;Qe++){const xt=qe[Qe],Dt=[xt,qe[Qe+1],Ke[Qe+1],Ke[Qe],xt];Nn(be,Dt)&&(Ee=Math.min(Ee,e4(be,Dt)))}}return Ee!==1/0&&Ee}(de,we,ve.isPointQuery()?ve.screenBounds:ve.screenGeometry)}},line:class extends gs{constructor(u,o,l,f){const p=h4();super(u,p,o,l,f),p.layout&&(this.layout=new Md(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof wd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,o){super.recalculate(u,o),this.paint._values["line-floorwidth"]=(()=>{if(o1)return o1;const l=h4();return o1=new roe(l.paint.properties["line-width"].specification),o1.useIntegerZoom=!0,o1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new VM(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,o,l){const f=c4(this);return{config:new Nh(this,{zoom:o,lut:l}),defines:f,overrideFog:!1}}queryRadius(u){const o=u,l=d4(sr("line-width",this,o),sr("line-gap-width",this,o)),f=sr("line-offset",this,o);return l/2+Math.abs(f)+Ri(this.paint.get("line-translate"))}queryIntersectsFeature(u,o,l,f,p,y){if(u.queryGeometry.isAboveHorizon)return!1;const v=Rr(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),E=u.pixelToTileUnitsFactor/2*d4(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),C=this.paint.get("line-offset").evaluate(o,l);return C&&(f=function(O,z){const F=[],$=new Tt(0,0);for(let Y=0;Y<O.length;Y++){const J=O[Y],re=[];for(let ce=0;ce<J.length;ce++){const de=J[ce],we=J[ce+1],ve=ce===0?$:de.sub(J[ce-1])._unit()._perp(),ie=ce===J.length-1?$:we.sub(de)._unit()._perp(),ge=ve._add(ie)._unit();ge._mult(1/(ge.x*ie.x+ge.y*ie.y)),re.push(ge._mult(z)._add(de))}F.push(re)}return F}(f,C*u.pixelToTileUnitsFactor)),function(O,z,F){for(let $=0;$<z.length;$++){const Y=z[$];if(O.length>=3){for(let J=0;J<Y.length;J++)if(ai(O,Y[J]))return!0}if(oi(O,Y,F))return!0}return!1}(v,f,E)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:rE,background:class extends gs{constructor(u,o,l,f){super(u,{layout:r5||(r5=new io({visibility:new Zt(st.layout_background.visibility)})),paint:i5||(i5=new io({"background-pitch-alignment":new Zt(st.paint_background["background-pitch-alignment"]),"background-color":new Zt(st.paint_background["background-color"]),"background-pattern":new Zt(st.paint_background["background-pattern"]),"background-opacity":new Zt(st.paint_background["background-opacity"]),"background-emissive-strength":new Zt(st.paint_background["background-emissive-strength"]),"background-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,o,l){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:c5,"raster-particle":m5,sky:class extends gs{constructor(u,o,l,f){super(u,{layout:d5||(d5=new io({visibility:new Zt(st.layout_sky.visibility)})),paint:f5||(f5=new io({"sky-type":new Zt(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new Zt(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Zt(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Zt(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Zt(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new Od(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Zt(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Zt(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Zt(st.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Xx({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(u,o){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),p=!f,y=u.style.light,v=y.properties.get("position");return p&&y.properties.get("anchor")==="viewport"&&mr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?dO(v.azimuthal,90-v.polar,o):dO(f[0],90-f[1],o)}const l=this.paint.get("sky-gradient-center");return dO(l[0],90-l[1],o)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends gs{constructor(u,o,l,f){super(u,{paint:p5||(p5=new io({}))},o,null)}},model:class extends gs{constructor(u,o,l,f){super(u,{layout:T5||(T5=new io({visibility:new Zt(st.layout_model.visibility),"model-id":new cn(st.layout_model["model-id"])})),paint:E5||(E5=new io({"model-opacity":new cn(st.paint_model["model-opacity"]),"model-rotation":new cn(st.paint_model["model-rotation"]),"model-scale":new cn(st.paint_model["model-scale"]),"model-translation":new cn(st.paint_model["model-translation"]),"model-color":new cn(st.paint_model["model-color"]),"model-color-mix-intensity":new cn(st.paint_model["model-color-mix-intensity"]),"model-type":new Zt(st.paint_model["model-type"]),"model-cast-shadows":new Zt(st.paint_model["model-cast-shadows"]),"model-receive-shadows":new Zt(st.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Zt(st.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new cn(st.paint_model["model-emissive-strength"]),"model-roughness":new cn(st.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new cn(st.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Zt(st.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Zt(st.paint_model["model-front-cutoff"]),"model-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,l,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new gO(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof hE?Kt-1:0}queryIntersectsFeature(u,o,l,f,p,y){if(!this.modelManager)return!1;const v=this.modelManager,E=u.tile.getBucket(this);if(!(E&&E instanceof gO))return!1;for(const C in E.instancesPerModel){const O=E.instancesPerModel[C],z=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(O.idToFeaturesIndex.hasOwnProperty(z)){const F=O.features[O.idToFeaturesIndex[z]],$=v.getModel(C,this.scope);if(!$)return!1;let Y=B();const J=new le(0,0),re=E.canonical;let ce=Number.MAX_VALUE;for(let de=0;de<F.instancedDataCount;++de){const we=16*(F.instancedDataOffset+de),ve=O.instancedDataArray.float32,ie=[ve[we+4],ve[we+5],ve[we+6]];O5(re,J,ve[we],0|ve[we+1]),A5(Y,$,y,J,F.rotation,F.scale,ie,!1,!1,!1),y.projection.name==="globe"&&(Y=pO(Y,y));const ge=H([],y.projMatrix,Y),be=u.queryGeometry,Ee=x5(be.isPointQuery()?be.screenBounds:be.screenGeometry,y,ge,$.aabb);Ee!=null&&(ce=Math.min(Ee,ce))}return ce!==Number.MAX_VALUE&&ce}}return!1}_handleOverridablePaintPropertyUpdate(u,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const o=this._transitionablePaint._values[u];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof Hf}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends gs{constructor(u,o,l,f){super(u,{layout:Tj||(Tj=new io({"clip-layer-types":new Zt(st.layout_clip["clip-layer-types"]),"clip-layer-scope":new Zt(st.layout_clip["clip-layer-scope"])})),paint:Ej||(Ej=new io({}))},o,l,f)}recalculate(u,o){super.recalculate(u,o)}createBucket(u){return new Aj(u)}is3D(u){return!0}}};class rae{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class iae{constructor(){this.tasks={},this.taskQueue=[],Zn(["process"],this),this.invoker=new rae(this.process),this.nextId=0}add(o,l){const f=this.nextId++,p=function({type:y,isSymbolTile:v,zoom:E}){return E=E||0,y==="message"?0:y!=="maybePrepare"||v?y!=="parseTile"||v?y==="parseTile"&&v?300-E:y==="maybePrepare"&&v?400-E:500:200-E:100-E}(l);if(p===0){try{o()}finally{}return null}return this.tasks[f]={fn:o,metadata:l,priority:p,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const y=this.tasks[this.taskQueue[p]];y.priority<l&&(l=y.priority,o=p)}if(o===null)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class k5{constructor(o,l,f){this.target=o,this.parent=l,this.mapId=f,this.callbacks={},this.cancelCallbacks={},Zn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new iae}send(o,l,f,p,y=!1,v){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=v,this.callbacks[E]=f);const C=new Set;return this.target.postMessage({id:E,type:o,hasCallback:!!f,targetMapId:p,mustQueue:y,sourceMapId:this.mapId,data:Mh(l,C)},C),{cancel:()=>{f&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(o){const l=o.data;if(!l)return;const f=l.id;if(f&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const p=this.cancelCallbacks[f];delete this.cancelCallbacks[f],p&&p.cancel()}else if(l.mustQueue||mi(self)){const p=this.callbacks[f],y=this.scheduler.add(()=>this.processTask(f,l),p&&p.metadata||{type:"message"});y&&(this.cancelCallbacks[f]=y)}else this.processTask(f,l)}processTask(o,l){if(delete this.cancelCallbacks[o],l.type==="<response>"){const f=this.callbacks[o];delete this.callbacks[o],f&&(l.error?f(Oh(l.error)):f(null,Oh(l.data)))}else{const f=new Set,p=l.hasCallback?(v,E)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:v?Mh(v):null,data:Mh(E,f)},f)}:()=>{},y=Oh(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,y,p);else if(this.parent.getWorkerSource){const v=l.type.split("."),{source:E,scope:C}=y;this.parent.getWorkerSource(l.sourceMapId,v[0],E,C)[v[1]](y,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var v1={workerUrl:"",workerClass:null,workerParams:void 0};const xO="mapboxgl_preloaded_worker_pool";class wg{constructor(){this.active={}}acquire(o,l=wg.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(v1.workerClass!=null?new v1.workerClass:new self.Worker(v1.workerUrl,v1.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xO]}numActive(){return Object.keys(this.active).length}}wg.workerCount=2;class Oy{constructor(o,l,f="Worker",p=wg.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=an();const y=this.workerPool.acquire(this.id,p);for(let v=0;v<y.length;v++){const E=new Oy.Actor(y[v],l,this.id);E.name=`${f} ${v}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,l,f){St(this.actors,(p,y)=>{p.send(o,l,y)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let x1,bO;function dE(){return x1||(x1=new wg),x1}Oy.Actor=k5;const wO=new Dr(0,0,0),SO={PATH_RULE_UNSPECIFIED:0,PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},TO={LINE_CAP_UNSPECIFIED:0,LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},fE={LINE_JOIN_UNSPECIFIED:0,LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},oae={PAINT_ORDER_UNSPECIFIED:0,PAINT_ORDER_FILL_AND_STROKE:1,PAINT_ORDER_STROKE_AND_FILL:2},b1={PATH_COMMAND_UNSPECIFIED:0,PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},R5={MASK_TYPE_UNSPECIFIED:0,MASK_TYPE_LUMINANCE:1,MASK_TYPE_ALPHA:2};function aae(u,o,l){u===1&&o.icons.push(function(f,p){return function(y){if(y.usvg_tree.height||(y.usvg_tree.height=y.usvg_tree.width),!y.metadata)return y;const{metadata:v}=y;if(v.content_area){const{content_area:E}=v;E.top==null&&(E.top=E.left),E.width==null&&(E.width=y.usvg_tree.width),E.height==null&&(E.height=E.width)}return v.stretch_x&&v.stretch_x.length&&D5(v,"x"),v.stretch_y&&v.stretch_y.length&&D5(v,"y"),y}(f.readFields(sae,{name:void 0},p))}(l,l.readVarint()+l.pos))}function D5(u,o){const l=[],f=u[`stretch_${o}`];let p=null;for(let y=0;y<f.length;y++)p===null?p=l.length===0?f[0]:l[l.length-1][1]+f[y]:(l.push([p,p+f[y]]),p=null);u[`stretch_${o}_areas`]=l}function sae(u,o,l){u===1?o.name=l.readString():u===2?o.metadata=function(f,p){return f.readFields(lae,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):u===3&&(o.usvg_tree=function(f,p){return f.readFields(hae,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),o.data="usvg_tree")}function lae(u,o,l){u===1?o.stretch_x=l.readPackedVarint():u===2?o.stretch_y=l.readPackedVarint():u===3?o.content_area=function(f,p){return f.readFields(cae,{left:0},p)}(l,l.readVarint()+l.pos):u===4&&o.variables.push(function(f,p){return f.readFields(uae,{name:void 0},p)}(l,l.readVarint()+l.pos))}function cae(u,o,l){u===1?o.left=l.readVarint():u===2?o.width=l.readVarint():u===3?o.top=l.readVarint():u===4&&(o.height=l.readVarint())}function uae(u,o,l){u===1?o.name=l.readString():u===2&&(o.rgb_color=gE(l.readVarint()),o.value="rgb_color")}function hae(u,o,l){u===1?o.width=o.height=l.readVarint():u===2?o.height=l.readVarint():u===3?o.children.push(pE(l,l.readVarint()+l.pos)):u===4?o.linear_gradients.push(function(f,p){return f.readFields(yae,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):u===5?o.radial_gradients.push(function(f,p){return f.readFields(xae,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):u===7?o.clip_paths.push(function(f,p){return f.readFields(bae,{children:[]},p)}(l,l.readVarint()+l.pos)):u===8&&o.masks.push(function(f,p){const y=f.readFields(wae,{left:0,width:20,mask_type:R5.MASK_TYPE_LUMINANCE,children:[]},p);return y.height==null&&(y.height=y.width),y.top==null&&(y.top=y.left),y}(l,l.readVarint()+l.pos))}function pE(u,o){return u.readFields(dae,{},o)}function dae(u,o,l){u===1?(o.group=function(f,p){return f.readFields(fae,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),o.node="group"):u===2&&(o.path=function(f,p){return f.readFields(mae,{paint_order:1,commands:[],step:1,diffs:[],rule:SO.PATH_RULE_NON_ZERO},p)}(l,l.readVarint()+l.pos),o.node="path")}function fae(u,o,l){u===1?o.transform=mE(l,l.readVarint()+l.pos):u===2?o.opacity=l.readVarint():u===5?o.clip_path_idx=l.readVarint():u===6?o.mask_idx=l.readVarint():u===7&&o.children.push(pE(l,l.readVarint()+l.pos))}function mE(u,o){return u.readFields(pae,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function pae(u,o,l){u===1?o.sx=l.readFloat():u===2?o.ky=l.readFloat():u===3?o.kx=l.readFloat():u===4?o.sy=l.readFloat():u===5?o.tx=l.readFloat():u===6&&(o.ty=l.readFloat())}function mae(u,o,l){u===1?o.fill=function(f,p){return f.readFields(gae,{rgb_color:wO,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):u===2?o.stroke=function(f,p){return f.readFields(_ae,{rgb_color:wO,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):u===3?o.paint_order=l.readVarint():u===5?l.readPackedVarint(o.commands):u===6?o.step=l.readFloat():u===7?l.readPackedSVarint(o.diffs):u===8&&(o.rule=l.readVarint())}function gae(u,o,l){u===1?(o.rgb_color=gE(l.readVarint()),o.paint="rgb_color"):u===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):u===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):u===5&&(o.opacity=l.readVarint())}function gE(u){return new Dr((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function _ae(u,o,l){u===1?(o.rgb_color=gE(l.readVarint()),o.paint="rgb_color"):u===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):u===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):u===5?l.readPackedFloat(o.dasharray):u===6?o.dashoffset=l.readFloat():u===7?o.miterlimit=l.readFloat():u===8?o.opacity=l.readVarint():u===9?o.width=l.readFloat():u===10?o.linecap=l.readVarint():u===11&&(o.linejoin=l.readVarint())}function yae(u,o,l){u===1?o.transform=mE(l,l.readVarint()+l.pos):u===2?o.spread_method=l.readVarint():u===3?o.stops.push(L5(l,l.readVarint()+l.pos)):u===4?o.x1=l.readFloat():u===5?o.y1=l.readFloat():u===6?o.x2=l.readFloat():u===7&&(o.y2=l.readFloat())}function L5(u,o){return u.readFields(vae,{offset:0,opacity:255,rgb_color:wO},o)}function vae(u,o,l){u===1?o.offset=l.readFloat():u===2?o.opacity=l.readVarint():u===3&&(o.rgb_color=gE(l.readVarint()))}function xae(u,o,l){u===1?o.transform=mE(l,l.readVarint()+l.pos):u===2?o.spread_method=l.readVarint():u===3?o.stops.push(L5(l,l.readVarint()+l.pos)):u===4?o.cx=l.readFloat():u===5?o.cy=l.readFloat():u===6?o.r=l.readFloat():u===7?o.fx=l.readFloat():u===8?o.fy=l.readFloat():u===9&&(o.fr=l.readFloat())}function bae(u,o,l){u===1?o.transform=mE(l,l.readVarint()+l.pos):u===2?o.clip_path_idx=l.readVarint():u===3&&o.children.push(pE(l,l.readVarint()+l.pos))}function wae(u,o,l){u===1?o.left=o.top=l.readFloat():u===2?o.width=o.height=l.readFloat():u===3?o.top=l.readFloat():u===4?o.height=l.readFloat():u===5?o.mask_type=l.readVarint():u===6?o.mask_idx=l.readVarint():u===7&&o.children.push(pE(l,l.readVarint()+l.pos))}class Sae{static calculate(o={},l=[]){const f=new Map,p=new Map;if(Object.keys(o).length===0)return f;l.forEach(y=>{p.set(y.name,y.rgb_color||new Dr(0,0,0))});for(const[y,v]of Object.entries(o))p.has(y)?f.set(p.get(y).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${y}"`);return f}}function ky(u,o=255,l){const f=o/255,p=u.toStringPremultipliedAlpha(),y=l.has(p)?l.get(p).clone():u.clone();return y.a*=f,y.toString()}function w1(u,o){if(!gh()){const l=document.createElement("canvas");return l.width=u,l.height=o,l}return new OffscreenCanvas(u,o)}function Tae(u,o){const l=Sae.calculate(o.params,u.metadata?u.metadata.variables:[]),f=u.usvg_tree,p=f.width,y=f.height,v=o.transform?o.transform:new DOMMatrix,E=Math.max(1,Math.round(p*v.a)),C=Math.max(1,Math.round(y*v.d)),O=new DOMMatrix([E/p,0,0,C/y,0,0]),z=w1(E,C).getContext("2d");return EO(z,O,f,f,l),z.getImageData(0,0,E,C)}function EO(u,o,l,f,p){for(const y of f.children)z5(u,o,l,y,p)}function z5(u,o,l,f,p){f.group?(u.save(),function(y,v,E,C,O){const z=C.mask_idx!=null?E.masks[C.mask_idx]:null,F=C.clip_path_idx!=null?E.clip_paths[C.clip_path_idx]:null;if(C.transform&&(v=_E(C.transform).preMultiplySelf(v)),!function(J,re,ce){return J.opacity!==255||re||ce}(C,F!=null,z!=null))return void EO(y,v,E,C,O);const $=w1(y.canvas.width,y.canvas.height),Y=$.getContext("2d");EO(Y,v,E,C,O),F&&V5(Y,v,E,F),z&&W5(Y,v,E,z,O),y.globalAlpha=C.opacity/255,y.drawImage($,0,0)}(u,o,l,f.group,p),u.restore()):f.path&&(u.save(),function(y,v,E,C,O){const z=G5(C);y.setTransform(v),C.paint_order===oae.PAINT_ORDER_FILL_AND_STROKE?(N5(y,E,C,z,O),B5(y,E,C,z,O)):(B5(y,E,C,z,O),N5(y,E,C,z,O))}(u,o,l,f.path,p),u.restore())}function N5(u,o,l,f,p){const y=l.fill;if(!y)return;const v=y.opacity/255;switch(y.paint){case"rgb_color":u.fillStyle=ky(y.rgb_color,y.opacity,p);break;case"linear_gradient_idx":u.fillStyle=j5(u,o.linear_gradients[y.linear_gradient_idx],v,p);break;case"radial_gradient_idx":u.fillStyle=$5(u,o.radial_gradients[y.radial_gradient_idx],v,p)}u.fill(f,F5(l))}function F5(u){return u.rule===SO.PATH_RULE_NON_ZERO?"nonzero":u.rule===SO.PATH_RULE_EVEN_ODD?"evenodd":void 0}function B5(u,o,l,f,p){const y=l.stroke;if(!y)return;u.lineWidth=y.width,u.miterLimit=y.miterlimit,u.setLineDash(y.dasharray),u.lineDashOffset=y.dashoffset;const v=y.opacity/255;switch(y.paint){case"rgb_color":u.strokeStyle=ky(y.rgb_color,y.opacity,p);break;case"linear_gradient_idx":u.strokeStyle=j5(u,o.linear_gradients[y.linear_gradient_idx],v,p);break;case"radial_gradient_idx":u.strokeStyle=$5(u,o.radial_gradients[y.radial_gradient_idx],v,p)}switch(y.linejoin){case fE.LINE_JOIN_MITER_CLIP:case fE.LINE_JOIN_MITER:u.lineJoin="miter";break;case fE.LINE_JOIN_ROUND:u.lineJoin="round";break;case fE.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(y.linecap){case TO.LINE_CAP_BUTT:u.lineCap="butt";break;case TO.LINE_CAP_ROUND:u.lineCap="round";break;case TO.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(f)}function j5(u,o,l,f){if(o.stops.length===1){const $=o.stops[0];return ky($.rgb_color,$.opacity*l,f)}const p=_E(o.transform),{x1:y,y1:v,x2:E,y2:C}=o,O=p.transformPoint(new DOMPoint(y,v)),z=p.transformPoint(new DOMPoint(E,C)),F=u.createLinearGradient(O.x,O.y,z.x,z.y);for(const $ of o.stops)F.addColorStop($.offset,ky($.rgb_color,$.opacity*l,f));return F}function $5(u,o,l,f){if(o.stops.length===1){const $=o.stops[0];return ky($.rgb_color,$.opacity*l,f)}const p=_E(o.transform),{fx:y,fy:v,cx:E,cy:C}=o,O=p.transformPoint(new DOMPoint(y,v)),z=p.transformPoint(new DOMPoint(E,C)),F=u.createRadialGradient(O.x,O.y,0,z.x,z.y,o.r*((p.a+p.d)/2));for(const $ of o.stops)F.addColorStop($.offset,ky($.rgb_color,$.opacity*l,f));return F}function U5(u,o,l,f){const p=f.transform?_E(f.transform).preMultiplySelf(o):o,y=w1(u.canvas.width,u.canvas.height),v=y.getContext("2d");for(const C of f.children)if(C.group)U5(v,p,l,C.group);else if(C.path){const O=C.path,z=new Path2D;z.addPath(G5(O),p),v.fill(z,F5(O))}const E=f.clip_path_idx!=null?l.clip_paths[f.clip_path_idx]:null;E&&V5(v,p,l,E),u.globalCompositeOperation="source-over",u.drawImage(y,0,0)}function V5(u,o,l,f){const p=w1(u.canvas.width,u.canvas.height);U5(p.getContext("2d"),o,l,f),u.globalCompositeOperation="destination-in",u.drawImage(p,0,0)}function W5(u,o,l,f,p){if(f.children.length===0)return;const y=f.mask_idx!=null?l.masks[f.mask_idx]:null;y&&W5(u,o,l,y,p);const v=u.canvas.width,E=u.canvas.height,C=w1(v,E),O=C.getContext("2d"),z=f.width,F=f.height,$=f.left,Y=f.top,J=new Path2D,re=new Path2D;re.rect($,Y,z,F),J.addPath(re,o),O.clip(J);for(const we of f.children)z5(O,o,l,we,p);const ce=O.getImageData(0,0,v,E),de=ce.data;if(f.mask_type===R5.MASK_TYPE_LUMINANCE)for(let we=0;we<de.length;we+=4)de[we+3]=de[we+3]/255*(.2126*de[we]+.7152*de[we+1]+.0722*de[we+2]);O.putImageData(ce,0,0),u.globalCompositeOperation="destination-in",u.drawImage(C,0,0)}function _E(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function G5(u){const o=new Path2D,l=u.step;let f=u.diffs[0]*l,p=u.diffs[1]*l;o.moveTo(f,p);for(let y=0,v=2;y<u.commands.length;y++)switch(u.commands[y]){case b1.PATH_COMMAND_MOVE:f+=u.diffs[v++]*l,p+=u.diffs[v++]*l,o.moveTo(f,p);break;case b1.PATH_COMMAND_LINE:f+=u.diffs[v++]*l,p+=u.diffs[v++]*l,o.lineTo(f,p);break;case b1.PATH_COMMAND_QUAD:{const E=f+u.diffs[v++]*l,C=p+u.diffs[v++]*l;f=E+u.diffs[v++]*l,p=C+u.diffs[v++]*l,o.quadraticCurveTo(E,C,f,p);break}case b1.PATH_COMMAND_CUBIC:{const E=f+u.diffs[v++]*l,C=p+u.diffs[v++]*l,O=E+u.diffs[v++]*l,z=C+u.diffs[v++]*l;f=O+u.diffs[v++]*l,p=z+u.diffs[v++]*l,o.bezierCurveTo(E,C,O,z,f,p);break}case b1.PATH_COMMAND_CLOSE:o.closePath()}return o}class yE{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const l=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,l),l}put(o,l){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,l)}delete(o){this.cache.delete(o)}}dn(yE,"LRUCache");class AO{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new Ha(o,o.data)}getFromCache(o,l,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new yE(150)),this.cacheMap.get(f).get(kd(o.toString(),l))}setInCache(o,l,f,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new yE(150));const y=this.cacheDependenciesMap.get(p),v=kd(o.id.toString(),f);y.get(v)||y.set(v,new Set);const E=this.cacheMap.get(p),C=o.toString();y.get(v).add(C),E.put(kd(o.toString(),f),l)}removeImagesFromCacheByIds(o,l,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const p=this.cacheMap.get(f),y=this.cacheDependenciesMap.get(f);for(const v of o){const E=kd(v.toString(),l);if(y.has(E)){for(const C of y.get(E))p.delete(C);y.delete(E)}}}rasterize(o,l,f,p,y=Tae){const v=this.getFromCache(o,f,p);if(v)return v.clone();const E=y(l.icon,o.options),C=AO._getImage(E);return this.setInCache(o,C,f,p),C.clone()}}class H5{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const f=this.toIdx(o,l);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function q5(u,o,l,f){let p=0,y=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(f[v])<1e-15){if(l[v]<u[v]||l[v]>o[v])return null}else{const E=1/f[v];let C=(u[v]-l[v])*E,O=(o[v]-l[v])*E;if(C>O){const z=C;C=O,O=z}if(C>p&&(p=C),O<y&&(y=O),p>y)return null}return p}function Z5(u,o,l,f,p,y,v,E,C,O,z){const F=f-u,$=p-o,Y=y-l,J=v-u,re=E-o,ce=C-l,de=z[1]*ce-z[2]*re,we=z[2]*J-z[0]*ce,ve=z[0]*re-z[1]*J,ie=F*de+$*we+Y*ve;if(Math.abs(ie)<1e-15)return null;const ge=1/ie,be=O[0]-u,Ee=O[1]-o,Ue=O[2]-l,qe=(be*de+Ee*we+Ue*ve)*ge;if(qe<0||qe>1)return null;const Ke=Ee*Y-Ue*$,Qe=Ue*F-be*Y,xt=be*$-Ee*F,Dt=(z[0]*Ke+z[1]*Qe+z[2]*xt)*ge;return Dt<0||qe+Dt>1?null:(J*Ke+re*Qe+ce*xt)*ge}function X5(u,o,l){return(u-o)/(l-o)}function K5(u,o,l,f,p,y,v,E,C){const O=1<<l,z=y-f,F=v-p,$=(u+1)/O*z+f,Y=(o+0)/O*F+p,J=(o+1)/O*F+p;E[0]=(u+0)/O*z+f,E[1]=Y,C[0]=$,C[1]=J}class Y5{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(y){const v=Math.ceil(Math.log2(y.dim/8)),E=[];let C=Math.ceil(Math.pow(2,v));const O=1/C,z=(Y,J,re,ce,de)=>{const we=ce?1:0,ve=(Y+1)*re-we,ie=J*re,ge=(J+1)*re-we;de[0]=Y*re,de[1]=ie,de[2]=ve,de[3]=ge};let F=new H5(C);const $=[];for(let Y=0;Y<C*C;Y++){z(Y%C,Math.floor(Y/C),O,!1,$);const J=pp($[0],$[1],y),re=pp($[2],$[1],y),ce=pp($[2],$[3],y),de=pp($[0],$[3],y);F.minimums.push(Math.min(J,re,ce,de)),F.maximums.push(Math.max(J,re,ce,de)),F.leaves.push(1)}for(E.push(F),C/=2;C>=1;C/=2){const Y=E[E.length-1];F=new H5(C);for(let J=0;J<C*C;J++){z(J%C,Math.floor(J/C),2,!0,$);const re=Y.getElevation($[0],$[1]),ce=Y.getElevation($[2],$[1]),de=Y.getElevation($[2],$[3]),we=Y.getElevation($[0],$[3]),ve=Y.isLeaf($[0],$[1]),ie=Y.isLeaf($[2],$[1]),ge=Y.isLeaf($[2],$[3]),be=Y.isLeaf($[0],$[3]),Ee=Math.min(re.min,ce.min,de.min,we.min),Ue=Math.max(re.max,ce.max,de.max,we.max),qe=ve&&ie&&ge&&be;F.maximums.push(Ue),F.minimums.push(Ee),F.leaves.push(Ue-Ee<=5&&qe?1:0)}E.push(F)}return E}(this.dem),f=l.length-1,p=l[f];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,f,0)}raycastRoot(o,l,f,p,y,v,E=1){return q5([o,l,-100],[f,p,this.maximums[0]*E],y,v)}raycast(o,l,f,p,y,v,E=1){if(!this.nodeCount)return null;const C=this.raycastRoot(o,l,f,p,y,v,E);if(C==null)return null;const O=[],z=[],F=[],$=[],Y=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;Y.length>0;){const{idx:J,t:re,nodex:ce,nodey:de,depth:we}=Y.pop();if(this.leaves[J]){K5(ce,de,we,o,l,f,p,F,$);const ie=1<<we,ge=(ce+0)/ie,be=(ce+1)/ie,Ee=(de+0)/ie,Ue=(de+1)/ie,qe=pp(ge,Ee,this.dem)*E,Ke=pp(be,Ee,this.dem)*E,Qe=pp(be,Ue,this.dem)*E,xt=pp(ge,Ue,this.dem)*E,Dt=Z5(F[0],F[1],qe,$[0],F[1],Ke,$[0],$[1],Qe,y,v),Ct=Z5($[0],$[1],Qe,F[0],$[1],xt,F[0],F[1],qe,y,v),kt=Math.min(Dt!==null?Dt:Number.MAX_VALUE,Ct!==null?Ct:Number.MAX_VALUE);if(kt!==Number.MAX_VALUE)return kt;{const Bt=Mt([],y,v,re);if(J5(qe,Ke,xt,Qe,X5(Bt[0],F[0],$[0]),X5(Bt[1],F[1],$[1]))>=Bt[2])return re}continue}let ve=0;for(let ie=0;ie<this._siblingOffset.length;ie++){K5((ce<<1)+this._siblingOffset[ie][0],(de<<1)+this._siblingOffset[ie][1],we+1,o,l,f,p,F,$),F[2]=-100,$[2]=this.maximums[this.childOffsets[J]+ie]*E;const ge=q5(F,$,y,v);if(ge!=null){const be=ge;O[ie]=be;let Ee=!1;for(let Ue=0;Ue<ve&&!Ee;Ue++)be>=O[z[Ue]]&&(z.splice(Ue,0,ie),Ee=!0);Ee||(z[ve]=ie),ve++}}for(let ie=0;ie<ve;ie++){const ge=z[ie];Y.push({idx:this.childOffsets[J]+ge,t:O[ge],nodex:(ce<<1)+this._siblingOffset[ge][0],nodey:(de<<1)+this._siblingOffset[ge][1],depth:we+1})}}return null}_addNode(o,l,f){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,f,p,y){if(o[p].isLeaf(l,f)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const v=p-1,E=o[v];let C=0,O=0;for(let z=0;z<this._siblingOffset.length;z++){const F=2*l+this._siblingOffset[z][0],$=2*f+this._siblingOffset[z][1],Y=E.getElevation(F,$),J=E.isLeaf(F,$),re=this._addNode(Y.min,Y.max,J);J&&(C|=1<<z),O||(O=re)}for(let z=0;z<this._siblingOffset.length;z++)C&1<<z||this._construct(o,2*l+this._siblingOffset[z][0],2*f+this._siblingOffset[z][1],v,O+z)}}function J5(u,o,l,f,p,y){return kn(kn(u,l,y),kn(o,f,y),p)}function pp(u,o,l){const f=l.dim,p=$e(u*f-.5,0,f-1),y=$e(o*f-.5,0,f-1),v=Math.floor(p),E=Math.floor(y),C=Math.min(v+1,f-1),O=Math.min(E+1,f-1);return J5(l.get(v,E),l.get(C,E),l.get(v,O),l.get(C,O),p-v,y-E)}const Eae={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Aae(u,o,l){return(256*u*256+256*o+l)/10-1e4}function Pae(u,o,l){return 256*u+o+l/256-32768}class vE{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,f,p=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void mr(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const y=this.dim=l.height-2,v=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let C=0;C<y;C++)v[this._idx(-1,C)]=v[this._idx(0,C)],v[this._idx(y,C)]=v[this._idx(y-1,C)],v[this._idx(C,-1)]=v[this._idx(C,0)],v[this._idx(C,y)]=v[this._idx(C,y-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(y,-1)]=v[this._idx(y-1,0)],v[this._idx(-1,y)]=v[this._idx(0,y-1)],v[this._idx(y,y)]=v[this._idx(y-1,y-1)]}const E=f==="terrarium"?Pae:Aae;for(let C=0;C<v.length;++C){const O=4*C;this.floatView[C]=E(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=Mo.now()}_buildQuadTree(){this._tree=new Y5(this)}get(o,l,f=!1){f&&(o=$e(o,-1,this.dim),l=$e(l,-1,this.dim));const p=this._idx(o,l);return this.floatView[p]}set(o,l,f){const p=this._idx(o,l),y=this.floatView[p];return this.floatView[p]=f,f-y}static getUnpackVector(o){return Eae[o]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){const f=[0,0,0,0],p=vE.getUnpackVector(l);let y=Math.floor((o+p[3])/p[2]);return f[2]=y%256,y=Math.floor(y/256),f[1]=y%256,y=Math.floor(y/256),f[0]=y,f}getPixels(){return new QB({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,y=l*this.dim+this.dim,v=f*this.dim,E=f*this.dim+this.dim;switch(l){case-1:p=y-1;break;case 1:y=p+1}switch(f){case-1:v=E-1;break;case 1:E=v+1}const C=-l*this.dim,O=-f*this.dim;for(let z=v;z<E;z++)for(let F=p;F<y;F++){const $=4*this._idx(F,z),Y=4*this._idx(F+C,z+O);this.pixels[$+0]=o.pixels[Y+0],this.pixels[$+1]=o.pixels[Y+1],this.pixels[$+2]=o.pixels[Y+2],this.pixels[$+3]=o.pixels[Y+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Cae(u,o,l){u===1?o.headerLength=l.readFixed32():u===2?o.x=l.readVarint():u===3?o.y=l.readVarint():u===4?o.z=l.readVarint():u===5&&o.layers.push(function(f,p){return f.readFields(Rae,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function Iae(u,o,l){u===1?(o.delta_filter=function(f,p){return f.readFields(Mae,{blockSize:0},p)}(l,l.readVarint()+l.pos),o.filter="delta_filter"):u===2?(l.readVarint(),o.filter="zigzag_filter"):u===3?(l.readVarint(),o.filter="bitshuffle_filter"):u===4&&(l.readVarint(),o.filter="byteshuffle_filter")}function Mae(u,o,l){u===1&&(o.blockSize=l.readVarint())}function Oae(u,o,l){u===1?(l.readVarint(),o.codec="gzip_data"):u===2?(l.readVarint(),o.codec="jpeg_image"):u===3?(l.readVarint(),o.codec="webp_image"):u===4&&(l.readVarint(),o.codec="png_image")}function kae(u,o,l){let f=0,p=0;u===1?o.firstByte=l.readFixed64():u===2?o.lastByte=l.readFixed64():u===3?o.filters.push(function(y,v){return y.readFields(Iae,{},v)}(l,l.readVarint()+l.pos)):u===4?o.codec=function(y,v){return y.readFields(Oae,{},v)}(l,l.readVarint()+l.pos):u===5?p=l.readFloat():u===6?f=l.readFloat():u===7?o.bands.push(l.readString()):u===8?o.offset=l.readDouble():u===9&&(o.scale=l.readDouble()),o.offset===0&&(o.offset=p),o.scale===0&&(o.scale=f)}function Rae(u,o,l){u===1?o.version=l.readVarint():u===2?o.name=l.readString():u===3?o.units=l.readString():u===4?o.tileSize=l.readVarint():u===5?o.buffer=l.readVarint():u===6?o.pixelFormat=l.readVarint():u===7&&o.dataIndex.push(function(f,p){return f.readFields(kae,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function Dae(u,o,l){if(u===2)(function(f,p,y){f.readFields(Lae,y,p)})(l,l.readVarint()+l.pos,o);else if(u===3)throw new Error("Not implemented")}function Lae(u,o,l){if(u===1){let f=0;const p=l.readVarint()+l.pos;for(;l.pos<p;)o[f++]=l.readVarint()}}function zae(u,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let l=o[3];for(let f=2;f>=1;f--){const p=f===1?1:0,y=f===2?1:0;for(let v=0;v<o[0];v++){const E=o[1]*v;for(let C=p;C<o[1];C++){const O=o[2]*(C+E);for(let z=y;z<o[2];z++){const F=o[3]*(z+O);for(let $=0;$<o[3];$++){const Y=F+$;u[Y]+=u[Y-l]}}}}l*=o[f]}return u}function Nae(u){for(let o=0,l=u.length;o<l;o++)u[o]=u[o]>>>1^-(1&u[o]);return u}function Fae(u,o){switch(o){case"uint32":return u;case"uint16":for(let l=0;l<u.length;l+=2){const f=u[l],p=u[l+1];u[l]=(240&f)>>4|(61440&f)>>8|(240&p)<<4|61440&p,u[l+1]=15&f|(3840&f)>>4|(15&p)<<8|(3840&p)<<4}return u;case"uint8":for(let l=0;l<u.length;l+=4){const f=u[l],p=u[l+1],y=u[l+2],v=u[l+3];u[l+0]=(192&f)>>6|(192&p)>>4|(192&y)>>2|192&v,u[l+1]=(48&f)>>4|(48&p)>>2|48&y|(48&v)<<2,u[l+2]=(12&f)>>2|12&p|(12&y)<<2|(12&v)<<4,u[l+3]=3&f|(3&p)<<2|(3&y)<<4|(3&v)<<6}return u;default:throw new Error(`Invalid pixel format, "${o}"`)}}dn(vE,"DEMData"),dn(Y5,"DemMinMaxQuadTree",{omit:["dem"]});var wc=Uint8Array,S1=Uint16Array,Bae=Int32Array,Q5=new wc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e$=new wc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jae=new wc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),t$=function(u,o){for(var l=new S1(31),f=0;f<31;++f)l[f]=o+=1<<u[f-1];var p=new Bae(l[30]);for(f=1;f<30;++f)for(var y=l[f];y<l[f+1];++y)p[y]=y-l[f]<<5|f;return{b:l,r:p}},n$=t$(Q5,2),r$=n$.b,$ae=n$.r;r$[28]=258,$ae[258]=28;for(var Uae=t$(e$,0).b,i$=new S1(32768),Vo=0;Vo<32768;++Vo){var Ry=(43690&Vo)>>1|(21845&Vo)<<1;i$[Vo]=((65280&(Ry=(61680&(Ry=(52428&Ry)>>2|(13107&Ry)<<2))>>4|(3855&Ry)<<4))>>8|(255&Ry)<<8)>>1}var T1=function(u,o,l){for(var f=u.length,p=0,y=new S1(o);p<f;++p)u[p]&&++y[u[p]-1];var v,E=new S1(o);for(p=1;p<o;++p)E[p]=E[p-1]+y[p-1]<<1;v=new S1(1<<o);var C=15-o;for(p=0;p<f;++p)if(u[p])for(var O=p<<4|u[p],z=o-u[p],F=E[u[p]-1]++<<z,$=F|(1<<z)-1;F<=$;++F)v[i$[F]>>C]=O;return v},E1=new wc(288);for(Vo=0;Vo<144;++Vo)E1[Vo]=8;for(Vo=144;Vo<256;++Vo)E1[Vo]=9;for(Vo=256;Vo<280;++Vo)E1[Vo]=7;for(Vo=280;Vo<288;++Vo)E1[Vo]=8;var o$=new wc(32);for(Vo=0;Vo<32;++Vo)o$[Vo]=5;var Vae=T1(E1,9),Wae=T1(o$,5),PO=function(u){for(var o=u[0],l=1;l<u.length;++l)u[l]>o&&(o=u[l]);return o},zu=function(u,o,l){var f=o/8|0;return(u[f]|u[f+1]<<8)>>(7&o)&l},CO=function(u,o){var l=o/8|0;return(u[l]|u[l+1]<<8|u[l+2]<<16)>>(7&o)},Gae=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Nu=function(u,o,l){var f=new Error(o||Gae[u]);if(f.code=u,Error.captureStackTrace&&Error.captureStackTrace(f,Nu),!l)throw f;return f},Hae=new wc(0),qae=typeof TextDecoder<"u"&&new TextDecoder;try{qae.decode(Hae,{stream:!0})}catch{}const Zae={gzip_data:"gzip"};class qc extends Error{constructor(o){super(o),this.name="MRTError"}}const Xae={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},a$={uint32:1,uint16:2,uint8:4},Kae={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let IO;class xE{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const l=this.layers[o];if(!l)throw new qc(`Layer '${o}' not found`);return l}getHeaderLength(o){const l=new Uint8Array(o),f=new DataView(o);if(l[0]!==13)throw new qc("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(o){const l=new Uint8Array(o),f=this.getHeaderLength(o);if(l.length<f)throw new qc(`Expected header with length >= ${f} but got buffer of length ${l.length}`);const p=function(y,v){return y.readFields(Cae,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new IO(l.subarray(0,f)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new qc(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const y of p.layers)this.layers[y.name]=new s$(y,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const l=[],f=this.getLayer(o.layerName);for(let p of o.blockIndices){const y=f.dataIndex[p],v=y.firstByte-o.firstByte,E=y.lastByte-o.firstByte;if(f._blocksInProgress.has(p))continue;const C={layerName:f.name,firstByte:v,lastByte:E,pixelFormat:f.pixelFormat,blockIndex:p,blockShape:[y.bands.length].concat(f.bandShape),buffer:f.buffer,codec:y.codec.codec,filters:y.filters.map(O=>O.filter)};f._blocksInProgress.add(p),l.push(C)}return new l$(l,()=>{l.forEach(p=>f._blocksInProgress.delete(p.blockIndex))},(p,y)=>{if(l.forEach(v=>f._blocksInProgress.delete(v.blockIndex)),p)throw p;y.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class s${constructor({version:o,name:l,units:f,tileSize:p,pixelFormat:y,buffer:v,dataIndex:E},C){if(this.version=o,this.version!==1)throw new qc(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=l,this.units=f,this.tileSize=p,this.buffer=v,this.pixelFormat=Xae[y],this.dataIndex=E,this.bandShape=[p+2*v,p+2*v,a$[this.pixelFormat]],this._decodedBlocks=new yE(C?C.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return a$[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const l=o.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,o.data)}getBlockForBand(o){let l=0;switch(typeof o){case"string":for(const[f,p]of this.dataIndex.entries()){for(const[y,v]of p.bands.entries())if(v===o)return{bandIndex:l+y,blockIndex:f,blockBandIndex:y};l+=p.bands.length}break;case"number":for(const[f,p]of this.dataIndex.entries()){if(o>=l&&o<l+p.bands.length)return{bandIndex:o,blockIndex:f,blockBandIndex:o-l};l+=p.bands.length}break;default:throw new qc(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(o){let l=1/0,f=-1/0;const p=[],y=new Set;for(const v of o){const{blockIndex:E}=this.getBlockForBand(v);if(E<0)throw new qc(`Invalid band: ${JSON.stringify(v)}`);const C=this.dataIndex[E];p.includes(E)||p.push(E),y.add(E),l=Math.min(l,C.firstByte),f=Math.max(f,C.lastByte)}if(y.size>this.cacheSize)throw new qc(`Number of blocks to decode (${y.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:f,blockIndices:p}}hasBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0}hasDataForBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(o){const{blockIndex:l,blockBandIndex:f}=this.getBlockForBand(o);if(l<0)throw new qc(`Band not found: ${JSON.stringify(o)}`);const p=this._decodedBlocks.get(l.toString());if(!p)throw new qc(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const y=this.dataIndex[l],v=this.bandShape.reduce((O,z)=>O*z,1),E=f*v,C=p.subarray(E,E+v);return{data:C,bytes:new Uint8Array(C.buffer).subarray(C.byteOffset,C.byteOffset+C.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:y.offset,scale:y.scale}}}xE.setPbf=function(u){IO=u};class l${constructor(o,l,f){this.tasks=o,this._onCancel=l,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,l){this._finalized||(this._onComplete(o,l),this._finalized=!0)}}xE.performDecoding=function(u,o){const l=new Uint8Array(u);return Promise.all(o.tasks.map(f=>{const{layerName:p,firstByte:y,lastByte:v,pixelFormat:E,blockShape:C,blockIndex:O,filters:z,codec:F}=f,$=l.subarray(y,v+1),Y=new Uint32Array(C[0]*C[1]*C[2]);let J;if(F!=="gzip_data")throw new qc(`Unhandled codec: ${F}`);return J=function(re,ce){if(!globalThis.DecompressionStream&&ce==="gzip_data")return Promise.resolve(((ie=function(Ee){Ee[0]==31&&Ee[1]==139&&Ee[2]==8||Nu(6,"invalid gzip data");var Ue=Ee[3],qe=10;4&Ue&&(qe+=2+(Ee[10]|Ee[11]<<8));for(var Ke=(Ue>>3&1)+(Ue>>4&1);Ke>0;Ke-=!Ee[qe++]);return qe+(2&Ue)}(ve=re))+8>ve.length&&Nu(6,"invalid gzip data"),function(Ee,Ue,qe,Ke){var Qe=Ee.length;if(!Qe||Ue.f&&!Ue.l)return qe||new wc(0);var xt=!qe,Dt=xt||Ue.i!=2,Ct=Ue.i;xt&&(qe=new wc(3*Qe));var kt,Bt,_t=function(ao){var Oi=qe.length;if(ao>Oi){var bi=new wc(Math.max(2*Oi,ao));bi.set(qe),qe=bi}},Ot=Ue.f||0,pt=Ue.p||0,vt=Ue.b||0,Ut=Ue.l,Wt=Ue.d,Sn=Ue.m,mn=Ue.n,Jt=8*Qe;do{if(!Ut){Ot=zu(Ee,pt,1);var $t=zu(Ee,pt+1,3);if(pt+=3,!$t){var qn=Ee[(Se=4+((pt+7)/8|0))-4]|Ee[Se-3]<<8,vn=Se+qn;if(vn>Qe){Ct&&Nu(0);break}Dt&&_t(vt+qn),qe.set(Ee.subarray(Se,vn),vt),Ue.b=vt+=qn,Ue.p=pt=8*vn,Ue.f=Ot;continue}if($t==1)Ut=Vae,Wt=Wae,Sn=9,mn=5;else if($t==2){var xn=zu(Ee,pt,31)+257,Vn=zu(Ee,pt+10,15)+4,nr=xn+zu(Ee,pt+5,31)+1;pt+=14;for(var rr=new wc(nr),gr=new wc(19),ur=0;ur<Vn;++ur)gr[jae[ur]]=zu(Ee,pt+3*ur,7);pt+=3*Vn;var lr=PO(gr),di=(1<<lr)-1,Pi=T1(gr,lr);for(ur=0;ur<nr;){var Se,Ae=Pi[zu(Ee,pt,di)];if(pt+=15&Ae,(Se=Ae>>4)<16)rr[ur++]=Se;else{var bt=0,Xt=0;for(Se==16?(Xt=3+zu(Ee,pt,3),pt+=2,bt=rr[ur-1]):Se==17?(Xt=3+zu(Ee,pt,7),pt+=3):Se==18&&(Xt=11+zu(Ee,pt,127),pt+=7);Xt--;)rr[ur++]=bt}}var tn=rr.subarray(0,xn),Qt=rr.subarray(xn);Sn=PO(tn),mn=PO(Qt),Ut=T1(tn,Sn),Wt=T1(Qt,mn)}else Nu(1);if(pt>Jt){Ct&&Nu(0);break}}Dt&&_t(vt+131072);for(var wn=(1<<Sn)-1,jn=(1<<mn)-1,Sr=pt;;Sr=pt){var Tr=(bt=Ut[CO(Ee,pt)&wn])>>4;if((pt+=15&bt)>Jt){Ct&&Nu(0);break}if(bt||Nu(2),Tr<256)qe[vt++]=Tr;else{if(Tr==256){Sr=pt,Ut=null;break}var cr=Tr-254;Tr>264&&(cr=zu(Ee,pt,(1<<(Er=Q5[ur=Tr-257]))-1)+r$[ur],pt+=Er);var ei=Wt[CO(Ee,pt)&jn],xi=ei>>4;if(ei||Nu(3),pt+=15&ei,Qt=Uae[xi],xi>3){var Er=e$[xi];Qt+=CO(Ee,pt)&(1<<Er)-1,pt+=Er}if(pt>Jt){Ct&&Nu(0);break}Dt&&_t(vt+131072);var Zi=vt+cr;if(vt<Qt){var Ci=0-Qt,Jr=Math.min(Qt,Zi);for(Ci+vt<0&&Nu(3);vt<Jr;++vt)qe[vt]=(void 0)[Ci+vt]}for(;vt<Zi;++vt)qe[vt]=qe[vt-Qt]}}Ue.l=Ut,Ue.p=Sr,Ue.b=vt,Ue.f=Ot,Ut&&(Ot=1,Ue.m=Sn,Ue.d=Wt,Ue.n=mn)}while(!Ot);return vt!=qe.length&&xt?(kt=qe,((Bt=vt)==null||Bt>kt.length)&&(Bt=kt.length),new wc(kt.subarray(0,Bt))):qe.subarray(0,vt)}(ve.subarray(ie,-8),{i:2},new wc(((de=ve)[(we=de.length)-4]|de[we-3]<<8|de[we-2]<<16|de[we-1]<<24)>>>0))));var de,we,ve,ie;const ge=Zae[ce];if(!ge)throw new Error(`Unhandled codec: ${ce}`);const be=new globalThis.DecompressionStream(ge);return new Response(new Blob([re]).stream().pipeThrough(be)).arrayBuffer().then(Ee=>new Uint8Array(Ee))}($,F).then(re=>(function(ce,de){ce.readFields(Dae,de)}(new IO(re),Y),new Kae[E](Y.buffer))),J.then(re=>{for(let ce=z.length-1;ce>=0;ce--)switch(z[ce]){case"delta_filter":zae(re,C);break;case"zigzag_filter":Nae(re);break;case"bitshuffle_filter":Fae(re,E);break;default:throw new qc(`Unhandled filter "${z[ce]}"`)}return{layerName:p,blockIndex:O,data:re}}).catch(re=>{throw re})}))},dn(l$,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),dn(xE,"MapboxRasterTile"),dn(s$,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let A1,MO,Fu,Dy,OO,Ly=null;function c$(){return mi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:MO||kr.DRACO_URL}function u$(){if(mi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Dy)return Dy;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Dy=WebAssembly.validate(u)?kr.MESHOPT_SIMD_URL:kr.MESHOPT_URL,Dy}const bE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Yae={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},P1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function h$(u,o,l){const f=l.json.bufferViews.length,p=l.buffers.length;o.bufferView=f,l.json.bufferViews[f]={buffer:p,byteLength:u.byteLength},l.buffers[p]=u}const kO="KHR_draco_mesh_compression";function Jae(u,o){const l=u.extensions&&u.extensions[kO];if(!l)return;const f=new Fu.Decoder,p=m$(o,l.bufferView),y=new Fu.Mesh;if(!f.DecodeArrayToMesh(p,p.byteLength,y))throw new Error("Failed to decode Draco mesh");const v=o.json.accessors[u.indices],E=bE[v.componentType],C=v.count*E.BYTES_PER_ELEMENT,O=Fu._malloc(C);E===Uint16Array?f.GetTrianglesUInt16Array(y,C,O):f.GetTrianglesUInt32Array(y,C,O),h$(Fu.memory.buffer.slice(O,O+C),v,o),Fu._free(O);for(const z of Object.keys(l.attributes)){const F=f.GetAttributeByUniqueId(y,l.attributes[z]),$=o.json.accessors[u.attributes[z]],Y=Yae[$.componentType],J=$.count*P1[$.type]*bE[$.componentType].BYTES_PER_ELEMENT,re=Fu._malloc(J);f.GetAttributeDataArrayForAllPoints(y,F,Fu[Y],J,re),h$(Fu.memory.buffer.slice(re,re+J),$,o),Fu._free(re)}f.destroy(),y.destroy(),delete u.extensions[kO]}const wE="EXT_meshopt_compression";function Qae(u,o){if(!u.extensions||!u.extensions[wE])return;const l=u.extensions[wE],f=new Uint8Array(o.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);OO.decodeGltfBuffer(p,l.count,l.byteStride,f,l.mode,l.filter),u.buffer=o.buffers.length,u.byteOffset=0,o.buffers[u.buffer]=p.buffer,delete u.extensions[wE]}const d$=1179937895,f$=new TextDecoder("utf8");function p$(u,o){return new URL(u,o).href}function ese(u,o,l,f){return fetch(p$(u.uri,f)).then(p=>p.arrayBuffer()).then(p=>{o.buffers[l]=p})}function m$(u,o){const l=u.json.bufferViews[o];return new Uint8Array(u.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function tse(u,o,l,f){if(u.uri){const p=p$(u.uri,f);return fetch(p).then(y=>y.blob()).then(y=>createImageBitmap(y)).then(y=>{o.images[l]=y})}if(u.bufferView!==void 0){const p=m$(o,u.bufferView),y=new Blob([p],{type:u.mimeType});return createImageBitmap(y).then(v=>{o.images[l]=v})}}function g$(u,o=0,l){const f={json:null,images:[],buffers:[]};if(new Uint32Array(u,o,1)[0]===d$){const z=new Uint32Array(u,o);let F=2;const $=(z[F++]>>2)-3,Y=z[F++]>>2;if(F++,f.json=JSON.parse(f$.decode(z.subarray(F,F+Y))),F+=Y,F<$){const J=z[F++];F++;const re=o+(F<<2);f.buffers[0]=u.slice(re,re+J)}}else f.json=JSON.parse(f$.decode(new Uint8Array(u,o)));const{buffers:p,images:y,meshes:v,extensionsUsed:E,bufferViews:C}=f.json;let O=Promise.resolve();if(p){const z=[];for(let F=0;F<p.length;F++){const $=p[F];$.uri?z.push(ese($,f,F,l)):f.buffers[F]||(f.buffers[F]=null)}O=Promise.all(z)}return O.then(()=>{const z=[],F=E&&E.includes(kO),$=E&&E.includes(wE);if(F&&z.push(function(){if(!Fu)return A1??(A1=function(Y){let J,re=null;function ce(){J=new Uint8Array(re.buffer)}function de(){throw new Error("Unexpected Draco error.")}const we={a:{a:de,d:function(ve,ie,ge){return J.copyWithin(ve,ie,ie+ge)},c:function(ve){const ie=J.length,ge=Math.max(ve>>>0,Math.ceil(1.2*ie)),be=Math.ceil((ge-ie)/65536);try{return re.grow(be),ce(),!0}catch{return!1}},b:de}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Y,we):Y.then(ve=>ve.arrayBuffer()).then(ve=>WebAssembly.instantiate(ve,we))).then(ve=>{const{Rb:ie,Qb:ge,P:be,T:Ee,X:Ue,Ja:qe,La:Ke,Qa:Qe,Va:xt,Wa:Dt,eb:Ct,jb:kt,f:Bt,e:_t,yb:Ot,zb:pt,Ab:vt,Bb:Ut,Db:Wt,Gb:Sn}=ve.instance.exports;re=_t;const mn=(()=>{let Jt=0,$t=0,qn=0,vn=0;return xn=>{qn&&(ie(vn),ie(Jt),$t+=qn,qn=Jt=0),Jt||($t+=128,Jt=ge($t));const Vn=xn.length+7&-8;let nr=Jt;Vn>=$t&&(qn=Vn,nr=vn=ge(Vn));for(let rr=0;rr<xn.length;rr++)J[nr+rr]=xn[rr];return nr}})();return ce(),Bt(),{memory:_t,_free:ie,_malloc:ge,Mesh:class{constructor(){this.ptr=be()}destroy(){Ee(this.ptr)}},Decoder:class{constructor(){this.ptr=qe()}destroy(){kt(this.ptr)}DecodeArrayToMesh(Jt,$t,qn){const vn=mn(Jt),xn=Ke(this.ptr,vn,$t,qn.ptr);return!!Ue(xn)}GetAttributeByUniqueId(Jt,$t){return{ptr:Qe(this.ptr,Jt.ptr,$t)}}GetTrianglesUInt16Array(Jt,$t,qn){xt(this.ptr,Jt.ptr,$t,qn)}GetTrianglesUInt32Array(Jt,$t,qn){Dt(this.ptr,Jt.ptr,$t,qn)}GetAttributeDataArrayForAllPoints(Jt,$t,qn,vn,xn){Ct(this.ptr,Jt.ptr,$t.ptr,qn,vn,xn)}},DT_INT8:Ot(),DT_UINT8:pt(),DT_INT16:vt(),DT_UINT16:Ut(),DT_UINT32:Wt(),DT_FLOAT32:Sn()}})}(fetch(c$())),A1.then(Y=>{Fu=Y,A1=void 0}))}()),$&&z.push(function(){if(OO)return;const Y=function(J){let re;const ce=WebAssembly.instantiateStreaming(J,{}).then(ve=>{re=ve.instance,re.exports.__wasm_call_ctors()}),de={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},we={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ce,supported:!0,decodeGltfBuffer(ve,ie,ge,be,Ee,Ue){(function(qe,Ke,Qe,xt,Dt,Ct,kt){const Bt=qe.exports.sbrk,_t=xt+3&-4,Ot=Bt(_t*Dt),pt=Bt(Ct.length),vt=new Uint8Array(qe.exports.memory.buffer);vt.set(Ct,pt);const Ut=Ke(Ot,xt,Dt,pt,Ct.length);if(Ut===0&&kt&&kt(Ot,_t,Dt),Qe.set(vt.subarray(Ot,Ot+xt*Dt)),Bt(Ot-Bt(0)),Ut!==0)throw new Error(`Malformed buffer data: ${Ut}`)})(re,re.exports[we[Ee]],ve,ie,ge,be,re.exports[de[Ue]])}}}(fetch(u$()));return Y.ready.then(()=>{OO=Y})}()),y)for(let Y=0;Y<y.length;Y++)z.push(tse(y[Y],f,Y,l));return(z.length?Promise.all(z):Promise.resolve()).then(()=>{if(F&&v)for(const{primitives:Y}of v)for(const J of Y)Jae(J,f);if($&&v&&C)for(const Y of C)Qae(Y,f);return f})})}function Sg(u,o){const l=u.json.bufferViews[o.bufferView],f=bE[o.componentType];return new f(u.buffers[l.buffer],(o.byteOffset||0)+(l.byteOffset||0),o.count*(l.byteStride&&l.byteStride!==P1[o.type]*f.BYTES_PER_ELEMENT?l.byteStride/f.BYTES_PER_ELEMENT:P1[o.type]))}function RO(u,o,l,f){const p=bE[o.componentType],y=function(z){switch(z){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),v=u.json.bufferViews[o.bufferView],E=v.byteStride?v.byteStride/p.BYTES_PER_ELEMENT:P1[o.type],C=l.float32,O=C.length/l.capacity;for(let z=0,F=0;z<o.count*E;z+=E,F+=O)for(let $=0;$<O;$++)C[F+$]=f[z+$]*y;l._trim()}function nse(u,o,l){const f=u.indices,p=u.attributes,y={};y.indexArray=new ia;const v=o.json.accessors[f],E=v.count/3;y.indexArray.reserve(E);const C=Sg(o,v);for(let $=0;$<E;$++)y.indexArray.emplaceBack(C[3*$],C[3*$+1],C[3*$+2]);y.indexArray._trim(),y.vertexArray=new Uc;const O=o.json.accessors[p.POSITION];y.vertexArray.reserve(O.count);const z=Sg(o,O);for(let $=0;$<O.count;$++)y.vertexArray.emplaceBack(z[3*$],z[3*$+1],z[3*$+2]);if(y.vertexArray._trim(),y.aabb=new Li(O.min,O.max),y.centroid=function($,Y){const J=[0,0,0],re=$.length;if(re>0){for(let ce=0;ce<re;ce++){const de=3*$[ce];J[0]+=Y[de],J[1]+=Y[de+1],J[2]+=Y[de+2]}J[0]/=re,J[1]/=re,J[2]/=re}return J}(C,z),p.COLOR_0!==void 0){const $=o.json.accessors[p.COLOR_0],Y=P1[$.type],J=Sg(o,$);y.colorArray=Y===3?new Uc:new Vc,y.colorArray.resize($.count),RO(o,$,y.colorArray,J)}if(p.NORMAL!==void 0){y.normalArray=new Uc;const $=o.json.accessors[p.NORMAL];y.normalArray.resize($.count);const Y=Sg(o,$);RO(o,$,y.normalArray,Y)}if(p.TEXCOORD_0!==void 0&&l.length>0){y.texcoordArray=new Ld;const $=o.json.accessors[p.TEXCOORD_0];y.texcoordArray.resize($.count);const Y=Sg(o,$);RO(o,$,y.texcoordArray,Y)}if(p._FEATURE_ID_RGBA4444!==void 0){const $=o.json.accessors[p._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(y.featureData=Sg(o,$))}p._FEATURE_RGBA4444!==void 0&&(y.featureData=new Uint32Array(Sg(o,o.json.accessors[p._FEATURE_RGBA4444]).buffer));const F=u.material;return y.material=function($,Y){const{emissiveFactor:J=[0,0,0],alphaMode:re="OPAQUE",alphaCutoff:ce=.5,normalTexture:de,occlusionTexture:we,emissiveTexture:ve,doubleSided:ie}=$,{baseColorFactor:ge=[1,1,1,1],metallicFactor:be=1,roughnessFactor:Ee=1,baseColorTexture:Ue,metallicRoughnessTexture:qe}=$.pbrMetallicRoughness||{},Ke=we?Y[we.index]:void 0;if(we&&we.extensions&&we.extensions.KHR_texture_transform&&Ke){const Qe=we.extensions.KHR_texture_transform;Ke.offsetScale=[Qe.offset[0],Qe.offset[1],Qe.scale[0],Qe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Dr(...ge),metallicFactor:be,roughnessFactor:Ee,baseColorTexture:Ue?Y[Ue.index]:void 0,metallicRoughnessTexture:qe?Y[qe.index]:void 0},doubleSided:ie,emissiveFactor:J,alphaMode:re,alphaCutoff:ce,normalTexture:de?Y[de.index]:void 0,occlusionTexture:Ke,emissionTexture:ve?Y[ve.index]:void 0,defined:$.defined===void 0}}(F!==void 0?o.json.materials[F]:{defined:!1},l),y}function _$(u,o,l){const{matrix:f,rotation:p,translation:y,scale:v,mesh:E,extras:C,children:O}=u,z={};if(z.matrix=f||function(F,$,Y,J){var re=$[0],ce=$[1],de=$[2],we=$[3],ve=re+re,ie=ce+ce,ge=de+de,be=re*ve,Ee=re*ie,Ue=re*ge,qe=ce*ie,Ke=ce*ge,Qe=de*ge,xt=we*ve,Dt=we*ie,Ct=we*ge,kt=J[0],Bt=J[1],_t=J[2];return F[0]=(1-(qe+Qe))*kt,F[1]=(Ee+Ct)*kt,F[2]=(Ue-Dt)*kt,F[3]=0,F[4]=(Ee-Ct)*Bt,F[5]=(1-(be+Qe))*Bt,F[6]=(Ke+xt)*Bt,F[7]=0,F[8]=(Ue+Dt)*_t,F[9]=(Ke-xt)*_t,F[10]=(1-(be+qe))*_t,F[11]=0,F[12]=Y[0],F[13]=Y[1],F[14]=Y[2],F[15]=1,F}([],p||[0,0,0,1],y||[0,0,0],v||[1,1,1]),E!==void 0){z.meshes=l[E];const F=z.anchor=[0,0];for(const $ of z.meshes){const{min:Y,max:J}=$.aabb;F[0]+=Y[0]+J[0],F[1]+=Y[1]+J[1]}F[0]=Math.floor(F[0]/z.meshes.length/2),F[1]=Math.floor(F[1]/z.meshes.length/2)}if(C&&(C.id&&(z.id=C.id),C.lights&&(z.lights=function(F){if(!F.length)return[];const $=function(de){const we=atob(de),ve=new Uint8Array(we.length);for(let ie=0;ie<we.length;ie++)ve[ie]=we.codePointAt(ie);return ve}(F),Y=[],J=$.length/24,re=new Uint16Array($.buffer),ce=new Float32Array($.buffer);for(let de=0;de<J;de++){const we=re[2*de*6]/30,ve=re[2*de*6+1]/30,ie=re[2*de*6+10]/100,ge=ce[6*de+1],be=ce[6*de+2],Ee=ce[6*de+3],Ue=ce[6*de+4],qe=Ee-ge,Ke=Ue-be,Qe=Math.hypot(qe,Ke);Y.push({pos:[ge+.5*qe,be+.5*Ke,ve],normal:[Ke/Qe,-qe/Qe,0],width:Qe,height:we,depth:ie,points:[ge,be,Ee,Ue]})}return Y}(C.lights))),O){const F=[];for(const $ of O)F.push(_$(o.json.nodes[$],o,l));z.children=F}return z}function rse(u){if(u.vertices.length===0||u.indices.length===0)return null;const o=new NM(u.vertices,u.indices,8,256),[l,f]=[o.min.clone(),o.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:o,min:l,max:f}}function ise(u){if(!u.extras||!u.extras.ground)return null;const o=u.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const l=o[0];if(!l||!Array.isArray(l)||l.length===0)return null;const f=[];for(const v of l){if(!Array.isArray(v)||v.length!==2)continue;const E=v[0],C=v[1];typeof E=="number"&&typeof C=="number"&&f.push(new Tt(E,C))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let p=0;for(let v=0;v<f.length;v++){const E=f[v],C=f[(v+1)%f.length],O=f[(v+2)%f.length];p+=(E.x-C.x)*(O.y-C.y)-(O.x-C.x)*(E.y-C.y)}p>0&&f.reverse();const y=Kx(f.flatMap(v=>[v.x,v.y]),[]);return y.length===0?null:{vertices:f,indices:y}}function ose(u,o){const l=[],f=[];let p=0;const y=[];for(const v of u){p=l.length;const E=v.vertexArray.float32,C=v.indexArray.uint16;for(let O=0;O<v.vertexArray.length;O++)y[0]=E[3*O+0],y[1]=E[3*O+1],y[2]=E[3*O+2],Gt(y,y,o),l.push(new Tt(y[0],y[1]));for(let O=0;O<3*v.indexArray.length;O++)f.push(C[O]+p)}if(f.length%3!=0)return null;for(let v=0;v<f.length;v+=3){const E=l[f[v+0]],C=l[f[v+1]],O=l[f[v+2]];(E.x-C.x)*(O.y-C.y)-(O.x-C.x)*(E.y-C.y)>0&&([f[v+1],f[v+2]]=[f[v+2],f[v+1]])}return{vertices:l,indices:f}}function y$(u){const o=function(C,O){const z=[],F=WebGL2RenderingContext;if(C.json.textures)for(const $ of C.json.textures){const Y={magFilter:F.LINEAR,minFilter:F.NEAREST,wrapS:F.REPEAT,wrapT:F.REPEAT};$.sampler!==void 0&&Object.assign(Y,C.json.samplers[$.sampler]),z.push({image:O[$.source],sampler:Y,uploaded:!1})}return z}(u,u.images),l=function(C,O){const z=[];for(const F of C.json.meshes){const $=[];for(const Y of F.primitives)$.push(nse(Y,C,O));z.push($)}return z}(u,o),{scenes:f,scene:p,nodes:y}=u.json,v=f?f[p||0].nodes:y,E=[];for(const C of v)E.push(_$(y[C],u,l));return function(C,O,z){const F={},$=new Set;for(let Y=0;Y<C.length;Y++){const J=z[O[Y]];if(!J.extras)continue;const re=J.extras["mapbox:footprint:version"],ce=J.extras["mapbox:footprint:id"];(re||ce)&&$.add(Y),re==="1.0.0"&&ce&&(F[ce]=Y)}for(let Y=0;Y<C.length;Y++){if($.has(Y))continue;const J=C[Y],re=z[O[Y]];if(!re.extras)continue;let ce=null;J.id in F&&(ce=ose(C[F[J.id]].meshes,J.matrix)),ce||(ce=ise(re)),ce&&(J.footprint=rse(ce))}if($.size>0){const Y=Array.from($.values()).sort((J,re)=>J-re);for(let J=Y.length-1;J>=0;J--)C.splice(Y[J],1)}}(E,v,u.json.nodes),E}function ase(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const o=u.vertexArray.float32,l=u.aabb.min[0]-1,f=u.aabb.min[1]-1,p=xg/(u.aabb.max[0]-l+2),y=xg/(u.aabb.max[1]-f+2);for(let v=0;v<o.length;v+=3){const E=o[v+2],C=(o[v+0]-l)*p|0,O=(o[v+1]-f)*y|0;E>u.heightmap[O*xg+C]&&(u.heightmap[O*xg+C]=E)}}function sse(u,o){const l={};l.indexArray=new ia,l.indexArray.reserve(4*u.length),l.vertexArray=new Uc,l.vertexArray.reserve(10*u.length),l.colorArray=new Vc,l.vertexArray.reserve(10*u.length);let f=0;for(const v of u){const E=Math.min(10,Math.max(4,1.3*v.height))*o,C=[-v.normal[1],v.normal[0],0],O=Math.min(.29,.1*v.width/v.depth),z=v.width-2*v.depth*o*(O+.01),F=Mt([],v.pos,C,z/2),$=Mt([],v.pos,C,-z/2),Y=[F[0],F[1],F[2]+v.height],J=[$[0],$[1],$[2]+v.height],re=Mt([],v.normal,C,O);at(re,re,E);const ce=Mt([],v.normal,C,-O);at(ce,ce,E),ct(re,F,re),ct(ce,$,ce),F[2]+=.1,$[2]+=.1,l.vertexArray.emplaceBack(re[0],re[1],re[2]),l.vertexArray.emplaceBack(ce[0],ce[1],ce[2]),l.vertexArray.emplaceBack(F[0],F[1],F[2]),l.vertexArray.emplaceBack($[0],$[1],$[2]),l.vertexArray.emplaceBack(Y[0],Y[1],Y[2]),l.vertexArray.emplaceBack(J[0],J[1],J[2]),l.vertexArray.emplaceBack(F[0],F[1],F[2]),l.vertexArray.emplaceBack($[0],$[1],$[2]),l.vertexArray.emplaceBack(re[0],re[1],re[2]),l.vertexArray.emplaceBack(ce[0],ce[1],ce[2]);const de=z/E/2;l.colorArray.emplaceBack(-de-O,-1,de,.8),l.colorArray.emplaceBack(de+O,-1,de,.8),l.colorArray.emplaceBack(-de,0,de,1.3),l.colorArray.emplaceBack(de,0,de,1.3),l.colorArray.emplaceBack(de+O,-.8,de,.7),l.colorArray.emplaceBack(de+O,-.8,de,.7),l.colorArray.emplaceBack(0,0,de,1.3),l.colorArray.emplaceBack(0,0,de,1.3),l.colorArray.emplaceBack(de+O,-1.2,de,.8),l.colorArray.emplaceBack(de+O,-1.2,de,.8),l.indexArray.emplaceBack(6+f,4+f,8+f),l.indexArray.emplaceBack(7+f,9+f,5+f),l.indexArray.emplaceBack(0+f,1+f,2+f),l.indexArray.emplaceBack(1+f,3+f,2+f),f+=10}const p={defined:!0,emissiveFactor:[0,0,0]},y={};return y.baseColorFactor=Dr.white,p.pbrMetallicRoughness=y,l.material=p,l.aabb=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class v${constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const f=o[l];this._stringToNumber[f]=l,this._numberToString[l]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const lse=["id","tile","layer","source","sourceLayer","state"];class zy{constructor(o,l,f,p,y){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=f,this._y=p,this.properties=o.properties,this.id=y}clone(){const o=new zy(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of lse)this[l]!==void 0&&(o[l]=this[l]);return o}}class x${constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new qf(Kt,16,0),this.featureIndexArray=new wT,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,l,f,p,y,v=0,E=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,p,y,v);const O=this.grid;for(let z=0;z<l.length;z++){const F=l[z],$=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<F.length;Y++){const J=F[Y];$[0]=Math.min($[0],J.x),$[1]=Math.min($[1],J.y),$[2]=Math.max($[2],J.x),$[3]=Math.max($[3],J.y)}E!==0&&($[0]-=E,$[1]-=E,$[2]+=E,$[3]+=E),$[0]<Kt&&$[1]<Kt&&$[2]>=0&&$[3]>=0&&O.insert(C,$[0],$[1],$[2],$[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new lp.VectorTile(new VT(this.rawTileData)).layers,this.sourceLayerCoder=new v$(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l){const{tilespaceGeometry:f,transform:p,tileTransform:y,pixelPosMatrix:v,availableImages:E}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const C=f.bufferedTilespaceBounds,O=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(Y,J,re,ce)=>Ao(f.bufferedTilespaceGeometry,Y,J,re,ce));O.sort(cse);let z=null;p.elevation&&O.length>0&&(z=My.create(p.elevation,this.tileID));const F={};let $;for(let Y=0;Y<O.length;Y++){const J=O[Y];if(J===$)continue;$=J;const re=this.featureIndexArray.get(J);let ce=null;this.is3DTile?this.loadMatchingModelFeature(F,re,o,f,p):this.loadMatchingFeature(F,re,o,E,(de,we,ve,ie=0)=>(ce||(ce=gn(de,this.tileID.canonical,y)),we.queryIntersectsFeature(f,de,ve,ce,this.z,p,v,z,ie)))}return F}loadMatchingFeature(o,l,f,p,y){const{featureIndex:v,bucketIndex:E,sourceLayerIndex:C,layoutVertexArrayOffset:O}=l,z=this.bucketLayerIDs[E],F=f.layers,$=Object.keys(F);if($.length&&!function(de,we){for(let ve=0;ve<de.length;ve++)if(we.indexOf(de[ve])>=0)return!0;return!1}($,z))return;const Y=f.sourceCache,J=this.sourceLayerCoder.decode(C),re=this.vtLayers[J].feature(v),ce=this.getId(re,J);for(let de=0;de<z.length;de++){const we=z[de];if(!F[we])continue;const{styleLayer:ve,targets:ie}=F[we];let ge={};ce!==void 0&&(ge=Y.getFeatureState(ve.sourceLayer,ce));const be=!y||y(re,ve,ge,O);if(!be)continue;const Ee=new zy(re,this.z,this.x,this.y,ce);Ee.tile=this.tileID.canonical,Ee.state=ge;let Ue=this.serializedLayersCache.get(we);Ue||(Ue=ve.serialize(),Ue.id=we,this.serializedLayersCache.set(we,Ue)),Ee.source=Ue.source,Ee.sourceLayer=Ue["source-layer"],Ee.layer=ut({},Ue),Ee.layer.paint=b$(Ue.paint,ve.paint,re,ge,p),Ee.layer.layout=b$(Ue.layout,ve.layout,re,ge,p);let qe=!1;for(const Ke of ie){this.updateFeatureProperties(Ee,Ke);const{filter:Qe}=Ke;if(Qe){if(re.properties=Ee.properties,Qe.needGeometry){const xt=En(re,!0);if(!Qe.filter(new ii(this.tileID.overscaledZ),xt,this.tileID.canonical))continue}else if(!Qe.filter(new ii(this.tileID.overscaledZ),re))continue}qe=!0,Ke.targetId&&this.addFeatureVariant(Ee,Ke)}qe&&this.appendToResult(o,we,v,Ee,be)}}loadMatchingModelFeature(o,l,f,p,y){const v=this.bucketLayerIDs[0][0],E=f.layers;if(!E[v])return;const{styleLayer:C,targets:O}=E[v];if(C.type!=="model")return;const z=p.tile,F=l.featureIndex,$=z.getBucket(C);if(!($&&$ instanceof hE))return;const Y=function(Ue,qe,Ke,Qe){const xt=Ue.getNodesInfo()[qe];if(xt.hiddenByReplacement||!xt.node.meshes)return;let Dt=Number.MAX_VALUE;const Ct=xt.node,kt=Ke.tile,Bt=Qe.calculatePosMatrix(kt.tileID.toUnwrapped(),Qe.worldSize),_t=xt.evaluatedScale;let Ot=0;Qe.elevation&&Ct.elevation&&(Ot=Ct.elevation*Qe.elevation.exaggeration()),G(Bt,Bt,[(Ct.anchor?Ct.anchor[0]:0)*(_t[0]-1),(Ct.anchor?Ct.anchor[1]:0)*(_t[1]-1),Ot]),q(Bt,Bt,_t);const pt=Ke.queryGeometry,vt=pt.isPointQuery()?pt.screenBounds:pt.screenGeometry,Ut=function(Sn){const mn=H([],Bt,Sn.matrix);H(mn,Qe.expandedFarZProjMatrix,mn);for(let Jt=0;Jt<Sn.meshes.length;++Jt){const $t=Sn.meshes[Jt];if(Jt===Sn.lightMeshIndex)continue;const qn=x5(vt,Qe,mn,$t.aabb);qn!=null&&(Dt=Math.min(qn,Dt))}if(Sn.children)for(const Jt of Sn.children)Ut(Jt)};if(Ut(Ct),Dt===Number.MAX_VALUE)return;const Wt=new le(0,0);return O5(kt.tileID.canonical,Wt,xt.node.anchor[0],xt.node.anchor[1]),{intersectionZ:Dt,position:Wt,feature:xt.feature}}($,F,p,y);if(!Y)return;const{z:J,x:re,y:ce}=z.tileID.canonical,{feature:de,intersectionZ:we,position:ve}=Y;let ie={};de.id!==void 0&&(ie=f.sourceCache.getFeatureState(C.sourceLayer,de.id));const ge=new zy({},J,re,ce,de.id);ge.tile=this.tileID.canonical,ge.state=ie,ge.properties=de.properties,ge.geometry={type:"Point",coordinates:[ve.lng,ve.lat]};let be=this.serializedLayersCache.get(v);be||(be=C.serialize(),be.id=v,this.serializedLayersCache.set(v,be)),ge.source=be.source,ge.sourceLayer=be["source-layer"],ge.layer=ut({},be);let Ee=!1;for(const Ue of O){this.updateFeatureProperties(ge,Ue);const{filter:qe}=Ue;if(qe){if(de.properties=ge.properties,qe.needGeometry){if(!qe.filter(new ii(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!qe.filter(new ii(this.tileID.overscaledZ),de))continue}Ee=!0,Ue.targetId&&this.addFeatureVariant(ge,Ue)}Ee&&this.appendToResult(o,v,F,ge,we)}updateFeatureProperties(o,l,f){if(l.properties){const p={};for(const y in l.properties){const v=l.properties[y].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,f);v!=null&&(p[y]=v)}o.properties=p}}addFeatureVariant(o,l,f){const p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=o.properties),o.variants=o.variants||{},o.variants[l.targetId]=o.variants[l.targetId]||[],o.variants[l.targetId].push(p)}appendToResult(o,l,f,p,y){let v=o[l];v===void 0&&(v=o[l]=[]),v.push({featureIndex:f,feature:p,intersectionZ:y})}lookupSymbolFeatures(o,l,f,p,y){const v={};this.loadVTLayers();for(const E of o)this.loadMatchingFeature(v,{bucketIndex:l,sourceLayerIndex:f,featureIndex:E,layoutVertexArrayOffset:0},p,y);return v}loadFeature(o){const{featureIndex:l,sourceLayerIndex:f}=o;this.loadVTLayers();const p=this.sourceLayerCoder.decode(f),y=this.vtFeatures[p];if(y[l])return y[l];const v=this.vtLayers[p].feature(l);return y[l]=v,v}hasLayer(o){for(const l of this.bucketLayerIDs)for(const f of l)if(o===f)return!0;return!1}getId(o,l){let f=o.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const y=Gf(p);if(y.result!=="success"){const v=y.value.map(E=>`${E.key}: ${E.message}`).join(", ");return void mr(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=y.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Tu),f=this.promoteIdExpression.evaluate({zoom:0},o)}else f=o.properties[p];typeof f=="boolean"&&(f=Number(f))}return f}}function b$(u,o,l,f,p){return er(u,(y,v)=>{const E=o instanceof Md?o.get(v):null;return E&&E.evaluate?E.evaluate(l,f,void 0,p):E})}function cse(u,o){return o-u}dn(x$,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const w$=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class DO{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,f]=new Uint8Array(o,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=f>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=w$[15&f];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(o,2,1),[E]=new Uint32Array(o,4,1);return new DO(E,v,y,o)}constructor(o,l=64,f=Float64Array,p){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=f,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const y=w$.indexOf(this.ArrayType),v=2*o*this.ArrayType.BYTES_PER_ELEMENT,E=o*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${f}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+E+C,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+C),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+E+C,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=o)}add(o,l){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=o,this.coords[this._pos++]=l,f}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return LO(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,l,f,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:E}=this,C=[0,y.length-1,0],O=[];for(;C.length;){const z=C.pop()||0,F=C.pop()||0,$=C.pop()||0;if(F-$<=E){for(let ce=$;ce<=F;ce++){const de=v[2*ce],we=v[2*ce+1];de>=o&&de<=f&&we>=l&&we<=p&&O.push(y[ce])}continue}const Y=$+F>>1,J=v[2*Y],re=v[2*Y+1];J>=o&&J<=f&&re>=l&&re<=p&&O.push(y[Y]),(z===0?o<=J:l<=re)&&(C.push($),C.push(Y-1),C.push(1-z)),(z===0?f>=J:p>=re)&&(C.push(Y+1),C.push(F),C.push(1-z))}return O}within(o,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:v}=this,E=[0,p.length-1,0],C=[],O=f*f;for(;E.length;){const z=E.pop()||0,F=E.pop()||0,$=E.pop()||0;if(F-$<=v){for(let ce=$;ce<=F;ce++)T$(y[2*ce],y[2*ce+1],o,l)<=O&&C.push(p[ce]);continue}const Y=$+F>>1,J=y[2*Y],re=y[2*Y+1];T$(J,re,o,l)<=O&&C.push(p[Y]),(z===0?o-f<=J:l-f<=re)&&(E.push($),E.push(Y-1),E.push(1-z)),(z===0?o+f>=J:l+f>=re)&&(E.push(Y+1),E.push(F),E.push(1-z))}return C}}function LO(u,o,l,f,p,y){if(p-f<=l)return;const v=f+p>>1;S$(u,o,v,f,p,y),LO(u,o,l,f,v-1,1-y),LO(u,o,l,v+1,p,1-y)}function S$(u,o,l,f,p,y){for(;p>f;){if(p-f>600){const O=p-f+1,z=l-f+1,F=Math.log(O),$=.5*Math.exp(2*F/3),Y=.5*Math.sqrt(F*$*(O-$)/O)*(z-O/2<0?-1:1);S$(u,o,l,Math.max(f,Math.floor(l-z*$/O+Y)),Math.min(p,Math.floor(l+(O-z)*$/O+Y)),y)}const v=o[2*l+y];let E=f,C=p;for(C1(u,o,f,l),o[2*p+y]>v&&C1(u,o,f,p);E<C;){for(C1(u,o,E,C),E++,C--;o[2*E+y]<v;)E++;for(;o[2*C+y]>v;)C--}o[2*f+y]===v?C1(u,o,f,C):(C++,C1(u,o,C,p)),C<=l&&(f=C+1),l<=C&&(p=C-1)}}function C1(u,o,l,f){zO(u,l,f),zO(o,2*l,2*f),zO(o,2*l+1,2*f+1)}function zO(u,o,l){const f=u[o];u[o]=u[l],u[l]=f}function T$(u,o,l,f){const p=u-l,y=o-f;return p*p+y*y}i.$=Da,i.A=ic,i.B=sl,i.C=kd,i.D=Oy,i.E=ol,i.F=2,i.G=c1,i.H=D4,i.I=ts,i.J=class extends cE{},i.K=Fn,i.L=pd,i.M=gc,i.N=Q_,i.O=J_,i.P=Tt,i.Q=bx,i.R=Fr,i.S=ny,i.T=hO,i.U=sy,i.V=cE,i.W=Km,i.X=Gf,i.Y=Yn,i.Z=Yr,i._=bn,i.a=function(u){return kr.API_CDN_URL_REGEX.test(u)},i.a$=an,i.a0=fd,i.a1=ly,i.a2=ey,i.a3=tT,i.a4=function(u){const o=u.value;let l=[];if(!o)return l;const f=Fn(o);return f!=="string"?(l=l.concat([new cE(u.key,o,`string expected, "${f}" found`)]),l):(mO(o,!0)||(l=l.concat([new cE(u.key,o,`invalid url "${o}"`)])),l)},i.a5=st,i.a6=lT,i.a7=io,i.a8=Zt,i.a9=class{constructor(u){this.specification=u}possiblyEvaluate(u,o){return hi(u.expression.evaluate(o))}interpolate(u,o,l){return{x:kn(u.x,o.x,l),y:kn(u.y,o.y,l),z:kn(u.z,o.z,l),azimuthal:kn(u.azimuthal,o.azimuthal,l),polar:kn(u.polar,o.polar,l)}}},i.aA=Pt,i.aB=ai,i.aC=It,i.aD=$e,i.aE=S,i.aF=function(u,o){const l={};for(let f=0;f<o.length;f++){const p=o[f];p in u&&(l[p]=u[p])}return l},i.aG=xe,i.aH=Re,i.aI=class{constructor(u){this.entries={},this.scheduler=u}request(u,o,l,f){const p=this.entries[u]=this.entries[u]||{callbacks:[]};if(p.result){const[y,v]=p.result;return this.scheduler?this.scheduler.add(()=>{f(y,v)},o):f(y,v),()=>{}}return p.callbacks.push(f),p.cancel||(p.cancel=l((y,v)=>{p.result=[y,v];for(const E of p.callbacks)this.scheduler?this.scheduler.add(()=>{E(y,v)},o):E(y,v);setTimeout(()=>delete this.entries[u],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(y=>y!==f),p.callbacks.length||(p.cancel(),delete this.entries[u]))}}},i.aJ=function(u,o,l){const f=JSON.stringify(u.request);return u.data&&(this.deduped.entries[f]={result:[null,u.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},p=>{const y=Bc(u.request,(v,E,C,O)=>{v?p(v):E&&p(null,{vectorTile:l?void 0:new lp.VectorTile(new VT(E)),rawData:E,cacheControl:C,expires:O})});return()=>{y.cancel(),p()}},o)},i.aK=function(u){yu++,yu>Ia&&(u.getActor().send("enforceCacheSizeLimit",ro),yu=0)},i.aL=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},i.aM=mo,i.aN=c5,i.aO=m5,i.aP=l5,i.aQ=function(u,o){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let f=0;f<u.length;f++){const p=document.createElement("source");Om(u[f])||(l.crossOrigin="Anonymous"),p.src=u[f],l.appendChild(p)}return{cancel:()=>{}}},i.aR=iE,i.aS=function(u){return fetch(u).then(o=>o.arrayBuffer()).then(o=>g$(o,0,u))},i.aT=y$,i.aU=class{constructor(u,o,l,f){this.id=u,this.position=o!=null?new le(o[0],o[1]):new le(0,0),this.orientation=l??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,o){if(H(u.matrix,o,u.matrix),u.meshes)for(const l of u.meshes){const f=Li.applyTransformFast(l.aabb,u.matrix);this.aabb.encapsulate(f)}if(u.children)for(const l of u.children)this._applyTransformations(l,u.matrix)}computeBoundsAndApplyParent(){const u=N([]);for(const o of this.nodes)this._applyTransformations(o,u)}computeModelMatrix(u,o,l,f,p,y,v=!1){A5(this.matrix,this,u.transform,this.position,o,l,f,p,y,v)}upload(u){if(!this.uploaded){for(const o of this.nodes)_O(o,u);for(const o of this.nodes)uE(o);this.uploaded=!0}}destroy(){for(const u of this.nodes)yO(u)}},i.aV=Zn,i.aW=d1,i.aX=Ve,i.aY=Ge,i.aZ=Rd,i.a_=ia,i.aa=ii,i.ab=Hf,i.ac=dt,i.ad=Gt,i.ae=Ze,i.af=Ye,i.ag=Md,i.ah=ap,i.ai=kn,i.aj=Kt,i.ak=Cf,i.al=ae,i.am=Dr,i.an=class{constructor(u){this.specification=u}possiblyEvaluate(u,o){return function([l,f]){const p=hi([1,l,f]);return{x:p.x,y:p.y,z:p.z}}(u.expression.evaluate(o))}interpolate(u,o,l){return{x:kn(u.x,o.x,l),y:kn(u.y,o.y,l),z:kn(u.z,o.z,l)}}},i.ao=function(u,o,l=0,f=!0){const p=new Tt(l,l),y=u.sub(p),v=o.add(p),E=[y,new Tt(v.x,y.y),v,new Tt(y.x,v.y)];return f&&E.push(y.clone()),E},i.ap=function(u,o){const l=[];for(let f=0;f<u.length;f++){const p=ft(f-1,-1,u.length-1),y=ft(f+1,-1,u.length-1),v=u[f],E=u[y],C=u[p].sub(v).unit(),O=E.sub(v).unit(),z=O.angleWithSep(C.x,C.y),F=C.add(O).unit().mult(-1*o/Math.sin(z/2));l.push(v.add(F))}return l},i.aq=Z4,i.ar=Ao,i.as=function(u,o,l=0){return He(((o.x-l)*u.scale-u.x)*Kt,(o.y*u.scale-u.y)*Kt,ht(o.z,o.y))},i.at=In,i.au=en,i.av=bc,i.aw=o4,i.ax=function(u){let o=1/0,l=1/0,f=-1/0,p=-1/0;for(const y of u)o=Math.min(o,y.x),l=Math.min(l,y.y),f=Math.max(f,y.x),p=Math.max(p,y.y);return{min:new Tt(o,l),max:new Tt(f,p)}},i.ay=ke,i.az=H,i.b=function(u){return kr.API_FONTS_REGEX.test(u)},i.b$=at,i.b0=_y,i.b1=nE,i.b2=function(){zl.isLoading()||zl.isLoaded()||Zf()!=="deferred"||sT()},i.b3=Mx,i.b4=En,i.b5=zy,i.b6=no,i.b7=VM,i.b8=zM,i.b9=gn,i.bA=function(u,o){const{x:l,y:f}=u.point,p=jB(l,f,u.worldSize/u._pixelsPerMercatorPixel,0,0);return H(p,p,bM(Fh(o)))},i.bB=T,i.bC=function(u){return u[0]=0,u[1]=0,u[2]=0,u},i.bD=function(u,o){return Math.hypot(o[0]-u[0],o[1]-u[1],o[2]-u[2])},i.bE=sn,i.bF=Mt,i.bG=Vt,i.bH=l1,i.bI=dl,i.bJ=YM,i.bK=function(u,o,l,f,p){const y=5*o+2;u.float32[y+0]=l,u.float32[y+1]=f,u.float32[y+2]=p},i.bL=tE,i.bM=UT,i.bN=Nn,i.bO=ba,i.bP=Pj,i.bQ=b5,i.bR=kj,i.bS=Rj,i.bT=tO,i.bU=$4,i.bV=KM,i.bW=DO,i.bX=ft,i.bY=Cn,i.bZ=function(u,o,l){l*=.5;var f=o[0],p=o[1],y=o[2],v=o[3],E=Math.sin(l),C=Math.cos(l);return u[0]=f*C+p*E,u[1]=p*C-f*E,u[2]=y*C+v*E,u[3]=v*C-y*E,u},i.b_=Mn,i.ba=Ou,i.bb=ag,i.bc=Gc,i.bd=qi,i.be=Kx,i.bf=lO,i.bg=function(u,o){const l=ap(o.zoom);if(l===0)return Fh(u);const f=MT(u),p=xM(f),y=ke(f.getWest())*o.worldSize,v=ke(f.getEast())*o.worldSize,E=Re(f.getNorth())*o.worldSize,C=Re(f.getSouth())*o.worldSize,O=[y,E,0],z=[v,E,0],F=[y,C,0],$=[v,C,0],Y=V([],o.globeMatrix);return Gt(O,O,Y),Gt(z,z,Y),Gt(F,F,Y),Gt($,$,Y),p[0]=Fd(p[0],F,l),p[1]=Fd(p[1],$,l),p[2]=Fd(p[2],z,l),p[3]=Fd(p[3],O,l),Li.fromPoints(p)},i.bh=kT,i.bi=V,i.bj=Zx,i.bk=Fd,i.bl=hy,i.bm=Fl,i.bn=fe,i.bo=G,i.bp=xE,i.bq=VT,i.br=Bc,i.bs=function(u,o){const l=[];for(const f in u)f in o||l.push(f);return l},i.bt=St,i.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bv=pi,i.bw=function(u){var o=new b(16);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o[3]=u[3],o[4]=u[4],o[5]=u[5],o[6]=u[6],o[7]=u[7],o[8]=u[8],o[9]=u[9],o[10]=u[10],o[11]=u[11],o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15],o},i.bx=N,i.by=ue,i.bz=B,i.c=Il,i.c$=function(u){return u({pluginStatus:Us,pluginURL:kh}),ay.on("pluginStateChange",u),u},i.c0=Ar,i.c1=jo,i.c2=function(u,o){return u[0]=-o[0],u[1]=-o[1],u[2]=-o[2],u[3]=o[3],u},i.c3=De,i.c4=function(u,o,l,f,p){var y,v=1/Math.tan(o/2);return u[0]=v/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=v,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,p!=null&&p!==1/0?(u[10]=(p+f)*(y=1/(f-p)),u[14]=2*p*f*y):(u[10]=-1,u[14]=-2*f),u},i.c5=function(u,o,l,f,p,y,v){var E=1/(o-l),C=1/(f-p),O=1/(y-v);return u[0]=-2*E,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*C,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*O,u[11]=0,u[12]=(o+l)*E,u[13]=(p+f)*C,u[14]=(v+y)*O,u[15]=1,u},i.c6=Ie,i.c7=function(u,o,l){u[4*o+0]=l[0],u[4*o+1]=l[1],u[4*o+2]=l[2],u[4*o+3]=l[3]},i.c8=ug,i.c9=_c,i.cA=sE,i.cB=Ne,i.cC=g5,i.cD=function(u){const o=g5(u,!0);return T([],[o[0],o[1],o[4],o[5]])},i.cE=q,i.cF=ip,i.cG=Q,i.cH=function(u){const{x:o,y:l}=u.point,{lng:f,lat:p}=u._center;return jB(o,l,u.worldSize,f,p)},i.cI=rt,i.cJ=me,i.cK=za,i.cL=P,i.cM=function(u,o,l){let f=0;for(let p=0;p<2;++p)u[p]>0&&(f+=(u[p]-0)*(u[p]-0)),o[p]<0&&(f+=(0-o[p])*(0-o[p]));return f},i.cN=45,i.cO=If,i.cP=ze,i.cQ=xy,i.cR=function(u,o,l){const f=Math.sqrt(u*u+o*o+l*l),p=f>0?Math.acos(l/f)*mt:0;let y=u!==0||o!==0?Math.atan2(-o,-u)*mt+90:0;return y<0&&(y+=360),[f,y,p]},i.cS=He,i.cT=tt,i.cU=ct,i.cV=Li,i.cW=hi,i.cX=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},i.cY=ot,i.cZ=mO,i.c_=function(u,o){return u.readFields(aae,{icons:[]},o)},i.ca=cg,i.cb=wo,i.cc=vy,i.cd=le,i.ce=Q4,i.cf=function(){var u=new b(4);return b!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},i.cg=function(u,o,l){var f=o[0],p=o[1],y=o[2],v=o[3],E=Math.sin(l),C=Math.cos(l);return u[0]=f*C+y*E,u[1]=p*C+v*E,u[2]=f*-E+y*C,u[3]=p*-E+v*C,u},i.ch=function(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]&&u[3]===o[3]},i.ci=yt,i.cj=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},i.ck=fa,i.cl=hn,i.cm=xa,i.cn=fg,i.co=_5,i.cp=Ai,i.cq=NB,i.cr=function(u,o,l,f,p,y,v,E,C){if(C.name==="globe")return NB(u,o,new Ai(l,f,p),!1);const O=d1({z:l,x:f,y:p},C);return new Li([(y+O.x/O.scale)*o,o*(O.y/O.scale),v],[(y+O.x2/O.scale)*o,o*(O.y2/O.scale),E])},i.cs=function(u,o,l){return u[0]=Math.min(o[0],l[0]),u[1]=Math.min(o[1],l[1]),u[2]=Math.min(o[2],l[2]),u[3]=Math.min(o[3],l[3]),u},i.ct=function(u,o,l){return u[0]=Math.max(o[0],l[0]),u[1]=Math.max(o[1],l[1]),u[2]=Math.max(o[2],l[2]),u[3]=Math.max(o[3],l[3]),u},i.cu=function(u){const o=Math.round((u+45+360)%360/90)%4;return Me[o]},i.cv=et,i.cw=Vr,i.cx=M,i.cy=function(u){const o=N(new Float64Array(16));H(o,u.pixelMatrix,u.globeMatrix);const l=[0,K,0],f=[0,Z,0];return Gt(l,l,o),Gt(f,f,o),[l[0]>0&&l[0]<=u.width&&l[1]>0&&l[1]<=u.height&&!SM(u,new le(u.center.lat,90)),f[0]>0&&f[0]<=u.width&&f[1]>0&&f[1]<=u.height&&!SM(u,new le(u.center.lat,-90))]},i.cz=function(u,o){const{scale:l}=u.tileTransform,f=l*Kt/(u.tileSize*Math.pow(2,o.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return function(p,y,v){var E=y[1],C=y[2],O=y[3],z=v[0],F=v[1];return p[0]=y[0]*z,p[1]=E*z,p[2]=C*F,p[3]=O*F,p}(new Float32Array(4),o.inverseAdjustmentMatrix,[f,f])},i.d=function(u){return kr.API_TILEJSON_REGEX.test(u)},i.d$=Wx,i.d0=dE,i.d1=Ay,i.d2=QM,i.d3=Hn,i.d4=Id,i.d5=Pa,i.d6=ds,i.d7=pr,i.d8=function(u){const o=u.indexOf(ng);return o>=0?u.slice(0,o):u},i.d9=function(u){return u.indexOf(ng)>=0},i.dA=BB,i.dB=ga,i.dC=ma,i.dD=256,i.dE=function(u,o){const l=[0,0,0];return Gt(l,l,kT(Fh(o.canonical))),Gt(l,l,u),l},i.dF=u=>({u_camera_to_center_distance:new wo(u),u_extrude_scale:new Nl(u),u_device_pixel_ratio:new wo(u),u_matrix:new ug(u),u_inv_rot_matrix:new ug(u),u_merc_center:new _c(u),u_tile_id:new cg(u),u_zoom_transition:new wo(u),u_up_dir:new cg(u),u_emissive_strength:new wo(u)}),i.dG=u=>({u_matrix:new ug(u),u_pixels_to_tile_units:new Nl(u),u_device_pixel_ratio:new wo(u),u_width_scale:new wo(u),u_floor_width_scale:new wo(u),u_units_to_pixels:new _c(u),u_dash_image:new vy(u),u_gradient_image:new vy(u),u_image_height:new wo(u),u_texsize:new _c(u),u_tile_units_to_pixels:new wo(u),u_alpha_discard_threshold:new wo(u),u_trim_offset:new _c(u),u_trim_fade_range:new _c(u),u_trim_color:new xy(u),u_emissive_strength:new wo(u),u_zbias_factor:new wo(u),u_tile_to_meter:new wo(u),u_ground_shadow_factor:new cg(u)}),i.dH=u=>({u_matrix:new ug(u),u_texsize:new _c(u),u_pixels_to_tile_units:new Nl(u),u_device_pixel_ratio:new wo(u),u_width_scale:new wo(u),u_floor_width_scale:new wo(u),u_image:new vy(u),u_units_to_pixels:new _c(u),u_tile_units_to_pixels:new wo(u),u_alpha_discard_threshold:new wo(u),u_trim_offset:new _c(u),u_trim_fade_range:new _c(u),u_trim_color:new xy(u),u_emissive_strength:new wo(u),u_zbias_factor:new wo(u),u_tile_to_meter:new wo(u),u_ground_shadow_factor:new cg(u),u_pattern_transition:new wo(u)}),i.dI=ig,i.dJ=hoe,i.dK=VB,i.dL=(u,o,l,f,p,y)=>{const v=u.transform,E=v.projection.name==="globe";let C;if(y.paint.get("circle-pitch-alignment")==="map")if(E){const z=BB(v.zoom,o.canonical)*v._pixelsPerMercatorPixel;C=Float32Array.from([z,0,0,z])}else C=v.calculatePixelsToTileUnitsMatrix(l);else C=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(v.projection),u_matrix:u.translatePosMatrix(o.projMatrix,l,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Mo.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:aie,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:y.paint.get("circle-emissive-strength")};if(E){O.u_inv_rot_matrix=f,O.u_merc_center=p,O.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],O.u_zoom_transition=ap(v.zoom);const z=p[0]*Kt,F=p[1]*Kt;O.u_up_dir=v.projection.upVector(new Ai(0,0,0),z,F)}return O},i.dM=c4,i.dN=ka,i.dO=(u,o,l,f,p,y,v,E,C,O)=>{const z=u.transform,F=z.pitch<15?a4(.07,.7,$e((14-z.zoom)/5,0,1)):.07,$=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:l4(u,o,l,f),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:z.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:p,u_width_scale:y,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:s4(o,z),u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor($?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:tt(o.tileID.canonical,0),u_ground_shadow_factor:C,u_pattern_transition:O}},i.dP=(u,o,l,f,p,y,v,E,C,O)=>{const z=u.transform,F=z.calculatePixelsToTileUnitsMatrix(o),$=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",Y=z.pitch<15?a4(.07,.7,$e((14-z.zoom)/5,0,1)):.07;return{u_matrix:l4(u,o,l,f),u_pixels_to_tile_units:F,u_device_pixel_ratio:y,u_width_scale:v,u_floor_width_scale:E,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:u4(l)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:s4(o,u.transform),u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor($?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:Y,u_tile_to_meter:tt(o.tileID.canonical,0),u_ground_shadow_factor:O}},i.dQ=pn,i.dR=Xx,i.dS=ht,i.dT=Hj,i.dU=xc,i.dV=$T,i.dW=cp,i.dX=450,i.dY=7,i.dZ=Woe,i.d_=zr,i.da=function(u){const o=u.lastIndexOf(ng);return o>=0?u.slice(o+1):""},i.db=function(u){const o=[],l=u.id;return l===void 0&&o.push({message:`layers.${l}: missing required property "id"`}),u.render===void 0&&o.push({message:`layers.${l}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},i.dc=function(u,o,l,f){return u.type==="custom"?new Goe(u,o):new nae[u.type](u,o,l,f)},i.dd=or,i.de=function(u){const o=u.indexOf(ng);return o>=0?u.slice(o+1):""},i.df=class extends zy{constructor(u,o){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},i.dg=ay,i.dh=bu,i.di=CT,i.dj=class extends Wc{constructor(u){super(u),this.current=IT}set(u,o,l){if(this.fetchUniformLocation(u,o)){for(let f=0;f<9;f++)if(l[f]!==this.current[f]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},i.dk=We,i.dl=function(u,o,l){const f=ap(l.zoom),p=u.style.map._antialias,y=u.terrain&&u.terrain.exaggeration()>0;return f===0&&!p&&!y},i.dm=function(u){const o=u.pixelsPerMeter,l=o/Ie(1,u.center.lat),f=N(new Float64Array(16));return G(f,f,[u.point.x,u.point.y,0]),q(f,f,[l,l,o]),Float32Array.from(f)},i.dn=MT,i.dp=function(u){const o=et-5;u=$e(u,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(ae(u))),3);return Math.round(l*(W.length-1))},i.dq=function(u,o,l,f){const p=o.getNorth(),y=o.getSouth(),v=o.getWest(),E=o.getEast(),C=1<<u.z,O=E-v,z=p-y,F=O/j,$=-z/W[l],Y=[0,F,0,$,0,0,p,v,0];if(u.z>0){const J=180/f;R(Y,Y,[J/O+1,0,0,0,J/z+1,0,-.5*J/F,.5*J/$,1])}return Y[2]=C,Y[5]=u.x,Y[8]=u.y,Y},i.dr=Fh,i.ds=function(u,o,l){const f=N(new Float64Array(16)),p=(o/(1<<u)-.5)*Math.PI*2;return te(f,l.globeMatrix,p),Float32Array.from(f)},i.dt=class{isDataAvailableAtPoint(u){const o=this._source();if(this.isUsingMockSource()||!o||u.y<0||u.y>1)return!1;const l=o.getSource().maxzoom,f=1<<l,p=Math.floor(u.x),y=Math.floor((u.x-p)*f),v=Math.floor(u.y*f),E=this.findDEMTileFor(new mo(l,p,l,y,v));return!(!E||!E.dem)}getAtPointOrZero(u,o=0){return this.getAtPoint(u,o)||0}getAtPoint(u,o,l=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const f=this._source();if(!f||u.y<0||u.y>1)return o;const p=f.getSource().maxzoom,y=1<<p,v=Math.floor(u.x),E=u.x-v,C=new mo(p,v,p,Math.floor(E*y),Math.floor(u.y*y)),O=this.findDEMTileFor(C);if(!O||!O.dem)return o;const z=O.dem,F=1<<O.tileID.canonical.z,$=(E*F-O.tileID.canonical.x)*z.dim,Y=(u.y*F-O.tileID.canonical.y)*z.dim,J=Math.floor($),re=Math.floor(Y);return(l?this.exaggeration():1)*kn(kn(z.get(J,re),z.get(J,re+1),Y-re),kn(z.get(J+1,re),z.get(J+1,re+1),Y-re),$-J)}getAtTileOffset(u,o,l){const f=1<<u.canonical.z;return this.getAtPointOrZero(new dt(u.wrap+(u.canonical.x+o/Kt)/f,(u.canonical.y+l/Kt)/f))}getAtTileOffsetFunc(u,o,l,f){return p=>{const y=this.getAtTileOffset(u,p.x,p.y),v=f.upVector(u.canonical,p.x,p.y);return at(v,v,y*f.upVectorScale(u.canonical,o,l).metersToTile),v}}getForTilePoints(u,o,l,f){if(this.isUsingMockSource())return!1;const p=My.create(this,u,f);return!!p&&(o.forEach(y=>{y[2]=this.exaggeration()*p.getElevationAt(y[0],y[1],l)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(u);if(!o||!o.dem)return null;const l=o.dem.tree,f=o.tileID,p=1<<u.canonical.z-f.canonical.z;let y=u.canonical.x/p-f.canonical.x,v=u.canonical.y/p-f.canonical.y,E=0;for(let C=0;C<u.canonical.z-f.canonical.z&&!l.leaves[E];C++){y*=2,v*=2;const O=2*Math.floor(v)+Math.floor(y);E=l.childOffsets[E]+O,y%=1,v%=1}return{min:this.exaggeration()*l.minimums[E],max:this.exaggeration()*l.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let o=!1,l=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const p of u){const y=this.getMinMaxForTile(p.tileID);y&&(l=Math.min(l,y.min),f=Math.max(f,y.max),o=!0)}return o?{min:l,max:f}:null}},i.du=QB,i.dv=op,i.dw=function(u,o){return[Math.pow(u[0],2.2)*o,Math.pow(u[1],2.2)*o,Math.pow(u[2],2.2)*o]},i.dx=A,i.dy=function(u,o){var l=Math.sin(o),f=Math.cos(o);return u[0]=f,u[1]=l,u[2]=0,u[3]=-l,u[4]=f,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},i.dz=Tn,i.e=kr,i.e$=v$,i.e0=256,i.e1=bM,i.e2=Uc,i.e3=te,i.e4=function(u,o){return u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[4],u[4]=o[5],u[5]=o[6],u[6]=o[8],u[7]=o[9],u[8]=o[10],u},i.e5=zh,i.e6=og,i.e7=function(u,o,l,f,p){return $e((u-o)/(l-o)*(p-f)+f,f,p)},i.e8=_n,i.e9=function(u,o){var l=o[0],f=o[1],p=o[2],y=o[3],v=o[4],E=o[5],C=o[6],O=o[7],z=o[8],F=z*v-E*O,$=-z*y+E*C,Y=O*y-v*C,J=l*F+f*$+p*Y;return J?(u[0]=F*(J=1/J),u[1]=(-z*f+p*O)*J,u[2]=(E*f-p*v)*J,u[3]=$*J,u[4]=(z*l-p*C)*J,u[5]=(-E*l+p*y)*J,u[6]=Y*J,u[7]=(-O*l+f*C)*J,u[8]=(v*l-f*y)*J,u):null},i.eA=function(u,o,l){return u[0]=o[0]/l[0],u[1]=o[1]/l[1],u[2]=o[2]/l[2],u},i.eB=Kn,i.eC=se,i.eD=rn,i.eE=function(u,o,l,f){return u[0]=o,u[1]=l,u[2]=f,u},i.eF=function([u,o,l]){const f=Math.hypot(u,o,l),p=Math.atan2(u,l),y=.5*Math.PI-Math.acos(-o/f);return new le(me(p),me(y))},i.eG=it,i.eH=fO,i.eI=function(u){const o=u.navigator?u.navigator.userAgent:null;return!!function(l){if(vo==null){const f=l.navigator?l.navigator.userAgent:null;vo=!!l.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return vo}(u)&&!(!o||!(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eJ=function(u,o){ro=u,Ia=o},i.eK=SM,i.eL=$B,i.eM=function(u){const o=[0,0,0],l=N(new Float64Array(16));return H(l,u.pixelMatrix,u.globeMatrix),Gt(o,o,l),new Tt(o[0],o[1])},i.eN=function(u,o,l=!1){if(Us===Ax||Us===Px||Us===Cx)throw new Error("setRTLTextPlugin cannot be called multiple times.");kh=Mo.resolveURL(u),Us=Ax,Ix=o,oy(),l||sT()},i.eO=Zf,i.eP=function(){dE().acquire(xO)},i.eQ=function(){const u=x1;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(xO),x1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.eR=wg,i.eS=function(u){const o=_u();if(!o)return;const l=o.delete(Ca);u&&l.then(()=>u()).catch(u)},i.eT=v1,i.eU=c$,i.eV=function(u){MO=Mo.resolveURL(u),Ly||(Ly=new Oy(dE(),new ol)),Ly.broadcast("setDracoUrl",MO)},i.eW=u$,i.eX=function(u){Dy=Mo.resolveURL(u),Ly||(Ly=new Oy(dE(),new ol)),Ly.broadcast("setMeshoptUrl",Dy)},i.eY=dn,i.eZ=sp,i.e_=Lu,i.ea=YS,i.eb=un,i.ec=wt,i.ed=class{constructor(u,o,l,f){this.context=u,this.format=f,this.size=l,this.texture=u.gl.createTexture();const[p,y,v]=this.size,{gl:E}=u;E.bindTexture(E.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,p,y,v,0,cO(this.format),uO(this.format),o.data)}bind(u,o){const{context:l}=this,{gl:f}=l;f.bindTexture(f.TEXTURE_3D,this.texture),u!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,u),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,u),this.minFilter=u),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},i.ee=function(u,o){if(u===o){var l=o[1],f=o[2],p=o[3],y=o[6],v=o[7],E=o[11];u[1]=o[4],u[2]=o[8],u[3]=o[12],u[4]=l,u[6]=o[9],u[7]=o[13],u[8]=f,u[9]=y,u[11]=o[14],u[12]=p,u[13]=v,u[14]=E}else u[0]=o[0],u[1]=o[4],u[2]=o[8],u[3]=o[12],u[4]=o[1],u[5]=o[5],u[6]=o[9],u[7]=o[13],u[8]=o[2],u[9]=o[6],u[10]=o[10],u[11]=o[14],u[12]=o[3],u[13]=o[7],u[14]=o[11],u[15]=o[15];return u},i.ef=pO,i.eg=Fe,i.eh=[1,1,1],i.ei=function(u,o,l,f){var p=new b(4);return p[0]=u,p[1]=o,p[2]=l,p[3]=f,p},i.ej=_r,i.ek=function(u,o,l,f){var p=o[0],y=o[1],v=o[2],E=o[3];return u[0]=p+f*(l[0]-p),u[1]=y+f*(l[1]-y),u[2]=v+f*(l[2]-v),u[3]=E+f*(l[3]-E),u},i.el=My,i.em=Iy,i.en=Lh,i.eo=Ld,i.ep=function(u,o,l,f,p,y,v,E,C,O,z,F,$,Y,J,re){var ce=new b(16);return ce[0]=u,ce[1]=o,ce[2]=l,ce[3]=f,ce[4]=p,ce[5]=y,ce[6]=v,ce[7]=E,ce[8]=C,ce[9]=O,ce[10]=z,ce[11]=F,ce[12]=$,ce[13]=Y,ce[14]=J,ce[15]=re,ce},i.eq=oe,i.er=my,i.es=Ux,i.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Tt(1/0,1/0),max:new Tt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,o=!1){const l=Ij(new Tt(0,0),new Tt(Kt,Kt),u),f=[];if(o&&!FM(l,this._globalClipBounds))return f;for(const p of this._activeRegions){if(p.hiddenByOverlap||!FM(l,p))continue;const y=Nie(p.min,p.max,u);f.push({min:y.min,max:y.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return f}setSources(u){this._setSources(u.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const l=[];for(const f of o.cache.getVisibleCoordinates()){const p=o.cache.getTile(f).buckets[o.layer];p&&p.updateFootprints(f.toUnwrapped(),l)}return l},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(u){const o=u.getFootprints();if(o.length===0)return;const l=u.getOrder(),f=u.getClipMask(),p=u.getClipScope();for(const y of o){if(!y.footprint)continue;const v=Ij(y.footprint.min,y.footprint.max,y.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:y.id,footprint:y.footprint,order:l,clipMask:f,clipScope:p})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,l)=>o.priority-l.priority||BT(o.min,l.min)||BT(o.max,l.max)||o.order-l.order||o.clipMask-l.clipMask||function(f,p){const y=(v,E)=>v+E;return f.length-p.length||f.reduce(y,"").localeCompare(p.reduce(y,""))}(o.clipScope,l.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let o=0;for(;!u&&o!==this._activeRegions.length;){const l=this._activeRegions[o],f=this._prevRegions[o];u=l.priority!==f.priority||!Cj(l,f)||l.order!==f.order||l.clipMask!==f.clipMask||!pi(l.clipScope,f.clipScope),++o}}if(u){++this._updateTime;for(const l of this._activeRegions)l.order!==FT&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const o=l=>{const f=this._activeRegions;if(l>=f.length)return l;const p=f[l].priority;for(;l<f.length&&f[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,f=o(l);for(;l!==f;){let p=l;const y=l;for(;p!==f;){const v=this._activeRegions[p];v.hiddenByOverlap=!1;for(let E=0;E<y;E++){const C=this._activeRegions[E];if(!C.hiddenByOverlap&&v.order===FT&&FM(v,C)&&(v.hiddenByOverlap=Oj(v.footprint,v.tileId,C.footprint,C.tileId),v.hiddenByOverlap))break}++p}l=f,f=o(l)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=u.length-1;o>=0;o--)this._addSource(u[o]);this._computeReplacement()}},i.eu=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,o){const l=new Ou,f=new ia,p=[],y=u+1+2,v=o[0]+1,E=o[0]+1+(1+o.length),C=(O,z,F)=>{let $=O===y-1?O-2:O===0?O:O-1;return $+=F?24575:0,[$,z]};for(let O=0;O<y;++O)l.emplaceBack(...C(O,0,!0));for(let O=0;O<v;++O)for(let z=0;z<y;++z)l.emplaceBack(...C(z,O,(z===0||z===y-1)&&!0));for(let O=0;O<o.length;++O){const z=o[O];for(let F=0;F<y;++F)l.emplaceBack(...C(F,z,!0))}for(let O=0;O<o.length;++O){const z=f.length,F=o[O]+1+2,$=new ia;for(let re=0;re<F-1;re++){const ce=re===F-2,de=ce?y*(E-o.length+O-re):y;for(let we=0;we<y-1;we++){const ve=re*y+we;re===0||ce||we===0||we===y-2?($.emplaceBack(ve+1,ve,ve+de),$.emplaceBack(ve+de,ve+de+1,ve+1)):(f.emplaceBack(ve+1,ve,ve+de),f.emplaceBack(ve+de,ve+de+1,ve+1))}}const Y=qi.simpleSegment(0,z,l.length,f.length-z);for(let re=0;re<$.uint16.length;re+=3)f.emplaceBack($.uint16[re],$.uint16[re+1],$.uint16[re+2]);const J=qi.simpleSegment(0,z,l.length,f.length-z);p.push({withoutSkirts:Y,withSkirts:J})}return{vertices:l,indices:f,segments:p}}_createGrid(u){const o=this._fillGridMeshWithLods(j,W);this._gridSegments=o.segments,this._gridBuffer=u.createVertexBuffer(o.vertices,Gc.members),this._gridIndexBuffer=u.createIndexBuffer(o.indices,!0)}_createPoles(u){const o=new ia;for(let v=0;v<=j;v++)o.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=u.createIndexBuffer(o,!0);const l=new zh,f=new zh,p=new zh,y=new zh;this._poleSegments=[];for(let v=0,E=0;v<P;v++){const C=360/(1<<v);l.emplaceBack(0,-S,0,.5,0),f.emplaceBack(0,-S,0,.5,1),p.emplaceBack(0,-S,0,.5,.5),y.emplaceBack(0,-S,0,.5,.5);for(let O=0;O<=j;O++){let z=O/j,F=0;const $=kn(0,C,z),[Y,J,re]=ee(iie,oie,$,S);l.emplaceBack(Y,J,re,z,F),f.emplaceBack(Y,J,re,z,1-F);const ce=ae($);z=.5+.5*Math.sin(ce),F=.5+.5*Math.cos(ce),p.emplaceBack(Y,J,re,z,F),y.emplaceBack(Y,J,re,z,1-F)}this._poleSegments.push(qi.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(l,Vs,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(f,Vs,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(p,Vs,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(y,Vs,!1)}getGridBuffers(u,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},i.ev=FT,i.ew=je,i.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.ey=Xe,i.ez=qt,i.f=function(u){return u.indexOf("mapbox:")===0},i.f0=x$,i.f1=n4,i.f2=mg,i.f3="hd_road_elevation",i.f4=RM,i.f5=er,i.f6=_g,i.f7=JM,i.f8=vg,i.f9=function(u,o,l,f,p,y,v,E=1,C,O){u.createArrays(),u.tilePixelRatio=Kt/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const z=u.layers[0].layout,F=u.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=E,$.textSizeScaleRange=z.get("text-size-scale-range"),$.iconSizeScaleRange=z.get("icon-size-scale-range");const[Y,J]=$.textSizeScaleRange,[re,ce]=$.iconSizeScaleRange;$.textScaleFactor=$e($.scaleFactor,Y,J),$.iconScaleFactor=$e($.scaleFactor,re,ce);const de=F["text-size"],we=F["icon-size"];if(u.textSizeData.kind==="composite"){const{minZoom:Ue,maxZoom:qe}=u.textSizeData;$.compositeTextSizes=[de.possiblyEvaluate(new ii(Ue),y),de.possiblyEvaluate(new ii(qe),y)]}if(u.iconSizeData.kind==="composite"){const{minZoom:Ue,maxZoom:qe}=u.iconSizeData;$.compositeIconSizes=[we.possiblyEvaluate(new ii(Ue),y),we.possiblyEvaluate(new ii(qe),y)]}$.layoutTextSize=de.possiblyEvaluate(new ii(v+1),y),$.layoutIconSize=we.possiblyEvaluate(new ii(v+1),y),$.textMaxSize=de.possiblyEvaluate(new ii(18),y);const ve=z.get("symbol-placement"),ie=z.get("text-rotation-alignment")==="map"&&ve!=="point",ge=z.get("text-size");let be=!1;const Ee=[];for(const Ue of u.features){const qe=z.get("text-font").evaluate(Ue,{},y).join(","),Ke=ge.evaluate(Ue,{},y)*$.textScaleFactor,Qe=$.layoutTextSize.evaluate(Ue,{},y)*$.textScaleFactor,xt=$.layoutIconSize.evaluate(Ue,{},y)*$.iconScaleFactor,Dt={horizontal:{},vertical:void 0},Ct=Ue.text;let kt,Bt=[0,0];if(Ct){const xn=Ct.toString(),Vn=z.get("text-letter-spacing").evaluate(Ue,{},y)*ba,nr=z.get("text-line-height").evaluate(Ue,{},y)*ba,rr=aM(xn)?Vn:0,gr=z.get("text-anchor").evaluate(Ue,{},y),ur=z.get("text-variable-anchor");if(!ur){const Ae=z.get("text-radial-offset").evaluate(Ue,{},y);if(Ae)Bt=$4(gr,[Ae*ba,eO]);else{const bt=z.get("text-offset").evaluate(Ue,{},y);Bt=[bt[0]*ba,bt[1]*ba]}}let lr=ie?"center":z.get("text-justify").evaluate(Ue,{},y);const di=ve==="point",Pi=di?z.get("text-max-width").evaluate(Ue,{},y)*ba:1/0,Se=Ae=>{u.allowVerticalPlacement&&Ex(xn)&&(Dt.vertical=XM(Ct,o,l,p,qe,Pi,nr,gr,Ae,rr,Bt,dl.vertical,!0,Qe,Ke,C))};if(!ie&&ur){const Ae=lr==="auto"?ur.map(Xt=>tO(Xt)):[lr];let bt=!1;for(let Xt=0;Xt<Ae.length;Xt++){const tn=Ae[Xt];if(!Dt.horizontal[tn])if(bt)Dt.horizontal[tn]=Dt.horizontal[0];else{const Qt=XM(Ct,o,l,p,qe,Pi,nr,"center",tn,rr,Bt,dl.horizontal,!1,Qe,Ke,C);Qt&&(Dt.horizontal[tn]=Qt,bt=Qt.positionedLines.length===1)}}Se("left")}else{if(lr==="auto"&&(lr=tO(gr)),di||z.get("text-writing-mode").indexOf("horizontal")>=0||!Ex(xn)){const Ae=XM(Ct,o,l,p,qe,Pi,nr,gr,lr,rr,Bt,dl.horizontal,!1,Qe,Ke,C);Ae&&(Dt.horizontal[lr]=Ae)}Se(di?"left":lr)}}let _t,Ot,pt,vt,Ut,Wt,Sn,mn=!1;if(Ue.icon&&Ue.icon.hasPrimary()){const xn=V4(Ue.icon,u.iconSizeData,F["icon-size"],y,u.zoom,Ue,C,$.iconScaleFactor);_t=xn.iconPrimary,pt=xn.iconSecondary;const Vn=_t.toString();if(Ot=f.get(Vn),Ot&&(Ut=z.get("icon-offset").evaluate(Ue,{},y),Wt=z.get("icon-anchor").evaluate(Ue,{},y),Sn=z.get("icon-text-fit").evaluate(Ue,{},y),kt=boe(p.get(Vn),pt?p.get(pt.toString()):void 0,Ut,Wt),mn=Ot.sdf,u.sdfIcons===void 0?u.sdfIcons=Ot.sdf:u.sdfIcons!==Ot.sdf&&mr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ot.pixelRatio!==u.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0)),pt){const nr=pt.toString();vt=f.get(nr)}}be=be||!(!Ue.icon||!Ue.icon.hasSecondary());const Jt=nO(Dt.horizontal)||Dt.vertical;u.iconsInText||(u.iconsInText=!!Jt&&Jt.iconsInText);const $t=Qe*$.textScaleFactor/ba,{defaultShapedIcon:qn,verticallyShapedIcon:vn}=Moe(u,kt,z,Ue,y,Dt,$t,Ut,Sn);Sn!=="none"&&kt&&(E4(kt)||A4(kt))&&(ZT(0,Ot,_t,kt,qn,Sn,O,f,p),ZT(0,vt,pt,kt,qn,Sn,O,f,p),vn&&(ZT(0,Ot,_t,kt,vn,Sn,O,f,p),ZT(0,vt,pt,kt,vn,Sn,O,f,p))),kt=qn,Ee.push({feature:Ue,shapedTextOrientations:Dt,shapedText:Jt,shapedIcon:kt,iconPrimary:_t,iconSecondary:pt,iconOffset:Ut,iconAnchor:Wt,verticallyShapedIcon:vn,layoutTextSize:Qe,layoutIconSize:xt,textOffset:Bt,isSDFIcon:mn,iconTextFit:Sn})}return{featureData:Ee,sizes:$,hasAnySecondaryIcon:be,textAlongLine:ie,symbolPlacement:ve}},i.fa=L4,i.fb=function(u,o,l,f,p,y,v,E,C,O){const{featureData:z,hasAnySecondaryIcon:F,sizes:$,textAlongLine:Y,symbolPlacement:J}=o;for(const re of z){const{shapedIcon:ce,verticallyShapedIcon:de,feature:we,shapedTextOrientations:ve,shapedText:ie,layoutTextSize:ge,textOffset:be,isSDFIcon:Ee,iconPrimary:Ue,iconSecondary:qe,iconTextFit:Ke,iconOffset:Qe}=re;W4(ce,O.iconPositions,Ue,qe),W4(de,O.iconPositions,Ue,qe),Ioe(ve,O.iconPositions),(ie||ce)&&Ooe(u,we,ve,ce,de,C,$,ge,0,be,Ee,f,p,v,E,F,Ke,Qe,Y,J)}l&&u.generateCollisionDebugBuffers(y,u.collisionBoxArray,$.textScaleFactor)},i.fc=lp,i.fd=vE,i.fe=Cl,i.ff=dj,i.fg=g4,i.fh=Qa,i.fi=function(u){let o=0;if(new Uint32Array(u,0,1)[0]!==d$){const l=new Uint32Array(u,0,7),[,,f,p,y,v]=l;o=l.byteLength+p+y+v+y,(f!==u.byteLength||o>=u.byteLength)&&mr("Invalid b3dm header information.")}return g$(u,o)},i.fj=function(u,o){const l=y$(u);for(const f of l){for(const p of f.meshes)ase(p);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(sse(f.lights,o)))}return l},i.fk=hE,i.fl=mi,i.fm=k5,i.fn=zl,i.fo=function(u){il(),Va!=null&&Va.then(o=>{o.keys().then(l=>{for(let f=0;f<l.length-u;f++)o.delete(l[f]).catch(p=>mr(p.message))}).catch(l=>mr(l.message))}).catch(o=>mr(o.message))},i.g=function(u,o){return bu(ut(u,{method:"GET"}),o)},i.h=Gi,i.i=function(u){return kr.API_STYLE_REGEX.test(u)&&!Il(u)},i.j=function(u){return decodeURIComponent(atob(u).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(o,l)=>String.fromCharCode(+("0x"+l))))},i.l=ut,i.m=_h,i.n=function(u,o){return bu(ut(u,{type:"json"}),o)},i.o=kl,i.p=function(u,o){return bu(ut(u,{method:"POST"}),o)},i.q=Mo,i.r=Ha,i.s=function(u){try{const o=self[u];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=gh,i.u=function(){return function u(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},i.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},i.w=mr,i.x=function(){return bO||(bO=new wg),bO},i.y=AO,i.z=Ei}),c(["./shared"],function(i){function _(mt){const ae=mt?mt.url.toString():void 0;return ae?performance.getEntriesByName(ae):[]}function b(mt){if(typeof mt=="number"||typeof mt=="boolean"||typeof mt=="string"||mt==null)return JSON.stringify(mt);if(Array.isArray(mt)){let me="[";for(const Me of mt)me+=`${b(Me)},`;return`${me}]`}let ae="{";for(const me of Object.keys(mt).sort())ae+=`${me}:${b(mt[me])},`;return`${ae}}`}function T(mt){let ae="";for(const me of i.bu)(mt.type!=="model"||me!=="minzoom"&&me!=="maxzoom")&&(ae+=`/${b(mt[me])}`);return ae}class A{constructor(ae){this.keyCache={},this._layers={},this._layerConfigs={},ae&&this.replace(ae)}replace(ae,me){this._layerConfigs={},this._layers={},this.update(ae,[],me)}update(ae,me,Me){this._options=Me;for(const je of ae)this._layerConfigs[je.id]=je,(this._layers[je.id]=i.dc(je,this.scope,null,this._options)).compileFilter(Me),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of me)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const We=function(je,Xe){const $e={};for(let ft=0;ft<je.length;ft++){const St=je[ft];let ut=Xe&&Xe[St.id];ut||(St.type==="symbol"?ut=St.id:(ut=T(St),St.type==="line"&&St.paint&&function an(pn){return typeof pn=="string"&&pn==="line-progress"||(Array.isArray(pn)?pn.some(an):!(!pn||typeof pn!="object")&&Object.values(pn).some(an))}(St.paint["line-width"])&&(ut+=`/${b(St.paint["line-width"])}`))),Xe&&(Xe[St.id]=ut);let Yt=$e[ut];Yt||(Yt=$e[ut]=[]),Yt.push(St)}const Ye=[];for(const ft in $e)Ye.push($e[ft]);return Ye}(Object.values(this._layerConfigs),this.keyCache);for(const je of We){const Xe=je.map(Yt=>this._layers[Yt.id]),$e=Xe[0];if($e.visibility==="none")continue;const Ye=$e.source||"";let ft=this.familiesBySource[Ye];ft||(ft=this.familiesBySource[Ye]={});const St=$e.sourceLayer||"_geojsonTileLayer";let ut=ft[St];ut||(ut=ft[St]=[]),ut.push(Xe)}}}const k=1*i.e_;class R{constructor(ae){const me={},Me=[];for(const $e in ae){const Ye=ae[$e],ft=me[$e]={};for(const St in Ye.glyphs){const ut=Ye.glyphs[+St];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Yt=ut.metrics.localGlyph?k:1,an={x:0,y:0,w:ut.bitmap.width+2*Yt,h:ut.bitmap.height+2*Yt};Me.push(an),ft[St]=an}}const{w:We,h:je}=i.H(Me),Xe=new i.eZ({width:We||1,height:je||1});for(const $e in ae){const Ye=ae[$e];for(const ft in Ye.glyphs){const St=Ye.glyphs[+ft];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const ut=me[$e][ft],Yt=St.metrics.localGlyph?k:1;i.eZ.copy(St.bitmap,Xe,{x:0,y:0},{x:ut.x+Yt,y:ut.y+Yt},St.bitmap)}}this.image=Xe,this.positions=me}}i.eY(R,"GlyphAtlas");class B{constructor(ae){this.tileID=new i.aM(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.lut=ae.lut,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.scope=ae.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.request&&ae.request.collectResourceTiming,this.promoteId=ae.promoteId,this.isSymbolTile=ae.isSymbolTile,this.tileTransform=i.aW(ae.tileID.canonical,ae.projection),this.projection=ae.projection,this.worldview=ae.worldview,this.localizableLayerIds=ae.localizableLayerIds,this.brightness=ae.brightness,this.extraShadowCaster=!!ae.extraShadowCaster,this.tessellationStep=ae.tessellationStep,this.scaleFactor=ae.scaleFactor}parse(ae,me,Me,We,je,Xe){this.status="parsing",this.data=ae,this.collisionBoxArray=new i.b0;const $e=new i.e$(Object.keys(ae.layers).sort()),Ye=new i.f0(this.tileID,this.promoteId);Ye.bucketLayerIDs=[];const ft={},St=new i.f1(256,256),ut={featureIndex:Ye,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:St,availableImages:Me,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Yt=me.familiesBySource[this.source];for(const Cr in Yt){const hi=ae.layers[Cr];if(!hi)continue;let mi=!1,no=!1,vo=!1;for(const ma of Yt[Cr])ma[0].type==="symbol"?mi=!0:no=!0,ma[0].is3D()&&ma[0].type!=="model"&&(vo=!0);if(this.extraShadowCaster&&!vo||this.isSymbolTile===!0&&!mi||this.isSymbolTile===!1&&!no)continue;hi.version===1&&i.w(`Vector tile source "${this.source}" layer "${Cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const jo=$e.encode(Cr),$o=[];let Cs=!1;for(let ma=0,ga=0;ma<hi.length;ma++){const xo=hi.feature(ma),kr=Ye.getId(xo,Cr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Cr)){const Gi=xo.properties?xo.properties.worldview:null;if(this.worldview&&typeof Gi=="string")if(Gi==="all")xo.properties.$localized=!0;else{if(!Gi.split(",").includes(this.worldview))continue;xo.properties.$localized=!0,xo.properties.worldview=this.worldview}}!Cs&&xo.properties&&xo.properties.hasOwnProperty(i.f2)&&(Cs=!0),$o.push({feature:xo,id:kr,index:ga,sourceLayerIndex:jo}),ga++}Cs&&!ut.elevationFeatures&&ae.layers.hasOwnProperty(i.f3)&&(ut.elevationFeatures=i.f4.parseFrom(ae.layers[i.f3],this.canonical));for(const ma of Yt[Cr]){const ga=ma[0];(!this.extraShadowCaster||ga.is3D()&&ga.type!=="model")&&(this.isSymbolTile!==void 0&&ga.type==="symbol"!==this.isSymbolTile||ga.minzoom&&this.zoom<Math.floor(ga.minzoom)||ga.maxzoom&&this.zoom>=ga.maxzoom||ga.visibility!=="none"&&(N(ma,this.zoom,ut.brightness,Me),(ft[ga.id]=ga.createBucket({index:Ye.bucketLayerIDs.length,layers:ma,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:jo,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:We})).populate($o,ut,this.tileID.canonical,this.tileTransform),Ye.bucketLayerIDs.push(ma.map(xo=>i.C(xo.id,xo.scope)))))}}let an,pn,Zn,er,or,pr;St.trim();const Wi={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},mr=()=>{if(an)return this.status="done",Xe(an);if(this.extraShadowCaster)this.status="done",Xe(null,{buckets:Object.values(ft).filter(Cr=>!Cr.isEmpty()),featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ut.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(pn&&Zn&&er){const Cr=new R(pn),hi=new Map;for(const[vo,jo]of Zn.entries()){const{imagePosition:$o}=i.f7(vo,jo,i.f8);hi.set(vo,$o)}const mi={};for(const vo in ft){const jo=ft[vo];jo instanceof i.b1&&(N(jo.layers,this.zoom,ut.brightness,Me),mi[vo]=i.f9(jo,pn,Cr.positions,Zn,hi,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,or))}const no={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(je,Zn,or,()=>{no.iconsPending=!1,ui(mi,Cr,no)}),this.rasterizeIfNeeded(je,er,pr,()=>{no.patternsPending=!1,ui(mi,Cr,no)})}},ui=(Cr,hi,mi,no)=>{if(mi.iconsPending||mi.patternsPending)return;const vo=new i.fa(Zn,er,this.lut);for(const jo in ft){const $o=ft[jo];if(jo in Cr)i.fb($o,Cr[jo],this.showCollisionBoxes,Me,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Zn,vo);else if($o.hasPattern&&($o instanceof i.b7||$o instanceof i.b8||$o instanceof i.dV)){N($o.layers,this.zoom,ut.brightness,Me);const Cs=Object.fromEntries(vo.patternPositions);$o.addFeatures(ut,this.tileID.canonical,Cs,Me,this.tileTransform,this.brightness)}}this.status="done",Xe(null,{buckets:Object.values(ft).filter(jo=>!jo.isEmpty()),featureIndex:Ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:hi.image,lineAtlas:St,imageAtlas:vo,brightness:ut.brightness})};if(!this.extraShadowCaster){const Cr=i.f5(ut.glyphDependencies,no=>Object.keys(no).map(Number));Object.keys(Cr).length?je.send("getGlyphs",{uid:this.uid,stacks:Cr,scope:this.scope},(no,vo)=>{an||(an=no,pn=vo,mr())},void 0,!1,Wi):pn={};const hi=Array.from(ut.iconDependencies.keys()).map(no=>i.I.parse(no));hi.length?je.send("getImages",{images:hi,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(no,vo)=>{an||(an=no,Zn=new Map,or=this.updateImageMapAndGetImageTaskQueue(Zn,vo,ut.iconDependencies),mr())},void 0,!1,Wi):(Zn=new Map,or=new Map);const mi=Array.from(ut.patternDependencies.keys()).map(no=>i.I.parse(no));mi.length?je.send("getImages",{images:mi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(no,vo)=>{an||(an=no,er=new Map,pr=this.updateImageMapAndGetImageTaskQueue(er,vo,ut.patternDependencies),mr())},void 0,!1,Wi):(er=new Map,pr=new Map)}if(ut.elevationFeatures&&ut.elevationFeatures.length>0){const Cr=[];for(const mi of Object.values(ft))if(mi instanceof i.b8){const no=mi.getUnevaluatedPortalGraph();no&&Cr.push(no)}const hi=i.f6.evaluate(Cr);for(const mi of Object.values(ft))mi instanceof i.b8&&mi.setEvaluatedPortalGraph(hi)}mr()}rasterizeIfNeeded(ae,me,Me,We){Array.from(me.values()).some(je=>je.usvg)?this.rasterize(ae,me,Me,We):We()}updateImageMapAndGetImageTaskQueue(ae,me,Me){const We=new Map;for(const je of me.keys()){const Xe=Me.get(je)||[];for(const $e of Xe){const Ye=$e.toString(),ft=me.get($e.id.toString());ft.usvg?We.has(Ye)||(We.set(Ye,$e),ae.set(Ye,Object.assign({},ft))):ae.set(Ye,ft)}}return We}rasterize(ae,me,Me,We){this.rasterizeTask=ae.send("rasterizeImages",{scope:this.scope,tasks:Me},(je,Xe)=>{if(!je)for(const[$e,Ye]of Xe.entries()){const ft=Object.assign(me.get($e),{data:Ye});me.set($e,ft)}We()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function N(mt,ae,me,Me){const We=new i.aa(ae,{brightness:me});for(const je of mt)je.recalculate(We,Me)}class V extends i.E{constructor(ae,me,Me,We,je,Xe,$e){super(),this.actor=ae,this.layerIndex=me,this.availableImages=Me,this.availableModels=We,this.loadVectorData=Xe||i.aJ,this.loading={},this.loaded={},this.deduped=new i.aI(ae.scheduler),this.isSpriteLoaded=je,this.scheduler=ae.scheduler,this.brightness=$e}loadTile(ae,me){const Me=ae.uid,We=ae&&ae.request,je=We&&We.collectResourceTiming,Xe=this.loading[Me]=new B(ae);Xe.abort=this.loadVectorData(ae,($e,Ye)=>{const ft=!this.loading[Me];if(delete this.loading[Me],Xe.cancelRasterize(),ft||$e||!Ye)return Xe.status="done",ft||(this.loaded[Me]=Xe),me($e);const St=Ye.rawData,ut={};Ye.expires&&(ut.expires=Ye.expires),Ye.cacheControl&&(ut.cacheControl=Ye.cacheControl),Xe.vectorTile=Ye.vectorTile||new i.fc.VectorTile(new i.bq(St));const Yt=()=>{Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(an,pn)=>{if(an||!pn)return me(an);const Zn={};if(je){const er=_(We);er.length>0&&(Zn.resourceTiming=JSON.parse(JSON.stringify(er)))}me(null,i.l({rawTileData:St.slice(0)},pn,ut,Zn))})};this.isSpriteLoaded?Yt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Yt,{type:"parseTile",isSymbolTile:ae.isSymbolTile,zoom:ae.tileZoom}):Yt()}),this.loaded=this.loaded||{},this.loaded[Me]=Xe})}reloadTile(ae,me){const Me=this.loaded,We=ae.uid;if(Me&&Me[We]){const je=Me[We];je.scaleFactor=ae.scaleFactor,je.showCollisionBoxes=ae.showCollisionBoxes,je.projection=ae.projection,je.brightness=ae.brightness,je.tileTransform=i.aW(ae.tileID.canonical,ae.projection),je.extraShadowCaster=ae.extraShadowCaster,je.lut=ae.lut;const Xe=($e,Ye)=>{const ft=je.reloadCallback;ft&&(delete je.reloadCallback,je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,ft)),me($e,Ye)};je.status==="parsing"?je.reloadCallback=Xe:je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Xe):Xe())}else me(null,void 0)}abortTile(ae,me){const Me=ae.uid,We=this.loading[Me];We&&(We.abort&&We.abort(),delete this.loading[Me]),me()}removeTile(ae,me){const Me=this.loaded,We=ae.uid;Me&&Me[We]&&delete Me[We],me()}}class H{loadTile(ae,me){const{uid:Me,encoding:We,rawImageData:je,padding:Xe}=ae,$e=ImageBitmap&&je instanceof ImageBitmap?this.getImageData(je,Xe):je;me(null,new i.fd(Me,$e,We,Xe<1))}reloadTile(ae,me){me(null,null)}abortTile(ae,me){me()}removeTile(ae,me){me()}getImageData(ae,me){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ae.width,ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ae.width,this.offscreenCanvas.height=ae.height,this.offscreenCanvasContext.drawImage(ae,0,0,ae.width,ae.height);const Me=this.offscreenCanvasContext.getImageData(-me,-me,ae.width+2*me,ae.height+2*me);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}i.bp.setPbf(i.bq);class G{constructor(ae){this._mrt=new i.bp(ae.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ae.uid,this.tileID=ae.tileID,this.source=ae.source}parse(ae,me){const Me=this._mrt;this.status="parsing",this._entireBuffer=ae;try{Me.parseHeader(ae),this._isHeaderLoaded=!0;const We=[];for(const je in Me.layers){const Xe=Me.getLayer(je),$e=Xe.getDataRange(Xe.getBandList()),Ye=Me.createDecodingTask($e),ft=ae.slice($e.firstByte,$e.lastByte+1),St=i.bp.performDecoding(ft,Ye).then(ut=>Ye.complete(null,ut)).catch(ut=>Ye.complete(ut,null));We.push(St)}Promise.allSettled(We).then(()=>me(null,Me)).catch(je=>me(je))}catch(We){me(We)}}}class q{constructor(ae){this.actor=ae,this.loading={},this.loaded={}}loadTile(ae,me){const Me=ae.uid,We=ae.request,je=this.loading[Me]=new G(ae),{cancel:Xe}=i.br(We,($e,Ye,ft,St)=>{const ut=!this.loading[Me];if(delete this.loading[Me],ut||$e||!Ye)return je.status="done",ut||(this.loaded[Me]=je),me($e);je.parse(Ye,(Yt,an)=>{if(Yt||!an)return me(Yt);me(null,an,ft,St)}),this.loaded[Me]=je});je.abort=Xe}reloadTile(ae,me){me(null,void 0)}abortTile(ae,me){const Me=ae.uid,We=this.loading[Me];We&&(We.abort&&We.abort(),delete this.loading[Me]),me()}removeTile(ae,me){const Me=ae.uid;this.loaded[Me]&&delete this.loaded[Me],me()}decodeRasterArray(ae,me){i.bp.performDecoding(ae.buffer,ae.task).then(Me=>me(null,Me)).catch(Me=>me(Me))}}const Q=i.fc.VectorTileFeature.prototype.toGeoJSON;class te{constructor(ae){this._feature=ae,this.extent=i.aj,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const me of this._feature.geometry)ae.push([new i.P(me[0],me[1])]);return ae}{const ae=[];for(const me of this._feature.geometry){const Me=[];for(const We of me)Me.push(new i.P(We[0],We[1]));ae.push(Me)}return ae}}toGeoJSON(ae,me,Me){return Q.call(this,ae,me,Me)}}class ue{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.aj,this.length=ae.length,this._features=ae}feature(ae){return new te(this._features[ae])}}const fe=64/4096,ye=128;class De{constructor(){this.features=new Map}clear(){this.features.clear()}load(ae=[],me){for(const Me of ae){const We=Me.id;if(We==null)continue;let je=this.features.get(We);je&&this.updateCache(je,me),Me.geometry?(je=Fe(Me),this.updateCache(je,me),this.features.set(We,je)):this.features.delete(We),this.updateCache(je,me)}}updateCache(ae,me){for(const{canonical:Me,uid:We}of Object.values(me)){const{z:je,x:Xe,y:$e}=Me;Ne(ae,Math.pow(2,je),Xe,$e)&&delete me[We]}}getTile(ae,me,Me){const We=Math.pow(2,ae),je=[];for(const Xe of this.features.values())Ne(Xe,We,me,Me)&&je.push(ct(Xe,We,me,Me));return{features:je}}getFeatures(){return[...this.features.values()]}}function Ne({minX:mt,minY:ae,maxX:me,maxY:Me},We,je,Xe){return mt<(je+1+fe)/We&&ae<(Xe+1+fe)/We&&me>(je-fe)/We&&Me>(Xe-fe)/We}function Fe(mt){const{id:ae,geometry:me,properties:Me}=mt;if(!me)return;if(me.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:We,coordinates:je}=me,Xe={id:ae,type:1,geometry:[],tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},$e=Xe.geometry;if(We==="Point")Le(je,$e,Xe);else if(We==="MultiPoint")for(const Ye of je)Le(Ye,$e,Xe);else if(We==="LineString")Xe.type=2,Ze(je,$e,Xe);else if(We==="MultiLineString")Xe.type=2,He(je,$e,Xe);else if(We==="Polygon")Xe.type=3,He(je,$e,Xe,!0);else{if(We!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Xe.type=3;for(const Ye of je)He(Ye,$e,Xe,!0)}return Xe}function Le([mt,ae],me,Me){const We=i.ay(mt);let je=i.aH(ae);je=je<0?0:je>1?1:je,me.push(We,je),Me.minX=Math.min(Me.minX,We),Me.minY=Math.min(Me.minY,je),Me.maxX=Math.max(Me.maxX,We),Me.maxY=Math.max(Me.maxY,je)}function Ze(mt,ae,me,Me=!1,We=!1){const je=[];for(const Xe of mt)Le(Xe,je,me);ae.push(je),Me&&function(Xe,$e){let Ye=0;for(let ft=0,St=Xe.length,ut=St-2;ft<St;ut=ft,ft+=2)Ye+=(Xe[ft]-Xe[ut])*(Xe[ft+1]+Xe[ut+1]);if(Ye>0===$e)for(let ft=0,St=Xe.length;ft<St/2;ft+=2){const ut=Xe[ft],Yt=Xe[ft+1];Xe[ft]=Xe[St-2-ft],Xe[ft+1]=Xe[St-1-ft],Xe[St-2-ft]=ut,Xe[St-1-ft]=Yt}}(je,We)}function He(mt,ae,me,Me=!1){for(let We=0;We<mt.length;We++)Ze(mt[We],ae,me,Me,We===0)}function ct(mt,ae,me,Me){const{id:We,type:je,geometry:Xe,tags:$e}=mt,Ye=[];if(je===1)(function(ft,St,ut,Yt,an){for(let pn=0;pn<ft.length;pn+=2){const Zn=Math.round(i.aj*(ft[pn+0]*St-ut)),er=Math.round(i.aj*(ft[pn+1]*St-Yt));an.push([Zn,er])}})(Xe,ae,me,Me,Ye);else for(const ft of Xe)ot(ft,ae,me,Me,Ye);return{id:We,type:je,geometry:Ye,tags:$e}}function ot(mt,ae,me,Me,We){const je=-ye,Xe=i.aj+ye;let $e;for(let Ye=0;Ye<mt.length-2;Ye+=2){let ft=Math.round(i.aj*(mt[Ye+0]*ae-me)),St=Math.round(i.aj*(mt[Ye+1]*ae-Me)),ut=Math.round(i.aj*(mt[Ye+2]*ae-me)),Yt=Math.round(i.aj*(mt[Ye+3]*ae-Me));const an=ut-ft,pn=Yt-St;ft<je&&ut<je||(ft<je?(St+=Math.round(pn*((je-ft)/an)),ft=je):ut<je&&(Yt=St+Math.round(pn*((je-ft)/an)),ut=je),St<je&&Yt<je||(St<je?(ft+=Math.round(an*((je-St)/pn)),St=je):Yt<je&&(ut=ft+Math.round(an*((je-St)/pn)),Yt=je),ft>=Xe&&ut>=Xe||(ft>=Xe?(St+=Math.round(pn*((Xe-ft)/an)),ft=Xe):ut>=Xe&&(Yt=St+Math.round(pn*((Xe-ft)/an)),ut=Xe),St>=Xe&&Yt>=Xe||(St>=Xe?(ft+=Math.round(an*((Xe-St)/pn)),St=Xe):Yt>=Xe&&(ut=ft+Math.round(an*((Xe-St)/pn)),Yt=Xe),$e&&ft===$e[$e.length-1][0]&&St===$e[$e.length-1][1]||($e=[[ft,St]],We.push($e)),$e.push([ut,Yt])))))}}var rt,Be,nt,at={exports:{}},Mt=function(){if(nt)return at.exports;nt=1;var mt=i.fg(),ae=function(){if(Be)return rt;Be=1;var St=i.fe(),ut=i.ff().VectorTileFeature;function Yt(pn,Zn){this.options=Zn||{},this.features=pn,this.length=pn.length}function an(pn,Zn){this.id=typeof pn.id=="number"?pn.id:void 0,this.type=pn.type,this.rawGeometry=pn.type===1?[pn.geometry]:pn.geometry,this.properties=pn.tags,this.extent=Zn||4096}return rt=Yt,Yt.prototype.feature=function(pn){return new an(this.features[pn],this.options.extent)},an.prototype.loadGeometry=function(){var pn=this.rawGeometry;this.geometry=[];for(var Zn=0;Zn<pn.length;Zn++){for(var er=pn[Zn],or=[],pr=0;pr<er.length;pr++)or.push(new St(er[pr][0],er[pr][1]));this.geometry.push(or)}return this.geometry},an.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var pn=this.geometry,Zn=1/0,er=-1/0,or=1/0,pr=-1/0,Wi=0;Wi<pn.length;Wi++)for(var mr=pn[Wi],ui=0;ui<mr.length;ui++){var Cr=mr[ui];Zn=Math.min(Zn,Cr.x),er=Math.max(er,Cr.x),or=Math.min(or,Cr.y),pr=Math.max(pr,Cr.y)}return[Zn,or,er,pr]},an.prototype.toGeoJSON=ut.prototype.toGeoJSON,rt}();function me(St){var ut=new mt;return function(Yt,an){for(var pn in Yt.layers)an.writeMessage(3,Me,Yt.layers[pn])}(St,ut),ut.finish()}function Me(St,ut){var Yt;ut.writeVarintField(15,St.version||1),ut.writeStringField(1,St.name||""),ut.writeVarintField(5,St.extent||4096);var an={keys:[],values:[],keycache:{},valuecache:{}};for(Yt=0;Yt<St.length;Yt++)an.feature=St.feature(Yt),ut.writeMessage(2,We,an);var pn=an.keys;for(Yt=0;Yt<pn.length;Yt++)ut.writeStringField(3,pn[Yt]);var Zn=an.values;for(Yt=0;Yt<Zn.length;Yt++)ut.writeMessage(4,ft,Zn[Yt])}function We(St,ut){var Yt=St.feature;Yt.id!==void 0&&ut.writeVarintField(1,Yt.id),ut.writeMessage(2,je,St),ut.writeVarintField(3,Yt.type),ut.writeMessage(4,Ye,Yt)}function je(St,ut){var Yt=St.feature,an=St.keys,pn=St.values,Zn=St.keycache,er=St.valuecache;for(var or in Yt.properties){var pr=Yt.properties[or],Wi=Zn[or];if(pr!==null){Wi===void 0&&(an.push(or),Zn[or]=Wi=an.length-1),ut.writeVarint(Wi);var mr=typeof pr;mr!=="string"&&mr!=="boolean"&&mr!=="number"&&(pr=JSON.stringify(pr));var ui=mr+":"+pr,Cr=er[ui];Cr===void 0&&(pn.push(pr),er[ui]=Cr=pn.length-1),ut.writeVarint(Cr)}}}function Xe(St,ut){return(ut<<3)+(7&St)}function $e(St){return St<<1^St>>31}function Ye(St,ut){for(var Yt=St.loadGeometry(),an=St.type,pn=0,Zn=0,er=Yt.length,or=0;or<er;or++){var pr=Yt[or],Wi=1;an===1&&(Wi=pr.length),ut.writeVarint(Xe(1,Wi));for(var mr=an===3?pr.length-1:pr.length,ui=0;ui<mr;ui++){ui===1&&an!==1&&ut.writeVarint(Xe(2,mr-1));var Cr=pr[ui].x-pn,hi=pr[ui].y-Zn;ut.writeVarint($e(Cr)),ut.writeVarint($e(hi)),pn+=Cr,Zn+=hi}an===3&&ut.writeVarint(Xe(7,1))}}function ft(St,ut){var Yt=typeof St;Yt==="string"?ut.writeStringField(1,St):Yt==="boolean"?ut.writeBooleanField(7,St):Yt==="number"&&(St%1!=0?ut.writeDoubleField(3,St):St<0?ut.writeSVarintField(6,St):ut.writeVarintField(5,St))}return at.exports=me,at.exports.fromVectorTileJs=me,at.exports.fromGeojsonVt=function(St,ut){ut=ut||{};var Yt={};for(var an in St)Yt[an]=new ae(St[an].features,ut),Yt[an].name=an,Yt[an].version=ut.version,Yt[an].extent=ut.extent;return me({layers:Yt})},at.exports.GeoJSONWrapper=ae,at.exports}(),Nt=i.fh(Mt);const rn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:mt=>mt},un=Math.fround||(en=new Float32Array(1),mt=>(en[0]=+mt,en[0]));var en;const sn=3,Vt=5,$n=6;class Gt{constructor(ae){this.options=Object.assign(Object.create(rn),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:me,minZoom:Me,maxZoom:We}=this.options;me&&console.time("total time");const je=`prepare ${ae.length} points`;me&&console.time(je),this.points=ae;const Xe=[];for(let Ye=0;Ye<ae.length;Ye++){const ft=ae[Ye];if(!ft.geometry)continue;const[St,ut]=ft.geometry.coordinates,Yt=un(yt(St)),an=un(In(ut));Xe.push(Yt,an,1/0,Ye,-1,1),this.options.reduce&&Xe.push(0)}let $e=this.trees[We+1]=this._createTree(Xe);me&&console.timeEnd(je);for(let Ye=We;Ye>=Me;Ye--){const ft=+Date.now();$e=this.trees[Ye]=this._createTree(this._cluster($e,Ye)),me&&console.log("z%d: %d clusters in %dms",Ye,$e.numItems,+Date.now()-ft)}return me&&console.timeEnd("total time"),this}getClusters(ae,me){let Me=((ae[0]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,ae[1]));let je=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)Me=-180,je=180;else if(Me>je){const ut=this.getClusters([Me,We,180,Xe],me),Yt=this.getClusters([-180,We,je,Xe],me);return ut.concat(Yt)}const $e=this.trees[this._limitZoom(me)],Ye=$e.range(yt(Me),In(Xe),yt(je),In(We)),ft=$e.data,St=[];for(const ut of Ye){const Yt=this.stride*ut;St.push(ft[Yt+Vt]>1?Tn(ft,Yt,this.clusterProps):this.points[ft[Yt+sn]])}return St}getChildren(ae){const me=this._getOriginId(ae),Me=this._getOriginZoom(ae),We="No cluster with the specified id.",je=this.trees[Me];if(!je)throw new Error(We);const Xe=je.data;if(me*this.stride>=Xe.length)throw new Error(We);const $e=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Ye=je.within(Xe[me*this.stride],Xe[me*this.stride+1],$e),ft=[];for(const St of Ye){const ut=St*this.stride;Xe[ut+4]===ae&&ft.push(Xe[ut+Vt]>1?Tn(Xe,ut,this.clusterProps):this.points[Xe[ut+sn]])}if(ft.length===0)throw new Error(We);return ft}getLeaves(ae,me,Me){const We=[];return this._appendLeaves(We,ae,me=me||10,Me=Me||0,0),We}getTile(ae,me,Me){const We=this.trees[this._limitZoom(ae)],je=Math.pow(2,ae),{extent:Xe,radius:$e}=this.options,Ye=$e/Xe,ft=(Me-Ye)/je,St=(Me+1+Ye)/je,ut={features:[]};return this._addTileFeatures(We.range((me-Ye)/je,ft,(me+1+Ye)/je,St),We.data,me,Me,je,ut),me===0&&this._addTileFeatures(We.range(1-Ye/je,ft,1,St),We.data,je,Me,je,ut),me===je-1&&this._addTileFeatures(We.range(0,ft,Ye/je,St),We.data,-1,Me,je,ut),ut.features.length?ut:null}getClusterExpansionZoom(ae){let me=this._getOriginZoom(ae)-1;for(;me<=this.options.maxZoom;){const Me=this.getChildren(ae);if(me++,Me.length!==1)break;ae=Me[0].properties.cluster_id}return me}_appendLeaves(ae,me,Me,We,je){const Xe=this.getChildren(me);for(const $e of Xe){const Ye=$e.properties;if(Ye&&Ye.cluster?je+Ye.point_count<=We?je+=Ye.point_count:je=this._appendLeaves(ae,Ye.cluster_id,Me,We,je):je<We?je++:ae.push($e),ae.length===Me)break}return je}_createTree(ae){const me=new i.bW(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<ae.length;Me+=this.stride)me.add(ae[Me],ae[Me+1]);return me.finish(),me.data=ae,me}_addTileFeatures(ae,me,Me,We,je,Xe){for(const $e of ae){const Ye=$e*this.stride,ft=me[Ye+Vt]>1;let St,ut,Yt;if(ft)St=hn(me,Ye,this.clusterProps),ut=me[Ye],Yt=me[Ye+1];else{const Zn=this.points[me[Ye+sn]];St=Zn.properties;const[er,or]=Zn.geometry.coordinates;ut=yt(er),Yt=In(or)}const an={type:1,geometry:[[Math.round(this.options.extent*(ut*je-Me)),Math.round(this.options.extent*(Yt*je-We))]],tags:St};let pn;pn=ft||this.options.generateId?me[Ye+sn]:this.points[me[Ye+sn]].id,pn!==void 0&&(an.id=pn),Xe.features.push(an)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,me){const{radius:Me,extent:We,reduce:je,minPoints:Xe}=this.options,$e=Me/(We*Math.pow(2,me)),Ye=ae.data,ft=[],St=this.stride;for(let ut=0;ut<Ye.length;ut+=St){if(Ye[ut+2]<=me)continue;Ye[ut+2]=me;const Yt=Ye[ut],an=Ye[ut+1],pn=ae.within(Ye[ut],Ye[ut+1],$e),Zn=Ye[ut+Vt];let er=Zn;for(const or of pn){const pr=or*St;Ye[pr+2]>me&&(er+=Ye[pr+Vt])}if(er>Zn&&er>=Xe){let or,pr=Yt*Zn,Wi=an*Zn,mr=-1;const ui=(ut/St<<5)+(me+1)+this.points.length;for(const Cr of pn){const hi=Cr*St;if(Ye[hi+2]<=me)continue;Ye[hi+2]=me;const mi=Ye[hi+Vt];pr+=Ye[hi]*mi,Wi+=Ye[hi+1]*mi,Ye[hi+4]=ui,je&&(or||(or=this._map(Ye,ut,!0),mr=this.clusterProps.length,this.clusterProps.push(or)),je(or,this._map(Ye,hi)))}Ye[ut+4]=ui,ft.push(pr/er,Wi/er,1/0,ui,-1,er),je&&ft.push(mr)}else{for(let or=0;or<St;or++)ft.push(Ye[ut+or]);if(er>1)for(const or of pn){const pr=or*St;if(!(Ye[pr+2]<=me)){Ye[pr+2]=me;for(let Wi=0;Wi<St;Wi++)ft.push(Ye[pr+Wi])}}}}return ft}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,me,Me){if(ae[me+Vt]>1){const Xe=this.clusterProps[ae[me+$n]];return Me?Object.assign({},Xe):Xe}const We=this.points[ae[me+sn]].properties,je=this.options.map(We);return Me&&je===We?Object.assign({},je):je}}function Tn(mt,ae,me){return{type:"Feature",id:mt[ae+sn],properties:hn(mt,ae,me),geometry:{type:"Point",coordinates:[(Me=mt[ae],360*(Me-.5)),Kn(mt[ae+1])]}};var Me}function hn(mt,ae,me){const Me=mt[ae+Vt],We=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,je=mt[ae+$n],Xe=je===-1?{}:Object.assign({},me[je]);return Object.assign(Xe,{cluster:!0,cluster_id:mt[ae+sn],point_count:Me,point_count_abbreviated:We})}function yt(mt){return mt/360+.5}function In(mt){const ae=Math.sin(mt*Math.PI/180),me=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return me<0?0:me>1?1:me}function Kn(mt){const ae=(180-360*mt)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Ar(mt,ae,me,Me){let We=Me;const je=ae+(me-ae>>1);let Xe,$e=me-ae;const Ye=mt[ae],ft=mt[ae+1],St=mt[me],ut=mt[me+1];for(let Yt=ae+3;Yt<me;Yt+=3){const an=_r(mt[Yt],mt[Yt+1],Ye,ft,St,ut);if(an>We)Xe=Yt,We=an;else if(an===We){const pn=Math.abs(Yt-je);pn<$e&&(Xe=Yt,$e=pn)}}We>Me&&(Xe-ae>3&&Ar(mt,ae,Xe,Me),mt[Xe+2]=We,me-Xe>3&&Ar(mt,Xe,me,Me))}function _r(mt,ae,me,Me,We,je){let Xe=We-me,$e=je-Me;if(Xe!==0||$e!==0){const Ye=((mt-me)*Xe+(ae-Me)*$e)/(Xe*Xe+$e*$e);Ye>1?(me=We,Me=je):Ye>0&&(me+=Xe*Ye,Me+=$e*Ye)}return Xe=mt-me,$e=ae-Me,Xe*Xe+$e*$e}function Vr(mt,ae,me,Me){const We={id:mt??null,type:ae,geometry:me,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")it(We,me);else if(ae==="Polygon")it(We,me[0]);else if(ae==="MultiLineString")for(const je of me)it(We,je);else if(ae==="MultiPolygon")for(const je of me)it(We,je[0]);return We}function it(mt,ae){for(let me=0;me<ae.length;me+=3)mt.minX=Math.min(mt.minX,ae[me]),mt.minY=Math.min(mt.minY,ae[me+1]),mt.maxX=Math.max(mt.maxX,ae[me]),mt.maxY=Math.max(mt.maxY,ae[me+1])}function Pt(mt,ae,me,Me){if(!ae.geometry)return;const We=ae.geometry.coordinates;if(We&&We.length===0)return;const je=ae.geometry.type,Xe=Math.pow(me.tolerance/((1<<me.maxZoom)*me.extent),2);let $e=[],Ye=ae.id;if(me.promoteId?Ye=ae.properties[me.promoteId]:me.generateId&&(Ye=Me||0),je==="Point")jt(We,$e);else if(je==="MultiPoint")for(const ft of We)jt(ft,$e);else if(je==="LineString")Cn(We,$e,Xe,!1);else if(je==="MultiLineString"){if(me.lineMetrics){for(const ft of We)$e=[],Cn(ft,$e,Xe,!1),mt.push(Vr(Ye,"LineString",$e,ae.properties));return}Mn(We,$e,Xe,!1)}else if(je==="Polygon")Mn(We,$e,Xe,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const ft of ae.geometry.geometries)Pt(mt,{id:Ye,geometry:ft,properties:ae.properties},me,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ft of We){const St=[];Mn(ft,St,Xe,!0),$e.push(St)}}mt.push(Vr(Ye,je,$e,ae.properties))}function jt(mt,ae){ae.push(_n(mt[0]),Gn(mt[1]),0)}function Cn(mt,ae,me,Me){let We,je,Xe=0;for(let Ye=0;Ye<mt.length;Ye++){const ft=_n(mt[Ye][0]),St=Gn(mt[Ye][1]);ae.push(ft,St,0),Ye>0&&(Xe+=Me?(We*St-ft*je)/2:Math.sqrt(Math.pow(ft-We,2)+Math.pow(St-je,2))),We=ft,je=St}const $e=ae.length-3;ae[2]=1,Ar(ae,0,$e,me),ae[$e+2]=1,ae.size=Math.abs(Xe),ae.start=0,ae.end=ae.size}function Mn(mt,ae,me,Me){for(let We=0;We<mt.length;We++){const je=[];Cn(mt[We],je,me,Me),ae.push(je)}}function _n(mt){return mt/360+.5}function Gn(mt){const ae=Math.sin(mt*Math.PI/180),me=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return me<0?0:me>1?1:me}function vr(mt,ae,me,Me,We,je,Xe,$e){if(Me/=ae,je>=(me/=ae)&&Xe<Me)return mt;if(Xe<me||je>=Me)return null;const Ye=[];for(const ft of mt){const St=ft.geometry;let ut=ft.type;const Yt=We===0?ft.minX:ft.minY,an=We===0?ft.maxX:ft.maxY;if(Yt>=me&&an<Me){Ye.push(ft);continue}if(an<me||Yt>=Me)continue;let pn=[];if(ut==="Point"||ut==="MultiPoint")ni(St,pn,me,Me,We);else if(ut==="LineString")vi(St,pn,me,Me,We,!1,$e.lineMetrics);else if(ut==="MultiLineString")fa(St,pn,me,Me,We,!1);else if(ut==="Polygon")fa(St,pn,me,Me,We,!0);else if(ut==="MultiPolygon")for(const Zn of St){const er=[];fa(Zn,er,me,Me,We,!0),er.length&&pn.push(er)}if(pn.length){if($e.lineMetrics&&ut==="LineString"){for(const Zn of pn)Ye.push(Vr(ft.id,ut,Zn,ft.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(pn.length===1?(ut="LineString",pn=pn[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=pn.length===3?"Point":"MultiPoint"),Ye.push(Vr(ft.id,ut,pn,ft.tags))}}return Ye.length?Ye:null}function ni(mt,ae,me,Me,We){for(let je=0;je<mt.length;je+=3){const Xe=mt[je+We];Xe>=me&&Xe<=Me&&to(ae,mt[je],mt[je+1],mt[je+2])}}function vi(mt,ae,me,Me,We,je,Xe){let $e=na(mt);const Ye=We===0?uo:ja;let ft,St,ut=mt.start;for(let er=0;er<mt.length-3;er+=3){const or=mt[er],pr=mt[er+1],Wi=mt[er+2],mr=mt[er+3],ui=mt[er+4],Cr=We===0?or:pr,hi=We===0?mr:ui;let mi=!1;Xe&&(ft=Math.sqrt(Math.pow(or-mr,2)+Math.pow(pr-ui,2))),Cr<me?hi>me&&(St=Ye($e,or,pr,mr,ui,me),Xe&&($e.start=ut+ft*St)):Cr>Me?hi<Me&&(St=Ye($e,or,pr,mr,ui,Me),Xe&&($e.start=ut+ft*St)):to($e,or,pr,Wi),hi<me&&Cr>=me&&(St=Ye($e,or,pr,mr,ui,me),mi=!0),hi>Me&&Cr<=Me&&(St=Ye($e,or,pr,mr,ui,Me),mi=!0),!je&&mi&&(Xe&&($e.end=ut+ft*St),ae.push($e),$e=na(mt)),Xe&&(ut+=ft)}let Yt=mt.length-3;const an=mt[Yt],pn=mt[Yt+1],Zn=We===0?an:pn;Zn>=me&&Zn<=Me&&to($e,an,pn,mt[Yt+2]),Yt=$e.length-3,je&&Yt>=3&&($e[Yt]!==$e[0]||$e[Yt+1]!==$e[1])&&to($e,$e[0],$e[1],$e[2]),$e.length&&ae.push($e)}function na(mt){const ae=[];return ae.size=mt.size,ae.start=mt.start,ae.end=mt.end,ae}function fa(mt,ae,me,Me,We,je){for(const Xe of mt)vi(Xe,ae,me,Me,We,je,!1)}function to(mt,ae,me,Me){mt.push(ae,me,Me)}function uo(mt,ae,me,Me,We,je){const Xe=(je-ae)/(Me-ae);return to(mt,je,me+(We-me)*Xe,1),Xe}function ja(mt,ae,me,Me,We,je){const Xe=(je-me)/(We-me);return to(mt,ae+(Me-ae)*Xe,je,1),Xe}function Bo(mt,ae){const me=[];for(let Me=0;Me<mt.length;Me++){const We=mt[Me],je=We.type;let Xe;if(je==="Point"||je==="MultiPoint"||je==="LineString")Xe=fo(We.geometry,ae);else if(je==="MultiLineString"||je==="Polygon"){Xe=[];for(const $e of We.geometry)Xe.push(fo($e,ae))}else if(je==="MultiPolygon"){Xe=[];for(const $e of We.geometry){const Ye=[];for(const ft of $e)Ye.push(fo(ft,ae));Xe.push(Ye)}}me.push(Vr(We.id,je,Xe,We.tags))}return me}function fo(mt,ae){const me=[];me.size=mt.size,mt.start!==void 0&&(me.start=mt.start,me.end=mt.end);for(let Me=0;Me<mt.length;Me+=3)me.push(mt[Me]+ae,mt[Me+1],mt[Me+2]);return me}function $a(mt,ae){if(mt.transformed)return mt;const me=1<<mt.z,Me=mt.x,We=mt.y;for(const je of mt.features){const Xe=je.geometry,$e=je.type;if(je.geometry=[],$e===1)for(let Ye=0;Ye<Xe.length;Ye+=2)je.geometry.push(Ua(Xe[Ye],Xe[Ye+1],ae,me,Me,We));else for(let Ye=0;Ye<Xe.length;Ye++){const ft=[];for(let St=0;St<Xe[Ye].length;St+=2)ft.push(Ua(Xe[Ye][St],Xe[Ye][St+1],ae,me,Me,We));je.geometry.push(ft)}}return mt.transformed=!0,mt}function Ua(mt,ae,me,Me,We,je){return[Math.round(me*(mt*Me-We)),Math.round(me*(ae*Me-je))]}function Es(mt,ae,me,Me,We){const je=ae===We.maxZoom?0:We.tolerance/((1<<ae)*We.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:mt.length,source:null,x:me,y:Me,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const $e of mt)ci(Xe,$e,je,We);return Xe}function ci(mt,ae,me,Me){const We=ae.geometry,je=ae.type,Xe=[];if(mt.minX=Math.min(mt.minX,ae.minX),mt.minY=Math.min(mt.minY,ae.minY),mt.maxX=Math.max(mt.maxX,ae.maxX),mt.maxY=Math.max(mt.maxY,ae.maxY),je==="Point"||je==="MultiPoint")for(let $e=0;$e<We.length;$e+=3)Xe.push(We[$e],We[$e+1]),mt.numPoints++,mt.numSimplified++;else if(je==="LineString")Qa(Xe,We,mt,me,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let $e=0;$e<We.length;$e++)Qa(Xe,We[$e],mt,me,je==="Polygon",$e===0);else if(je==="MultiPolygon")for(let $e=0;$e<We.length;$e++){const Ye=We[$e];for(let ft=0;ft<Ye.length;ft++)Qa(Xe,Ye[ft],mt,me,!0,ft===0)}if(Xe.length){let $e=ae.tags||null;if(je==="LineString"&&Me.lineMetrics){$e={};for(const ft in ae.tags)$e[ft]=ae.tags[ft];$e.mapbox_clip_start=We.start/We.size,$e.mapbox_clip_end=We.end/We.size}const Ye={geometry:Xe,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:$e};ae.id!==null&&(Ye.id=ae.id),mt.features.push(Ye)}}function Qa(mt,ae,me,Me,We,je){const Xe=Me*Me;if(Me>0&&ae.size<(We?Xe:Me))return void(me.numPoints+=ae.length/3);const $e=[];for(let Ye=0;Ye<ae.length;Ye+=3)(Me===0||ae[Ye+2]>Xe)&&(me.numSimplified++,$e.push(ae[Ye],ae[Ye+1])),me.numPoints++;We&&function(Ye,ft){let St=0;for(let ut=0,Yt=Ye.length,an=Yt-2;ut<Yt;an=ut,ut+=2)St+=(Ye[ut]-Ye[an])*(Ye[ut+1]+Ye[an+1]);if(St>0===ft)for(let ut=0,Yt=Ye.length;ut<Yt/2;ut+=2){const an=Ye[ut],pn=Ye[ut+1];Ye[ut]=Ye[Yt-2-ut],Ye[ut+1]=Ye[Yt-1-ut],Ye[Yt-2-ut]=an,Ye[Yt-1-ut]=pn}}($e,je),mt.push($e)}const As={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class pa{constructor(ae,me){const Me=(me=this.options=function(je,Xe){for(const $e in Xe)je[$e]=Xe[$e];return je}(Object.create(As),me)).debug;if(Me&&console.time("preprocess data"),me.maxZoom<0||me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(me.promoteId&&me.generateId)throw new Error("promoteId and generateId cannot be used together.");let We=function(je,Xe){const $e=[];if(je.type==="FeatureCollection")for(let Ye=0;Ye<je.features.length;Ye++)Pt($e,je.features[Ye],Xe,Ye);else Pt($e,je.type==="Feature"?je:{geometry:je},Xe);return $e}(ae,me);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",me.indexMaxZoom,me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),We=function(je,Xe){const $e=Xe.buffer/Xe.extent;let Ye=je;const ft=vr(je,1,-1-$e,$e,0,-1,2,Xe),St=vr(je,1,1-$e,2+$e,0,-1,2,Xe);return(ft||St)&&(Ye=vr(je,1,-$e,1+$e,0,-1,2,Xe)||[],ft&&(Ye=Bo(ft,1).concat(Ye)),St&&(Ye=Ye.concat(Bo(St,-1)))),Ye}(We,me),We.length&&this.splitTile(We,0,0,0),Me&&(We.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,me,Me,We,je,Xe,$e){const Ye=[ae,me,Me,We],ft=this.options,St=ft.debug;for(;Ye.length;){We=Ye.pop(),Me=Ye.pop(),me=Ye.pop(),ae=Ye.pop();const ut=1<<me,Yt=Ps(me,Me,We);let an=this.tiles[Yt];if(!an&&(St>1&&console.time("creation"),an=this.tiles[Yt]=Es(ae,me,Me,We,ft),this.tileCoords.push({z:me,x:Me,y:We}),St)){St>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",me,Me,We,an.numFeatures,an.numPoints,an.numSimplified),console.timeEnd("creation"));const mi=`z${me}`;this.stats[mi]=(this.stats[mi]||0)+1,this.total++}if(an.source=ae,je==null){if(me===ft.indexMaxZoom||an.numPoints<=ft.indexMaxPoints)continue}else{if(me===ft.maxZoom||me===je)continue;if(je!=null){const mi=je-me;if(Me!==Xe>>mi||We!==$e>>mi)continue}}if(an.source=null,ae.length===0)continue;St>1&&console.time("clipping");const pn=.5*ft.buffer/ft.extent,Zn=.5-pn,er=.5+pn,or=1+pn;let pr=null,Wi=null,mr=null,ui=null,Cr=vr(ae,ut,Me-pn,Me+er,0,an.minX,an.maxX,ft),hi=vr(ae,ut,Me+Zn,Me+or,0,an.minX,an.maxX,ft);ae=null,Cr&&(pr=vr(Cr,ut,We-pn,We+er,1,an.minY,an.maxY,ft),Wi=vr(Cr,ut,We+Zn,We+or,1,an.minY,an.maxY,ft),Cr=null),hi&&(mr=vr(hi,ut,We-pn,We+er,1,an.minY,an.maxY,ft),ui=vr(hi,ut,We+Zn,We+or,1,an.minY,an.maxY,ft),hi=null),St>1&&console.timeEnd("clipping"),Ye.push(pr||[],me+1,2*Me,2*We),Ye.push(Wi||[],me+1,2*Me,2*We+1),Ye.push(mr||[],me+1,2*Me+1,2*We),Ye.push(ui||[],me+1,2*Me+1,2*We+1)}}getTile(ae,me,Me){ae=+ae,me=+me,Me=+Me;const We=this.options,{extent:je,debug:Xe}=We;if(ae<0||ae>24)return null;const $e=1<<ae,Ye=Ps(ae,me=me+$e&$e-1,Me);if(this.tiles[Ye])return $a(this.tiles[Ye],je);Xe>1&&console.log("drilling down to z%d-%d-%d",ae,me,Me);let ft,St=ae,ut=me,Yt=Me;for(;!ft&&St>0;)St--,ut>>=1,Yt>>=1,ft=this.tiles[Ps(St,ut,Yt)];return ft&&ft.source?(Xe>1&&(console.log("found parent tile z%d-%d-%d",St,ut,Yt),console.time("drilling down")),this.splitTile(ft.source,St,ut,Yt,ae,me,Me),Xe>1&&console.timeEnd("drilling down"),this.tiles[Ye]?$a(this.tiles[Ye],je):null):null}}function Ps(mt,ae,me){return 32*((1<<mt)*me+ae)+mt}function es(mt,ae){const me=mt.tileID.canonical;if(!this._geoJSONIndex)return void ae(null,null);const Me=this._geoJSONIndex.getTile(me.z,me.x,me.y);if(!Me)return void ae(null,null);const We=new ue(Me.features);let je=Nt(We);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),ae(null,{vectorTile:We,rawData:je.buffer})}class Cl extends V{constructor(ae,me,Me,We,je,Xe,$e){super(ae,me,Me,We,je,es,$e),Xe&&(this.loadGeoJSON=Xe),this._dynamicIndex=new De}loadData(ae,me){const Me=ae&&ae.request,We=Me&&Me.collectResourceTiming;this.loadGeoJSON(ae,(je,Xe)=>{if(je||!Xe)return me(je);if(typeof Xe!="object")return me(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));{try{if(ae.filter){const Ye=i.X(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(ft=>`${ft.key}: ${ft.message}`).join(", "));Xe.features=Xe.features.filter(ft=>Ye.value.evaluate({zoom:0},ft))}ae.dynamic?(Xe.type==="Feature"&&(Xe={type:"FeatureCollection",features:[Xe]}),ae.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Xe.features,this.loaded),ae.cluster&&(Xe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ae.cluster?new Gt(function({superclusterOptions:Ye,clusterProperties:ft}){if(!ft||!Ye)return Ye;const St={},ut={},Yt={accumulated:null,zoom:0},an={properties:null},pn=Object.keys(ft);for(const Zn of pn){const[er,or]=ft[Zn],pr=i.X(or),Wi=i.X(typeof er=="string"?[er,["accumulated"],["get",Zn]]:er);St[Zn]=pr.value,ut[Zn]=Wi.value}return Ye.map=Zn=>{an.properties=Zn;const er={};for(const or of pn)er[or]=St[or].evaluate(Yt,an);return er},Ye.reduce=(Zn,er)=>{an.properties=er;for(const or of pn)Yt.accumulated=Zn[or],Zn[or]=ut[or].evaluate(Yt,an)},Ye}(ae)).load(Xe.features):ae.dynamic?this._dynamicIndex:function(Ye,ft){return new pa(Ye,ft)}(Xe,ae.geojsonVtOptions)}catch(Ye){return me(Ye)}const $e={};if(We){const Ye=_(Me);Ye&&($e.resourceTiming={},$e.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Ye)))}me(null,$e)}})}reloadTile(ae,me){const Me=this.loaded;return Me&&Me[ae.uid]?ae.partial?me(null,void 0):super.reloadTile(ae,me):this.loadTile(ae,me)}loadGeoJSON(ae,me){if(ae.request)i.n(ae.request,me);else{if(typeof ae.data!="string")return me(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));try{return me(null,JSON.parse(ae.data))}catch{return me(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ae,me){try{me(null,this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId))}catch(Me){me(Me)}}getClusterChildren(ae,me){try{me(null,this._geoJSONIndex.getChildren(ae.clusterId))}catch(Me){me(Me)}}getClusterLeaves(ae,me){try{me(null,this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset))}catch(Me){me(Me)}}}class Tt{constructor(ae,me){this.tileID=new i.aM(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ae.projection,this.brightness=me}parse(ae,me,Me,We){this.status="parsing";const je=new i.aM(Me.tileID.overscaledZ,Me.tileID.wrap,Me.tileID.canonical.z,Me.tileID.canonical.x,Me.tileID.canonical.y),Xe=[],$e=me.familiesBySource[Me.source],Ye=new i.f0(je,Me.promoteId);Ye.bucketLayerIDs=[],Ye.is3DTile=!0,i.fi(ae).then(ft=>{if(!ft)return We(new Error("Could not parse tile"));const St=i.fj(ft,1/i.cT(Me.tileID.canonical)),ut=ft.json.extensionsUsed&&ft.json.extensionsUsed.includes("MAPBOX_mesh_features")||ft.json.asset.extras&&ft.json.asset.extras.MAPBOX_mesh_features,Yt=ft.json.extensionsUsed&&ft.json.extensionsUsed.includes("EXT_meshopt_compression"),an=new i.aa(this.zoom,{brightness:this.brightness});for(const pn in $e)for(const Zn of $e[pn]){const er=Zn[0];Ye.bucketLayerIDs.push(Zn.map(pr=>i.C(pr.id,pr.scope))),er.recalculate(an,[]);const or=new i.fk(Zn,St,je,ut,Yt,this.brightness,Ye);ut||(or.needsUpload=!0),Xe.push(or),or.evaluate(er)}this.status="done",We(null,{buckets:Xe,featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(ft=>We(new Error(ft.message)))}}class pi{constructor(ae,me,Me,We,je,Xe,$e){this.actor=ae,this.layerIndex=me,this.availableImages=Me,this.availableModels=We,this.brightness=$e,this.loading={},this.loaded={}}loadTile(ae,me){const Me=ae.uid,We=this.loading[Me]=new Tt(ae,this.brightness);i.br(ae.request,(je,Xe)=>{const $e=!this.loading[Me];return delete this.loading[Me],$e||je?(We.status="done",$e||(this.loaded[Me]=We),me(je)):Xe&&Xe.byteLength!==0?void We.parse(Xe,this.layerIndex,ae,(Ye,ft)=>{We.status="done",this.loaded=this.loaded||{},this.loaded[Me]=We,Ye||!ft?me(Ye):me(null,ft)}):(We.status="done",this.loaded[Me]=We,me())})}reloadTile(ae,me){const Me=this.loaded,We=ae.uid;if(Me&&Me[We]){const je=Me[We];je.projection=ae.projection,je.brightness=ae.brightness;const Xe=($e,Ye)=>{je.reloadCallback&&(delete je.reloadCallback,this.loadTile(ae,me)),me($e,Ye)};je.status==="parsing"?je.reloadCallback=Xe:je.status==="done"&&this.loadTile(ae,me)}}abortTile(ae,me){const Me=ae.uid;this.loading[Me]&&delete this.loading[Me],me()}removeTile(ae,me){const Me=this.loaded,We=ae.uid;Me&&Me[We]&&delete Me[We],me()}}class Yi{constructor(ae){this.self=ae,this.actor=new i.fm(ae,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.y,this.projections={},this.defaultProjection=i.ce({name:"mercator"}),this.workerSourceTypes={vector:V,geojson:Cl,"raster-dem":H,"raster-array":q,"batched-model":pi},this.workerSources={},this.self.registerWorkerSource=(me,Me)=>{if(this.workerSourceTypes[me])throw new Error(`Worker source with name "${me}" already registered.`);this.workerSourceTypes[me]=Me},this.self.registerRTLTextPlugin=me=>{if(i.fn.isParsed())throw new Error("RTL text plugin already registered.");i.fn.applyArabicShaping=me.applyArabicShaping,i.fn.processBidirectionalText=me.processBidirectionalText,i.fn.processStyledBidirectionalText=me.processStyledBidirectionalText}}clearCaches(ae,me,Me){delete this.layerIndexes[ae],delete this.availableImages[ae],delete this.availableModels[ae],delete this.workerSources[ae],Me()}checkIfReady(ae,me,Me){Me()}setReferrer(ae,me){this.referrer=me}spriteLoaded(ae,me){this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={});const{scope:Me,isLoaded:We}=me;if(this.isSpriteLoaded[ae][Me]=We,this.workerSources[ae]&&this.workerSources[ae][Me])for(const je in this.workerSources[ae][Me]){const Xe=this.workerSources[ae][Me][je];for(const $e in Xe){const Ye=Xe[$e];Ye instanceof V&&(Ye.isSpriteLoaded=We,Ye.fire(new i.A("isSpriteLoaded")))}}}setImages(ae,me,Me){this.availableImages[ae]||(this.availableImages[ae]={});const{scope:We,images:je}=me;if(this.availableImages[ae][We]=je,this.workerSources[ae]&&this.workerSources[ae][We]){for(const Xe in this.workerSources[ae][We]){const $e=this.workerSources[ae][We][Xe];for(const Ye in $e)$e[Ye].availableImages=je}Me()}else Me()}setModels(ae,{scope:me,models:Me},We){if(this.availableModels[ae]||(this.availableModels[ae]={}),this.availableModels[ae][me]=Me,this.workerSources[ae]&&this.workerSources[ae][me]){for(const je in this.workerSources[ae][me]){const Xe=this.workerSources[ae][me][je];for(const $e in Xe)Xe[$e].availableModels=Me}We()}else We()}setProjection(ae,me){this.projections[ae]=i.ce(me)}setBrightness(ae,me,Me){this.brightness=me,Me()}setLayers(ae,me,Me){this.getLayerIndex(ae,me.scope).replace(me.layers,me.options),Me()}updateLayers(ae,me,Me){this.getLayerIndex(ae,me.scope).update(me.layers,me.removedIds,me.options),Me()}loadTile(ae,me,Me){me.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,me.type,me.source,me.scope).loadTile(me,Me)}decodeRasterArray(ae,me,Me){this.getWorkerSource(ae,me.type,me.source,me.scope).decodeRasterArray(me,Me)}reloadTile(ae,me,Me){me.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,me.type,me.source,me.scope).reloadTile(me,Me)}abortTile(ae,me,Me){this.getWorkerSource(ae,me.type,me.source,me.scope).abortTile(me,Me)}removeTile(ae,me,Me){this.getWorkerSource(ae,me.type,me.source,me.scope).removeTile(me,Me)}removeSource(ae,me,Me){if(!(this.workerSources[ae]&&this.workerSources[ae][me.scope]&&this.workerSources[ae][me.scope][me.type]&&this.workerSources[ae][me.scope][me.type][me.source]))return;const We=this.workerSources[ae][me.scope][me.type][me.source];delete this.workerSources[ae][me.scope][me.type][me.source],We.removeSource!==void 0?We.removeSource(me,Me):Me()}loadWorkerSource(ae,me,Me){try{this.self.importScripts(me.url),Me()}catch(We){Me(We.toString())}}syncRTLPluginState(ae,me,Me){try{i.fn.setState(me);const We=i.fn.getPluginURL();if(i.fn.isLoaded()&&!i.fn.isParsed()&&We!=null){this.self.importScripts(We);const je=i.fn.isParsed();Me(je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${We}`),je)}}catch(We){Me(We.toString())}}setDracoUrl(ae,me){this.dracoUrl=me}getAvailableImages(ae,me){this.availableImages[ae]||(this.availableImages[ae]={});let Me=this.availableImages[ae][me];return Me||(Me=[]),Me}getAvailableModels(ae,me){this.availableModels[ae]||(this.availableModels[ae]={});let Me=this.availableModels[ae][me];return Me||(Me={}),Me}getLayerIndex(ae,me){this.layerIndexes[ae]||(this.layerIndexes[ae]={});let Me=this.layerIndexes[ae][me];return Me||(Me=this.layerIndexes[ae][me]=new A,Me.scope=me),Me}getWorkerSource(ae,me,Me,We){const je=this.workerSources;return je[ae]||(je[ae]={}),je[ae][We]||(je[ae][We]={}),je[ae][We][me]||(je[ae][We][me]={}),this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={}),je[ae][We][me][Me]||(je[ae][We][me][Me]=new this.workerSourceTypes[me]({send:(Xe,$e,Ye,ft,St,ut)=>this.actor.send(Xe,$e,Ye,ae,St,ut),scheduler:this.actor.scheduler},this.getLayerIndex(ae,We),this.getAvailableImages(ae,We),this.getAvailableModels(ae,We),this.isSpriteLoaded[ae][We],void 0,this.brightness)),je[ae][We][me][Me]}rasterizeImagesWorker(ae,me,Me){const We=new Map;for(const[je,{image:Xe,imageVariant:$e}]of me.tasks.entries()){const Ye=this.imageRasterizer.rasterize($e,Xe,me.scope,ae);We.set(je,Ye)}Me(void 0,We)}removeRasterizedImages(ae,me,Me){this.imageRasterizer.removeImagesFromCacheByIds(me.imageIds,me.scope,ae),Me()}enforceCacheSizeLimit(ae,me){i.fo(me)}getWorkerPerformanceMetrics(ae,me,Me){Me(void 0,void 0)}}return i.fl(self)&&(self.worker=new Yi(self)),Yi}),c(["./shared"],function(i){var _="3.12.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},T={mark(m){performance.mark(m)},measure(m,s,h){performance.measure(m,s,h)}};function A(m){const s=m.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var k,R={},B=function(){if(k)return R;function m(g){return!s(g)}function s(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,P,M=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(M);try{P=new Worker(D),S=!0}catch{S=!1}return P&&P.terminate(),URL.revokeObjectURL(D),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var P=S.getContext("2d");if(!P)return!1;var M=P.getImageData(0,0,1,1);return M&&M.width===S.width}()?(h[w=g&&g.failIfMajorPerformanceCaveat]===void 0&&(h[w]=function(S){var P,M=function(D){var j=document.createElement("canvas"),W=Object.create(m.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=D,j.getContext("webgl2",W)}(S);if(!M)return!1;try{P=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!P||M.isContextLost())&&(M.shaderSource(P,"void main() {}"),M.compileShader(P),M.getShaderParameter(P,M.COMPILE_STATUS)===!0)}(w)),h[w]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var w}k=1,R.supported=m,R.notSupportedReason=s;var h={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},R}();function N(m,s,h){const g=document.createElement(m);return s!=null&&(g.className=s),h&&h.appendChild(g),g}function V(m,s,h){const g=document.createElementNS("http://www.w3.org/2000/svg",m);for(const w of Object.keys(s))g.setAttributeNS(null,w,String(s[w]));return h&&h.appendChild(g),g}const H=typeof document<"u"?document.documentElement&&document.documentElement.style:null,G=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;function Q(){H&&G&&(q=H[G],H[G]="none")}function te(){H&&G&&(H[G]=q)}function ue(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",ue,!0)}function fe(){window.addEventListener("click",ue,!0),window.setTimeout(()=>{window.removeEventListener("click",ue,!0)},0)}function ye(m,s){const h=m.getBoundingClientRect();return Fe(m,h,s)}function De(m,s){const h=m.getBoundingClientRect(),g=[];for(let w=0;w<s.length;w++)g.push(Fe(m,h,s[w]));return g}function Ne(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function Fe(m,s,h){const g=m.offsetWidth===s.width?1:m.offsetWidth/s.width;return new i.P((h.clientX-s.left)*g,(h.clientY-s.top)*g)}const Le="01",Ze="NO_ACCESS_TOKEN";class He{constructor(s,h,g){this._transformRequestFn=s,this._customAccessToken=h,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const s=function(){let h="";for(let g=0;g<10;g++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Le,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,h){return this._transformRequestFn&&this._transformRequestFn(s,h)||{url:s}}normalizeStyleURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.params.push(`sdk=js-${_}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeGlyphsURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeModelURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeSourceURL(s,h,g,w){if(!i.f(s))return s;const S=ot(s);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),g&&S.params.push(`language=${g}`),w&&S.params.push(`worldview=${w}`),this._makeAPIURL(S,this._customAccessToken||h)}normalizeIconsetURL(s,h){const g=ot(s);return i.f(s)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||h)):rt(g)}normalizeSpriteURL(s,h,g,w){const S=ot(s);return i.f(s)?(S.path=`/styles/v1${S.path}/sprite${h}${g}`,this._makeAPIURL(S,this._customAccessToken||w)):(S.path+=`${h}${g}`,rt(S))}normalizeTileURL(s,h,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.f(s))return s;const w=ot(s);w.path=w.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||g&&w.authority!=="raster"&&g===512?"@2x":""}${i.m.supported?".webp":"$1"}`),w.authority==="raster"?w.path=`/${i.e.RASTER_URL_PREFIX}${w.path}`:w.authority==="rasterarrays"?w.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${w.path}`:w.authority==="3dtiles"?w.path=`/${i.e.TILES3D_URL_PREFIX}${w.path}`:(w.path=w.path.replace(/^.+\/v4\//,"/"),w.path=`/${i.e.TILE_URL_VERSION}${w.path}`);const S=this._customAccessToken||function(P){for(const M of P){const D=M.match(/^access_token=(.*)$/);if(D)return D[1]}return null}(w.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&w.params.push(`sku=${this._skuToken}`),this._makeAPIURL(w,S)}canonicalizeTileURL(s,h){const g=ot(s);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return s;let w="mapbox://";g.path.match(/^\/raster\/v1\//)?w+=`raster/${g.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?w+=`rasterarrays/${g.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:w+=`tiles/${g.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let S=g.params;return h&&(S=S.filter(P=>!P.match(/^access_token=/))),S.length&&(w+=`?${S.join("&")}`),w}canonicalizeTileset(s,h){const g=!!h&&i.f(h),w=[];for(const S of s.tiles||[])i.h(S)?w.push(this.canonicalizeTileURL(S,g)):w.push(S);return w}_makeAPIURL(s,h){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",w=ot(i.e.API_URL);if(s.protocol=w.protocol,s.authority=w.authority,s.protocol==="http"){const S=s.params.indexOf("secure");S>=0&&s.params.splice(S,1)}if(w.path!=="/"&&(s.path=`${w.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return rt(s);if(h=h||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return s.params=s.params.filter(S=>S.indexOf("access_token")===-1),s.params.push(`access_token=${h||""}`),rt(s)}}const ct=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ot(m){const s=m.match(ct);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function rt(m){const s=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${s}`}const Be="mapbox.eventData";function nt(m){if(!m)return null;const s=m.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.j(s[1]))}catch{return null}}class at{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const h=nt(i.e.ACCESS_TOKEN);let g="";return g=h&&h.u?i.k(h.u):i.e.ACCESS_TOKEN||"",s?`${Be}.${s}:${g}`:`${Be}:${g}`}fetchEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),g=this.getStorageKey("uuid");if(s)try{const w=localStorage.getItem(h);w&&(this.eventData=JSON.parse(w));const S=localStorage.getItem(g);S&&(this.anonId=S)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),g=this.getStorageKey("uuid"),w=this.anonId;if(s&&w)try{localStorage.setItem(g,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,h,g,w){if(!i.e.EVENTS_URL)return;const S=ot(i.e.EVENTS_URL);S.params.push(`access_token=${w||i.e.ACCESS_TOKEN||""}`);const P={event:this.type,created:new Date(s).toISOString()},M=h?i.l(P,h):P,D={url:rt(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};this.pendingRequest=i.p(D,j=>{this.pendingRequest=null,g(j),this.saveEventData(),this.processRequests(w)})}queueRequest(s,h){this.queue.push(s),this.processRequests(h)}}const Mt=new class extends at{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(h=>i.f(h)||i.h(h))&&this.queueRequest(Date.now(),s)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=nt(i.e.ACCESS_TOKEN),h=s?s.u:i.e.ACCESS_TOKEN;let g=h!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),g=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),P=new Date(w),M=(w-this.eventData.lastSuccess)/864e5;g=g||M>=1||M<-1||S.getDate()!==P.getDate()}else g=!0;g?this.postEvent(w,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:Le,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=w,this.eventData.tokenU=h)},m):this.processRequests()}},Nt=Mt.postTurnstileEvent.bind(Mt),rn=new class extends at{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,s,h,g){this.skuToken=s,this.errorCb=g,i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},h):this.errorCb(new Error(Ze)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:Le,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m))}remove(){this.errorCb=null}},un=rn.postMapLoadEvent.bind(rn),en=new class extends at{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let s=this.mapInstanceIdMap.get(m);return s||(s=i.u(),this.mapInstanceIdMap.set(m,s)),s}getEventId(m){const s=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,s+1),s}postStyleLoadEvent(m,s){const{map:h,style:g,importedStyles:w}=s;if(!i.e.EVENTS_URL||!m&&!i.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(h),P={mapInstanceId:S,eventId:this.getEventId(S),style:g};w.length&&(P.importedStyles=w),this.queueRequest({timestamp:Date.now(),payload:P},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:h}=this.queue.shift();this.postEvent(s,h,()=>{},m)}},sn=en.postStyleLoadEvent.bind(en),Vt=new class extends at{constructor(){super("gljs.performance")}postPerformanceEvent(m,s){i.e.EVENTS_URL&&(m||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:h}=this.queue.shift(),g=function(w){const S=performance.getEntriesByType("resource"),P=performance.getEntriesByType("mark"),M=function(ee){const se={};if(ee){for(const oe in ee)if(oe!=="other")for(const he of ee[oe]){const le=`${oe}ResolveRangeMin`,xe=`${oe}ResolveRangeMax`,Te=`${oe}RequestCount`,Pe=`${oe}RequestCachedCount`;se[le]=Math.min(se[le]||1/0,he.startTime),se[xe]=Math.max(se[xe]||-1/0,he.responseEnd);const ze=ke=>{se[ke]===void 0&&(se[ke]=0),++se[ke]};he.transferSize!==void 0&&he.transferSize===0&&ze(Pe),ze(Te)}}return se}(function(ee,se){const oe={};if(ee)for(const he of ee){const le=se(he);oe[le]===void 0&&(oe[le]=[]),oe[le].push(he)}return oe}(S,A)),D=window.devicePixelRatio,j=navigator.connection||navigator.mozConnection||navigator.webkitConnection,W=j?j.effectiveType:void 0,K={counters:[],metadata:[],attributes:[]},Z=(ee,se,oe)=>{oe!=null&&ee.push({name:se,value:oe.toString()})};for(const ee in M)Z(K.counters,ee,M[ee]);if(w.interactionRange[0]!==1/0&&w.interactionRange[1]!==-1/0&&(Z(K.counters,"interactionRangeMin",w.interactionRange[0]),Z(K.counters,"interactionRangeMax",w.interactionRange[1])),P)for(const ee of Object.keys(b)){const se=b[ee],oe=P.find(he=>he.name===se);oe&&Z(K.counters,se,oe.startTime)}return Z(K.counters,"visibilityHidden",w.visibilityHidden),Z(K.attributes,"style",function(ee){if(ee)for(const se of ee){const oe=se.name.split("?")[0];if(i.i(oe)){const he=oe.split("/").slice(-2);if(he.length===2)return`mapbox://styles/${he[0]}/${he[1]}`}}}(S)),Z(K.attributes,"terrainEnabled",w.terrainEnabled?"true":"false"),Z(K.attributes,"fogEnabled",w.fogEnabled?"true":"false"),Z(K.attributes,"projection",w.projection),Z(K.attributes,"zoom",w.zoom),Z(K.metadata,"devicePixelRatio",D),Z(K.metadata,"connectionEffectiveType",W),Z(K.metadata,"navigatorUserAgent",navigator.userAgent),Z(K.metadata,"screenWidth",window.screen.width),Z(K.metadata,"screenHeight",window.screen.height),Z(K.metadata,"windowWidth",window.innerWidth),Z(K.metadata,"windowHeight",window.innerHeight),Z(K.metadata,"mapWidth",w.width/D),Z(K.metadata,"mapHeight",w.height/D),Z(K.metadata,"webglRenderer",w.renderer),Z(K.metadata,"webglVendor",w.vendor),Z(K.metadata,"sdkVersion",_),Z(K.metadata,"sdkIdentifier","mapbox-gl-js"),K}(h);for(const w of g.metadata);for(const w of g.counters);for(const w of g.attributes);this.postEvent(s,g,()=>{},m)}},$n=Vt.postPerformanceEvent.bind(Vt),Gt=new class extends at{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,s,h,g){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const w=ot(i.e.API_URL+i.e.SESSION_PATH);w.params.push(`sku=${s||""}`),w.params.push(`access_token=${g||i.e.ACCESS_TOKEN||""}`);const S={url:rt(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(S,P=>{this.pendingRequest=null,h(P),this.saveEventData(),this.processRequests(g)})}getSessionAPI(m,s,h,g){this.skuToken=s,this.errorCb=g,i.e.SESSION_PATH&&i.e.API_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},h):this.errorCb(new Error(Ze)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||this.getSession(h,this.skuToken,g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m)}remove(){this.errorCb=null}},Tn=Gt.getSessionAPI.bind(Gt),hn=new Set;function yt(m,s){s?hn.add(m):hn.delete(m)}class In{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,h){this._updatedSourceCaches[s]=h,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const h=s.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(s.id),this.setDirty()}removeLayer(s){const h=s.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][s.id]=s,this._updatedLayers[h].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const h in this._updatedLayers)s[h]=s[h]||{},s[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)s[h]=s[h]||{},s[h].removedIds=Object.keys(this._removedLayers[h]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(s){return this._updatedImages[s]?Array.from(this._updatedImages[s].values()):[]}updateImage(s,h){this._updatedImages[h]=this._updatedImages[h]||new Set,this._updatedImages[h].add(i.I.toString(s)),this.setDirty()}resetUpdatedImages(s){this._updatedImages[s]&&this._updatedImages[s].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Kn(m){const{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class Ar extends i.E{constructor(s){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}addScope(s){this.loaded.set(s,!1),this.imageProviders.set(s,new Map),this.images.set(s,new Map),this.updatedImages.set(s,new Set),this.callbackDispatchedThisFrame.set(s,new Set),this.patterns.set(s,new Map),this.atlasImage.set(s,new i.r({width:1,height:1}))}removeScope(s){this.loaded.delete(s),this.imageProviders.delete(s),this.images.delete(s),this.updatedImages.delete(s),this.callbackDispatchedThisFrame.delete(s),this.patterns.delete(s),this.atlasImage.delete(s);const h=this.atlasTexture.get(s);h&&(h.destroy(),this.atlasTexture.delete(s))}addImageProvider(s,h){this.imageProviders.has(h)||this.imageProviders.set(h,new Map),this.imageProviders.get(h).set(s.id,s)}removeImageProvider(s,h){this.imageProviders.has(h)&&this.imageProviders.get(h).delete(s)}getPendingImageProviders(){const s=[];for(const h of this.imageProviders.values())for(const g of h.values())g.hasPendingRequests()&&s.push(g);return s}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.y),this._imageRasterizer}isLoaded(){for(const s of this.loaded.keys())if(!this.loaded.get(s))return!1;return!0}setLoaded(s,h){if(this.loaded.get(h)!==s&&(this.loaded.set(h,s),s)){for(const{ids:g,callback:w}of this.requestors)this._notify(g,h,w);this.requestors=[]}}hasImage(s,h){return!!this.getImage(s,h)}getImage(s,h){return this.images.get(h).get(s.toString())}addImage(s,h,g){this._validate(s,g)&&this.images.get(h).set(s.toString(),g)}_validate(s,h){let g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "content" value`))),g=!1),g}_validateStretch(s,h){if(!s)return!0;let g=0;for(const w of s){if(w[0]<g||w[1]<w[0]||h<w[1])return!1;g=w[1]}return!0}_validateContent(s,h){return s?s.length!==4||!h.usvg&&(s[0]<0||h.data.width<s[0]||s[1]<0||h.data.height<s[1]||s[2]<0||h.data.width<s[2]||s[3]<0||h.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,h,g){const w=this.images.get(h).get(s.toString());g.version=w.version+1,this.images.get(h).set(s.toString(),g),this.updatedImages.get(h).add(s),this.removeFromImageRasterizerCache(s,h)}clearUpdatedImages(s){this.updatedImages.get(s).clear()}removeFromImageRasterizerCache(s,h){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:h}):this.imageRasterizer.removeImagesFromCacheByIds([s],h))}removeImage(s,h){const g=this.images.get(h),w=g.get(s.toString());g.delete(s.toString()),this.patterns.get(h).delete(s.toString()),this.removeFromImageRasterizerCache(s,h),w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(s){return Array.from(this.images.get(s).keys()).map(h=>i.I.from(h))}getImages(s,h,g){const w=[],S=[],P=this.imageProviders.get(h);for(const W of s){if(!W.iconsetId){w.push(W);continue}const K=P.get(W.iconsetId);K&&(this.getImage(W,h)?S.push(W):K.addPendingRequest(W))}if(w.length===0)return void this._notify(S,h,g);let M=!0;const D=!!this.loaded.get(h),j=this.images.get(h);if(!D)for(const W of w)j.has(W.toString())||(M=!1);D||M?this._notify(w,h,g):this.requestors.push({ids:w,scope:h,callback:g})}rasterizeImages(s,h){const g=new Map,{tasks:w,scope:S}=s;for(const[P,M]of w.entries()){const D=this.getImage(M.id,S);D&&g.set(P,{image:D,imageVariant:M})}this._rasterizeImages(S,g,h)}_rasterizeImages(s,h,g){if(i.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:h,scope:s},g);else{const w=new Map;for(const[S,{image:P,imageVariant:M}]of h.entries())w.set(S,this.imageRasterizer.rasterize(M,P,s,0));g(void 0,w)}}getUpdatedImages(s){return this.updatedImages.get(s)||new Set}_notify(s,h,g){const w=this.images.get(h),S=new Map;for(const P of s){if(!w.get(P.toString())){if(P.iconsetId)continue;this.fire(new i.A("styleimagemissing",{id:P.name}))}const M=w.get(P.toString());if(!M){i.w(`Image "${P.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const D={data:M.usvg?null:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,usvg:M.usvg,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!!(M.userImage&&M.userImage.render)};M.usvg&&Object.assign(D,{width:M.icon.usvg_tree.width,height:M.icon.usvg_tree.height}),S.set(i.I.toString(P),D)}g(null,S)}getPixelSize(s){const{width:h,height:g}=this.atlasImage.get(s);return{width:h,height:g}}getPattern(s,h,g){const w=s.toString(),S=this.patterns.get(h),P=S.get(w),M=this.getImage(s,h);if(!M)return null;if(P){if(P.position.version===M.version)return P.position;P.position.version=M.version}else{if(M.usvg&&!M.data){const D=this.getPatternInFlightId(w,h);if(this.patternsInFlight.has(D))return null;this.patternsInFlight.add(D);const j=new i.B(s).scaleSelf(i.q.devicePixelRatio),W=new Map([[j.toString(),{image:M,imageVariant:j}]]);return this._rasterizeImages(h,W,(K,Z)=>this.storePatternImage(j,h,M,g,Z)),null}this.storePattern(s,h,M)}return this._updatePatternAtlas(h,g),S.get(w).position}getPatternInFlightId(s,h){return i.C(s,h)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,h,g,w,S){const P=s.toString(),M=S?S.get(P):void 0;M&&(g.data=M,this.storePattern(s.id,h,g),this._updatePatternAtlas(h,w),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),h)))}storePattern(s,h,g){const w={w:g.data.width+2*i.F,h:g.data.height+2*i.F,x:0,y:0},S=new i.G(w,g,i.F);this.patterns.get(h).set(s.toString(),{bin:w,position:S})}bind(s,h){const g=s.gl;let w=this.atlasTexture.get(h);w?this.dirty&&(w.update(this.atlasImage.get(h)),this.dirty=!1):(w=new i.T(s,this.atlasImage.get(h),g.RGBA8),this.atlasTexture.set(h,w)),w.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,h){const g=this.patterns.get(s),w=Array.from(g.values()).map(({bin:j})=>j),{w:S,h:P}=i.H(w),M=this.atlasImage.get(s);M.resize({width:S||1,height:P||1});const D=this.images.get(s);for(const[j,{bin:W,position:K}]of g.entries()){let Z=K.padding;const ee=W.x+Z,se=W.y+Z,oe=D.get(j).data,he=oe.width,le=oe.height;Z=Z>1?Z-1:Z,i.r.copy(oe,M,{x:0,y:0},{x:ee,y:se},{width:he,height:le},h),i.r.copy(oe,M,{x:0,y:le-Z},{x:ee,y:se-Z},{width:he,height:Z},h),i.r.copy(oe,M,{x:0,y:0},{x:ee,y:se+le},{width:he,height:Z},h),i.r.copy(oe,M,{x:he-Z,y:0},{x:ee-Z,y:se},{width:Z,height:le},h),i.r.copy(oe,M,{x:0,y:0},{x:ee+he,y:se},{width:Z,height:le},h),i.r.copy(oe,M,{x:he-Z,y:le-Z},{x:ee-Z,y:se-Z},{width:Z,height:Z},h),i.r.copy(oe,M,{x:0,y:le-Z},{x:ee+he,y:se-Z},{width:Z,height:Z},h),i.r.copy(oe,M,{x:0,y:0},{x:ee+he,y:se+le},{width:Z,height:Z},h),i.r.copy(oe,M,{x:he-Z,y:0},{x:ee-Z,y:se+le},{width:Z,height:Z},h)}this.dirty=!0}beginFrame(){for(const s of this.images.keys())this.callbackDispatchedThisFrame.set(s,new Set)}dispatchRenderCallbacks(s,h){const g=this.images.get(h);for(const w of s){if(this.callbackDispatchedThisFrame.get(h).has(w.toString()))continue;this.callbackDispatchedThisFrame.get(h).add(w.toString());const S=g.get(w.toString());Kn(S)&&this.updateImage(w,h,S)}}}function _r(m){const s=m.key,h=m.value,g=m.valueSpec||{},w=m.objectElementValidators||{},S=m.style,P=m.styleSpec;let M=[];const D=i.K(h);if(D!=="object")return[new i.V(s,h,`object expected, ${D} found`)];for(const j in h){const W=j.split(".")[0];let K;w[W]?K=w[W]:g[W]?K=ci:w["*"]?K=w["*"]:g["*"]&&(K=ci),K?M=M.concat(K({key:(s&&`${s}.`)+j,value:h[j],valueSpec:g[W]||g["*"],style:S,styleSpec:P,object:h,objectKey:j},h)):M.push(new i.J(s,h[j],`unknown property "${j}"`))}for(const j in g)w[j]||g[j].required&&g[j].default===void 0&&h[j]===void 0&&M.push(new i.V(s,h,`missing required property "${j}"`));return M}function Vr(m){const s=m.value,h=m.valueSpec,g=m.style,w=m.styleSpec,S=m.key,P=m.arrayElementValidator||ci;if(i.K(s)!=="array")return[new i.V(S,s,`array expected, ${i.K(s)} found`)];if(h.length&&s.length!==h.length)return[new i.V(S,s,`array length ${h.length} expected, length ${s.length} found`)];if(h["min-length"]&&s.length<h["min-length"])return[new i.V(S,s,`array length at least ${h["min-length"]} expected, length ${s.length} found`)];let M={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};w.$version<7&&(M.function=h.function),i.K(h.value)==="object"&&(M=h.value);let D=[];for(let j=0;j<s.length;j++)D=D.concat(P({array:s,arrayIndex:j,value:s[j],valueSpec:M,style:g,styleSpec:w,key:`${S}[${j}]`},!0));return D}function it(m){const s=m.key,h=m.value,g=m.valueSpec;let w=i.K(h);if(w==="number"&&h!=h&&(w="NaN"),w!=="number")return[new i.V(s,h,`number expected, ${w} found`)];if("minimum"in g){let S=g.minimum;if(i.K(g.minimum)==="array"&&(S=g.minimum[m.arrayIndex]),h<S)return[new i.V(s,h,`${h} is less than the minimum value ${S}`)]}if("maximum"in g){let S=g.maximum;if(i.K(g.maximum)==="array"&&(S=g.maximum[m.arrayIndex]),h>S)return[new i.V(s,h,`${h} is greater than the maximum value ${S}`)]}return[]}function Pt(m){const s=m.valueSpec,h=i.M(m.value.type);let g,w,S,P={};const M=h!=="categorical"&&m.value.property===void 0,D=!M,j=i.K(m.value.stops)==="array"&&i.K(m.value.stops[0])==="array"&&i.K(m.value.stops[0][0])==="object",W=_r({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(ee){if(h==="identity")return[new i.V(ee.key,ee.value,'identity function may not have a "stops" property')];let se=[];const oe=ee.value;return se=se.concat(Vr({key:ee.key,value:oe,valueSpec:ee.valueSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:K})),i.K(oe)==="array"&&oe.length===0&&se.push(new i.V(ee.key,oe,"array must have at least one stop")),se},default:function(ee){return ci({key:ee.key,value:ee.value,valueSpec:s,style:ee.style,styleSpec:ee.styleSpec})}}});return h==="identity"&&M&&W.push(new i.V(m.key,m.value,'missing required property "property"')),h==="identity"||m.value.stops||W.push(new i.V(m.key,m.value,'missing required property "stops"')),h==="exponential"&&m.valueSpec.expression&&!i.N(m.valueSpec)&&W.push(new i.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(D&&!i.O(m.valueSpec)?W.push(new i.V(m.key,m.value,"property functions not supported")):M&&!i.Q(m.valueSpec)&&W.push(new i.V(m.key,m.value,"zoom functions not supported"))),h!=="categorical"&&!j||m.value.property!==void 0||W.push(new i.V(m.key,m.value,'"property" property is required')),W;function K(ee){let se=[];const oe=ee.value,he=ee.key;if(i.K(oe)!=="array")return[new i.V(he,oe,`array expected, ${i.K(oe)} found`)];if(oe.length!==2)return[new i.V(he,oe,`array length 2 expected, length ${oe.length} found`)];if(j){if(i.K(oe[0])!=="object")return[new i.V(he,oe,`object expected, ${i.K(oe[0])} found`)];if(oe[0].zoom===void 0)return[new i.V(he,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new i.V(he,oe,"object stop key must have value")];const le=i.M(oe[0].zoom);if(typeof le!="number")return[new i.V(he,oe[0].zoom,"stop zoom values must be numbers")];if(S&&S>le)return[new i.V(he,oe[0].zoom,"stop zoom values must appear in ascending order")];le!==S&&(S=le,w=void 0,P={}),se=se.concat(_r({key:`${he}[0]`,value:oe[0],valueSpec:{zoom:{}},style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:it,value:Z}}))}else se=se.concat(Z({key:`${he}[0]`,value:oe[0],valueSpec:{},style:ee.style,styleSpec:ee.styleSpec},oe));return i.S(i.U(oe[1]))?se.concat([new i.V(`${he}[1]`,oe[1],"expressions are not allowed in function stops.")]):se.concat(ci({key:`${he}[1]`,value:oe[1],valueSpec:s,style:ee.style,styleSpec:ee.styleSpec}))}function Z(ee,se){const oe=i.K(ee.value),he=i.M(ee.value),le=ee.value!==null?ee.value:se;if(g){if(oe!==g)return[new i.V(ee.key,le,`${oe} stop domain type must match previous stop domain type ${g}`)]}else g=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof he!="number"&&typeof he!="string"&&typeof he!="boolean")return[new i.V(ee.key,le,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&h!=="categorical"){let xe=`number expected, ${oe} found`;return i.O(s)&&h===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(ee.key,le,xe)]}return h!=="categorical"||oe!=="number"||typeof he=="number"&&isFinite(he)&&Math.floor(he)===he?h!=="categorical"&&oe==="number"&&typeof he=="number"&&typeof w=="number"&&w!==void 0&&he<w?[new i.V(ee.key,le,"stop domain values must appear in ascending order")]:(w=he,h==="categorical"&&he in P?[new i.V(ee.key,le,"stop domain values must be unique")]:(P[he]=!0,[])):[new i.V(ee.key,le,`integer expected, found ${String(he)}`)]}}function jt(m){const s=(m.expressionContext==="property"?i.W:i.X)(i.U(m.value),m.valueSpec);if(s.result==="error")return s.value.map(g=>new i.V(`${m.key}${g.key}`,m.value,g.message));const h=s.value.expression||s.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!h.outputDefined())return[new i.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!i.Y(h))return[new i.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return Cn(h,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!i.Z(h,["zoom","feature-state"]))return[new i.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!i._(h))return[new i.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cn(m,s){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const w of s.valueSpec.expression.parameters)h.delete(w);if(h.size===0)return[];const g=[];return m instanceof i.$&&h.has(m.name)?[new i.V(s.key,s.value,`["${m.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(m.eachChild(w=>{g.push(...Cn(w,s))}),g)}function Mn(m){const s=m.key,h=m.value,g=m.valueSpec,w=[];return Array.isArray(g.values)?g.values.indexOf(i.M(h))===-1&&w.push(new i.V(s,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(i.M(h))===-1&&w.push(new i.V(s,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),w}function _n(m){return i.a1(i.U(m.value))?jt(i.L({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):Gn(m)}function Gn(m){const s=m.value,h=m.key;if(i.K(s)!=="array")return[new i.V(h,s,`array expected, ${i.K(s)} found`)];const g=m.styleSpec;let w,S=[];if(s.length<1)return[new i.V(h,s,"filter array must have at least 1 element")];switch(S=S.concat(Mn({key:`${h}[0]`,value:s[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),i.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.M(s[1])==="$type"&&S.push(new i.V(h,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&S.push(new i.V(h,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(w=i.K(s[1]),w!=="string"&&S.push(new i.V(`${h}[1]`,s[1],`string expected, ${w} found`)));for(let P=2;P<s.length;P++)w=i.K(s[P]),i.M(s[1])==="$type"?S=S.concat(Mn({key:`${h}[${P}]`,value:s[P],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&S.push(new i.V(`${h}[${P}]`,s[P],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let P=1;P<s.length;P++)S=S.concat(Gn({key:`${h}[${P}]`,value:s[P],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":w=i.K(s[1]),s.length!==2?S.push(new i.V(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):w!=="string"&&S.push(new i.V(`${h}[1]`,s[1],`string expected, ${w} found`))}return S}function vr(m,s){const h=m.key,g=m.style,w=m.layer,S=m.styleSpec,P=m.value,M=m.objectKey,D=S[`${s}_${m.layerType}`];if(!D)return[];const j=M.match(/^(.*)-use-theme$/);if(s==="paint"&&j&&D[j[1]])return i.S(P)?[].concat(ci({key:m.key,value:P,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:M})):ci({key:h,value:P,valueSpec:{type:"string"},style:g,styleSpec:S});const W=M.match(/^(.*)-transition$/);if(s==="paint"&&W&&D[W[1]]&&D[W[1]].transition)return ci({key:h,value:P,valueSpec:S.transition,style:g,styleSpec:S});const K=m.valueSpec||D[M];if(!K)return[new i.J(h,P,`unknown property "${M}"`)];let Z;if(i.K(P)==="string"&&i.O(K)&&!K.tokens&&(Z=/^{([^}]+)}$/.exec(P))){const se=`\`{ "type": "identity", "property": ${Z?JSON.stringify(Z[1]):'"_"'} }\``;return[new i.V(h,P,`"${M}" does not support interpolation syntax
Use an identity property function instead: ${se}.`)]}const ee=[];if(m.layerType==="symbol")M!=="text-field"||!g||g.glyphs||g.imports||ee.push(new i.V(h,P,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&i.a2(i.U(P))&&i.M(P.type)==="identity"&&ee.push(new i.V(h,P,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&s==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&i.O(K)&&(i.a3(K)||i.Q(K))){const se=i.W(i.U(P),K),oe=se.value.expression||se.value._styleExpression.expression;oe&&!i.Z(oe,["measure-light"])&&(M==="model-emissive-strength"&&i._(oe)&&i.Y(oe)||ee.push(new i.V(h,P,`${M} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(ci({key:m.key,value:P,valueSpec:K,style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:M}))}function ni(m){return vr(m,"paint")}function vi(m){return vr(m,"layout")}function na(m){let s=[];const h=m.value,g=m.key,w=m.style,S=m.styleSpec;h.type||h.ref||s.push(new i.V(g,h,'either "type" or "ref" is required'));let P=i.M(h.type);const M=i.M(h.ref);if(h.id){const D=i.M(h.id);for(let j=0;j<m.arrayIndex;j++){const W=w.layers[j];i.M(W.id)===D&&s.push(new i.V(g,h.id,`duplicate layer id "${h.id}", previously used at line ${W.id.__line__}`))}}if("ref"in h){let D;["type","source","source-layer","filter","layout"].forEach(j=>{j in h&&s.push(new i.V(g,h[j],`"${j}" is prohibited for ref layers`))}),w.layers.forEach(j=>{i.M(j.id)===M&&(D=j)}),D?D.ref?s.push(new i.V(g,h.ref,"ref cannot reference another ref layer")):P=i.M(D.type):typeof M=="string"&&s.push(new i.V(g,h.ref,`ref layer "${M}" not found`))}else if(P!=="background"&&P!=="sky"&&P!=="slot")if(h.source){const D=w.sources&&w.sources[h.source],j=D&&i.M(D.type);D?j==="vector"&&P==="raster"?s.push(new i.V(g,h.source,`layer "${h.id}" requires a raster source`)):j==="raster"&&P!=="raster"?s.push(new i.V(g,h.source,`layer "${h.id}" requires a vector source`)):j!=="vector"||h["source-layer"]?j==="raster-dem"&&P!=="hillshade"?s.push(new i.V(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):j!=="raster-array"||["raster","raster-particle"].includes(P)?P==="line"&&h.paint&&(h.paint["line-gradient"]||h.paint["line-trim-offset"])&&j==="geojson"&&!D.lineMetrics?s.push(new i.V(g,h,`layer "${h.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):P==="raster-particle"&&j!=="raster-array"&&s.push(new i.V(g,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):s.push(new i.V(g,h.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(g,h,`layer "${h.id}" must specify a "source-layer"`)):s.push(new i.V(g,h.source,`source "${h.source}" not found`))}else s.push(new i.V(g,h,'missing required property "source"'));return s=s.concat(_r({key:g,value:h,valueSpec:S.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ci({key:`${g}.type`,value:h.type,valueSpec:S.layer.type,style:m.style,styleSpec:m.styleSpec,object:h,objectKey:"type"}),filter:D=>_n(i.L({layerType:P},D)),layout:D=>_r({layer:h,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":j=>vi(i.L({layerType:P},j))}}),paint:D=>_r({layer:h,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":j=>ni(i.L({layerType:P,layer:h},j))}})}})),s}function fa(m){const s=m.value,h=m.key,g=i.K(s);return g!=="string"?[new i.V(h,s,`string expected, ${g} found`)]:[]}const to={promoteId:function m({key:s,value:h}){if(i.K(h)==="string")return fa({key:s,value:h});if(Array.isArray(h)){const g=[],w=i.U(h),S=i.X(w);return S.result==="error"&&S.value.forEach(P=>{g.push(new i.V(`${s}${P.key}`,null,`${P.message}`))}),i.Z(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const w in h)g.push(...m({key:`${s}.${w}`,value:h[w]}));return g}}};function uo(m){const s=m.value,h=m.key,g=m.styleSpec,w=m.style;if(!s.type)return[new i.V(h,s,'"type" is required')];const S=i.M(s.type);let P=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(s.url||s.tiles||P.push(new i.J(h,s,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return P=P.concat(_r({key:h,value:s,valueSpec:g[`source_${S.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:to})),P;case"geojson":if(P=_r({key:h,value:s,valueSpec:g.source_geojson,style:w,styleSpec:g,objectElementValidators:to}),s.cluster)for(const M in s.clusterProperties){const[D,j]=s.clusterProperties[M],W=typeof D=="string"?[D,["accumulated"],["get",M]]:D;P.push(...jt({key:`${h}.${M}.map`,value:j,expressionContext:"cluster-map"})),P.push(...jt({key:`${h}.${M}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return P;case"video":return _r({key:h,value:s,valueSpec:g.source_video,style:w,styleSpec:g});case"image":return _r({key:h,value:s,valueSpec:g.source_image,style:w,styleSpec:g});case"canvas":return[new i.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Mn({key:`${h}.type`,value:s.type,valueSpec:{values:ja(g)},style:w,styleSpec:g})}}function ja(m){return m.source.reduce((s,h)=>{const g=m[h];return g.type.type==="enum"&&(s=s.concat(Object.keys(g.type.values))),s},[])}function Bo(m){const s=m.value,h=m.styleSpec,g=h.light,w=m.style;let S=[];const P=i.K(s);if(s===void 0)return S;if(P!=="object")return S=S.concat([new i.V("light",s,`object expected, ${P} found`)]),S;for(const M in s){const D=M.match(/^(.*)-transition$/),j=M.match(/^(.*)-use-theme$/);S=S.concat(j&&g[j[1]]?ci({key:M,value:s[M],valueSpec:{type:"string"},style:w,styleSpec:h}):D&&g[D[1]]&&g[D[1]].transition?ci({key:M,value:s[M],valueSpec:h.transition,style:w,styleSpec:h}):g[M]?ci({key:M,value:s[M],valueSpec:g[M],style:w,styleSpec:h}):[new i.V(M,s[M],`unknown property "${M}"`)])}return S}function fo(m){const s=m.value;let h=[];if(!s)return h;const g=i.K(s);if(g!=="object")return h=h.concat([new i.V("light-3d",s,`object expected, ${g} found`)]),h;const w=m.styleSpec,S=w["light-3d"],P=m.key,M=m.style,D=m.style.lights;for(const K of["type","id"])if(!(K in s))return h=h.concat([new i.V("light-3d",s,`missing property ${K} on light`)]),h;if(s.type&&D)for(let K=0;K<m.arrayIndex;K++){const Z=i.M(s.type),ee=D[K];i.M(ee.type)===Z&&h.push(new i.V(P,s.id,`duplicate light type "${s.type}", previously defined at line ${ee.id.__line__}`))}const j=`properties_light_${s.type}`;if(!(j in w))return h=h.concat([new i.V("light-3d",s,`Invalid light type ${s.type}`)]),h;const W=w[j];for(const K in s)if(K==="properties"){const Z=s[K],ee=i.K(Z);if(ee!=="object")return h=h.concat([new i.V("properties",Z,`object expected, ${ee} found`)]),h;for(const se in Z)h=h.concat(W[se]?ci({key:se,value:Z[se],valueSpec:W[se],style:M,styleSpec:w}):[new i.J(m.key,Z[se],`unknown property "${se}"`)])}else{const Z=K.match(/^(.*)-transition$/),ee=K.match(/^(.*)-use-theme$/);h=h.concat(ee&&S[ee[1]]?ci({key:K,value:s[K],valueSpec:{type:"string"},style:M,styleSpec:w}):Z&&S[Z[1]]&&S[Z[1]].transition?ci({key:K,value:s[K],valueSpec:w.transition,style:M,styleSpec:w}):S[K]?ci({key:K,value:s[K],valueSpec:S[K],style:M,styleSpec:w}):[new i.J(K,s[K],`unknown property "${K}"`)])}return h}function $a(m){const s=m.value,h=m.key,g=m.style,w=m.styleSpec,S=w.terrain;let P=[];const M=i.K(s);if(s===void 0||M==="null")return P;if(M!=="object")return P=P.concat([new i.V("terrain",s,`object expected, ${M} found`)]),P;for(const D in s){const j=D.match(/^(.*)-transition$/),W=D.match(/^(.*)-use-theme$/);P=P.concat(W&&S[W[1]]?ci({key:D,value:s[D],valueSpec:{type:"string"},style:g,styleSpec:w}):j&&S[j[1]]&&S[j[1]].transition?ci({key:D,value:s[D],valueSpec:w.transition,style:g,styleSpec:w}):S[D]?ci({key:D,value:s[D],valueSpec:S[D],style:g,styleSpec:w}):[new i.J(D,s[D],`unknown property "${D}"`)])}if(s.source){const D=g.sources&&g.sources[s.source],j=D&&i.M(D.type);D?j!=="raster-dem"&&P.push(new i.V(h,s.source,`terrain cannot be used with a source of type ${String(j)}, it only be used with a "raster-dem" source type`)):P.push(new i.V(h,s.source,`source "${s.source}" not found`))}else P.push(new i.V(h,s,'terrain is missing required property "source"'));return P}function Ua(m){const s=m.value,h=m.style,g=m.styleSpec,w=g.fog;let S=[];const P=i.K(s);if(s===void 0)return S;if(P!=="object")return S=S.concat([new i.V("fog",s,`object expected, ${P} found`)]),S;for(const M in s){const D=M.match(/^(.*)-transition$/),j=M.match(/^(.*)-use-theme$/);S=S.concat(j&&w[j[1]]?ci({key:M,value:s[M],valueSpec:{type:"string"},style:h,styleSpec:g}):D&&w[D[1]]&&w[D[1]].transition?ci({key:M,value:s[M],valueSpec:g.transition,style:h,styleSpec:g}):w[M]?ci({key:M,value:s[M],valueSpec:w[M],style:h,styleSpec:g}):[new i.J(M,s[M],`unknown property "${M}"`)])}return S}const Es={"*":()=>[],array:Vr,boolean:function(m){const s=m.value,h=m.key,g=i.K(s);return g!=="boolean"?[new i.V(h,s,`boolean expected, ${g} found`)]:[]},number:it,color:function(m){const s=m.key,h=m.value,g=i.K(h);return g!=="string"?[new i.V(s,h,`color expected, ${g} found`)]:i.a0.parseCSSColor(h)===null?[new i.V(s,h,`color expected, "${h}" found`)]:[]},enum:Mn,filter:_n,function:Pt,layer:na,object:_r,source:uo,model:i.a4,light:Bo,"light-3d":fo,terrain:$a,fog:Ua,string:fa,formatted:function(m){return fa(m).length===0?[]:jt(m)},resolvedImage:function(m){return fa(m).length===0?[]:jt(m)},projection:function(m){const s=m.value,h=m.styleSpec,g=h.projection,w=m.style;let S=[];const P=i.K(s);if(P==="object")for(const M in s)S=S.concat(ci({key:M,value:s[M],valueSpec:g[M],style:w,styleSpec:h}));else P!=="string"&&(S=S.concat([new i.V("projection",s,`object or string expected, ${P} found`)]));return S},import:function(m){const{value:s,styleSpec:h}=m,{data:g,...w}=s;Object.defineProperty(w,"__line__",{value:s.__line__,enumerable:!1});let S=_r(i.L({},m,{value:w,valueSpec:h.import}));return i.M(w.id)===""&&S.push(new i.V(`${m.key}.id`,w,"import id can't be an empty string")),g&&(S=S.concat(As(g,h,{key:`${m.key}.data`}))),S},iconset:function(m){const s=m.value,h=m.key,g=m.styleSpec,w=m.style;if(!s.type)return[new i.V(h,s,'"type" is required')];const S=i.M(s.type);let P=[];if(P=P.concat(_r({key:h,value:s,valueSpec:g[`iconset_${S}`],style:w,styleSpec:g})),S==="source"&&s.source){const M=w.sources&&w.sources[s.source],D=M&&i.M(M.type);M?D!=="raster-array"&&P.push(new i.V(h,s.source,`iconset cannot be used with a source of type ${String(D)}, it only be used with a "raster-array" source type`)):P.push(new i.V(h,s.source,`source "${s.source}" not found`))}return P}};function ci(m,s=!1){const h=m.value,g=m.valueSpec,w=m.styleSpec;if(g.expression&&i.a2(i.M(h)))return Pt(m);if(g.expression&&i.S(i.U(h)))return jt(m);if(g.type&&Es[g.type]){const S=Es[g.type](m);return s===!0&&S.length>0&&i.K(m.value)==="array"?jt(m):S}return _r(i.L({},m,{valueSpec:g.type?w[g.type]:g}))}function Qa(m){const s=m.value,h=m.key,g=fa(m);return g.length||(s.indexOf("{fontstack}")===-1&&g.push(new i.V(h,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&g.push(new i.V(h,s,'"glyphs" url must include a "{range}" token'))),g}function As(m,s=i.a5,h={}){return ci({key:h.key||"",value:m,valueSpec:s.$root,styleSpec:s,style:m,objectElementValidators:{glyphs:Qa,"*":()=>[]}})}function pa(m,s=i.a5){return Xe(As(m,s))}const Ps=m=>Xe(uo(m)),es=m=>Xe(Bo(m)),Cl=m=>Xe(fo(m)),Tt=m=>Xe($a(m)),pi=m=>Xe(Ua(m)),Yi=m=>Xe(function(s){const h=s.value,g=s.style,w=s.styleSpec,S=w.snow;let P=[];const M=i.K(h);if(h===void 0)return P;if(M!=="object")return P=P.concat([new i.V("snow",h,`object expected, ${M} found`)]),P;for(const D in h){const j=D.match(/^(.*)-transition$/);P=P.concat(j&&S[j[1]]&&S[j[1]].transition?ci({key:D,value:h[D],valueSpec:w.transition,style:g,styleSpec:w}):S[D]?ci({key:D,value:h[D],valueSpec:S[D],style:g,styleSpec:w}):[new i.J(D,h[D],`unknown property "${D}"`)])}return P}(m)),mt=m=>Xe(function(s){const h=s.value,g=s.style,w=s.styleSpec,S=w.rain;let P=[];const M=i.K(h);if(h===void 0)return P;if(M!=="object")return P=P.concat([new i.V("rain",h,`object expected, ${M} found`)]),P;for(const D in h){const j=D.match(/^(.*)-transition$/);P=P.concat(j&&S[j[1]]&&S[j[1]].transition?ci({key:D,value:h[D],valueSpec:w.transition,style:g,styleSpec:w}):S[D]?ci({key:D,value:h[D],valueSpec:S[D],style:g,styleSpec:w}):[new i.J(D,h[D],`unknown property "${D}"`)])}return P}(m)),ae=m=>Xe(na(m)),me=m=>Xe(_n(m)),Me=m=>Xe(ni(m)),We=m=>Xe(vi(m)),je=m=>Xe(i.a4(m));function Xe(m){return m.slice().sort((s,h)=>s.line&&h.line?s.line-h.line:0)}function $e(m,s){let h=!1;if(s&&s.length)for(const g of s)g instanceof i.J?i.w(g.message):(m.fire(new i.z(new Error(g.message))),h=!0);return h}let Ye;class ft extends i.E{constructor(s,h="flat"){super(),this._transitionable=new i.a6(Ye||(Ye=new i.a7({anchor:new i.a8(i.a5.light.anchor),position:new i.a9(i.a5.light.position),color:new i.a8(i.a5.light.color),intensity:new i.a8(i.a5.light.intensity)}))),this.setLight(s,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,h,g={}){this._validate(es,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=h)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,g){return(!g||g.validate!==!1)&&$e(this,s.call(pa,i.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let St=class extends i.E{constructor(m,s,h,g){super(),this.scope=h,this._transitionable=new i.a6(new i.a7({source:new i.a8(i.a5.terrain.source),exaggeration:new i.a8(i.a5.terrain.exaggeration)}),h,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(m,s){this._transitionable.setTransitionOrValue(m,s)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new i.aa(m)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const s=m.value.expression;if(!s)return null;let h=-1,g=-1,w=1;for(const S of s.zoomStops)w=s.evaluate(new i.aa(S)),w>.01?(h=S,g=-1):g=S;return w<.01&&h>0&&g>h?[h,g]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof i.ab}};const ut=45,Yt=65,an=.05;function pn(m,s,h,g){const w=i.af(ut,Yt,h),[S,P]=Zn(m,g);let M=1-Math.min(1,Math.exp((s-S)/(P-S)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*w*m.alpha}function Zn(m,s){const h=.5/Math.tan(.5*s);return[m.range[0]+h,m.range[1]+h]}function er(m,s,h,g,w){const S=i.ad([],[s,h,g],w.mercatorFogMatrix);return pn(m,i.ae(S),w.pitch,w._fov)}function or(m,s,h,g,w,S,P){const M=[[h,g,0],[w,g,0],[w,S,0],[h,S,0]];let D=Number.MAX_VALUE,j=-Number.MAX_VALUE;for(const W of M){const K=i.ad([],W,s),Z=i.ae(K);D=Math.min(D,Z),j=Math.max(j,Z)}return[pn(m,D,P.pitch,P._fov),pn(m,j,P.pitch,P._fov)]}class pr extends i.E{constructor(s,h,g,w){super();const S=new i.a7({range:new i.a8(i.a5.fog.range),color:new i.a8(i.a5.fog.color),"color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a8(i.a5.fog["high-color"]),"high-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a8(i.a5.fog["space-color"]),"space-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a8(i.a5.fog["horizon-blend"]),"star-intensity":new i.a8(i.a5.fog["star-intensity"]),"vertical-range":new i.a8(i.a5.fog["vertical-range"])});this._transitionable=new i.a6(S,g,new Map(w)),this.set(s,w),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new i.ag(S),this.scope=g}get state(){const s=this._transform,h=s.projection.name==="globe",g=i.ah(s.zoom),w=this.properties.get("range"),S=[.5,3];return{range:h?[i.ai(S[0],w[0],g),i.ai(S[1],w[1],g)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,h,g={}){if(this._validate(pi,s,g))return;const w=i.l({},s);for(const S of Object.keys(i.a5.fog))w[S]===void 0&&(w[S]=i.a5.fog[S].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.af(ut,Yt,s))*h.a}getOpacityAtLatLng(s,h){return this._transform.projection.supportsFog?function(g,w,S){const P=i.ac.fromLngLat(w),M=S.elevation?S.elevation.getAtPointOrZero(P):0;return er(g,P.x,P.y,M,S)}(this.state,s,h):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(s.toUnwrapped());return or(this.state,h,0,0,i.aj,i.aj,this._transform)}getOpacityForBounds(s,h,g,w,S){return this._transform.projection.supportsFog?or(this.state,s,h,g,w,S,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Zn(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const g of h){const w=s.points[g];let S;if(w[2]>=0)S=w;else{const P=s.points[g-4];S=i.ak(P,w,P[2]/(P[2]-w[2]))}if(er(this.state,S[0],S[1],0,this._transform)>=an)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,g){return(!g||g.validate!==!1)&&$e(this,s.call(pa,i.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Wi,mr,ui,Cr,hi=class extends i.E{constructor(m,s,h,g){super();const w=Wi||(Wi=new i.a7({density:new i.a8(i.a5.snow.density),intensity:new i.a8(i.a5.snow.intensity),color:new i.a8(i.a5.snow.color),opacity:new i.a8(i.a5.snow.opacity),vignette:new i.a8(i.a5.snow.vignette),"vignette-color":new i.a8(i.a5.snow["vignette-color"]),"center-thinning":new i.a8(i.a5.snow["center-thinning"]),direction:new i.a8(i.a5.snow.direction),"flake-size":new i.a8(i.a5.snow["flake-size"])}));this._transitionable=new i.a6(w,h,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(w),this.scope=h}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),g=i.al(h[0]),w=-Math.max(i.al(h[1]),.01),S=[Math.cos(g)*Math.cos(w),Math.sin(g)*Math.cos(w),Math.sin(w)],P=this.properties.get("vignette"),M=this.properties.get("vignette-color");return M.a=P,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(s.r,s.g,s.b,s.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(m,s,h={}){if(this._validate(Yi,m,h))return;const g=i.l({},m);for(const w of Object.keys(i.a5.snow))g[w]===void 0&&(g[w]=i.a5.snow[w].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,h){return(!h||h.validate!==!1)&&$e(this,m.call(pa,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}},mi=class extends i.E{constructor(m,s,h,g){super();const w=mr||(mr=new i.a7({density:new i.a8(i.a5.rain.density),intensity:new i.a8(i.a5.rain.intensity),color:new i.a8(i.a5.rain.color),opacity:new i.a8(i.a5.rain.opacity),vignette:new i.a8(i.a5.rain.vignette),"vignette-color":new i.a8(i.a5.rain["vignette-color"]),"center-thinning":new i.a8(i.a5.rain["center-thinning"]),direction:new i.a8(i.a5.rain.direction),"droplet-size":new i.a8(i.a5.rain["droplet-size"]),"distortion-strength":new i.a8(i.a5.rain["distortion-strength"])}));this._transitionable=new i.a6(w,h,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(w),this.scope=h}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),g=i.al(h[0]),w=-Math.max(i.al(h[1]),.01),S=[Math.cos(g)*Math.cos(w),Math.sin(g)*Math.cos(w),Math.sin(w)],P=this.properties.get("vignette-color");return P.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(s.r,s.g,s.b,s.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(m,s,h={}){if(this._validate(mt,m,h))return;const g=i.l({},m);for(const w of Object.keys(i.a5.rain))g[w]===void 0&&(g[w]=i.a5.rain[w].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,h){return(!h||h.validate!==!1)&&$e(this,m.call(pa,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}};class no extends i.E{constructor(s,h,g,w){super(),this.scope=g,this._options=s,this.properties=new i.ag(h),this._transitionable=new i.a6(h,g,new Map(w)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,h){this._options=s,this._transitionable.setTransitionOrValue(s.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class vo{constructor(s,h,g,w){this.screenBounds=s,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(s,h){let g,w;if(s instanceof i.P||typeof s[0]=="number"){const S=i.P.convert(s);g=[S],w=h.isPointAboveHorizon(S)}else{const S=i.P.convert(s[0]),P=i.P.convert(s[1]),M=S.add(P)._div(2);g=[S,P],w=i.ao(S,P).every(D=>h.isPointAboveHorizon(D))&&h.isPointAboveHorizon(M)}return new vo(g,h.getCameraPoint(),w,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],w=i.ao(h,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<g.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?w[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(w[3]=this.cameraPoint)),i.ap(w,s)}bufferedCameraGeometryGlobe(s){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],w=i.ao(h,g,s),S=this.cameraPoint.clone();switch(3*((S.y>h.y)+(S.y>g.y))+((S.x>h.x)+(S.x>g.x))){case 0:w[0]=S,w[4]=S.clone();break;case 1:w.splice(1,0,S);break;case 2:w[1]=S;break;case 3:w.splice(4,0,S);break;case 5:w.splice(2,0,S);break;case 6:w[3]=S;break;case 7:w.splice(3,0,S);break;case 8:w[2]=S}return w}containsTile(s,h,g,w=0){const S=s.queryPadding/h._pixelsPerMercatorPixel+1,P=g?this._bufferedCameraMercator(S,h):this._bufferedScreenMercator(S,h);let M=s.tileID.wrap+(P.unwrapped?w:0);const D=P.polygon.map(he=>i.aq(s.tileTransform,he,M));if(!i.ar(D,0,0,i.aj,i.aj))return;M=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const j=this.screenGeometryMercator.polygon.map(he=>i.as(s.tileTransform,he,M)),W=j.map(he=>new i.P(he[0],he[1])),K=h.getFreeCameraOptions().position||new i.ac(0,0,0),Z=i.as(s.tileTransform,K,M),ee=j.map(he=>{const le=i.at(he,he,Z);return i.au(le,le),new i.av(Z,le)}),se=i.aw(s,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:ee,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(oe=i.ax(D),oe.min.x=i.aD(oe.min.x,0,i.aj),oe.min.y=i.aD(oe.min.y,0,i.aj),oe.max.x=i.aD(oe.max.x,0,i.aj),oe.max.y=i.aD(oe.max.y,0,i.aj),oe),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:se};var oe}_bufferedScreenMercator(s,h){const g=Cs(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),h):{polygon:this.bufferedScreenGeometry(s).map(S=>h.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[g]=w,w}}_bufferedCameraMercator(s,h){const g=Cs(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),h):{polygon:this.bufferedCameraGeometry(s).map(S=>h.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[g]=w,w}}_projectAndResample(s,h){const g=function(S,P){const M=i.az([],P.pixelMatrix,P.globeMatrix),D=[0,-i.aE,0,1],j=[0,i.aE,0,1],W=[0,0,0,1];i.aA(D,D,M),i.aA(j,j,M),i.aA(W,W,M);const K=new i.P(D[0]/D[3],D[1]/D[3]),Z=new i.P(j[0]/j[3],j[1]/j[3]),ee=i.aB(S,K)&&D[3]<W[3],se=i.aB(S,Z)&&j[3]<W[3];if(!ee&&!se)return null;const oe=function(Re,Ie,Ve){for(let Ge=1;Ge<Re.length;Ge++){const ht=$o(Ie.pointCoordinate3D(Re[Ge-1]).x),et=$o(Ie.pointCoordinate3D(Re[Ge]).x);if(Ve<0){if(ht<et)return{idx:Ge,t:-ht/(et-1-ht)}}else if(et<ht)return{idx:Ge,t:(1-ht)/(et+1-ht)}}return null}(S,P,ee?-1:1);if(!oe)return null;const{idx:he,t:le}=oe;let xe=he>1?jo(S.slice(0,he),P):[],Te=he<S.length?jo(S.slice(he),P):[];xe=xe.map(Re=>new i.P($o(Re.x),Re.y)),Te=Te.map(Re=>new i.P($o(Re.x),Re.y));const Pe=[...xe];Pe.length===0&&Pe.push(Te[Te.length-1]);const ze=i.ai(Pe[Pe.length-1].y,(Te.length===0?xe[0]:Te[0]).y,le);let ke;return ke=ee?[new i.P(0,ze),new i.P(0,0),new i.P(1,0),new i.P(1,ze)]:[new i.P(1,ze),new i.P(1,1),new i.P(0,1),new i.P(0,ze)],Pe.push(...ke),Te.length===0?Pe.push(xe[0]):Pe.push(...Te),{polygon:Pe.map(Re=>new i.ac(Re.x,Re.y)),unwrapped:!1}}(s,h);if(g)return g;const w=function(S,P){let M=!1,D=-1/0,j=0;for(let K=0;K<S.length-1;K++)S[K].x>D&&(D=S[K].x,j=K);for(let K=0;K<S.length-1;K++){const Z=(j+K)%(S.length-1),ee=S[Z],se=S[Z+1];Math.abs(ee.x-se.x)>.5&&(ee.x<se.x?(ee.x+=1,Z===0&&(S[S.length-1].x+=1)):(se.x+=1,Z+1===S.length-1&&(S[0].x+=1)),M=!0)}const W=i.ay(P.center.lng);return M&&W<Math.abs(W-1)&&S.forEach(K=>{K.x-=1}),{polygon:S,unwrapped:M}}(jo(s,h).map(S=>new i.P($o(S.x),S.y)),h);return{polygon:w.polygon.map(S=>new i.ac(S.x,S.y)),unwrapped:w.unwrapped}}}function jo(m,s){return i.aC(m,h=>{const g=s.pointCoordinate3D(h);h.x=g.x,h.y=g.y},1/256)}function $o(m){return m<0?1+m%1:m%1}function Cs(m){return 100*m|0}function ma(m,s,h,g,w){const S=function(M,D){if(M)return w(M);if(D){if(m.url&&D.tiles&&m.tiles&&delete m.tiles,D.variants){if(!Array.isArray(D.variants))return w(new Error("variants must be an array"));for(const W of D.variants){if(W==null||typeof W!="object"||W.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(W.capabilities))return w(new Error("capabilities must be an array"));if(W.capabilities.length===1&&W.capabilities[0]==="meshopt"){D=i.l(D,W);break}}}const j=i.aF(i.l({},D,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);j.tiles=s.canonicalizeTileset(j,m.url),w(null,j)}},P=function(M,D,j){if(!M)return null;if(!D&&!j)return M;j=j||M.worldview_default;const W=Object.values(M.language||{});if(W.length===0)return null;const K=Object.values(M.worldview||{});if(K.length===0)return null;const Z=W.every(se=>se===D),ee=K.every(se=>se===j);return Z&&ee?M:D in(M.language_options||{})||j in(M.worldview_options||{})?null:M.language_options&&M.worldview_options?M:null}(m.data,h,g);return P?i.q.frame(()=>S(null,P)):m.url?i.n(s.transformRequest(s.normalizeSourceURL(m.url,null,h,g),i.R.Source),S):i.q.frame(()=>{const{data:M,...D}=m;S(null,D)})}function ga(m,s){const h=Math.pow(2,s.z),g=Math.floor(i.ay(m.getWest())*h),w=Math.floor(i.aH(m.getNorth())*h),S=Math.ceil(i.ay(m.getEast())*h),P=Math.ceil(i.aH(m.getSouth())*h);return s.x>=g&&s.x<S&&s.y>=w&&s.y<P}class xo{constructor(s,h,g){this.bounds=s?i.aG.convert(this.validateBounds(s)):null,this.minzoom=h||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}addExtraBounds(s){if(s){this.extraBounds||(this.extraBounds=[]);for(const h of s)this.extraBounds.push(i.aG.convert(this.validateBounds(h)))}}contains(s){if(s.z>this.maxzoom||s.z<this.minzoom||this.bounds&&!ga(this.bounds,s))return!1;if(!this.extraBounds)return!0;for(const h of this.extraBounds)if(ga(h,s))return!0;return!1}static fromTileJSON(s){if(!s.bounds&&!s.extra_bounds)return null;const h=new xo(s.bounds,s.minzoom,s.maxzoom);return h.addExtraBounds(s.extra_bounds),h}}class kr extends i.E{constructor(s,h,g,w){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.aF(h,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new i.aI}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=ma(this._options,this.map._requestManager,h,g,(w,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,w)h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new i.z(w));else if(S){if(i.l(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const P of S.vector_layers)this.vectorLayerIds.push(P.id),S.worldview&&S.worldview[P.source]&&this.localizableLayerIds.add(P.id)}this.tileBounds=xo.fromTileJSON(S),Nt(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(w)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(s,h){const g=s.tileID.canonical.url(this.tiles,this.scheme),w=this.map._requestManager.normalizeTileURL(g),S=this.map._requestManager.transformRequest(w,i.R.Tile),P=this.map.style?this.map.style.getLut(this.scope):null,M=P?{image:P.image.clone()}:null,D={request:S,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:M,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(g)&&(D.worldview=this.map.getWorldview()||this.worldviewDefault,D.localizableLayerIds=this.localizableLayerIds),D.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=h:s.request=s.actor.send("reloadTile",D,j.bind(this));else if(s.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",D,j.bind(this),void 0,!0);else{const W=i.aJ.call({deduped:this._deduped},D,(K,Z)=>{K||!Z?j.call(this,K):(D.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},s.actor&&s.actor.send("loadTile",D,j.bind(this),void 0,!0))},!0);s.request={cancel:W}}function j(W,K){return delete s.request,s.aborted?h(null):W&&W.status!==404?h(W):(K&&K.resourceTiming&&(s.resourceTiming=K.resourceTiming),this.map._refreshExpiredTiles&&K&&s.setExpiryData(K),s.loadVectorData(K,this.map.painter),i.aK(this.dispatcher),h(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Gi extends i.E{constructor(s,h,g,w){super(),this.id=s,this.dispatcher=g,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},h),i.l(this,i.aF(h,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._tileJSONRequest=ma(this._options,this.map._requestManager,null,null,(h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new i.z(h)):g&&(i.l(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(w=>w.id)),this.tileBounds=xo.fromTileJSON(g),Nt(g.tiles),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(h)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,h){const g=i.q.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=i.o(this.map._requestManager.transformRequest(w,i.R.Tile),(S,P,M,D)=>(delete s.request,s.aborted?(s.state="unloaded",h(null)):S?(s.state="errored",h(S)):P?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:M,expires:D}),s.setTexture(P,this.map.painter),s.state="loaded",i.aK(this.dispatcher),void h(null)):h(null)))}abortTile(s,h){s.request&&(s.request.cancel(),delete s.request),h&&h()}unloadTile(s,h){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Il extends Gi{constructor(s,h,g,w){super(s,h,g,w),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=i.l({type:"raster-array"},h)}triggerRepaint(s){const h=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);h&&h.enabled&&g&&h._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,h){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(g,i.R.Tile),S={request:w,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=w,s.actor||(s.actor=this.dispatcher.getActor());const P=(M,D,j,W)=>{if(delete s.request,s.aborted)return s.state="unloaded",h(null);if(M)return M.name==="AbortError"?void 0:(s.state="errored",h(M));if(this.map._refreshExpiredTiles&&D&&s.setExpiryData({cacheControl:j,expires:W}),this.partial)s.state="empty";else{if(!D)return h(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=D}h(null)};s.request=this.partial?s.fetchHeader(void 0,P.bind(this)):s.actor.send("loadTile",S,P.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){const g=s.texture;g&&g instanceof i.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,h,g){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(h,g,(w,S)=>{if(w)return s.state="errored",this.fire(new i.z(w)),void this.triggerRepaint(s);S&&(s._isHeaderLoaded=!0,s.setTexture(S,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:S})=>S===s),g=h&&h.fields,w=g&&g.bands&&g.bands;return w?w[0]:0}getTextureDescriptor(s,h,g){if(!s)return;const w=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let S=null;h instanceof i.aN?S=h.paint.get("raster-array-band"):h instanceof i.aO&&(S=h.paint.get("raster-particle-array-band"));const P=S||this.getInitialBand(w);if(P!=null)if(s.textureDescriptor){if(!s.updateNeeded(w,P)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,w,P)}getImages(s,h){const g=new Map;for(const w of s)for(const S of h){const[P,M]=S.split("/"),D=w.getLayer(P);if(!D||!D.hasBand(M)||!D.hasDataForBand(M))continue;const{bytes:j,tileSize:W,buffer:K}=D.getBandView(M),Z=W+2*K,ee={data:new i.r({width:Z,height:Z},j),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(S,ee)}return g}}const Ml={vector:kr,raster:Gi,"raster-dem":class extends Gi{constructor(m,s,h,g){super(m,s,h,g),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(m,s){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(w,S){w&&(m.state="errored",s(w)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",s(null))}m.request=i.o(this.map._requestManager.transformRequest(h,i.R.Tile),(function(w,S,P,M){if(delete m.request,m.aborted)m.state="unloaded",s(null);else if(w)m.state="errored",s(w);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:P,expires:M});const D=ImageBitmap&&S instanceof ImageBitmap&&i.t(),j=1-(S.width-i.aL(S.width))/2;j<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const W=D?S:i.q.getImageData(S,j),K={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:W,encoding:this.encoding,padding:j};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",K,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const s=m.canonical,h=Math.pow(2,s.z),g=(s.x-1+h)%h,w=s.x===0?m.wrap-1:m.wrap,S=(s.x+1+h)%h,P=s.x+1===h?m.wrap+1:m.wrap,M={};return M[new i.aM(m.overscaledZ,w,s.z,g,s.y).key]={backfilled:!1},M[new i.aM(m.overscaledZ,P,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(M[new i.aM(m.overscaledZ,w,s.z,g,s.y-1).key]={backfilled:!1},M[new i.aM(m.overscaledZ,m.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},M[new i.aM(m.overscaledZ,P,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<h&&(M[new i.aM(m.overscaledZ,w,s.z,g,s.y+1).key]={backfilled:!1},M[new i.aM(m.overscaledZ,m.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},M[new i.aM(m.overscaledZ,P,s.z,S,s.y+1).key]={backfilled:!1}),M}},"raster-array":Il,geojson:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(g),this._data=s.data,this._options=i.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const w=i.aj/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*w,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*w,extent:i.aj,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.aj,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*w,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new i.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new i.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const h of this._data.features)s.set(h.id,h);for(const h of m.features)s.set(h.id,h);this._data.features=[...s.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterChildren(m,s){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterLeaves(m,s,h,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:s,offset:h},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.A("dataloading",{dataType:"source"})),this._loaded=!1;const s=i.l({append:m},this.workerOptions);s.scope=this.scope;const h=this._data;typeof h=="string"?(s.request=this.map._requestManager.transformRequest(i.q.resolveURL(h),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,w)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new i.z(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(S.resourceTiming=w.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new i.A("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const m=i.C(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,s){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,w=g?{image:g.image.clone()}:null,S=this._partialReload,P={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:m.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:S};m.request=this.actor.send(h,P,(M,D)=>S&&!D?(m.state="loaded",s(null)):(delete m.request,m.destroy(),m.aborted?s(null):M?s(M):(m.loadVectorData(D,this.map.painter,h==="reloadTile"),s(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,s){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aP{constructor(m,s,h,g){super(m,s,h,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const s of m.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aQ(this.urls,(s,h)=>{this._loaded=!0,s?this.fire(new i.z(s)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const s=this.video.seekable;m<s.start(0)||m>s.end(0)?this.fire(new i.z(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,s=m.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(m,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aP,model:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const m=[];for(const s in this._options.models){const h=this._options.models[s],g=i.aS(this.map._requestManager.transformRequest(h.uri,i.R.Model).url).then(w=>{if(!w)return;const S=i.aT(w),P=new i.aU(s,h.position,h.orientation,S);P.computeBoundsAndApplyParent(),this.models.push(P)}).catch(w=>{this.fire(new i.z(new Error(`Could not load model ${s} from ${h.uri}: ${w.message}`)))});m.push(g)}Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this._loaded=!0,this.fire(new i.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,s){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(m,s,h,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();const m=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=ma(this._options,this.map._requestManager,s,h,(g,w)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new i.z(g))):w&&(i.l(this,w),w.bounds&&(this.tileBounds=new xo(w.bounds,this.minzoom,this.maxzoom)),Nt(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,s){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(h,i.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.q.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=s;else{if(m.buckets){const S=Object.values(m.buckets);for(const P of S)P.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,w.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,w.bind(this),void 0,!0);function w(S,P){return m.aborted?s(null):S&&S.status!==404?s(S):(this.map._refreshExpiredTiles&&P&&m.setExpiryData(P),m.loadModelData(P,this.map.painter),m.state="loaded",void s(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aP{constructor(m,s,h,g){super(m,s,h,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(S=>typeof S!="number"))||this.fire(new i.z(new i.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.z(new i.V(`sources.${m}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.z(new i.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.z(new i.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.z(new i.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof i.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new xo(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.aF(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:s,y:h,z:g}=m.canonical;return this._implementation.hasTile({x:s,y:h,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,s){const{x:h,y:g,z:w}=m.tileID.canonical,S=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:g,z:w},{signal:S.signal})).then((function(P){return delete m.request,m.aborted?(m.state="unloaded",s(null)):P===void 0?(m.state="errored",s(null)):P===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",s(null)):function(M){return M instanceof ImageData||M instanceof HTMLCanvasElement||M instanceof ImageBitmap||M instanceof HTMLImageElement}(P)?(this.loadTileData(m,P),m.state="loaded",void s(null)):(m.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(P=>{P.name!=="AbortError"&&(m.state="errored",s(P))}),m.request.cancel=()=>S.abort()}loadTileData(m,s){m.setTexture(s,this.map.painter)}unloadTile(m,s){if(m.texture&&m.texture instanceof i.T?(m.destroy(!0),m.texture&&m.texture instanceof i.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:h,y:g,z:w}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:g,z:w})}s&&s()}abortTile(m,s){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=i.C(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}}},rl=function(m,s,h,g){const w=new Ml[s.type](m,s,h,g);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return i.aV(["load","abort","unload","serialize","prepare"],w),w};function mh(m,s,h=""){return`${h}:${s.id||""}:${s.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:w,importId:S}=g;return`featureset:${w}${S?`:import:${S}`:""}`}}(m.target)}`}function Wr(m,s,h,g=""){if(m.uniqueFeatureID){const w=mh(m,s,g);if(h.has(w))return!0;h.add(w)}return!1}function co(m,s,h,g,w=!1){const S=s.sourceCache.transform,P=s.sourceCache.tilesIn(m,s.has3DLayers,w);P.sort(Mo);const M=[];for(const D of P){const j=D.tile.queryRenderedFeatures(s,D,h,g,S,w);Object.keys(j).length&&M.push({wrappedTileID:D.tile.tileID.wrapped().key,queryResults:j})}return M.length===0?{}:function(D){const j={},W={};for(const K of D){const Z=K.queryResults,ee=K.wrappedTileID,se=W[ee]=W[ee]||{};for(const oe in Z){const he=Z[oe],le=se[oe]=se[oe]||{},xe=j[oe]=j[oe]||[];for(const Te of he)le[Te.featureIndex]||(le[Te.featureIndex]=!0,xe.push(Te))}}return j}(M)}function mu(m,s,h,g,w){const S={},P=g.queryRenderedSymbols(m),M=[];for(const D of Object.keys(P).map(Number))M.push(w[D]);M.sort(Mo);for(const D of M){const j=D.featureIndex.lookupSymbolFeatures(P[D.bucketInstanceId],D.bucketIndex,D.sourceLayerIndex,s,h);for(const W in j){const K=S[W]=S[W]||[],Z=j[W];Z.sort((ee,se)=>{const oe=D.featureSortOrder;if(oe){const he=oe.indexOf(ee.featureIndex);return oe.indexOf(se.featureIndex)-he}return se.featureIndex-ee.featureIndex});for(const ee of Z)K.push(ee)}}return S}function gh(m,s){const h=m.getRenderableIds().map(S=>m.getTileByID(S)),g=[],w={};for(let S=0;S<h.length;S++){const P=h[S],M=P.tileID.canonical.key;w[M]||(w[M]=!0,P.querySourceFeatures(g,s))}return g}function Mo(m,s){const h=m.tileID,g=s.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function Mm(m,s){const h={};if(!s)return h;for(const g of m){const w=g.layerIds.map(S=>s.getLayer(S)).filter(Boolean);if(w.length!==0){g.layers=w,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(S=>w.filter(P=>P.id===S)[0]));for(const S of w)h[S.fqid]=g}}return h}const Pa=32,Ca=33,ro=new Uint16Array(8184);for(let m=0;m<2046;m++){let s=m+2,h=0,g=0,w=0,S=0,P=0,M=0;for(1&s?w=S=P=Pa:h=g=M=Pa;(s>>=1)>1;){const j=h+w>>1,W=g+S>>1;1&s?(w=h,S=g,h=P,g=M):(h=w,g=S,w=P,S=M),P=j,M=W}const D=4*m;ro[D+0]=h,ro[D+1]=g,ro[D+2]=w,ro[D+3]=S}const Ia=new Uint16Array(2178),Is=new Uint8Array(1089),Va=new Uint16Array(1089);function gu(m){return m===0?-.03125:m===32?.03125:0}const _u={type:2,extent:i.aj,loadGeometry:()=>[[new i.P(0,0),new i.P(i.aj+1,0),new i.P(i.aj+1,i.aj+1),new i.P(0,i.aj+1),new i.P(0,0)]]};class il{constructor(s,h,g,w,S){this.tileID=s,this.uid=i.a$(),this.uses=0,this.tileSize=h,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection)}registerFadeDuration(s){const h=s+this.timeAdded;h<i.q.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,h,g){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=Mm(s.buckets,h.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const S=this.buckets[w];if(S instanceof i.b1){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const S=this.buckets[w];if(S instanceof i.b1&&S.hasRTLText){this.hasRTLText=!0,i.b2();break}}this.queryPadding=0;for(const w in this.buckets){const S=this.buckets[w],P=h.style.getOwnLayer(w);if(!P)continue;const M=P.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,M)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.b0}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,h,g){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,Mm(s.buckets,h.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const w in this.buckets){const S=this.buckets[w];S.uploadPending()&&S.upload(s)}const h=s.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new i.T(s,g.image,h.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(s,h,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,g),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=h.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this.updateBuckets(h,this._lastUpdatedBrightness!==w),this._lastUpdatedBrightness=w))}queryRenderedFeatures(s,h,g,w,S,P){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const M=function(D,j){const W=i.bn([],[.5*D.width,.5*-D.height,1]);return i.bo(W,W,[1,-1,0]),i.az(W,W,D.calculateProjMatrix(j.toUnwrapped())),Float32Array.from(W)}(S,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:h,pixelPosMatrix:M,transform:w,availableImages:g,tileTransform:this.tileTransform})}querySourceFeatures(s,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const w=g.loadVTLayers(),S=h?h.sourceLayer:"",P=w._geojsonTileLayer||w[S];if(!P)return;const M=i.b3(h&&h.filter),{z:D,x:j,y:W}=this.tileID.canonical,K={z:D,x:j,y:W};for(let Z=0;Z<P.length;Z++){const ee=P.feature(Z);if(M.needGeometry){const he=i.b4(ee,!0);if(!M.filter(new i.aa(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!M.filter(new i.aa(this.tileID.overscaledZ),ee))continue;const se=g.getId(ee,S),oe=new i.b5(ee,D,j,W,se);oe.tile=K,s.push(oe)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const h=this.expirationTime;if(s.cacheControl){const g=i.b6(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let w=!1;if(this.expirationTime>g)w=!1;else if(h)if(this.expirationTime<h)w=!0;else{const S=this.expirationTime-h;S?this.expirationTime=g+Math.max(S,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,h){if(!this.latestFeatureIndex||!s.style)return;const g=this.latestFeatureIndex.loadVTLayers(),w=s.style.listImages(),S=s.style.getBrightness();for(const P in this.buckets){if(!s.style.hasLayer(P))continue;const M=this.buckets[P],D=M.layers[0],j=D.sourceLayer||"_geojsonTileLayer",W=g[j],K=s.style.getLayerSourceCache(D);let Z={};K&&(Z=K._state.getState(j,void 0));const ee=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},se=Object.keys(Z).length>0&&!h;se&&!M.stateDependentLayers.length&&!h||M.update(Z,W,w,ee,se?M.stateDependentLayers:M.layers,h,S),(M instanceof i.b7||M instanceof i.b8)&&s._terrain&&s._terrain.enabled&&K&&M.uploadPending()&&s._terrain._clearRenderCacheForTile(K.id,this.tileID);const oe=s&&s.style&&s.style.getOwnLayer(P);oe&&(this.queryPadding=Math.max(this.queryPadding,oe.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.q.now()+s}setTexture(s,h){const g=h.context,w=g.gl;this.texture=this.texture||h.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(g,s,w.RGBA8,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(s,h){const g={};for(const w of h)g[w]=!0;this.dependencies[s]=g}hasDependency(s,h){for(const g of s){const w=this.dependencies[g];if(w){for(const S of h)if(w[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const g=i.b9(_u,this.tileID.canonical,this.tileTransform)[0],w=new i.ba,S=new i.bb;for(let P=0;P<g.length;P++){const{x:M,y:D}=g[P];w.emplaceBack(M,D),S.emplaceBack(P)}S.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(S),this._tileDebugBuffer=s.createVertexBuffer(w,i.bc.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,w.length,S.length)}_makeTileBoundsBuffers(s,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const g=i.b9(_u,this.tileID.canonical,this.tileTransform)[0];let w,S;if(this.isRaster){const P=function(M,D){const j=i.aW(M,D),W=Math.pow(2,M.z);for(let he=0;he<Ca;he++)for(let le=0;le<Ca;le++){const xe=i.aX((M.x+(le+gu(le))/Pa)/W),Te=i.aY((M.y+(he+gu(he))/Pa)/W),Pe=D.project(xe,Te),ze=he*Ca+le;Ia[2*ze+0]=Math.round((Pe.x*j.scale-j.x)*i.aj),Ia[2*ze+1]=Math.round((Pe.y*j.scale-j.y)*i.aj)}Is.fill(0),Va.fill(0);for(let he=2045;he>=0;he--){const le=4*he,xe=ro[le+0],Te=ro[le+1],Pe=ro[le+2],ze=ro[le+3],ke=xe+Pe>>1,Re=Te+ze>>1,Ie=ke+Re-Te,Ve=Re+xe-ke,Ge=Te*Ca+xe,ht=ze*Ca+Pe,et=Re*Ca+ke,Et=Math.hypot((Ia[2*Ge+0]+Ia[2*ht+0])/2-Ia[2*et+0],(Ia[2*Ge+1]+Ia[2*ht+1])/2-Ia[2*et+1])>=16;Is[et]=Is[et]||(Et?1:0),he<1022&&(Is[et]=Is[et]||Is[(Te+Ve>>1)*Ca+(xe+Ie>>1)]||Is[(ze+Ve>>1)*Ca+(Pe+Ie>>1)])}const K=new i.aZ,Z=new i.a_;let ee=0;function se(he,le){const xe=le*Ca+he;return Va[xe]===0&&(K.emplaceBack(Ia[2*xe+0],Ia[2*xe+1],he*i.aj/Pa,le*i.aj/Pa),Va[xe]=++ee),Va[xe]-1}function oe(he,le,xe,Te,Pe,ze){const ke=he+xe>>1,Re=le+Te>>1;if(Math.abs(he-Pe)+Math.abs(le-ze)>1&&Is[Re*Ca+ke])oe(Pe,ze,he,le,ke,Re),oe(xe,Te,Pe,ze,ke,Re);else{const Ie=se(he,le),Ve=se(xe,Te),Ge=se(Pe,ze);Z.emplaceBack(Ie,Ve,Ge)}}return oe(0,0,Pa,Pa,Pa,0),oe(Pa,Pa,0,0,0,Pa),{vertices:K,indices:Z}}(this.tileID.canonical,h);w=P.vertices,S=P.indices}else{w=new i.aZ,S=new i.a_;for(const{x:M,y:D}of g)w.emplaceBack(M,D,0,0);const P=i.be(w.int16.subarray(0,4*w.length),void 0,4);for(let M=0;M<P.length;M+=3)S.emplaceBack(P[M],P[M+1],P[M+2])}this._tileBoundsBuffer=s.createVertexBuffer(w,i.bf.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(S),this._tileBoundsSegments=i.bd.simpleSegment(0,0,w.length,S.length)}_makeGlobeTileDebugBuffers(s,h){const g=h.projection;if(!g||g.name!=="globe"||h.freezeTileCoverage)return;const w=this.tileID.canonical,S=i.bg(w,h),P=i.bh(S),M=i.ah(h.zoom);let D;M>0&&(D=i.bi(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,w,h,P,D,M),this._makeGlobeTileDebugTextBuffer(s,w,h,P,D,M)}_globePoint(s,h,g,w,S,P,M){let D=i.bj(s,h,g);if(P){const j=1<<g.z,W=i.ay(w.center.lng),K=i.aH(w.center.lat),Z=(g.x+.5)/j-W;let ee=0;Z>.5?ee=-1:Z<-.5&&(ee=1);let se=(s/i.aj+g.x)/j+ee,oe=(h/i.aj+g.y)/j;se=(se-W)*w._pixelsPerMercatorPixel+W,oe=(oe-K)*w._pixelsPerMercatorPixel+K;const he=[se*w.worldSize,oe*w.worldSize,0];i.ad(he,he,P),D=i.bk(D,he,M)}return i.ad(D,D,S)}_makeGlobeTileDebugBorderBuffer(s,h,g,w,S,P){const M=new i.ba,D=new i.bb,j=new i.bl,W=(Z,ee,se,oe,he)=>{const le=(se-Z)/(he-1),xe=(oe-ee)/(he-1),Te=M.length;for(let Pe=0;Pe<he;Pe++){const ze=Z+Pe*le,ke=ee+Pe*xe;M.emplaceBack(ze,ke);const Re=this._globePoint(ze,ke,h,g,w,S,P);j.emplaceBack(Re[0],Re[1],Re[2]),D.emplaceBack(Te+Pe)}},K=i.aj;W(0,0,K,0,16),W(K,0,K,K,16),W(K,K,0,K,16),W(0,K,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(D),this._tileDebugBuffer=s.createVertexBuffer(M,i.bc.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(j,i.bm.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,M.length,D.length)}_makeGlobeTileDebugTextBuffer(s,h,g,w,S,P){const M=i.aj/4,D=new i.ba,j=new i.a_,W=new i.bl,K=25;j.reserve(32),D.reserve(K),W.reserve(K);const Z=(ee,se)=>K*ee+se;for(let ee=0;ee<K;ee++){const se=ee*M;for(let oe=0;oe<K;oe++){const he=oe*M;D.emplaceBack(he,se);const le=this._globePoint(he,se,h,g,w,S,P);W.emplaceBack(le[0],le[1],le[2])}}for(let ee=0;ee<4;ee++)for(let se=0;se<4;se++){const oe=Z(ee,se),he=Z(ee,se+1),le=Z(ee+1,se),xe=Z(ee+1,se+1);j.emplaceBack(oe,he,le),j.emplaceBack(le,he,xe)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(j),this._tileDebugTextBuffer=s.createVertexBuffer(D,i.bc.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(W,i.bm.members),this._tileDebugTextSegments=i.bd.simpleSegment(0,0,K,32)}destroy(s=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bp.setPbf(i.bq);class yu extends il{constructor(s,h,g,w,S){super(s,h,g,w,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,h){const g=h.context,w=g.gl;this.texture=this.texture||h.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s,{premultiply:!1}):this.texture=new i.T(g,s,w.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,h){const g=this._mrt=new i.bp(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.br(w,(S,P,M,D)=>{if(S)h(S);else try{const j=g.getHeaderLength(P);if(j>s)return void(this.request=this.fetchHeader(j,h));g.parseHeader(P),this._isHeaderLoaded=!0;let W=0;for(const K of Object.values(g.layers))W=Math.max(W,K.dataIndex[K.dataIndex.length-1].lastByte);P.byteLength>=W&&(this.entireBuffer=P),h(null,this.entireBuffer||P,M,D)}catch(j){h(j)}}),this.request}fetchBand(s,h,g){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void g(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void g(new Error("Can't fetch tile band without an actor"));let P;const M=(K,Z)=>{P.complete(K,Z),K?g(K):(this.updateTextureDescriptor(s,h),g(null,this.textureDescriptor&&this.textureDescriptor.img))},D=(K,Z)=>{if(K)return g(K);const ee=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Z,task:P},M,void 0,!0);this._workQueue.push(()=>{ee&&ee.cancel(),P.cancel()})},j=w.getLayer(s);if(!j)return void g(new Error(`Unknown sourceLayer "${s}"`));if(j.hasDataForBand(h))return this.updateTextureDescriptor(s,h),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const W=j.getDataRange([h]);if(P=w.createDecodingTask(W),!P||P.tasks.length)if(this.flushQueues(),this.entireBuffer)D(null,this.entireBuffer.slice(W.firstByte,W.lastByte+1));else{const K=Object.assign({},this.requestParams,{headers:{Range:`bytes=${W.firstByte}-${W.lastByte}`}}),Z=i.br(K,D);this._fetchQueue.push(()=>{Z.cancel(),P.cancel()})}else g(null)}updateNeeded(s,h){return(!this.textureDescriptor||this.textureDescriptor.band!==h||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,h){if(!this._mrt)return;const g=this._mrt.getLayer(s);if(!g||!g.hasBand(h)||!g.hasDataForBand(h))return;const{bytes:w,tileSize:S,buffer:P,offset:M,scale:D}=g.getBandView(h),j=S+2*P,W=new i.r({width:j,height:j},w),K=this.texture;K&&K instanceof i.T&&K.update(W,{premultiply:!1}),this.textureDescriptor={layer:s,band:h,img:W,buffer:P,offset:M,tileSize:S,format:g.pixelFormat,mix:[D,256*D,65536*D,16777216*D]}}}class _h{constructor(s,h){this.max=s,this.onRemove=h,this.reset()}reset(){for(const s in this.data)for(const h of this.data[s])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(s,h,g){const w=s.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const S={value:h,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout(()=>{this.remove(s,S)},g)),this.data[w].push(S),this.order.push(w),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const h=this.data[s].shift();return h.timeout&&clearTimeout(h.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),h.value}getByKey(s){const h=this.data[s];return h?h[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,h){if(!this.has(s))return this;const g=s.wrapped().key,w=h===void 0?0:this.data[g].indexOf(h),S=this.data[g][w];return this.data[g].splice(w,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(s){const h=[];for(const g in this.data)for(const w of this.data[g])s(w.value)||h.push(w);for(const g of h)this.remove(g.value.tileID,g)}}class vu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,h,g){const w=String(h);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][w]=this.stateChanges[s][w]||{},i.l(this.stateChanges[s][w],g),this.deletedStates[s]===null){this.deletedStates[s]={};for(const S in this.state[s])S!==w&&(this.deletedStates[s][S]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][w]===null){this.deletedStates[s][w]={};for(const S in this.state[s][w])g[S]||(this.deletedStates[s][w][S]=null)}else for(const S in g)this.deletedStates[s]&&this.deletedStates[s][w]&&this.deletedStates[s][w][S]===null&&delete this.deletedStates[s][w][S]}removeFeatureState(s,h,g){if(this.deletedStates[s]===null)return;const w=String(h);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&h!==void 0)this.deletedStates[s][w]!==null&&(this.deletedStates[s][w]=this.deletedStates[s][w]||{},this.deletedStates[s][w][g]=null);else if(h!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][w])for(g in this.deletedStates[s][w]={},this.stateChanges[s][w])this.deletedStates[s][w][g]=null;else this.deletedStates[s][w]=null;else this.deletedStates[s]=null}getState(s,h){const g=this.state[s]||{},w=this.stateChanges[s]||{},S=this.deletedStates[s];if(S===null)return{};if(h!==void 0){const M=String(h),D=i.l({},g[M],w[M]);if(S){const j=S[h];if(j===null)return{};for(const W in j)delete D[W]}return D}const P=i.l({},g,w);if(S)for(const M in S)delete P[M];return P}initializeTileState(s,h){s.refreshFeatureState(h)}coalesceChanges(s,h){const g={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const S={};for(const P in this.stateChanges[w])this.state[w][P]||(this.state[w][P]={}),i.l(this.state[w][P],this.stateChanges[w][P]),S[P]=this.state[w][P];g[w]=S}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const S={};if(this.deletedStates[w]===null)for(const P in this.state[w])S[P]={},this.state[w][P]={};else for(const P in this.deletedStates[w]){if(this.deletedStates[w][P]===null)this.state[w][P]={};else if(this.state[w][P])for(const M of Object.keys(this.deletedStates[w][P]))delete this.state[w][P][M];S[P]=this.state[w][P]}g[w]=g[w]||{},i.l(g[w],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const w in s)s[w].refreshFeatureState(h)}}class _a extends i.E{constructor(s,h,g){super(),this.id=s,this._onlySymbols=g,h.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new _h(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new vu,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,h){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,h)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(s),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(xu).map(s=>s.key)}getRenderableIds(s,h){const g=[];for(const w in this._tiles)this._isIdRenderable(+w,s,h)&&g.push(this._tiles[w]);return s?g.sort((w,S)=>{const P=w.tileID,M=S.tileID,D=new i.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),j=new i.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-M.overscaledZ||j.y-D.y||j.x-D.x}).map(w=>w.tileID.key):g.map(w=>w.tileID).sort(xu).map(w=>w.key)}hasRenderableParent(s){const h=this.findLoadedParent(s,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(s,h,g){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(h||!this._tiles[s].holdingForFade())&&(g||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,h){const g=this._tiles[s];g&&(g.state!=="loading"&&(g.state=h),this._loadTile(g,this._tileLoaded.bind(this,g,s,h)))}_tileLoaded(s,h,g,w){if(w)if(s.state="errored",w.status!==404)this._source.fire(new i.z(w,{tile:s}));else{if(this._source.fire(new i.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.q.now(),g==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(h,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const h=this.getRenderableIds();for(let w=0;w<h.length;w++){const S=h[w];if(s.neighboringTiles&&s.neighboringTiles[S]){const P=this.getTileByID(S);g(s,P),g(P,s)}}function g(w,S){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let P=S.tileID.canonical.x-w.tileID.canonical.x;const M=S.tileID.canonical.y-w.tileID.canonical.y,D=Math.pow(2,w.tileID.canonical.z),j=S.tileID.key;P===0&&M===0||Math.abs(M)>1||(Math.abs(P)>1&&(Math.abs(P+D)===1?P+=D:Math.abs(P-D)===1&&(P-=D)),S.dem&&w.dem&&(w.dem.backfillBorder(S.dem,P,M),w.neighboringTiles&&w.neighboringTiles[j]&&(w.neighboringTiles[j].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,h,g,w){for(const S in this._tiles){let P=this._tiles[S];if(w[S]||!P.hasData()||P.tileID.overscaledZ<=h||P.tileID.overscaledZ>g)continue;let M=P.tileID;for(;P&&P.tileID.overscaledZ>h+1;){const j=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[j.key],P&&P.hasData()&&(M=j)}let D=M;for(;D.overscaledZ>h;)if(D=D.scaledTo(D.overscaledZ-1),s[D.key]){w[M.key]=M;break}}}findLoadedParent(s,h){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=s.overscaledZ-1;g>=h;g--){const w=s.scaledTo(g),S=this._getLoadedTile(w);if(S)return S}}_getLoadedTile(s){const h=this._tiles[s.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,h){h=h||this._source.tileSize;const g=Math.ceil(s.width/h)+1,w=Math.ceil(s.height/h)+1,S=Math.floor(g*w*5),P=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(M)}handleWrapJump(s){const h=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,h){const g={};for(const w in this._tiles){const S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+h),g[S.tileID.key]=S}this._tiles=g;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(s,h,g,w,S){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(s,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let M,D=this._source.maxzoom;const j=this.map&&this.map.painter?this.map.painter._terrain:null;if(j&&j.sourceCache===this&&j.attenuationRange()){const Z=j.attenuationRange()[0],ee=Math.floor(Z)-Math.log2(j.getDemUpscale());D>ee&&(D=ee)}if(this.used||this.usedForTerrain){if(this._source.tileID)M=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new i.aM(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=s.clone();Z.tileCoverLift=this.tileCoverLift,M=Z.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&s.projection.name==="globe"&&(M.push(new i.aM(1,0,1,0,0)),M.push(new i.aM(1,0,1,1,0)),M.push(new i.aM(1,0,1,0,1)),M.push(new i.aM(1,0,1,1,1)))}else if(M=s.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);M=M.filter(ee=>Z(ee))}}else M=[];if(M.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ud(this._source.type)){const Z=s.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),ee=Math.min(Z,this._source.maxzoom);if(P){const se=s.extendTileCover(M,ee);for(const oe of se)M.push(oe)}else if(S){const se=s.extendTileCover(M,ee,this.transform._camera.forward());for(const oe of se)M.push(oe)}else if(this.castsShadows&&w){const se=s.extendTileCover(M,ee,w);for(const oe of se)this._shadowCasterTiles[oe.key]=!0,M.push(oe)}}const W=this._updateRetainedTiles(M);if(ud(this._source.type)&&M.length!==0){const Z={},ee={},se=Object.keys(W);for(const he of se){const le=W[he],xe=this._tiles[he];if(!xe||xe.fadeEndTime&&xe.fadeEndTime<=i.q.now())continue;const Te=this.findLoadedParent(le,Math.max(le.overscaledZ-_a.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),Z[Te.tileID.key]=Te.tileID),ee[he]=le}const oe=M[M.length-1].overscaledZ;for(const he in this._tiles){const le=this._tiles[he];if(W[he]||!le.hasData())continue;let xe=le.tileID;for(;xe.overscaledZ>oe;){xe=xe.scaledTo(xe.overscaledZ-1);const Te=this._tiles[xe.key];if(Te&&Te.hasData()&&ee[xe.key]){W[he]=le.tileID;break}}}for(const he in Z)W[he]||(this._coveredTiles[he]=!0,W[he]=Z[he])}for(const Z in W)this._tiles[Z].clearFadeHold();const K=i.bs(this._tiles,W);for(const Z of K){const ee=this._tiles[Z];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const h={};if(s.length===0)return h;const g={},w=s.reduce((j,W)=>Math.min(j,W.overscaledZ),1/0),S=s[0].overscaledZ,P=Math.max(S-_a.maxOverzooming,this._source.minzoom),M=Math.max(S+_a.maxUnderzooming,this._source.minzoom),D={};for(const j of s){const W=this._addTile(j);h[j.key]=j,W.hasData()||w<this._source.maxzoom&&(D[j.key]=j)}this._retainLoadedChildren(D,w,M,h);for(const j of s){let W=this._tiles[j.key];if(W.hasData())continue;if(j.canonical.z>=this._source.maxzoom){const Z=j.children(this._source.maxzoom)[0],ee=this.getTile(Z);if(ee&&ee.hasData()){h[Z.key]=Z;continue}}else{const Z=j.children(this._source.maxzoom);if(h[Z[0].key]&&h[Z[1].key]&&h[Z[2].key]&&h[Z[3].key])continue}let K=W.wasRequested();for(let Z=j.overscaledZ-1;Z>=P;--Z){const ee=j.scaledTo(Z);if(g[ee.key]||(g[ee.key]=!0,W=this.getTile(ee),!W&&K&&(W=this._addTile(ee)),W&&(h[ee.key]=ee,K=W.wasRequested(),W.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const h=[];let g,w=this._tiles[s].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){g=this._loadedParentTiles[w.key];break}h.push(w.key);const S=w.scaledTo(w.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;w=S}for(const S of h)this._loadedParentTiles[S]=g}}_addTile(s){let h=this._tiles[s.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),h;h=this._cache.getAndRemove(s),h&&(this._setTileReloadTimer(s.key,h),h.tileID=s,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,h)));const g=!!h;if(!g){const w=this.map?this.map.painter:null,S=this._source.tileSize*s.overscaleFactor();h=this._source.type==="raster-array"?new yu(s,S,this.transform.tileZoom,w,this._isRaster):new il(s,S,this.transform.tileZoom,w,this._isRaster),this._loadTile(h,this._tileLoaded.bind(this,h,s.key,h.state))}return h.uses++,this._tiles[s.key]=h,g||this._source.fire(new i.A("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(s,h){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=h.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const h=this._tiles[s];h&&(h.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,h,g){const w=[],S=this.transform;if(!S)return w;const P=S.projection.name==="globe",M=i.ay(S.center.lng);for(const D in this._tiles){const j=this._tiles[D];if(g&&j.clearQueryDebugViz(),j.holdingForFade())continue;let W;if(P){const K=j.tileID.canonical;if(K.z===0){const Z=[Math.abs(i.aD(M,...Fc(K,-1))-M),Math.abs(i.aD(M,...Fc(K,1))-M)];W=[0,2*Z.indexOf(Math.min(...Z))-1]}else{const Z=[Math.abs(i.aD(M,...Fc(K,-1))-M),Math.abs(i.aD(M,...Fc(K,0))-M),Math.abs(i.aD(M,...Fc(K,1))-M)];W=[Z.indexOf(Math.min(...Z))-1]}}else W=[0];for(const K of W){const Z=s.containsTile(j,S,h,K);Z&&w.push(Z)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,h){const g=this.getRenderableIds(s,h).map(S=>this._tiles[S].tileID),w=this.transform.projection.name==="globe";for(const S of g)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=w?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return g}sortCoordinatesByDistance(s){const h=s.slice(),g=this.transform._camera.position,w=this.transform._camera.forward(),S={};for(const P of h){const M=1/(1<<P.canonical.z);S[P.key]=((P.canonical.x+.5)*M+P.wrap-g[0])*w[0]+((P.canonical.y+.5)*M-g[1])*w[1]-g[2]*w[2]}return h.sort((P,M)=>S[P.key]-S[M.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(ud(this._source.type))for(const s in this._tiles){const h=this._tiles[s];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(s,h,g){this._state.updateState(s=s||"_geojsonTileLayer",h,g)}removeFeatureState(s,h,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",h,g)}getFeatureState(s,h){return this._state.getState(s=s||"_geojsonTileLayer",h)}setDependencies(s,h,g){const w=this._tiles[s];w&&w.setDependencies(h,g)}reloadTilesForDependencies(s,h){for(const g in this._tiles)this._tiles[g].hasDependency(s,h)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(s,h))}_preloadTiles(s,h){if(!this._sourceLoaded){const D=()=>{this._sourceLoaded&&(this._source.off("data",D),this._preloadTiles(s,h))};return void this._source.on("data",D)}const g=new Map,w=Array.isArray(s)?s:[s],S=this.map.painter.terrain,P=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const D of w){const j=D.coveringTiles({tileSize:P,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const W of j)g.set(W.key,W);this.usedForTerrain&&D.updateElevation(!1)}const M=Array.from(g.values());i.bt(M,(D,j)=>{const W=new il(D,this._source.tileSize*D.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(W,K=>{this._source.type==="raster-dem"&&W.dem&&this._backfillDEM(W),j(K,W)})},h)}}function xu(m,s){const h=Math.abs(2*m.wrap)-+(m.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||g-h||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function ud(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function Fc(m,s){const h=1<<m.z;return[m.x/h+s,(m.x+1)/h+s]}_a.maxOverzooming=10,_a.maxUnderzooming=3;class R_{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,h=!1;for(const g in this.style._mergedLayers){const w=this.style._mergedLayers[g];if(w.type==="fill-extrusion")this.layers.push({layer:w,visible:s,visibilityChanged:h});else if(w.type==="model"){const S=this.style.getLayerSource(w);S&&S.type==="batched-model"&&this.layers.push({layer:w,visible:s,visibilityChanged:h})}}}onNewFrame(s){this.layersGotHidden=!1;for(const h of this.layers){const g=h.layer;let w=!1;g.type==="fill-extrusion"?w=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(w=!g.isHidden(s)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!w&&h.visible,h.visible=w}}updateZOffset(s,h){this.currentBuildingBuckets=[];for(const w of this.layers){const S=w.layer,P=this.style.getLayerSourceCache(S);let M=1;S.type==="fill-extrusion"&&(M=w.visible?S.paint.get("fill-extrusion-vertical-scale"):0);let D=P?P.getTile(h):null;if(!D&&P&&h.canonical.z>P.getSource().minzoom){let j=h.scaledTo(Math.min(P.getSource().maxzoom,h.overscaledZ-1));for(;j.overscaledZ>=P.getSource().minzoom&&(D=P.getTile(j),!D&&j.overscaledZ!==0);)j=j.scaledTo(j.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:D?D.getBucket(S):null,tileID:D?D.tileID:h,verticalScale:M})}s.hasAnyZOffset=!1;let g=!1;for(let w=0;w<s.symbolInstances.length;w++){const S=s.symbolInstances.get(w),P=S.zOffset,M=this._getHeightAtTileOffset(h,S.tileAnchorX,S.tileAnchorY);S.zOffset=M!==Number.NEGATIVE_INFINITY?M:P,g||P===S.zOffset||(g=!0),s.hasAnyZOffset||S.zOffset===0||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,h,g,w){let S=h,P=g;if(s.canonical.z!==w.canonical.z){const M=w.canonical,D=1/(1<<s.canonical.z-M.z);S=(h+s.canonical.x*i.aj)*D-M.x*i.aj|0,P=(g+s.canonical.y*i.aj)*D-M.y*i.aj|0}return{tileX:S,tileY:P}}_getHeightAtTileOffset(s,h,g){let w,S;for(let P=0;P<this.layers.length;++P){if(this.layers[P].layer.type!=="fill-extrusion")continue;const{bucket:M,tileID:D,verticalScale:j}=this.currentBuildingBuckets[P];if(!M)continue;const{tileX:W,tileY:K}=this._mapCoordToOverlappingTile(s,h,g,D),Z=M.getHeightAtTileCoord(W,K);Z&&Z.height!==void 0&&(Z.hidden?w=Z.height:S=Math.max(Z.height*j,S||0))}if(S!==void 0)return S;for(let P=0;P<this.layers.length;++P){const M=this.layers[P];if(M.layer.type!=="model"||!M.visible)continue;const{bucket:D,tileID:j}=this.currentBuildingBuckets[P];if(!D)continue;const{tileX:W,tileY:K}=this._mapCoordToOverlappingTile(s,h,g,j),Z=D.getHeightAtTileCoord(W,K);if(Z&&!Z.hidden)return Z.height===void 0&&w!==void 0?Math.min(Z.maxHeight,w)*Z.verticalScale:Z.height?Z.height*Z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Fr(m,s){const h={};for(const g in m)g!=="ref"&&(h[g]=m[g]);return i.bu.forEach(g=>{g in s&&(h[g]=s[g])}),h}function Ms(m){m=m.slice();const s=Object.create(null);for(let h=0;h<m.length;h++)s[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=Fr(m[h],s[m[h].ref]));return m}const Hn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function bu(m,s,h){h.push({command:Hn.addSource,args:[m,s[m]]})}function Bc(m,s,h){s.push({command:Hn.removeSource,args:[m]}),h[m]=!0}function Om(m,s,h,g){Bc(m,h,g),bu(m,s,h)}function Pf(m,s,h){let g;for(g in m[h])if(m[h].hasOwnProperty(g)&&g!=="data"&&!i.bv(m[h][g],s[h][g]))return!1;for(g in s[h])if(s[h].hasOwnProperty(g)&&g!=="data"&&!i.bv(m[h][g],s[h][g]))return!1;return!0}function Os(m,s,h,g,w,S){let P;for(P in s=s||{},m=m||{})m.hasOwnProperty(P)&&(i.bv(m[P],s[P])||h.push({command:S,args:[g,P,s[P],w]}));for(P in s)s.hasOwnProperty(P)&&!m.hasOwnProperty(P)&&(i.bv(m[P],s[P])||h.push({command:S,args:[g,P,s[P],w]}))}function Ol(m){return m.id}function kl(m,s){return m[s.id]=s,m}class ya{constructor(s,h){this.reset(s,h)}reset(s,h){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.aD(s,0,1);let h=1,g=this._distances[h];const w=s*this.paddedLength+this.padding;for(;g<w&&h<this._distances.length;)g=this._distances[++h];const S=h-1,P=this._distances[S],M=g-P,D=M>0?(w-P)/M:0;return this.points[S].mult(1-D).add(this.points[h].mult(D))}}class rc{constructor(s,h,g){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(h/g);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=h,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,h,g,w,S){this._forEachCell(h,g,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(s,h,g,w){this._forEachCell(h-w,g-w,h+w,g+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(h),this.circles.push(g),this.circles.push(w)}_insertBoxCell(s,h,g,w,S,P){this.boxCells[S].push(P)}_insertCircleCell(s,h,g,w,S,P){this.circleCells[S].push(P)}_query(s,h,g,w,S,P){if(g<0||s>this.width||w<0||h>this.height)return!S&&[];const M=[];if(s<=0&&h<=0&&this.width<=g&&this.height<=w){if(S)return!0;for(let D=0;D<this.boxKeys.length;D++)M.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const j=this.circles[3*D],W=this.circles[3*D+1],K=this.circles[3*D+2];M.push({key:this.circleKeys[D],x1:j-K,y1:W-K,x2:j+K,y2:W+K})}return P?M.filter(P):M}return this._forEachCell(s,h,g,w,this._queryCell,M,{hitTest:S,seenUids:{box:{},circle:{}}},P),S?M.length>0:M}_queryCircle(s,h,g,w,S){const P=s-g,M=s+g,D=h-g,j=h+g;if(M<0||P>this.width||j<0||D>this.height)return!w&&[];const W=[];return this._forEachCell(P,D,M,j,this._queryCellCircle,W,{hitTest:w,circle:{x:s,y:h,radius:g},seenUids:{box:{},circle:{}}},S),w?W.length>0:W}query(s,h,g,w,S){return this._query(s,h,g,w,!1,S)}hitTest(s,h,g,w,S){return this._query(s,h,g,w,!0,S)}hitTestCircle(s,h,g,w){return this._queryCircle(s,h,g,!0,w)}_queryCell(s,h,g,w,S,P,M,D){const j=M.seenUids,W=this.boxCells[S];if(W!==null){const Z=this.bboxes;for(const ee of W)if(!j.box[ee]){j.box[ee]=!0;const se=4*ee;if(s<=Z[se+2]&&h<=Z[se+3]&&g>=Z[se+0]&&w>=Z[se+1]&&(!D||D(this.boxKeys[ee]))){if(M.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[ee],x1:Z[se],y1:Z[se+1],x2:Z[se+2],y2:Z[se+3]})}}}const K=this.circleCells[S];if(K!==null){const Z=this.circles;for(const ee of K)if(!j.circle[ee]){j.circle[ee]=!0;const se=3*ee;if(this._circleAndRectCollide(Z[se],Z[se+1],Z[se+2],s,h,g,w)&&(!D||D(this.circleKeys[ee]))){if(M.hitTest)return P.push(!0),!0;{const oe=Z[se],he=Z[se+1],le=Z[se+2];P.push({key:this.circleKeys[ee],x1:oe-le,y1:he-le,x2:oe+le,y2:he+le})}}}}}_queryCellCircle(s,h,g,w,S,P,M,D){const j=M.circle,W=M.seenUids,K=this.boxCells[S];if(K!==null){const ee=this.bboxes;for(const se of K)if(!W.box[se]){W.box[se]=!0;const oe=4*se;if(this._circleAndRectCollide(j.x,j.y,j.radius,ee[oe+0],ee[oe+1],ee[oe+2],ee[oe+3])&&(!D||D(this.boxKeys[se])))return P.push(!0),!0}}const Z=this.circleCells[S];if(Z!==null){const ee=this.circles;for(const se of Z)if(!W.circle[se]){W.circle[se]=!0;const oe=3*se;if(this._circlesCollide(ee[oe],ee[oe+1],ee[oe+2],j.x,j.y,j.radius)&&(!D||D(this.circleKeys[se])))return P.push(!0),!0}}}_forEachCell(s,h,g,w,S,P,M,D){const j=this._convertToXCellCoord(s),W=this._convertToYCellCoord(h),K=this._convertToXCellCoord(g),Z=this._convertToYCellCoord(w);for(let ee=j;ee<=K;ee++)for(let se=W;se<=Z;se++)if(S.call(this,s,h,g,w,this.xCellCount*se+ee,P,M,D))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,h,g,w,S,P){const M=w-s,D=S-h,j=g+P;return j*j>M*M+D*D}_circleAndRectCollide(s,h,g,w,S,P,M){const D=(P-w)/2,j=Math.abs(s-(w+D));if(j>D+g)return!1;const W=(M-S)/2,K=Math.abs(h-(S+W));if(K>W+g)return!1;if(j<=D||K<=W)return!0;const Z=j-D,ee=K-W;return Z*Z+ee*ee<=g*g}}const jc={unknown:0,flipRequired:1,flipNotRequired:2},yh=Math.tan(85*Math.PI/180);function vh(m,s,h,g,w,S,P){const M=i.bz();if(h)if(S.name==="globe"){const D=i.bA(w,s);i.az(M,M,D)}else{const D=i.bB([],P);M[0]=D[0],M[1]=D[1],M[4]=D[2],M[5]=D[3],g||i.by(M,M,w.angle)}else i.az(M,w.labelPlaneMatrix,m);return M}function hd(m,s,h,g,w,S,P){const M=vh(m,s,h,g,w,S,P);return S.name==="globe"&&h||(M[2]=M[6]=M[10]=M[14]=0),M}function dd(m,s,h,g,w,S,P){if(h){if(S.name==="globe"){const M=vh(m,s,h,g,w,S,P);return i.bi(M,M),i.az(M,m,M),M}{const M=i.bw(m),D=i.bx([]);return D[0]=P[0],D[1]=P[1],D[4]=P[2],D[5]=P[3],i.az(M,M,D),g||i.by(M,M,-w.angle),M}}return w.glCoordMatrix}function ds(m,s,h,g){const w=[m,s,h,1];h?i.aA(w,w,g):D_(w,w,g);const S=w[3];return w[0]/=S,w[1]/=S,w[2]/=S,w}function ic(m,s){return Math.min(.5+m/s*.5,1.5)}function Ei(m,s){const h=m[0]/m[3],g=m[1]/m[3];return h>=-s[0]&&h<=s[0]&&g>=-s[1]&&g<=s[1]}function km(m,s,h,g,w,S,P,M,D,j){const W=h.transform,K=g?m.textSizeData:m.iconSizeData,Z=i.bH(K,h.transform.zoom),ee=W.projection.name==="globe",se=[256/h.width*2+1,256/h.height*2+1],oe=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;oe.clear();let he=null;ee&&(he=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const le=m.lineVertexArray,xe=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,Te=h.transform.width/h.transform.height;let Pe,ze=!1;for(let ke=0;ke<xe.length;ke++){const Re=xe.get(ke),{numGlyphs:Ie,writingMode:Ve}=Re;if(Ve!==i.bI.vertical||ze||Pe===i.bI.horizontal||(ze=!0),Pe=Ve,(Re.hidden||Ve===i.bI.vertical)&&!ze){Dr(Ie,oe);continue}ze=!1;const Ge=new i.P(Re.tileAnchorX,Re.tileAnchorY);let{x:ht,y:et,z:Et}=W.projection.projectTilePoint(Ge.x,Ge.y,j.canonical);if(D){const[gn,En,fn]=D(Ge);ht+=gn,et+=En,Et+=fn}const wt=[ht,et,Et,1];if(i.aA(wt,wt,s),!Ei(wt,se)){Dr(Ie,oe);continue}const qt=wt[3],tt=ic(h.transform.getCameraToCenterDistance(W.projection),qt),dt=i.bJ(K,Z,Re),Je=P?dt/tt:dt*tt,It=ds(ht,et,Et,w);if(It[3]<=0){Dr(Ie,oe);continue}let gt={};const Lt=i.al(m.layers[0].layout.get("text-max-angle")),At=Math.cos(Lt),zt=P?null:D,Ft=ts(Re,Je,!1,M,s,w,S,m.glyphOffsetArray,le,oe,he,It,Ge,gt,Te,zt,W.projection,j,P,At);ze=Ft.useVertical,zt&&Ft.needsFlipping&&(gt={}),(Ft.notEnoughRoom||ze||Ft.needsFlipping&&ts(Re,Je,!0,M,s,w,S,m.glyphOffsetArray,le,oe,he,It,Ge,gt,Te,zt,W.projection,j,P,At).notEnoughRoom)&&Dr(Ie,oe)}g?(m.text.dynamicLayoutVertexBuffer.updateData(oe),he&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(he)):(m.icon.dynamicLayoutVertexBuffer.updateData(oe),he&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(he))}function fs(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he){const{lineStartIndex:le,glyphStartIndex:xe,segment:Te}=M,Pe=xe+M.numGlyphs,ze=le+M.lineLength,ke=s.getoffsetX(xe),Re=s.getoffsetX(Pe-1),Ie=fd(m*ke,h,g,w,S,P,Te,le,ze,D,j,W,K,Z,!0,ee,se,oe,he);if(!Ie)return null;const Ve=fd(m*Re,h,g,w,S,P,Te,le,ze,D,j,W,K,Z,!0,ee,se,oe,he);return Ve?{first:Ie,last:Ve}:null}function ol(m,s,h,g){return m===i.bI.horizontal&&Math.abs(g)>Math.abs(h)?{useVertical:!0}:m===i.bI.vertical?g>0?{needsFlipping:!0}:null:s!==jc.unknown&&function(w,S){return w===0||Math.abs(S/w)>yh}(h,g)?s===jc.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function ts(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe,Te){const Pe=s/24,ze=m.lineOffsetX*Pe,ke=m.lineOffsetY*Pe,{lineStartIndex:Re,glyphStartIndex:Ie,numGlyphs:Ve,segment:Ge,writingMode:ht,flipState:et}=m,Et=Re+m.lineLength,wt=qt=>{if(W){const[It,gt,Lt]=qt.up,At=j.length;i.bK(W,At+0,It,gt,Lt),i.bK(W,At+1,It,gt,Lt),i.bK(W,At+2,It,gt,Lt),i.bK(W,At+3,It,gt,Lt)}const[tt,dt,Je]=qt.point;i.bL(j,tt,dt,Je,qt.angle)};if(Ve>1){const qt=fs(Pe,M,ze,ke,h,K,Z,m,D,S,ee,oe,!1,he,le,xe,Te);if(!qt)return{notEnoughRoom:!0};if(g&&!h){let[tt,dt,Je]=qt.first.point,[It,gt,Lt]=qt.last.point;[tt,dt]=ds(tt,dt,Je,P),[It,gt]=ds(It,gt,Lt,P);const At=ol(ht,et,(It-tt)*se,gt-dt);if(m.flipState=At&&At.needsFlipping?jc.flipRequired:jc.flipNotRequired,At)return At}wt(qt.first);for(let tt=Ie+1;tt<Ie+Ve-1;tt++){const dt=fd(Pe*M.getoffsetX(tt),ze,ke,h,K,Z,Ge,Re,Et,D,S,ee,oe,!1,!1,he,le,xe,Te);if(!dt)return j.length-=4*(tt-Ie),{notEnoughRoom:!0};wt(dt)}wt(qt.last)}else{if(g&&!h){const tt=ds(Z.x,Z.y,0,w),dt=Re+Ge+1,Je=new i.P(D.getx(dt),D.gety(dt)),It=ds(Je.x,Je.y,0,w),gt=It[3]>0?It:xh(Z,Je,tt,1,w,void 0,he,le.canonical),Lt=ol(ht,et,(gt[0]-tt[0])*se,gt[1]-tt[1]);if(m.flipState=Lt&&Lt.needsFlipping?jc.flipRequired:jc.flipNotRequired,Lt)return Lt}const qt=fd(Pe*M.getoffsetX(Ie),ze,ke,h,K,Z,Ge,Re,Et,D,S,ee,oe,!1,!1,he,le,xe,Te);if(!qt)return{notEnoughRoom:!0};wt(qt)}return{}}function Rm(m,s,h,g,w){const{x:S,y:P,z:M}=g.projectTilePoint(m.x,m.y,s);if(!w)return ds(S,P,M,h);const[D,j,W]=w(m);return ds(S+D,P+j,M+W,h)}function xh(m,s,h,g,w,S,P,M){const D=Rm(m.sub(s)._unit()._add(m),M,w,P,S);return i.at(D,h,D),i.au(D,D),i.bF(D,h,D,g)}function fd(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe){const Te=g?m-s:m+s;let Pe=Te>0?1:-1,ze=0;g&&(Pe*=-1,ze=Math.PI),Pe<0&&(ze+=Math.PI);let ke=M+P+(Pe>0?0:1)|0,Re=w,Ie=w,Ve=0,Ge=0;const ht=Math.abs(Te),et=[],Et=[];let wt=S,qt=wt,tt=i.bC([]);const dt=()=>xh(qt,wt,Ie,ht-Ve+1,W,Z,oe,he.canonical);for(;Ve+Ge<=ht;){if(ke+=Pe,ke<M||ke>=D)return null;if(Ie=Re,qt=wt,et.push(Ie),ee&&Et.push(qt),wt=new i.P(j.getx(ke),j.gety(ke)),Re=K[ke],!Re){const fn=Rm(wt,he.canonical,W,oe,Z);Re=fn[3]>0?K[ke]=fn:dt()}Ve+=Ge;const gn=i.at([],Re,Ie),En=i.bD(Ie,Re);if(h&&En>0&&Ge>0&&i.bE(tt,gn)/(Ge*En)<xe)return null;Ge=En,tt=gn}se&&Z&&(K[ke]&&(Re=dt(),Ge=i.bD(Ie,Re),tt=i.at([],Re,Ie)),K[ke]=Re);const Je=(ht-Ve)/Ge,It=wt.sub(qt)._mult(Je)._add(qt),gt=i.bF([],Ie,tt,Je);let Lt=[0,0,1],At=tt[0],zt=tt[1];if(le&&(Lt=oe.upVector(he.canonical,It.x,It.y),Lt[0]!==0||Lt[1]!==0||Lt[2]!==1)){const gn=[Lt[2],0,-Lt[0]],En=i.bG([],Lt,gn);i.au(gn,gn),i.au(En,En),At=i.bE(tt,gn),zt=i.bE(tt,En)}if(h){const gn=i.bG([],Lt,tt);i.au(gn,gn),i.bF(gt,gt,gn,h*Pe)}const Ft=ze+Math.atan2(zt,At);return et.push(gt),ee&&Et.push(It),{point:gt,angle:Ft,path:et,tilePath:Et,up:Lt}}function Dr(m,s){const h=s.length,g=h+4*m;s.resize(g),s.float32.fill(-1/0,4*h,4*g)}function D_(m,s,h){const g=s[0],w=s[1];return m[0]=h[0]*g+h[4]*w+h[12],m[1]=h[1]*g+h[5]*w+h[13],m[3]=h[3]*g+h[7]*w+h[15],m}const kn=100;class Cf{constructor(s,h,g=new rc(s.width+200,s.height+200,25),w=new rc(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=w,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+kn,this.screenBottomBoundary=s.height+kn,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=h}placeCollisionBox(s,h,g,w,S,P,M,D){let j=g.projectedAnchorX,W=g.projectedAnchorY,K=g.projectedAnchorZ;const Z=g.elevation,ee=g.tileID,se=s.getProjection();if(Z&&ee){const[ke,Re,Ie]=se.upVector(ee.canonical,g.tileAnchorX,g.tileAnchorY),Ve=se.upVectorScale(ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=ke*Z*Ve,W+=Re*Z*Ve,K+=Ie*Z*Ve}const oe=this.projectAndGetPerspectiveRatio(M,j,W,K,g.tileID,se.name==="globe"||!!Z||this.transform.pitch>0,se),he=P*oe.perspectiveRatio,le=(g.x1*h+w.x-g.padding)*he+oe.point.x,xe=(g.y1*h+w.y-g.padding)*he+oe.point.y,Te=(g.x2*h+w.x+g.padding)*he+oe.point.x,Pe=(g.y2*h+w.y+g.padding)*he+oe.point.y,ze=oe.perspectiveRatio<=.55||oe.occluded;return!this.isInsideGrid(le,xe,Te,Pe)||!S&&this.grid.hitTest(le,xe,Te,Pe,D)||ze?{box:[],offscreen:!1,occluded:oe.occluded}:{box:[le,xe,Te,Pe],offscreen:this.isOffscreen(le,xe,Te,Pe),occluded:!1}}placeCollisionCircles(s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe){const he=[],le=this.transform.elevation,xe=s.getProjection(),Te=le?le.getAtTileOffsetFunc(oe,this.transform.center.lat,this.transform.worldSize,xe):null,Pe=new i.P(g.tileAnchorX,g.tileAnchorY);let{x:ze,y:ke,z:Re}=xe.projectTilePoint(Pe.x,Pe.y,oe.canonical);if(Te){const[Lt,At,zt]=Te(Pe);ze+=Lt,ke+=At,Re+=zt}const Ie=xe.name==="globe",Ve=this.projectAndGetPerspectiveRatio(M,ze,ke,Re,oe,Ie||!!le||this.transform.pitch>0,xe),{perspectiveRatio:Ge}=Ve,ht=(K?P/Ge:P*Ge)/i.bO,et=ds(ze,ke,Re,D),Et=g.lineOffsetX*ht,wt=g.lineOffsetY*ht,qt=i.al(s.layers[0].layout.get("text-max-angle")),tt=Math.cos(qt),dt=Ve.signedDistanceFromCamera>0?fs(ht,S,Et,wt,!1,et,Pe,g,w,D,{},le&&!K?Te:null,K&&!!le,xe,oe,K,tt):null;let Je=!1,It=!1,gt=!0;if(dt&&!Ve.occluded){const Lt=.5*ee*Ge+se,At=new i.P(-100,-100),zt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Ft=new ya,{first:gn,last:En}=dt,fn=gn.path.length;let Pn=[];for(let Xn=fn-1;Xn>=1;Xn--)Pn.push(gn.path[Xn]);for(let Xn=1;Xn<En.path.length;Xn++)Pn.push(En.path[Xn]);const yn=2.5*Lt;j&&(Pn=Pn.map(([Xn,yr,oi],Qr)=>(Te&&!Ie&&(oi=Te(Qr<fn-1?gn.tilePath[fn-1-Qr]:En.tilePath[Qr-fn+2])[2]),ds(Xn,yr,oi,j))),Pn.some(Xn=>Xn[3]<=0)&&(Pn=[]));let Nn=[];if(Pn.length>0){let Xn=1/0,yr=-1/0,oi=1/0,Qr=-1/0;for(const br of Pn)Xn=Math.min(Xn,br[0]),oi=Math.min(oi,br[1]),yr=Math.max(yr,br[0]),Qr=Math.max(Qr,br[1]);yr>=At.x&&Xn<=zt.x&&Qr>=At.y&&oi<=zt.y&&(Nn=[Pn.map(br=>new i.P(br[0],br[1]))],(Xn<At.x||yr>zt.x||oi<At.y||Qr>zt.y)&&(Nn=i.bM(Nn,At.x,At.y,zt.x,zt.y)))}for(const Xn of Nn){Ft.reset(Xn,.25*Lt);let yr=0;yr=Ft.length<=.5*Lt?1:Math.ceil(Ft.paddedLength/yn)+1;for(let oi=0;oi<yr;oi++){const Qr=oi/Math.max(yr-1,1),br=Ft.lerp(Qr),Ji=br.x+kn,Hi=br.y+kn;he.push(Ji,Hi,Lt,0);const tr=Ji-Lt,Mr=Hi-Lt,Lr=Ji+Lt,ai=Hi+Lt;if(gt=gt&&this.isOffscreen(tr,Mr,Lr,ai),It=It||this.isInsideGrid(tr,Mr,Lr,ai),!h&&this.grid.hitTestCircle(Ji,Hi,Lt,Z)&&(Je=!0,!W))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!W&&Je||!It?[]:he,offscreen:gt,collisionDetected:Je,occluded:Ve.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,w=1/0,S=-1/0,P=-1/0;for(const W of s){const K=new i.P(W.x+kn,W.y+kn);g=Math.min(g,K.x),w=Math.min(w,K.y),S=Math.max(S,K.x),P=Math.max(P,K.y),h.push(K)}const M=this.grid.query(g,w,S,P).concat(this.ignoredGrid.query(g,w,S,P)),D={},j={};for(const W of M){const K=W.key;if(D[K.bucketInstanceId]===void 0&&(D[K.bucketInstanceId]={}),D[K.bucketInstanceId][K.featureIndex])continue;const Z=[new i.P(W.x1,W.y1),new i.P(W.x2,W.y1),new i.P(W.x2,W.y2),new i.P(W.x1,W.y2)];i.bN(h,Z)&&(D[K.bucketInstanceId][K.featureIndex]=!0,j[K.bucketInstanceId]===void 0&&(j[K.bucketInstanceId]=[]),j[K.bucketInstanceId].push(K.featureIndex))}return j}insertCollisionBox(s,h,g,w,S){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:S},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,h,g,w,S){const P=h?this.ignoredGrid:this.grid,M={bucketInstanceId:g,featureIndex:w,collisionGroupID:S};for(let D=0;D<s.length;D+=4)P.insertCircle(M,s[D],s[D+1],s[D+2])}projectAndGetPerspectiveRatio(s,h,g,w,S,P,M){const D=[h,g,w,1];let j=!1;w||this.transform.pitch>0?(i.aA(D,D,s),this.fogState&&S&&M.name!=="globe"&&(j=function(Z,ee,se,oe,he,le){const xe=le.calculateFogTileMatrix(he),Te=[ee,se,oe];return i.ad(Te,Te,xe),pn(Z,i.ae(Te),le.pitch,le._fov)}(this.fogState,h,g,w,S.toUnwrapped(),this.transform)>.9)):D_(D,D,s);const W=D[3];return{point:new i.P((D[0]/W+1)/2*this.transform.width+kn,(-D[1]/W+1)/2*this.transform.height+kn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/W*.5,1.5),signedDistanceFromCamera:W,occluded:P&&D[2]>W||j}}isOffscreen(s,h,g,w){return g<kn||s>=this.screenRightBoundary||w<kn||h>this.screenBottomBoundary}isInsideGrid(s,h,g,w){return g>=0&&s<this.gridRightBoundary&&w>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const s=i.bx([]);return i.bo(s,s,[-100,-100,0]),s}}function If(m,s,h){const g=s.createTileMatrix(m,m.worldSize,h.toUnwrapped());return i.az(new Float32Array(16),m.projMatrix,g)}function ks(m,s,h){if(s.projection.name===h.projection.name)return m.projMatrix;const g=h.clone();return g.setProjection(s.projection),If(g,s.getProjection(),m)}function pd(m,s,h){return s.name===h.projection.name?m.projMatrix:If(h,s,m)}class Rs{constructor(s,h,g,w){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?h:-h))):w&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class ps{constructor(s,h,g,w,S,P=!1){this.text=new Rs(s?s.text:null,h,g,S),this.icon=new Rs(s?s.icon:null,h,w,S),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oc{constructor(s,h,g,w=!1){this.text=s,this.icon=h,this.skipFade=g,this.clipped=w}}class An{constructor(){this.invProjMatrix=i.bz(),this.viewportMatrix=i.bz(),this.circles=[]}}class Kr{constructor(s,h,g,w,S){this.bucketInstanceId=s,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=w,this.tileID=S}}class Gr{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const h=++this.maxGroupID;this.collisionGroups[s]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[s]}}function Wa(m,s,h,g,w){const{horizontalAlign:S,verticalAlign:P}=i.bV(m),M=-(S-.5)*s,D=-(P-.5)*h,j=i.bU(m,g);return new i.P(M+j[0]*w,D+j[1]*w)}function ac(m,s,h,g,w){const S=new i.P(m,s);return h&&S._rotate(g?w:-w),S}class Br{constructor(s,h,g,w,S,P){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Cf(this.transform,S),this.buildingIndex=P,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Gr(g),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,h,g,w,S=1){const P=g.getBucket(h),M=g.latestFeatureIndex;if(!P||!M||h.fqid!==P.layerIds[0])return;const D=P.layers[0].layout,j=P.layers[0].paint,W=g.collisionBoxArray,K=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Z=g.tileSize/i.aj,ee=g.tileID.toUnwrapped();this.transform.setProjection(P.projection);const se=(oe=g.tileID,he=P.getProjection(),le=this.transform,he.name===this.projection?le.calculateProjMatrix(oe.toUnwrapped()):If(le,he,oe));var oe,he,le;const xe=D.get("text-pitch-alignment")==="map",Te=D.get("text-rotation-alignment")==="map";h.compileFilter(h.options);const Pe=h.dynamicFilter(),ze=h.dynamicFilterNeedsFeature(),ke=this.transform.calculatePixelsToTileUnitsMatrix(g),Re=hd(se,g.tileID.canonical,xe,Te,this.transform,P.getProjection(),ke);let Ie=null;if(xe){const dt=dd(se,g.tileID.canonical,xe,Te,this.transform,P.getProjection(),ke);Ie=i.az([],this.transform.labelPlaneMatrix,dt)}let Ve=null;Pe&&g.latestFeatureIndex&&(Ve={unwrappedTileID:ee,dynamicFilter:Pe,dynamicFilterNeedsFeature:ze}),this.retainedQueryData[P.bucketInstanceId]=new Kr(P.bucketInstanceId,M,P.sourceLayerIndex,P.index,g.tileID);const[Ge,ht]=P.layers[0].layout.get("text-size-scale-range"),et=i.aD(S,Ge,ht),[Et,wt]=D.get("icon-size-scale-range"),qt=i.aD(S,Et,wt),tt={bucket:P,layout:D,paint:j,posMatrix:se,textLabelPlaneMatrix:Re,labelToScreenMatrix:Ie,clippingData:Ve,scale:K,textPixelRatio:Z,holdingForFade:g.holdingForFade(),collisionBoxArray:W,partiallyEvaluatedTextSize:i.bH(P.textSizeData,this.transform.zoom,et),partiallyEvaluatedIconSize:i.bH(P.iconSizeData,this.transform.zoom,qt),collisionGroup:this.collisionGroups.get(P.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(w)for(const dt of P.sortKeyRanges){const{sortKey:Je,symbolInstanceStart:It,symbolInstanceEnd:gt}=dt;s.push({sortKey:Je,symbolInstanceStart:It,symbolInstanceEnd:gt,parameters:tt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe){const{textOffset0:Te,textOffset1:Pe,crossTileID:ze}=Z,ke=[Te,Pe],Re=Wa(s,g,w,ke,S),Ie=this.collisionIndex.placeCollisionBox(se,S,h,ac(Re.x,Re.y,P,M,this.transform.angle),K,D,j,W.predicate);if(he){const Ve=se.getSymbolInstanceIconSize(xe,this.transform.zoom,Z.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(se,Ve,he,ac(Re.x,Re.y,P,M,this.transform.angle),K,D,j,W.predicate).box.length===0)return}if(Ie.box.length>0){let Ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[ze]&&this.prevPlacement.placements[ze]&&this.prevPlacement.placements[ze].text&&(Ve=this.prevPlacement.variableOffsets[ze].anchor),this.variableOffsets[ze]={textOffset:ke,width:g,height:w,anchor:s,textScale:S,prevAnchor:Ve},this.markUsedJustification(se,s,Z,oe),se.allowVerticalPlacement&&(this.markUsedOrientation(se,oe,Z),this.placedOrientations[ze]=oe),{shift:Re,placedGlyphBoxes:Ie}}}placeLayerBucketPart(s,h,g,w,S=1){const{bucket:P,layout:M,paint:D,posMatrix:j,textLabelPlaneMatrix:W,labelToScreenMatrix:K,clippingData:Z,textPixelRatio:ee,holdingForFade:se,collisionBoxArray:oe,partiallyEvaluatedTextSize:he,partiallyEvaluatedIconSize:le,collisionGroup:xe,latestFeatureIndex:Te}=s.parameters,Pe=M.get("text-optional"),ze=M.get("icon-optional"),ke=M.get("text-allow-overlap"),Re=M.get("icon-allow-overlap"),Ie=M.get("text-rotation-alignment")==="map",Ve=M.get("text-pitch-alignment")==="map",Ge=D.get("symbol-z-offset"),ht=M.get("symbol-elevation-reference")==="sea",[et,Et]=M.get("text-size-scale-range"),[wt,qt]=M.get("icon-size-scale-range"),tt=i.aD(S,et,Et),dt=i.aD(S,wt,qt);this.transform.setProjection(P.projection);let Je=ke&&(Re||!P.hasIconData()||ze),It=Re&&(ke||!P.hasTextData()||Pe);const gt=!Ge.isConstant();!P.collisionArrays&&oe&&P.deserializeCollisionBoxes(oe),g&&w&&P.updateCollisionDebugBuffers(this.transform.zoom,oe,tt,dt);const Lt=(At,zt,Ft)=>{const{crossTileID:gn,numVerticalGlyphVertices:En}=At;let fn=null;if(Z&&Z.dynamicFilterNeedsFeature||gt){const Rr=this.retainedQueryData[P.bucketInstanceId];fn=Te.loadFeature({featureIndex:At.featureIndex,bucketIndex:Rr.bucketIndex,sourceLayerIndex:Rr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Z&&!(0,Z.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},fn,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new i.P(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(Z.unwrappedTileID)))return this.placements[gn]=new oc(!1,!1,!1,!0),void h.add(gn);const Pn=Ge.evaluate(fn,{});if(h.has(gn))return;if(se)return void(this.placements[gn]=new oc(!1,!1,!1));let yn=!1,Nn=!1,Xn=!0,yr=!1,oi=!1,Qr=null,br={box:null,offscreen:null,occluded:null},Ji={box:null,offscreen:null,occluded:null},Hi=null,tr=null,Mr=null,Lr=0,ai=0,Ao=0;Ft.textFeatureIndex?Lr=Ft.textFeatureIndex:At.useRuntimeCollisionCircles&&(Lr=At.featureIndex),Ft.verticalTextFeatureIndex&&(ai=Ft.verticalTextFeatureIndex);const oo=Rr=>{Rr.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const Di=this.transform.elevation;Rr.elevation=ht?Pn:Pn+(Di?Di.getAtTileOffset(Rr.tileID,Rr.tileAnchorX,Rr.tileAnchorY):0),Rr.elevation+=At.zOffset},So=Ft.textBox;if(So){oo(So);const Rr=jr=>{let $i=i.bI.horizontal;if(P.allowVerticalPlacement&&!jr&&this.prevPlacement){const oa=this.prevPlacement.placedOrientations[gn];oa&&(this.placedOrientations[gn]=oa,$i=oa,this.markUsedOrientation(P,$i,At))}return $i},Di=(jr,$i)=>{if(P.allowVerticalPlacement&&En>0&&Ft.verticalTextBox){for(const oa of P.writingModes)if(oa===i.bI.vertical?(br=$i(),Ji=br):br=jr(),br&&br.box&&br.box.length)break}else br=jr()};if(M.get("text-variable-anchor")){let jr=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[gn]){const Ai=this.prevPlacement.variableOffsets[gn];jr.indexOf(Ai.anchor)>0&&(jr=jr.filter(xa=>xa!==Ai.anchor),jr.unshift(Ai.anchor))}const $i=(Ai,xa,mo)=>{const za=P.getSymbolInstanceTextSize(he,At,this.transform.zoom,zt),xc=(Ai.x2-Ai.x1)*za+2*Ai.padding,Du=(Ai.y2-Ai.y1)*za+2*Ai.padding,Vs=At.hasIconTextFit&&!Re?xa:null;Vs&&oo(Vs);let Fl={box:[],offscreen:!1,occluded:!1};const Gc=ke?2*jr.length:jr.length;for(let Hc=0;Hc<Gc;++Hc){const bc=this.attemptAnchorPlacement(jr[Hc%jr.length],Ai,xc,Du,za,Ie,Ve,ee,j,xe,Hc>=jr.length,At,zt,P,mo,Vs,he,le);if(bc&&(Fl=bc.placedGlyphBoxes,Fl&&Fl.box&&Fl.box.length)){yn=!0,Qr=bc.shift;break}}return Fl};Di(()=>$i(So,Ft.iconBox,i.bI.horizontal),()=>{const Ai=Ft.verticalTextBox;return Ai&&oo(Ai),P.allowVerticalPlacement&&!(br&&br.box&&br.box.length)&&En>0&&Ai?$i(Ai,Ft.verticalIconBox,i.bI.vertical):{box:null,offscreen:null,occluded:null}}),br&&(yn=br.box,Xn=br.offscreen,yr=br.occluded);const oa=Rr(!(!br||!br.box));if(!yn&&this.prevPlacement){const Ai=this.prevPlacement.variableOffsets[gn];Ai&&(this.variableOffsets[gn]=Ai,this.markUsedJustification(P,Ai.anchor,At,oa))}}else{const jr=($i,oa)=>{const Ai=P.getSymbolInstanceTextSize(he,At,this.transform.zoom,zt,S),xa=this.collisionIndex.placeCollisionBox(P,Ai,$i,new i.P(0,0),ke,ee,j,xe.predicate);return xa&&xa.box&&xa.box.length&&(this.markUsedOrientation(P,oa,At),this.placedOrientations[gn]=oa),xa};Di(()=>jr(So,i.bI.horizontal),()=>{const $i=Ft.verticalTextBox;return P.allowVerticalPlacement&&En>0&&$i?(oo($i),jr($i,i.bI.vertical)):{box:null,offscreen:null,occluded:null}}),Rr(!!(br&&br.box&&br.box.length))}}if(Hi=br,yn=Hi&&Hi.box&&Hi.box.length>0,Xn=Hi&&Hi.offscreen,yr=Hi&&Hi.occluded,At.useRuntimeCollisionCircles){const Rr=P.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),Di=i.bJ(P.textSizeData,he,Rr),jr=M.get("text-padding");tr=this.collisionIndex.placeCollisionCircles(P,ke,Rr,P.lineVertexArray,P.glyphOffsetArray,Di,j,W,K,g,Ve,xe.predicate,At.collisionCircleDiameter*Di/i.bO,jr,this.retainedQueryData[P.bucketInstanceId].tileID),yn=ke||tr.circles.length>0&&!tr.collisionDetected,Xn=Xn&&tr.offscreen,yr=tr.occluded}if(Ft.iconFeatureIndex&&(Ao=Ft.iconFeatureIndex),Ft.iconBox){const Rr=Di=>{oo(Di);const jr=At.hasIconTextFit&&Qr?ac(Qr.x,Qr.y,Ie,Ve,this.transform.angle):new i.P(0,0),$i=P.getSymbolInstanceIconSize(le,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,$i,Di,jr,Re,ee,j,xe.predicate)};Ji&&Ji.box&&Ji.box.length&&Ft.verticalIconBox?(Mr=Rr(Ft.verticalIconBox),Nn=Mr.box.length>0):(Mr=Rr(Ft.iconBox),Nn=Mr.box.length>0),Xn=Xn&&Mr.offscreen,oi=Mr.occluded}const ji=Pe||At.numHorizontalGlyphVertices===0&&En===0,sr=ze||At.numIconVertices===0;if(ji||sr?sr?ji||(Nn=Nn&&yn):yn=Nn&&yn:Nn=yn=Nn&&yn,yn&&Hi&&Hi.box&&this.collisionIndex.insertCollisionBox(Hi.box,M.get("text-ignore-placement"),P.bucketInstanceId,Ji&&Ji.box&&ai?ai:Lr,xe.ID),Nn&&Mr&&this.collisionIndex.insertCollisionBox(Mr.box,M.get("icon-ignore-placement"),P.bucketInstanceId,Ao,xe.ID),tr&&(yn&&this.collisionIndex.insertCollisionCircles(tr.circles,M.get("text-ignore-placement"),P.bucketInstanceId,Lr,xe.ID),g)){const Rr=P.bucketInstanceId;let Di=this.collisionCircleArrays[Rr];Di===void 0&&(Di=this.collisionCircleArrays[Rr]=new An);for(let jr=0;jr<tr.circles.length;jr+=4)Di.circles.push(tr.circles[jr+0]),Di.circles.push(tr.circles[jr+1]),Di.circles.push(tr.circles[jr+2]),Di.circles.push(tr.collisionDetected?1:0)}const Ri=P.projection.name!=="globe";Je=Je&&(Ri||!yr),It=It&&(Ri||!oi),this.placements[gn]=new oc(yn||Je,Nn||It,Xn||P.justReloaded),h.add(gn)};if(P.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(P,this.retainedQueryData[P.bucketInstanceId].tileID),P.elevationType==="road"&&P.updateRoadElevation(),P.updateZOffset(),P.sortFeaturesByY){const At=P.getSortedSymbolIndexes(this.transform.angle);for(let zt=At.length-1;zt>=0;--zt){const Ft=At[zt];Lt(P.symbolInstances.get(Ft),Ft,P.collisionArrays[Ft])}P.hasAnyZOffset&&i.w(`${P.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(P.hasAnyZOffset){const At=P.getSortedIndexesByZOffset();for(let zt=0;zt<At.length;++zt){const Ft=At[zt];Lt(P.symbolInstances.get(Ft),Ft,P.collisionArrays[Ft])}}else for(let At=s.symbolInstanceStart;At<s.symbolInstanceEnd;At++)Lt(P.symbolInstances.get(At),At,P.collisionArrays[At]);if(g&&P.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[P.bucketInstanceId];i.bi(At.invProjMatrix,j),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(s,h,g,w){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:D,crossTileID:j}=g,W=i.bT(h),K=w===i.bI.vertical?D:W==="left"?S:W==="center"?P:W==="right"?M:-1;S>=0&&(s.text.placedSymbolArray.get(S).crossTileID=K>=0&&S!==K?0:j),P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=K>=0&&P!==K?0:j),M>=0&&(s.text.placedSymbolArray.get(M).crossTileID=K>=0&&M!==K?0:j),D>=0&&(s.text.placedSymbolArray.get(D).crossTileID=K>=0&&D!==K?0:j)}markUsedOrientation(s,h,g){const w=h===i.bI.horizontal||h===i.bI.horizontalOnly?h:0,S=h===i.bI.vertical?h:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:j}=g,W=s.text.placedSymbolArray;P>=0&&(W.get(P).placedOrientation=w),M>=0&&(W.get(M).placedOrientation=w),D>=0&&(W.get(D).placedOrientation=w),j>=0&&(W.get(j).placedOrientation=S)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const w=h?h.symbolFadeChange(s):1,S=h?h.opacities:{},P=h?h.variableOffsets:{},M=h?h.placedOrientations:{};for(const D in this.placements){const j=this.placements[D],W=S[D];W?(this.opacities[D]=new ps(W,w,j.text,j.icon,null,j.clipped),g=g||j.text!==W.text.placed||j.icon!==W.icon.placed):(this.opacities[D]=new ps(null,w,j.text,j.icon,j.skipFade,j.clipped),g=g||j.text||j.icon)}for(const D in S){const j=S[D];if(!this.opacities[D]){const W=new ps(j,w,!1,!1);W.isHidden()||(this.opacities[D]=W,g=g||j.text.placed||j.icon.placed)}}for(const D in P)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=P[D]);for(const D in M)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=M[D]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:s)}updateLayerOpacities(s,h,g,w){const S=new Set;for(const P of h){const M=P.getBucket(s);M&&P.latestFeatureIndex&&s.fqid===M.layerIds[0]&&(this.updateBucketOpacities(M,S,P,P.collisionBoxArray,g,w,P.tileID,s.scope),M.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(M,P.tileID),M.elevationType==="road"&&M.updateRoadElevation(),M.updateZOffset())}}updateBucketOpacities(s,h,g,w,S,P,M,D){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const j=s.layers[0].layout,W=s.layers[0].paint,K=!!s.layers[0].dynamicFilter(),Z=new ps(null,0,!1,!1,!0),ee=j.get("text-allow-overlap"),se=j.get("icon-allow-overlap"),oe=j.get("text-variable-anchor"),he=j.get("text-rotation-alignment")==="map",le=j.get("text-pitch-alignment")==="map",xe=W.get("symbol-z-offset"),Te=j.get("symbol-elevation-reference")==="sea",Pe=!xe.isConstant(),ze=new ps(null,0,ee&&(se||!s.hasIconData()||j.get("icon-optional")),se&&(ee||!s.hasTextData()||j.get("text-optional")),!0);!s.collisionArrays&&w&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(w);const ke=(Ie,Ve,Ge)=>{for(let ht=0;ht<Ve/4;ht++)Ie.opacityVertexArray.emplaceBack(Ge)};let Re=0;P&&s.updateReplacement(M,P);for(let Ie=0;Ie<s.symbolInstances.length;Ie++){const Ve=s.symbolInstances.get(Ie),{numHorizontalGlyphVertices:Ge,numVerticalGlyphVertices:ht,crossTileID:et,numIconVertices:Et,tileAnchorX:wt,tileAnchorY:qt}=Ve;let tt=null;const dt=this.retainedQueryData[s.bucketInstanceId];Pe&&Ve&&dt&&(tt=g.latestFeatureIndex.loadFeature({featureIndex:Ve.featureIndex,bucketIndex:dt.bucketIndex,sourceLayerIndex:dt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Je=xe.evaluate(tt,{}),It=h.has(et);let gt=this.opacities[et];It?gt=Z:gt||(gt=ze,this.opacities[et]=gt),h.add(et);const Lt=Ge>0||ht>0,At=Et>0,zt=this.placedOrientations[et],Ft=zt===i.bI.vertical,gn=zt===i.bI.horizontal||zt===i.bI.horizontalOnly;!Lt&&!At||gt.isHidden()||Re++;let En=!1;if((Lt||At)&&P)for(const fn of s.activeReplacements){if(i.bP(fn,S,i.bQ.Symbol,D)||fn.min.x>wt||wt>fn.max.x||fn.min.y>qt||qt>fn.max.y)continue;const Pn=i.bR(wt,qt,M.canonical,fn.footprintTileId.canonical);if(En=i.bS(Pn,fn.footprint),En)break}if(Lt){const fn=En?ra:Rl(gt.text);ke(s.text,Ge,Ft?ra:fn),ke(s.text,ht,gn?ra:fn);const Pn=gt.text.isHidden(),{leftJustifiedTextSymbolIndex:yn,centerJustifiedTextSymbolIndex:Nn,rightJustifiedTextSymbolIndex:Xn,verticalPlacedTextSymbolIndex:yr}=Ve,oi=s.text.placedSymbolArray,Qr=Pn||Ft?1:0;yn>=0&&(oi.get(yn).hidden=Qr),Nn>=0&&(oi.get(Nn).hidden=Qr),Xn>=0&&(oi.get(Xn).hidden=Qr),yr>=0&&(oi.get(yr).hidden=Pn||gn?1:0);const br=this.variableOffsets[et];br&&this.markUsedJustification(s,br.anchor,Ve,zt);const Ji=this.placedOrientations[et];Ji&&(this.markUsedJustification(s,"left",Ve,Ji),this.markUsedOrientation(s,Ji,Ve))}if(At){const fn=En?ra:Rl(gt.icon),{placedIconSymbolIndex:Pn,verticalPlacedIconSymbolIndex:yn}=Ve,Nn=s.icon.placedSymbolArray,Xn=gt.icon.isHidden()?1:0;Pn>=0&&(ke(s.icon,Et,Ft?ra:fn),Nn.get(Pn).hidden=Xn),yn>=0&&(ke(s.icon,Ve.numVerticalIconVertices,gn?ra:fn),Nn.get(yn).hidden=Xn)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const fn=s.collisionArrays[Ie];if(fn){let Pn=new i.P(0,0),yn=!0;if(fn.textBox||fn.verticalTextBox){if(oe){const Xn=this.variableOffsets[et];Xn?(Pn=Wa(Xn.anchor,Xn.width,Xn.height,Xn.textOffset,Xn.textScale),he&&Pn._rotate(le?this.transform.angle:-this.transform.angle)):yn=!1}K&&(yn=!gt.clipped),fn.textBox&&wu(s.textCollisionBox.collisionVertexArray,gt.text.placed,!yn||Ft,Je,Te,Pn.x,Pn.y),fn.verticalTextBox&&wu(s.textCollisionBox.collisionVertexArray,gt.text.placed,!yn||gn,Je,Te,Pn.x,Pn.y)}const Nn=yn&&!!(!gn&&fn.verticalIconBox);fn.iconBox&&wu(s.iconCollisionBox.collisionVertexArray,gt.icon.placed,Nn,Je,Te,Ve.hasIconTextFit?Pn.x:0,Ve.hasIconTextFit?Pn.y:0),fn.verticalIconBox&&wu(s.iconCollisionBox.collisionVertexArray,gt.icon.placed,!Nn,Je,Te,Ve.hasIconTextFit?Pn.x:0,Ve.hasIconTextFit?Pn.y:0)}}}if(s.fullyClipped=Re===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Ie.invProjMatrix,s.placementViewportMatrix=Ie.viewportMatrix,s.collisionCircleArray=Ie.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function wu(m,s,h,g,w,S,P){m.emplaceBack(s?1:0,h?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(s?1:0,h?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(s?1:0,h?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(s?1:0,h?1:0,S||0,P||0,g,w?1:0)}const Su=Math.pow(2,25),md=Math.pow(2,24),Ma=Math.pow(2,17),po=Math.pow(2,16),Mf=Math.pow(2,9),al=Math.pow(2,8),Dm=Math.pow(2,1);function Rl(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const s=m.placed?1:0,h=Math.floor(127*m.opacity);return h*Su+s*md+h*Ma+s*po+h*Mf+s*al+h*Dm+s}const ra=0;class gd{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,h,g,w,S,P){const M=this._bucketParts;for(;this._currentTileIndex<s.length;)if(h.getBucketParts(M,w,s[this._currentTileIndex],this._sortAcrossTiles,P),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((D,j)=>D.sortKey-j.sortKey));this._currentPartIndex<M.length;){const D=M[this._currentPartIndex];if(h.placeLayerBucketPart(D,this._seenCrossTileIDs,g,D.symbolInstanceStart===0,P),this._currentPartIndex++,S())return!0}return!1}}class Oa{constructor(s,h,g,w,S,P,M,D,j){this.placement=new Br(s,S,P,M,D,j),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(s,h,g,w,S){const P=i.q.now(),M=()=>{const D=i.q.now()-P;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=h[s[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=j)&&(!D.maxzoom||D.maxzoom>j)){const W=D,K=W.layout.get("symbol-z-elevate"),Z=W.layout.get("symbol-sort-key").constantOr(1)!==void 0,ee=W.layout.get("symbol-z-order"),se=ee==="viewport-y"||ee==="auto"&&!(ee!=="viewport-y"&&Z),oe=W.layout.get("text-allow-overlap")||W.layout.get("icon-allow-overlap")||W.layout.get("text-ignore-placement")||W.layout.get("icon-ignore-placement"),he=se&&oe,le=this._inProgressLayer=this._inProgressLayer||new gd(W),xe=i.C(D.source,D.scope);if(le.continuePlacement(K||he?w[xe]:g[xe],this.placement,this._showCollisionBoxes,D,M,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const sl=512/i.aj/2;class ka{constructor(s,h,g){this.tileID=s,this.bucketInstanceId=g,this.index=new i.bW(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=s.canonical.x*i.aj,S=s.canonical.y*i.aj;for(let P=0;P<h.length;P++){const{key:M,crossTileID:D,tileAnchorX:j,tileAnchorY:W}=h.get(P),K=Math.floor((w+j)*sl),Z=Math.floor((S+W)*sl);this.index.add(K,Z),this.keys.push(M),this.crossTileIDs.push(D)}this.index.finish()}findMatches(s,h,g){const w=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),S=sl/Math.pow(2,h.canonical.z-this.tileID.canonical.z),P=h.canonical.x*i.aj,M=h.canonical.y*i.aj;for(let D=0;D<s.length;D++){const j=s.get(D);if(j.crossTileID)continue;const{key:W,tileAnchorX:K,tileAnchorY:Z}=j,ee=Math.floor((P+K)*S),se=Math.floor((M+Z)*S),oe=this.index.range(ee-w,se-w,ee+w,se+w).sort((he,le)=>he-le);for(const he of oe){const le=this.crossTileIDs[he];if(this.keys[he]===W&&!g.has(le)){g.add(le),j.crossTileID=le;break}}}}}class Of{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const h=Math.round((s-this.lng)/360);if(h!==0)for(const g in this.indexes){const w=this.indexes[g],S={};for(const P in w){const M=w[P];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+h),S[M.tileID.key]=M}this.indexes[g]=S}this.lng=s}addBucket(s,h,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let S=0;S<h.symbolInstances.length;S++)h.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const w=this.usedCrossTileIDs[s.overscaledZ];for(const S in this.indexes){const P=this.indexes[S];if(Number(S)>s.overscaledZ)for(const M in P){const D=P[M];D.tileID.isChildOf(s)&&D.findMatches(h.symbolInstances,s,w)}else{const M=P[s.scaledTo(Number(S)).key];M&&M.findMatches(h.symbolInstances,s,w)}}for(let S=0;S<h.symbolInstances.length;S++){const P=h.symbolInstances.get(S);P.crossTileID||(P.crossTileID=g.generate(),w.add(P.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new ka(s,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(s,h){for(const g of h.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let h=!1;for(const g in this.indexes){const w=this.indexes[g];for(const S in w)s[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,w[S]),delete w[S],h=!0)}return h}}class Oo{constructor(){this.layerIndexes={},this.crossTileIDs=new Of,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,h,g,w){let S=this.layerIndexes[s.fqid];S===void 0&&(S=this.layerIndexes[s.fqid]=new bh);let P=!1;const M={};w.name!=="globe"&&S.handleWrapJump(g);for(const D of h){const j=D.getBucket(s);j&&s.fqid===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(D.tileID,j,this.crossTileIDs)&&(P=!0),M[j.bucketInstanceId]=!0)}return S.removeStaleBuckets(M)&&(P=!0),P}pruneUnusedLayers(s){const h={};s.forEach(g=>{h[g]=!0});for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const Ra=771;class ar{constructor(s,h,g,w){this.blendFunction=s,this.blendColor=h,this.mask=g,this.blendEquation=w}}ar.Replace=[1,0,1,0],ar.disabled=new ar(ar.Replace,i.am.transparent,[!1,!1,!1,!1]),ar.unblended=new ar(ar.Replace,i.am.transparent,[!0,!0,!0,!0]),ar.alphaBlended=new ar([1,Ra,1,Ra],i.am.transparent,[!0,!0,!0,!0]),ar.alphaBlendedNonPremultiplied=new ar([770,Ra,770,Ra],i.am.transparent,[!0,!0,!0,!0]),ar.multiply=new ar([774,0,774,0],i.am.transparent,[!0,!0,!0,!0]);class nn{constructor(s,h,g){this.func=s,this.mask=h,this.range=g}}nn.ReadOnly=!1,nn.ReadWrite=!0,nn.disabled=new nn(519,nn.ReadOnly,[0,1]);const Dl=7680;class Un{constructor(s,h,g,w,S,P){this.test=s,this.ref=h,this.mask=g,this.fail=w,this.depthFail=S,this.pass=P}}Un.disabled=new Un({func:519,mask:0},0,0,Dl,Dl,Dl);const ns=1029,wh=2305;class Fn{constructor(s,h,g){this.enable=s,this.mode=h,this.frontFace=g}}function L_(m,s){const h=i.c1(m,3);i.c3(m,s),i.c7(m,3,h)}function rs(m,s){const h=i.bY([]);return i.bZ(h,h,-s),i.b_(h,h,-m),h}function Lm(m,s){const h=[m[0],m[1],0],g=[s[0],s[1],0];if(i.ae(h)>=1e-15){const P=i.au([],h);i.b$(g,P,i.bE(g,P)),s[0]=g[0],s[1]=g[1]}const w=i.bG([],s,m);if(i.c0(w)<1e-15)return null;const S=Math.atan2(-w[1],w[0]);return rs(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}Fn.disabled=new Fn(!1,ns,wh),Fn.backCCW=new Fn(!0,ns,wh),Fn.backCW=new Fn(!0,ns,2304),Fn.frontCW=new Fn(!0,1028,2304),Fn.frontCCW=new Fn(!0,1028,wh);class Tu{constructor(s,h){this.position=s,this.orientation=h}get position(){return this._position}set position(s){if(s){const h=s instanceof i.ac?s:new i.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(h.x=i.bX(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(s,h){if(this.orientation=null,!this.position)return;const g=this.position,w=this._elevation?this._elevation.getAtPointOrZero(i.ac.fromLngLat(s)):0,S=i.ac.fromLngLat(s,w),P=[S.x-g.x,S.y-g.y,S.z-g.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Lm(P,h)}setPitchBearing(s,h){this.orientation=rs(i.al(s),i.al(-h))}}class Da{constructor(s,h){this._transform=i.bx([]),this.orientation=h,this.position=s}get mercatorPosition(){const s=this.position;return new i.ac(s[0],s[1],s[2])}get position(){const s=i.c1(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var h;s&&i.c7(this._transform,3,[(h=s)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.bY([]),s&&L_(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,h){this._orientation=rs(s,h),L_(this._transform,this._orientation)}forward(){const s=i.c1(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.c1(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.c1(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,h){const g=new Float64Array(16);return i.bi(g,this.getWorldToCamera(s,h)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,h,g){const w=this.position;i.b$(w,w,-s);const S=new Float64Array(16);return i.bn(S,[g,g,g]),i.bo(S,S,w),S[10]*=h,S}getWorldToCamera(s,h){const g=new Float64Array(16),w=new Float64Array(4),S=this.position;return i.c2(w,this._orientation),i.b$(S,S,-s),i.c3(g,w),i.bo(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=h,g[9]*=h,g[10]*=h,g[11]*=h,g}getCameraToClipPerspective(s,h,g,w){const S=new Float64Array(16);return i.c4(S,s,h,g,w),S}getCameraToClipOrthographic(s,h,g,w,S,P){const M=new Float64Array(16);return i.c5(M,s,h,g,w,S,P),M}getDistanceToElevation(s,h=!1){const g=s===0?0:i.c6(s,h?i.aY(this.position[1]):this.position[1]),w=this.forward();return(g-this.position[2])/w[2]}clone(){return new Da([...this.position],[...this.orientation])}}const Eo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class sc{constructor(s=0,h=0,g=0,w=0){if(isNaN(s)||s<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=h,this.left=g,this.right=w}interpolate(s,h,g){return h.top!=null&&s.top!=null&&(this.top=i.ai(s.top,h.top,g)),h.bottom!=null&&s.bottom!=null&&(this.bottom=i.ai(s.bottom,h.bottom,g)),h.left!=null&&s.left!=null&&(this.left=i.ai(s.left,h.left,g)),h.right!=null&&s.right!=null&&(this.right=i.ai(s.right,h.right,g)),this}getCenter(s,h){const g=i.aD((this.left+s-this.right)/2,0,s),w=i.aD((this.top+h-this.bottom)/2,0,h);return new i.P(g,w)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new sc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const $c=15;class lc{constructor(s,h,g,w,S,P,M){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new i.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new sc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Da,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new lc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<$c}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,h=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return i.aF(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=i.ce(this.projectionOptions);const g=this.getProjection(),w=!i.bv(h,g);return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.ce({name:"mercator"});const h=s!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bX(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const h=-s*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=i.cf(),i.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const h=i.aD(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.al(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const h=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let w=0,S=0;for(let P=0;P<h.length;P++){const M=new i.P(h[P][0]*this.width,g+h[P][1]*(this.height-g)),D=s.pointCoordinate(M);if(!D)continue;const j=1/Math.hypot(D[0]-this._camera.position[0],D[1]-this._camera.position[1]);w+=D[3]*j,S+=j}return S===0?NaN:w/S}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*h,w=this._mercatorZfromZoom(s),S=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-g,S);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[h.x,h.y,h.z]:[s.x,s.y,s.z];const w=i.ae(i.at([],this._camera.position,g));return i.aD(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let h=!1;if(s.orientation&&!i.ch(s.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];i.ci(g,this._camera.position)||(this._setCameraPosition(g),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,h=new Tu;return h.position=new i.ac(s[0],s[1],s[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(s){if(!i.cj(s))return!1;i.ck(s,s);const h=i.cl([],[0,0,-1],s),g=i.cl([],[0,-1,0],s);if(g[2]<0)return!1;const w=Lm(h,g);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(s){const h=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;s[2]=i.aD(s[2],w/g,w/h),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,h,g){this._unmodified=!1,this._edgeInsets.interpolate(s,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const h=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(s){const h=[new i.cm(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new i.P(0,0)),w=this.pointCoordinate(new i.P(this.width,0)),S=this.pointCoordinate(new i.P(this.width,this.height)),P=this.pointCoordinate(new i.P(0,this.height)),M=Math.floor(Math.min(g.x,w.x,S.x,P.x)),D=Math.floor(Math.max(g.x,w.x,S.x,P.x)),j=1;for(let W=M-j;W<=D+j;W++)W!==0&&h.push(new i.cm(W,s))}return h}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,h,g){let w=[];const S=g!=null,P=!S;if(P&&this.zoom<h||S&&g[0]===0&&g[1]===0)return w;const M=new Set,D=(W,K,Z,ee,se)=>{const oe=i.cK(K,W,Z,ee,se);M.has(oe)||(w.push(new i.aM(W,K,Z,ee,se)),M.add(oe))};for(let W=0;W<s.length;W++){const K=s[W];if(P&&K.canonical.z!==h)continue;const Z=K.canonical,ee=K.overscaledZ,se=K.wrap,oe=1<<Z.z,he=Z.x+1<oe,le=Z.x>0,xe=Z.y+1<oe,Te=Z.y>0,Pe=K.wrap-(le?0:1),ze=K.wrap+(he?0:1),ke=le?Z.x-1:oe-1,Re=he?Z.x+1:0;if(S)g[0]<0?(D(ee,ze,Z.z,Re,Z.y),g[1]<0&&xe&&(D(ee,se,Z.z,Z.x,Z.y+1),D(ee,ze,Z.z,Re,Z.y+1)),g[1]>0&&Te&&(D(ee,se,Z.z,Z.x,Z.y-1),D(ee,ze,Z.z,Re,Z.y-1))):g[0]>0?(D(ee,Pe,Z.z,ke,Z.y),g[1]<0&&xe&&(D(ee,se,Z.z,Z.x,Z.y+1),D(ee,Pe,Z.z,ke,Z.y+1)),g[1]>0&&Te&&(D(ee,se,Z.z,Z.x,Z.y-1),D(ee,Pe,Z.z,ke,Z.y-1))):g[1]<0&&xe?D(ee,se,Z.z,Z.x,Z.y+1):Te&&D(ee,se,Z.z,Z.x,Z.y-1);else{const Ie=K.visibleQuadrants;1&Ie&&(D(ee,Pe,Z.z,ke,Z.y),Te&&(D(ee,se,Z.z,Z.x,Z.y-1),D(ee,Pe,Z.z,ke,Z.y-1))),2&Ie&&(D(ee,ze,Z.z,Re,Z.y),Te&&(D(ee,se,Z.z,Z.x,Z.y-1),D(ee,ze,Z.z,Re,Z.y-1))),4&Ie&&(D(ee,Pe,Z.z,ke,Z.y),xe&&(D(ee,se,Z.z,Z.x,Z.y+1),D(ee,Pe,Z.z,ke,Z.y+1))),8&Ie&&(D(ee,ze,Z.z,Re,Z.y),xe&&(D(ee,se,Z.z,Z.x,Z.y+1),D(ee,ze,Z.z,Re,Z.y+1)))}}const j=[];for(const W of w)w.some(K=>W.isChildOf(K))||j.push(W);if(w=j.filter(W=>!s.some(K=>!!(W.overscaledZ<h&&K.isChildOf(W))||W.equals(K)||W.isChildOf(K))),P){const W=1<<h,K=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Z=[W*K.x,W*K.y],ee=4,se=ee*ee;w=w.filter(oe=>{const he=oe.canonical.x+.5-Z[0],le=oe.canonical.y+.5-Z[1];return he*he+le*le<se})}return w}coveringTiles(s){let h=this.coveringZoomLevel(s);const g=h,w=this.elevation&&this.elevation.exaggeration(),S=w&&!s.isTerrainDEM,P=this.projection.name==="mercator";if(s.minzoom!==void 0&&h<s.minzoom)return[];s.maxzoom!==void 0&&h>s.maxzoom&&(h=s.maxzoom);const M=this.locationCoordinate(this.center),D=this.center.lat,j=1<<h,W=[j*M.x,j*M.y,0],K=this.projection.name==="globe",Z=!K,ee=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,Z),se=K?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),oe=j*i.c6(1,this.center.lat),he=this._camera.position[2]/i.c6(1,this.center.lat),le=[j*se.x,j*se.y,he*(Z?1:oe)],xe=K||w,Te=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Pe=this.isLODDisabled(!0)?h:0;let ze;if(this._elevation&&s.isTerrainDEM)ze=1e4*this._elevation.exaggeration();else if(this._elevation){const Je=this._elevation.getMinMaxForVisibleTiles();ze=Je?Je.max:this._centerAltitude}else ze=this._centerAltitude;const ke=s.isTerrainDEM?-ze:this._elevation?this._elevation.getMinElevationBelowMSL():0,Re=this.projection.isReprojectedInTileSpace?i.co(this):1,Ie=Je=>{const gt=new i.ac(Je.x+25e-6,Je.y,Je.z),Lt=new i.ac(Je.x,Je.y+25e-6,Je.z),At=Je.toLngLat(),zt=gt.toLngLat(),Ft=Lt.toLngLat(),gn=this.locationCoordinate(At),En=this.locationCoordinate(zt),fn=this.locationCoordinate(Ft),Pn=Math.hypot(En.x-gn.x,En.y-gn.y),yn=Math.hypot(fn.x-gn.x,fn.y-gn.y);return Math.sqrt(Pn*yn)*Re/25e-6},Ve=Je=>{const It=ze,gt=ke;return{aabb:i.cr(this,j,0,0,0,Je,gt,It,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:It,wrap:Je,fullyVisible:!1}},Ge=[];let ht=[];const et=h,Et=s.reparseOverscaled?g:h,wt=(he-this._centerAltitude)*oe,qt=Je=>{if(!this._elevation||!Je.tileID||!P)return;const It=this._elevation.getMinMaxForTile(Je.tileID),gt=Je.aabb;It?(gt.min[2]=It.min,gt.max[2]=It.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(Je.shouldSplit=dt(Je),Je.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},tt=(Je,It)=>{if(.707*It<Je)return 1;const gt=It/Je;return gt/(1.4144271570014144+(Math.pow(1.1,gt-1.4144271570014144+1)-1)/(1.1-1)-1)},dt=Je=>{if(Je.zoom<Pe)return!0;if(Je.zoom===et)return!1;if(Je.shouldSplit!=null)return Je.shouldSplit;const It=Je.aabb.distanceX(le),gt=Je.aabb.distanceY(le);let Lt=wt,At=1;if(K){Lt=Je.aabb.distanceZ(le);const yn=Math.pow(2,Je.zoom),Nn=i.aY((Je.y+1)/yn),Xn=i.aY(Je.y/yn),yr=Math.min(Math.max(D,Nn),Xn),oi=i.cP(yr)/i.cP(D);if(At=yr===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,oi/this._mercatorScaleRatio),this.zoom<=i.cL&&Je.zoom===et-1&&oi>=.9)return!0}else if(S&&(Lt=Je.aabb.distanceZ(le)*oe),this.projection.isReprojectedInTileSpace&&g<=5){const yn=Math.pow(2,Je.zoom),Nn=Ie(new i.ac((Je.x+.5)/yn,(Je.y+.5)/yn));At=Nn>.85?1:Nn}if(!P){const yn=Math.sqrt(It*It+gt*gt+Lt*Lt);let Nn=(1<<et-Je.zoom)*Te*At;return Nn*=tt(Math.max(Lt,wt),yn),yn<Nn}let zt=Number.MAX_VALUE,Ft=0;const gn=Je.aabb.getCorners(),En=[];for(const yn of gn){i.at(En,yn,le),K||(S?En[2]*=oe:En[2]=wt);const Nn=i.bE(En,this._camera.forward());Nn<zt&&(zt=Nn,Ft=Math.abs(En[2]))}let fn=(1<<et-Je.zoom)*Te*At;if(fn*=tt(Math.max(Ft,wt),zt),zt<fn)return!0;const Pn=Je.aabb.closestPoint(W);return Pn[0]===W[0]&&Pn[1]===W[1]};if(this.renderWorldCopies)for(let Je=1;Je<=3;Je++)Ge.push(Ve(-Je)),Ge.push(Ve(Je));for(Ge.push(Ve(0));Ge.length>0;){const Je=Ge.pop(),It=Je.x,gt=Je.y;let Lt=Je.fullyVisible;const At=()=>this.projection.name==="globe"&&(Je.y===0||Je.y===(1<<Je.zoom)-1);if(!Lt){let zt=xe?Je.aabb.intersects(ee):Je.aabb.intersectsFlat(ee);if(zt===0&&At()){const Ft=new i.cp(Je.zoom,It,gt);zt=i.cq(this,j,Ft,!0).intersects(ee)}if(zt===0)continue;Lt=zt===2}if(Je.zoom!==et&&dt(Je))for(let zt=0;zt<4;zt++){const Ft=(It<<1)+zt%2,gn=(gt<<1)+(zt>>1),En={aabb:P?Je.aabb.quadrant(zt):i.cr(this,j,Je.zoom+1,Ft,gn,Je.wrap,Je.minZ,Je.maxZ,this.projection),zoom:Je.zoom+1,x:Ft,y:gn,wrap:Je.wrap,fullyVisible:Lt,tileID:void 0,shouldSplit:void 0,minZ:Je.minZ,maxZ:Je.maxZ};S&&!K&&(En.tileID=new i.aM(Je.zoom+1===et?Et:Je.zoom+1,Je.wrap,Je.zoom+1,Ft,gn),qt(En)),Ge.push(En)}else{const zt=Je.zoom===et?Et:Je.zoom;if(s.minzoom&&s.minzoom>zt)continue;let Ft=0;if(!Lt){let Pn=xe?Je.aabb.intersectsPrecise(ee):Je.aabb.intersectsPreciseFlat(ee);if(Pn===0&&At()){const yn=new i.cp(Je.zoom,It,gt);Pn=i.cq(this,j,yn,!0).intersectsPrecise(ee)}if(Pn===0)continue;if(s.calculateQuadrantVisibility)if(ee.containsPoint(Je.aabb.center))Ft=15;else for(let yn=0;yn<4;yn++)Je.aabb.quadrant(yn).intersects(ee)!==0&&(Ft|=1<<yn)}const gn=W[0]-(.5+It+(Je.wrap<<Je.zoom))*(1<<h-Je.zoom),En=W[1]-.5-gt,fn=Je.tileID?Je.tileID:new i.aM(zt,Je.wrap,Je.zoom,It,gt);s.calculateQuadrantVisibility&&(fn.visibleQuadrants=Ft),ht.push({tileID:fn,distanceSq:gn*gn+En*En})}}if(this.fogCullDistSq){const Je=this.fogCullDistSq,It=this.horizonLineFromTop();ht=ht.filter(gt=>{const Lt=[0,0,0,1],At=[i.aj,i.aj,0,1],zt=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());i.aA(Lt,Lt,zt),i.aA(At,At,zt);const Ft=i.cs([],Lt,At),gn=i.ct([],Lt,At),En=i.cM(Ft,gn);if(En===0)return!0;let fn=!1;const Pn=this._elevation;if(Pn&&En>Je&&It!==0){const yn=this.calculateProjMatrix(gt.tileID.toUnwrapped());let Nn;s.isTerrainDEM||(Nn=Pn.getMinMaxForTile(gt.tileID)),Nn||(Nn={min:ke,max:ze});const Xn=i.cu(this.rotation),yr=[Xn[0]*i.aj,Xn[1]*i.aj,Nn.max];i.ad(yr,yr,yn),fn=(1-yr[1])*this.height*.5<It}return En<Je||fn})}return ht.sort((Je,It)=>Je.distanceSq-It.distanceSq).map(Je=>Je.tileID)}resize(s,h){this.width=s,this.height=h,this.pixelsToGLUnits=[2/s,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const h=i.aD(s.lat,-i.cv,i.cv),g=this.projection.project(s.lng,h);return new i.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,h){let g,w;const S=this.centerPoint;if(this.projection.name==="globe"){const M=this.worldSize;g=(h.x-S.x)/M,w=(h.y-S.y)/M}else{const M=this.pointCoordinate(h),D=this.pointCoordinate(S);g=M.x-D.x,w=M.y-D.y}const P=this.locationCoordinate(s);this.setLocation(new i.ac(P.x-g,P.y-w))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,h){return this.projection.locationPoint(this,s,h)}locationPoint3D(s,h){return this.projection.locationPoint(this,s,h,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,h){return this.coordinateLocation(this.pointCoordinate3D(s,h))}locationCoordinate(s,h){const g=h?i.c6(h,s.lat):void 0,w=this.projection.project(s.lng,s.lat);return new i.ac(w.x,w.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,h){const g=h??this._centerAltitude,w=[s.x,s.y,0,1],S=[s.x,s.y,1,1];i.aA(w,w,this.pixelMatrixInverse),i.aA(S,S,this.pixelMatrixInverse);const P=S[3];i.cw(w,w,1/w[3]),i.cw(S,S,1/P);const M=w[2],D=S[2];return{p0:w,p1:S,t:M===D?0:(g-M)/(D-M)}}screenPointToMercatorRay(s){const h=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return i.aA(h,h,this.pixelMatrixInverse),i.aA(g,g,this.pixelMatrixInverse),i.cw(h,h,1/h[3]),i.cw(g,g,1/g[3]),h[2]=i.c6(h[2],this._center.lat)*this.worldSize,g[2]=i.c6(g[2],this._center.lat)*this.worldSize,i.cw(h,h,1/this.worldSize),i.cw(g,g,1/this.worldSize),new i.av([h[0],h[1],h[2]],i.au([],i.at([],g,h)))}rayIntersectionCoordinate(s){const{p0:h,p1:g,t:w}=s,S=i.c6(h[2],this._center.lat),P=i.c6(g[2],this._center.lat);return new i.ac(i.ai(h[0],g[0],w)/this.worldSize,i.ai(h[1],g[1],w)/this.worldSize,i.ai(S,P,w))}pointCoordinate(s,h=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,h)}pointCoordinate3D(s,h){if(!this.elevation)return this.pointCoordinate(s,h);let g=this.projection.pointCoordinate3D(this,s.x,s.y);if(g)return new i.ac(g[0],g[1],g[2]);let w=0,S=this.horizonLineFromTop();if(s.y>S)return this.pointCoordinate(s,h);const P=.02*S,M=s.clone();for(let D=0;D<10&&S-w>P;D++){M.y=i.ai(w,S,.66);const j=this.projection.pointCoordinate3D(this,M.x,M.y);j?(S=M.y,g=j):w=M.y}return g?new i.ac(g[0],g[1],g[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.cx)return!this.isPointAboveHorizon(s);const h=this.pointCoordinate(s);return h.y>=0&&h.y<=1}_coordinatePoint(s,h){const g=h&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,w=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return i.aA(w,w,this.pixelMatrix),w[3]>0?new i.P(w[0]/w[3],w[1]/w[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:h}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=this.pointLocation3D(new i.P(h,s)),P=this.pointLocation3D(new i.P(w,s)),M=this.pointLocation3D(new i.P(w,g)),D=this.pointLocation3D(new i.P(h,g));let j=Math.min(S.lng,P.lng,M.lng,D.lng),W=Math.max(S.lng,P.lng,M.lng,D.lng),K=Math.min(S.lat,P.lat,M.lat,D.lat),Z=Math.max(S.lat,P.lat,M.lat,D.lat);const ee=Math.pow(2,-this.zoom)/16*270,se=this.projection.name==="globe"?1:4,oe=(he,le,xe,Te,Pe)=>{const ze=(he+xe)/2,ke=(le+Te)/2,Re=new i.P(ze,ke),{lng:Ie,lat:Ve}=this.pointLocation3D(Re),Ge=Math.max(0,j-Ie,K-Ve,Ie-W,Ve-Z);j=Math.min(j,Ie),W=Math.max(W,Ie),K=Math.min(K,Ve),Z=Math.max(Z,Ve),(Pe<se||Ge>ee)&&(oe(he,le,ze,ke,Pe+1),oe(ze,ke,xe,Te,Pe+1))};if(oe(h,s,w,s,1),oe(w,s,w,g,1),oe(w,g,h,g,1),oe(h,g,h,s,1),this.projection.name==="globe"){const[he,le]=i.cy(this);he?(Z=90,W=180,j=-180):le&&(K=-90,W=180,j=-180)}return new i.aG(new i.cd(j,K),new i.cd(W,Z))}_getBoundsRectangular(s,h){const{top:g,left:w}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,M=new i.P(w,g),D=new i.P(P,g),j=new i.P(P,S),W=new i.P(w,S);let K=this.pointCoordinate(M,s),Z=this.pointCoordinate(D,s);const ee=this.pointCoordinate(j,h),se=this.pointCoordinate(W,h),oe=(he,le)=>(le.y-he.y)/(le.x-he.x);return K.y>1&&Z.y>=0?K=new i.ac((1-se.y)/oe(se,K)+se.x,1):K.y<0&&Z.y<=1&&(K=new i.ac(-se.y/oe(se,K)+se.x,0)),Z.y>1&&K.y>=0?Z=new i.ac((1-ee.y)/oe(ee,Z)+ee.x,1):Z.y<0&&K.y<=1&&(Z=new i.ac(-ee.y/oe(ee,Z)+ee.x,0)),new i.aG().extend(this.coordinateLocation(K)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(se)).extend(this.coordinateLocation(ee))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=s.visibleDemTiles.reduce((g,w)=>{if(w.dem){const S=w.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*s.exaggeration(),h.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-h*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.cv,this.maxLat=i.cv,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.ay(this.minLng)*this.tileSize,this.worldMaxX=i.ay(this.maxLng)*this.tileSize,this.worldMinY=i.aH(this.maxLat)*this.tileSize,this.worldMaxY=i.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,h){return this.projection.createTileMatrix(this,h,s)}calculateDistanceTileData(s){const h=s.key,g=this._distanceTileDataCache;if(g[h])return g[h];const w=s.canonical,S=1/this.height,P=this.cameraWorldSize,M=P/this.zoomScale(w.z),D=(w.x+Math.pow(2,w.z)*s.wrap)*M,j=w.y*M,W=this.point;W.x*=P/this.worldSize,W.y*=P/this.worldSize;const K=this.angle,Z=Math.sin(-K),ee=-Math.cos(-K);return g[h]={bearing:[Z,ee],center:[(W.x-D)*S,(W.y-j)*S],scale:M/i.aj*S},g[h]}calculateFogTileMatrix(s){const h=s.key,g=this._fogTileMatrixCache;if(g[h])return g[h];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.az(w,this.worldToFogMatrix,w),g[h]=new Float32Array(w),g[h]}calculateProjMatrix(s,h=!1,g=!1){const w=s.key;let S;if(S=g?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,S[w])return S[w];const P=this.calculatePosMatrix(s,this.worldSize);let M;return M=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,i.az(P,M,P),S[w]=new Float32Array(P),S[w]}calculatePixelsToTileUnitsMatrix(s){const h=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[h])return g[h];const w=i.cz(s,this);return g[h]=w,g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,h=i.bn([],[s,s,s]);return i.az(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const h=i.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(h),w=this._camera.forward(),S=i.c6(1,this._center.lat);g[2]/=S,w[2]/=S,i.au(w,w);const P=s.raycast(g,w,s.exaggeration());if(P){const M=i.bF([],g,w,P),D=new i.ac(M[0],M[1],i.c6(M[2],i.aY(M[1]))),j=(D.z+i.ae([D.x-g[0],D.y-g[1],D.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=D.toAltitude(),this._center=this.coordinateLocation(D),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const h=this._elevation,g=i.c6(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(g),S=h.getAtPointOrZero(new i.ac(...w)),P=this.pixelsPerMeter/this.worldSize*S,M=this._minimumHeightOverTerrain(),D=w[2]-P;if(D<=M)if(D<0||s){const j=this.locationCoordinate(this._center,this._centerAltitude),W=[w[0],w[1],j.z-w[2]],K=i.ae(W);W[2]-=(M-D)/this._pixelsPerMercatorPixel;const Z=i.ae(W);if(Z===0)return;i.b$(W,W,K/Z*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],j.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const Z=this.center;return Z.lat=i.aD(Z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(Z.lng=i.aD(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const h=this._unmodified,{x:g,y:w}=this.point;let S=0,P=g,M=w;const D=this.width/2,j=this.height/2,W=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(w-j<W&&(M=W+j),w+j>K&&(M=K-j),K-W<this.height&&(S=Math.max(S,this.height/(K-W)),M=(K+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,ee=this.worldMaxX*this.scale,se=this.worldSize/2-(Z+ee)/2;P=(g+se+this.worldSize)%this.worldSize-se,P-D<Z&&(P=Z+D),P+D>ee&&(P=ee-D),ee-Z<this.width&&(S=Math.max(S,this.width/(ee-Z)),P=(ee+Z)/2)}P===g&&M===w||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(P,M))),S&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,h=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.c6(1,this.center.lat)/i.c6(1,i.cN));const w=i.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?g:1,P=this._camera.getWorldToCamera(this.worldSize,S);let M;const D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(D[8]=2*-s.x/this.width,D[9]=2*s.y/this.height,this.isOrthographic){let Ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ge=Ve*this.aspect,ht=-Ge,et=-Ve;Ge-=s.x,ht-=s.x,Ve+=s.y,et+=s.y,M=this._camera.getCameraToClipOrthographic(ht,Ge,et,Ve,this._nearZ,this._farZ),((Et,wt,qt,tt)=>{for(let dt=0;dt<16;dt++)Et[dt]=i.ai(wt[dt],qt[dt],tt)})(M,M,D,i.cO(this.pitch>=$c?1:this.pitch/$c))}else M=D;const j=i.cB([],D,P);let W=i.cB([],M,P);if(this.projection.isReprojectedInTileSpace){const Ve=this.locationCoordinate(this.center),Ge=i.bx([]);i.bo(Ge,Ge,[Ve.x*this.worldSize,Ve.y*this.worldSize,0]),i.az(Ge,Ge,i.cC(this)),i.bo(Ge,Ge,[-Ve.x*this.worldSize,-Ve.y*this.worldSize,0]),i.az(W,W,Ge),i.az(j,j,Ge),this.inverseAdjustmentMatrix=i.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cE([],W,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=W,this.invProjMatrix=i.bi(new Float64Array(16),this.projMatrix),h){const Ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ve[8]=2*-s.x/this.width,Ve[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.cB([],Ve,P)}else this.expandedFarZProjMatrix=this.projMatrix;const K=i.bi([],M);this.frustumCorners=i.cF.fromInvProjectionMatrix(K,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const Z=new Float32Array(16);i.bx(Z),i.cE(Z,Z,[1,-1,1]),i.cG(Z,Z,this._pitch),i.by(Z,Z,this.angle);const ee=i.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bw(ee);const se=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ee[8]=2*-s.x/this.width,ee[9]=2*(s.y+se)/this.height,this.skyboxMatrix=i.az(Z,ee,Z);const oe=this.point,he=oe.x,le=oe.y,xe=this.width%2/2,Te=this.height%2/2,Pe=Math.cos(this.angle),ze=Math.sin(this.angle),ke=he-Math.round(he)+Pe*xe+ze*Te,Re=le-Math.round(le)+Pe*Te+ze*xe,Ie=new Float64Array(W);if(i.bo(Ie,Ie,[ke>.5?ke-1:ke,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=Ie,W=i.bz(),i.cE(W,W,[this.width/2,-this.height/2,1]),i.bo(W,W,[1,-1,0]),this.labelPlaneMatrix=W,W=i.bz(),i.cE(W,W,[1,-1,1]),i.bo(W,W,[-1,-1,0]),i.cE(W,W,[2/this.width,2/this.height,1]),this.glCoordMatrix=W,this.pixelMatrix=i.az(new Float64Array(16),this.labelPlaneMatrix,j),this._calcFogMatrices(),this._distanceTileDataCache={},W=i.bi(new Float64Array(16),this.pixelMatrix),!W)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=W,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cH(this);const Ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ad(Ve,Ve,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=W;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,g=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,S=[s,s,h];i.b$(S,S,w),i.b$(g,g,-1),i.cI(g,g,S);const P=i.bz();i.bo(P,P,g),i.cE(P,P,S),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,h,w)}_computeCameraPosition(s){const h=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),w=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-s/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-g[0]*S,w.y/this.worldSize-g[1]*S,s/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],w=s[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(S=Math.min((h-g)/w,1)),this._camera.position=i.bF([],this._camera.position,s,S),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,h=this._camera.forward(),{pitch:g,bearing:w}=this._camera.getPitchBearing(),S=i.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.al(this._maxPitch)),M=Math.max((s[2]-S)/Math.cos(g),P),D=this._zoomFromMercatorZ(M);i.bF(s,s,h,M),this._pitch=i.aD(g,i.al(this.minPitch),i.al(this.maxPitch)),this.angle=i.bX(w,-Math.PI,Math.PI),this._setZoom(i.aD(D,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let h=0,g=i.cx,w=0,S=1/0;for(;g-h>1e-6&&g>h;){const P=h+.5*(g-h),M=this.tileSize*Math.pow(2,P),D=this.getCameraToCenterDistance(this.projection,P,M),j=this.scaleZoom(D/(s*this.tileSize)),W=Math.abs(P-j);W<S&&(S=W,w=P),P<j?h=P:g=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,h){const g=Math.min(s.x,h.x),w=Math.max(s.x,h.x),S=Math.min(s.y,h.y),P=Math.max(s.y,h.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const M=[new i.P(g,S),new i.P(w,P),new i.P(g,P),new i.P(w,S)],D=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const W of M){const K=this.pointRayIntersection(W);if(K.t<0)return!0;const Z=this.rayIntersectionCoordinate(K);if(Z.x<D||Z.y<0||Z.x>j||Z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,h){const g=i.ae(i.at([],this._camera.position,s)),w=this._zoomFromMercatorZ(g)+h;return g-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([h,g,w],S){const P=[h,g,w,1];i.aA(P,P,S);const M=P[3]=Math.max(P[3],1e-6);return P[0]/=M,P[1]/=M,P[2]/=M,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,h=this.zoom,g=this.worldSize){const w=i.cA(s,h,this.width,this.height,1024),S=s.pixelSpaceConversion(this.center.lat,g,w);let P=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(P=i.ai(1,P,i.cO(this.pitch>=$c?1:this.pitch/$c))),P}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.az(s,s,this.globeMatrix),s}getFrustum(s){return i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Eu=(m,s)=>{if(s>0&&m.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=m.transform,g=Math.max(Math.abs(h._zoom-(m.minCutoffZoom-1)),1),w=h.isLODDisabled(!1)?i.af(60,45,h.pitch):i.af(30,15,h.pitch),S=h._farZ-h._nearZ,P=s*h.height,M=((1-(D=w))*h.cameraToCenterDistance+D*(h._farZ+P))*g;var D;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(M-h._nearZ)/S,(M-P-h._nearZ)/S]}}},bo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class _d{constructor(s,h){this.aabb=s,this.lastCascade=h}}class Ll{add(s,h){const g=this.receivers[s.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],h.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],h.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],h.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],h.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],h.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],h.max[2])):this.receivers[s.key]=new _d(h,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,h,g){const w=i.cV.fromPoints(s.points);let S=0;for(const P in this.receivers){const M=this.receivers[P];if(!M||!w.intersectsAabb(M.aabb))continue;M.aabb.min=w.closestPoint(M.aabb.min),M.aabb.max=w.closestPoint(M.aabb.max);const D=M.aabb.getCorners();for(let j=0;j<g.length;j++){let W=!0;for(const K of D){const Z=[K[0]*h,K[1]*h,K[2]];if(i.ad(Z,Z,g[j].matrix),Z[0]<-1||Z[0]>1||Z[1]<-1||Z[1]>1){W=!1;break}}if(M.lastCascade=j,S=Math.max(S,j),W)break}}return S+1}}class dx{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Ll,this._depthMode=new nn(s.context.gl.LEQUAL,nn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(bo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(bo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(bo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,h){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const w=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||w<=0||(this._shadowLayerCount=g.style.order.reduce((se,oe)=>{const he=g.style._mergedLayers[oe];return se+(he.hasShadowPass()&&!he.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=g.context,P=bo.shadowMapResolution,M=bo.shadowMapResolution;if(this._cascades.length===0||bo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let se=0;se<bo.cascadeCount;++se){const oe=g._shadowMapDebug,he=S.gl,le=S.createFramebuffer(P,M,oe,"texture"),xe=new i.T(S,{width:P,height:M,data:null},he.DEPTH_COMPONENT16);if(le.depthAttachment.set(xe.texture),oe){const Te=new i.T(S,{width:P,height:M,data:null},he.RGBA8);le.colorAttachment.set(Te.texture)}this._cascades.push({framebuffer:le,texture:xe,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cn,scale:0})}}this.shadowDirection=Sh(h);let D=0;if(s.elevation){const se=s.elevation,oe=[1e4,-1e4];se.visibleDemTiles.filter(he=>he.dem).forEach(he=>{const le=he.dem.tree;oe[0]=Math.min(oe[0],le.minimums[0]),oe[1]=Math.max(oe[1],le.maximums[0])}),oe[0]!==1e4&&(D=(oe[1]-oe[0])*se.exaggeration())}const j=1.5*s.cameraToCenterDistance,W=3*j,K=new Float64Array(16);for(let se=0;se<this._cascades.length;++se){const oe=this._cascades[se];let he=s.height/50,le=1;bo.cascadeCount===1?le=W:se===0?le=j:(he=j,le=W);const[xe,Te]=yd(s,this.shadowDirection,he,le,bo.shadowMapResolution,D);oe.scale=s.scale,oe.matrix=xe,oe.boundingSphereRadius=Te,i.bi(K,oe.matrix),oe.frustum=i.cn.fromInvProjectionMatrix(K,1,0,!0),oe.far=le}const Z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Z].far,this._cascades[Z].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/bo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=bo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Eo.ShadowMap0,this._uniformValues.u_shadowmap_1=Eo.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ee=g.transform.elevation;for(const se of this._groundShadowTiles){let oe={min:0,max:0};if(ee){const he=ee.getMinMaxForTile(se);he&&(oe=he)}this.addShadowReceiver(se.toUnwrapped(),oe.min,oe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,h){if(!this.enabled)return;const g=this.painter,w=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),w.viewport.set([0,0,bo.shadowMapResolution,bo.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){g.currentShadowCascade=S,w.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),w.clear({color:i.am.white,depth:1});for(const P of s.order){const M=s._mergedLayers[P];if(!M.hasShadowPass()||M.isHidden(g.transform.zoom))continue;const D=s.getLayerSourceCache(M),j=D?h[D.id]:void 0;(M.type==="model"||j&&j.length)&&g.renderLayer(g,D,M,j)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,h=s.style,g=s.context,w=h.directionalLight,S=h.ambientLight;if(!w||!S)return;const P=[],M=Eu(s,s.longestCutoffRange);M.shouldRenderCutoff&&P.push("RENDER_CUTOFF"),P.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&P.push("NORMAL_OFFSET");const D=ll(h,w,S),j=new nn(g.gl.LEQUAL,nn.ReadOnly,s.depthRangeFor3D);for(const W of this._groundShadowTiles){const K=W.toUnwrapped(),Z=s.isTileAffectedByFog(W),ee=s.getOrCreateProgram("groundShadow",{defines:P,overrideFog:Z});this.setupShadows(K,ee),s.uploadCommonUniforms(g,ee,K,null,M);const se={u_matrix:s.transform.calculateProjMatrix(K),u_ground_shadow_factor:D};ee.draw(s,g.gl.TRIANGLES,j,Un.disabled,ar.multiply,Fn.disabled,se,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ar.unblended:ar.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const h=this.painter.transform,g=h.calculatePosMatrix(s,h.worldSize);return i.az(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return i.az(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,h,g,w=0){if(!this.enabled)return;const S=this.painter.transform,P=this.painter.context,M=P.gl,D=this._uniformValues,j=new Float64Array(16),W=S.calculatePosMatrix(s,S.worldSize);for(let K=0;K<this._cascades.length;K++)i.az(j,this._cascades[K].matrix,W),D[K===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(j),P.activeTexture.set(M.TEXTURE0+Eo.ShadowMap0+K),this._cascades[K].texture.bind(M.NEAREST,M.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){const K=i.cT(s.canonical),Z=2/S.tileSize*i.aj/bo.shadowMapResolution,ee=Z*this._cascades[0].boundingSphereRadius,se=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,oe=(g==="vector-tile"?1:3)/Math.pow(2,w-s.canonical.z-(1-S.zoom+Math.floor(S.zoom)));D.u_shadow_normal_offset=[K,ee*oe,se*oe],D.u_shadow_bias=[6e-5,.0012,.012]}else D.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(P,D)}setupShadowsFromMatrix(s,h,g=!1){if(!this.enabled)return;const w=this.painter.context,S=w.gl,P=this._uniformValues,M=new Float64Array(16);for(let D=0;D<bo.cascadeCount;D++)i.az(M,this._cascades[D].matrix,s),P[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),w.activeTexture.set(S.TEXTURE0+Eo.ShadowMap0+D),this._cascades[D].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);if(this.useNormalOffset=g,g){const D=bo.normalOffset;P.u_shadow_normal_offset=[1,D,D],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(w,P)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,h,g,w){if(w[2]>=0)return{};const S=function(D,j,W){const K=W/(1<<D.canonical.z);return new i.cV([D.canonical.x*K+D.wrap*W,D.canonical.y*K+D.wrap*W,0],[(D.canonical.x+1)*K+D.wrap*W,(D.canonical.y+1)*K+D.wrap*W,j])}(s,h,g).getCorners(),P=h/-w[2];w[0]<0?(i.cU(S[0],S[0],[w[0]*P,0,0]),i.cU(S[3],S[3],[w[0]*P,0,0])):w[0]>0&&(i.cU(S[1],S[1],[w[0]*P,0,0]),i.cU(S[2],S[2],[w[0]*P,0,0])),w[1]<0?(i.cU(S[0],S[0],[0,w[1]*P,0]),i.cU(S[1],S[1],[0,w[1]*P,0])):w[1]>0&&(i.cU(S[2],S[2],[0,w[1]*P,0]),i.cU(S[3],S[3],[0,w[1]*P,0]));const M={};return M.vertices=S,M.planes=[La(S[1],S[0],S[4]),La(S[2],S[1],S[5]),La(S[3],S[2],S[6]),La(S[0],S[3],S[7])],M}addShadowReceiver(s,h,g){this._receivers.add(s,i.cV.fromTileIdAndHeight(s,h,g))}getMaxCascadeForTile(s){const h=this._receivers.get(s);return h&&h.lastCascade?h.lastCascade:0}}function La(m,s,h){const g=i.at([],h,s),w=i.at([],m,s),S=i.bG([],g,w),P=i.ae(S);return P===0?[0,0,1,0]:(i.b$(S,S,1/P),[S[0],S[1],S[2],-i.bE(S,s)])}function Sh(m){const s=m.properties.get("direction"),h=i.cR(s.x,s.y,s.z);h[2]=i.aD(h[2],0,75);const g=i.cW([h[0],h[1],h[2]]);return i.cS(g.x,g.y,g.z)}function ll(m,s,h){const g=s.properties.get("color-use-theme")==="none",w=s.properties.get("color"),S=s.properties.get("intensity"),P=s.properties.get("direction"),M=[P.x,P.y,P.z],D=h.properties.get("color-use-theme")==="none",j=h.properties.get("color"),W=h.properties.get("intensity"),K=Math.max(i.bE([0,0,1],M),0),Z=[0,0,0];i.b$(Z,j.toRenderColor(D?null:m.getLut(s.scope)).toArray01Linear().slice(0,3),W);const ee=[0,0,0];return i.b$(ee,w.toRenderColor(g?null:m.getLut(h.scope)).toArray01Linear().slice(0,3),K*S),i.cX([Z[0]>0?Z[0]/(Z[0]+ee[0]):0,Z[1]>0?Z[1]/(Z[1]+ee[1]):0,Z[2]>0?Z[2]/(Z[2]+ee[2]):0])}function yd(m,s,h,g,w,S){const P=m.zoom,M=m.scale,D=m.worldSize,j=1/D,W=m.aspect,K=Math.sqrt(1+W*W)*Math.tan(.5*m.fovX),Z=K*K,ee=g-h,se=g+h;let oe,he;Z>ee/se?(oe=g,he=g*K):(oe=.5*se*(1+Z),he=.5*Math.sqrt(ee*ee+2*(g*g+h*h)*Z+se*se*Z*Z));const le=m.projection.pixelsPerMeter(m.center.lat,D),xe=m._camera.getCameraToWorldMercator(),Te=[0,0,-oe*j];i.ad(Te,Te,xe);let Pe=he*j;const ze=m._edgeInsets;if(!(ze.left===0&&ze.top===0&&ze.right===0&&ze.bottom===0||ze.left===ze.right&&ze.top===ze.bottom)){const Lt=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?le:1),At=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,h,g);At[8]=2*-m.centerOffset.x/m.width,At[9]=2*m.centerOffset.y/m.height;const zt=new Float64Array(16);i.cB(zt,At,Lt);const Ft=new Float64Array(16);i.bi(Ft,zt);const gn=i.cn.fromInvProjectionMatrix(Ft,D,P,!0);for(const En of gn.points){const fn=((ke=En)[0]/=M,ke[1]/=M,ke[2]=i.c6(ke[2],m._center.lat),ke);Pe=Math.max(Pe,i.c0(i.cY([],Te,fn)))}}var ke;Pe*=w/(w-1);const Re=Math.acos(s[2]),Ie=Math.atan2(-s[0],-s[1]),Ve=new Da;Ve.position=Te,Ve.setPitchBearing(Re,Ie);const Ge=Ve.getWorldToCamera(D,le),ht=Pe*D,et=Math.min(m._mercatorZfromZoom(17)*D*-2,-2*ht),Et=Ve.getCameraToClipOrthographic(-ht,ht,-ht,ht,et,(ht+S*le)/s[2]),wt=new Float64Array(16);i.az(wt,Et,Ge);const qt=i.cS(Math.floor(1e6*Te[0])/1e6*D,Math.floor(1e6*Te[1])/1e6*D,0),tt=.5*w,dt=[0,0,0];i.ad(dt,qt,wt),i.b$(dt,dt,tt);const Je=[Math.floor(dt[0]),Math.floor(dt[1]),Math.floor(dt[2])],It=[0,0,0];i.at(It,dt,Je),i.b$(It,It,-1/tt);const gt=new Float64Array(16);return i.bx(gt),i.bo(gt,gt,It),i.az(wt,gt,wt),[wt,ht]}class cl extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(s,h){return i.aS(this.requestManager.transformRequest(h,i.R.Model).url).then(g=>{if(!g)return;const w=i.aT(g),S=new i.aU(s,void 0,void 0,w);return S.computeBoundsAndApplyParent(),S}).catch(g=>{if(g&&g.status===404)return null;this.fire(new i.z(new Error(`Could not load model ${s} from ${h}: ${g.message}`)))})}load(s,h,g={forceReload:!1}){this.models[h]||(this.models[h]={});const w=Object.keys(s),S=[],P=[];for(const M of w){const D=s[M];this.hasURLBeenRequested(D)&&!g.forceReload||(this.modelByURL[D]={modelId:M,scope:h},S.push(this.loadModel(M,D)),P.push(M)),this.models[h][M]||(this.models[h][M]={model:null,numReferences:1})}this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+P.length,Promise.allSettled(S).then(M=>{for(let D=0;D<M.length;D++){const{status:j}=M[D];if(j==="rejected")continue;const{value:W}=M[D];this.models[h][P[D]]||(this.models[h][P[D]]={model:null,numReferences:1}),this.models[h][P[D]].model=W}this.numModelsLoading[h]-=P.length,this.fire(new i.A("data",{dataType:"style"}))}).catch(M=>{this.fire(new i.z(new Error(`Could not load models: ${M.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,h,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(s,h):this.getModelByURL(this.modelUris[h][s]))}getModel(s,h){return this.models[h]||(this.models[h]={}),this.models[h][s]?this.models[h][s].model:void 0}getModelByURL(s){if(!s)return null;const h=this.modelByURL[s];return h?this.models[h.scope][h.modelId].model:null}hasModelBeenAdded(s,h){return this.models[h]&&this.models[h][s]!==void 0}getModelURIs(s){return this.modelUris[s]||{}}addModel(s,h,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const w=this.requestManager.normalizeModelURL(h);if((this.hasModel(s,g,{exactIdMatch:!0})||this.hasModelBeenAdded(s,g))&&this.modelUris[g][s]===w)this.models[g][s].numReferences++;else if(this.hasURLBeenRequested(w)){const{scope:S,modelId:P}=this.modelByURL[w];this.models[S][P].numReferences++}else this.modelUris[g][s]=w,this.load({[s]:this.modelUris[g][s]},g)}addModelURLs(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const g=this.modelUris[h];for(const w in s)g[w]=this.requestManager.normalizeModelURL(s[w])}reloadModels(s){this.load(this.modelUris[s],s,{forceReload:!0})}addModelsFromBucket(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const g={};for(const w of s)this.hasModel(w,h,{exactIdMatch:!0})||this.hasURLBeenRequested(w)?this.models[h][w].numReferences++:this.modelUris[h][w]&&!this.hasURLBeenRequested(w)?g[w]=this.modelUris[h][w]:!this.hasURLBeenRequested(w)&&i.cZ(w,!1)&&(this.modelUris[h][w]=this.requestManager.normalizeModelURL(w),g[w]=this.modelUris[h][w]);this.load(g,h)}hasURLBeenRequested(s){return this.modelByURL[s]!==void 0}removeModel(s,h,g=!1){if(this.models[h]&&this.models[h][s]&&(this.models[h][s].numReferences--,this.models[h][s].numReferences===0)){const w=this.modelUris[h][s];g||delete this.modelUris[h][s],delete this.modelByURL[w];const S=this.models[h][s].model;if(!S)return;delete this.models[h][s],S.destroy()}}destroy(){for(const s of Object.keys(this.models))for(const h of Object.keys(this.models[s])){const g=this.models[s][h].model;delete this.models[s][h],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,h){this.models[h]||(this.models[h]={});for(const g in this.models[h])this.models[h][g].model&&this.models[h][g].model.upload(s.context)}}const zm=new i.a7({data:new i.a8(i.a5.colorTheme.data)}),kf={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Au(m){return m=m||{},Object.assign(m,kf)}class vd extends i.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(P,M){const[D,j]=P,{center:W,radius:K}=M,[Z,ee]=W,se=Math.abs(D-Z);return Math.sqrt((se>180?360-se:se)**2+(j-ee)**2)<=K}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.A("floorplangone")));const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=new i.P(this._map.transform.width/2,this._map.transform.height/2),w=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(s?w:g,h);S.length>0&&(this._selectedFloorplan&&S[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=S[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(S){const[[P,M],[D,j]]=S,W=(D-P+360)%360,K=W>180?360-W:W;return{center:[(P+K/2+360)%360,(M+j)/2],radius:Math.sqrt(K**2+(j-M)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const h=this._floorplanStates[this._indoorData.id].selectedBuilding,g=this._floorplanStates[this._indoorData.id].selectedLevel;let w;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const S of this._indoorData.levels)S.id===this._selectedLevel.id&&(w=S.id);if(this.fire(new i.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:w})),h){const S=this._indoorData.buildings.find(P=>P.id===h);this._buildingSelected(S,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(g){const S=this._indoorData.levels.find(P=>P.id===g);this._updateLevels(S,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,h){h&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const g=this._indoorData.levels.filter(w=>s.levels.includes(w.id));this.fire(new i.A("buildingselected",{buildingId:s.id,levels:g}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const h=this._indoorData.levels.find(g=>g.id===s);this._updateLevels(h,!0)}this.fire(new i.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,h){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(h&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function g(j){const W=j.indexOf("/floor/");if(W===-1)return j;const K=W+7,Z=j.indexOf("/",K);return Z===-1?j.slice(K):j.slice(K,Z)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const w=[],S={},P={},M={},D={};for(const j of this._indoorData.levels)if(w.push(j.id),S[j.id]=j.height,P[j.id]=j.base,s){if(this.mergeFloors){const W=g(s.id),K=g(j.id);M[j.id]=K===W?"true":"false"}else M[j.id]=j.id===s.id?"true":"false";D[j.id]=j.base<s.base?"true":"false"}else D[j.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",D]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),h&&s.extent)){const j=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),W=this._map.getZoom(),K=j.zoom?Math.abs(W-j.zoom):0;this._map.fitBounds(s.extent,K>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:W})}}selectFloorplan(s){const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(g,h);if(w.length>0){for(const S of w)if(JSON.parse(S.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=S,this._floorplanSelected(!0);break}}}selectBuilding(s){const h=this._indoorData.buildings.find(g=>g.id===s);this._buildingSelected(h,!0)}selectLevel(s){this._levelSelected(s)}}function Nm(m){if(!m.metadata||!m.metadata.content_area)return;const s=i.q.devicePixelRatio,{left:h,top:g,width:w,height:S}=m.metadata.content_area,P=h*s,M=g*s;return[P,M,P+w*s,M+S*s]}function xd(m){if(m)return m.map(([s,h])=>[s*i.q.devicePixelRatio,h*i.q.devicePixelRatio])}class z_{constructor(s,h,g){this.id=s,this.scope=h,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(s){this.missingRequests.has(s.name)||this.pendingRequests.has(s.name)||this.pendingRequests.add(s.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const s=new Map;if(!this.sourceCache.loaded())return s;const h=this.sourceCache.getVisibleCoordinates();if(h.length===0)return s;const g=this.sourceCache.getSource();if(!(g instanceof Il))return s;const w=h.map(P=>this.sourceCache.getTile(P)),S=g.getImages(w,Array.from(this.pendingRequests));for(const[P,M]of S)s.set(i.I.from({name:P,iconsetId:this.id}),M),this.pendingRequests.delete(P);for(const P of this.pendingRequests)this.missingRequests.add(P);return this.pendingRequests.clear(),s}}const ul=(m,s)=>$e(m,s&&s.filter(h=>h.identifier!=="source.canvas")),N_=i.aF(Hn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Fm=i.aF(Hn,["setCenter","setZoom","setBearing","setPitch"]),cc=new Set(["background","sky","slot","custom"]),Th={version:8,layers:[],sources:{}},Bm={duration:300,delay:0};class Uo extends i.E{constructor(s,h={}){super(),this.map=s,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=i.l({},Bm),this._buildingIndex=new R_(this),this.crossTileSymbolIndex=new Oo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new In,this.dispatcher=h.dispatcher?h.dispatcher:new i.D(i.d0(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new Ar(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new i.d1(s._requestManager,h.localFontFamily?i.d2.all:h.localIdeographFontFamily?i.d2.ideographs:i.d2.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new cl(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:h.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",i.d3());const g=this;this._rtlTextPluginCallback=Uo.registerForPluginStateChange(w=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(S,P)=>{if(i.d4(S),P&&P.every(M=>M))for(const M in g._sourceCaches){const D=g._sourceCaches[M],j=D.getSource().type;j!=="vector"&&j!=="geojson"||D.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const S=this.getOwnSource(w.sourceId);if(S&&S.vectorLayerIds)for(const P in this._layers){const M=this._layers[P];M.source===S.id&&this._validateLayer(M)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.f(s))return s;const h=i.d5(s);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${i.d6(JSON.stringify(s))}`}_diffStyle(s,h,g){this.globalId=this._getGlobalId(s);const w=(S,P)=>{try{P(null,this.setState(S,g))}catch(M){P(M,!1)}};if(typeof s=="string"){const S=this.map._requestManager.normalizeStyleURL(s),P=this.map._requestManager.transformRequest(S,i.R.Style);i.n(P,(M,D)=>{M?this.fire(new i.z(M)):D&&w(D,h)})}else typeof s=="object"&&w(s,h)}loadURL(s,h={}){this.fire(new i.A("dataloading",{dataType:"style"}));const g=typeof h.validate=="boolean"?h.validate:!i.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,h.accessToken),this.resolvedImports.add(s);const w=this.importsCache.get(s);if(w)return this._load(w,g);const S=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.n(S,(P,M)=>{if(this._request=null,P)this.fire(new i.z(P));else if(M)return this.importsCache.set(s,M),this._load(M,g)})}loadJSON(s,h={}){this.fire(new i.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.q.frame(()=>{this._request=null,this._load(s,h.validate!==!1)})}loadEmpty(){this.fire(new i.A("dataloading",{dataType:"style"})),this._load(Th,!1)}_loadImports(s,h,g){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const S of s){const P=this._createFragmentStyle(S),M=new Promise(W=>{P.once("style.import.load",W),P.once("error",W)}).then(()=>this.mergeAll());if(w.push(M),this.resolvedImports.has(S.url)){P.loadEmpty();continue}const D=S.data||this.importsCache.get(S.url);D?(P.loadJSON(D,{validate:h}),this._isInternalStyle(D)&&(P.globalId=null)):S.url?P.loadURL(S.url,{validate:h}):P.loadEmpty();const j={style:P,id:S.id,config:S.config};if(g){const W=this.fragments.findIndex(({id:K})=>K===g);this.fragments=this.fragments.slice(0,W).concat(j).concat(this.fragments.slice(W))}else this.fragments.push(j)}return Promise.allSettled(w)}getImportGlobalIds(s=this,h=new Set){for(const g of s.fragments)g.style.globalId&&h.add(g.style.globalId),this.getImportGlobalIds(g.style,h);return[...h.values()]}_createFragmentStyle(s){const h=this.scope?i.C(s.id,this.scope):s.id;let g;const w=this._initialConfig&&this._initialConfig[h];(s.config||w)&&(g=i.l({},s.config,w));const S=new Uo(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,h){const g=s.indoor?Au(s.schema):s.schema;if(this._isInternalStyle(s)){const P=i.l({},Th,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(P,h)}if(this.updateConfig(this._config,g),h&&ul(this,pa(s)))return;this._loaded=!0,this.stylesheet=i.d7(s);const w=()=>{for(const j in s.sources)this.addSource(j,s.sources[j],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const j in s.iconsets)this.addIconset(j,s.iconsets[j]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);const P=Ms(this.stylesheet.layers);if(this._order=P.map(j=>j.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const j=this.stylesheet.lights[0];this.light=new ft(j.properties,j.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ft(this.stylesheet.light)),this._layers={};for(const j of P){const W=i.dc(j,this.scope,this._styleColorTheme.lut,this.options);W.configDependencies.size!==0&&this._configDependentLayers.add(W.fqid),W.setEventedParent(this,{layer:{id:W.id}}),this._layers[W.id]=W;const K=this.getOwnLayerSourceCache(W),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();K&&W.canCastShadows()&&Z&&(K.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const M=this.stylesheet.terrain;M&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(M,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.A("data",{dataType:"style"}));const D=this.isRootStyle();s.imports?this._loadImports(s.imports,h).then(()=>{this._reloadImports(),this.fire(new i.A(D?"style.load":"style.import.load"))}).catch(j=>{this.fire(new i.z(new Error("Failed to load imports",j))),this.fire(new i.A(D?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.A(D?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const S=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(S){const P=this._evaluateColorThemeData(S);this._loadColorTheme(P).then(()=>{w()}).catch(M=>{i.w(`Couldn't load color theme from the stylesheet: ${M}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,h,g,w,S,P,M,D,j,W;const K={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Z=>{if(Z.stylesheet){if(Z.light!=null&&(s=Z.light),Z.stylesheet.lights)for(const ee of Z.stylesheet.lights)ee.type==="ambient"&&Z.ambientLight!=null&&(h=Z.ambientLight),ee.type==="directional"&&Z.directionalLight!=null&&(g=Z.directionalLight);w=this._prioritizeTerrain(w,Z.terrain,Z.stylesheet.terrain),Z.stylesheet.fog&&Z.fog!=null&&(S=Z.fog),Z.stylesheet.snow&&Z.snow!=null&&(P=Z.snow),Z.stylesheet.rain&&Z.rain!=null&&(M=Z.rain),Z.stylesheet.camera!=null&&(W=Z.stylesheet.camera),Z.stylesheet.projection!=null&&(D=Z.stylesheet.projection),Z.stylesheet.transition!=null&&(j=Z.stylesheet.transition),K[Z.scope]=Z._styleColorTheme}}),this.light=s,this.ambientLight=h,this.directionalLight=g,this.fog=S,this.snow=P,this.rain=M,this._styleColorThemeForScope=K,w===null?delete this.terrain:this.terrain=w,this.camera=W||{"camera-projection":"perspective"},this.projection=D||{name:"mercator"},this.transition=i.l({},Bm,j),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const h=g=>{for(const w of g.fragments)h(w.style);s(g)};h(this)}_prioritizeTerrain(s,h,g){const w=s&&s.drapeRenderMode===0;return g===null?h&&h.drapeRenderMode===0?h:w?s:null:h!=null&&(!s||w||h&&h.drapeRenderMode===1)?h:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{s=this._prioritizeTerrain(s,h.terrain,h.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(s=h.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},h={},g={};this.forEachFragmentStyle(w=>{for(const S in w._sourceCaches){const P=i.C(S,w.scope);s[P]=w._sourceCaches[S]}for(const S in w._otherSourceCaches){const P=i.C(S,w.scope);h[P]=w._otherSourceCaches[S]}for(const S in w._symbolSourceCaches){const P=i.C(S,w.scope);g[P]=w._symbolSourceCaches[S]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=g}mergeLayers(){const s={},h=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const P of S._order){const M=S._layers[P];if(M.type==="slot"){const D=i.d8(P);if(s[D])continue;s[D]=[]}M.slot&&s[M.slot]?s[M.slot].push(M):h.push(M)}}),this._mergedOrder=[];const w=(S=[])=>{for(const P of S)if(P.type==="slot"){const M=i.d8(P.id);s[M]&&w(s[M]),this._mergedSlots.push(M)}else{const M=i.C(P.id,P.scope);this._mergedOrder.push(M),g[M]=P,P.is3D(!!this.terrain)&&(this._has3DLayers=!0),P.type==="circle"&&(this._hasCircleLayers=!0),P.type==="symbol"&&(this._hasSymbolLayers=!0),P.type==="clip"&&(this._clipLayerPresent=!0)}};w(h),this._mergedOrder.sort((S,P)=>{const M=g[S],D=g[P];return M.hasInitialOcclusionOpacityProperties?D.is3D(!!this.terrain)?1:0:M.is3D(!!this.terrain)&&D.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=i.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(h,g,w){const S=i.l({},g);for(const M of Object.keys(i.a5.colorTheme))S[M]===void 0&&(S[M]=i.a5.colorTheme[M].default);const P=new i.a6(zm,h,new Map(w));return P.setTransitionOrValue(S,w),P.untransitioned().possiblyEvaluate(new i.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const h=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,w)=>{const S="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let P=s;P.startsWith(S)||(P=S+P);const M=i.I.from("mapbox-reserved-lut"),D=new Image;D.src=P,D.onerror=()=>{this._styleColorTheme.lutLoading=!1,w(new Error("Failed to load image data"))},D.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==h)return void g();this._styleColorTheme.lutLoading=!1;const{width:j,height:W,data:K}=i.q.getImageData(D);if(W>32)return void w(new Error("The height of the image must be less than or equal to 32 pixels."));if(j!==W*W)return void w(new Error("The width of the image must be equal to the height squared."));this.getImage(M)&&this.removeImage(M),this.addImage(M,{data:new i.r({width:j,height:W},K),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Z=this.imageManager.getImage(M,this.scope);Z?(this._styleColorTheme.lut={image:Z.data,data:s},g()):w(new Error("Missing LUT image."))}})}getLut(s){const h=this._styleColorThemeForScope[s];return h?h.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(h,g,w){let S,P,M;const D=i.q.devicePixelRatio>1?"@2x":"";let j=i.n(g.transformRequest(g.normalizeSpriteURL(h,D,".json"),i.R.SpriteJSON),(Z,ee)=>{j=null,M||(M=Z,S=ee,K())}),W=i.o(g.transformRequest(g.normalizeSpriteURL(h,D,".png"),i.R.SpriteImage),(Z,ee)=>{W=null,M||(M=Z,P=ee,K())});function K(){if(M)w(M);else if(S&&P){const Z=i.q.getImageData(P),ee={};for(const se in S){const{width:oe,height:he,x:le,y:xe,sdf:Te,pixelRatio:Pe,stretchX:ze,stretchY:ke,content:Re}=S[se],Ie=new i.r({width:oe,height:he});i.r.copy(Z,Ie,{x:le,y:xe},{x:0,y:0},{width:oe,height:he},null),ee[se]={data:Ie,pixelRatio:Pe,sdf:Te,stretchX:ze,stretchY:ke,content:Re,usvg:!1}}w(null,ee)}}return{cancel(){j&&(j.cancel(),j=null),W&&(W.cancel(),W=null)}}}(s,this.map._requestManager,(h,g)=>{if(this._spriteRequest=null,h)this.fire(new i.z(h));else if(g){const w=new Map;for(const S in g)w.set(i.I.from(S),g[S]);this.addImages(w)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))})}addIconset(s,h){if(h.type==="sprite")return void this._loadSprite(h.url);const g=this.getOwnSourceCache(h.source);if(!g)return void this.fire(new i.z(new Error(`Source "${h.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));const w=g.getSource();if(w.type!=="raster-array")return void this.fire(new i.z(new Error(`Source "${h.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));w.partial=!1;const S=new z_(s,this.scope,g);this.imageManager.addImageProvider(S,this.scope)}removeIconset(s){this.imageManager.removeImageProvider(s,this.scope)}_loadIconset(s){if(!i.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const h=this.map._spriteFormat==="auto";var g,w;this._spriteRequest=(w=(S,P)=>{if(this._spriteRequest=null,S)h?this._loadSprite(s):this.fire(new i.z(S));else if(P){const M=new Map;for(const D in P)M.set(i.I.from(D),P[D]);this.addImages(M)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))},i.br((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(s),i.R.Iconset),(S,P)=>{if(S)return void w(S);const M={},D=i.c_(new i.bq(P));for(const j of D.icons){const W={version:1,pixelRatio:i.q.devicePixelRatio,content:Nm(j),stretchX:j.metadata?xd(j.metadata.stretch_x_areas):void 0,stretchY:j.metadata?xd(j.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:j};M[j.name]=W}w(null,M)}))}_validateLayer(s){const h=this.getOwnSource(s.source);if(!h)return;const g=s.sourceLayer;g&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.z(new Error(`Source layer "${g}" does not exist on source "${h.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,h)=>{const g=this.fragments[h];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){const s={};for(const h in this._sourceCaches){const g=this._sourceCaches[h].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){const h=[];for(const g of s){const w=this._layers[g];w&&w.type!=="custom"&&h.push(w.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const h=this.getOwnLayer(s);if(h)return h;this.fire(new i.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const h=this.getOwnSource(s);if(h)return h;this.fire(new i.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,h){const g=this.map.painter;if(g)for(let w=s.minzoom||0;w<(s.maxzoom||25.5);w++){const S=s.getProgramIds();if(S)for(const P of S){const M=s.getDefaultProgramParams(P,h.zoom,this._styleColorTheme.lut);M&&(g.style=this,this.fog&&(g._fogVisible=!0,M.overrideFog=!0,g.getOrCreateProgram(P,M)),g._fogVisible=!1,M.overrideFog=!1,g.getOrCreateProgram(P,M),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(M.overrideRtt=!0,g.getOrCreateProgram(P,M)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const h=this.calculateLightsBrightness();s.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));const g=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const M=this._changes.getLayerUpdatesByScope();for(const D in M){const{updatedIds:j,removedIds:W}=M[D];(j||W)&&(this._updateWorkerLayers(D,j,W),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const S={};for(const M in this._mergedSourceCaches){const D=this._mergedSourceCaches[M];S[M]=D.used,D.used=!1,D.tileCoverLift=0}for(const M of this._mergedOrder){const D=this._mergedLayers[M];if(D.recalculate(s,this._availableImages),!D.isHidden(s.zoom)){const j=this.getLayerSourceCache(D);j&&(j.used=!0,j.tileCoverLift=Math.max(j.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,s)}):this.precompilePrograms(D,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();const P=this.imageManager.getPendingImageProviders();for(const M of P)M.sourceCache.used=!0;for(const M in S){const D=this._mergedSourceCaches[M];S[M]!==D.used&&D.getSource().fire(new i.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new i.A("data",{dataType:"style"}))}updateImageProviders(){const s=this.imageManager.getPendingImageProviders();for(const h of s){const g=h.resolvePendingRequests(),w=this.getFragmentStyle(h.scope);w&&w.addImages(g)}}_updateTilesForChangedImages(){const s={};for(const h in this._mergedSourceCaches){const g=this._mergedSourceCaches[h].getSource().scope;s[g]=s[g]||this._changes.getUpdatedImages(g),s[g].length!==0&&this._mergedSourceCaches[h].reloadTilesForDependencies(["icons","patterns"],s[g])}for(const h in s)this._changes.resetUpdatedImages(h)}_updateWorkerLayers(s,h,g){const w=this.getFragmentStyle(s);w&&this.dispatcher.broadcast("updateLayers",{layers:h?w._serializeLayers(h):[],scope:s,removedIds:g||[],options:w.options})}setState(s,h){if(this._checkLoaded(),ul(this,pa(s)))return!1;(s=i.d7(s)).layers=Ms(s.layers);const g=function(P,M){if(!P)return[{command:Hn.setStyle,args:[M]}];let D=[];try{if(!i.bv(P.version,M.version))return[{command:Hn.setStyle,args:[M]}];if(i.bv(P.center,M.center)||D.push({command:Hn.setCenter,args:[M.center]}),i.bv(P.zoom,M.zoom)||D.push({command:Hn.setZoom,args:[M.zoom]}),i.bv(P.bearing,M.bearing)||D.push({command:Hn.setBearing,args:[M.bearing]}),i.bv(P.pitch,M.pitch)||D.push({command:Hn.setPitch,args:[M.pitch]}),i.bv(P.sprite,M.sprite)||D.push({command:Hn.setSprite,args:[M.sprite]}),i.bv(P.glyphs,M.glyphs)||D.push({command:Hn.setGlyphs,args:[M.glyphs]}),i.bv(P.imports,M.imports)||function(ee=[],se=[],oe){se=se||[];const he=(ee=ee||[]).map(Ol),le=se.map(Ol),xe=ee.reduce(kl,{}),Te=se.reduce(kl,{}),Pe=he.slice();let ze,ke,Re,Ie;for(ze=0,ke=0;ze<he.length;ze++)Re=he[ze],Te.hasOwnProperty(Re)?ke++:(oe.push({command:Hn.removeImport,args:[Re]}),Pe.splice(Pe.indexOf(Re,ke),1));for(ze=0,ke=0;ze<le.length;ze++)Re=le[le.length-1-ze],Pe[Pe.length-1-ze]!==Re&&(xe.hasOwnProperty(Re)?(oe.push({command:Hn.removeImport,args:[Re]}),Pe.splice(Pe.lastIndexOf(Re,Pe.length-ke),1)):ke++,Ie=Pe[Pe.length-ze],oe.push({command:Hn.addImport,args:[Te[Re],Ie]}),Pe.splice(Pe.length-ze,0,Re));for(const Ve of se){const Ge=xe[Ve.id];Ge&&!i.bv(Ge,Ve)&&oe.push({command:Hn.updateImport,args:[Ve.id,Ve]})}}(P.imports,M.imports,D),i.bv(P.transition,M.transition)||D.push({command:Hn.setTransition,args:[M.transition]}),i.bv(P.light,M.light)||D.push({command:Hn.setLight,args:[M.light]}),i.bv(P.fog,M.fog)||D.push({command:Hn.setFog,args:[M.fog]}),i.bv(P.snow,M.snow)||D.push({command:Hn.setSnow,args:[M.snow]}),i.bv(P.rain,M.rain)||D.push({command:Hn.setRain,args:[M.rain]}),i.bv(P.projection,M.projection)||D.push({command:Hn.setProjection,args:[M.projection]}),i.bv(P.lights,M.lights)||D.push({command:Hn.setLights,args:[M.lights]}),i.bv(P.camera,M.camera)||D.push({command:Hn.setCamera,args:[M.camera]}),i.bv(P.iconsets,M.iconsets)||function(ee,se,oe){let he;for(he in se=se||{},ee=ee||{})ee.hasOwnProperty(he)&&(se.hasOwnProperty(he)||oe.push({command:Hn.removeIconset,args:[he]}));for(he in se){if(!se.hasOwnProperty(he))continue;const le=se[he];ee.hasOwnProperty(he)?i.bv(ee[he],le)||(oe.push({command:Hn.removeIconset,args:[he]}),oe.push({command:Hn.addIconset,args:[he,le]})):oe.push({command:Hn.addIconset,args:[he,le]})}}(P.iconsets,M.iconsets,D),!i.bv(P["color-theme"],M["color-theme"]))return[{command:Hn.setStyle,args:[M]}];const j={},W=[];(function(ee,se,oe,he){let le;for(le in se=se||{},ee=ee||{})ee.hasOwnProperty(le)&&(se.hasOwnProperty(le)||Bc(le,oe,he));for(le in se){if(!se.hasOwnProperty(le))continue;const xe=se[le];ee.hasOwnProperty(le)?i.bv(ee[le],xe)||(ee[le].type==="geojson"&&xe.type==="geojson"&&Pf(ee,se,le)?oe.push({command:Hn.setGeoJSONSourceData,args:[le,xe.data]}):Om(le,se,oe,he)):bu(le,se,oe)}})(P.sources,M.sources,W,j);const K=[];P.layers&&P.layers.forEach(ee=>{ee.source&&j[ee.source]?D.push({command:Hn.removeLayer,args:[ee.id]}):K.push(ee)});let Z=P.terrain;Z&&j[Z.source]&&(D.push({command:Hn.setTerrain,args:[void 0]}),Z=void 0),D=D.concat(W),i.bv(Z,M.terrain)||D.push({command:Hn.setTerrain,args:[M.terrain]}),function(ee,se,oe){se=se||[];const he=(ee=ee||[]).map(Ol),le=se.map(Ol),xe=ee.reduce(kl,{}),Te=se.reduce(kl,{}),Pe=he.slice(),ze=Object.create(null);let ke,Re,Ie,Ve,Ge,ht,et;for(ke=0,Re=0;ke<he.length;ke++)Ie=he[ke],Te.hasOwnProperty(Ie)?Re++:(oe.push({command:Hn.removeLayer,args:[Ie]}),Pe.splice(Pe.indexOf(Ie,Re),1));for(ke=0,Re=0;ke<le.length;ke++)Ie=le[le.length-1-ke],Pe[Pe.length-1-ke]!==Ie&&(xe.hasOwnProperty(Ie)?(oe.push({command:Hn.removeLayer,args:[Ie]}),Pe.splice(Pe.lastIndexOf(Ie,Pe.length-Re),1)):Re++,ht=Pe[Pe.length-ke],oe.push({command:Hn.addLayer,args:[Te[Ie],ht]}),Pe.splice(Pe.length-ke,0,Ie),ze[Ie]=!0);for(ke=0;ke<le.length;ke++)if(Ie=le[ke],Ve=xe[Ie],Ge=Te[Ie],!ze[Ie]&&!i.bv(Ve,Ge))if(i.bv(Ve.source,Ge.source)&&i.bv(Ve["source-layer"],Ge["source-layer"])&&i.bv(Ve.type,Ge.type)){for(et in Os(Ve.layout,Ge.layout,oe,Ie,null,Hn.setLayoutProperty),Os(Ve.paint,Ge.paint,oe,Ie,null,Hn.setPaintProperty),i.bv(Ve.slot,Ge.slot)||oe.push({command:Hn.setSlot,args:[Ie,Ge.slot]}),i.bv(Ve.filter,Ge.filter)||oe.push({command:Hn.setFilter,args:[Ie,Ge.filter]}),i.bv(Ve.minzoom,Ge.minzoom)&&i.bv(Ve.maxzoom,Ge.maxzoom)||oe.push({command:Hn.setLayerZoomRange,args:[Ie,Ge.minzoom,Ge.maxzoom]}),Ve)Ve.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?Os(Ve[et],Ge[et],oe,Ie,et.slice(6),Hn.setPaintProperty):i.bv(Ve[et],Ge[et])||oe.push({command:Hn.setLayerProperty,args:[Ie,et,Ge[et]]}));for(et in Ge)Ge.hasOwnProperty(et)&&!Ve.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?Os(Ve[et],Ge[et],oe,Ie,et.slice(6),Hn.setPaintProperty):i.bv(Ve[et],Ge[et])||oe.push({command:Hn.setLayerProperty,args:[Ie,et,Ge[et]]}))}else oe.push({command:Hn.removeLayer,args:[Ie]}),ht=Pe[Pe.lastIndexOf(Ie)+1],oe.push({command:Hn.addLayer,args:[Ge,ht]})}(K,M.layers,D)}catch(j){console.warn("Unable to compute style diff:",j),D=[{command:Hn.setStyle,args:[M]}]}return D}(this.serialize(),s).filter(P=>!(P.command in Fm));if(g.length===0)return!1;const w=g.filter(P=>!(P.command in N_));if(w.length>0)throw new Error(`Unimplemented: ${w.map(P=>P.command).join(", ")}.`);const S=[];return g.forEach(P=>{S.push(this[P.command](...P.args))}),h&&Promise.all(S).then(h).catch(h),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(s){for(const[h,g]of s.entries()){if(this.getImage(h))return this.fire(new i.z(new Error(`An image with the name "${h.name}" already exists.`)));this.imageManager.addImage(h,this.scope,g),this._changes.updateImage(h,this.scope)}return this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this}addImage(s,h){return this.getImage(s)?this.fire(new i.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,h),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this)}updateImage(s,h,g=!1){this.imageManager.updateImage(s,this.scope,h),g&&(this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(s){return this.modelManager.addModelURLs(s,this.scope),this._updateWorkerModels(),this.fire(new i.A("data",{dataType:"style"})),this}addModel(s,h,g={}){return this._checkLoaded(),this._validate(je,`models.${s}`,h,null,g)||(this.modelManager.addModel(s,h,this.scope),this.fire(new i.A("data",{dataType:"style"}))),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,h,g={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(Ps,`sources.${s}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const w=rl(s,h,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const S=P=>{const M=(P?"symbol:":"other:")+w.id,D=i.C(M,this.scope),j=this._sourceCaches[M]=new _a(D,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=j,j.onAdd(this.map)};S(!1),h.type!=="vector"&&h.type!=="geojson"||S(!0),w.onAdd&&w.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const h=this.getOwnSource(s);if(!h)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const w=Object.entries(this.stylesheet.iconsets).find(([S,P])=>P.type==="source"&&P.source===s);if(w)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while iconset "${w[0]}" is using it.`)))}const g=this.getOwnSourceCaches(s);for(const w of g){const S=i.d8(w.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(w.id),w.fire(new i.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,h){this._checkLoaded(),this.getOwnSource(s).setData(h),this._changes.setDirty()}getOwnSource(s){const h=this.getOwnSourceCache(s);return h&&h.getSource()}getOwnSources(){const s=[];for(const h in this._otherSourceCaches){const g=this.getOwnSourceCache(h);g&&s.push(g.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const h in s){const g=s[h]._tiles;for(const w in g){const S=g[w];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const w of s){if(this._validate(Cl,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(w),S.updateTransitions(h)}else this.ambientLight=new no(w,ui||(ui=new i.a7({color:new i.a8(i.a5.properties_light_ambient.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(w),S.updateTransitions(h)}else this.directionalLight=new no(w,Cr||(Cr=new i.a7({direction:new i.an(i.a5.properties_light_directional.direction),color:new i.a8(i.a5.properties_light_directional.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_directional.intensity),"cast-shadows":new i.a8(i.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a8(i.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a8(i.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=new i.aa(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,h=this.ambientLight;if(!s||!h)return;const g=Z=>.2126*(Z[0]<=.03928?Z[0]/12.92:Math.pow((Z[0]+.055)/1.055,2.4))+.7152*(Z[1]<=.03928?Z[1]/12.92:Math.pow((Z[1]+.055)/1.055,2.4))+.0722*(Z[2]<=.03928?Z[2]/12.92:Math.pow((Z[2]+.055)/1.055,2.4)),w=s.properties.get("color").toRenderColor(null).toArray01(),S=s.properties.get("intensity"),P=s.properties.get("direction"),M=1-i.cR(P.x,P.y,P.z)[2]/90,D=g(w)*S*M,j=h.properties.get("color").toRenderColor(null).toArray01(),W=h.properties.get("intensity"),K=g(j)*W;return Number(((D+K)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(s==null||s===""&&this.isRootStyle())return this;if(i.d9(s)){const h=i.da(s),g=this.fragments.find(({id:S})=>S===h);if(!g)return;const w=i.d8(s);return g.style.getFragmentStyle(w)}{const h=this.fragments.find(({id:g})=>g===s);return h?h.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const h={},g=(w,S="")=>`${w}::${S}`;this._featuresetSelectors={};for(const w in s){const S=this._featuresetSelectors[w]=[];for(const P of s[w].selectors){if(P.featureNamespace){const D=this.getOwnLayer(P.layer);if(!D){i.w(`Layer is undefined for selector: ${P.layer}`);continue}const j=g(D.source,D.sourceLayer);if(j in h&&h[j]!==P.featureNamespace){i.w(`"featureNamespace ${P.featureNamespace} of featureset ${w}'s selector is not associated to the same source, skip this selector`);continue}h[j]=P.featureNamespace}let M;if(P.properties)for(const D in P.properties){const j=i.X(P.properties[D]);j.result==="success"&&(M=M||{},M[D]=j.value)}S.push({layerId:P.layer,namespace:P.featureNamespace,properties:M,uniqueFeatureID:P._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const h=this.getFragmentStyle(s);if(!h||!h.stylesheet.featuresets)return[];const g=[];for(const w in h.stylesheet.featuresets)g.push({featuresetId:w,importId:h.scope?h.scope:void 0});return g}getFeaturesetLayers(s,h){const g=this.getFragmentStyle(h),w=g.stylesheet.featuresets;if(!w||!w[s])return this.fire(new i.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const P of w[s].selectors){const M=g.getOwnLayer(P.layer);M&&S.push(M)}return S}getConfigProperty(s,h){const g=this.getFragmentStyle(s);if(!g)return null;const w=i.C(h,g.scope),S=g.options.get(w),P=S?S.value||S.default:null;return P?P.serialize():null}setConfigProperty(s,h,g){const w=this.getFragmentStyle(s);if(!w)return;const S=w.stylesheet.indoor?Au(w.stylesheet.schema):w.stylesheet.schema;if(!S||!S[h])return;const P=i.X(g);if(P.result!=="success")return void ul(this,P.value);const M=P.value.expression,D=i.C(h,w.scope),j=w.options.get(D);if(!j)return;let W;const{minValue:K,maxValue:Z,stepValue:ee,type:se,values:oe}=S[h],he=i.X(S[h].default);he.result==="success"&&(W=he.value.expression),W?(this.options.set(D,Object.assign({},j,{value:M,default:W,minValue:K,maxValue:Z,stepValue:ee,type:se,values:oe})),this.updateConfigDependencies(h)):this.fire(new i.z(new Error(`No schema defined for the config option "${h}" in the "${s}" fragment.`)))}getConfig(s){const h=this.getFragmentStyle(s);if(!h)return null;const g=h.stylesheet.schema;if(!g)return null;const w={};for(const S in g){const P=i.C(S,h.scope),M=h.options.get(P),D=M?M.value||M.default:null;w[S]=D?D.serialize():null}return w}setConfig(s,h){const g=this.getFragmentStyle(s);g&&(g.updateConfig(h,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const h=this.getFragmentStyle(s);return h?h.stylesheet.schema:null}setSchema(s,h){const g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=h,g.updateConfig(g._config,h),this.updateConfigDependencies())}updateConfig(s,h){if(this._config=s,s||h)if(h)for(const g in h){let w,S;const P=i.X(h[g].default);if(P.result==="success"&&(w=P.value.expression),s&&s[g]!==void 0){const Z=i.X(s[g]);Z.result==="success"&&(S=Z.value.expression)}const{minValue:M,maxValue:D,stepValue:j,type:W,values:K}=h[g];if(w){const Z=i.C(g,this.scope);this.options.set(Z,{default:w,value:S,minValue:M,maxValue:D,stepValue:j,type:W,values:K})}else this.fire(new i.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new i.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const h of this._configDependentLayers){const g=this.getLayer(h);if(g){if(s&&!g.configDependencies.has(s))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(h=>{const g=h._styleColorTheme.colorThemeOverride?h._styleColorTheme.colorThemeOverride:h._styleColorTheme.colorTheme;if(g){const w=h._evaluateColorThemeData(g);(!h._styleColorTheme.lut&&w!==""||h._styleColorTheme.lut&&w!==h._styleColorTheme.lut.data)&&h.setColorTheme(g)}}),this._changes.setDirty()}addLayer(s,h,g={}){this._checkLoaded();const w=s.id;if(this._layers[w])return void this.fire(new i.z(new Error(`Layer with id "${w}" already exists on this map`)));let S;if(s.type==="custom"){if(ul(this,i.db(s)))return;S=i.dc(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(w,s.source),s=i.d7(s),s=i.l(s,{source:w})),this._validate(ae,`layers.${w}`,s,{arrayIndex:-1},g))return;S=i.dc(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}})}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let P=this._order.length;if(h){const W=this._order.indexOf(h);if(W===-1)return void this.fire(new i.z(new Error(`Layer with id "${h}" does not exist on this map.`)));S.slot===this._layers[h].slot?P=W:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=S;const M=this.getOwnLayerSourceCache(S),D=!!this.directionalLight&&this.directionalLight.shadowsEnabled();M&&S.canCastShadows()&&D&&(M.castsShadows=!0);const j=this._changes.getRemovedLayer(S);if(j&&S.source&&M&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const W=i.C(S.source,S.scope);j.type!==S.type?this._changes.updateSourceCache(W,"clear"):(this._changes.updateSourceCache(W,"reload"),M.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(s,h){this._checkLoaded();const g=this._checkLayer(s);if(!g||s===h)return;const w=this._order.indexOf(s);this._order.splice(w,1);let S=this._order.length;if(h){const P=this._order.indexOf(h);if(P===-1)return void this.fire(new i.z(new Error(`Layer with id "${h}" does not exist on this map.`)));g.slot===this._layers[h].slot?S=P:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const h=this._checkLayer(s);if(!h)return;h.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const w=this.getOwnLayerSourceCache(h);if(w&&w.castsShadows){let S=!1;for(const P in this._layers)if(this._layers[P].source===h.source&&this._layers[P].canCastShadows()){S=!0;break}w.castsShadows=S}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const h in this._layers)if(this._layers[h].type===s)return!0;return!1}setLayerZoomRange(s,h,g){this._checkLoaded();const w=this._checkLayer(s);w&&(w.minzoom===h&&w.maxzoom===g||(h!=null&&(w.minzoom=h),g!=null&&(w.maxzoom=g),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,h){this._checkLoaded();const g=this._checkLayer(s);g&&g.slot!==h&&(g.slot=h,this._updateLayer(g))}setFilter(s,h,g={}){this._checkLoaded();const w=this._checkLayer(s);if(w&&!i.bv(w.filter,h))return h==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(me,`layers.${w.id}.filter`,h,{layerType:w.type},g)||(w.filter=i.d7(h),this._updateLayer(w)))}getFilter(s){const h=this._checkLayer(s);if(h)return i.d7(h.filter)}setLayoutProperty(s,h,g,w={}){this._checkLoaded();const S=this._checkLayer(s);if(S&&!i.bv(S.getLayoutProperty(h),g)){if(g!=null&&(!w||w.validate!==!1)&&ul(S,We.call(pa,{key:`layers.${s}.layout.${h}`,layerType:S.type,objectKey:h,value:g,styleSpec:i.a5,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(h,g),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(s,h){const g=this._checkLayer(s);if(g)return g.getLayoutProperty(h)}setPaintProperty(s,h,g,w={}){this._checkLoaded();const S=this._checkLayer(s);if(!S||i.bv(S.getPaintProperty(h),g)||g!=null&&(!w||w.validate!==!1)&&ul(S,Me.call(pa,{key:`layers.${s}.paint.${h}`,layerType:S.type,objectKey:h,value:g,styleSpec:i.a5})))return;const P=S.setPaintProperty(h,g);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),P&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(s,h){const g=this._checkLayer(s);if(g)return g.getPaintProperty(h)}setFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:D,importId:j}=s.target,W=this.getFragmentStyle(j),K=W.getFeaturesetLayers(D);for(const{source:Z,sourceLayer:ee}of K)W.setFeatureState({id:s.id,source:Z,sourceLayer:ee},h)}else if("layerId"in s.target){const{layerId:D}=s.target,j=this.getLayer(D);this.setFeatureState({id:s.id,source:j.source,sourceLayer:j.sourceLayer},h)}return}const g=s.source,w=s.sourceLayer,S=this._checkSource(g);if(!S)return;const P=S.type;if(P==="geojson"&&w)return void this.fire(new i.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!w)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided.")));const M=this.getOwnSourceCaches(g);for(const D of M)D.setFeatureState(w,s.id,h)}removeFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:D,importId:j}=s.target,W=this.getFragmentStyle(j),K=W.getFeaturesetLayers(D);for(const{source:Z,sourceLayer:ee}of K)W.removeFeatureState({id:s.id,source:Z,sourceLayer:ee},h)}else if("layerId"in s.target){const{layerId:D}=s.target,j=this.getLayer(D);this.removeFeatureState({id:s.id,source:j.source,sourceLayer:j.sourceLayer},h)}return}const g=s.source,w=this._checkSource(g);if(!w)return;const S=w.type,P=S==="vector"?s.sourceLayer:void 0;if(S==="vector"&&!P)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.z(new Error("A feature id is required to remove its specific state property.")));const M=this.getOwnSourceCaches(g);for(const D of M)D.removeFeatureState(P,s.id,h)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let S;if("featuresetId"in s.target){const{featuresetId:P,importId:M}=s.target,D=this.getFragmentStyle(M),j=D.getFeaturesetLayers(P);for(const{source:W,sourceLayer:K}of j){const Z=D.getFeatureState({id:s.id,source:W,sourceLayer:K});if(Z&&!S)S=Z;else if(!i.bv(S,Z))return void this.fire(new i.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:P}=s.target,M=this.getLayer(P);S=this.getFeatureState({id:s.id,source:M.source,sourceLayer:M.sourceLayer})}return S}const h=s.source,g=s.sourceLayer,w=this._checkSource(h);if(w){if(w.type!=="vector"||g)return s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(g,s.id);this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=i.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),h=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.dd({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(s){for(const h of Object.values(this._mergedLayers))s(h)&&this._updateLayer(h)}_updateLayer(s){this._changes.updateLayer(s);const h=this.getLayerSourceCache(s),g=i.C(s.source,s.scope),w=this._changes.getUpdatedSourceCaches();s.source&&!w[g]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),h.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const h=M=>this._mergedLayers[M].is3D(!!this.terrain),g=this.order,w={},S=[];for(let M=g.length-1;M>=0;M--){const D=g[M];if(h(D)){w[D]=M;for(const j of s){const W=j[D];if(W)for(const K of W)S.push(K)}}}S.sort((M,D)=>D.intersectionZ-M.intersectionZ);const P=[];for(let M=g.length-1;M>=0;M--){const D=g[M];if(h(D))for(let j=S.length-1;j>=0;j--){const W=S[j].feature;if(W.layer&&w[W.layer.id]<M)break;P.push(W),S.pop()}else for(const j of s){const W=j[D];if(W)for(const K of W)P.push(K.feature)}}return P}queryRenderedFeatures(s,h,g){let w;h&&!Array.isArray(h)&&h.filter&&(this._validate(me,"queryRenderedFeatures.filter",h.filter,null,h),w=i.b3(h.filter));const S={},P=W=>{if(cc.has(W.type))return;const K=this.getOwnLayerSourceCache(W),Z=S[K.id]=S[K.id]||{sourceCache:K,layers:{},has3DLayers:!1};W.is3D(!!this.terrain)&&(Z.has3DLayers=!0),Z.layers[W.fqid]=Z.layers[W.fqid]||{styleLayer:W,targets:[]},Z.layers[W.fqid].targets.push({filter:w})};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new i.z(new Error("parameters.layers must be an Array."))),[];for(const W of h.layers){const K=this._layers[W];if(!K)return this.fire(new i.z(new Error(`The layer '${W}' does not exist in the map's style and cannot be queried for features.`))),[];P(K)}}else for(const W in this._layers)P(this._layers[W]);const M=this._queryRenderedFeatures(s,S,g),D=this._flattenAndSortRenderedFeatures(M),j=[];for(const W of D)i.de(W.layer.id)===this.scope&&j.push(W);return j}queryRenderedFeatureset(s,h,g){let w;h&&!Array.isArray(h)&&h.filter&&(this._validate(me,"queryRenderedFeatures.filter",h.filter,null,h),w=i.b3(h.filter));const S="mock",P=[];if(h&&h.target)P.push(Object.assign({},h,{targetId:S,filter:w}));else{const W=this.getFeaturesetDescriptors();for(const K of W)P.push({targetId:S,filter:w,target:K});for(const{style:K}of this.fragments){const Z=K.getFeaturesetDescriptors();for(const ee of Z)P.push({targetId:S,filter:w,target:ee})}}const M=this.queryRenderedTargets(s,P,g),D=[],j=new Set;for(const W of M)for(const K of W.variants[S])Wr(K,W,j)||D.push(new i.df(W,K));return D}queryRenderedTargets(s,h,g){const w={},S=(M,D,j,W)=>{const K=w[D.id]=w[D.id]||{sourceCache:D,layers:{},has3DLayers:!1};if(K.layers[M.fqid]=K.layers[M.fqid]||{styleLayer:M,targets:[]},M.is3D(!!this.terrain)&&(K.has3DLayers=!0),!W)return j.uniqueFeatureID=!1,void K.layers[M.fqid].targets.push(j);K.layers[M.fqid].targets.push(Object.assign({},j,{namespace:W.namespace,properties:W.properties,uniqueFeatureID:W.uniqueFeatureID}))};for(const M of h)if("featuresetId"in M.target){const{featuresetId:D,importId:j}=M.target,W=this.getFragmentStyle(j);if(!W||!W._featuresetSelectors)continue;const K=W._featuresetSelectors[D];if(!K){this.fire(new i.z(new Error(`The featureset '${D}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Z of K){const ee=W.getOwnLayer(Z.layerId);ee&&!cc.has(ee.type)&&S(ee,W.getOwnLayerSourceCache(ee),M,Z)}}else if("layerId"in M.target){const{layerId:D}=M.target,j=this.getLayer(D);if(!j||cc.has(j.type))continue;S(j,this.getLayerSourceCache(j),M)}const P=this._queryRenderedFeatures(s,w,g);return this._flattenAndSortRenderedFeatures(P)}_queryRenderedFeatures(s,h,g){const w=[],S=!!this.map._showQueryGeometry,P=vo.createFromScreenPoints(s,g);for(const M in h){const D=co(P,h[M],this._availableImages,g,S);Object.keys(D).length&&w.push(D)}if(this.placement)for(const M in h){if(!h[M].sourceCache._onlySymbols)continue;const D=mu(P.screenGeometry,h[M],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(D).length&&w.push(D)}return w}querySourceFeatures(s,h){const g=h&&h.filter;g&&this._validate(me,"querySourceFeatures.filter",g,null,h);let w=[];const S=this.getOwnSourceCaches(s);for(const P of S)w=w.concat(gh(P,h));return w}addSourceType(s,h,g){return Uo.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Uo.setSourceType(s,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:h.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,h,g={}){this._checkLoaded();const w=this.light.getLight();let S=!1;for(const M in s)if(!i.bv(s[M],w[M])){S=!0;break}if(!S)return;const P=this._getTransitionParameters();this.light.setLight(s,h,g),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,h=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),h===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s;const w=s.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const M="terrain-dem-src";this.addSource(M,g.source),g=i.d7(g),g=i.l(g,{source:M})}const S=i.l({},g),P={};if(this.terrain&&w){S.source=this.terrain.get().source;const M=this.terrain?this.getFragmentStyle(this.terrain.scope):null;M&&(P.style=M.serialize())}if(this._validate(Tt,"terrain",S,P))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&h!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,h),this.fire(new i.A("data",{dataType:"style"}))}else{const S=this.terrain,P=S.get();for(const M of Object.keys(i.a5.terrain))!g.hasOwnProperty(M)&&i.a5.terrain[M].default&&(g[M]=i.a5.terrain[M].default);for(const M in s)if(!i.bv(s[M],P[M])){S.set(s,this.options),this.stylesheet.terrain=s;const D=this._getTransitionParameters({duration:0});S.updateTransitions(D),this.fire(new i.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const h=this.fog=new pr(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_createSnow(s){const h=this.snow=new hi(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_createRain(s){const h=this.rain=new mi(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.fog=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const h=this.snow;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.snow=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const h=this.rain;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.rain=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()},h=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!h)return this._styleColorTheme.lut=null,void s();const g=this._evaluateColorThemeData(h);this._loadColorTheme(g).then(()=>{this.fire(new i.A("colorthemeset")),s()}).catch(w=>{i.w(`Couldn't set color theme: ${w}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,h){const g=this.getFragmentStyle(s);g&&(g._styleColorTheme.colorThemeOverride=h,g._reloadColorTheme())}_getTransitionParameters(s){return{now:i.q.now(),transition:i.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],h=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?s.push(g):h.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...h)}_createTerrain(s,h){const g=this.terrain=new St(s,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});g.updateTransitions(w)}_force3DLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="symbol"&&this._updateLayer(h)}}_validate(s,h,g,w,S={}){if(S&&S.validate===!1)return!1;const P=i.l({},this.serialize());return ul(this,s.call(pa,i.l({key:h,style:P,value:g,styleSpec:i.a5},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.dg.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(s){const h=this.getSourceCaches(s);for(const g of h)g.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const h=this.getSourceCaches(s);for(const g of h)g.resume(),g.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let h;this.directionalLight&&(h=Sh(this.directionalLight));const g=new Set;for(const w in this._mergedLayers){const S=this._mergedLayers[w];S.hasElevation()&&!g.has(S.source)&&g.add(S.source)}for(const w in this._mergedSourceCaches){const S=this._mergedSourceCaches[w],P=g.has(S._source.id);S.update(s,void 0,void 0,h,P)}}_generateCollisionBoxes(){for(const s in this._sourceCaches){const h=this._sourceCaches[s];h.resume(),h.reload()}}_updatePlacement(s,h,g,w,S,P,M=!1){let D=!1,j=!1;const W={},K={};for(const Z of this._mergedOrder){const ee=this._mergedLayers[Z];if(ee.type!=="symbol")continue;const se=i.C(ee.source,ee.scope);let oe=W[se];if(!oe){const le=this.getLayerSourceCache(ee);if(!le)continue;const xe=le.getRenderableIds(!0).map(Te=>le.getTileByID(Te));K[se]=xe.slice(),oe=W[se]=xe.sort((Te,Pe)=>Pe.tileID.overscaledZ-Te.tileID.overscaledZ||(Te.tileID.isLessThan(Pe.tileID)?-1:1))}const he=this.crossTileSymbolIndex.addLayer(ee,oe,h.center.lng,h.projection);D=D||he}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),M=M||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new i.A("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),h.zoom))&&(this.pauseablePlacement=new Oa(h,this._mergedOrder,M,g,w,S,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,W,K,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),j=!0),D&&this.pauseablePlacement.placement.setStale()),j||D){this._buildingIndex.onNewFrame(h.zoom);for(let Z=0;Z<this._mergedOrder.length;Z++){const ee=this._mergedLayers[this._mergedOrder[Z]];if(ee.type!=="symbol")continue;const se=this.isLayerClipped(ee);this.placement.updateLayerOpacities(ee,W[i.C(ee.source,ee.scope)],Z,se?P:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,h){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:S})=>S===s.id)!==-1)return void this.fire(new i.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!h)return g.push(s),this._loadImports([s],!0);const w=g.findIndex(({id:S})=>S===h);return w===-1&&this.fire(new i.z(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,w).concat(s).concat(g.slice(w)),this._loadImports([s],!0,h)}updateImport(s,h){this._checkLoaded();const g=this.stylesheet.imports||[],w=this.getImportIndex(s);return w===-1?this:typeof h=="string"?(this.setImportUrl(s,h),this):(h.url&&h.url!==g[w].url&&this.setImportUrl(s,h.url),i.bv(h.config,g[w].config)||this.setImportConfig(s,h.config,h.data.schema),i.bv(h.data,g[w].data)||this.setImportData(s,h.data),this)}moveImport(s,h){this._checkLoaded();let g=this.stylesheet.imports||[];const w=this.getImportIndex(s);if(w===-1)return this;const S=this.getImportIndex(h);if(S===-1)return this;const P=g[w],M=this.fragments[w];return g=g.filter(({id:D})=>D!==s),this.fragments=this.fragments.filter(({id:D})=>D!==s),this.stylesheet.imports=g.slice(0,S).concat(P).concat(g.slice(S)),this.fragments=this.fragments.slice(0,S).concat(M).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(s,h){this._checkLoaded();const g=this.stylesheet.imports||[],w=this.getImportIndex(s);if(w===-1)return this;g[w].url=h;const S=this.fragments[w];return S.style=this._createFragmentStyle(g[w]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(h),this}setImportData(s,h){this._checkLoaded();const g=this.getImportIndex(s),w=this.stylesheet.imports||[];return g===-1?this:h?(this.fragments[g].style.setState(h),this._reloadImports(),this):(delete w[g].data,this.setImportUrl(s,w[g].url))}setImportConfig(s,h,g){this._checkLoaded();const w=this.getImportIndex(s),S=this.stylesheet.imports||[];if(w===-1)return this;h?S[w].config=h:delete S[w].config;const P=this.fragments[w];g&&P.style.stylesheet&&(P.style.stylesheet.schema=g);const M=P.style.stylesheet&&P.style.stylesheet.schema;return P.config=h,P.style.updateConfig(h,M),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const h=this.stylesheet.imports||[],g=this.getImportIndex(s);g!==-1&&(h.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){const h=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return h===-1&&this.fire(new i.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),h}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const h in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[h];g&&s.push(g.getSource())}return s}getSource(s,h){const g=this.getSourceCache(s,h);return g&&g.getSource()}getLayerSource(s){const h=this.getLayerSourceCache(s);return h&&h.getSource()}getSourceCache(s,h){const g=i.C(s,h);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){const h=i.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const h=[];return this._mergedOtherSourceCaches[s]&&h.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&h.push(this._mergedSymbolSourceCaches[s]),h}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const h in s){const g=s[h];g==="reload"?this.reloadSource(h):g==="clear"&&this.clearSource(h)}}updateLayers(s){const h=this._changes.getUpdatedPaintProperties();for(const g of h){const w=this.getLayer(g);w&&w.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,h,g){this.imageManager.getImages(h.images,h.scope,g),this._updateTilesForChangedImages();const w=P=>{if(P){const M=h.images.map(D=>i.I.toString(D));P.setDependencies(h.tileID.key,h.type,M)}},S=i.C(h.source,h.scope);w(this._mergedOtherSourceCaches[S]),w(this._mergedSymbolSourceCaches[S])}rasterizeImages(s,h,g){this.imageManager.rasterizeImages(h,g)}getGlyphs(s,h,g){this.glyphManager.getGlyphs(h.stacks,h.scope,g)}getResource(s,h,g){return i.dh(h,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const h=[];return this._otherSourceCaches[s]&&h.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&h.push(this._symbolSourceCaches[s]),h}_isSourceCacheLoaded(s){const h=this.getOwnSourceCaches(s);return h.length===0?(this.fire(new i.z(new Error(`There is no source with ID '${s}'`))),!1):h.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,h){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const g=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(g||h&&h.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Uo.getSourceType=function(m){return Ml[m]},Uo.setSourceType=function(m,s){Ml[m]=s},Uo.registerForPluginStateChange=i.c$;var uc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Eh=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Ah=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Rf="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ms=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Df=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Kt=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,jm=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,hc=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,bd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Lf=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Pu=[];pc(uc,Pu),pc(Ah,Pu),pc(Eh,Pu);const Ko={"_prelude_fog.vertex.glsl":Df,"_prelude_terrain.vertex.glsl":ms,"_prelude_shadow.vertex.glsl":bd,"_prelude_fog.fragment.glsl":Kt,"_prelude_shadow.fragment.glsl":Lf,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":jm,"_prelude_raster_particle.glsl":hc},Cu={};xr("",ms),xr(Kt,Df),xr(Lf,bd),xr(jm,""),xr(hc,"");const dc=xr(Eh,Ah),fc=uc;var Iu={background:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);color*=u_opacity;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=vec4(linearTosRGB(color.rgb),color.a);
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:xr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:xr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:xr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:xr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:xr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:xr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:xr(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:xr(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:xr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:xr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:xr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:xr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:xr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:xr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:xr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:xr(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(abs(v_z_offset) > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:xr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:xr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Rf),skyboxGradient:xr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Rf),skyboxCapture:xr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:xr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:xr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:xr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:xr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:xr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:xr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:xr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:xr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function pc(m,s){const h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of h)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=g.split(" ");for(const S of w)s.includes(S)||s.push(S)}}function xr(m,s){const h=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(j=>{const W=j.split(" ");return W[W.length-1]}),w=[...new Set(w)]);const S={},P=[],M=[];if(m=m.replace(h,(j,W)=>(M.push(W),"")),(s=s.replace(h,(j,W)=>(P.push(W),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let D=[...Pu];pc(m,D),pc(s,D);for(const j of[...P,...M])Ko[j]||console.error(`Undefined include: ${j}`),Cu[j]||(Cu[j]=[],pc(Ko[j],Cu[j])),D=[...D,...Cu[j]];return{fragmentSource:m=m.replace(g,(j,W,K,Z,ee)=>(S[ee]=!0,W==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
in ${K} ${Z} ${ee};
#else
uniform ${K} ${Z} u_${ee};
#endif
`:W==="initialize"?`
#ifdef HAS_UNIFORM_u_${ee}
    ${K} ${Z} ${ee} = u_${ee};
#endif
`:W==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${K} ${Z} ${ee};
#endif
`:W==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(g,(j,W,K,Z,ee)=>{const se=Z==="float"?"vec2":Z,oe=ee.match(/color/)?"color":se;return W==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
in ${K} ${Z} a_${ee};
#endif
`:S[ee]?W==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${K} ${se} a_${ee};
out ${K} ${Z} ${ee};
#else
uniform ${K} ${Z} u_${ee};
#endif
`:W==="initialize"?oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${K} ${Z} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${oe}(a_${ee}, u_${ee}_t);
#else
    ${K} ${Z} ${ee} = u_${ee};
#endif
`:W==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${K} ${Z} a_${ee};
    out ${K} ${Z} ${ee};
#endif
`:W==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${ee} = a_${ee};
#endif
`:void 0:W==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${K} ${se} a_${ee};
#else
uniform ${K} ${Z} u_${ee};
#endif
`:W==="define-instanced"?oe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ee}0;
in vec4 a_${ee}1;
in vec4 a_${ee}2;
in vec4 a_${ee}3;
#else
uniform ${K} ${Z} u_${ee};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${K} ${se} a_${ee};
#else
uniform ${K} ${Z} u_${ee};
#endif
`:W==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${K} ${Z} ${ee} = a_${ee};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${K} ${Z} ${ee} = a_${ee};
#else
    ${K} ${Z} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${K} ${Z} ${ee} = unpack_mix_${oe}(a_${ee}, u_${ee}_t);
#else
    ${K} ${Z} ${ee} = u_${ee};
#endif
`}),staticAttributes:w,usedDefines:D,vertexIncludes:P,fragmentIncludes:M}}class zf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,h,g,w,S,P,M,D){this.context=s;let j=this.boundPaintVertexBuffers.length!==w.length;for(let K=0;!j&&K<w.length;K++)this.boundPaintVertexBuffers[K]!==w[K]&&(j=!0);let W=this.boundDynamicVertexBuffers.length!==M.length;for(let K=0;!W&&K<M.length;K++)this.boundDynamicVertexBuffers[K]!==M[K]&&(W=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||j||W||this.boundIndexBuffer!==S||this.boundVertexOffset!==P)this.freshBind(h,g,w,S,P,M,D);else{s.bindVertexArrayOES.set(this.vao);for(const K of M)K&&(K.bind(),D&&K.instanceCount&&K.setVertexAttribDivisor(s.gl,h,D));S&&S.dynamicDraw&&S.bind()}}freshBind(s,h,g,w,S,P,M){const D=s.numAttributes,j=this.context,W=j.gl;this.vao&&this.destroy(),this.vao=j.gl.createVertexArray(),j.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=P,h.enableAttributes(W,s),h.bind(),h.setVertexAttribPointers(W,s,S);for(const K of g)K.enableAttributes(W,s),K.bind(),K.setVertexAttribPointers(W,s,S);for(const K of P)K&&(K.enableAttributes(W,s),K.bind(),K.setVertexAttribPointers(W,s,S),M&&K.instanceCount&&K.setVertexAttribDivisor(W,s,M));w&&w.bind(),j.currentNumAttributes=D}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function F_(m,s){const h=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new i.ac(0,g/h).toLngLat().lat,new i.ac(0,(g+1)/h).toLngLat().lat]}function B_(m,s,h,g,w,S,P){const M=m.context,D=M.gl,j=h.hillshadeFBO;if(!j)return;m.prepareDrawTile();const W=m.isTileAffectedByFog(s),K=m.getOrCreateProgram("hillshade",{overrideFog:W});M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,j.colorAttachment.get());const Z=((he,le,xe,Te)=>{const Pe=xe.paint.get("hillshade-shadow-color"),ze=xe.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",ke=xe.paint.get("hillshade-highlight-color"),Re=xe.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ie=xe.paint.get("hillshade-accent-color"),Ve=xe.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ge=xe.paint.get("hillshade-emissive-strength");let ht=i.al(xe.paint.get("hillshade-illumination-direction"));if(xe.paint.get("hillshade-illumination-anchor")==="viewport")ht-=he.transform.angle;else if(he.style&&he.style.enable3dLights()&&he.style.directionalLight){const Et=he.style.directionalLight.properties.get("direction"),wt=i.cR(Et.x,Et.y,Et.z);ht=i.al(wt[1])}const et=!he.options.moving;return{u_matrix:Te||he.transform.calculateProjMatrix(le.tileID.toUnwrapped(),et),u_image:0,u_latrange:F_(0,le.tileID),u_light:[xe.paint.get("hillshade-exaggeration"),ht],u_shadow:Pe.toRenderColor(ze?null:xe.lut),u_highlight:ke.toRenderColor(Re?null:xe.lut),u_emissive_strength:Ge,u_accent:Ie.toRenderColor(Ve?null:xe.lut)}})(m,h,g,m.terrain?s.projMatrix:null);m.uploadCommonUniforms(M,K,s.toUnwrapped());const{tileBoundsBuffer:ee,tileBoundsIndexBuffer:se,tileBoundsSegments:oe}=m.getTileBoundsBuffers(h);K.draw(m,D.TRIANGLES,w,S,P,Fn.disabled,Z,g.id,ee,se,oe)}function Nf(m,s,h){if(!s.needsDEMTextureUpload)return;const g=m.context,w=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(h.stride);const S=h.getPixels();s.demTexture?s.demTexture.update(S,{premultiply:!1}):s.demTexture=new i.T(g,S,w.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function Ff(m,s,h){const g=m.context,w=g.gl;if(!s.dem)return;const S=s.dem;if(g.activeTexture.set(w.TEXTURE1),Nf(m,s,S),!s.demTexture)return;s.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const P=S.dim;g.activeTexture.set(w.TEXTURE0);let M=s.hillshadeFBO;if(!M){const Z=new i.T(g,{width:P,height:P,data:null},w.RGBA8);Z.bind(w.LINEAR,w.CLAMP_TO_EDGE),M=s.hillshadeFBO=g.createFramebuffer(P,P,!0,"renderbuffer"),M.colorAttachment.set(Z.texture)}g.bindFramebuffer.set(M.framebuffer),g.viewport.set([0,0,P,P]);const{tileBoundsBuffer:D,tileBoundsIndexBuffer:j,tileBoundsSegments:W}=m.getMercatorTileBoundsBuffers(),K=[];m.linearFloatFilteringSupported()&&K.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:K}).draw(m,w.TRIANGLES,nn.disabled,Un.disabled,ar.unblended,Fn.disabled,((Z,ee)=>{const se=ee.stride,oe=i.bz();return i.c5(oe,0,i.aj,-i.aj,0,0,1),i.bo(oe,oe,[0,-i.aj,0]),{u_matrix:oe,u_image:1,u_dimension:[se,se],u_zoom:Z.overscaledZ}})(s.tileID,S),h.id,D,j,W),s.needsHillshadePrepare=!1}class Fi{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class j_ extends Fi{getDefault(){return i.am.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class $_ extends Fi{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class fx extends Fi{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class $m extends Fi{getDefault(){return[!0,!0,!0,!0]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class U_ extends Fi{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Bf extends Fi{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class x extends Fi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const h=this.current;(s.func!==h.func||s.ref!==h.ref||s.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class I extends Fi{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class U extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=s,this.dirty=!1}}class ne extends Fi{getDefault(){return[0,1]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class pe extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=s,this.dirty=!1}}class Oe extends Fi{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class lt extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.BLEND):h.disable(h.BLEND),this.current=s,this.dirty=!1}}class Rt extends Fi{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ht extends Fi{getDefault(){return i.am.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class bn extends Fi{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Yn extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=s,this.dirty=!1}}class Ir extends Fi{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Yr extends Fi{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let va=class extends Fi{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Yo extends Fi{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Ds extends Fi{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ga extends Fi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class mc extends Fi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class wd extends Fi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class V_ extends Fi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class W_ extends Fi{getDefault(){return null}set(s){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Um extends Fi{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class Ph extends Fi{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Vm extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Jo extends Fi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Ch extends Fi{constructor(s,h){super(s),this.context=s,this.parent=h}getDefault(){return null}}class px extends Ch{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class jf extends Ch{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Wm extends Ch{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Sd extends jf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const $f=(m,s,h)=>({u_matrix:m,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:h}),Gm=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:h,u_zoom_transition:w,u_merc_center:S,u_image0:0,u_frustum_tl:P,u_frustum_tr:M,u_frustum_br:D,u_frustum_bl:j,u_globe_pos:W,u_globe_radius:K,u_viewport:Z,u_grid_matrix:oe?Float32Array.from(oe):new Float32Array(9),u_skirt_height:ee,u_far_z_cutoff:se});function mx(m,s){return m!=null&&s!=null&&!(!m.hasData()||!s.hasData())&&m.demTexture!=null&&s.demTexture!=null&&m.tileID.key!==s.tileID.key}const Uf=new class{constructor(){this.operations={}}newMorphing(m,s,h,g,w){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==h.tileID.key&&(S.queued=h)}else this.operations[m]={startTime:g,phase:0,duration:w,from:s,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const s=this.operations[m];return{from:s.from,to:s.to,phase:s.phase}}update(m){for(const s in this.operations){const h=this.operations[s];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[s];break}}}_nextOp(m,s){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=s,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Vf={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Wf(m,s,h){if(s===0)return 0;const g=s<1&&h===514?.25/s:1;return 6*Math.pow(1.5,22-m)*Math.max(s,1)*g}function qS(m,s){const h=1<<m.z;return!s&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}const Ls=m=>({u_matrix:m});function Hm(m,s,h,g,w){if(w>0){const S=i.q.now(),P=(S-m.timeAdded)/w,M=s?(S-s.timeAdded)/w:-1,D=h.getSource(),j=g.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),W=!s||Math.abs(s.tileID.overscaledZ-j)>Math.abs(m.tileID.overscaledZ-j),K=W&&m.refreshedUponExpiration?1:i.aD(W?P:1-M,0,1);return m.refreshedUponExpiration&&P>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class G_ extends _a{constructor(s){const h={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new i.D(i.d0(),null),w=rl("mock-dem",h,g,s.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,h){s.state="loaded",h(null)}}class H_ extends _a{constructor(s){const h=rl("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new i.D(i.d0(),null),s.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,h,g){if(s.freezeTileCoverage)return;this.transform=s;const w=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,P)=>{if(S[P.key]="",!this._tiles[P.key]){const M=new il(P,this._source.tileSize*P.overscaleFactor(),s.tileZoom);M.state="loaded",this._tiles[P.key]=M}return S},{});for(const S in this._tiles)S in w||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(s){const h=this.proxyCachedFBO[s];if(h!==void 0){const g=Object.values(h);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class q_ extends i.aM{constructor(s,h,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=h,this.projMatrix=g}}class Z_ extends i.dt{constructor(s,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,w,S]=function(D){const j=new i.ba,W=new i.a_,K=131;j.reserve(17161),W.reserve(33800);const Z=i.aj/128,ee=i.aj+Z/2,se=ee+Z;for(let he=-Z;he<se;he+=Z)for(let le=-Z;le<se;le+=Z){const xe=le<0||le>ee||he<0||he>ee?24575:0,Te=i.aD(Math.round(le),0,i.aj),Pe=i.aD(Math.round(he),0,i.aj);j.emplaceBack(Te+xe,Pe)}const oe=(he,le)=>{const xe=le*K+he;W.emplaceBack(xe+1,xe,xe+K),W.emplaceBack(xe+K,xe+K+1,xe+1)};for(let he=1;he<129;he++)for(let le=1;le<129;le++)oe(le,he);return[0,129].forEach(he=>{for(let le=0;le<130;le++)oe(le,he),oe(he,le)}),[j,W,32768]}(),P=s.context;this.gridBuffer=P.createVertexBuffer(g,i.bc.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=i.bd.simpleSegment(0,0,g.length,w.length),this.gridNoSkirtSegments=i.bd.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new H_(h.map),this.orthoMatrix=i.bz(),i.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.aj,0,i.aj,0,1);const M=P.gl;this._overlapStencilMode=new Un({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new G_(h.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,h,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const w=s.terrain.properties,S=s.terrain.drapeRenderMode===0,P=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const M=s.terrain&&s.terrain.scope,D=w.get("source"),j=S?this._mockSourceCache:s.getSourceCache(D,M);if(!j)return void i.w(`Couldn't find terrain source "${D}".`);if(this.sourceCache=j,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=P?this.calculateExaggeration(h):w.get("exaggeration"),!h.projection.requiresDraping&&P&&this._exaggeration===0)return void this._disable();this.enabled=!0;const W=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const K=this.getScaledDemTileSize();this.sourceCache.update(h,K,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,W(),this._initializing=!0),W(),h.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const h=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;const w=h!=null?g-h:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const S=s.zoom,P=this._style.terrain;if(!this._previousUpdateTimestamp)return P.getExaggeration(S);let M=S-this._previousZoom;const D=this._previousUpdateTimestamp;let j=S;this._evaluationZoom!=null&&(j=this._evaluationZoom,Math.abs(S-j)>.5&&(M=.5*(S-j+M)),M*w<0&&(j+=M)),this._evaluationZoom=j;const W=P.getExaggeration(j),K=W===P.getExaggeration(Math.max(0,j-.1));if(K&&Math.abs(W-this._exaggeration)<.01)return W;let Z=Math.min(.1,.00375*(this._updateTimestamp-D));return(K||W<.1||Math.abs(M)<1e-4)&&(Z=Math.min(.2,4*Z)),i.ai(this._exaggeration,W,Z)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(i.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=h.getIds().map(D=>{const j=h.getTileByID(D).tileID;return j.projMatrix=g.calculateProjMatrix(j.toUnwrapped()),j});(function(D,j){const W=j.transform.pointCoordinate(j.transform.getCameraPoint()),K=new i.P(W.x,W.y);D.sort((Z,ee)=>{if(ee.overscaledZ-Z.overscaledZ)return ee.overscaledZ-Z.overscaledZ;const se=new i.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),oe=new i.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),he=K.mult(1<<Z.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(se)-he.distSqr(oe)})})(w,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},w.forEach(D=>{this.proxyToSource[D.key]={}}),this.terrainTileForTile={};const P=this._style._mergedSourceCaches;for(const D in P){const j=P[D];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,s[D],S),j.usedForTerrain))continue;const W=s[D];j.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[h.id]=w.map(D=>new q_(D,D.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const M={};this._visibleDemTiles=[];for(const D of this.proxyCoords){const j=this.terrainTileForTile[D.key];if(!j)continue;const W=j.tileID.key;W in M||(this._visibleDemTiles.push(j),M[W]=W)}}_assignTerrainTiles(s){this._initializing||s.forEach(h=>{if(this.terrainTileForTile[h.key])return;const g=this._findTileCoveringTileID(h,this.sourceCache);g&&(this.terrainTileForTile[h.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,h=s.gl;for(const g in this.terrainTileForTile){const w=this.terrainTileForTile[g],S=w.dem;!S||w.demTexture&&!w.needsDEMTextureUpload||(s.activeTexture.set(h.TEXTURE1),Nf(this.painter,w,S))}}_prepareDemTileUniforms(s,h,g,w){if(!h||h.demTexture==null)return!1;const S=s.tileID.canonical,P=Math.pow(2,h.tileID.canonical.z-S.z),M=w||"";return g[`u_dem_tl${M}`]=[S.x*P%1,S.y*P%1],g[`u_dem_scale${M}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const h=this._visibleDemTiles.reduce((g,w)=>{if(!w.dem)return g;const S=w.dem.tree.minimums[0];return S>0&&s++,g+S},0);return s?h/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,h=s.gl;s.activeTexture.set(h.TEXTURE2);const g=this._getLoadedAreaMinimum(),w=new i.du({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(w,{premultiply:!1}):S=this._emptyDEMTexture=new i.T(s,w,h.R32F,{premultiply:!1}),S}setupElevationDraw(s,h,g){const w=this.painter.context,S=w.gl,P={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};P.u_exaggeration=this.exaggeration();let M=null,D=null,j=1;if(g&&g.morphing&&this._useVertexMorphing){const ee=g.morphing.srcDemTile,se=g.morphing.dstDemTile;j=g.morphing.phase,ee&&se&&(this._prepareDemTileUniforms(s,ee,P,"_prev")&&(D=ee),this._prepareDemTileUniforms(s,se,P)&&(M=se))}const W=ee=>ee&&ee.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let K=null;var Z;if(this.enabled?D&&M?(K=M.demTexture,w.activeTexture.set(S.TEXTURE4),D.demTexture.bind(W(D),S.CLAMP_TO_EDGE),P.u_dem_lerp=j):(M=this.terrainTileForTile[s.tileID.key],K=this._prepareDemTileUniforms(s,M,P)?M.demTexture:this.emptyDEMTexture):K=this.emptyDEMTexture,w.activeTexture.set(S.TEXTURE2),K&&(P.u_dem_size=(Z=K).size[0]===1?1:Z.size[0]-2,K.bind(W(M),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,h,P),g&&g.useMeterToDem&&M){const ee=(1<<M.tileID.canonical.z)*i.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=ee}if(g&&g.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),h.setTerrainUniformValues(w,P),this.painter.transform.projection.name==="globe"){const ee=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);h.setGlobeUniformValues(w,ee)}}globeUniformValues(s,h,g){const w=s.projection;return{u_tile_tl_up:w.upVector(h,0,0),u_tile_tr_up:w.upVector(h,i.aj,0),u_tile_br_up:w.upVector(h,i.aj,i.aj),u_tile_bl_up:w.upVector(h,0,i.aj),u_tile_up_scale:g?i.dv(1):w.upVectorScale(h,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const h=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,S,P,M,D){if(w.transform.projection.name==="globe")(function(j,W,K,Z,ee){const se=j.context,oe=se.gl;let he,le;const xe=j.transform,Te=i.dl(j,se,xe),Pe=(Et,wt)=>{if(le===wt)return;const qt=[Vf[wt],"PROJECTION_GLOBE_VIEW"];Te&&qt.push("CUSTOM_ANTIALIASING");const tt=j.isTileAffectedByFog(Et);he=j.getOrCreateProgram("globeRaster",{defines:qt,overrideFog:tt}),le=wt},ze=j.colorModeForRenderPass(),ke=new nn(oe.LEQUAL,nn.ReadWrite,j.depthRangeFor3D);Uf.update(ee);const Re=i.dm(xe),Ie=[i.ay(xe.center.lng),i.aH(xe.center.lat)],Ve=j.globeSharedBuffers,Ge=[xe.width*i.q.devicePixelRatio,xe.height*i.q.devicePixelRatio],ht=Float32Array.from(xe.globeMatrix),et={useDenormalizedUpVectorScale:!0};{const Et=j.transform,wt=Wf(Et.zoom,W.exaggeration(),W.sourceCache._source.tileSize);le=-1;const qt=oe.TRIANGLES;for(const tt of Z){const dt=K.getTile(tt),Je=Un.disabled,It=W.prevTerrainTileForTile[tt.key],gt=W.terrainTileForTile[tt.key];mx(It,gt)&&Uf.newMorphing(tt.key,It,gt,ee,250),se.activeTexture.set(oe.TEXTURE0),dt.texture&&dt.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Lt=Uf.getMorphValuesForProxy(tt.key),At=Lt?1:0;Lt&&i.L(et,{morphing:{srcDemTile:Lt.from,dstDemTile:Lt.to,phase:i.dk(Lt.phase)}});const zt=i.dn(tt.canonical),Ft=i.dp(zt.getCenter().lat),gn=i.dq(tt.canonical,zt,Ft,Et.worldSize/Et._pixelsPerMercatorPixel),En=i.bh(i.dr(tt.canonical)),fn=Gm(Et.expandedFarZProjMatrix,ht,Re,En,i.ah(Et.zoom),Ie,Et.frustumCorners.TL,Et.frustumCorners.TR,Et.frustumCorners.BR,Et.frustumCorners.BL,Et.globeCenterInViewSpace,Et.globeRadius,Ge,wt,Et._farZ,gn);if(Pe(tt,At),he&&(W.setupElevationDraw(dt,he,et),j.uploadCommonUniforms(se,he,tt.toUnwrapped()),Ve)){const[Pn,yn,Nn]=Ve.getGridBuffers(Ft,wt!==0);he.draw(j,qt,ke,Je,ze,Fn.backCCW,fn,"globe_raster",Pn,yn,Nn)}}}if(Ve&&(j.renderDefaultNorthPole||j.renderDefaultSouthPole)){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Te&&Et.push("CUSTOM_ANTIALIASING"),he=j.getOrCreateProgram("globeRaster",{defines:Et});for(const wt of Z){const{x:qt,y:tt,z:dt}=wt.canonical,Je=tt===0,It=tt===(1<<dt)-1,[gt,Lt,At,zt]=Ve.getPoleBuffers(dt,!1);if(zt&&(Je||It)){const Ft=K.getTile(wt);se.activeTexture.set(oe.TEXTURE0),Ft.texture&&Ft.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);let gn=i.ds(dt,qt,xe);const En=i.bh(i.dr(wt.canonical)),fn=(Pn,yn)=>Pn.draw(j,oe.TRIANGLES,ke,Un.disabled,ze,Fn.disabled,Gm(xe.expandedFarZProjMatrix,gn,gn,En,0,Ie,xe.frustumCorners.TL,xe.frustumCorners.TR,xe.frustumCorners.BR,xe.frustumCorners.BL,xe.globeCenterInViewSpace,xe.globeRadius,Ge,0,xe._farZ),"globe_pole_raster",yn,At,zt);W.setupElevationDraw(Ft,he,et),j.uploadCommonUniforms(se,he,wt.toUnwrapped()),Je&&j.renderDefaultNorthPole&&fn(he,gt),It&&j.renderDefaultSouthPole&&(gn=i.cE(i.bz(),gn,[1,-1,1]),fn(he,Lt))}}}})(w,S,P,M,D);else{const j=w.context,W=j.gl;let K,Z;const ee=w.shadowRenderer,se=Eu(w,w.longestCutoffRange),oe=ze=>{if(Z===ze)return;const ke=[];ke.push(Vf[ze]),se.shouldRenderCutoff&&ke.push("RENDER_CUTOFF"),ee&&(ke.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&ke.push("NORMAL_OFFSET")),K=w.getOrCreateProgram("terrainRaster",{defines:ke}),Z=ze},he=w.colorModeForRenderPass(),le=new nn(W.LEQUAL,nn.ReadWrite,w.depthRangeFor3D);Uf.update(D);const xe=w.transform,Te=Wf(xe.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let Pe=[0,0,0];if(ee){const ze=w.style.directionalLight,ke=w.style.ambientLight;ze&&ke&&(Pe=ll(w.style,ze,ke))}{Z=-1;const ze=W.TRIANGLES,[ke,Re]=[S.gridIndexBuffer,S.gridSegments];for(const Ie of M){const Ve=P.getTile(Ie),Ge=Un.disabled,ht=S.prevTerrainTileForTile[Ie.key],et=S.terrainTileForTile[Ie.key];mx(ht,et)&&Uf.newMorphing(Ie.key,ht,et,D,250),j.activeTexture.set(W.TEXTURE0),Ve.texture&&Ve.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Et=Uf.getMorphValuesForProxy(Ie.key),wt=Et?1:0;let qt;Et&&(qt={morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:i.dk(Et.phase)}});const tt=$f(Ie.projMatrix,qS(Ie.canonical,xe.renderWorldCopies)?Te/10:Te,Pe);if(oe(wt),!K)continue;S.setupElevationDraw(Ve,K,qt);const dt=Ie.toUnwrapped();ee&&ee.setupShadows(dt,K),w.uploadCommonUniforms(j,K,dt,null,se),K.draw(w,ze,le,Ge,he,Fn.backCCW,tt,"terrain_raster",S.gridBuffer,ke,Re)}}}}(h,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const h=this.painter,g=this.painter.context,w=this.proxySourceCache,S=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),M=h.style.order,D=[];let j=0;for(const W of S){const K=w.getTileByID(W.proxyTileKey),Z=w.proxyCachedFBO[W.key]?w.proxyCachedFBO[W.key][s]:void 0,ee=Z!==void 0?w.renderCache[Z]:this.pool[j++],se=Z!==void 0;if(K.texture=ee.tex,se&&!ee.dirty){D.push(K.tileID);continue}let oe;g.bindFramebuffer.set(ee.fb.framebuffer),this.renderedToTile=!1,ee.dirty&&(g.clear({color:i.am.transparent,stencil:0}),ee.dirty=!1);for(let he=P.start;he<=P.end;++he){const le=h.style._mergedLayers[M[he]];if(le.isHidden(h.transform.zoom))continue;const xe=h.style.getLayerSourceCache(le),Te=xe?this.proxyToSource[W.key][xe.id]:[W];if(!Te)continue;const Pe=Te;g.viewport.set([0,0,ee.fb.width,ee.fb.height]),oe!==(xe?xe.id:null)&&(this._setupStencil(ee,Te,le,xe),oe=xe?xe.id:null),h.renderLayer(h,xe,le,Pe)}if(this._drapedRenderBatches.length===0)for(const he of this._pendingGroundEffectLayers){const le=h.style._mergedLayers[M[he]];if(le.isHidden(h.transform.zoom))continue;const xe=h.style.getLayerSourceCache(le),Te=xe?this.proxyToSource[W.key][xe.id]:[W];if(!Te)continue;const Pe=Te;g.viewport.set([0,0,ee.fb.width,ee.fb.height]),oe!==(xe?xe.id:null)&&(this._setupStencil(ee,Te,le,xe),oe=xe?xe.id:null),h.renderLayer(h,xe,le,Pe)}this.renderedToTile?(ee.dirty=!0,D.push(K.tileID)):se||--j,j===5&&(j=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),P.end+1}postRender(){}isLayerOrderingCorrect(s){const h=s.order.length;let g=-1,w=h;for(let S=0;S<h;++S)this._style.isLayerDraped(s._mergedLayers[s.order[S]])?g=Math.max(g,S):w=Math.min(w,S);return w>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{s=Math.min(s,h.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,h,g){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const P=S.tileID,M=1<<P.overscaledZ,{x:D,y:j}=P.canonical,W=D/M,K=(D+1)/M,Z=j/M,ee=(j+1)/M;return{minx:W,miny:Z,maxx:K,maxy:ee,t:S.dem.tree.raycastRoot(W,Z,K,ee,s,h,g),tile:S}});w.sort((S,P)=>(S.t!==null?S.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const S of w){if(S.t==null)return null;const P=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,s,h,g);if(P!=null)return P}return null}_createFBO(){const s=this.painter.context,h=s.gl,g=this.drapeBufferSize;s.activeTexture.set(h.TEXTURE0);const w=new i.T(s,{width:g[0],height:g[1],data:null},h.RGBA8);w.bind(h.LINEAR,h.CLAMP_TO_EDGE);const S=s.createFramebuffer(g[0],g[1],!0,null);return S.colorAttachment.set(w.texture),S.depthAttachment=new Sd(s,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:S,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const h=this._style._mergedLayers[s],g=h.isHidden(this.painter.transform.zoom);return h.type==="hillshade"||h.type==="custom"?!g&&h.shouldRedrape():!g&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style.getSources())if(g instanceof kr){s=!0;break}if(!s)return;const h={};for(let g=0;g<this._style.order.length;++g){const w=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(w);if(S&&!h[S.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof i.ab){h[S.id]=!0;for(const P of this.proxyCoords){const M=this.proxyToSource[P.key][S.id];if(M)for(const D of M)this._clearRenderCacheForTile(S.id,D)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Gi){s=!0;break}if(!s)return;const h={};for(let g=0;g<this._style.order.length;++g){const w=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(w);if(!S||h[S.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const P=w.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const D=this.proxyToSource[M.key][S.id];if(D)for(const j of D){const W=Hm(S.getTile(j),S.findLoadedParent(j,0),S,this.painter.transform,P);(W.opacity!==1||W.mix!==0)&&this._clearRenderCacheForTile(S.id,j)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,h=s.length;if(h===0)return;const g=[];this._pendingGroundEffectLayers=[];let w,S=0,P=this._style._mergedLayers[s[S]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++S<h;)P=this._style._mergedLayers[s[S]];for(;S<h;++S){const M=this._style._mergedLayers[s[S]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?w===void 0&&(w=S):(M.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),w!==void 0&&(g.push({start:w,end:S-1}),w=void 0)))}if(w!==void 0&&g.push({start:w,end:S-1}),g.length!==0){const M=g[g.length-1];this._pendingGroundEffectLayers.every(D=>D>M.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const P=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let M=0;M<P.length;++M){const D=Object.values(P[M]);h.renderCachePool.push(...D)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,w=this._tilesDirty;for(let P=g.length-1;P>=0;P--){const M=g[P];if(h.getTileByID(M.key),h.proxyCachedFBO[M.key]!==void 0){const D=s[M.key],j=this.proxyToSource[M.key];let W=0;for(const K in j){const Z=j[K],ee=D[K];if(!ee||ee.length!==Z.length||Z.some((se,oe)=>se!==ee[oe]||w[K]&&w[K].hasOwnProperty(se.key))){W=-1;break}++W}for(const K in h.proxyCachedFBO[M.key])h.renderCache[h.proxyCachedFBO[M.key][K]].dirty=W<0||W!==Object.values(D).length}}const S=[...this._drapedRenderBatches];S.sort((P,M)=>M.end-M.start-(P.end-P.start));for(const P of S)for(const M of g){if(h.proxyCachedFBO[M.key])continue;let D=h.renderCachePool.pop();D===void 0&&h.renderCache.length<50&&(D=h.renderCache.length,h.renderCache.push(this._createFBO())),D!==void 0&&(h.proxyCachedFBO[M.key]={},h.proxyCachedFBO[M.key][P.start]=D,h.renderCache[D].dirty=!0)}this._tilesDirty={}}_setupStencil(s,h,g,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,P=S.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let M;if(g.isTileClipped())M=h.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Un.disabled}_renderTileClippingMasks(s,h){const g=this.painter,w=this.painter.context,S=w.gl;g._tileClippingMaskIDs={},w.setColorMode(ar.disabled),w.setDepthMode(nn.disabled);const P=g.getOrCreateProgram("clippingMask");for(const M of s){const D=g._tileClippingMaskIDs[M.key]=--h;P.draw(g,S.TRIANGLES,nn.disabled,new Un({func:S.ALWAYS,mask:0},D,255,S.KEEP,S.KEEP,S.REPLACE),ar.disabled,Fn.disabled,Ls(M.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const h=this.painter.transform;if(s.x<0||s.x>h.width||s.y<0||s.y>h.height)return null;const g=[s.x,s.y,1,1];i.aA(g,g,h.pixelMatrixInverse),i.cw(g,g,1/g[3]),g[0]/=h.worldSize,g[1]/=h.worldSize;const w=h._camera.position,S=i.c6(1,h.center.lat),P=[w[0],w[1],w[2]/S,0],M=i.cY([],g.slice(0,3),P);i.au(M,M);const D=this.raycast(P,M,this._exaggeration);return D!==null&&D?(i.bF(P,P,M,D),P[3]=P[2],P[2]*=S,P):null}_setupProxiedCoordsForOrtho(s,h,g){if(s.getSource()instanceof i.aP)return this._setupProxiedCoordsForImageSource(s,h,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const w=this.proxiedCoords[s.id]=[],S=this.proxyCoords;for(let D=0;D<S.length;D++){const j=S[D],W=this._findTileCoveringTileID(j,s);if(W){const K=this._createProxiedId(j,W,g[j.key]&&g[j.key][s.id]);w.push(K),this.proxyToSource[j.key][s.id]=[K]}}let P=!1;const M=new Set;for(let D=0;D<h.length;D++){const j=s.getTile(h[D]);if(!j||!j.hasData())continue;const W=this._findTileCoveringTileID(j.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==j.tileID.canonical.z){const K=this.proxyToSource[W.tileID.key][s.id],Z=this._createProxiedId(W.tileID,j,g[W.tileID.key]&&g[W.tileID.key][s.id]);K?K.splice(K.length-1,0,Z):this.proxyToSource[W.tileID.key][s.id]=[Z];const ee=this.proxyToSource[W.tileID.key][s.id];M.has(ee)||M.add(ee),w.push(Z),P=!0}}if(this._sourceTilesOverlap[s.id]=P,P&&this._debugParams.sortTilesHiZFirst)for(const D of M)D.sort((j,W)=>W.overscaledZ-j.overscaledZ)}_setupProxiedCoordsForImageSource(s,h,g){if(!s.getSource().loaded())return;const w=this.proxiedCoords[s.id]=[],S=this.proxyCoords,P=s.getSource(),M=P.tileID;if(!M)return;const D=new i.P(M.x,M.y)._div(1<<M.z),j=P.coordinates.map(i.ac.fromLngLat).reduce((K,Z)=>(K.min.x=Math.min(K.min.x,Z.x-D.x),K.min.y=Math.min(K.min.y,Z.y-D.y),K.max.x=Math.max(K.max.x,Z.x-D.x),K.max.y=Math.max(K.max.y,Z.y-D.y),K),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(K,Z)=>{const ee=K.wrap+K.canonical.x/(1<<K.canonical.z),se=K.canonical.y/(1<<K.canonical.z),oe=i.aj/(1<<K.canonical.z),he=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),le=Z.canonical.y/(1<<Z.canonical.z);return ee+oe<he+j.min.x||ee>he+j.max.x||se+oe<le+j.min.y||se>le+j.max.y};for(let K=0;K<S.length;K++){const Z=S[K];for(let ee=0;ee<h.length;ee++){const se=s.getTile(h[ee]);if(!se||!se.hasData()||W(Z,se.tileID))continue;const oe=this._createProxiedId(Z,se,g[Z.key]&&g[Z.key][s.id]),he=this.proxyToSource[Z.key][s.id];he?he.push(oe):this.proxyToSource[Z.key][s.id]=[oe],w.push(oe)}}}_createProxiedId(s,h,g){let w=this.orthoMatrix;if(g){const S=g.find(P=>P.key===h.tileID.key);if(S)return S}if(h.tileID.key!==s.key){const S=s.canonical.z-h.tileID.canonical.z;let P,M,D;w=i.bz();const j=h.tileID.wrap-s.wrap<<s.overscaledZ;S>0?(P=i.aj>>S,M=P*((h.tileID.canonical.x<<S)-s.canonical.x+j),D=P*((h.tileID.canonical.y<<S)-s.canonical.y)):(P=i.aj<<-S,M=i.aj*(h.tileID.canonical.x-(s.canonical.x+j<<-S)),D=i.aj*(h.tileID.canonical.y-(s.canonical.y<<-S))),i.c5(w,0,P,0,P,0,1),i.bo(w,w,[M,D,0])}return new q_(h.tileID,s.key,w)}_findTileCoveringTileID(s,h){let g=h.getTile(s);if(g&&g.hasData())return g;const w=this._findCoveringTileCache[h.id],S=w[s.key];if(g=S?h.getTileByID(S):null,g&&g.hasData()||S===null)return g;let P=g?g.tileID:s,M=P.overscaledZ;const D=h.getSource().minzoom,j=[];if(!S){const K=h.getSource().maxzoom;if(s.canonical.z>=K){const Z=s.canonical.z-K;h.getSource().reparseOverscaled?(M=Math.max(s.canonical.z+2,h.transform.tileZoom),P=new i.aM(M,s.wrap,K,s.canonical.x>>Z,s.canonical.y>>Z)):Z!==0&&(M=K,P=new i.aM(M,s.wrap,K,s.canonical.x>>Z,s.canonical.y>>Z))}P.key!==s.key&&(j.push(P.key),g=h.getTile(P))}const W=K=>{j.forEach(Z=>{w[Z]=K}),j.length=0};for(M-=1;M>=D&&(!g||!g.hasData());M--){g&&W(g.tileID.key);const K=P.calculateScaledKey(M);if(g=h.getTileByID(K),g&&g.hasData())break;const Z=w[K];if(Z===null)break;Z===void 0?j.push(K):g=h.getTileByID(Z)}return W(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,h){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[h.key]=!0}}function gx(m,s,h){const g=function(M,D,j){const W=i.bE(D,M),K=i.bE(j,[.2126,.7152,.0722]),Z=(se,oe,he)=>(1-he)*se+he*oe,ee=Z(1-.3*Math.min(K,1),1,Math.min(W+1,1));return Z(.92,1,Math.asin(i.aD(D[2],-1,1))/Math.PI+.5)*ee}(m,[0,0,1],s),w=[0,0,0];i.b$(w,h.slice(0,3),g);const S=[0,0,0];i.b$(S,s.slice(0,3),m[2]);const P=[0,0,0];return i.cU(P,w,S),i.cX(P)}const X_=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],_x=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class K_{static cacheKey(s,h,g,w){let S=`${h}${w?w.cacheKey:""}`;for(const P of g)s.usedDefines.includes(P)&&(S+=`/${P}`);return S}constructor(s,h,g,w,S,P){const M=s.gl;this.program=M.createProgram(),this.configuration=w,this.name=h,this.fixedDefines=[...P];const D=w?w.getBinderAttributes():[],j=(g.staticAttributes||[]).concat(D);let W=w?w.defines():[];W=W.concat(P.map(he=>`#define ${he}`));const K=`#version 300 es
`;let Z=K+W.concat("precision mediump float;",fc,dc.fragmentSource).join(`
`);for(const he of g.fragmentIncludes)Z+=`
${Ko[he]}`;Z+=`
${g.fragmentSource}`;let ee=K+W.concat("precision highp float;",fc,dc.vertexSource).join(`
`);for(const he of g.vertexIncludes)ee+=`
${Ko[he]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ee+=`
uniform int u_instanceID;
`),ee+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ee=ee.replaceAll("gl_InstanceID","u_instanceID"));const se=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(se,Z),M.compileShader(se),M.attachShader(this.program,se);const oe=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(oe,ee),M.compileShader(oe),M.attachShader(this.program,oe),this.attributes={},this.numAttributes=j.length;for(let he=0;he<this.numAttributes;he++)if(j[he]){const le=j[he].startsWith("a_")?j[he]:`a_${j[he]}`;M.bindAttribLocation(this.program,he,le),this.attributes[le]=he}M.linkProgram(this.program),M.deleteShader(oe),M.deleteShader(se),this.fixedUniforms=S(s),this.binderUniforms=w?w.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(he=>({u_instanceID:new i.cc(he)}))(s)),(P.includes("TERRAIN")||h.indexOf("symbol")!==-1||h.indexOf("circle")!==-1)&&(this.terrainUniforms=(he=>({u_dem:new i.cc(he),u_dem_prev:new i.cc(he),u_dem_tl:new i.c9(he),u_dem_scale:new i.cb(he),u_dem_tl_prev:new i.c9(he),u_dem_scale_prev:new i.cb(he),u_dem_size:new i.cb(he),u_dem_lerp:new i.cb(he),u_exaggeration:new i.cb(he),u_depth:new i.cc(he),u_depth_size_inv:new i.c9(he),u_depth_range_unpack:new i.c9(he),u_occluder_half_size:new i.cb(he),u_occlusion_depth_offset:new i.cb(he),u_meter_to_dem:new i.cb(he),u_label_plane_matrix_inv:new i.c8(he)}))(s)),P.includes("GLOBE")&&(this.globeUniforms=(he=>({u_tile_tl_up:new i.ca(he),u_tile_tr_up:new i.ca(he),u_tile_br_up:new i.ca(he),u_tile_bl_up:new i.ca(he),u_tile_up_scale:new i.cb(he)}))(s)),P.includes("FOG")&&(this.fogUniforms=(he=>({u_fog_matrix:new i.c8(he),u_fog_range:new i.c9(he),u_fog_color:new i.cQ(he),u_fog_horizon_blend:new i.cb(he),u_fog_vertical_limit:new i.c9(he),u_fog_temporal_offset:new i.cb(he),u_frustum_tl:new i.ca(he),u_frustum_tr:new i.ca(he),u_frustum_br:new i.ca(he),u_frustum_bl:new i.ca(he),u_globe_pos:new i.ca(he),u_globe_radius:new i.cb(he),u_globe_transition:new i.cb(he),u_is_globe:new i.cc(he),u_viewport:new i.c9(he)}))(s)),P.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(he=>({u_cutoff_params:new i.cQ(he)}))(s)),P.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(he=>({u_lighting_ambient_color:new i.ca(he),u_lighting_directional_dir:new i.ca(he),u_lighting_directional_color:new i.ca(he),u_ground_radiance:new i.ca(he)}))(s)),P.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(he=>({u_light_matrix_0:new i.c8(he),u_light_matrix_1:new i.c8(he),u_fade_range:new i.c9(he),u_shadow_normal_offset:new i.ca(he),u_shadow_intensity:new i.cb(he),u_shadow_texel_size:new i.cb(he),u_shadow_map_resolution:new i.cb(he),u_shadow_direction:new i.ca(he),u_shadow_bias:new i.ca(he),u_shadowmap_0:new i.cc(he),u_shadowmap_1:new i.cc(he)}))(s))}}setTerrainUniformValues(s,h){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)g[w]&&g[w].set(this.program,w,h[w])}}setGlobeUniformValues(s,h){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)g[w]&&g[w].set(this.program,w,h[w])}}setFogUniformValues(s,h){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)g[w].set(this.program,w,h[w])}}setCutoffUniformValues(s,h){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)g[w].set(this.program,w,h[w])}}setLightsUniformValues(s,h){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)g[w].set(this.program,w,h[w])}}setShadowUniformValues(s,h){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;s.program.set(this.program);for(const w in h)g[w].set(this.program,w,h[w])}_drawDebugWireframe(s,h,g,w,S,P,M,D,j,W){const K=s.options.wireframe;if(K.terrain===!1&&K.layers2D===!1&&K.layers3D===!1)return;const Z=s.context;if(!(!(!K.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!K.layers2D||s._terrain&&s._terrain.renderingToTexture||!X_.includes(this.name))||!(!K.layers3D||!_x.includes(this.name))))return;const ee=Z.gl,se=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,S,Z);if(!se)return;const oe=[...this.fixedDefines];oe.push("DEBUG_WIREFRAME");const he=s.getOrCreateProgram(this.name,{config:this.configuration,defines:oe});Z.program.set(he.program);const le=(Pe,ze,ke)=>{if(ze[Pe]&&ke[Pe])for(const Re in ze[Pe])ke[Pe][Re]&&ke[Pe][Re].set(ke.program,Re,ze[Pe][Re].current)};j&&j.setUniforms(he.program,Z,he.binderUniforms,M,{zoom:D}),le("fixedUniforms",this,he),le("terrainUniforms",this,he),le("globeUniforms",this,he),le("fogUniforms",this,he),le("lightsUniforms",this,he),le("shadowUniforms",this,he),se.bind(),Z.setColorMode(new ar([ee.ONE,ee.ONE_MINUS_SRC_ALPHA,ee.ZERO,ee.ONE],i.am.transparent,[!0,!0,!0,!1])),Z.setDepthMode(new nn(h.func===ee.LESS?ee.LEQUAL:h.func,nn.ReadOnly,h.range)),Z.setStencilMode(Un.disabled);const xe=3*P.primitiveLength*2,Te=3*P.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Pe=W||1;for(let ze=0;ze<Pe;++ze)he.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ze),ee.drawElements(ee.LINES,xe,ee.UNSIGNED_SHORT,Te)}else W&&W>1?ee.drawElementsInstanced(ee.LINES,xe,ee.UNSIGNED_SHORT,Te,W):ee.drawElements(ee.LINES,xe,ee.UNSIGNED_SHORT,Te);S.bind(),Z.program.set(this.program),Z.setDepthMode(h),Z.setStencilMode(g),Z.setColorMode(w)}checkUniforms(s,h,g){if(this.fixedDefines.includes(h)){for(const w of Object.keys(g))if(!g[w].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${w} not set but required by ${h} being defined`)}}draw(s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he){const le=s.context,xe=le.gl;if(this.failedToCreate)return;le.program.set(this.program),le.setDepthMode(g),le.setStencilMode(w),le.setColorMode(S),le.setCullFace(P);for(const ze of Object.keys(this.fixedUniforms))this.fixedUniforms[ze].set(this.program,ze,M[ze]);se&&se.setUniforms(this.program,le,this.binderUniforms,Z,{zoom:ee});const Te={[xe.POINTS]:1,[xe.LINES]:2,[xe.TRIANGLES]:3,[xe.LINE_STRIP]:1}[h];this.checkUniforms(D,"RENDER_SHADOWS",this.shadowUniforms);const Pe=he&&he>0?1:void 0;for(const ze of K.get()){const ke=ze.vaos||(ze.vaos={});if((ke[D]||(ke[D]=new zf)).bind(le,this,j,se?se.getPaintVertexBuffers():[],W,ze.vertexOffset,oe||[],Pe),this.forceManualRenderingForInstanceIDShaders){const Re=he||1;for(let Ie=0;Ie<Re;++Ie)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ie),W?xe.drawElements(h,ze.primitiveLength*Te,xe.UNSIGNED_SHORT,ze.primitiveOffset*Te*2):xe.drawArrays(h,ze.vertexOffset,ze.vertexLength)}else he&&he>1?xe.drawElementsInstanced(h,ze.primitiveLength*Te,xe.UNSIGNED_SHORT,ze.primitiveOffset*Te*2,he):W?xe.drawElements(h,ze.primitiveLength*Te,xe.UNSIGNED_SHORT,ze.primitiveOffset*Te*2):xe.drawArrays(h,ze.vertexOffset,ze.vertexLength);h===xe.TRIANGLES&&W&&this._drawDebugWireframe(s,g,w,S,W,ze,Z,ee,se,he)}}}function qm(m,s,h=0){const g=Math.pow(2,s.tileID.overscaledZ),w=s.tileSize*Math.pow(2,m.transform.tileZoom)/g,S=w*(s.tileID.canonical.x+s.tileID.wrap*g),P=w*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.aw(s,1,m.transform.tileZoom),u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P],u_pattern_transition:h}}const Zm={terrain:0,flat:1},ZS=i.bz(),Td=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le)=>{const xe=s.style.light,Te=xe.properties.get("position"),Pe=[Te.x,Te.y,Te.z],ze=i.dx();xe.properties.get("anchor")==="viewport"&&(i.dy(ze,-s.transform.angle),i.dz(Pe,Pe,ze));const ke=xe.properties.get("color"),Re=s.transform,Ie={u_matrix:m,u_lightpos:Pe,u_lightintensity:xe.properties.get("intensity"),u_lightcolor:[ke.r,ke.g,ke.b],u_vertical_gradient:+h,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ZS,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Zm[j],u_base_type:Zm[W],u_ao:w,u_edge_radius:S,u_width_scale:P,u_flood_light_color:se,u_vertical_scale:oe,u_flood_light_intensity:he,u_ground_shadow_factor:le};return Re.projection.name==="globe"&&(Ie.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Ie.u_zoom_transition=K,Ie.u_inv_rot_matrix=ee,Ie.u_merc_center=Z,Ie.u_up_dir=Re.projection.upVector(new i.cp(0,0,0),Z[0]*i.aj,Z[1]*i.aj),Ie.u_height_lift=D),Ie},eM=(m,s,h,g,w,S)=>({u_matrix:m,u_edge_radius:s,u_width_scale:h,u_vertical_scale:g,u_height_type:Zm[w],u_base_type:Zm[S]}),tM=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le)=>{const xe=Td(m,s,h,g,w,S,P,M,j,W,K,Z,ee,se,oe,he,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,M.overscaledZ)/D.tileSize/8};return i.l(xe,qm(s,D,le),Te)},XS=(m,s,h)=>({u_matrix:m,u_emissive_strength:s,u_ground_shadow_factor:h}),KS=(m,s,h,g,w,S=0)=>i.l(XS(m,s,w),qm(h,g,S)),nM=(m,s,h,g)=>({u_matrix:m,u_world:h,u_emissive_strength:s,u_ground_shadow_factor:g}),rM=(m,s,h,g,w,S,P=0)=>i.l(KS(m,s,h,g,S,P),{u_world:w}),yx=(m,s)=>({u_matrix:m,u_ground_shadow_factor:s}),Xm=(m,s,h,g,w)=>({u_matrix:m,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:h,u_height_scale:g,u_reset_depth:w}),YS=(m,s,h,g)=>{const w=i.aj/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/w,s.pixelsToGLUnits[1]/w]}},Ed=(m,s,h=1)=>({u_matrix:m,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:h}),JS=i.bz(),QS=(m,s,h,g,w,S,P)=>{const M=m.transform,D=M.projection.name==="globe",j=D?i.dA(M.zoom,s.canonical)*M._pixelsPerMercatorPixel:i.aw(h,1,S),W={u_matrix:s.projMatrix,u_extrude_scale:j,u_intensity:P,u_inv_rot_matrix:JS,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){W.u_inv_rot_matrix=g,W.u_merc_center=w,W.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],W.u_zoom_transition=i.ah(M.zoom);const K=w[0]*i.aj,Z=w[1]*i.aj;W.u_up_dir=M.projection.upVector(new i.cp(0,0,0),K,Z)}return W};function vx(m,[s,h,g,w],[S,P]){if(S===P)return[0,0,0,0];const M=255*(m-1)/(m*(P-S));return[s*M,h*M,g*M,w*M]}function Y_(m,s,[h,g]){return h===g?0:.5/m+(s-h)*(m-1)/(m*(g-h))}const Ih=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe,Te,Pe)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:w,u_tl_parent:S,u_scale_parent:j,u_fade_t:W.mix,u_opacity:W.opacity*K.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:K.paint.get("raster-brightness-min"),u_brightness_high:K.paint.get("raster-brightness-max"),u_saturation_factor:i.dB(K.paint.get("raster-saturation")),u_contrast_factor:i.dC(K.paint.get("raster-contrast")),u_spin_weights:eT(K.paint.get("raster-hue-rotate")),u_perspective_transform:Z,u_raster_elevation:ee,u_zoom_transition:P,u_merc_center:M,u_cutoff_params:D,u_colorization_mix:vx(i.dD,oe,le),u_colorization_offset:Y_(i.dD,he,le),u_color_ramp:se,u_texture_offset:[Te/(xe+2*Te),xe/(xe+2*Te)],u_texture_res:[xe+2*Te,xe+2*Te],u_emissive_strength:Pe});function eT(m){m*=Math.PI/180;const s=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*s-h+1)/3,(Math.sqrt(3)*s-h+1)/3]}const hl=.05,xx=(m,s,h,g,w,S,P,M,D,j,W,K)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:w,u_tl_parent:S,u_scale_parent:j,u_fade_t:W.mix,u_opacity:W.opacity,u_image0:0,u_image1:1,u_raster_elevation:K,u_zoom_transition:P,u_merc_center:M,u_cutoff_params:D}),J_=(m,s,h,g,w,S,P,M,D,j)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_tile_offset:h,u_velocity:g,u_color_ramp:S,u_velocity_res:w,u_max_speed:P,u_uv_offset:M,u_data_scale:[255*D[0],255*D[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[hl,hl]}),tT=(m,s,h,g,w,S,P,M,D,j)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_velocity:h,u_velocity_res:g,u_max_speed:w,u_speed_factor:S,u_reset_rate:P,u_rand_seed:Math.random(),u_uv_offset:M,u_data_scale:[255*D[0],255*D[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[hl,hl]}),bx=i.bz(),Q_=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe,Te,Pe,ze,ke)=>{const Re=w.transform,Ie={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Re.getCameraToCenterDistance(xe),u_rotate_symbol:+h,u_aspect_ratio:Re.width/Re.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:P,u_coord_matrix:M,u_is_text:+j,u_elevation_from_sea:D?1:0,u_pitch_with_map:+g,u_texsize:W,u_texsize_icon:K,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:bx,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:bx,u_up_vector:[0,-1,0],u_color_adj_mat:Pe,u_icon_transition:ze||0,u_gamma_scale:g?w.transform.getCameraToCenterDistance(xe)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+Z,u_scale_factor:ke||1,u_ground_shadow_factor:Te,u_inv_matrix:i.bi(i.bz(),P)};return xe.name==="globe"&&(Ie.u_tile_id=[ee.canonical.x,ee.canonical.y,1<<ee.canonical.z],Ie.u_zoom_transition=se,Ie.u_inv_rot_matrix=he,Ie.u_merc_center=oe,Ie.u_camera_forward=Re._camera.forward(),Ie.u_ecef_origin=i.dE(Re.globeMatrix,ee.toUnwrapped()),Ie.u_tile_matrix=Float32Array.from(Re.globeMatrix),Ie.u_up_vector=le),Ie},ey=(m,s,h,g)=>({u_matrix:m,u_emissive_strength:s,u_opacity:h,u_color:g}),nT=(m,s,h,g,w,S,P,M,D)=>i.l(function(j,W,K,Z,ee,se){const{width:oe,height:he}=Z.imageManager.getPixelSize(W),le=Math.pow(2,se.tileID.overscaledZ),xe=se.tileSize*Math.pow(2,Z.transform.tileZoom)/le,Te=xe*(se.tileID.canonical.x+se.tileID.wrap*le),Pe=xe*se.tileID.canonical.y;return{u_image:0,u_pattern_tl:K.tl,u_pattern_br:K.br,u_texsize:[oe,he],u_pattern_size:K.displaySize,u_pattern_units_to_pixels:ee?[Z.transform.width,-1*Z.transform.height]:[1/i.aw(se,1,Z.transform.tileZoom),1/i.aw(se,1,Z.transform.tileZoom)],u_pixel_coord_upper:[Te>>16,Pe>>16],u_pixel_coord_lower:[65535&Te,65535&Pe]}}(0,S,P,g,M,D),{u_matrix:m,u_emissive_strength:s,u_opacity:h}),ty=new Float32Array(i.bx([])),Ad=(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee=[0,0,0],se)=>{const oe=w.style.light,he=oe.properties.get("position"),le=[-he.x,-he.y,he.z],xe=i.dx();oe.properties.get("anchor")==="viewport"&&(i.dy(xe,-w.transform.angle),i.dz(le,le,xe));const Te=W.alphaMode==="MASK",Pe=oe.properties.get("color").toRenderColor(null),ze=Z.paint.get("model-ambient-occlusion-intensity"),ke=Z.paint.get("model-color").constantOr(i.am.white).toRenderColor(null),Re=Z.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:s,u_normal_matrix:h,u_node_matrix:g||ty,u_lightpos:le,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_camera_pos:ee,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+Te,u_alphaCutoff:W.alphaCutoff,u_baseColorFactor:[P.r,P.g,P.b,P.a],u_emissiveFactor:[M[0],M[1],M[2],1],u_metallicFactor:D,u_roughnessFactor:j,u_baseColorTexture:Eo.BaseColor,u_metallicRoughnessTexture:Eo.MetallicRoughness,u_normalTexture:Eo.Normal,u_occlusionTexture:Eo.Occlusion,u_emissionTexture:Eo.Emission,u_lutTexture:Eo.LUT,u_color_mix:[ke.r,ke.g,ke.b,Re],u_aoIntensity:ze,u_emissive_strength:K,u_occlusionTextureTransform:se||[0,0,0,0]}},rT=(m,s=ty,h=ty)=>({u_matrix:m,u_instance:s,u_node_matrix:h}),iM={fillExtrusion:m=>({u_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_vertical_gradient:new i.cb(m),u_opacity:new i.cb(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_ao:new i.c9(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_up_dir:new i.ca(m),u_height_lift:new i.cb(m),u_flood_light_color:new i.ca(m),u_vertical_scale:new i.cb(m),u_flood_light_intensity:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),fillExtrusionDepth:m=>({u_matrix:new i.c8(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_vertical_scale:new i.cb(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m)}),fillExtrusionPattern:m=>({u_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_vertical_gradient:new i.cb(m),u_height_factor:new i.cb(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_ao:new i.c9(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_up_dir:new i.ca(m),u_height_lift:new i.cb(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_opacity:new i.cb(m),u_pattern_transition:new i.cb(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new i.c8(m),u_opacity:new i.cb(m),u_ao_pass:new i.cb(m),u_meter_to_tile:new i.cb(m),u_ao:new i.c9(m),u_flood_light_intensity:new i.cb(m),u_flood_light_color:new i.ca(m),u_attenuation:new i.cb(m),u_edge_radius:new i.cb(m),u_fb:new i.cc(m),u_fb_size:new i.cb(m),u_dynamic_offset:new i.cb(m)}),fill:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),fillPattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_pattern_transition:new i.cb(m)}),fillOutline:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_world:new i.c9(m),u_ground_shadow_factor:new i.ca(m)}),fillOutlinePattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_world:new i.c9(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_pattern_transition:new i.cb(m)}),building:m=>({u_matrix:new i.c8(m),u_normal_matrix:new i.c8(m),u_opacity:new i.cb(m)}),buildingDepth:m=>({u_matrix:new i.c8(m)}),elevatedStructuresDepth:m=>({u_matrix:new i.c8(m),u_depth_bias:new i.cb(m)}),elevatedStructures:m=>({u_matrix:new i.c8(m),u_ground_shadow_factor:new i.ca(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new i.c8(m),u_camera_pos:new i.ca(m),u_depth_bias:new i.cb(m),u_height_scale:new i.cb(m),u_reset_depth:new i.cb(m)}),circle:i.dF,collisionBox:m=>({u_matrix:new i.c8(m),u_camera_to_center_distance:new i.cb(m),u_extrude_scale:new i.c9(m)}),collisionCircle:m=>({u_matrix:new i.c8(m),u_inv_matrix:new i.c8(m),u_camera_to_center_distance:new i.cb(m),u_viewport_size:new i.c9(m)}),debug:m=>({u_color:new i.di(m),u_matrix:new i.c8(m),u_overlay:new i.cc(m),u_overlay_scale:new i.cb(m)}),clippingMask:m=>({u_matrix:new i.c8(m)}),heatmap:m=>({u_extrude_scale:new i.cb(m),u_intensity:new i.cb(m),u_matrix:new i.c8(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_up_dir:new i.ca(m)}),heatmapTexture:m=>({u_image:new i.cc(m),u_color_ramp:new i.cc(m),u_opacity:new i.cb(m)}),hillshade:m=>({u_matrix:new i.c8(m),u_image:new i.cc(m),u_latrange:new i.c9(m),u_light:new i.c9(m),u_shadow:new i.di(m),u_highlight:new i.di(m),u_emissive_strength:new i.cb(m),u_accent:new i.di(m)}),hillshadePrepare:m=>({u_matrix:new i.c8(m),u_image:new i.cc(m),u_dimension:new i.c9(m),u_zoom:new i.cb(m)}),line:i.dG,linePattern:i.dH,raster:m=>({u_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_grid_matrix:new i.dj(m),u_tl_parent:new i.c9(m),u_scale_parent:new i.cb(m),u_fade_t:new i.cb(m),u_opacity:new i.cb(m),u_image0:new i.cc(m),u_image1:new i.cc(m),u_brightness_low:new i.cb(m),u_brightness_high:new i.cb(m),u_saturation_factor:new i.cb(m),u_contrast_factor:new i.cb(m),u_spin_weights:new i.ca(m),u_perspective_transform:new i.c9(m),u_raster_elevation:new i.cb(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_cutoff_params:new i.cQ(m),u_colorization_mix:new i.cQ(m),u_colorization_offset:new i.cb(m),u_color_ramp:new i.cc(m),u_texture_offset:new i.c9(m),u_texture_res:new i.c9(m),u_emissive_strength:new i.cb(m)}),rasterParticle:m=>({u_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_grid_matrix:new i.dj(m),u_tl_parent:new i.c9(m),u_scale_parent:new i.cb(m),u_fade_t:new i.cb(m),u_opacity:new i.cb(m),u_image0:new i.cc(m),u_image1:new i.cc(m),u_raster_elevation:new i.cb(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_cutoff_params:new i.cQ(m)}),rasterParticleTexture:m=>({u_texture:new i.cc(m),u_opacity:new i.cb(m)}),rasterParticleDraw:m=>({u_particle_texture:new i.cc(m),u_particle_texture_side_len:new i.cb(m),u_tile_offset:new i.c9(m),u_velocity:new i.cc(m),u_color_ramp:new i.cc(m),u_velocity_res:new i.c9(m),u_max_speed:new i.cb(m),u_uv_offset:new i.c9(m),u_data_scale:new i.c9(m),u_data_offset:new i.cb(m),u_particle_pos_scale:new i.cb(m),u_particle_pos_offset:new i.c9(m)}),rasterParticleUpdate:m=>({u_particle_texture:new i.cc(m),u_particle_texture_side_len:new i.cb(m),u_velocity:new i.cc(m),u_velocity_res:new i.c9(m),u_max_speed:new i.cb(m),u_speed_factor:new i.cb(m),u_reset_rate:new i.cb(m),u_rand_seed:new i.cb(m),u_uv_offset:new i.c9(m),u_data_scale:new i.c9(m),u_data_offset:new i.cb(m),u_particle_pos_scale:new i.cb(m),u_particle_pos_offset:new i.c9(m)}),symbol:m=>({u_is_size_zoom_constant:new i.cc(m),u_is_size_feature_constant:new i.cc(m),u_size_t:new i.cb(m),u_size:new i.cb(m),u_camera_to_center_distance:new i.cb(m),u_rotate_symbol:new i.cc(m),u_aspect_ratio:new i.cb(m),u_fade_change:new i.cb(m),u_matrix:new i.c8(m),u_label_plane_matrix:new i.c8(m),u_coord_matrix:new i.c8(m),u_is_text:new i.cc(m),u_elevation_from_sea:new i.cc(m),u_pitch_with_map:new i.cc(m),u_texsize:new i.c9(m),u_texsize_icon:new i.c9(m),u_texture:new i.cc(m),u_texture_icon:new i.cc(m),u_gamma_scale:new i.cb(m),u_device_pixel_ratio:new i.cb(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_camera_forward:new i.ca(m),u_tile_matrix:new i.c8(m),u_up_vector:new i.ca(m),u_ecef_origin:new i.ca(m),u_is_halo:new i.cc(m),u_icon_transition:new i.cb(m),u_color_adj_mat:new i.c8(m),u_scale_factor:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_inv_matrix:new i.c8(m)}),background:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_opacity:new i.cb(m),u_color:new i.di(m)}),backgroundPattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_opacity:new i.cb(m),u_image:new i.cc(m),u_pattern_tl:new i.c9(m),u_pattern_br:new i.c9(m),u_texsize:new i.c9(m),u_pattern_size:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_pattern_units_to_pixels:new i.c9(m)}),terrainRaster:m=>({u_matrix:new i.c8(m),u_image0:new i.cc(m),u_skirt_height:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),skybox:m=>({u_matrix:new i.c8(m),u_sun_direction:new i.ca(m),u_cubemap:new i.cc(m),u_opacity:new i.cb(m),u_temporal_offset:new i.cb(m)}),skyboxGradient:m=>({u_matrix:new i.c8(m),u_color_ramp:new i.cc(m),u_center_direction:new i.ca(m),u_radius:new i.cb(m),u_opacity:new i.cb(m),u_temporal_offset:new i.cb(m)}),skyboxCapture:m=>({u_matrix_3f:new i.dj(m),u_sun_direction:new i.ca(m),u_sun_intensity:new i.cb(m),u_color_tint_r:new i.cQ(m),u_color_tint_m:new i.cQ(m),u_luminance:new i.cb(m)}),globeRaster:m=>({u_proj_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_image0:new i.cc(m),u_grid_matrix:new i.dj(m),u_skirt_height:new i.cb(m),u_far_z_cutoff:new i.cb(m),u_frustum_tl:new i.ca(m),u_frustum_tr:new i.ca(m),u_frustum_br:new i.ca(m),u_frustum_bl:new i.ca(m),u_globe_pos:new i.ca(m),u_globe_radius:new i.cb(m),u_viewport:new i.c9(m)}),globeAtmosphere:m=>({u_frustum_tl:new i.ca(m),u_frustum_tr:new i.ca(m),u_frustum_br:new i.ca(m),u_frustum_bl:new i.ca(m),u_horizon:new i.cb(m),u_transition:new i.cb(m),u_fadeout_range:new i.cb(m),u_color:new i.cQ(m),u_high_color:new i.cQ(m),u_space_color:new i.cQ(m),u_temporal_offset:new i.cb(m),u_horizon_angle:new i.cb(m)}),model:m=>({u_matrix:new i.c8(m),u_lighting_matrix:new i.c8(m),u_normal_matrix:new i.c8(m),u_node_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_camera_pos:new i.ca(m),u_opacity:new i.cb(m),u_baseColorFactor:new i.cQ(m),u_emissiveFactor:new i.cQ(m),u_metallicFactor:new i.cb(m),u_roughnessFactor:new i.cb(m),u_baseTextureIsAlpha:new i.cc(m),u_alphaMask:new i.cc(m),u_alphaCutoff:new i.cb(m),u_baseColorTexture:new i.cc(m),u_metallicRoughnessTexture:new i.cc(m),u_normalTexture:new i.cc(m),u_occlusionTexture:new i.cc(m),u_emissionTexture:new i.cc(m),u_lutTexture:new i.cc(m),u_color_mix:new i.cQ(m),u_aoIntensity:new i.cb(m),u_emissive_strength:new i.cb(m),u_occlusionTextureTransform:new i.cQ(m)}),modelDepth:m=>({u_matrix:new i.c8(m),u_instance:new i.c8(m),u_node_matrix:new i.c8(m)}),groundShadow:m=>({u_matrix:new i.c8(m),u_ground_shadow_factor:new i.ca(m)}),stars:m=>({u_matrix:new i.c8(m),u_up:new i.ca(m),u_right:new i.ca(m),u_intensity_multiplier:new i.cb(m)}),snowParticle:m=>({u_modelview:new i.c8(m),u_projection:new i.c8(m),u_time:new i.cb(m),u_cam_pos:new i.ca(m),u_velocityConeAperture:new i.cb(m),u_velocity:new i.cb(m),u_horizontalOscillationRadius:new i.cb(m),u_horizontalOscillationRate:new i.cb(m),u_boxSize:new i.cb(m),u_billboardSize:new i.cb(m),u_simpleShapeParameters:new i.c9(m),u_screenSize:new i.c9(m),u_thinningCenterPos:new i.c9(m),u_thinningShape:new i.ca(m),u_thinningAffectedRatio:new i.cb(m),u_thinningParticleOffset:new i.cb(m),u_particleColor:new i.cQ(m),u_direction:new i.ca(m)}),rainParticle:m=>({u_modelview:new i.c8(m),u_projection:new i.c8(m),u_time:new i.cb(m),u_cam_pos:new i.ca(m),u_texScreen:new i.cc(m),u_velocityConeAperture:new i.cb(m),u_velocity:new i.cb(m),u_boxSize:new i.cb(m),u_rainDropletSize:new i.c9(m),u_distortionStrength:new i.cb(m),u_rainDirection:new i.ca(m),u_color:new i.cQ(m),u_screenSize:new i.c9(m),u_thinningCenterPos:new i.c9(m),u_thinningShape:new i.ca(m),u_thinningAffectedRatio:new i.cb(m),u_thinningParticleOffset:new i.cb(m),u_shapeDirectionalPower:new i.cb(m),u_shapeNormalPower:new i.cb(m),u_mode:new i.cb(m)}),vignette:m=>({u_vignetteShape:new i.ca(m),u_vignetteColor:new i.cQ(m)}),occlusion:m=>({u_matrix:new i.c8(m),u_anchorPos:new i.ca(m),u_screenSizePx:new i.c9(m),u_occluderSizePx:new i.c9(m),u_color:new i.cQ(m)})};class Mu{constructor(s,h,g,w){this.id=Mu.uniqueIdxCounter,Mu.uniqueIdxCounter++,this.context=s;const S=s.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||w||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=Mu.uniqueIdxCounter,Mu.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Mu.uniqueIdxCounter=0;const oM={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wx{constructor(s,h,g,w,S,P){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=w,this.instanceCount=P,this.context=s;const M=s.gl;this.buffer=M.createBuffer(),s.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||S||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,h){for(let g=0;g<this.attributes.length;g++){const w=h.attributes[this.attributes[g].name];w!==void 0&&s.enableVertexAttribArray(w)}}setVertexAttribPointers(s,h,g){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],P=h.attributes[S.name];P!==void 0&&s.vertexAttribPointer(P,S.components,s[oM[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,h,g){for(let w=0;w<this.attributes.length;w++){const S=h.attributes[this.attributes[w].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(S,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ny{constructor(s,h,g,w,S){this.context=s,this.width=h,this.height=g;const P=this.framebuffer=s.gl.createFramebuffer();w&&(this.colorAttachment=new px(s,P)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new jf(s,P):new Wm(s,P))}destroy(){const s=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&s.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&s.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&s.deleteTexture(h)}s.deleteFramebuffer(this.framebuffer)}}class Gf{constructor(s,h){this.gl=s,this.clearColor=new j_(this),this.clearDepth=new $_(this),this.clearStencil=new fx(this),this.colorMask=new $m(this),this.depthMask=new U_(this),this.stencilMask=new Bf(this),this.stencilFunc=new x(this),this.stencilOp=new I(this),this.stencilTest=new U(this),this.depthRange=new ne(this),this.depthTest=new pe(this),this.depthFunc=new Oe(this),this.blend=new lt(this),this.blendFunc=new Rt(this),this.blendColor=new Ht(this),this.blendEquation=new bn(this),this.cullFace=new Yn(this),this.cullFaceSide=new Ir(this),this.frontFace=new Yr(this),this.program=new va(this),this.activeTexture=new Yo(this),this.viewport=new Ds(this),this.bindFramebuffer=new Ga(this),this.bindRenderbuffer=new mc(this),this.bindTexture=new wd(this),this.bindVertexBuffer=new V_(this),this.bindElementBuffer=new W_(this),this.bindVertexArrayOES=new Um(this),this.pixelStoreUnpack=new Ph(this),this.pixelStoreUnpackPremultiplyAlpha=new Vm(this),this.pixelStoreUnpackFlipY=new Jo(this),this.options=h?Object.assign({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=h&&!!h.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,h,g){return new Mu(this,s,h,g)}createVertexBuffer(s,h,g,w,S){return new wx(this,s,h,g,w,S)}createRenderbuffer(s,h,g){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,s,h,g),this.bindRenderbuffer.set(null),S}createFramebuffer(s,h,g,w){return new ny(this,s,h,g,w)}clear({color:s,depth:h,stencil:g,colorMask:w}){const S=this.gl;let P=0;s&&(P|=S.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(w||[!0,!0,!0,!0])),h!==void 0&&(P|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(P|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),S.clear(P)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.bv(s.blendFunction,ar.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Pd;function Hf(m,s,h,g,w,S,P){const M=m.context,D=M.gl,j=m.transform,W=m.getOrCreateProgram("collisionBox"),K=[];let Z=0,ee=0;for(let Pe=0;Pe<g.length;Pe++){const ze=g[Pe],ke=s.getTile(ze),Re=ke.getBucket(h);if(!Re)continue;const Ie=ks(ze,Re,j);let Ve=Ie;w[0]===0&&w[1]===0||(Ve=m.translatePosMatrix(Ie,ke,w,S));const Ge=P?Re.textCollisionBox:Re.iconCollisionBox,ht=Re.collisionCircleArray;if(ht.length>0){const et=i.bz(),Et=Ve;i.cB(et,Re.placementInvProjMatrix,j.glCoordMatrix),i.cB(et,et,Re.placementViewportMatrix),K.push({circleArray:ht,circleOffset:ee,transform:Et,invTransform:et,projection:Re.getProjection()}),Z+=ht.length/4,ee=Z}Ge&&(m.terrain&&m.terrain.setupElevationDraw(ke,W),W.draw(m,D.LINES,nn.disabled,Un.disabled,m.colorModeForRenderPass(),Fn.disabled,YS(Ve,j,ke,Re.getProjection()),h.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,j.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!P||!K.length)return;const se=m.getOrCreateProgram("collisionCircle"),oe=new i.dI;oe.resize(4*Z),oe._trim();let he=0;for(const Pe of K)for(let ze=0;ze<Pe.circleArray.length/4;ze++){const ke=4*ze,Re=Pe.circleArray[ke+0],Ie=Pe.circleArray[ke+1],Ve=Pe.circleArray[ke+2],Ge=Pe.circleArray[ke+3];oe.emplace(he++,Re,Ie,Ve,Ge,0),oe.emplace(he++,Re,Ie,Ve,Ge,1),oe.emplace(he++,Re,Ie,Ve,Ge,2),oe.emplace(he++,Re,Ie,Ve,Ge,3)}(!Pd||Pd.length<2*Z)&&(Pd=function(Pe){const ze=2*Pe,ke=new i.a_;ke.resize(ze),ke._trim();for(let Re=0;Re<ze;Re++){const Ie=6*Re;ke.uint16[Ie+0]=4*Re+0,ke.uint16[Ie+1]=4*Re+1,ke.uint16[Ie+2]=4*Re+2,ke.uint16[Ie+3]=4*Re+2,ke.uint16[Ie+4]=4*Re+3,ke.uint16[Ie+5]=4*Re+0}return ke}(Z));const le=M.createIndexBuffer(Pd,!0),xe=M.createVertexBuffer(oe,i.dJ.members,!0);for(const Pe of K){const ze={u_matrix:Pe.transform,u_inv_matrix:Pe.invTransform,u_camera_to_center_distance:(Te=j).getCameraToCenterDistance(Pe.projection),u_viewport_size:[Te.width,Te.height]};se.draw(m,D.TRIANGLES,nn.disabled,Un.disabled,m.colorModeForRenderPass(),Fn.disabled,ze,h.id,xe,le,i.bd.simpleSegment(0,2*Pe.circleOffset,Pe.circleArray.length,Pe.circleArray.length/2),null,j.zoom)}var Te;xe.destroy(),le.destroy()}const Km=i.bz();function Ym(m){const s=m._camera.getWorldToCamera(m.worldSize,1),h=i.az([],s,m.globeMatrix);i.bi(h,h);const g=[0,0,0],w=[0,1,0,0];return i.aA(w,w,h),g[0]=w[0],g[1]=w[1],g[2]=w[2],i.au(g,g),g}function ry({width:m,height:s,anchor:h,textOffset:g,textScale:w},S){const{horizontalAlign:P,verticalAlign:M}=i.bV(h),D=-(P-.5)*m,j=-(M-.5)*s,W=i.bU(h,g);return new i.P((D/w+W[0])*S,(j/w+W[1])*S)}function Sx(m,s,h,g,w,S,P,M,D,j){const W=m.text.placedSymbolArray,K=m.text.dynamicLayoutVertexArray,Z=m.icon.dynamicLayoutVertexArray,ee={},se=m.getProjection(),oe=pd(P,se,w),he=w.elevation,le=se.upVectorScale(P.canonical,w.center.lat,w.worldSize).metersToTile;K.clear();for(let xe=0;xe<W.length;xe++){const Te=W.get(xe),{tileAnchorX:Pe,tileAnchorY:ze,numGlyphs:ke}=Te,Re=Te.hidden||!Te.crossTileID||m.allowVerticalPlacement&&!Te.placedOrientation?null:g[Te.crossTileID];if(Re){let Ie=0,Ve=0,Ge=0;if(he){const It=he?he.getAtTileOffset(P,Pe,ze):0,[gt,Lt,At]=se.upVector(P.canonical,Pe,ze);Ie=It*gt*le,Ve=It*Lt*le,Ge=It*At*le}let[ht,et,Et,wt]=ds(Te.projectedAnchorX+Ie,Te.projectedAnchorY+Ve,Te.projectedAnchorZ+Ge,h?oe:S);const qt=ic(w.getCameraToCenterDistance(se),wt);let tt=i.bJ(m.textSizeData,D,Te)*qt/i.bO;h&&(tt*=m.tilePixelRatio/M);const dt=ry(Re,tt);h?({x:ht,y:et,z:Et}=se.projectTilePoint(Pe+dt.x,ze+dt.y,P.canonical),[ht,et,Et]=ds(ht+Ie,et+Ve,Et+Ge,S)):(s&&dt._rotate(-w.angle),ht+=dt.x,et+=dt.y,Et=0);const Je=m.allowVerticalPlacement&&Te.placedOrientation===i.bI.vertical?Math.PI/2:0;for(let It=0;It<ke;It++)i.bL(K,ht,et,Et,Je);j&&Te.associatedIconIndex>=0&&(ee[Te.associatedIconIndex]={x:ht,y:et,z:Et,angle:Je})}else Dr(ke,K)}if(j){Z.clear();const xe=m.icon.placedSymbolArray;for(let Te=0;Te<xe.length;Te++){const Pe=xe.get(Te),{numGlyphs:ze}=Pe,ke=ee[Te];if(Pe.hidden||!ke)Dr(ze,Z);else{const{x:Re,y:Ie,z:Ve,angle:Ge}=ke;for(let ht=0;ht<ze;ht++)i.bL(Z,Re,Ie,Ve,Ge)}}m.icon.dynamicLayoutVertexBuffer.updateData(Z)}m.text.dynamicLayoutVertexBuffer.updateData(K)}function iy(m,s,h,g,w,S,P={}){const M=h.paint.get("icon-translate"),D=h.paint.get("text-translate"),j=h.paint.get("icon-translate-anchor"),W=h.paint.get("text-translate-anchor"),K=h.layout.get("icon-rotation-alignment"),Z=h.layout.get("text-rotation-alignment"),ee=h.layout.get("icon-pitch-alignment"),se=h.layout.get("text-pitch-alignment"),oe=h.layout.get("icon-keep-upright"),he=h.layout.get("text-keep-upright"),le=h.paint.get("icon-color-saturation"),xe=h.paint.get("icon-color-contrast"),Te=h.paint.get("icon-color-brightness-min"),Pe=h.paint.get("icon-color-brightness-max"),ze=h.layout.get("symbol-elevation-reference")==="sea",ke=m.context,Re=ke.gl,Ie=m.transform,Ve=K==="map",Ge=Z==="map",ht=ee==="map",et=se==="map",Et=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let wt=!1;const qt=m.depthModeForSublayer(0,nn.ReadOnly),tt=new nn(m.context.gl.LEQUAL,nn.ReadOnly,m.depthRangeFor3D),dt=[i.ay(Ie.center.lng),i.aH(Ie.center.lat)],Je=h.layout.get("text-variable-anchor"),It=Ie.projection.name==="globe",gt=[],Lt=[0,-1,0];for(const At of g){const zt=s.getTile(At),Ft=zt.getBucket(h);if(!Ft||Ft.projection.name==="mercator"&&It||Ft.fullyClipped)continue;const gn=Ft.projection.name==="globe",En=gn?i.ah(Ie.zoom):0,fn=pd(At,Ft.getProjection(),Ie),Pn=Ie.calculatePixelsToTileUnitsMatrix(zt),yn=Je&&Ft.hasTextData(),Nn=Ft.hasIconTextFit()&&yn&&Ft.hasIconData(),Xn=Ft.elevationType==="road"?tt:qt,yr=Ft.getProjection().createInversionMatrix(Ie,At.canonical),oi=m.shadowRenderer,Qr=Ft.elevationType==="road"&&!!oi&&oi.enabled;let br=[0,0,0];if(Qr){const ji=m.style.directionalLight,sr=m.style.ambientLight;ji&&sr&&(br=ll(m.style,ji,sr))}const Ji=ji=>{Ie.depthOcclusionForSymbolsAndCircles&&(h.hasInitialOcclusionOpacityProperties||m.terrain)&&(ji.push("DEPTH_D24"),ji.push("DEPTH_OCCLUSION"))},Hi=()=>{const ji=Ve&&h.layout.get("symbol-placement")!=="point",sr=[];Ji(sr);const Ri=ji||Nn,Rr=h.paint.get("icon-image-cross-fade");m.terrainRenderModeElevated()&&ht&&sr.push("PITCH_WITH_MAP_TERRAIN"),gn&&(sr.push("PROJECTION_GLOBE_VIEW"),Ri&&sr.push("PROJECTED_POS_ON_VIEWPORT")),Rr>0&&sr.push("ICON_TRANSITION"),Ft.icon.zOffsetVertexBuffer&&sr.push("Z_OFFSET"),le===0&&xe===0&&Te===0&&Pe===1||sr.push("COLOR_ADJUSTMENT"),Ft.sdfIcons&&sr.push("RENDER_SDF"),Qr&&sr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Di=Ft.icon.programConfigurations.get(h.id),jr=m.getOrCreateProgram("symbol",{config:Di,defines:sr}),$i=zt.imageAtlasTexture?zt.imageAtlasTexture.size:[0,0],oa=Ft.iconSizeData,Ai=i.bH(oa,Ie.zoom),xa=ht||Ie.pitch!==0,mo=vh(fn,zt.tileID.canonical,ht,Ve,Ie,Ft.getProjection(),Pn),za=dd(fn,zt.tileID.canonical,ht,Ve,Ie,Ft.getProjection(),Pn),xc=m.translatePosMatrix(za,zt,M,j,!0),Du=m.translatePosMatrix(fn,zt,M,j),Vs=Ri?Km:mo,Fl=Ve&&!ht&&!ji;let Gc=Lt;!It&&!Ie.mercatorFromTransition||Ve||(Gc=Ym(Ie));const Hc=gn?Gc:Lt,bc=h.getColorAdjustmentMatrix(le,xe,Te,Pe),ip=Q_(oa.kind,Ai,Fl,ht,m,Du,Vs,xc,ze,!1,$i,[0,0],!0,At,En,dt,yr,Hc,Ft.getProjection(),br,bc,Rr),Nd=zt.imageAtlasTexture?zt.imageAtlasTexture:null,by=h.layout.get("icon-size").constantOr(0)!==1||Ft.iconsNeedLinear,wy=Ft.sdfIcons||m.options.rotating||m.options.zooming||by||xa?Re.LINEAR:Re.NEAREST,Sy=Ft.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,fg=m.terrain&&ht&&ji?i.bi(i.bz(),mo):Km;if(ji&&Ft.icon){const Li=Ie.elevation,op=Li?Li.getAtTileOffsetFunc(At,Ie.center.lat,Ie.worldSize,Ft.getProjection()):null,qx=hd(fn,zt.tileID.canonical,ht,Ve,Ie,Ft.getProjection(),Pn);km(Ft,fn,m,!1,qx,za,ht,oe,op,At)}return{program:jr,buffers:Ft.icon,uniformValues:ip,atlasTexture:Nd,atlasTextureIcon:null,atlasInterpolation:wy,atlasInterpolationIcon:null,isSDF:Ft.sdfIcons,hasHalo:Sy,depthMode:Xn,tile:zt,renderWithShadows:Qr,labelPlaneMatrixInv:fg}},tr=()=>{const ji=Ge&&h.layout.get("symbol-placement")!=="point",sr=[],Ri=ji||Je||Nn;m.terrainRenderModeElevated()&&et&&sr.push("PITCH_WITH_MAP_TERRAIN"),gn&&(sr.push("PROJECTION_GLOBE_VIEW"),Ri&&sr.push("PROJECTED_POS_ON_VIEWPORT")),Ft.text.zOffsetVertexBuffer&&sr.push("Z_OFFSET"),Ft.iconsInText&&sr.push("RENDER_TEXT_AND_SYMBOL"),sr.push("RENDER_SDF"),Qr&&sr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ji(sr);const Rr=Ft.text.programConfigurations.get(h.id),Di=m.getOrCreateProgram("symbol",{config:Rr,defines:sr});let jr,$i=[0,0],oa=null;const Ai=Ft.textSizeData;Ft.iconsInText&&($i=zt.imageAtlasTexture?zt.imageAtlasTexture.size:[0,0],oa=zt.imageAtlasTexture?zt.imageAtlasTexture:null,jr=et||Ie.pitch!==0||m.options.rotating||m.options.zooming||Ai.kind==="composite"||Ai.kind==="camera"?Re.LINEAR:Re.NEAREST);const xa=zt.glyphAtlasTexture?zt.glyphAtlasTexture.size:[0,0],mo=h.layout.get("text-size-scale-range"),za=i.aD(m.scaleFactor,mo[0],mo[1]),xc=i.bH(Ai,Ie.zoom,za),Du=vh(fn,zt.tileID.canonical,et,Ge,Ie,Ft.getProjection(),Pn),Vs=dd(fn,zt.tileID.canonical,et,Ge,Ie,Ft.getProjection(),Pn),Fl=m.translatePosMatrix(Vs,zt,D,W,!0),Gc=m.translatePosMatrix(fn,zt,D,W),Hc=Ri?Km:Du,bc=Ge&&!et&&!ji;let ip=Lt;!It&&!Ie.mercatorFromTransition||Ge||(ip=Ym(Ie));const Nd=Q_(Ai.kind,xc,bc,et,m,Gc,Hc,Fl,ze,!0,xa,$i,!0,At,En,dt,yr,gn?ip:Lt,Ft.getProjection(),br,null,null,za),by=zt.glyphAtlasTexture?zt.glyphAtlasTexture:null,wy=Re.LINEAR,Sy=h.paint.get("text-halo-width").constantOr(1)!==0,fg=m.terrain&&et&&ji?i.bi(i.bz(),Du):Km;if(ji&&Ft.text){const Li=Ie.elevation,op=Li?Li.getAtTileOffsetFunc(At,Ie.center.lat,Ie.worldSize,Ft.getProjection()):null,qx=hd(fn,zt.tileID.canonical,et,Ge,Ie,Ft.getProjection(),Pn);km(Ft,fn,m,!0,qx,Vs,et,he,op,At)}return{program:Di,buffers:Ft.text,uniformValues:Nd,atlasTexture:by,atlasTextureIcon:oa,atlasInterpolation:wy,atlasInterpolationIcon:jr,isSDF:!0,hasHalo:Sy,depthMode:Xn,tile:zt,renderWithShadows:Qr,labelPlaneMatrixInv:fg}},Mr=Ft.icon.segments.get().length,Lr=Ft.text.segments.get().length,ai=Mr&&!P.onlyText?Hi():null,Ao=Lr&&!P.onlyIcons?tr():null,oo=h.paint.get("icon-opacity").constantOr(1),So=h.paint.get("text-opacity").constantOr(1);if(Et&&Ft.canOverlap){wt=!0;const ji=oo&&!P.onlyText?Ft.icon.segments.get():[],sr=So&&!P.onlyIcons?Ft.text.segments.get():[];for(const Ri of ji)gt.push({segments:new i.bd([Ri]),sortKey:Ri.sortKey,state:ai});for(const Ri of sr)gt.push({segments:new i.bd([Ri]),sortKey:Ri.sortKey,state:Ao})}else P.onlyText||gt.push({segments:oo?Ft.icon.segments:new i.bd([]),sortKey:0,state:ai}),P.onlyIcons||gt.push({segments:So?Ft.text.segments:new i.bd([]),sortKey:0,state:Ao})}wt&&gt.sort((At,zt)=>At.sortKey-zt.sortKey);for(const At of gt){const zt=At.state;if(zt)if(m.terrain?m.terrain.setupElevationDraw(zt.tile,zt.program,{useDepthForOcclusion:Ie.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:zt.labelPlaneMatrixInv}):m.setupDepthForOcclusion(Ie.depthOcclusionForSymbolsAndCircles,zt.program),ke.activeTexture.set(Re.TEXTURE0),zt.atlasTexture&&zt.atlasTexture.bind(zt.atlasInterpolation,Re.CLAMP_TO_EDGE,!0),zt.atlasTextureIcon&&(ke.activeTexture.set(Re.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,Re.CLAMP_TO_EDGE,!0)),zt.renderWithShadows&&m.shadowRenderer.setupShadows(zt.tile.tileID.toUnwrapped(),zt.program,"vector-tile",zt.tile.tileID.overscaledZ),m.uploadCommonLightUniforms(m.context,zt.program),zt.hasHalo){const Ft=zt.uniformValues;Ft.u_is_halo=1,Tx(zt.buffers,At.segments,h,m,zt.program,zt.depthMode,w,S,Ft,2),Ft.u_is_halo=0}else{if(zt.isSDF){const Ft=zt.uniformValues;zt.hasHalo&&(Ft.u_is_halo=1,Tx(zt.buffers,At.segments,h,m,zt.program,zt.depthMode,w,S,Ft,1)),Ft.u_is_halo=0}Tx(zt.buffers,At.segments,h,m,zt.program,zt.depthMode,w,S,zt.uniformValues,1)}}}function Tx(m,s,h,g,w,S,P,M,D,j){const W=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];w.draw(g,g.context.gl.TRIANGLES,S,P,M,Fn.disabled,D,h.id,m.layoutVertexBuffer,m.indexBuffer,s,h.paint,g.transform.zoom,m.programConfigurations.get(h.id),W,j)}function qf(m,s){const h=1<<m.canonical.z,g=(s.x*h-m.canonical.x-m.wrap*h)*i.aj,w=(s.y*h-m.canonical.y)*i.aj,S=i.dS(s.z,s.y);return i.cS(g,w,S)}function Jm(m,s,h,g,w){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const S=m.context.gl,P=new nn(m.context.gl.LEQUAL,nn.ReadWrite,m.depthRangeFor3D),M=new nn(m.context.gl.GREATER,nn.ReadWrite,m.depthRangeFor3D),D=function(ee){const se=i.cJ(ee.pitch);let oe=.01;return ee.isOrthographic&&(oe=i.ai(1e-4,oe,i.cO(se>=$c?1:se/$c))),2*oe}(m.transform),j=m.transform.getFreeCameraOptions().position,W="elevatedStructuresDepthReconstruct",K=m.getOrCreateProgram(W,{defines:["DEPTH_RECONSTRUCTION"]}),Z=m.getOrCreateProgram(W);for(const ee of g){const se=s.getTile(ee),oe=se.getBucket(h);if(!oe)continue;const he=oe.elevatedStructures;if(!he)continue;const le=oe.elevationBufferData.heightRange,xe=qf(ee.toUnwrapped(),j),Te=m.translatePosMatrix(ee.projMatrix,se,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));let Pe,ze,ke,Re;if(w==="initialize"){if(!le||le.min>=1||he.depthSegments.segments[0].primitiveLength===0)continue;Pe=Xm(Te,xe,D,1,0),ze=P,ke=he.depthSegments,Re=K}else if(w==="reset"){if(!le||le.min>=0||he.maskSegments.segments[0].primitiveLength===0)continue;Pe=Xm(Te,xe,0,0,1),ze=M,ke=he.maskSegments,Re=K}else if(w==="geometry"){if(he.depthSegments.segments[0].primitiveLength===0)continue;Pe=Xm(Te,xe,D,1,0),ze=P,ke=he.depthSegments,Re=Z}Re.draw(m,S.TRIANGLES,ze,Un.disabled,ar.disabled,Fn.disabled,Pe,h.id,he.vertexBuffer,he.indexBuffer,ke,h.paint,m.transform.zoom)}}function dn(m,s,h){const{painter:g,sourceCache:w,layer:S,coords:P,colorMode:M,elevationType:D,terrainEnabled:j,pass:W}=m,K=g.context.gl,Z=S.paint.get("fill-pattern"),ee=S.paint.get("fill-pattern-cross-fade"),se=Z.constantOr(null);let oe=D;D!=="road"||s&&!j||(oe="none");const he=oe==="road",le=m.painter.shadowRenderer,xe=he&&!!le&&le.enabled,Te=new nn(g.context.gl.LEQUAL,nn.ReadOnly,g.depthRangeFor3D);let Pe=[0,0,0];if(xe){const Re=g.style.directionalLight,Ie=g.style.ambientLight;Re&&Ie&&(Pe=ll(g.style,Re,Ie))}const ze=Z&&Z.constantOr(1),ke=(Re,Ie)=>{let Ve,Ge,ht,et,Et;Ie?(Ve=ze&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ht=K.LINES):(Ve=ze?"fillPattern":"fill",ht=K.TRIANGLES);for(const wt of P){const qt=w.getTile(wt);if(ze&&!qt.patternsLoaded())continue;const tt=qt.getBucket(S);if(!tt)continue;const dt=s?tt.elevationBufferData:tt.bufferData;if(dt.isEmpty())continue;g.prepareDrawTile();const Je=dt.programConfigurations.get(S.id),It=g.isTileAffectedByFog(wt),gt=[],Lt=[];he&&(gt.push("ELEVATED_ROADS"),Lt.push(dt.elevatedLayoutVertexBuffer)),xe&&gt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ze&&(g.context.activeTexture.set(K.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Je.updatePaintBuffers());let At=!1;if(se&&qt.imageAtlas){const fn=qt.imageAtlas,Pn=i.dN.from(se),yn=Pn.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Nn=Pn.getSecondary(),Xn=fn.patternPositions.get(yn),yr=Nn?fn.patternPositions.get(Nn.scaleSelf(i.q.devicePixelRatio).toString()):null;At=!!Xn&&!!yr,Xn&&Je.setConstantPatternPositions(Xn,yr)}ee>0&&(At||Je.getPatternTransitionVertexBuffer("fill-pattern"))&&gt.push("FILL_PATTERN_TRANSITION");const zt=g.getOrCreateProgram(Ve,{config:Je,overrideFog:It,defines:gt}),Ft=g.translatePosMatrix(wt.projMatrix,qt,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));xe&&le.setupShadows(qt.tileID.toUnwrapped(),zt,"vector-tile",qt.tileID.overscaledZ);const gn=S.paint.get("fill-emissive-strength");if(Ie){et=dt.lineIndexBuffer,Et=dt.lineSegments;const fn=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[K.drawingBufferWidth,K.drawingBufferHeight];Ge=Ve==="fillOutlinePattern"&&ze?rM(Ft,gn,g,qt,fn,Pe,ee):nM(Ft,gn,fn,Pe)}else et=dt.indexBuffer,Et=dt.triangleSegments,Ge=ze?KS(Ft,gn,g,qt,Pe,ee):XS(Ft,gn,Pe);g.uploadCommonUniforms(g.context,zt,wt.toUnwrapped());let En=Re;(D==="road"&&!j||D==="offset")&&(En=Te),zt.draw(g,ht,En,h||g.stencilModeForClipping(wt),M,Fn.disabled,Ge,S.id,dt.layoutVertexBuffer,et,Et,S.paint,g.transform.zoom,Je,Lt)}};g.renderPass===W&&ke(g.depthModeForSublayer(1,g.renderPass==="opaque"?nn.ReadWrite:nn.ReadOnly),!1),oe==="none"&&g.renderPass==="translucent"&&S.paint.get("fill-antialias")&&ke(g.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,nn.ReadOnly),!0)}function Qm(m,s,h,g,w,S,P,M){h.resetLayerRenderingStats(m);const D=m.context,j=D.gl,W=m.transform,K=h.paint.get("fill-extrusion-pattern"),Z=h.paint.get("fill-extrusion-pattern-cross-fade"),ee=K.constantOr(null),se=K.constantOr(1),oe=h.paint.get("fill-extrusion-opacity"),he=m.style.enable3dLights(),le=h.paint.get(he&&!se?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),xe=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),le],Te=h.layout.get("fill-extrusion-edge-radius"),Pe=Te>0&&!h.paint.get("fill-extrusion-rounded-roof"),ze=Pe?0:Te,ke=W.projection.name==="globe"?i.dT():0,Re=W.projection.name==="globe",Ie=Re?i.ah(W.zoom):0,Ve=[i.ay(W.center.lng),i.aH(W.center.lat)],Ge=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ht=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ge?null:h.lut).toArray01().slice(0,3),et=h.paint.get("fill-extrusion-flood-light-intensity"),Et=h.paint.get("fill-extrusion-vertical-scale"),wt=h.paint.get("fill-extrusion-line-width").constantOr(1)!==0,qt=h.paint.get("fill-extrusion-height-alignment"),tt=h.paint.get("fill-extrusion-base-alignment"),dt=Eu(m,h.paint.get("fill-extrusion-cutoff-fade-range")),Je=[];let It;Re&&Je.push("PROJECTION_GLOBE_VIEW"),xe[0]>0&&Je.push("FAUX_AO"),Pe&&Je.push("ZERO_ROOF_RADIUS"),M&&Je.push("HAS_CENTROID"),et>0&&Je.push("FLOOD_LIGHT"),dt.shouldRenderCutoff&&Je.push("RENDER_CUTOFF"),wt&&Je.push("RENDER_WALL_MODE");const gt=m.renderPass==="shadow",Lt=m.shadowRenderer,At=gt&&!!Lt,zt=gt?Fn.disabled:Fn.backCCW;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let Ft=[0,0,0];if(Lt){const fn=m.style.directionalLight,Pn=m.style.ambientLight;fn&&Pn&&(Ft=ll(m.style,fn,Pn)),gt||(Je.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Lt.useNormalOffset&&Je.push("NORMAL_OFFSET")),It=Je.concat(["SHADOWS_SINGLE_CASCADE"])}const gn=At?"fillExtrusionDepth":se?"fillExtrusionPattern":"fillExtrusion",En=h.getLayerRenderingStats();for(const fn of g){const Pn=s.getTile(fn),yn=Pn.getBucket(h);if(!yn||yn.projection.name!==W.projection.name)continue;let Nn=!1;Lt&&(Nn=Lt.getMaxCascadeForTile(fn.toUnwrapped())===0);const Xn=m.isTileAffectedByFog(fn),yr=yn.programConfigurations.get(h.id);let oi=!1;if(ee&&Pn.imageAtlas){const Lr=Pn.imageAtlas,ai=i.dN.from(ee),Ao=ai.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),oo=ai.getSecondary(),So=Lr.patternPositions.get(Ao),ji=oo?Lr.patternPositions.get(oo.scaleSelf(i.q.devicePixelRatio).toString()):null;oi=!!So&&!!ji,So&&yr.setConstantPatternPositions(So,ji)}Z>0&&(oi||yr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Je.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Qr=m.getOrCreateProgram(gn,{config:yr,defines:Nn?It:Je,overrideFog:Xn});if(m.terrain&&m.terrain.setupElevationDraw(Pn,Qr,{useMeterToDem:!0}),!yn.centroidVertexBuffer){const Lr=Qr.attributes.a_centroid_pos;Lr!==void 0&&j.vertexAttrib2f(Lr,0,0)}!gt&&Lt&&Lt.setupShadows(Pn.tileID.toUnwrapped(),Qr,"vector-tile",Pn.tileID.overscaledZ),se&&(m.context.activeTexture.set(j.TEXTURE0),Pn.imageAtlasTexture&&Pn.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),yr.updatePaintBuffers());const br=h.paint.get("fill-extrusion-vertical-gradient"),Ji=1/yn.tileToMeter;let Hi;if(gt&&Lt){if(aM(Pn.tileID,yn,m))continue;const Lr=Lt.calculateShadowPassMatrixFromTile(Pn.tileID.toUnwrapped());Hi=eM(Lr,ze,Ji,Et,qt,tt)}else{const Lr=m.translatePosMatrix(fn.expandedProjMatrix,Pn,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ai=W.projection.createInversionMatrix(W,fn.canonical);Hi=se?tM(Lr,m,br,oe,xe,ze,Ji,fn,Pn,ke,qt,tt,Ie,Ve,ai,ht,Et,Z):Td(Lr,m,br,oe,xe,ze,Ji,fn,ke,qt,tt,Ie,Ve,ai,ht,Et,et,Ft)}m.uploadCommonUniforms(D,Qr,fn.toUnwrapped(),null,dt);let tr=yn.segments;if(W.projection.name==="mercator"&&!gt&&(tr=yn.getVisibleSegments(Pn.tileID,m.terrain,m.transform.getFrustum(0)),!tr.get().length))continue;if(En)if(gt)for(const Lr of tr.get())En.numRenderedVerticesInShadowPass+=Lr.primitiveLength;else for(const Lr of tr.get())En.numRenderedVerticesInTransparentPass+=Lr.primitiveLength;const Mr=[];(m.terrain||M)&&Mr.push(yn.centroidVertexBuffer),Re&&Mr.push(yn.layoutVertexExtBuffer),wt&&Mr.push(yn.wallVertexBuffer),Qr.draw(m,D.gl.TRIANGLES,w,S,P,zt,Hi,h.id,yn.layoutVertexBuffer,yn.indexBuffer,tr,h.paint,m.transform.zoom,yr,Mr)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Cd(m,s,h,g,w,S,P,M,D,j,W,K,Z,ee,se,oe,he,le,xe){const Te=m.context,Pe=Te.gl,ze=m.transform,ke=m.transform.zoom,Re=[],Ie=Eu(m,h.paint.get("fill-extrusion-cutoff-fade-range"));j==="clear"?(Re.push("CLEAR_SUBPASS"),xe&&(Re.push("CLEAR_FROM_TEXTURE"),Te.activeTexture.set(Pe.TEXTURE0),xe.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE))):j==="sdf"&&Re.push("SDF_SUBPASS"),he&&Re.push("HAS_CENTROID"),Ie.shouldRenderCutoff&&Re.push("RENDER_CUTOFF");const Ve=h.layout.get("fill-extrusion-edge-radius"),Ge=(ht,et,Et,wt,qt)=>{const tt=et.programConfigurations.get(h.id),dt=m.isTileAffectedByFog(ht),Je=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:tt,defines:Re,overrideFog:dt}),It=((Lt,At,zt,Ft,gn,En,fn,Pn,yn,Nn,Xn)=>({u_matrix:At,u_opacity:zt,u_ao_pass:Ft?1:0,u_meter_to_tile:gn,u_ao:En,u_flood_light_intensity:fn,u_flood_light_color:Pn,u_attenuation:yn,u_edge_radius:Nn,u_fb:0,u_fb_size:Xn,u_dynamic_offset:1}))(0,wt,W,D,qt,[K,Z*qt],ee,se,oe,ke>=17?0:Ve*qt,xe?xe.size[0]:0),gt=[];he&&gt.push(et.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(Te,Je,ht.toUnwrapped(),null,Ie),Je.draw(m,Te.gl.TRIANGLES,w,S,P,M,It,h.id,et.vertexBuffer,et.indexBuffer,Et,h.paint,ke,tt,gt)};for(const ht of g){const et=s.getTile(ht),Et=et.getBucket(h);if(!Et||Et.projection.name!==ze.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;const wt=Et.groundEffect,qt=1/Et.tileToMeter;{const tt=m.translatePosMatrix(ht.projMatrix,et,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),dt=wt.getDefaultSegment();Ge(ht,wt,dt,tt,qt)}if(le)for(let tt=0;tt<4;tt++){const dt=i.dU[tt](ht),Je=s.getTile(dt);if(!Je)continue;const It=Je.getBucket(h);if(!It||It.projection.name!==ze.projection.name||!It.groundEffect||It.groundEffect&&!It.groundEffect.hasData())continue;const gt=It.groundEffect;let Lt,At;tt===0?(Lt=[-i.aj,0,0],At=1):tt===1?(Lt=[i.aj,0,0],At=0):tt===2?(Lt=[0,-i.aj,0],At=3):(Lt=[0,i.aj,0],At=2);const zt=gt.regionSegments[At];if(!zt)continue;const Ft=new Float32Array(16);i.bo(Ft,ht.projMatrix,Lt),Ge(ht,gt,zt,m.translatePosMatrix(Ft,et,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),qt)}}}function Mh(m,s,h,g,w,S,P){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const M=S?S.findDEMTileFor(h):null;if(!(M&&M.dem||P))return;S&&M&&M.dem&&g.selfDEMTileTimestamp!==M.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=M.dem._timestamp);const D=le=>new i.P(Math.ceil((le+i.dX)*i.dY),0),j=le=>{const xe=s.getSource().minzoom,Te=ze=>{const ke=s.getTileByID(ze);if(ke&&ke.hasData())return ke.getBucket(w)},Pe=[0,-1,1];for(const ze of Pe){if(le.overscaledZ+ze<xe)continue;const ke=Te(le.calculateScaledKey(le.overscaledZ+ze));if(ke)return ke}},W=[0,0,0],K=(le,xe)=>(W[0]=Math.min(le.min.y,xe.min.y),W[1]=Math.max(le.max.y,xe.max.y),W[2]=i.aj-xe.min.x>le.max.x?xe.min.x-i.aj:le.max.x,W),Z=(le,xe)=>(W[0]=Math.min(le.min.x,xe.min.x),W[1]=Math.max(le.max.x,xe.max.x),W[2]=i.aj-xe.min.y>le.max.y?xe.min.y-i.aj:le.max.y,W),ee=[(le,xe)=>K(le,xe),(le,xe)=>K(xe,le),(le,xe)=>Z(le,xe),(le,xe)=>Z(xe,le)],se=(le,xe,Te,Pe,ze,ke,Re)=>{if(!S)return 0;const Ie=[[ke?Te:le,ke?le:Te,0],[ke?Te:xe,ke?xe:Te,0]],Ve=Re<0?i.aj+Re:Re,Ge=[ke?Ve:(le+xe)/2,ke?(le+xe)/2:Ve,0];return Te===0&&Re<0||Te!==0&&Re>0?S.getForTilePoints(ze,[Ge],!0,Pe):Ie.push(Ge),S.getForTilePoints(h,Ie,!0,M),Math.max(Ie[0][2],Ie[1][2],Ge[2])/S.exaggeration()};for(let le=0;le<4;le++){const xe=g.borderFeatureIndices[le];if(xe.length===0)continue;const Te=i.dU[le](h),Pe=j(Te);if(!(Pe&&Pe instanceof i.dV))continue;const ze=S?S.findDEMTileFor(Te):null;if(!(ze&&ze.dem||P)||(S&&ze&&ze.dem&&g.borderDEMTileTimestamp[le]!==ze.dem._timestamp&&(g.borderDoneWithNeighborZ[le]=-1,g.borderDEMTileTimestamp[le]=ze.dem._timestamp),g.borderDoneWithNeighborZ[le]===Pe.canonical.z))continue;Pe.centroidVertexArray.length===0&&Pe.createCentroidsBuffer();const ke=(le<2?1:5)-le,Re=Pe.borderDoneWithNeighborZ[ke]!==g.canonical.z,Ie=Pe.borderFeatureIndices[ke];let Ve=0;if(g.canonical.z!==Pe.canonical.z){for(const Ge of xe)g.showCentroid(g.featuresOnBorder[Ge]);if(Re)for(const Ge of Ie)Pe.showCentroid(Pe.featuresOnBorder[Ge]);g.borderDoneWithNeighborZ[le]=Pe.canonical.z,Pe.borderDoneWithNeighborZ[ke]=g.canonical.z}for(const Ge of xe){const ht=g.featuresOnBorder[Ge],et=g.centroidData[ht.centroidDataIndex],Et=ht.borders[le];let wt;for(;Ve<Ie.length;){wt=Pe.featuresOnBorder[Ie[Ve]];const qt=wt.borders[ke];if(qt[1]>Et[0]+3||qt[0]>Et[0]-3)break;Pe.showCentroid(wt),Ve++}if(wt&&Ve<Ie.length){const qt=Ve;let tt=0;for(;!(wt.borders[ke][0]>Et[1]-3)&&(tt++,++Ve!==Ie.length);)wt=Pe.featuresOnBorder[Ie[Ve]];wt=Pe.featuresOnBorder[Ie[qt]];let dt=!1;if(tt>=1){const gt=wt.borders[ke];Math.abs(Et[0]-gt[0])<3&&Math.abs(Et[1]-gt[1])<3&&(tt=1,dt=!0,Ve=qt+1)}else if(tt===0){g.showCentroid(ht);continue}const Je=Pe.centroidData[wt.centroidDataIndex];P&&dt&&(((oe=et).flags|(he=Je).flags)&i.dW?(oe.flags|=i.dW,he.flags|=i.dW):(oe.flags&=~i.dW,he.flags&=~i.dW));const It=ht.intersectsCount()>1||wt.intersectsCount()>1;if(tt>1)Ve=qt,et.centroidXY=Je.centroidXY=new i.P(0,0);else if(ze&&ze.dem&&!It){const gt=ee[le](et,Je),Lt=le%2?i.aj-1:0,At=se(gt[0],Math.min(i.aj-1,gt[1]),Lt,ze,Te,le<2,gt[2]);et.centroidXY=Je.centroidXY=D(At)}else It?et.centroidXY=Je.centroidXY=new i.P(0,0):(et.centroidXY=g.encodeBorderCentroid(ht),Je.centroidXY=Pe.encodeBorderCentroid(wt));g.writeCentroidToBuffer(et),Pe.writeCentroidToBuffer(Je)}else g.showCentroid(ht)}g.borderDoneWithNeighborZ[le]=Pe.canonical.z,Pe.borderDoneWithNeighborZ[ke]=g.canonical.z}var oe,he;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}const Oh=[1,0,0],Ln=[0,1,0],Ex=[0,0,1];function aM(m,s,h){const g=h.transform,w=h.shadowRenderer;if(!w)return!0;const S=m.toUnwrapped(),P=g.tileSize*w._cascades[h.currentShadowCascade].scale;let M=s.maxHeight;if(g.elevation){const oe=g.elevation.getMinMaxForTile(m);oe&&(M+=oe.max)}const D=[...w.shadowDirection];D[2]=-D[2];const j=w.computeSimplifiedTileShadowVolume(S,M,P,D);if(!j)return!1;const W=[Oh,Ln,Ex,D,[D[0],0,D[2]],[0,D[1],D[2]]],K=g.projection.name==="globe",Z=g.scaleZoom(P),ee=i.cn.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,Z,!K),se=w.getCurrentCascadeFrustum();return ee.intersectsPrecise(j.vertices,j.planes,W)===0||se.intersectsPrecise(j.vertices,j.planes,W)===0}function iT(m){return[m[0]*i.dZ,m[1]*i.dZ,m[2]*i.dZ,0]}function eg(m,s,h,g,w,S,P,M,D){const j=g.getSource(),W=h.globeSharedBuffers;if(!W)return;let K,Z,ee;if(s&&(K=g.getTile(s)),j instanceof i.aP?(Z=j.texture,ee=i.ds(0,0,h.transform)):K&&s&&(Z=K.texture,ee=i.ds(s.canonical.z,s.canonical.x,h.transform)),!Z||!ee)return;m||(ee=i.cE(i.bz(),ee,[1,-1,1]));const se=h.context,oe=se.gl,he=w.paint.get("raster-resampling")==="nearest"?oe.NEAREST:oe.LINEAR,le=h.colorModeForDrapableLayerRenderPass(S),xe=P.defines;xe.push("GLOBE_POLES");const Te=new nn(oe.LEQUAL,nn.ReadWrite,h.depthRangeFor3D),Pe=Float32Array.from(h.transform.expandedFarZProjMatrix),ze=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),se.activeTexture.set(oe.TEXTURE0),Z.bind(he,oe.CLAMP_TO_EDGE),se.activeTexture.set(oe.TEXTURE1),Z.bind(he,oe.CLAMP_TO_EDGE),"useMipmap"in Z&&se.extTextureFilterAnisotropic&&h.transform.pitch>20&&oe.texParameterf(oe.TEXTURE_2D,se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,se.extTextureFilterAnisotropicMax);const[ke,Re,Ie,Ve]=s?W.getPoleBuffers(s.canonical.z,!1):W.getPoleBuffers(0,!0),Ge=w.paint.get("raster-elevation");let ht;m?(ht=ke,h.renderDefaultNorthPole=Ge!==0):(ht=Re,h.renderDefaultSouthPole=Ge!==0);const et=iT(P.mix),Et=((qt,tt,dt,Je,It,gt,Lt,At,zt,Ft,gn,En,fn)=>Ih(qt,tt,dt,new Float32Array(16),new Float32Array(9),[0,0],Je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},gt,[0,0],At,2,Ft,gn,En,1,0,fn))(Pe,ze,ee,i.ah(h.transform.zoom),0,w,0,Ge,0,et,P.offset,P.range,S),wt=h.getOrCreateProgram("raster",{defines:xe});h.uploadCommonUniforms(se,wt,null),wt.draw(h,oe.TRIANGLES,Te,D,le,M,Et,w.id,ht,Ie,Ve)}function oT(m){const s=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-s,w=.2*m.height,S=s+w;return[s,h,(S-w-s)/g,(S-s)/g]}function sM(m,s,h,g){if(m)return s instanceof Il&&m instanceof yu?s.getTextureDescriptor(m,h,!0):{texture:m.texture,mix:iT(g.mix),offset:g.offset,buffer:0,tileSize:1}}var aT=i.d_([{name:"a_index",type:"Int16",components:1}]);class lM{constructor(s,h,g,w){const S={width:g[0],height:g[1],data:null},P=s.gl;this.targetColorTexture=new i.T(s,S,P.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,S,P.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(h,w),this.lastInvalidatedAt=0}updateParticleTexture(s,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,w=h.width*h.height;this.particleTexture0=new i.T(this.context,h,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,h,g.RGBA8,{premultiply:!1,useMipmap:!1});const S=new i.d$;S.reserve(w);for(let P=0;P<w;P++)S.emplaceBack(P);this.particleIndexBuffer=this.context.createVertexBuffer(S,aT.members,!0),this.particleSegment=i.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function cM(m,s,h){if(!m)return null;const g=s.getTextureDescriptor(m,h,!0);if(!g)return null;let{texture:w,mix:S,offset:P,tileSize:M,buffer:D,format:j}=g;if(!w||!j)return null;let W=!1;return j==="uint32"&&(W=!0,S[3]=0,S=vx(i.e0,S,[0,h.paint.get("raster-particle-max-speed")]),P=Y_(i.e0,P,[0,h.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[D/(M+2*D),M/(M+2*D)],tileSize:M,scalarData:W,scale:S,offset:P,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[j]]}}function Ax(m){const s=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-s,w=.2*m.height,S=s+w;return[s,h,(S-w-s)/g,(S-s)/g]}const Px=new i.am(1,0,0,1),Cx=new i.am(0,1,0,1),Ix=new i.am(0,0,1,1),Us=new i.am(1,0,1,1),kh=new i.am(0,1,1,1);function Id(m,s,h,g,w,S,P){const M=m.context,D=m.transform,j=M.gl,W=D.projection.name==="globe",K=W?["PROJECTION_GLOBE_VIEW"]:[];let Z=i.bw(h.projMatrix);if(W&&i.ah(D.zoom)>0){const et=i.bg(h.canonical,D),Et=i.e1(et);Z=i.az(new Float32Array(16),D.globeMatrix,Et),i.az(Z,D.projMatrix,Z)}const ee=i.bz();ee[12]+=2*w/(i.q.devicePixelRatio*D.width),ee[13]+=2*S/(i.q.devicePixelRatio*D.height),i.az(Z,ee,Z);const se=m.getOrCreateProgram("debug",{defines:K}),oe=s.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(oe,se);const he=nn.disabled,le=Un.disabled,xe=m.colorModeForRenderPass(),Te="$debug";M.activeTexture.set(j.TEXTURE0),m.emptyTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),W?oe._makeGlobeTileDebugBuffers(m.context,D):oe._makeDebugTileBoundsBuffers(m.context,D.projection);const Pe=oe._tileDebugBuffer||m.debugBuffer,ze=oe._tileDebugIndexBuffer||m.debugIndexBuffer,ke=oe._tileDebugSegments||m.debugSegments;if(se.draw(m,j.LINE_STRIP,he,le,xe,Fn.disabled,Ed(Z,g),Te,Pe,ze,ke,null,null,null,[oe._globeTileDebugBorderBuffer]),P){const et=oe.latestRawTileData,Et=Math.floor((et&&et.byteLength||0)/1024);let wt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(wt+=` => ${h.overscaledZ}`),wt+=` ${oe.state}`,wt+=` ${Et}kb`,function(qt,tt){qt.initDebugOverlayCanvas();const dt=qt.debugOverlayCanvas,Je=qt.context.gl,It=qt.debugOverlayCanvas.getContext("2d");It.clearRect(0,0,dt.width,dt.height),It.shadowColor="white",It.shadowBlur=2,It.lineWidth=1.5,It.strokeStyle="white",It.textBaseline="top",It.font="bold 36px Open Sans, sans-serif",It.fillText(tt,5,5),It.strokeText(tt,5,5),qt.debugOverlayTexture.update(dt),qt.debugOverlayTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE)}(m,wt)}const Re=s.getTile(h).tileSize,Ie=512/Math.min(Re,512)*(h.overscaledZ/D.zoom)*.5,Ve=oe._tileDebugTextBuffer||m.debugBuffer,Ge=oe._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,ht=oe._tileDebugTextSegments||m.debugSegments;se.draw(m,j.TRIANGLES,he,le,ar.alphaBlended,Fn.disabled,Ed(Z,i.am.transparent,Ie),Te,Ve,Ge,ht,null,null,null,[oe._globeTileDebugTextBuffer])}function oy(m,s,h,g){Zf(m,0,s+h/2,m.transform.width,h,g)}function ay(m,s,h,g){Zf(m,s-h/2,0,h,m.transform.height,g)}function Zf(m,s,h,g,w,S){const P=m.context,M=P.gl;M.enable(M.SCISSOR_TEST),M.scissor(s*i.q.devicePixelRatio,h*i.q.devicePixelRatio,g*i.q.devicePixelRatio,w*i.q.devicePixelRatio),P.clear({color:S}),M.disable(M.SCISSOR_TEST)}const sT=i.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:zl}=sT;function ii(m,s,h,g){m.emplaceBack(s,h,g)}class tg{constructor(s){this.vertexArray=new i.e2,this.indices=new i.a_,ii(this.vertexArray,-1,-1,1),ii(this.vertexArray,1,-1,1),ii(this.vertexArray,-1,1,1),ii(this.vertexArray,1,1,1),ii(this.vertexArray,-1,-1,-1),ii(this.vertexArray,1,-1,-1),ii(this.vertexArray,-1,1,-1),ii(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,zl),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.bd.simpleSegment(0,0,36,12)}}function Rh(m,s,h,g,w,S){const P=m.context.gl,M=s.paint.get("sky-atmosphere-color"),D=s.paint.get("sky-atmosphere-halo-color"),j=s.paint.get("sky-atmosphere-sun-intensity"),W=((K,Z,ee,se,oe)=>({u_matrix_3f:K,u_sun_direction:Z,u_sun_intensity:ee,u_color_tint_r:[se.r,se.g,se.b,se.a],u_color_tint_m:[oe.r,oe.g,oe.b,oe.a],u_luminance:5e-5}))(i.e4(i.dx(),g),w,j,M,D);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+S,s.skyboxTexture,0),h.draw(m,P.TRIANGLES,nn.disabled,Un.disabled,ar.unblended,Fn.frontCW,W,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const lT=i.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class cT{constructor(s){const h=new i.e5;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const g=new i.a_;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(h,lT.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=i.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const uT=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class uM{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Xf{constructor(s){this.colorModeAlphaBlendedWriteRGB=new ar([1,Ra,1,Ra],i.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ar([1,0,1,0],i.am.transparent,[!1,!1,!1,!0]),this.params=new uM,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const h=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new cT(h);const g=this.params.sizeRange,w=this.params.intensityRange,S=function(W){const K=i.ea(30),Z=[];for(let ee=0;ee<W;++ee){const se=2*Math.PI*K(),oe=Math.acos(1-2*K())-.5*Math.PI;Z.push(i.cS(Math.cos(oe)*Math.cos(se),Math.cos(oe)*Math.sin(se),Math.sin(oe)))}return Z}(this.params.starsCount),P=i.ea(300),M=new i.e6,D=new i.a_;let j=0;for(let W=0;W<S.length;++W){const K=i.b$([],S[W],200),Z=Math.max(0,1+.01*g*(1*P()-.5)),ee=Math.max(0,1+.01*w*(1*P()-.5));M.emplaceBack(K[0],K[1],K[2],-1,-1,Z,ee),M.emplaceBack(K[0],K[1],K[2],1,-1,Z,ee),M.emplaceBack(K[0],K[1],K[2],1,1,Z,ee),M.emplaceBack(K[0],K[1],K[2],-1,1,Z,ee),D.emplaceBack(j+0,j+1,j+2),D.emplaceBack(j+0,j+2,j+3),j+=4}this.starsVx=h.createVertexBuffer(M,uT.members),this.starsIdx=h.createIndexBuffer(D),this.starsSegments=i.bd.simpleSegment(0,0,M.length,D.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,h){const g=s.context,w=g.gl,S=s.transform,P=new nn(w.LEQUAL,nn.ReadOnly,[0,1]),M=i.ah(S.zoom),D=s.style.getLut(h.scope),j=h.properties.get("color-use-theme")==="none",W=h.properties.get("color").toRenderColor(j?null:D).toArray01(),K=h.properties.get("high-color-use-theme")==="none",Z=h.properties.get("high-color").toRenderColor(K?null:D).toArray01(),ee=h.properties.get("space-color-use-theme")==="none",se=h.properties.get("space-color").toRenderColor(ee?null:D).toArray01PremultipliedAlpha(),oe=5e-4,he=i.e7(h.properties.get("horizon-blend"),0,1,oe,.25),le=i.dl(s,g,S)&&he===oe?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,xe=s.frameCounter/1e3%1,Te=i.ae(S.globeCenterInViewSpace),Pe=Math.sqrt(Math.pow(Te,2)-Math.pow(le,2)),ze=Math.acos(Pe/Te),ke=Re=>{const Ie=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Re&&Ie.push("ALPHA_PASS");const Ve=s.getOrCreateProgram("globeAtmosphere",{defines:Ie}),Ge=((et,Et,wt,qt,tt,dt,Je,It,gt,Lt,At,zt)=>({u_frustum_tl:et,u_frustum_tr:Et,u_frustum_br:wt,u_frustum_bl:qt,u_horizon:tt,u_transition:dt,u_fadeout_range:Je,u_color:It,u_high_color:gt,u_space_color:Lt,u_temporal_offset:At,u_horizon_angle:zt}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,M,he,W,Z,se,xe,ze);s.uploadCommonUniforms(g,Ve);const ht=this.atmosphereBuffer;ht&&Ve.draw(s,w.TRIANGLES,P,Un.disabled,Re?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Fn.backCW,Ge,Re?"atmosphere_glow_alpha":"atmosphere_glow",ht.vertexBuffer,ht.indexBuffer,ht.segments)};ke(!1),ke(!0)}drawStars(s,h){const g=i.aD(h.properties.get("star-intensity"),0,1);if(g===0)return;const w=s.context,S=w.gl,P=s.transform,M=s.getOrCreateProgram("stars"),D=i.bY([]);i.b_(D,D,-P._pitch),i.bZ(D,D,-P.angle),i.b_(D,D,i.al(P._center.lat)),i.e8(D,D,-i.al(P._center.lng));const j=i.c3(new Float32Array(16),D),W=i.az([],P.starsProjMatrix,j),K=i.e4([],j),Z=i.e9([],K),ee=[0,1,0];i.dz(ee,ee,Z),i.b$(ee,ee,this.params.sizeMultiplier);const se=[1,0,0];i.dz(se,se,Z),i.b$(se,se,this.params.sizeMultiplier);const oe=(he=ee,le=se,xe=g,{u_matrix:Float32Array.from(W),u_up:he,u_right:le,u_intensity_multiplier:xe});var he,le,xe;s.uploadCommonUniforms(w,M),this.starsVx&&this.starsIdx&&M.draw(s,S.TRIANGLES,nn.disabled,Un.disabled,this.colorModeAlphaBlendedWriteRGB,Fn.disabled,oe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Md(m,s){const h=[...m],g=s.cameraWorldSizeForFog/s.worldSize,w=i.bx([]);return i.cE(w,w,[g,g,1]),i.az(h,w,h),i.az(h,s.worldToFogMatrix,h),h}function Zt(m,s,h,g,w){const S=h.material,P=g.context,{baseColorTexture:M,metallicRoughnessTexture:D}=S.pbrMetallicRoughness,{normalTexture:j,occlusionTexture:W,emissionTexture:K}=S;function Z(se,oe,he){if(se&&(m.push(oe),P.activeTexture.set(P.gl.TEXTURE0+he),se.gfxTexture)){const{minFilter:le,magFilter:xe,wrapS:Te,wrapT:Pe}=se.sampler;se.gfxTexture.bindExtraParam(le,xe,Te,Pe)}}Z(M,"HAS_TEXTURE_u_baseColorTexture",Eo.BaseColor),Z(D,"HAS_TEXTURE_u_metallicRoughnessTexture",Eo.MetallicRoughness),Z(j,"HAS_TEXTURE_u_normalTexture",Eo.Normal),Z(W,"HAS_TEXTURE_u_occlusionTexture",Eo.Occlusion),Z(K,"HAS_TEXTURE_u_emissionTexture",Eo.Emission),w&&(w.texture||(w.texture=new i.ed(g.context,w.image,[w.image.height,w.image.height,w.image.height],P.gl.RGBA8)),P.activeTexture.set(P.gl.TEXTURE0+Eo.LUT),w.texture&&w.texture.bind(P.gl.LINEAR,P.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(h.texcoordBuffer)),h.colorBuffer&&(m.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(h.colorBuffer)),h.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(h.normalBuffer)),h.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(h.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||m.push("DIFFUSE_SHADED");const ee=g.shadowRenderer;ee&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&m.push("NORMAL_OFFSET"))}function cn(m,s,h,g,w,S){const P=h.paint.get("model-opacity").constantOr(1),M=s.context,D=new nn(s.context.gl.LEQUAL,nn.ReadWrite,s.depthRangeFor3D),j=s.transform,W=m.mesh,K=W.material,Z=K.pbrMetallicRoughness,ee=s.style.fog;let se;se=s.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:i.az([],g.zScaleMatrix,m.nodeModelMatrix),i.az(se,g.negCameraPosMatrix,se);const oe=i.bi([],se);i.ee(oe,oe);const he=h.paint.get("model-color-use-theme").constantOr("default")==="none",le=h.paint.get("model-emissive-strength").constantOr(0),xe=Ad(new Float32Array(m.worldViewProjection),new Float32Array(se),new Float32Array(oe),null,s,P,Z.baseColorFactor.toRenderColor(null),K.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,K,le,h),Te={defines:[]},Pe=[],ze=s.shadowRenderer;ze&&(ze.useNormalOffset=!1),Zt(Te.defines,Pe,W,s,he?null:h.lut);let ke=null;if(ee){const Ve=Md(m.nodeModelMatrix,s.transform);if(ke=new Float32Array(Ve),j.projection.name!=="globe"){const Ge=W.aabb.min,ht=W.aabb.max,[et,Et]=ee.getOpacityForBounds(Ve,Ge[0],Ge[1],ht[0],ht[1]);Te.overrideFog=et>=an||Et>=an}}const Re=Eu(s,h.paint.get("model-cutoff-fade-range"));Re.shouldRenderCutoff&&Te.defines.push("RENDER_CUTOFF");const Ie=s.getOrCreateProgram("model",Te);s.uploadCommonUniforms(M,Ie,null,ke,Re),s.renderPass!=="shadow"&&ze&&ze.setupShadowsFromMatrix(m.nodeModelMatrix,Ie),Ie.draw(s,M.gl.TRIANGLES,D,w,S,W.material.doubleSided?Fn.disabled:Fn.backCCW,xe,h.id,W.vertexBuffer,W.indexBuffer,W.segments,h.paint,s.transform.zoom,void 0,Pe)}function Od(m,s,h,g,w,S,P){let M;M=m.projection.name==="globe"?i.ef(h,m):[...h],i.az(M,M,s.matrix);const D=i.az([],g,M);if(s.meshes)for(const j of s.meshes){if(j.material.alphaMode!=="BLEND"){P.push({mesh:j,depth:0,modelIndex:w,worldViewProjection:D,nodeModelMatrix:M});continue}const W=i.ad([],j.centroid,D);!m.isOrthographic&&W[2]<=0||S.push({mesh:j,depth:W[2],modelIndex:w,worldViewProjection:D,nodeModelMatrix:M})}if(s.children)for(const j of s.children)Od(m,j,h,g,w,S,P)}function io(m,s,h,g){const w=h.shadowRenderer;if(!w)return;const S=w.getShadowPassDepthMode(),P=w.getShadowPassColorMode(),M=w.calculateShadowPassMatrixFromMatrix(s),D=rT(M);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,S,Un.disabled,P,Fn.backCCW,D,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,h.transform.zoom,void 0,void 0)}function st(m,s,h){const g=s.updateZoomBasedPaintProperties(),w=function(S,P,M){let D,j,W,K=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&K>0){const Z=S.terrain,ee=Z.findDEMTileFor(M);ee&&ee.dem?D=i.el.create(Z,M,ee):K=0}if(K===0&&(P.terrainElevationMin=0,P.terrainElevationMax=0),K===P.validForExaggeration&&(K===0||D&&D._demTile&&D._demTile.tileID===P.validForDEMTile.id&&D._dem._timestamp===P.validForDEMTile.timestamp))return!1;for(const Z in P.instancesPerModel){const ee=P.instancesPerModel[Z];for(let se=0;se<ee.instancedDataArray.length;++se){const oe=(D?K*D.getElevationAt(0|ee.instancedDataArray.float32[16*se],0|ee.instancedDataArray.float32[16*se+1],!0,!0):0)+ee.instancesEvaluatedElevation[se];ee.instancedDataArray.float32[16*se+6]=oe,j=j?Math.min(P.terrainElevationMin,oe):oe,W=W?Math.max(P.terrainElevationMax,oe):oe}}return P.terrainElevationMin=j||0,P.terrainElevationMax=W||0,P.validForExaggeration=K,P.validForDEMTile=D&&D._demTile?{id:D._demTile.tileID,timestamp:D._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,s,h);(g||w)&&(s.uploaded=!1,s.upload(m.context))}const gc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cV([0,0,0],[i.aj,i.aj,0])};function sy(m,s){const h=1<<m.canonical.z,g=s.getFreeCameraOptions().position,w=s.elevation,S=m.canonical.x/h,P=(m.canonical.x+1)/h,M=m.canonical.y/h,D=(m.canonical.y+1)/h;let j=s._centerAltitude;if(w){const ee=w.getMinMaxForTile(m);ee&&ee.max>j&&(j=ee.max)}const W=i.aD(g.x,S,P)-g.x,K=i.aD(g.y,M,D)-g.y,Z=i.c6(j,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(W*W+K*K+Z*Z))}function ly(m,s,h,g,w,S,P){const M=m.context,D=m.renderPass==="shadow",j=m.shadowRenderer,W=D&&j?j.getShadowPassDepthMode():new nn(M.gl.LEQUAL,nn.ReadWrite,m.depthRangeFor3D),K=m.isTileAffectedByFog(S);if(h.meshes)for(const Z of h.meshes){const ee=["MODEL_POSITION_ON_GPU"],se=[];let oe,he,le;g.instancedDataArray.length>20&&ee.push("INSTANCED_ARRAYS");const xe=Eu(m,s.paint.get("model-cutoff-fade-range"));if(xe.shouldRenderCutoff&&ee.push("RENDER_CUTOFF"),D&&j)oe=m.getOrCreateProgram("modelDepth",{defines:ee}),he=rT(P.shadowTileMatrix,P.shadowTileMatrix,Float32Array.from(h.matrix)),le=j.getShadowPassColorMode();else{Zt(ee,se,Z,m,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),oe=m.getOrCreateProgram("model",{defines:ee,overrideFog:K});const Pe=Z.material,ze=Pe.pbrMetallicRoughness,ke=s.paint.get("model-opacity").constantOr(1),Re=s.paint.get("model-emissive-strength").constantOr(0);he=Ad(S.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,m,ke,ze.baseColorFactor.toRenderColor(null),Pe.emissiveFactor,ze.metallicFactor,ze.roughnessFactor,Pe,Re,s,w),j&&(P.shadowUniformsInitialized?oe.setShadowUniformValues(M,j.getShadowUniformValues()):(j.setupShadows(S.toUnwrapped(),oe,"model-tile",S.overscaledZ),P.shadowUniformsInitialized=!0)),le=xe.shouldRenderCutoff||ke<1||Pe.alphaMode!=="OPAQUE"?ar.alphaBlended:ar.unblended}m.uploadCommonUniforms(M,oe,S.toUnwrapped(),null,xe);const Te=Z.material.doubleSided?Fn.disabled:Fn.backCCW;if(g.instancedDataArray.length>20)se.push(g.instancedDataBuffer),oe.draw(m,M.gl.TRIANGLES,W,Un.disabled,le,Te,he,s.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,s.paint,m.transform.zoom,void 0,se,g.instancedDataArray.length);else{const Pe=D?"u_instance":"u_normal_matrix";for(let ze=0;ze<g.instancedDataArray.length;++ze)he[Pe]=new Float32Array(g.instancedDataArray.arrayBuffer,64*ze,16),oe.draw(m,M.gl.TRIANGLES,W,Un.disabled,le,Te,he,s.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,s.paint,m.transform.zoom,void 0,se)}}if(h.children)for(const Z of h.children)ly(m,s,Z,g,w,S,P)}const Mx=[1,-1,1];function hT(m,s,h,g){if(!h.modelManager)return!0;const w=h.modelManager;if(!h.shadowRenderer)return!0;const S=h.shadowRenderer,P=s.aabb;let M=!0,D=m.maxHeight;if(D===0){let W=0;for(const K in m.instancesPerModel){const Z=w.getModel(K,g);Z?W=Math.max(W,Math.max(Math.max(Z.aabb.max[0],Z.aabb.max[1]),Z.aabb.max[2])):M=!1}D=m.maxScale*W*1.41+m.maxVerticalOffset,M&&(m.maxHeight=D)}P.max[2]=D,P.min[2]+=m.terrainElevationMin,P.max[2]+=m.terrainElevationMax,i.ad(P.min,P.min,s.tileMatrix),i.ad(P.max,P.max,s.tileMatrix);const j=P.intersects(S.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=j===2),j===0}function dT(m,s){const h=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],w=m.uniformValues.u_cutoff_params[2],S=m.uniformValues.u_cutoff_params[3];return g===h||S===w?1:i.aD(((s-h)/(g-h)-w)/(S-w),0,1)}function Kf(m,s,h,g){if(s.pitch<20)return 1;const w=s.getWorldToCameraMatrix();i.az(w,w,m);const S=i.ei(h.min[0],h.min[1],h.min[2],1);let P=i.aA(i.ej(),S,w),M=P,D=P;S[1]=h.max[1],P=i.aA(i.ej(),S,w),M=P[1]<M[1]?P:M,D=P[1]>D[1]?P:D,S[0]=h.max[0],P=i.aA(i.ej(),S,w),M=P[1]<M[1]?P:M,D=P[1]>D[1]?P:D,S[1]=h.min[1],P=i.aA(i.ej(),S,w),M=P[1]<M[1]?P:M,D=P[1]>D[1]?P:D;const j=i.aD(g[0],0,1),W=100*s.pixelsPerMeter*i.aD(g[1],0,1),K=i.aD(g[2],0,1),Z=i.ek(i.ej(),M,D,j),ee=Math.tan(.5*s.fovX),se=-Z[2]*ee;if(W===0)return Z[1]<-Math.abs(se)?K:1;const oe=(-Math.abs(se)-Z[1])/W,he=(xe,Te,Pe)=>(1-Pe)*xe+Pe*Te,le=i.aD(he(1,K,oe),K,1);return he(1,le,i.aD((s.pitch-20)/20,0,1))}class hM{}class dM{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,h,g){{const K=this._storage.get(h.id);if(K)return K.lastUsedFrameIdx=s,K.buf}const w=g.gl,S=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),P=new ArrayBuffer(S),M=new Int16Array(P);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(P));const D=new i.en;for(let K=0;K<S/2;K+=3){const Z=M[K],ee=M[K+1],se=M[K+2];D.emplaceBack(Z,ee),D.emplaceBack(ee,se),D.emplaceBack(se,Z)}const j=g.bindVertexArrayOES.current,W=new hM;return W.buf=new Mu(g,D),W.lastUsedFrameIdx=s,this._storage.set(h.id,W),g.bindVertexArrayOES.set(j),W.buf}update(s){for(const[h,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(h))}destroy(){for(const[s,h]of this._storage)h.buf.destroy(),this._storage.delete(s)}}class fT{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const cy=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Ox{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class kx{constructor(s,h){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...h,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...h,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const pT=i.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class uy{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,h){const g=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const P=new i.eo,M=new i.a_;P.emplaceBack(-1,-1),P.emplaceBack(1,-1),P.emplaceBack(1,1),P.emplaceBack(-1,1),M.emplaceBack(0,1,2),M.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(P,pT.members),this.vignetteIdx=s.context.createIndexBuffer(M)}const w=i.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,g);const P={u_vignetteShape:(S={vignetteShape:[h.start,h.range,Math.pow(10,h.fadePower)],vignetteColor:[h.color.r,h.color.g,h.color.b,h.color.a*h.strength]}).vignetteShape,u_vignetteColor:S.vignetteColor};g.draw(s,s.context.gl.TRIANGLES,nn.disabled,Un.disabled,ar.alphaBlended,Fn.disabled,P,"vignette",this.vignetteVx,this.vignetteIdx,w)}var S}}class ng{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,h){const g=s.getFreeCameraOptions().position,w=g.toAltitude(),S=g.toLngLat(),P=i.al(S.lng),M=i.al(S.lat),D=s.pixelsPerMeter/h,j=P*i.eq,W=i.eq*Math.log(Math.tan(Math.PI/4+M/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const K=-this._offsetYPrev+W,Z=-this._elevationPrev+w;this._accumulatedOffsetX+=(-this._offsetXPrev+j)*D,this._accumulatedOffsetY+=K*D,this._accumulatedElevation+=Z*D,this._offsetXPrev=j,this._offsetYPrev=W,this._elevationPrev=w}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function kd(m,s){return[-(m[0]-Math.floor(m[0]/s)*s),-(m[1]-Math.floor(m[1]/s)*s),-(m[2]-Math.floor(m[2]/s)*s)]}function Rx(m){const s=i.ea(1323123451230),h=[];for(let g=0;g<m;++g){const w=2*s()-1,S=2*s()-1,P=2*s()-1;h.push(i.cS(w,S,P))}return h}function Dh(m,s,h,g,w){const S=i.aD((w-h)/(g-h),0,1);return(1-S)*m+S*s}class gs{constructor(s){this._movement=new ng,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new uy,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,h){const g=s.transform;this._movement.update(g,this._ppmScaleFactor);const w=g.starsProjMatrix,S=i.bY([]);i.b_(S,S,i.al(90)-g._pitch),i.bZ(S,S,-g.angle);const P=i.c3(new Float32Array(16),S),M=i.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),D=i.ee([],M),j=i.az([],D,P),W=Date.now()/1e3;return this._accumulatedTimeFromStart+=(W-this._prevTime)*h,this._prevTime=W,{projectionMatrix:w,modelviewMatrix:j}}}class fM extends gs{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new kx(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const g=Rx(this.particlesCount),w=new i.er,S=new i.a_;let P=0;const M=i.ea(1323123451230);for(let D=0;D<g.length;++D){const j=g[D],W=[2*M()-1,M(),M(),M()];w.emplaceBack(j[0],j[1],j[2],-1,-1,...W),w.emplaceBack(j[0],j[1],j[2],1,-1,...W),w.emplaceBack(j[0],j[1],j[2],1,1,...W),w.emplaceBack(j[0],j[1],j[2],-1,1,...W),S.emplaceBack(P+0,P+1,P+2),S.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=h.createVertexBuffer(w,cy.members),this.particlesIdx=h.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const h=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=s.transform.zoom;if(h.revealStart>g)return;const w=Dh(0,1,h.revealStart,h.revealStart+h.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const S=structuredClone(this._params);let P=[-S.direction.x,S.direction.y,-100];i.au(P,P);const M=structuredClone(this._vignetteParams);M.strength*=w,S.overrideStyleParameters||(S.intensity=s.style.rain.state.density,S.timeFactor=s.style.rain.state.intensity,S.color=structuredClone(s.style.rain.state.color),P=structuredClone(s.style.rain.state.direction),S.screenThinning.intensity=s.style.rain.state.centerThinning,S.dropletSizeX=s.style.rain.state.dropletSize[0],S.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],S.distortionStrength=100*s.style.rain.state.distortionStrength,M.strength=1,M.color=structuredClone(s.style.rain.state.vignetteColor));const D=this.updateOnRender(s,S.timeFactor),j=s.context,W=j.gl,K=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(j,{width:s.width,height:s.height,data:null},W.RGBA8)),S.distortionStrength>0&&(j.activeTexture.set(W.TEXTURE0),this.screenTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),W.copyTexSubImage2D(W.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const Z=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(j,Z),j.activeTexture.set(W.TEXTURE0),this.screenTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const ee=[S.color.r,S.color.g,S.color.b,S.color.a],se=(oe,he)=>{const le=kd(this._movement.getPosition(),oe),xe=S.dropletSizeX,Te=S.dropletSizeX*S.dropletSizeYScale,Pe=s.width/2,ze=s.height/2,ke=Dh(0,S.screenThinning.start,0,1,S.screenThinning.intensity),Re=Dh(.001,S.screenThinning.range,0,1,S.screenThinning.intensity),Ie=Dh(0,S.screenThinning.particleOffset,0,1,S.screenThinning.intensity),Ve=(Ge={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:le,velocityConeAperture:S.velocityConeAperture,velocity:S.velocity,boxSize:oe,rainDropletSize:[xe,Te],distortionStrength:S.distortionStrength,rainDirection:P,color:ee,screenSize:[K.width,K.height],thinningCenterPos:[Pe,ze],thinningShape:[ke,Re,Math.pow(10,S.screenThinning.fadePower)],thinningAffectedRatio:S.screenThinning.affectedRatio,thinningParticleOffset:Ie,shapeDirectionalPower:S.shapeDirPower,shapeNormalPower:S.shapeNormalPower,mode:he?0:1},{u_modelview:Float32Array.from(Ge.modelview),u_projection:Float32Array.from(Ge.projection),u_time:Ge.time,u_cam_pos:Ge.camPos,u_texScreen:0,u_velocityConeAperture:Ge.velocityConeAperture,u_velocity:Ge.velocity,u_boxSize:Ge.boxSize,u_rainDropletSize:Ge.rainDropletSize,u_distortionStrength:Ge.distortionStrength,u_rainDirection:Ge.rainDirection,u_color:Ge.color,u_screenSize:Ge.screenSize,u_thinningCenterPos:Ge.thinningCenterPos,u_thinningShape:Ge.thinningShape,u_thinningAffectedRatio:Ge.thinningAffectedRatio,u_thinningParticleOffset:Ge.thinningParticleOffset,u_shapeDirectionalPower:Ge.shapeDirectionalPower,u_shapeNormalPower:Ge.shapeNormalPower,u_mode:Ge.mode});var Ge;const ht=Math.round(S.intensity*this.particlesCount),et=i.bd.simpleSegment(0,0,4*ht,2*ht);Z.draw(s,W.TRIANGLES,nn.disabled,Un.disabled,ar.alphaBlended,Fn.disabled,Ve,"rain_particles",this.particlesVx,this.particlesIdx,et)};S.distortionStrength>0&&se(S.boxSize,!0),se(S.boxSize,!1),this._vignette.draw(s,M)}}const rg=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Bi extends gs{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new kx(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const g=Rx(this.particlesCount),w=new i.es,S=new i.a_;let P=0;const M=i.ea(1323123451230);for(let D=0;D<g.length;++D){const j=g[D],W=M(),K=M(),Z=M(),ee=[D/g.length,W,K,Z],se=[M(),M()];w.emplaceBack(j[0],j[1],j[2],-1,-1,...ee,...se),w.emplaceBack(j[0],j[1],j[2],1,-1,...ee,...se),w.emplaceBack(j[0],j[1],j[2],1,1,...ee,...se),w.emplaceBack(j[0],j[1],j[2],-1,1,...ee,...se),S.emplaceBack(P+0,P+1,P+2),S.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=h.createVertexBuffer(w,rg.members),this.particlesIdx=h.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const h=structuredClone(this._params);let g=[-h.direction.x,h.direction.y,-100];i.au(g,g);const w=structuredClone(this._vignetteParams),S=h.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},P=s.transform.zoom;if(S.revealStart>P)return;const M=Dh(0,1,S.revealStart,S.revealStart+S.revealRange,P);w.strength*=M,h.overrideStyleParameters||(h.intensity=s.style.snow.state.density,h.timeFactor=s.style.snow.state.intensity,h.color=structuredClone(s.style.snow.state.color),g=structuredClone(s.style.snow.state.direction),h.screenThinning.intensity=s.style.snow.state.centerThinning,h.billboardSize=2.79*s.style.snow.state.flakeSize,w.strength=1,w.color=structuredClone(s.style.snow.state.vignetteColor));const D=this.updateOnRender(s,h.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const j=s.context,W=j.gl,K=s.transform,Z=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(j,Z),((ee,se,oe)=>{const he=kd(this._movement.getPosition(),ee),le=K.width/2,xe=K.height/2,Te=Dh(0,oe.screenThinning.start,0,1,oe.screenThinning.intensity),Pe=Dh(.001,oe.screenThinning.range,0,1,oe.screenThinning.intensity),ze=Dh(0,oe.screenThinning.particleOffset,0,1,oe.screenThinning.intensity),ke=(Re={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:he,velocityConeAperture:oe.velocityConeAperture,velocity:oe.velocity,horizontalOscillationRadius:oe.horizontalOscillationRadius,horizontalOscillationRate:oe.horizontalOscillationRate,boxSize:ee,billboardSize:1*oe.billboardSize,simpleShapeParameters:[oe.shapeFadeStart,oe.shapeFadePower],screenSize:[K.width,K.height],thinningCenterPos:[le,xe],thinningShape:[Te,Pe,Math.pow(10,oe.screenThinning.fadePower)],thinningAffectedRatio:oe.screenThinning.affectedRatio,thinningParticleOffset:ze,color:[oe.color.r,oe.color.g,oe.color.b,oe.color.a],direction:g},{u_modelview:Float32Array.from(Re.modelview),u_projection:Float32Array.from(Re.projection),u_time:Re.time,u_cam_pos:Re.camPos,u_velocityConeAperture:Re.velocityConeAperture,u_velocity:Re.velocity,u_horizontalOscillationRadius:Re.horizontalOscillationRadius,u_horizontalOscillationRate:Re.horizontalOscillationRate,u_boxSize:Re.boxSize,u_billboardSize:Re.billboardSize,u_simpleShapeParameters:Re.simpleShapeParameters,u_screenSize:Re.screenSize,u_thinningCenterPos:Re.thinningCenterPos,u_thinningShape:Re.thinningShape,u_thinningAffectedRatio:Re.thinningAffectedRatio,u_thinningParticleOffset:Re.thinningParticleOffset,u_particleColor:Re.color,u_direction:Re.direction});var Re;const Ie=Math.round(oe.intensity*this.particlesCount),Ve=i.bd.simpleSegment(0,0,4*Ie,2*Ie);this.particlesVx&&this.particlesIdx&&Z.draw(s,W.TRIANGLES,nn.disabled,Un.disabled,ar.alphaBlended,Fn.disabled,ke,"snow_particles",this.particlesVx,this.particlesIdx,Ve)})(h.boxSize,0,h),this._vignette.draw(s,w)}}const zr={symbol:function(m,s,h,g,w){if(m.renderPass!=="translucent")return;const S=Un.disabled,P=m.colorModeForRenderPass(),M=h.layout.get("text-variable-anchor"),D=h.layout.get("text-size-scale-range"),j=i.aD(m.scaleFactor,D[0],D[1]);M&&function(Z,ee,se,oe,he,le,xe,Te){const Pe=ee.transform,ze=he==="map",ke=le==="map";for(const Re of Z){const Ie=oe.getTile(Re),Ve=Ie.getBucket(se);if(!Ve||!Ve.text||!Ve.text.segments.get().length)continue;const Ge=i.bH(Ve.textSizeData,Pe.zoom,Te),ht=pd(Re,Ve.getProjection(),Pe),et=Pe.calculatePixelsToTileUnitsMatrix(Ie),Et=vh(ht,Ie.tileID.canonical,ke,ze,Pe,Ve.getProjection(),et),wt=Ve.hasIconTextFit()&&Ve.hasIconData();Ge&&Sx(Ve,ze,ke,xe,Pe,Et,Re,Math.pow(2,Pe.zoom-Ie.tileID.overscaledZ),Ge,wt)}}(g,m,h,s,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w,j);const W=h.paint.get("icon-opacity").constantOr(1)!==0,K=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(W||K)?iy(m,s,h,g,S,P):(W&&iy(m,s,h,g,S,P,{onlyIcons:!0}),K&&iy(m,s,h,g,S,P,{onlyText:!0})),s.map.showCollisionBoxes&&(Hf(m,s,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Hf(m,s,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,h,g){if(m.renderPass!=="translucent")return;const w=h.paint.get("circle-opacity"),S=h.paint.get("circle-stroke-width"),P=h.paint.get("circle-stroke-opacity"),M=h.layout.get("circle-sort-key").constantOr(1)!==void 0,D=h.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(S.constantOr(1)===0||P.constantOr(1)===0))return;const j=m.context,W=j.gl,K=m.transform,Z=m.depthModeForSublayer(0,nn.ReadOnly),ee=Un.disabled,se=m.colorModeForDrapableLayerRenderPass(D),oe=K.projection.name==="globe",he=[i.ay(K.center.lng),i.aH(K.center.lat)],le=[];for(let Te=0;Te<g.length;Te++){const Pe=g[Te],ze=s.getTile(Pe),ke=ze.getBucket(h);if(!ke||ke.projection.name!==K.projection.name)continue;const Re=ke.programConfigurations.get(h.id),Ie=i.dK(h),Ve=m.isTileAffectedByFog(Pe);oe&&Ie.push("PROJECTION_GLOBE_VIEW"),Ie.push("DEPTH_D24"),m.terrain&&K.depthOcclusionForSymbolsAndCircles&&Ie.push("DEPTH_OCCLUSION");const Ge=m.getOrCreateProgram("circle",{config:Re,defines:Ie,overrideFog:Ve}),ht=ke.layoutVertexBuffer,et=ke.globeExtVertexBuffer,Et=ke.indexBuffer,wt=K.projection.createInversionMatrix(K,Pe.canonical),qt={programConfiguration:Re,program:Ge,layoutVertexBuffer:ht,globeExtVertexBuffer:et,indexBuffer:Et,uniformValues:i.dL(m,Pe,ze,wt,he,h),tile:ze};if(M){const tt=ke.segments.get();for(const dt of tt)le.push({segments:new i.bd([dt]),sortKey:dt.sortKey,state:qt})}else le.push({segments:ke.segments,sortKey:0,state:qt})}M&&le.sort((Te,Pe)=>Te.sortKey-Pe.sortKey);const xe={useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles};for(const Te of le){const{programConfiguration:Pe,program:ze,layoutVertexBuffer:ke,globeExtVertexBuffer:Re,indexBuffer:Ie,uniformValues:Ve,tile:Ge}=Te.state,ht=Te.segments;m.terrain&&m.terrain.setupElevationDraw(Ge,ze,xe),m.uploadCommonUniforms(j,ze,Ge.tileID.toUnwrapped()),ze.draw(m,W.TRIANGLES,Z,ee,se,Fn.disabled,Ve,h.id,ke,Ie,ht,h.paint,K.zoom,Pe,[Re])}},heatmap:function(m,s,h,g){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const w=m.context,S=w.gl,P=Un.disabled,M=new ar([S.ONE,S.ONE,S.ONE,S.ONE],i.am.transparent,[!0,!0,!0,!0]);(function(ee,se,oe,he){const le=ee.gl,xe=se.width*he,Te=se.height*he;ee.activeTexture.set(le.TEXTURE1),ee.viewport.set([0,0,xe,Te]);let Pe=oe.heatmapFbo;if(!Pe||Pe&&(Pe.width!==xe||Pe.height!==Te)){Pe&&Pe.destroy();const ze=le.createTexture();le.bindTexture(le.TEXTURE_2D,ze),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MAG_FILTER,le.LINEAR),Pe=oe.heatmapFbo=ee.createFramebuffer(xe,Te,!0,null),function(ke,Re,Ie,Ve,Ge,ht){const et=ke.gl;et.texImage2D(et.TEXTURE_2D,0,ke.extRenderToTextureHalfFloat?et.RGBA16F:et.RGBA,Ge,ht,0,et.RGBA,ke.extRenderToTextureHalfFloat?et.HALF_FLOAT:et.UNSIGNED_BYTE,null),Ve.colorAttachment.set(Ie)}(ee,0,ze,Pe,xe,Te)}else le.bindTexture(le.TEXTURE_2D,Pe.colorAttachment.get()),ee.bindFramebuffer.set(Pe.framebuffer)})(w,m,h,m.transform.projection.name==="globe"?.5:.25),w.clear({color:i.am.transparent});const D=m.transform,j=D.projection.name==="globe",W=j?["PROJECTION_GLOBE_VIEW"]:[],K=j?Fn.frontCCW:Fn.disabled,Z=[i.ay(D.center.lng),i.aH(D.center.lat)];for(let ee=0;ee<g.length;ee++){const se=g[ee];if(s.hasRenderableParent(se))continue;const oe=s.getTile(se),he=oe.getBucket(h);if(!he||he.projection.name!==D.projection.name)continue;const le=m.isTileAffectedByFog(se),xe=he.programConfigurations.get(h.id),Te=m.getOrCreateProgram("heatmap",{config:xe,defines:W,overrideFog:le}),{zoom:Pe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(oe,Te),m.uploadCommonUniforms(w,Te,se.toUnwrapped());const ze=D.projection.createInversionMatrix(D,se.canonical);Te.draw(m,S.TRIANGLES,nn.disabled,P,M,K,QS(m,se,oe,ze,Z,Pe,h.paint.get("heatmap-intensity")),h.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,h.paint,m.transform.zoom,xe,j?[he.globeExtVertexBuffer]:null)}w.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(w,S){const P=w.context,M=P.gl,D=S.heatmapFbo;if(!D)return;P.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,D.colorAttachment.get()),P.activeTexture.set(M.TEXTURE1);let j=S.colorRampTexture;j||(j=S.colorRampTexture=new i.T(P,S.colorRamp,M.RGBA8)),j.bind(M.LINEAR,M.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,M.TRIANGLES,nn.disabled,Un.disabled,w.colorModeForRenderPass(),Fn.disabled,((W,K,Z,ee)=>({u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}))(0,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)}(m,h))},line:function(m,s,h,g){if(m.renderPass!=="translucent")return;const w=h.paint.get("line-opacity"),S=h.paint.get("line-width");if(w.constantOr(1)===0||S.constantOr(1)===0)return;const P=h.paint.get("line-emissive-strength"),M=h.paint.get("line-occlusion-opacity"),D=h.layout.get("line-elevation-reference"),j=h.layout.get("line-width-unit")==="meters",W=D==="sea",K=!(!m.terrain||!m.terrain.enabled),Z=m.context,ee=Z.gl;if(h.hasElevatedBuckets&&m.transform.projection.name==="globe")return;const se=h.layout.get("line-cross-slope"),oe=se!==void 0,he=se<1,le=m.colorModeForDrapableLayerRenderPass(P),xe=m.terrain&&m.terrain.renderingToTexture,Te=xe?1:i.q.devicePixelRatio,Pe=h.paint.get("line-dasharray"),ze=Pe.constantOr(1),ke=h.layout.get("line-cap"),Re=Pe.constantOr(null),Ie=ke.constantOr(null),Ve=h.paint.get("line-pattern"),Ge=Ve.constantOr(1),ht=h.paint.get("line-pattern-cross-fade"),et=Ve.constantOr(null),Et=h.paint.get("line-opacity").constantOr(1);let wt=!Ge&&Et!==1||m.depthOcclusion&&M>0&&M<1;const qt=h.paint.get("line-gradient"),tt=Ge?"linePattern":"line",dt=i.dM(h);let Je;if(xe&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(wt=!1),M!==0&&m.depthOcclusion){const At=h.paint._values["line-opacity"];At&&At.value&&At.value.kind==="constant"?Je=At.value:i.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}S.value.kind!=="constant"&&S.value.isLineProgressConstant===!1&&dt.push("VARIABLE_LINE_WIDTH");const It=(At,zt,Ft,gn,En,fn)=>{for(const Pn of At){const yn=s.getTile(Pn);if(Ge&&!yn.patternsLoaded())continue;const Nn=yn.getBucket(h);if(!Nn||Nn.elevationType!=="none"&&!En||Nn.elevationType==="none"&&En)continue;m.prepareDrawTile();const Xn=[...zt],yr=m.shadowRenderer,oi=Nn.elevationType==="road"&&!!yr&&yr.enabled;let Qr=[0,0,0];if(oi){const sr=m.style.directionalLight,Ri=m.style.ambientLight;sr&&Ri&&(Qr=ll(m.style,sr,Ri)),Xn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const br=Nn.programConfigurations.get(h.id);let Ji=!1;if(et&&yn.imageAtlas){const sr=i.dN.from(et),Ri=sr.getPrimary().scaleSelf(Te).toString(),Rr=yn.imageAtlas.patternPositions.get(Ri),Di=sr.getSecondary(),jr=Di?yn.imageAtlas.patternPositions.get(Di.scaleSelf(Te).toString()):null;Ji=!!Rr&&!!jr,Rr&&br.setConstantPatternPositions(Rr,jr)}ht>0&&(Ji||br.getPatternTransitionVertexBuffer("line-pattern"))&&Xn.push("LINE_PATTERN_TRANSITION");const Hi=m.isTileAffectedByFog(Pn),tr=m.getOrCreateProgram(tt,{config:br,defines:Xn,overrideFog:Hi,overrideRtt:!En&&void 0});if(!Ge&&Re&&Ie&&yn.lineAtlas){const sr=yn.lineAtlas.getDash(Re,Ie);sr&&br.setConstantPatternPositions(sr)}oi&&yr.setupShadows(yn.tileID.toUnwrapped(),tr,"vector-tile",yn.tileID.overscaledZ);let[Mr,Lr]=h.paint.get("line-trim-offset");(Ie==="round"||Ie==="square")&&Mr!==Lr&&(Mr===0&&(Mr-=1),Lr===1&&(Lr+=1));const ai=xe?Pn.projMatrix:null,Ao=j?1/Nn.tileToMeter/i.aw(yn,1,m.transform.zoom):1,oo=j?1/Nn.tileToMeter/i.aw(yn,1,Math.floor(m.transform.zoom)):1,So=Ge?i.dO(m,yn,h,ai,Te,Ao,oo,[Mr,Lr],Qr,ht):i.dP(m,yn,h,ai,Nn.lineClipsArray.length,Te,Ao,oo,[Mr,Lr],Qr);if(qt){const sr=Nn.gradients[h.id];let Ri=sr.texture;if(h.gradientVersion!==sr.version){let Rr=256;if(h.stepInterpolant){const Di=s.getSource().maxzoom,jr=Pn.canonical.z===Di?Math.ceil(1<<m.transform.maxZoom-Pn.canonical.z):1;Rr=i.aD(i.dQ(Nn.maxLineLength/i.aj*1024*jr),256,Z.maxTextureSize)}sr.gradient=i.dR({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Rr,image:sr.gradient||void 0,clips:Nn.lineClipsArray}),sr.texture?sr.texture.update(sr.gradient):sr.texture=new i.T(Z,sr.gradient,ee.RGBA8),sr.version=h.gradientVersion,Ri=sr.texture}Z.activeTexture.set(ee.TEXTURE1),Ri.bind(h.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}ze&&(Z.activeTexture.set(ee.TEXTURE0),yn.lineAtlasTexture&&yn.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),br.updatePaintBuffers()),Ge&&(Z.activeTexture.set(ee.TEXTURE0),yn.imageAtlasTexture&&yn.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),br.updatePaintBuffers()),En&&!W&&m.terrain.setupElevationDraw(yn,tr),m.uploadCommonUniforms(Z,tr,Pn.toUnwrapped());const ji=sr=>{Je!=null&&(Je.value=Et*M),tr.draw(m,ee.TRIANGLES,Ft,sr,le,Fn.disabled,So,h.id,Nn.layoutVertexBuffer,Nn.indexBuffer,Nn.segments,h.paint,m.transform.zoom,br,[Nn.layoutVertexBuffer2,Nn.patternVertexBuffer,Nn.zOffsetVertexBuffer]),Je!=null&&(Je.value=Et)};if(wt&&!En){const sr=m.stencilModeForClipping(Pn).ref;sr===0&&xe&&Z.clear({stencil:0});const Ri={func:ee.EQUAL,mask:255};So.u_alpha_discard_threshold=.8,ji(new Un(Ri,sr,255,ee.KEEP,ee.KEEP,ee.INVERT)),So.u_alpha_discard_threshold=0,ji(new Un(Ri,sr,255,ee.KEEP,ee.KEEP,ee.KEEP))}else So.u_alpha_discard_threshold=wt&&En&&fn?.8:0,ji(En?gn:m.stencilModeForClipping(Pn))}};let gt=m.depthModeForSublayer(0,nn.ReadOnly);const Lt=new nn(m.depthOcclusion?ee.GREATER:ee.LEQUAL,nn.ReadOnly,m.depthRangeFor3D);if(h.hasNonElevatedBuckets){const At=!xe&&m.terrain;M!==0&&At?i.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has line-z-offset enabled.`):At?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${h.id}.`):It(g,dt,gt,Un.disabled,!1,!0)}if(h.hasElevatedBuckets){D==="hd-road-markup"?K||(gt=Lt,dt.push("ELEVATED_ROADS")):(dt.push("ELEVATED"),gt=Lt,oe&&dt.push(he?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),W&&dt.push("ELEVATION_REFERENCE_SEA"));const At=wt?m.stencilModeFor3D():Un.disabled;m.forceTerrainMode=!0,It(g,dt,gt,At,!0,!0),wt&&It(g,dt,gt,At,!0,!1),m.forceTerrainMode=!1}wt&&(m.resetStencilClippingMasks(),xe&&Z.clear({stencil:0})),M===0||m.depthOcclusion||xe||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,s,h,g){const w=h.paint.get("fill-color"),S=h.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const P=h.paint.get("fill-emissive-strength"),M=m.colorModeForDrapableLayerRenderPass(P),D=h.paint.get("fill-pattern"),j=m.opaquePassEnabledForLayer()&&!D.constantOr(1)&&w.constantOr(i.am.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";let W="none";h.layout.get("fill-elevation-reference")!=="none"?W="road":h.paint.get("fill-z-offset").constantOr(1)!==0&&(W="offset");const K=!(!m.terrain||!m.terrain.enabled),Z={painter:m,sourceCache:s,layer:h,coords:g,colorMode:M,elevationType:W,terrainEnabled:K,pass:j};if(m.renderPass!=="shadow")if(W!=="offset"){if(dn(Z,!1),W==="road"){const ee=!K&&m.renderPass==="translucent";ee&&Jm(m,s,h,g,"geometry"),dn(Z,!0,Un.disabled),ee&&function(se){const{painter:oe,sourceCache:he,layer:le,coords:xe,colorMode:Te}=se,Pe=oe.context.gl,ze=se.painter.shadowRenderer,ke=!!ze&&ze.enabled,Re=new nn(oe.context.gl.LEQUAL,nn.ReadOnly,oe.depthRangeFor3D);let Ie=[0,0,0];if(ke){const Ve=oe.style.directionalLight,Ge=oe.style.ambientLight;Ve&&Ge&&(Ie=ll(oe.style,Ve,Ge))}for(const Ve of xe){const Ge=he.getTile(Ve),ht=Ge.getBucket(le);if(!ht)continue;const et=ht.elevatedStructures;if(!et||!et.renderableSegments||et.renderableSegments.segments[0].primitiveLength===0)continue;oe.prepareDrawTile();const Et=ht.bufferData.programConfigurations.get(le.id),wt=oe.isTileAffectedByFog(Ve),qt=[];ke&&qt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const tt=oe.getOrCreateProgram("elevatedStructures",{config:Et,overrideFog:wt,defines:qt}),dt=oe.translatePosMatrix(Ve.projMatrix,Ge,le.paint.get("fill-translate"),le.paint.get("fill-translate-anchor"));ke&&ze.setupShadows(Ge.tileID.toUnwrapped(),tt,"vector-tile",Ge.tileID.overscaledZ);const Je=yx(dt,Ie);oe.uploadCommonUniforms(oe.context,tt,Ve.toUnwrapped()),tt.draw(oe,Pe.TRIANGLES,Re,Un.disabled,Te,Fn.backCCW,Je,le.id,et.vertexBuffer,et.indexBuffer,et.renderableSegments,le.paint,oe.transform.zoom,Et,[et.vertexBufferNormal])}}(Z)}}else dn(Z,!1,m.stencilModeFor3D());else m.shadowRenderer&&W==="road"&&!K&&function(ee){const{painter:se,sourceCache:oe,layer:he,coords:le}=ee,xe=se.context.gl,Te=ee.painter.shadowRenderer;for(const Pe of le){const ze=oe.getTile(Pe),ke=ze.getBucket(he);if(!ke)continue;const Re=ke.elevatedStructures;if(!Re||!Re.shadowCasterSegments||Re.shadowCasterSegments.segments[0].primitiveLength===0)continue;se.prepareDrawTile();const Ie=ke.bufferData.programConfigurations.get(he.id),Ve=se.isTileAffectedByFog(Pe),Ge=se.getOrCreateProgram("elevatedStructuresDepth",{config:Ie,overrideFog:Ve}),ht=Te.calculateShadowPassMatrixFromTile(ze.tileID.toUnwrapped());se.uploadCommonUniforms(se.context,Ge,Pe.toUnwrapped());const et={u_matrix:ht,u_depth_bias:.001};Ge.draw(se,xe.TRIANGLES,Te.getShadowPassDepthMode(),Un.disabled,Te.getShadowPassColorMode(),Fn.disabled,et,he.id,Re.vertexBuffer,Re.indexBuffer,Re.shadowCasterSegments,he.paint,se.transform.zoom,Ie)}}(Z)},"fill-extrusion":function(m,s,h,g){const w=h.paint.get("fill-extrusion-opacity"),S=m.context,P=S.gl,M=m.terrain,D=M&&M.renderingToTexture;if(w===0)return;const j=m.conflationActive&&m.style.isLayerClipped(h,s.getSource()),W=m.style.order.indexOf(h.fqid);if(j&&function(K,Z,ee,se,oe){for(const he of se){const le=Z.getTile(he).getBucket(ee);le&&(le.updateReplacement(he,K.replacementSource,oe),le.uploadCentroid(K.context))}}(m,s,h,g,W),M||j)for(const K of g){const Z=s.getTile(K).getBucket(h);Z&&Mh(m.context,s,K,Z,h,M,j)}if(m.renderPass==="shadow"&&m.shadowRenderer){const K=m.shadowRenderer;if(M&&w<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ab)return;const Z=K.getShadowPassDepthMode(),ee=K.getShadowPassColorMode();Qm(m,s,h,g,Z,Un.disabled,ee,j)}else if(m.renderPass==="translucent"){const K=!h.paint.get("fill-extrusion-pattern").constantOr(1),Z=h.paint.get("fill-extrusion-color").constantOr(i.am.white);if(!D&&Z.a!==0){const ee=new nn(m.context.gl.LEQUAL,nn.ReadWrite,m.depthRangeFor3D);w===1&&K?Qm(m,s,h,g,ee,Un.disabled,ar.unblended,j):(Qm(m,s,h,g,ee,Un.disabled,ar.disabled,j),Qm(m,s,h,g,ee,m.stencilModeFor3D(),m.colorModeForRenderPass(),j),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&K&&(!M&&m.transform.projection.name!=="globe"||D)){const ee=h.paint.get("fill-extrusion-opacity"),se=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),he=h.paint.get("fill-extrusion-flood-light-intensity"),le=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",xe=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(le?null:h.lut).toArray01().slice(0,3),Te=se>0&&oe>0,Pe=he>0,ze=(Re,Ie,Ve)=>(1-Ve)*Re+Ve*Ie,ke=Re=>{const Ie=m.depthModeForSublayer(1,nn.ReadOnly,P.LEQUAL,!0),Ve=h.paint.get(Re?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ge=ze(.1,3,Ve),ht=m._showOverdrawInspector;if(!ht){const et=new Un({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),Et=new ar([P.ONE,P.ONE,P.ONE,P.ONE],i.am.transparent,[!1,!1,!1,!0],P.MIN);Cd(m,s,h,g,Ie,et,Et,Fn.disabled,Re,"sdf",ee,se,oe,he,xe,Ge,j,!1)}{const et=ht?Un.disabled:new Un({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),Et=ht?m.colorModeForRenderPass():new ar([P.ONE_MINUS_DST_ALPHA,P.DST_ALPHA,P.ONE,P.ONE],i.am.transparent,[!0,!0,!0,!0]);Cd(m,s,h,g,Ie,et,Et,Fn.disabled,Re,"color",ee,se,oe,he,xe,Ge,j,!1)}};if(D){const Re=(Ie,Ve,Ge)=>{const ht=m.depthModeForSublayer(1,nn.ReadOnly,P.LEQUAL,!1),et=h.paint.get(Ie?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Et=ze(.1,3,et);{const wt=new ar([P.ONE,P.ONE,P.ONE,P.ONE],i.am.transparent,[!1,!1,!1,!0]);Cd(m,s,h,g,ht,Un.disabled,wt,Fn.disabled,Ie,"clear",ee,se,oe,he,xe,Et,j,Ve)}{const wt=new Un({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),qt=new ar([P.ONE,P.ONE,P.ONE,P.ONE],i.am.transparent,[!1,!1,!1,!0],P.MIN);Cd(m,s,h,g,ht,wt,qt,Fn.disabled,Ie,"sdf",ee,se,oe,he,xe,Et,j,Ve)}{const wt=Ie?P.ZERO:P.ONE_MINUS_DST_ALPHA,qt=new Un({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),tt=new ar([wt,P.DST_ALPHA,P.ONE_MINUS_DST_ALPHA,P.ZERO],i.am.transparent,[!0,!0,!0,!0]);Cd(m,s,h,g,ht,qt,tt,Fn.disabled,Ie,"color",ee,se,oe,he,xe,Et,j,Ve)}{const wt=new ar([P.ONE,P.ONE,P.ONE,Ie?P.ZERO:P.ONE],i.am.transparent,[!1,!1,!1,!0],Ie?P.FUNC_ADD:P.MAX);Cd(m,s,h,g,ht,Un.disabled,wt,Fn.disabled,Ie,"clear",ee,se,oe,he,xe,Et,j,Ve,Ge)}};if(Te||Pe){let Ie;if(m.prepareDrawTile(),M){const Ve=M.drapeBufferSize[0],Ge=M.drapeBufferSize[1];Ie=M.framebufferCopyTexture,Ie&&(!Ie||Ie.size[0]===Ve&&Ie.size[1]===Ge)||(Ie&&Ie.destroy(),Ie=M.framebufferCopyTexture=new i.T(S,new i.r({width:Ve,height:Ge}),P.RGBA8)),Ie.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.copyTexSubImage2D(P.TEXTURE_2D,0,0,0,0,0,Ve,Ge)}Te&&Re(!0,!1,Ie),Pe&&Re(!1,!0,Ie)}}else Te&&ke(!0),Pe&&ke(!1),(Te||Pe)&&m.resetStencilClippingMasks()}}},hillshade:function(m,s,h,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const w=m.context,S=m.terrain&&m.terrain.renderingToTexture,[P,M]=m.renderPass!=="translucent"||S?[{},g]:m.stencilConfigForOverlap(g);for(const D of M){const j=s.getTile(D);if(j.needsHillshadePrepare&&m.renderPass==="offscreen")Ff(m,j,h);else if(m.renderPass==="translucent"){const W=m.depthModeForSublayer(0,nn.ReadOnly),K=h.paint.get("hillshade-emissive-strength"),Z=m.colorModeForDrapableLayerRenderPass(K),ee=S&&m.terrain?m.terrain.stencilModeForRTTOverlap(D):P[D.overscaledZ];B_(m,D,j,h,W,ee,Z)}}w.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,s,h,g,w,S){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const P=m.transform.projection.name==="globe",M=h.paint.get("raster-elevation")!==0,D=M&&P;if(m.renderElevatedRasterBackface&&!D)return;const j=m.context,W=j.gl,K=s.getSource(),Z=function(ke,Re,Ie,Ve){const Ge=Re.paint.get("raster-color"),ht=ke.type==="raster-array",et=[],Et=Re.paint.get("raster-resampling"),wt=Re.paint.get("raster-color-mix");let qt=Re.paint.get("raster-color-range");const tt=[wt[0],wt[1],wt[2],0],dt=wt[3];let Je=Et==="nearest"?Ve.NEAREST:Ve.LINEAR;if(ht&&(et.push("RASTER_ARRAY"),Ge||et.push("RASTER_COLOR"),Et==="linear"&&et.push("RASTER_ARRAY_LINEAR"),Je=Ve.NEAREST,!qt&&ke.rasterLayers)){const It=ke.rasterLayers.find(({id:gt})=>gt===Re.sourceLayer);It&&It.fields&&It.fields.range&&(qt=It.fields.range)}if(qt=qt||[0,1],Ge){et.push("RASTER_COLOR"),Ie.activeTexture.set(Ve.TEXTURE2),Re.updateColorRamp(qt);let It=Re.colorRampTexture;It||(It=Re.colorRampTexture=new i.T(Ie,Re.colorRamp,Ve.RGBA8)),It.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}return{mix:tt,range:qt,offset:dt,defines:et,resampling:Je}}(K,h,j,W);if(K instanceof i.aP&&!g.length&&!P)return;const ee=h.paint.get("raster-emissive-strength"),se=m.colorModeForDrapableLayerRenderPass(ee),oe=m.terrain&&m.terrain.renderingToTexture,he=!m.options.moving,le=h.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR;if(K instanceof i.aP&&!g.length&&(K.onNorthPole||K.onSouthPole)){const ke=M?m.stencilModeFor3D():Un.disabled;return void eg(!!K.onNorthPole,null,m,s,h,ee,Z,Fn.disabled,ke)}if(!g.length)return;const[xe,Te]=K instanceof i.aP||oe?[{},g]:m.stencilConfigForOverlap(g),Pe=Te[Te.length-1].overscaledZ;D&&Z.defines.push("PROJECTION_GLOBE_VIEW"),M&&Z.defines.push("RENDER_CUTOFF");const ze=(ke,Re,Ie)=>{for(const Ve of ke){const Ge=Ve.toUnwrapped(),ht=s.getTile(Ve);if(oe&&(!ht||!ht.hasData()))continue;j.activeTexture.set(W.TEXTURE0);const et=sM(ht,K,h,Z);if(!et||!et.texture)continue;const{texture:Et,mix:wt,offset:qt,tileSize:tt,buffer:dt}=et;let Je,It;oe?(Je=nn.disabled,It=Ve.projMatrix):M?(Je=new nn(W.LEQUAL,nn.ReadWrite,m.depthRangeFor3D),It=P?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(Ge,he)):(Je=m.depthModeForSublayer(Ve.overscaledZ-Pe,h.paint.get("raster-opacity")===1?nn.ReadWrite:nn.ReadOnly,W.LESS),It=m.transform.calculateProjMatrix(Ge,he));const gt=m.terrain&&oe?m.terrain.stencilModeForRTTOverlap(Ve):xe[Ve.overscaledZ],Lt=S?0:h.paint.get("raster-fade-duration");ht.registerFadeDuration(Lt);const At=s.findLoadedParent(Ve,0),zt=Hm(ht,At,s,m.transform,Lt);let Ft,gn;m.terrain&&m.terrain.prepareDrawTile(),j.activeTexture.set(W.TEXTURE0),Et.bind(le,W.CLAMP_TO_EDGE),j.activeTexture.set(W.TEXTURE1),At?(At.texture&&At.texture.bind(le,W.CLAMP_TO_EDGE),Ft=Math.pow(2,At.tileID.overscaledZ-ht.tileID.overscaledZ),gn=[ht.tileID.canonical.x*Ft%1,ht.tileID.canonical.y*Ft%1]):Et.bind(le,W.CLAMP_TO_EDGE),"useMipmap"in Et&&j.extTextureFilterAnisotropic&&m.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const En=m.transform;let fn;const Pn=M?oT(En):[0,0,0,0];let yn,Nn,Xn,yr,oi,Qr=0;if(D&&K instanceof i.aP&&K.coordinates.length>3)yn=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0)))),Nn=Float32Array.from(En.globeMatrix),Xn=Float32Array.from(i.dm(En)),yr=[i.ay(En.center.lng),i.aH(En.center.lat)],fn=K.elevatedGlobePerspectiveTransform,oi=K.elevatedGlobeGridMatrix||new Float32Array(9);else if(D){const tr=i.dn(Ve.canonical);Qr=i.dp(tr.getCenter().lat),yn=Float32Array.from(i.bh(i.dr(Ve.canonical))),Nn=Float32Array.from(En.globeMatrix),Xn=Float32Array.from(i.dm(En)),yr=[i.ay(En.center.lng),i.aH(En.center.lat)],fn=[0,0],oi=Float32Array.from(i.dq(Ve.canonical,tr,Qr,En.worldSize/En._pixelsPerMercatorPixel))}else fn=K instanceof i.aP?K.perspectiveTransform:[0,0],yn=new Float32Array(16),Nn=new Float32Array(9),Xn=new Float32Array(16),yr=[0,0],oi=new Float32Array(9);const br=Ih(It,yn,Nn,Xn,oi,gn||[0,0],i.ah(m.transform.zoom),yr,Pn,Ft||1,zt,h,fn,M?h.paint.get("raster-elevation"):0,2,wt,qt,Z.range,tt,dt,ee),Ji=m.isTileAffectedByFog(Ve),Hi=m.getOrCreateProgram("raster",{defines:Z.defines,overrideFog:Ji});if(m.uploadCommonUniforms(j,Hi,Ge),K instanceof i.aP){const tr=K.elevatedGlobeVertexBuffer,Mr=K.elevatedGlobeIndexBuffer;if(oe||!P)K.boundsBuffer&&K.boundsSegments&&Hi.draw(m,W.TRIANGLES,Je,Un.disabled,se,Fn.disabled,br,h.id,K.boundsBuffer,m.quadTriangleIndexBuffer,K.boundsSegments);else if(tr&&Mr){const Lr=En.zoom<=i.cL?K.elevatedGlobeSegments:K.getSegmentsForLongitude(En.center.lng);Lr&&Hi.draw(m,W.TRIANGLES,Je,Un.disabled,se,Re,br,h.id,tr,Mr,Lr)}}else if(D){Je=new nn(W.LEQUAL,nn.ReadOnly,m.depthRangeFor3D);const tr=m.globeSharedBuffers;if(tr){const[Mr,Lr,ai]=tr.getGridBuffers(Qr,!1);Hi.draw(m,W.TRIANGLES,Je,Ie||gt,m.colorModeForRenderPass(),Re,br,h.id,Mr,Lr,ai)}}else{const{tileBoundsBuffer:tr,tileBoundsIndexBuffer:Mr,tileBoundsSegments:Lr}=m.getTileBoundsBuffers(ht);Hi.draw(m,W.TRIANGLES,Je,gt,se,Fn.disabled,br,h.id,tr,Mr,Lr)}}if(!(K instanceof i.aP)&&D)for(const Ve of ke){const Ge=Ve.canonical.y===(1<<Ve.canonical.z)-1;Ve.canonical.y===0&&eg(!0,Ve,m,s,h,ee,Z,Re,Ie||Un.disabled),Ge&&eg(!1,Ve,m,s,h,ee,Z,Re===Fn.frontCW?Fn.backCW:Fn.frontCW,Ie||Un.disabled)}};D?ze(Te,m.renderElevatedRasterBackface?Fn.backCW:Fn.frontCW,m.stencilModeFor3D()):ze(Te,Fn.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,s,h,g,w,S){m.renderPass==="offscreen"&&function(P,M,D,j){if(!j.length)return;const W=P.context,K=W.gl,Z=M.getSource();if(!(Z instanceof Il))return;const ee=Math.ceil(Math.sqrt(D.paint.get("raster-particle-count")));let se=D.particlePositionRGBAImage;if(!se||se.width!==ee){const Te=function(Pe){const ze=Pe*Pe,ke=new Uint8Array(4*ze),Re=function(Ve){return Ve|=0,Ve=Math.imul(2747636419^Ve,2654435769),Ve=Math.imul(Ve^Ve>>>16,2654435769),((Ve=Math.imul(Ve^Ve>>>16,2654435769))>>>0)/4294967296},Ie=1/1.1;for(let Ve=0;Ve<ze;Ve++){const Ge=Ie*(Re(2*Ve+0)+hl),ht=Ie*(Re(2*Ve+1)+hl),et=255*Ge%1,Et=255*ht%1,wt=et,qt=ht-Et/255,tt=Et;ke[4*Ve+0]=255*(Ge-et/255),ke[4*Ve+1]=255*wt,ke[4*Ve+2]=255*qt,ke[4*Ve+3]=255*tt}return ke}(ee);se=D.particlePositionRGBAImage=new i.r({width:ee,height:ee},Te)}let oe=D.particleFramebuffer;oe?oe.width!==ee&&(oe.destroy(),oe=D.particleFramebuffer=W.createFramebuffer(ee,ee,!0,null)):oe=D.particleFramebuffer=W.createFramebuffer(ee,ee,!0,null);const he=[];for(const Te of j){const Pe=M.getTile(Te);if(!(Pe instanceof yu))continue;const ze=cM(Pe,Z,D);if(!ze)continue;const ke=[Pe.tileSize,Pe.tileSize];let Re=D.tileFramebuffer;Re||(Re=D.tileFramebuffer=W.createFramebuffer(ke[0],ke[1],!0,null));let Ie=Pe.rasterParticleState;Ie||(Ie=Pe.rasterParticleState=new lM(W,Te,ke,se));const Ve=Ie.update(D.lastInvalidatedAt);Ie.particleTextureDimension!==ee&&Ie.updateParticleTexture(Te,se);const Ge=Ie.targetColorTexture;Ie.targetColorTexture=Ie.backgroundColorTexture,Ie.backgroundColorTexture=Ge;const ht=Ie.particleTexture0;Ie.particleTexture0=Ie.particleTexture1,Ie.particleTexture1=ht,he.push([Te,ze,Ie,Ve])}if(he.length===0)return;const le=i.q.now(),xe=D.previousDrawTimestamp?.001*(le-D.previousDrawTimestamp):.0167;if(D.previousDrawTimestamp=le,D.hasColorMap()){W.activeTexture.set(K.TEXTURE0+2);let Te=D.colorRampTexture;Te||(Te=D.colorRampTexture=new i.T(W,D.colorRamp,K.RGBA8)),Te.bind(K.LINEAR,K.CLAMP_TO_EDGE)}W.bindFramebuffer.set(D.tileFramebuffer.framebuffer),function(Te,Pe,ze){const ke=Te.context,Re=ke.gl,Ie=Pe.tileFramebuffer;ke.activeTexture.set(Re.TEXTURE0);const Ve={u_texture:0,u_opacity:1.05*(ht=Pe.paint.get("raster-particle-fade-opacity-factor"))/(ht+.05)},Ge=Te.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ht;for(const et of ze){const[,,Et,wt]=et;Ie.colorAttachment.set(Et.targetColorTexture.texture),ke.viewport.set([0,0,Ie.width,Ie.height]),ke.clear({color:i.am.transparent}),wt&&(Et.backgroundColorTexture.bind(Re.NEAREST,Re.CLAMP_TO_EDGE),Ge.draw(Te,Re.TRIANGLES,nn.disabled,Un.disabled,ar.alphaBlended,Fn.disabled,Ve,Pe.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments))}}(P,D,he),function(Te,Pe,ze,ke){const Re=Te.context,Ie=Re.gl,Ve=ze.tileFramebuffer,Ge=Te.transform.projection.name==="globe",ht=ze.paint.get("raster-particle-max-speed");for(const et of ke){const[Et,wt,qt]=et;Re.activeTexture.set(Ie.TEXTURE0+0),wt.texture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),Ve.colorAttachment.set(qt.targetColorTexture.texture);const tt=Te.getOrCreateProgram("rasterParticleDraw",{defines:wt.defines,overrideFog:!1});Re.activeTexture.set(Ie.TEXTURE0+1);const dt=wt.scalarData?[]:[0,1,2,3].map(gt=>i.dU[gt](Et));dt.push(Et);const Je=Et.canonical.x,It=Et.canonical.y;for(const gt of dt){const Lt=Pe.getTile(Ge?gt.wrapped():gt);if(!Lt)continue;const At=Lt.rasterParticleState;if(!At)continue;const zt=gt.canonical.x+(1<<gt.canonical.z)*(gt.wrap-Et.wrap),Ft=gt.canonical.y;At.particleTexture0.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE);const gn=J_(1,At.particleTexture0.size[0],[zt-Je,Ft-It],0,wt.texture.size,2,ht,wt.textureOffset,wt.scale,wt.offset);tt.draw(Te,Ie.POINTS,nn.disabled,Un.disabled,ar.alphaBlended,Fn.disabled,gn,ze.id,At.particleIndexBuffer,void 0,At.particleSegment)}}}(P,M,D,he),W.bindFramebuffer.set(D.particleFramebuffer.framebuffer),function(Te,Pe,ze,ke){const Re=Te.context,Ie=Re.gl,Ve=Pe.paint.get("raster-particle-max-speed"),Ge=ke*Pe.paint.get("raster-particle-speed-factor")*.15,ht=function(Et){return Math.pow(Et,6)}(.01+1*Pe.paint.get("raster-particle-reset-rate-factor")),et=Pe.particleFramebuffer;Re.viewport.set([0,0,et.width,et.height]);for(const Et of ze){const[,wt,qt]=Et;Re.activeTexture.set(Ie.TEXTURE0+0),wt.texture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),Re.activeTexture.set(Ie.TEXTURE0+1);const tt=qt.particleTexture0;tt.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE);const dt=tT(1,tt.size[0],0,wt.texture.size,Ve,Ge,ht,wt.textureOffset,wt.scale,wt.offset);et.colorAttachment.set(qt.particleTexture1.texture),Re.clear({color:i.am.transparent}),Te.getOrCreateProgram("rasterParticleUpdate",{defines:wt.defines}).draw(Te,Ie.TRIANGLES,nn.disabled,Un.disabled,ar.unblended,Fn.disabled,dt,Pe.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments)}}(P,D,he,xe)}(m,s,h,g),m.renderPass==="translucent"&&(function(P,M,D,j,W){const K=P.context,Z=K.gl,ee=M.getSource().tileSize,se=5*(1-i.af(i.cx,i.cx+1,P.transform.zoom))*ee+D.paint.get("raster-particle-elevation"),oe=!P.options.moving,he=P.transform.projection.name==="globe";if(!j.length)return;const[le,xe]=P.stencilConfigForOverlap(j),Te=[];he&&Te.push("PROJECTION_GLOBE_VIEW");const Pe=P.stencilModeFor3D();for(const ze of xe){const ke=ze.toUnwrapped(),Re=M.getTile(ze);if(!Re.rasterParticleState)continue;const Ie=Re.rasterParticleState,Ve=100;Re.registerFadeDuration(Ve);const Ge=M.findLoadedParent(ze,0),ht=Hm(Re,Ge,M,P.transform,Ve);let et,Et;P.terrain&&P.terrain.prepareDrawTile(),K.activeTexture.set(Z.TEXTURE0),Ie.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),K.activeTexture.set(Z.TEXTURE1),Ge&&Ge.rasterParticleState?(Ge.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),et=Math.pow(2,Ge.tileID.overscaledZ-Re.tileID.overscaledZ),Et=[Re.tileID.canonical.x*et%1,Re.tileID.canonical.y*et%1]):Ie.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const wt=he?Float32Array.from(P.transform.expandedFarZProjMatrix):P.transform.calculateProjMatrix(ke,oe),qt=P.transform,tt=Ax(qt),dt=i.dn(ze.canonical),Je=i.dp(dt.getCenter().lat);let It,gt,Lt,At,zt;he?(It=Float32Array.from(i.bh(i.dr(ze.canonical))),gt=Float32Array.from(qt.globeMatrix),Lt=Float32Array.from(i.dm(qt)),At=[i.ay(qt.center.lng),i.aH(qt.center.lat)],zt=Float32Array.from(i.dq(ze.canonical,dt,Je,qt.worldSize/qt._pixelsPerMercatorPixel))):(It=new Float32Array(16),gt=new Float32Array(9),Lt=new Float32Array(16),At=[0,0],zt=new Float32Array(9));const Ft=xx(wt,It,gt,Lt,zt,Et||[0,0],i.ah(P.transform.zoom),At,tt,et||1,ht,se),gn=P.isTileAffectedByFog(ze),En=P.getOrCreateProgram("rasterParticle",{defines:Te,overrideFog:gn});if(P.uploadCommonUniforms(K,En,ke),he){const fn=new nn(Z.LEQUAL,nn.ReadOnly,P.depthRangeFor3D),Pn=0,yn=P.globeSharedBuffers;if(yn){const[Nn,Xn,yr]=yn.getGridBuffers(Je,Pn!==0);En.draw(P,Z.TRIANGLES,fn,Pe,ar.alphaBlended,P.renderElevatedRasterBackface?Fn.frontCCW:Fn.backCCW,Ft,D.id,Nn,Xn,yr)}}else{const fn=P.depthModeForSublayer(0,nn.ReadOnly),Pn=le[ze.overscaledZ],{tileBoundsBuffer:yn,tileBoundsIndexBuffer:Nn,tileBoundsSegments:Xn}=P.getTileBoundsBuffers(Re);En.draw(P,Z.TRIANGLES,fn,Pn,ar.alphaBlended,Fn.disabled,Ft,D.id,yn,Nn,Xn)}}P.resetStencilClippingMasks()}(m,s,h,g),m.style.map.triggerRepaint())},background:function(m,s,h,g){const w=h.paint.get("background-color"),S=h.paint.get("background-color-use-theme").constantOr("default")==="none",P=h.paint.get("background-opacity"),M=h.paint.get("background-emissive-strength"),D=h.paint.get("background-pitch-alignment")==="viewport";if(P===0)return;const j=m.context,W=j.gl,K=m.transform,Z=K.tileSize,ee=h.paint.get("background-pattern");let se;if(ee!==void 0&&(ee===null||(se=m.imageManager.getPattern(i.I.from(ee.toString()),h.scope,m.style.getLut(h.scope)),!se)))return;const oe=!ee&&w.a===1&&P===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==oe)return;const he=Un.disabled,le=m.depthModeForSublayer(0,oe==="opaque"?nn.ReadWrite:nn.ReadOnly),xe=m.colorModeForDrapableLayerRenderPass(M),Te=ee?"backgroundPattern":"background";let Pe,ze=g;if(ze||(Pe=m.getBackgroundTiles(),ze=Object.values(Pe).map(ke=>ke.tileID)),ee&&(j.activeTexture.set(W.TEXTURE0),m.imageManager.bind(m.context,h.scope)),D){const ke=m.getOrCreateProgram(Te,{overrideFog:!1,overrideRtt:!0}),Re=new Float32Array(i.bx([])),Ie=new i.aM(0,0,0,0,0),Ve=ee?nT(Re,M,P,m,0,h.scope,se,D,{tileID:Ie,tileSize:Z}):ey(Re,M,P,w.toRenderColor(S?null:h.lut));ke.draw(m,W.TRIANGLES,le,he,xe,Fn.disabled,Ve,h.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const ke of ze){const Re=m.isTileAffectedByFog(ke),Ie=m.getOrCreateProgram(Te,{overrideFog:Re}),Ve=ke.toUnwrapped(),Ge=g?ke.projMatrix:m.transform.calculateProjMatrix(Ve);m.prepareDrawTile();const ht=s?s.getTile(ke):Pe?Pe[ke.key]:new il(ke,Z,K.zoom,m),et=ee?nT(Ge,M,P,m,0,h.scope,se,D,{tileID:ke,tileSize:Z}):ey(Ge,M,P,w.toRenderColor(S?null:h.lut));m.uploadCommonUniforms(j,Ie,Ve);const{tileBoundsBuffer:Et,tileBoundsIndexBuffer:wt,tileBoundsSegments:qt}=m.getTileBoundsBuffers(ht);Ie.draw(m,W.TRIANGLES,le,he,xe,Fn.disabled,et,h.id,Et,wt,qt)}},sky:function(m,s,h){const g=m._atmosphere?i.ah(m.transform.zoom):1,w=h.paint.get("sky-opacity")*g;if(w===0)return;const S=m.context,P=h.paint.get("sky-type"),M=new nn(S.gl.LEQUAL,nn.ReadOnly,[0,1]),D=m.frameCounter/1e3%1;P==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(j,W,K,Z){const ee=j.context,se=ee.gl;let oe=W.skyboxFbo;if(!oe){oe=W.skyboxFbo=ee.createFramebuffer(32,32,!0,null),W.skyboxGeometry=new tg(ee),W.skyboxTexture=ee.gl.createTexture(),se.bindTexture(se.TEXTURE_CUBE_MAP,W.skyboxTexture),se.texParameteri(se.TEXTURE_CUBE_MAP,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_CUBE_MAP,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_CUBE_MAP,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_CUBE_MAP,se.TEXTURE_MAG_FILTER,se.LINEAR);for(let Te=0;Te<6;++Te)se.texImage2D(se.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,se.RGBA,32,32,0,se.RGBA,se.UNSIGNED_BYTE,null)}ee.bindFramebuffer.set(oe.framebuffer),ee.viewport.set([0,0,32,32]);const he=W.getCenter(j,!0),le=j.getOrCreateProgram("skyboxCapture"),xe=new Float64Array(16);i.bx(xe),i.e3(xe,xe,.5*-Math.PI),Rh(j,W,le,xe,he,0),i.bx(xe),i.e3(xe,xe,.5*Math.PI),Rh(j,W,le,xe,he,1),i.bx(xe),i.cG(xe,xe,.5*-Math.PI),Rh(j,W,le,xe,he,2),i.bx(xe),i.cG(xe,xe,.5*Math.PI),Rh(j,W,le,xe,he,3),i.bx(xe),Rh(j,W,le,xe,he,4),i.bx(xe),i.e3(xe,xe,Math.PI),Rh(j,W,le,xe,he,5),ee.viewport.set([0,0,j.width,j.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(j,W,K,Z,ee){const se=j.context,oe=se.gl,he=j.transform,le=j.getOrCreateProgram("skybox");se.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_CUBE_MAP,W.skyboxTexture);const xe=((Te,Pe,ze,ke,Re)=>({u_matrix:Te,u_sun_direction:Pe,u_cubemap:0,u_opacity:ke,u_temporal_offset:Re}))(he.skyboxMatrix,W.getCenter(j,!1),0,Z,ee);j.uploadCommonUniforms(se,le),le.draw(j,oe.TRIANGLES,K,Un.disabled,j.colorModeForRenderPass(),Fn.backCW,xe,"skybox",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(m,h,M,w,D):P==="gradient"&&m.renderPass==="sky"&&function(j,W,K,Z,ee){const se=j.context,oe=se.gl,he=j.transform,le=j.getOrCreateProgram("skyboxGradient");W.skyboxGeometry||(W.skyboxGeometry=new tg(se)),se.activeTexture.set(oe.TEXTURE0);let xe=W.colorRampTexture;xe||(xe=W.colorRampTexture=new i.T(se,W.colorRamp,oe.RGBA8)),xe.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Te=((Pe,ze,ke,Re,Ie)=>({u_matrix:Pe,u_color_ramp:0,u_center_direction:ze,u_radius:i.al(ke),u_opacity:Re,u_temporal_offset:Ie}))(he.skyboxMatrix,W.getCenter(j,!1),W.paint.get("sky-gradient-radius"),Z,ee);j.uploadCommonUniforms(se,le),le.draw(j,oe.TRIANGLES,K,Un.disabled,j.colorModeForRenderPass(),Fn.backCW,Te,"skyboxGradient",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(m,h,M,w,D)},debug:function(m,s,h,g,w,S){for(let P=0;P<h.length;P++)if(w){const j=new i.am(g.r*.8,g.g*.8,g.b*.8,1);Id(m,s,h[P],g,-1,-1,S),Id(m,s,h[P],g,-1,1,S),Id(m,s,h[P],g,1,1,S),Id(m,s,h[P],g,1,-1,S),Id(m,s,h[P],j,0,0,S)}else Id(m,s,h[P],g,0,0,S)},custom:function(m,s,h,g){const w=m.context,S=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isDraped(s)){if(m.renderPass==="offscreen"){const P=S.prerender;if(P){if(m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const M=m.transform.pointMerc;P.call(S,w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.ah(m.transform.zoom),[M.x,M.y],m.transform.pixelsPerMeterRatio)}else P.call(S,w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const M=S.renderToTile;if(M){const D=g[0].canonical,j={x:D.x+g[0].wrap*(S.wrapTileId?0:1<<D.z),y:D.y,z:D.z};w.setDepthMode(nn.disabled),w.setStencilMode(Un.disabled),w.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),M.call(S,w.gl,j),w.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),w.setStencilMode(Un.disabled);const P=S.renderingMode==="3d"?new nn(m.context.gl.LEQUAL,nn.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,nn.ReadOnly);if(w.setDepthMode(P),m.transform.projection.name==="globe"){const M=m.transform.pointMerc;S.render(w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.ah(m.transform.zoom),[M.x,M.y],m.transform.pixelsPerMeterRatio)}else S.render(w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState(),w.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,s,h,g){if(m.renderPass==="opaque")return;const w=h.paint.get("model-opacity").constantOr(1);if(w===0)return;const S=h.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!S||m.terrain&&w<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof i.ab))return;const P=m.shadowRenderer,M=h.paint.get("model-receive-shadows");P&&(P.useNormalOffset=!0,M||(P.enabled=!1));const D=()=>{P&&(P.useNormalOffset=!0,M||(P.enabled=!0))},j=s.getSource();if(m.renderPass==="light-beam"&&j.type!=="batched-model")return;if(j.type==="vector"||j.type==="geojson")return function(le,xe,Te,Pe,ze){const ke=le.transform;if(ke.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${ke.projection.name} projection is not yet implemented`);const Re=ke.getFreeCameraOptions().position;if(!le.modelManager)return;const Ie=le.modelManager;Te.modelManager=Ie;const Ve=le.shadowRenderer;if(!Te._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ge=Te._unevaluatedLayout._values["model-id"],ht=Object.assign({},Te.layout.get("model-id").parameters),et=le.style.order.indexOf(Te.fqid);for(const Et of Pe){const wt=xe.getTile(Et).getBucket(Te);if(!wt||wt.projection.name!==ke.projection.name)continue;const qt=wt.getModelUris();qt&&!wt.modelsRequested&&(Ie.addModelsFromBucket(qt,ze),wt.modelsRequested=!0);const tt=sy(Et,ke);ht.zoom=tt;const dt=Ge.possiblyEvaluate(ht);if(st(le,wt,Et),gc.shadowUniformsInitialized=!1,gc.useSingleShadowCascade=!!Ve&&Ve.getMaxCascadeForTile(Et.toUnwrapped())===0,le.renderPass==="shadow"&&Ve){if(le.currentShadowCascade===1&&wt.isInsideFirstShadowMapFrustum)continue;const gt=ke.calculatePosMatrix(Et.toUnwrapped(),ke.worldSize);if(gc.tileMatrix.set(gt),gc.shadowTileMatrix=Float32Array.from(Ve.calculateShadowPassMatrixFromMatrix(gt)),gc.aabb.min.fill(0),gc.aabb.max[0]=gc.aabb.max[1]=i.aj,gc.aabb.max[2]=0,hT(wt,gc,le,Te.scope))continue}const Je=1<<Et.canonical.z,It=[((Re.x-Et.wrap)*Je-Et.canonical.x)*i.aj,(Re.y*Je-Et.canonical.y)*i.aj,Re.z*Je*i.aj];le.conflationActive&&Object.keys(wt.instancesPerModel).length>0&&le.style.isLayerClipped(Te,xe.getSource())&&wt.updateReplacement(Et,le.replacementSource,et,ze)&&(wt.uploaded=!1,wt.upload(le.context));for(let gt in wt.instancesPerModel){const Lt=wt.instancesPerModel[gt];Lt.features.length>0&&(gt=dt.evaluate(Lt.features[0].feature,{}));const At=Ie.getModel(gt,ze);if(At||Ie.hasURLBeenRequested(gt)||wt.modelUris.includes(gt)||(wt.modelUris.push(gt),wt.modelsRequested=!1),At&&At.uploaded)for(const zt of At.nodes)ly(le,Te,zt,Lt,It,Et,gc)}}}(m,s,h,g,j.type==="vector"?h.scope:""),void D();if(!j.loaded())return;if(j.type==="batched-model")return function(le,xe,Te,Pe){Te.resetLayerRenderingStats(le);const ze=le.context,ke=le.transform,Re=le.style.fog,Ie=le.shadowRenderer;if(ke.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${ke.projection.name} projection is not yet implemented`);const Ve=le.transform.getFreeCameraOptions().position,Ge=i.b$([],[Ve.x,Ve.y,Ve.z],le.transform.worldSize),ht=i.eb([],Ge),et=i.bx([]),Et=i.ec(ke.center.lat,ke.zoom),wt=i.bn([],[1,1,1/Et]);i.bo(et,et,ht);const qt=Te.paint.get("model-opacity").constantOr(1),tt=new nn(ze.gl.LEQUAL,nn.ReadWrite,le.depthRangeFor3D),dt=new nn(ze.gl.LEQUAL,nn.ReadOnly,le.depthRangeFor3D),Je=new i.cV([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),It=le.renderPass==="shadow",gt=It&&Ie?Ie.getCurrentCascadeFrustum():ke.getFrustum(ke.scaleZoom(ke.worldSize)),Lt=Te.paint.get("model-front-cutoff"),At=Lt[2]<1,zt=Eu(le,Te.paint.get("model-cutoff-fade-range")),Ft=Te.getLayerRenderingStats();(function(gn,En,fn,Pn){const yn=gn.terrain?gn.terrain.exaggeration():0,Nn=gn.transform.zoom;for(const Xn of Pn){const yr=En.getTile(Xn).getBucket(fn);yr&&(yr.setFilter(fn.filter),gn.conflationActive&&yr.updateReplacement(Xn,gn.replacementSource),yr.evaluateScale(gn,fn),gn.terrain&&yn>0&&yr.elevationUpdate(gn.terrain,yn,Xn,fn.source),yr.needsReEvaluation(gn,Nn,fn)&&yr.evaluate(fn))}})(le,xe,Te,Pe),function(){let gn,En,fn;At?(gn=Pe.length-1,En=-1,fn=-1):(gn=0,En=Pe.length,fn=1);const Pn=new Float64Array(16),yn=i.eg(),Nn=new i.P(0,0);for(let Xn=gn;Xn!==En;Xn+=fn){const yr=Pe[Xn],oi=xe.getTile(yr).getBucket(Te);if(!oi||!oi.uploaded)continue;let Qr=!1;Ie&&(Qr=Ie.getMaxCascadeForTile(yr.toUnwrapped())===0);const br=ke.calculatePosMatrix(yr.toUnwrapped(),ke.worldSize),Ji=oi.modelTraits;!It&&At&&(i.bi(Pn,br),i.ad(yn,Ge,Pn),Nn.x=yn[0],Nn.y=yn[1]);const Hi=[];oi.setFilter(Te.filter);for(const tr of oi.getNodesInfo()){if(tr.hiddenByReplacement||!tr.node.meshes)continue;const Mr=tr.node;let Lr=0;le.terrain&&Mr.elevation&&(Lr=Mr.elevation*le.terrain.exaggeration());const ai=(()=>{const $i=tr.aabb;return Je.min=[...$i.min],Je.max=[...$i.max],Je.min[2]+=Lr,Je.max[2]+=Lr,i.ad(Je.min,Je.min,br),i.ad(Je.max,Je.max,br),Je})(),Ao=tr.evaluatedScale;if(Ao[0]<=1&&Ao[1]<=1&&Ao[2]<=1&&ai.intersects(gt)===0)continue;if(!It&&At){const $i=.16666666666666666;tr.cameraCollisionOpacity=Ge[0]>ai.min[0]&&Ge[0]<ai.max[0]&&Ge[1]>ai.min[1]&&Ge[1]<ai.max[1]&&Ge[2]*Et<ai.max[2]&&Mr.footprint&&i.bS(Nn,Mr.footprint)?Math.max(tr.cameraCollisionOpacity-$i,0):Math.min(1,tr.cameraCollisionOpacity+$i)}const oo=[...br],So=Mr.anchor?Mr.anchor[0]:0,ji=Mr.anchor?Mr.anchor[1]:0;i.bo(oo,oo,[So*(Ao[0]-1),ji*(Ao[1]-1),Lr]),i.ci(Ao,i.eh)||i.cE(oo,oo,Ao);const sr=i.az([],oo,Mr.matrix),Ri=i.az([],ke.expandedFarZProjMatrix,sr),Rr=i.az([],ke.expandedFarZProjMatrix,oo),Di=i.aA([],[So,ji,Lr,1],Ri)[2];Mr.hidden=!1;let jr=qt;It||(At&&(jr*=tr.cameraCollisionOpacity,jr*=Kf(oo,ke,tr.aabb,Lt)),jr*=dT(zt,Di)),jr!==0?Hi.push({nodeInfo:tr,depth:Di,opacity:jr,wvpForNode:Ri,wvpForTile:Rr,nodeModelMatrix:sr,tileModelMatrix:oo}):Mr.hidden=!0}It||Hi.sort((tr,Mr)=>!At||tr.opacity===1&&Mr.opacity===1?tr.depth<Mr.depth?-1:1:tr.opacity===1?-1:Mr.opacity===1?1:tr.depth>Mr.depth?-1:1);for(const tr of Hi){const Mr=tr.nodeInfo,Lr=Mr.node;let ai=i.az([],wt,tr.tileModelMatrix);i.az(ai,et,ai);const Ao=i.bi([],ai);i.ee(Ao,Ao),i.cE(Ao,Ao,Mx),ai=i.az(ai,ai,Lr.matrix);const oo=le.renderPass==="light-beam",So=Te.paint.get("model-color-use-theme").constantOr("default")==="none",ji=Ji&i.em.HasMapboxMeshFeatures,sr=ji?0:Mr.evaluatedRMEA[0][2];for(let Ri=0;Ri<Lr.meshes.length;++Ri){const Rr=Lr.meshes[Ri],Di=Ri===Lr.lightMeshIndex;let jr=tr.wvpForNode;if(Di){if(!oo&&!le.terrain&&le.shadowRenderer){le.currentLayer<le.firstLightBeamLayer&&(le.firstLightBeamLayer=le.currentLayer);continue}jr=tr.wvpForTile}else if(oo)continue;const $i={defines:[]},oa=[];if(!It&&Ie&&(Ie.useNormalOffset=!!Rr.normalBuffer),Zt($i.defines,oa,Rr,le,So?null:Te.lut),ji||$i.defines.push("DIFFUSE_SHADED"),Qr&&$i.defines.push("SHADOWS_SINGLE_CASCADE"),Ft&&(It?Ft.numRenderedVerticesInShadowPass+=Rr.vertexArray.length:Ft.numRenderedVerticesInTransparentPass+=Rr.vertexArray.length),It){io(Rr,tr.nodeModelMatrix,le,Te);continue}let Ai=null;if(Re){const Vs=Md(tr.nodeModelMatrix,le.transform);if(Ai=new Float32Array(Vs),ke.projection.name!=="globe"){const Fl=Rr.aabb.min,Gc=Rr.aabb.max,[Hc,bc]=Re.getOpacityForBounds(Vs,Fl[0],Fl[1],Gc[0],Gc[1]);$i.overrideFog=Hc>=an||bc>=an}}const xa=Rr.material;let mo;xa.occlusionTexture&&xa.occlusionTexture.offsetScale&&(mo=xa.occlusionTexture.offsetScale,$i.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const za=le.getOrCreateProgram("model",$i);!It&&Ie&&Ie.setupShadowsFromMatrix(tr.tileModelMatrix,za,Ie.useNormalOffset),le.uploadCommonUniforms(ze,za,null,Ai);const xc=xa.pbrMetallicRoughness;xc.metallicFactor=.9,xc.roughnessFactor=.5;const Du=Ad(new Float32Array(jr),new Float32Array(ai),new Float32Array(Ao),new Float32Array(Lr.matrix),le,tr.opacity,xc.baseColorFactor.toRenderColor(null),xa.emissiveFactor,xc.metallicFactor,xc.roughnessFactor,xa,sr,Te,[0,0,0],mo);!Di&&(Mr.hasTranslucentParts||tr.opacity<1)&&za.draw(le,ze.gl.TRIANGLES,tt,Un.disabled,ar.disabled,Fn.backCCW,Du,Te.id,Rr.vertexBuffer,Rr.indexBuffer,Rr.segments,Te.paint,le.transform.zoom,void 0,oa),za.draw(le,ze.gl.TRIANGLES,Di?dt:tt,Un.disabled,Di||tr.opacity<1||Mr.hasTranslucentParts?ar.alphaBlended:ar.unblended,Fn.backCCW,Du,Te.id,Rr.vertexBuffer,Rr.indexBuffer,Rr.segments,Te.paint,le.transform.zoom,void 0,oa)}}}}()}(m,s,h,g),void D();if(j.type!=="model")return;const W=j.getModels(),K=[],Z=m.transform.getFreeCameraOptions().position,ee=i.b$([],[Z.x,Z.y,Z.z],m.transform.worldSize);i.eb(ee,ee);const se=[],oe=[];let he=0;for(const le of W){const xe=h.paint.get("model-rotation").constantOr(null),Te=h.paint.get("model-scale").constantOr(null),Pe=h.paint.get("model-translation").constantOr(null);le.computeModelMatrix(m,xe,Te,Pe,!0,!0,!1);const ze=i.bx([]),ke=i.ec(le.position.lat,m.transform.zoom),Re=i.bn([],[1,1,1/ke]);i.bo(ze,ze,ee),K.push({zScaleMatrix:Re,negCameraPosMatrix:ze});for(const Ie of le.nodes)Od(m.transform,Ie,le.matrix,m.transform.expandedFarZProjMatrix,he,se,oe);he++}if(se.sort((le,xe)=>xe.depth-le.depth),m.renderPass!=="shadow"){if(w===1)for(const le of oe)cn(le,m,h,K[le.modelIndex],Un.disabled,m.colorModeForRenderPass());else{for(const le of oe)cn(le,m,h,K[le.modelIndex],Un.disabled,ar.disabled);for(const le of oe)cn(le,m,h,K[le.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const le of se)cn(le,m,h,K[le.modelIndex],Un.disabled,m.colorModeForRenderPass());D()}else{for(const le of oe)io(le.mesh,le.nodeModelMatrix,m,h);for(const le of se)io(le.mesh,le.nodeModelMatrix,m,h);D()}}},Dx={line:function(m,s,h){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const g=s.getVisibleCoordinates();for(const w of g){const S=s.getTile(w).getBucket(m);if(S&&(S.elevationType!=="none"?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,s,h){const g=s.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,g.type==="vector"?m.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const w=g.getModels();for(const S of w)S.upload(h.context)},raster:function(m,s,h){const g=s.getSource();if(!(g instanceof Il&&g.loaded()))return;const w=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!w)return;const S=m.paint.get("raster-array-band")||g.getInitialBand(w);if(S==null)return;const P=s.getIds().map(M=>s.getTileByID(M));for(const M of P)M.updateNeeded(w,S)&&g.prepareTile(M,w,S)},"raster-particle":function(m,s,h){const g=s.getSource();if(!(g instanceof Il&&g.loaded()))return;const w=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!w)return;const S=m.paint.get("raster-particle-array-band")||g.getInitialBand(w);if(S==null)return;const P=s.getIds().map(M=>s.getTileByID(M));for(const M of P)M.updateNeeded(w,S)&&g.prepareTile(M,w,S)}},Ou={fill:Jm};class hy{constructor(s,h,g,w,S){this.context=new Gf(s,h),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const P=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const D of P)this._debugParams.enabledLayers[D]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const D of P)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],D);this.occlusionParams=new fT(S),this.setup(),this.numSublayers=_a.maxUnderzooming+_a.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new dx(this),this._wireframeDebugCache=new dM,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const M=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,M,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=w}updateTerrain(s,h){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Z_(this,s));const w=this._terrain;this.transform.elevation=g?w:null,w.update(s,this.transform,h),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(s){const h=s.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,w]=h.getFovAdjustedRange(this.transform._fov);if(g>w)return void(this.transform.fogCullDistSq=null);const S=g+.78*(w-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new Z_(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,h){if(this.width=s*i.q.devicePixelRatio,this.height=h*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const s=this.context,h=new i.ba;h.emplaceBack(0,0),h.emplaceBack(i.aj,0),h.emplaceBack(0,i.aj),h.emplaceBack(i.aj,i.aj),this.tileExtentBuffer=s.createVertexBuffer(h,i.bc.members),this.tileExtentSegments=i.bd.simpleSegment(0,0,4,2);const g=new i.ba;g.emplaceBack(0,0),g.emplaceBack(i.aj,0),g.emplaceBack(0,i.aj),g.emplaceBack(i.aj,i.aj),this.debugBuffer=s.createVertexBuffer(g,i.bc.members),this.debugSegments=i.bd.simpleSegment(0,0,4,5);const w=new i.ba;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(w,i.bc.members),this.viewportSegments=i.bd.simpleSegment(0,0,4,2);const S=new i.aZ;S.emplaceBack(0,0,0,0),S.emplaceBack(i.aj,0,i.aj,0),S.emplaceBack(0,i.aj,0,i.aj),S.emplaceBack(i.aj,i.aj,i.aj,i.aj),this.mercatorBoundsBuffer=s.createVertexBuffer(S,i.bf.members),this.mercatorBoundsSegments=i.bd.simpleSegment(0,0,4,2);const P=new i.a_;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(P);const M=new i.bb;for(const j of[0,1,3,2,0])M.emplaceBack(j);this.debugIndexBuffer=s.createIndexBuffer(M),this.emptyTexture=new i.T(s,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.bz();const D=this.context.gl;this.stencilClearMode=new Un({func:D.ALWAYS,mask:0},0,255,D.ZERO,D.ZERO,D.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,nn.disabled,this.stencilClearMode,ar.disabled,Fn.disabled,Ls(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,h,g){if(!h||this.currentStencilSource===h.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const D of g)if(this._tileClippingMaskIDs[D.key]===void 0){M=!0;break}if(!M)return}this.currentStencilSource=h.id;const w=this.context,S=w.gl;this.nextStencilID+g.length>256&&this.clearStencil(),w.setColorMode(ar.disabled),w.setDepthMode(nn.disabled);const P=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of g){const D=h.getTile(M),j=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:K,tileBoundsSegments:Z}=this.getTileBoundsBuffers(D);P.draw(this,S.TRIANGLES,nn.disabled,new Un({func:S.ALWAYS,mask:0},j,255,S.KEEP,S.KEEP,S.REPLACE),ar.disabled,Fn.disabled,Ls(M.projMatrix),"$clipping",W,K,Z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,h=this.context.gl;return new Un({func:h.NOTEQUAL,mask:255},s,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const h=this.context.gl;return new Un({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(s){const h=this.context.gl,g=s.sort((P,M)=>M.overscaledZ-P.overscaledZ),w=g[g.length-1].overscaledZ,S=g[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const P={};for(let M=0;M<S;M++)P[M+w]=new Un({func:h.GEQUAL,mask:255},M+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=S,[P,g]}return[{[w]:Un.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new ar([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ar.unblended:ar.alphaBlended}colorModeForDrapableLayerRenderPass(s){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ar([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new i.am(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,h,g,w=!1){if(this.depthOcclusion)return new nn(this.context.gl.GREATER,nn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return nn.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new nn(g||this.context.gl.LEQUAL,h,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,h=Math.ceil(this.width),g=Math.ceil(this.height),w=this.context.bindFramebuffer.get(),S=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===h&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),h!==0&&g!==0&&(this.depthFBO=new ny(this.context,h,g,!1,"texture"),this.depthTexture=new i.T(this.context,{width:h,height:g,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(w),s.bindTexture(s.TEXTURE_2D,S),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,h,g,0,0,h,g,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,h)=>s+h/this._fpsHistory.length,0))}render(s,h){const g=i.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=h;const w=this.style._mergedLayers,S=!(!this.terrain||!this.terrain.enabled),P=()=>this.style._getOrder(S).filter(tt=>{const dt=w[tt];return!(dt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[dt.type]});let M=P(),D=!1,j=!1;for(const tt of M){const dt=w[tt];dt.type==="circle"&&(D=!0),dt.type==="symbol"&&(dt.hasInitialOcclusionOpacityProperties?j=!0:D=!0)}let W=M.map(tt=>w[tt]);const K=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let Z=0,ee=!1;for(const tt in K){const dt=K[tt];dt.used&&(dt.prepare(this.context),dt.getSource().usedInConflation&&++Z)}let se=!1;for(const tt of W)tt.isHidden(this.transform.zoom)||(tt.type==="clip"&&(se=!0),this.prepareLayer(tt));const oe={},he={},le={},xe={},Te={};for(const tt in K){const dt=K[tt];oe[tt]=dt.getVisibleCoordinates(),he[tt]=oe[tt].slice().reverse(),le[tt]=dt.getVisibleCoordinates(!0).reverse(),xe[tt]=dt.getShadowCasterCoordinates(),Te[tt]=dt.sortCoordinatesByDistance(oe[tt])}const Pe=tt=>{const dt=this.style.getLayerSourceCache(tt);return dt&&dt.used?dt.getSource():null};if(Z||se||this._clippingActiveLastFrame){const tt=[],dt=[];let Je=0;for(const It of W)this.isSourceForClippingOrConflation(It,Pe(It))&&(tt.push(It),dt.push(Je)),Je++;if(tt&&(se||tt.length>1)||this._clippingActiveLastFrame){se=!1;const It=[];for(let gt=0;gt<tt.length;gt++){const Lt=tt[gt],At=dt[gt],zt=this.style.getLayerSourceCache(Lt);if(!zt||!zt.used||!zt.getSource().usedInConflation&&Lt.type!=="clip")continue;let Ft=i.ev,gn=i.bQ.None;const En=[];let fn=!0;if(Lt.type==="clip"){Ft=At;for(const Pn of Lt.layout.get("clip-layer-types"))gn|=Pn==="model"?i.bQ.Model:Pn==="symbol"?i.bQ.Symbol:i.bQ.FillExtrusion;for(const Pn of Lt.layout.get("clip-layer-scope"))En.push(Pn);Lt.isHidden(this.transform.zoom)?fn=!1:se=!0}fn&&It.push({layer:Lt.fqid,cache:zt,order:Ft,clipMask:gn,clipScope:En})}this.replacementSource.setSources(It),ee=!0}}this._clippingActiveLastFrame=se,ee||this.replacementSource.clear(),this.conflationActive=ee,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let tt=0;tt<W.length;tt++){const dt=W[tt],Je=dt.cutoffRange();if(this.longestCutoffRange=Math.max(Je,this.longestCutoffRange),Je>0){const It=Pe(dt);It&&(this.minCutoffZoom=Math.max(It.minzoom,this.minCutoffZoom)),dt.minzoom&&(this.minCutoffZoom=Math.max(dt.minzoom,this.minCutoffZoom))}dt.is3D(S)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=tt),this._lastOcclusionLayer=tt)}const ze=this.style&&this.style.fog;ze?(this._fogVisible=ze.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=ze.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(le),this.opaquePassCutoff=0,M=P(),W=M.map(tt=>w[tt]));const ke=this._shadowRenderer;if(ke){ke.updateShadowParameters(this.transform,this.style.directionalLight);for(const tt in K)for(const dt of oe[tt]){let Je={min:0,max:0};this.terrain&&(Je=this.terrain.getMinMaxForTile(dt)||Je),ke.addShadowReceiver(dt.toUnwrapped(),Je.min,Je.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eu(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Xf(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Re=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ie=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Re&&!this._snow&&(this._snow=new Bi(this)),!Re&&this._snow&&(this._snow.destroy(),delete this._snow),Ie&&!this._rain&&(this._rain=new fM(this)),!Ie&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!hn.has(this.context.gl))return;this.renderPass="offscreen";for(const tt of W){const dt=s.getLayerSourceCache(tt);if(!tt.hasOffscreenPass()||tt.isHidden(this.transform.zoom))continue;const Je=dt?he[dt.id]:void 0;(tt.type==="custom"||tt.type==="raster"||tt.type==="raster-particle"||tt.isSky()||Je&&Je.length)&&this.renderLayer(this,dt,tt,Je)}this.depthRangeFor3D=[0,1-(W.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,xe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ve=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ge=(()=>{if(h.showOverdrawInspector)return i.am.black;const tt=this.style.fog;if(tt&&this.transform.projection.supportsFog){const dt=this.style.getLut(tt.scope);if(!Ve){const Je=tt.properties.get("color-use-theme")==="none",It=tt.properties.get("color").toRenderColor(Je?null:dt).toArray01();return new i.am(...It)}if(Ve){const Je=tt.properties.get("space-color-use-theme")==="none",It=tt.properties.get("space-color").toRenderColor(Je?null:dt).toArray01();return new i.am(...It)}}return i.am.transparent})();if(this.context.clear({color:Ge,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){const tt=W[this.currentLayer],dt=s.getLayerSourceCache(tt);if(tt.isSky())continue;const Je=dt?(tt.is3D(S)?Te:he)[dt.id]:void 0;this._renderTileClippingMasks(tt,dt,Je),this.renderLayer(this,dt,tt,Je)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){const tt=W[this.currentLayer],dt=s.getLayerSourceCache(tt);tt.isSky()&&this.renderLayer(this,dt,tt,dt?he[dt.id]:void 0)}function ht(tt,dt){let Je;return dt&&(Je=(tt.type==="symbol"?le:tt.is3D(S)?Te:he)[dt.id]),Je}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<M.length;){const tt=W[this.currentLayer];if(tt.type==="raster"||tt.type==="raster-particle"){const dt=s.getLayerSourceCache(tt);this.renderLayer(this,dt,tt,ht(tt,dt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let et=0;ke&&(et=ke.getShadowCastingLayerCount());let Et=!1,wt=-1;for(let tt=0;tt<M.length;++tt){const dt=W[tt];dt.isHidden(this.transform.zoom)||dt.is3D(S)&&(wt=tt)}j&&wt===-1&&(D=!0);let qt=!1;for(;this.currentLayer<M.length;){const tt=W[this.currentLayer],dt=s.getLayerSourceCache(tt);if(tt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(tt)){if(tt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!qt&&tt.is3D(S)&&!S){const Je=this.currentLayer,It=gt=>{for(this.currentLayer=0;this.currentLayer<W.length;this.currentLayer++){const Lt=W[this.currentLayer];if(Ou[Lt.type]){const At=this.style.getLayerSourceCache(Lt);Ou[Lt.type](this,At,Lt,ht(Lt,At),gt)}}};It("initialize"),It("reset"),this.currentLayer=Je,qt=!0}if(D&&!Et&&this.terrain&&!this.transform.isOrthographic&&(Et=!0,this.blitDepth()),j&&wt!==-1&&this.currentLayer===wt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(tt,dt,dt?oe[dt.id]:void 0),this.renderLayer(this,dt,tt,ht(tt,dt)),!this.terrain&&ke&&et>0&&tt.hasShadowPass()&&--et==0&&(ke.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Je=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Je;this.currentLayer++){const It=W[this.currentLayer];if(!It.hasLightBeamPass())continue;const gt=s.getLayerSourceCache(It);this.renderLayer(this,gt,It,gt?he[gt.id]:void 0)}this.currentLayer=Je,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Je=this.currentLayer;this.depthOcclusion=!0;for(const It of this.layersWithOcclusionOpacity){this.currentLayer=It;const gt=W[this.currentLayer],Lt=s.getLayerSourceCache(gt),At=Lt?he[Lt.id]:void 0;this.terrain||this._renderTileClippingMasks(gt,Lt,Lt?oe[Lt.id]:void 0),this.renderLayer(this,Lt,gt,At)}this.depthOcclusion=!1,this.currentLayer=Je,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let tt=null;W.forEach(dt=>{const Je=s.getLayerSourceCache(dt);Je&&!dt.isHidden(this.transform.zoom)&&Je.getVisibleCoordinates().length&&(!tt||tt.getSource().maxzoom<Je.getSource().maxzoom)&&(tt=Je)}),tt&&this.options.showTileBoundaries&&zr.debug(this,tt,tt.getVisibleCoordinates(),i.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&zr.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(tt){const dt=tt.transform.padding;oy(tt,tt.transform.height-(dt.top||0),3,Px),oy(tt,dt.bottom||0,3,Cx),ay(tt,dt.left||0,3,Ix),ay(tt,tt.transform.width-(dt.right||0),3,Us);const Je=tt.transform.centerPoint;(function(It,gt,Lt,At){Zf(It,gt-1,Lt-10,2,20,At),Zf(It,gt-10,Lt-1,20,2,At)})(tt,Je.x,tt.transform.height-Je.y,kh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ee||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:h}=this.transform.projection,g=!h||!h.includes(s.type);if(Dx[s.type]&&(g||this.terrain&&s.type==="custom")){const w=this.style.getLayerSourceCache(s);Dx[s.type](s,w,this)}this.gpuTimingEnd()}renderLayer(s,h,g,w){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||w&&w.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||g.type!=="custom")||g.type==="clip"||zr[g.type](s,h,g,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,g=this.context.gl;let w=this.gpuTimers[s.id];w||(w=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),w.calls++,g.beginQuery(h.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,h=this.context.gl,g=h.createQuery();this.deferredRenderGpuTimeQueries.push(g),h.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const h={};for(const g in s){const w=s[g],S=this.context.extTimerQuery,P=S.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(w.query),h[g]=P}return h}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.gl;let g=0;for(const w of s)g+=h.getQueryParameter(w,h.QUERY_RESULT)/1e6,h.deleteQuery(w);return g}translatePosMatrix(s,h,g,w,S){if(!g[0]&&!g[1])return s;const P=S?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(P){const j=Math.sin(P),W=Math.cos(P);g=[g[0]*W-g[1]*j,g[0]*j+g[1]*W]}const M=[S?g[0]:i.aw(h,g[0],this.transform.zoom),S?g[1]:i.aw(h,g[1],this.transform.zoom),0],D=new Float32Array(16);return i.bo(D,s,M),D}saveTileTexture(s){const h=s.size[0],g=this._tileTextures[h];g?g.push(s):this._tileTextures[h]=[s]}getTileTexture(s){const h=this._tileTextures[s];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,h,g){const w=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,S=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||w||h!==void 0&&!h||S.push("FOG","FOG_DITHERING"),w&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(s,h){this.cache=this.cache||{};const g=h&&h.defines||[],w=h&&h.config,S=this.currentGlobalDefines(s,h&&h.overrideFog,h&&h.overrideRtt).concat(g),P=K_.cacheKey(Iu[s],s,S,w);return this.cache[P]||(this.cache[P]=new K_(this.context,s,Iu[s],w,iM[s],S)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,h){if(this.style.enable3dLights()){const g=this.style.directionalLight,w=this.style.ambientLight;if(g&&w){const S=((P,M,D)=>{const j=P.properties.get("direction"),W=P.properties.get("color-use-theme")==="none",K=P.properties.get("color").toRenderColor(W?null:D.getLut(P.scope)).toArray01(),Z=P.properties.get("intensity"),ee=M.properties.get("color-use-theme")==="none",se=M.properties.get("color").toRenderColor(ee?null:D.getLut(M.scope)).toArray01(),oe=M.properties.get("intensity"),he=[j.x,j.y,j.z],le=i.dw(se,oe),xe=i.dw(K,Z);return{u_lighting_ambient_color:le,u_lighting_directional_dir:he,u_lighting_directional_color:xe,u_ground_radiance:gx(he,xe,le)}})(g,w,this.style);h.setLightsUniformValues(s,S)}}}uploadCommonUniforms(s,h,g,w,S){if(this.uploadCommonLightUniforms(s,h),this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const M=P.getOpacity(this.transform.pitch),D=((j,W,K,Z,ee,se,oe,he,le,xe,Te,Pe)=>{const ze=j.transform,ke=W.properties.get("color-use-theme")==="none",Re=W.properties.get("color").toRenderColor(ke?null:j.style.getLut(W.scope)).toArray01();Re[3]=Z;const Ie=j.frameCounter/1e3%1,[Ve,Ge]=W.properties.get("vertical-range");return{u_fog_matrix:K?ze.calculateFogTileMatrix(K):Pe||j.identityMat,u_fog_range:W.getFovAdjustedRange(ze._fov),u_fog_color:Re,u_fog_horizon_blend:W.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ve,Ge),Ge],u_fog_temporal_offset:Ie,u_frustum_tl:ee,u_frustum_tr:se,u_frustum_br:oe,u_frustum_bl:he,u_globe_pos:le,u_globe_radius:xe,u_viewport:Te,u_globe_transition:i.ah(ze.zoom),u_is_globe:+(ze.projection.name==="globe")}})(this,P,g,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],w);h.setFogUniformValues(s,D)}S&&h.setCutoffUniformValues(s,S.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,h=s.createTexture();return s.bindTexture(s.TEXTURE_2D,h),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,h=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const w of g)h[w.key]=s[w.key]||new il(w,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,h){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!h||h.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[s.key];return h||(this._cachedTileFogOpacities[s.key]=h=this.style.fog.getOpacityForTile(s)),h[0]>=an||h[1]>=an}setupDepthForOcclusion(s,h,g){const w=this.context,S=w.gl,P=!!g;var M;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),w.activeTexture.set(S.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((M=this.depthRangeFor3D)[1]-M[0]),-1-2*M[0]/(M[1]-M[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),w.activeTexture.set(S.TEXTURE0),P||h.setTerrainUniformValues(w,g)}}function Rd(m,s){let h=!1,g=null;const w=()=>{g=null,h&&(m(),g=setTimeout(w,s),h=!1)};return()=>(h=!0,g||w(),g)}class Yf{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Rd(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const h=dy(s);if(this._hashName){const g=this._hashName;let w=!1;const S=location.hash.slice(1).split("&").map(P=>{const M=P.split("=")[0];return M===g?(w=!0,`${M}=${h}`):P}).filter(P=>P);return w||S.push(`${g}=${h}`),`#${S.join("&")}`}return`#${h}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(h=g)}),(h&&h[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(g=>isNaN(Number(g)))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(h[3]||0):s.getBearing();return s.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function dy(m,s){const h=m.getCenter(),g=Math.round(100*m.getZoom())/100,w=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),P=Math.round(h.lng*S)/S,M=Math.round(h.lat*S)/S,D=m.getBearing(),j=m.getPitch();let W=s?`/${P}/${M}/${g}`:`${g}/${M}/${P}`;return(D||j)&&(W+="/"+Math.round(10*D)/10),j&&(W+=`/${Math.round(j)}`),W}const Jf={linearity:.3,easing:i.ew(0,0,.3,1)},Lx=i.l({deceleration:2500,maxSpeed:1400},Jf),zx=i.l({deceleration:20,maxSpeed:1400},Jf),Uc=i.l({deceleration:1e3,maxSpeed:360},Jf),ku=i.l({deceleration:1e3,maxSpeed:90},Jf);class fy{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,h=i.q.now();for(;s.length>0&&h-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)h.zoom+=S.zoomDelta||0,h.bearing+=S.bearingDelta||0,h.pitch+=S.pitchDelta||0,S.panDelta&&h.pan._add(S.panDelta),S.around&&(h.around=S.around),S.pinchAround&&(h.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(h.pan.mag()){const S=Qf(h.pan.mag(),g,i.l({},Lx,s||{}));w.offset=h.pan.mult(S.amount/h.pan.mag()),w.center=this._map.transform.center,Dd(w,S)}if(h.zoom){const S=Qf(h.zoom,g,zx);w.zoom=this._map.transform.zoom+S.amount,Dd(w,S)}if(h.bearing){const S=Qf(h.bearing,g,Uc);w.bearing=this._map.transform.bearing+i.aD(S.amount,-179,179),Dd(w,S)}if(h.pitch){const S=Qf(h.pitch,g,ku);w.pitch=this._map.transform.pitch+S.amount,Dd(w,S)}if(w.zoom||w.bearing){const S=h.pinchAround===void 0?h.around:h.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Dd(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function Qf(m,s,h){const{maxSpeed:g,linearity:w,deceleration:S}=h,P=i.aD(m*w/(s/1e3),-g,g),M=Math.abs(P)/(S*w);return{easing:h.easing,duration:1e3*M,amount:P*(M/2)}}class zs extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,g,w={}){const S=ye(h.getCanvasContainer(),g),P=h.unproject(S);super(s,i.l({point:S,lngLat:P,originalEvent:g},w)),this._defaultPrevented=!1,this.target=h}}class Vc extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,g){const w=s==="touchend"?g.changedTouches:g.touches,S=De(h.getCanvasContainer(),w),P=S.map(D=>h.unproject(D)),M=S.reduce((D,j,W,K)=>D.add(j.div(K.length)),new i.P(0,0));super(s,{points:S,point:M,lngLats:P,lngLat:h.unproject(M),originalEvent:g}),this._defaultPrevented=!1}}class Nx extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h){super("wheel",{originalEvent:h}),this._defaultPrevented=!1}}class Lh{constructor(s,h){this._map=s,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new Nx(this._map,s))}mousedown(s,h){return this._mousedownPos=h,this._firePreventable(new zs(s.type,this._map,s))}mouseup(s){this._map.fire(new zs(s.type,this._map,s))}preclick(s){const h=i.l({},s);h.type="preclick",this._map.fire(new zs(h.type,this._map,h))}click(s,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(s),this._map.fire(new zs(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new zs(s.type,this._map,s))}mouseover(s){this._map.fire(new zs(s.type,this._map,s))}mouseout(s){this._map.fire(new zs(s.type,this._map,s))}touchstart(s){return this._firePreventable(new Vc(s.type,this._map,s))}touchmove(s){this._map.fire(new Vc(s.type,this._map,s))}touchend(s){this._map.fire(new Vc(s.type,this._map,s))}touchcancel(s){this._map.fire(new Vc(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fx{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new zs(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new zs(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class py{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,h){this.isEnabled()&&s.shiftKey&&s.button===0&&(Q(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(s,h){if(!this._active)return;const g=h,w=this._startPos,S=this._lastPos;if(!w||!S||S.equals(g)||!this._box&&g.dist(w)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=N("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const P=Math.min(w.x,g.x),M=Math.max(w.x,g.x),D=Math.min(w.y,g.y),j=Math.max(w.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${D}px)`,this._box.style.width=M-P+"px",this._box.style.height=j-D+"px")})}mouseupWindow(s,h){if(!this._active)return;const g=this._startPos,w=h;if(g&&s.button===0){if(this.reset(),fe(),g.x!==w.x||g.y!==w.y)return this._map.fire(new i.A("boxzoomend",{originalEvent:s})),{cameraAnimation:S=>S.fitScreenCoordinates(g,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),te(),delete this._startPos,delete this._lastPos}_fireEvent(s,h){return this._map.fire(new i.A(s,{originalEvent:h}))}}function ig(m,s){const h={};for(let g=0;g<m.length;g++)h[m[g].identifier]=s[g];return h}class Bx{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(w){const S=new i.P(0,0);for(const P of w)S._add(P);return S.div(w.length)}(h),this.touches=ig(g,h)))}touchmove(s,h,g){if(this.aborted||!this.centroid)return;const w=ig(g,h);for(const S in this.touches){const P=w[S];(!P||P.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(s,h,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class ia{constructor(s){this.singleTap=new Bx(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,h,g){this.singleTap.touchstart(s,h,g)}touchmove(s,h,g){this.singleTap.touchmove(s,h,g)}touchend(s,h,g){const w=this.singleTap.touchend(s,h,g);if(w){const S=s.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(S&&P||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class jx{constructor(){this._zoomIn=new ia({numTouches:1,numTaps:2}),this._zoomOut=new ia({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,h,g){this._zoomIn.touchstart(s,h,g),this._zoomOut.touchstart(s,h,g)}touchmove(s,h,g){this._zoomIn.touchmove(s,h,g),this._zoomOut.touchmove(s,h,g)}touchend(s,h,g){const w=this._zoomIn.touchend(s,h,g),S=this._zoomOut.touchend(s,h,g);return w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:s})}):S?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(S)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const $x={0:1,2:2},zh={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class og{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,h){return!1}_move(s,h){return{}}mousedown(s,h){if(this._lastPoint)return;const g=Ne(s);this._correctButton(s,g)&&(this._lastPoint=h,this._eventButton=g)}mousemoveWindow(s,h){const g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(w,S){const P=$x[S];return w.buttons===void 0||(w.buttons&P)!==P}(s,this._eventButton))this.reset();else if(this._moved||!(h.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(g,h)}}mouseupWindow(s){this._lastPoint&&Ne(s)===this._eventButton&&(this._moved&&fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ux extends og{mousedown(s,h){super.mousedown(s,h),this._lastPoint&&(this._active=!0)}_correctButton(s,h){return h===0&&!s.ctrlKey}_move(s,h){return{around:h,panDelta:h.sub(s)}}}class my extends og{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?zh[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const g=.8*(h.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Ld extends og{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?zh[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const g=-.5*(h.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Vx{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),i.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,h,g){return this._calculateTransform(s,h,g)}touchmove(s,h,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!i.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,h,g)}}touchend(s,h,g){this._calculateTransform(s,h,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,h,g){g.length>0&&(this._active=!0);const w=ig(g,h),S=new i.P(0,0),P=new i.P(0,0);let M=0;for(const j in w){const W=w[j],K=this._touches[j];K&&(S._add(W),P._add(W.sub(K)),M++,w[j]=W)}if(this._touches=w,M<this._minTouches||!P.mag())return;const D=P.div(M);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(M),panDelta:D}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class ag{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,h,g){return{}}touchstart(s,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(s,h,g){const w=this._firstTwoTouches;if(!w)return;s.preventDefault();const[S,P]=w,M=ep(g,h,S),D=ep(g,h,P);if(!M||!D)return;const j=this._aroundCenter?null:M.add(D).div(2);return this._move([M,D],j,s)}touchend(s,h,g){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,P=ep(g,h,w),M=ep(g,h,S);P&&M||(this._active&&fe(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ep(m,s,h){for(let g=0;g<m.length;g++)if(m[g].identifier===h)return s[g]}function sg(m,s){return Math.log(m/s)/Math.LN2}class Wx extends ag{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,h){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(sg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sg(this._distance,g),pinchAround:h}}}function gy(m,s){return 180*m.angleWith(s)/Math.PI}class mT extends ag{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,h){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:gy(this._vector,g),pinchAround:h}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const h=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const w=gy(s,g);return Math.abs(w)<h}}function _y(m){return Math.abs(m.y)>Math.abs(m.x)}class gT extends ag{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,_y(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,h,g){const w=this._lastPoints;if(!w)return;const S=s[0].sub(w[0]),P=s[1].sub(w[1]);return this._map._cooperativeGestures&&!i.ex()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,P,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(S.y+P.y)/2*-.5})}gestureBeginsVertically(s,h,g){if(this._valid!==void 0)return this._valid;const w=s.mag()>=2,S=h.mag()>=2;if(!w&&!S)return;if(!w||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const P=s.y>0==h.y>0;return _y(s)&&_y(h)&&P}}const _T={panStep:100,bearingStep:15,pitchStep:10};class yT{constructor(){const s=_T;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let h=0,g=0,w=0,S=0,P=0;switch(s.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),S=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),S=1);break;case 38:s.shiftKey?w=1:(s.preventDefault(),P=-1);break;case 40:s.shiftKey?w=-1:(s.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:M=>{const D=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:vT,zoom:h?Math.round(D)+h*(s.shiftKey?2:1):D,bearing:M.getBearing()+g*this._bearingStep,pitch:M.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-P*this._panStep],center:M.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function vT(m){return m*(2-m)}const Gx=4.000244140625,xT=1/450;class bT{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=xT,i.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=i.q.now(),w=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%Gx==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=h,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(w*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),s.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=s,this._delta-=h,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ye(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const j=this._type==="wheel"&&Math.abs(this._delta)>Gx?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&W!==0&&(W=1/W);const K=h(),Z=Math.pow(2,K),ee=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(ee*W))),this._type==="wheel"&&(this._startZoom=K,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:h(),w=this._startZoom,S=this._easing;let P,M=!1;if(this._type==="wheel"&&w&&S){const j=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),W=S(j);P=i.ai(w,g,W),j<1?this._frameId||(this._frameId=!0):M=!0}else P=g,M=!0;this._active=!0,M&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let D=P-h();return D*this._lastDelta<0&&(D=0),{noInertia:!0,needsRenderFrame:!M,zoomDelta:D,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let h=i.ey;if(this._prevEase){const g=this._prevEase,w=(i.q.now()-g.start)/g.duration,S=g.easing(w+.01)-g.easing(w),P=.27/Math.sqrt(S*S+1e-4)*.01,M=Math.sqrt(.0729-P*P);h=i.ew(P,M,.25,1)}return this._prevEase={start:i.q.now(),duration:s,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class wT{constructor(s,h){this._clickZoom=s,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ST{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,h){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(h)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class TT{constructor(){this._tap=new ia({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,h,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=h[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,h,g))}touchmove(s,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const w=h[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,s.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(s,h,g)}touchend(s,h,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,h,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ET{constructor(s,h,g){this._el=s,this._mousePan=h,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class pM{constructor(s,h,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class mM{constructor(s,h,g,w){this._el=s,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qi=m=>m.zoom||m.drag||m.pitch||m.rotate;class AT extends i.A{}class gM{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,h){const g=i.at([],h,s);this.radius=i.ae(g[2]<0?i.eA([],g,this.constants):[g[0],g[1],0])}projectRay(s){i.eA(s,s,this.constants),i.au(s,s),i.eB(s,s,this.constants);const h=i.b$([],s,this.radius);if(h[2]>0){const g=i.b$([],[0,0,1],i.bE(h,[0,0,1])),w=i.b$([],i.au([],[h[0],h[1],0]),this.radius),S=i.cU([],h,i.b$([],i.at([],i.cU([],w,g),h),2));h[0]=S[0],h[1]=S[1]}return h}}function tp(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class _M{constructor(s,h){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fy(s),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new gM,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),i.aV(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,S,P]of this._listeners){const M=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(S,M,P)}}destroy(){for(const[s,h,g]of this._listeners){const w=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(h,w,g)}}_addDefaultHandlers(s){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new Lh(h,s));const w=h.boxZoom=new py(h,s);this._add("boxZoom",w);const S=new jx,P=new ST;h.doubleClickZoom=new wT(P,S),this._add("tapZoom",S),this._add("clickZoom",P);const M=new TT;this._add("tapDragZoom",M);const D=h.touchPitch=new gT(h);this._add("touchPitch",D);const j=new my(s),W=new Ld(s);h.dragRotate=new pM(s,j,W),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const K=new Ux(s),Z=new Vx(h,s);h.dragPan=new ET(g,K,Z),this._add("mousePan",K),this._add("touchPan",Z,["touchZoom","touchRotate"]);const ee=new mT,se=new Wx;h.touchZoomRotate=new mM(g,se,ee,M),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fx(h));const oe=h.scrollZoom=new bT(h,this);this._add("scrollZoom",oe,["mousePan"]);const he=h.keyboard=new yT;this._add("keyboard",he);for(const le of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[le]&&h[le].enable(s[le])}_add(s,h,g){this._handlers.push({handlerName:s,handler:h,allowed:g}),this._handlersById[s]=h}stop(s){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qi(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,h,g){for(const w in s)if(w!==g&&(!h||h.indexOf(w)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const h=[];for(const g of s)this._el.contains(g.target)&&h.push(g);return h}handleEvent(s,h){this._updatingCamera=!0;const g=s.type==="renderFrame",w=g?void 0:s,S={needsRenderFrame:!1},P={},M={},D=s.touches?this._getMapTouches(s.touches):void 0,j=D?De(this._el,D):g?void 0:ye(this._el,s);for(const{handlerName:Z,handler:ee,allowed:se}of this._handlers){if(!ee.isEnabled())continue;let oe;this._blockedByActive(M,se,Z)?ee.reset():ee[h||s.type]&&(oe=ee[h||s.type](s,j,D),this.mergeHandlerResult(S,P,oe,Z,w),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ee.isActive())&&(M[Z]=ee)}const W={};for(const Z in this._previousActiveHandlers)M[Z]||(W[Z]=w);this._previousActiveHandlers=M,(Object.keys(W).length||tp(S))&&(this._changes.push([S,P,W]),this._triggerRenderFrame()),(Object.keys(M).length||tp(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=S;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(s,h,g,w,S){if(!g)return;i.l(s,g);const P={handlerName:w,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(h.zoom=P),g.panDelta!==void 0&&(h.drag=P),g.pitchDelta!==void 0&&(h.pitch=P),g.bearingDelta!==void 0&&(h.rotate=P)}_applyChanges(){const s={},h={},g={};for(const[w,S,P]of this._changes)w.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(w.panDelta)),w.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(s.around=w.around),w.aroundCoord!==void 0&&(s.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(s.pinchAround=w.pinchAround),w.noInertia&&(s.noInertia=w.noInertia),i.l(h,S),i.l(g,P);this._updateMapTransform(s,h,g),this._changes=[]}_updateMapTransform(s,h,g){const w=this._map,S=w.transform,P=xe=>[xe.x,xe.y,xe.z];if((xe=>{const Te=this._eventsInProgress.drag;return Te&&!this._handlersById[Te.handlerName].isActive()})()&&!tp(s)){const xe=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),xe!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&w._stop(!0),!tp(s))return void this._fireEvents(h,g,!0);let{panDelta:M,zoomDelta:D,bearingDelta:j,pitchDelta:W,around:K,aroundCoord:Z,pinchAround:ee}=s;S._isCameraConstrained&&(D>0&&(D=0),S._isCameraConstrained=!1),ee!==void 0&&(K=ee),(D||(xe=>h[xe]&&!this._eventsInProgress[xe])("drag"))&&K&&(this._dragOrigin=P(S.pointCoordinate3D(K)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",w._stop(!0),K=K||w.transform.centerPoint,j&&(S.bearing+=j),W&&(S.pitch+=W),S._updateCameraState();const se=[0,0,0];if(M)if(S.projection.name==="mercator"){const xe=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(K).dir),Te=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(K.sub(M)).dir);se[0]=Te[0]-xe[0],se[1]=Te[1]-xe[1]}else{const xe=S.pointCoordinate(K);if(S.projection.name==="globe"){M=M.rotate(-S.angle);const Te=S._pixelsPerMercatorPixel/S.worldSize;se[0]=-M.x*i.ez(i.aY(xe.y))*Te,se[1]=-M.y*i.ez(S.center.lat)*Te}else{const Te=S.pointCoordinate(K.sub(M));xe&&Te&&(se[0]=Te.x-xe.x,se[1]=Te.y-xe.y)}}const oe=S.zoom,he=[0,0,0];if(D){const xe=P(Z||S.pointCoordinate3D(K)),Te={dir:i.au([],i.at([],xe,S._camera.position))};if(Te.dir[2]<0){const Pe=S.zoomDeltaToMovement(xe,D);i.b$(he,Te.dir,Pe)}}const le=i.cU(se,se,he);S._translateCameraConstrained(le),D&&Math.abs(S.zoom-oe)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(h,g,!0)}_fireEvents(s,h,g){const w=qi(this._eventsInProgress),S=qi(s),P={};for(const W in s){const{originalEvent:K}=s[W];this._eventsInProgress[W]||(P[`${W}start`]=K),this._eventsInProgress[W]=s[W]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const W in P)this._fireEvent(W,P[W]);S&&this._fireEvent("move",S.originalEvent);for(const W in s){const{originalEvent:K}=s[W];this._fireEvent(W,K)}const M={};let D;for(const W in this._eventsInProgress){const{handlerName:K,originalEvent:Z}=this._eventsInProgress[W];this._handlersById[K].isActive()||(delete this._eventsInProgress[W],D=h[K]||Z,M[`${W}end`]=D)}for(const W in M)this._fireEvent(W,M[W]);const j=qi(this._eventsInProgress);if(g&&(w||S)&&!j){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;W?(K(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:D})):(this._map.fire(new i.A("moveend",{originalEvent:D})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,h){this._map.fire(new i.A(s,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new AT("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const np="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class PT extends i.E{constructor(s,h){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,i.aV(["_renderFrameCallback"],this)}getCenter(){return new i.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(s,h){return this.jumpTo({center:s},h)}panBy(s,h,g){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,i.l({offset:s},h),g)}panTo(s,h,g){return this.easeTo(i.l({center:s},h),g)}getZoom(){return this.transform.zoom}setZoom(s,h){return this.jumpTo({zoom:s},h),this}zoomTo(s,h,g){return this.easeTo(i.l({zoom:s},h),g)}zoomIn(s,h){return this.zoomTo(this.getZoom()+1,s,h),this}zoomOut(s,h){return this.zoomTo(this.getZoom()-1,s,h),this}getBearing(){return this.transform.bearing}setBearing(s,h){return this.jumpTo({bearing:s},h),this}getPadding(){return this.transform.padding}setPadding(s,h){return this.jumpTo({padding:s},h),this}rotateTo(s,h,g){return this.easeTo(i.l({bearing:s},h),g)}resetNorth(s,h){return this.rotateTo(0,i.l({duration:1e3},s),h),this}resetNorthPitch(s,h){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},s),h),this}snapToNorth(s,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,h):this}getPitch(){return this.transform.pitch}setPitch(s,h){return this.jumpTo({pitch:s},h),this}cameraForBounds(s,h){s=i.aG.convert(s);const g=h&&h.bearing||0,w=h&&h.pitch||0,S=s.getNorthWest(),P=s.getSouthEast();return this._cameraForBounds(this.transform,S,P,g,w,h)}_extendPadding(s){const h={top:0,right:0,bottom:0,left:0};return s==null?i.l({},h,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:i.l({},h,s)}_extendCameraOptions(s){return(s=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,h){const g=h.max[0]-h.min[0],w=h.max[1]-h.min[1];return g/w>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):w/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,h,g,w,S,P){const M=s.clone(),D=this._extendCameraOptions(P);M.bearing=w,M.pitch=S;const j=i.cd.convert(h),W=i.cd.convert(g),K=.5*(j.lat+W.lat),Z=.5*(j.lng+W.lng),ee=i.eC(K,Z),se=i.au([],ee),oe=i.au([],i.bG([],se,[0,1,0])),he=i.bG([],oe,se),le=[oe[0],oe[1],oe[2],0,he[0],he[1],he[2],0,se[0],se[1],se[2],0,0,0,0,1],xe=[ee,i.eC(j.lat,j.lng),i.eC(W.lat,j.lng),i.eC(W.lat,W.lng),i.eC(j.lat,W.lng),i.eC(K,j.lng),i.eC(K,W.lng),i.eC(j.lat,Z),i.eC(W.lat,Z)];let Te=i.cV.fromPoints(xe.map(gt=>[i.bE(oe,gt),i.bE(he,gt),i.bE(se,gt)]));const Pe=i.ad([],Te.center,le);i.eD(Pe)===0&&i.eE(Pe,0,0,1),i.au(Pe,Pe),i.b$(Pe,Pe,i.aE),M.center=i.eF(Pe);const ze=M.getWorldToCameraMatrix(),ke=i.bi(new Float64Array(16),ze);Te=i.cV.applyTransform(Te,i.az([],ze,le));const Re=this._extendAABB(Te,M,D,w);if(!Re)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Re,i.ad(Pe,Pe,ze);const Ie=.5*(Te.max[2]-Te.min[2]),Ve=this._minimumAABBFrustumDistance(M,Te),Ge=i.b$([],[0,0,1],Ie),ht=i.cU(Ge,Pe,Ge),et=Ve+(M.pitch===0?0:i.bD(Pe,ht)),Et=M.globeCenterInViewSpace,wt=i.at([],Pe,[Et[0],Et[1],Et[2]]);i.au(wt,wt),i.b$(wt,wt,et);const qt=i.cU([],Pe,wt);i.ad(qt,qt,ke);const tt=i.eq/i.aE,dt=i.ae(qt),Je=i.c6(Math.max(dt*tt-i.eq,Number.EPSILON),0),It=Math.min(M.zoomFromMercatorZAdjusted(Je),D.maxZoom);return It>.5*(i.cL+i.cx)?(M.setProjection({name:"mercator"}),M.zoom=It,this._cameraForBounds(M,h,g,w,S,P)):{center:M.center,zoom:It,bearing:w,pitch:S}}_extendAABB(s,h,g,w){const S=.5*((g.padding.left||0)+(g.padding.right||0)),P=.5*((g.padding.top||0)+(g.padding.bottom||0)),M=P,D=S,j=S,W=P,K=h.width-(D+j),Z=h.height-(M+W),ee=i.at([],s.max,s.min),se=Math.min(K/ee[0],Z/ee[1]),oe=Math.min(h.scaleZoom(h.scale*se),g.maxZoom);if(isNaN(oe))return null;const he=h.scale/h.zoomScale(oe),le=new i.cV([s.min[0]-D*he,s.min[1]-W*he,s.min[2]],[s.max[0]+j*he,s.max[1]+M*he,s.max[2]]),xe=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new i.P(g.offset.x,g.offset.y):i.P.convert(g.offset)).rotate(-i.al(w));return le.center[0]-=xe.x*he,le.center[1]+=xe.y*he,le}queryTerrainElevation(s,h){const g=this.transform.elevation;return g?(h=i.l({},{exaggerated:!0},h),g.getAtPoint(i.ac.fromLngLat(s),null,h.exaggerated)):null}_cameraForBounds(s,h,g,w,S,P){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,h,g,w,S,P);const M=s.clone(),D=this._extendCameraOptions(P);M.bearing=w,M.pitch=S;const j=i.cd.convert(h),W=i.cd.convert(g),K=new i.cd(j.lng,W.lat),Z=new i.cd(W.lng,j.lat),ee=M.project(j),se=M.project(W),oe=this.queryTerrainElevation(j),he=this.queryTerrainElevation(W),le=this.queryTerrainElevation(K),xe=this.queryTerrainElevation(Z),Te=[[ee.x,ee.y,Math.min(oe||0,he||0,le||0,xe||0)],[se.x,se.y,Math.max(oe||0,he||0,le||0,xe||0)]];let Pe=i.cV.fromPoints(Te);const ze=M.getWorldToCameraMatrix(),ke=i.bi(new Float64Array(16),ze);Pe=i.cV.applyTransform(Pe,ze);const Re=this._extendAABB(Pe,M,D,w);if(!Re)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=Re;const Ie=.5*i.at([],Pe.max,Pe.min)[2],Ve=this._minimumAABBFrustumDistance(M,Pe),Ge=[0,0,1,0];i.aA(Ge,Ge,ze),i.eG(Ge,Ge);const ht=i.b$([],Ge,Ve+Ie),et=i.cU([],Pe.center,ht);i.ad(Pe.center,Pe.center,ke),i.ad(et,et,ke);const Et=M.unproject(new i.P(Pe.center[0],Pe.center[1])),wt=i.eH(M.projection,Et),qt=Math.pow(2,wt),tt=Math.min(M._zoomFromMercatorZ(et[2]*M.pixelsPerMeter*qt/M.worldSize),D.maxZoom);return M.mercatorFromTransition&&tt<.5*(i.cL+i.cx)?(M.setProjection({name:"globe"}),M.zoom=tt,this._cameraForBounds(M,h,g,w,S,P)):{center:Et,zoom:tt,bearing:w,pitch:S}}fitBounds(s,h,g){const w=this.cameraForBounds(s,h);return this._fitInternal(w,h,g)}fitScreenCoordinates(s,h,g,w,S){const P=i.P.convert(s),M=i.P.convert(h),D=new i.P(Math.min(P.x,M.x),Math.min(P.y,M.y)),j=new i.P(Math.max(P.x,M.x),Math.max(P.y,M.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,M))return this;const W=this.transform.pointLocation3D(D),K=this.transform.pointLocation3D(j),Z=this.transform.pointLocation3D(new i.P(D.x,j.y)),ee=this.transform.pointLocation3D(new i.P(j.x,D.y)),se=[Math.min(W.lng,K.lng,Z.lng,ee.lng),Math.min(W.lat,K.lat,Z.lat,ee.lat)],oe=[Math.max(W.lng,K.lng,Z.lng,ee.lng),Math.max(W.lat,K.lat,Z.lat,ee.lat)],he=w&&w.pitch?w.pitch:this.getPitch(),le=this._cameraForBounds(this.transform,se,oe,g,he,w);return this._fitInternal(le,w,S)}_fitInternal(s,h,g){return s?(h=i.l(s,h)).linear?this.easeTo(h,g):this.flyTo(h,g):this}jumpTo(s,h){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let w=!1,S=!1,P=!1;"zoom"in s&&g.zoom!==+s.zoom&&(w=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=i.cd.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(S=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(P=!0,g.pitch=+s.pitch);const M=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!g.isPaddingEqual(M))if(s.retainPadding===!1){const D=g.clone();D.padding=M,g.setLocationAtPoint(g.center,D.centerPoint)}else g.padding=M;return s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new i.A("movestart",h)).fire(new i.A("move",h)),w&&this.fire(new i.A("zoomstart",h)).fire(new i.A("zoom",h)).fire(new i.A("zoomend",h)),S&&this.fire(new i.A("rotatestart",h)).fire(new i.A("rotate",h)).fire(new i.A("rotateend",h)),P&&this.fire(new i.A("pitchstart",h)).fire(new i.A("pitch",h)).fire(new i.A("pitchend",h)),this.fire(new i.A("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(np),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,h){const g=this.transform;if(!g.projection.supportsFreeCamera)return i.w(np),this;this.stop();const w=g.zoom,S=g.pitch,P=g.bearing;g.setFreeCameraOptions(s);const M=w!==g.zoom,D=S!==g.pitch,j=P!==g.bearing;return this.fire(new i.A("movestart",h)).fire(new i.A("move",h)),M&&this.fire(new i.A("zoomstart",h)).fire(new i.A("zoom",h)).fire(new i.A("zoomend",h)),j&&this.fire(new i.A("rotatestart",h)).fire(new i.A("rotate",h)).fire(new i.A("rotateend",h)),D&&this.fire(new i.A("pitchstart",h)).fire(new i.A("pitch",h)).fire(new i.A("pitchend",h)),this.fire(new i.A("moveend",h)),this}easeTo(s,h){this._stop(!1,s.easeId),((s=i.l({offset:[0,0],duration:500,easing:i.ey},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),M=this.getPadding(),D="zoom"in s?+s.zoom:w,j="bearing"in s?this._normalizeBearing(s.bearing,S):S,W="pitch"in s?+s.pitch:P,K=this._extendPadding(s.padding),Z=i.P.convert(s.offset);let ee,se,oe;if(g.projection.name==="globe"){const Ge=i.ac.fromLngLat(g.center),ht=Z.rotate(-g.angle);Ge.x+=ht.x/g.worldSize,Ge.y+=ht.y/g.worldSize;const et=Ge.toLngLat(),Et=i.cd.convert(s.center||et);this._normalizeCenter(Et),ee=g.centerPoint.add(ht),se=new i.P(Ge.x,Ge.y).mult(g.worldSize),oe=new i.P(i.ay(Et.lng),i.aH(Et.lat)).mult(g.worldSize).sub(se)}else{ee=g.centerPoint.add(Z);const Ge=g.pointLocation(ee),ht=i.cd.convert(s.center||Ge);this._normalizeCenter(ht),se=g.project(Ge),oe=g.project(ht).sub(se)}const he=g.zoomScale(D-w);let le,xe;s.around&&(le=i.cd.convert(s.around),xe=g.locationPoint(le));const Te=this._zooming||D!==w,Pe=this._rotating||S!==j,ze=this._pitching||W!==P,ke=!g.isPaddingEqual(K),Re=s.retainPadding===!1?g.clone():g,Ie=Ge=>ht=>{if(Te&&(Ge.zoom=i.ai(w,D,ht)),Pe&&(Ge.bearing=i.ai(S,j,ht)),ze&&(Ge.pitch=i.ai(P,W,ht)),ke&&(Re.interpolatePadding(M,K,ht),ee=Re.centerPoint.add(Z)),le)Ge.setLocationAtPoint(le,xe);else{const et=Ge.zoomScale(Ge.zoom-w),Et=D>w?Math.min(2,he):Math.max(.5,he),wt=Math.pow(Et,1-ht),qt=Ge.unproject(se.add(oe.mult(ht*wt)).mult(et));Ge.setLocationAtPoint(Ge.renderWorldCopies?qt.wrap():qt,ee)}return s.preloadOnly||this._fireMoveEvents(h),Ge};if(s.preloadOnly){const Ge=this._emulate(Ie,s.duration,g);return this._preloadTiles(Ge),this}const Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Te,this._rotating=Pe,this._pitching=ze,this._padding=ke,this._easeId=s.easeId,this._prepareEase(h,s.noMoveStart,Ve),this._ease(Ie(g),Ge=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(h,Ge)},s),this}_prepareEase(s,h,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||g.moving||this.fire(new i.A("movestart",s)),this._zooming&&!g.zooming&&this.fire(new i.A("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new i.A("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new i.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.A("move",s)),this._zooming&&this.fire(new i.A("zoom",s)),this._rotating&&this.fire(new i.A("rotate",s)),this._pitching&&this.fire(new i.A("pitch",s))}_afterEase(s,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.A("zoomend",s)),w&&this.fire(new i.A("rotateend",s)),S&&this.fire(new i.A("pitchend",s)),this.fire(new i.A("moveend",s))}flyTo(s,h){if(this._prefersReducedMotion(s)){const gt=i.aF(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(gt,h)}this.stop(),s=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.ey},s);const g=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),M=this.getPadding(),D="zoom"in s?i.aD(+s.zoom,g.minZoom,g.maxZoom):w,j="bearing"in s?this._normalizeBearing(s.bearing,S):S,W="pitch"in s?+s.pitch:P,K=this._extendPadding(s.padding),Z=g.zoomScale(D-w),ee=i.P.convert(s.offset);let se=g.centerPoint.add(ee);const oe=g.pointLocation(se),he=i.cd.convert(s.center||oe);this._normalizeCenter(he);const le=g.project(oe),xe=g.project(he).sub(le);let Te=s.curve;const Pe=Math.max(g.width,g.height),ze=Pe/Z,ke=xe.mag();if("minZoom"in s){const gt=i.aD(Math.min(s.minZoom,w,D),g.minZoom,g.maxZoom),Lt=Pe/g.zoomScale(gt-w);Te=Math.sqrt(Lt/ke*2)}const Re=Te*Te;function Ie(gt){const Lt=(ze*ze-Pe*Pe+(gt?-1:1)*Re*Re*ke*ke)/(2*(gt?ze:Pe)*Re*ke);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function Ve(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function Ge(gt){return(Math.exp(gt)+Math.exp(-gt))/2}const ht=Ie(0);let et=function(gt){return Ge(ht)/Ge(ht+Te*gt)},Et=function(gt){return Pe*((Ge(ht)*(Ve(Lt=ht+Te*gt)/Ge(Lt))-Ve(ht))/Re)/ke;var Lt},wt=(Ie(1)-ht)/Te;if(Math.abs(ke)<1e-6||!isFinite(wt)){if(Math.abs(Pe-ze)<1e-6)return this.easeTo(s,h);const gt=ze<Pe?-1:1;wt=Math.abs(Math.log(ze/Pe))/Te,Et=function(){return 0},et=function(Lt){return Math.exp(gt*Te*Lt)}}s.duration="duration"in s?+s.duration:1e3*wt/("screenSpeed"in s?+s.screenSpeed/Te:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const qt=S!==j,tt=W!==P,dt=!g.isPaddingEqual(K),Je=s.retainPadding===!1?g.clone():g,It=gt=>Lt=>{const At=Lt*wt,zt=1/et(At);gt.zoom=Lt===1?D:w+gt.scaleZoom(zt),qt&&(gt.bearing=i.ai(S,j,Lt)),tt&&(gt.pitch=i.ai(P,W,Lt)),dt&&(Je.interpolatePadding(M,K,Lt),se=Je.centerPoint.add(ee));const Ft=Lt===1?he:gt.unproject(le.add(xe.mult(Et(At))).mult(zt));return gt.setLocationAtPoint(gt.renderWorldCopies?Ft.wrap():Ft,se),gt._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(h),gt};if(s.preloadOnly){const gt=this._emulate(It,s.duration,g);return this._preloadTiles(gt),this}return this._zooming=!0,this._rotating=qt,this._pitching=tt,this._padding=dt,this._prepareEase(h,!1),this._ease(It(g),()=>this._afterEase(h),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,h)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,h,g){g.animate===!1||g.duration===0?(s(1),h()):(this._easeStart=i.q.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,h){s=i.bX(s,-180,180);const g=Math.abs(s-h);return Math.abs(s-360-h)<g&&(s-=360),Math.abs(s+360-h)<g&&(s+=360),s}_normalizeCenter(s){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const g=s.lng-h.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,h,g){const w=Math.ceil(15*h/1e3),S=[],P=s(g.clone());for(let M=0;M<=w;M++){const D=P(M/w);S.push(D.clone())}return S}_preloadTiles(s,h){}}class yy{constructor(s={}){this.options=s,i.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const h=this.options&&this.options.compact,g=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=N("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const w=N("span","mapboxgl-ctrl-icon",this._compactButton);return w.setAttribute("aria-hidden","true"),w.setAttribute("title",g),this._innerContainer=N("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const g=h.reduce((w,S,P)=>(S.value&&(w+=`${S.key}=${S.value}${P<h.length-1?"&":""}`),w),"?");s.href=`${i.e.FEEDBACK_URL}/${g}#${dy(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const h=this._map.style._mergedSourceCaches;for(const w in h){const S=h[w];if(S.used){const P=S.getSource();P.attribution&&s.indexOf(P.attribution)<0&&s.push(P.attribution)}}s.sort((w,S)=>w.length-S.length),s=s.filter((w,S)=>{for(let P=S+1;P<s.length;P++)if(s[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class lg{constructor(){i.aV(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=N("div","mapboxgl-ctrl");const h=N("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const h in s){const g=s[h].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Wc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const h=++this._id;return this._queue.push({callback:s,id:h,cancelled:!1}),h}remove(s){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const w of g)if(w.id===s)return void(w.cancelled=!0)}run(s=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class vy{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const h=i.dk((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,h,g){this._start=this.getValue(h),this._end=s,this._startTime=h,this._endTime=h+g}}const wo={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class _c extends i.A{constructor(s,h,g,w){const{point:S,lngLat:P,originalEvent:M,target:D}=s;super(s.type,{point:S,lngLat:P,originalEvent:M,target:D}),this.preventDefault=()=>{s.preventDefault()},this.id=h,this.interaction=g,this.feature=w}}class cg{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,h){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const g=h.filter;let w=h.type;g&&this.filters.set(s,i.b3(g)),w==="mouseover"&&(w="mouseenter"),w==="mouseout"&&(w="mouseleave");const S=this.interactionsByType.get(w)||new Map;w==="mouseenter"||w==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,h)):S.size===0&&this.map.on(w,this.handleType),S.size===0&&this.interactionsByType.set(w,S),S.set(s,h),this.typeById.set(s,w)}get(s){const h=this.typeById.get(s);if(!h)return;const g=this.interactionsByType.get(h);return g?g.get(s):void 0}remove(s){const h=this.typeById.get(s);if(!h)return;this.typeById.delete(s),this.filters.delete(s);const g=this.interactionsByType.get(h);g&&(g.delete(s),h==="mouseenter"||h==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(h,this.handleType))}queryTargets(s,h){const g=[];for(const[w,S]of h)S.target&&g.push({targetId:w,target:S.target,filter:this.filters.get(w)});return this.map.style.queryRenderedTargets(s,g,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const h=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());h.length&&(s.type="mouseenter",this.handleType(s,h));const g=new Map;for(const[w,{feature:S}]of this.prevHoveredFeatures)this.hoveredFeatures.has(w)||g.set(S.id,S);g.size&&(s.type="mouseleave",this.handleType(s,Array.from(g.values())))}handleOut(s){const h=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);h.length&&(s.type="mouseleave",this.handleType(s,h)),this.hoveredFeatures.clear()}handleType(s,h){const g=Array.from(this.interactionsByType.get(s.type)).reverse(),w=!!h;h=h||this.queryTargets(s.point,g);const S=s.type==="mouseenter";let P=!1;const M=new Set;for(const D of h){for(const[j,W]of g){if(!W.target)continue;const K=D.variants?D.variants[j]:null;if(K){for(const Z of K){if(Wr(Z,D,M,j))continue;const ee=new i.df(D,Z),se=mh(Z,D,j);w&&(ee.state=this.map.getFeatureState(ee));const oe=S?this.prevHoveredFeatures.get(se):null,he=new _c(s,j,W,ee),le=oe?oe.stop:W.handler(he);if(S&&this.hoveredFeatures.set(se,{feature:D,stop:le}),le!==!1){P=!0;break}}if(P)break}}if(P)break}if(!P)for(const[D,j]of g){const{handler:W,target:K}=j;if(!K&&W(new _c(s,D,j,null))!==!1)break}}}function xy(m,s){if(Array.isArray(m)&&Array.isArray(s)){const h=new Set(m),g=new Set(s);return h.size===g.size&&m.every(w=>g.has(w))}return i.bv(m,s)}const CT={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},yM={showCompass:!0,showZoom:!0,visualizePitch:!1};class ug{constructor(s,h,g=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new my({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new Ld({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(s,h){this.mouseRotate.mousedown(s,h),this.mousePitch&&this.mousePitch.mousedown(s,h),Q()}move(s,h){const g=this.map,w=this.mouseRotate.mousemoveWindow(s,h),S=w&&w.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const P=this.mousePitch.mousemoveWindow(s,h),M=P&&P.pitchDelta;M&&g.setPitch(g.getPitch()+M)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){te(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(i.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ye(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ye(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=De(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=De(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function IT(m,s,h){if(m=new i.cd(m.lng,m.lat),s){const g=new i.cd(m.lng-360,m.lat),w=new i.cd(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),P=h.locationPoint3D(m).distSqr(s),M=s.x<0||s.y<0||s.x>h.width||s.y>h.height;h.locationPoint3D(g).distSqr(s)<P&&(M||Math.abs(g.lng-h.center.lng)<S)?m=g:h.locationPoint3D(w).distSqr(s)<P&&(M||Math.abs(w.lng-h.center.lng)<S)&&(m=w)}for(;Math.abs(m.lng-h.center.lng)>180;){const g=h.locationPoint3D(m);if(g.x>=0&&g.y>=0&&g.x<=h.width&&g.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Hx={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Nl={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class hg extends i.E{constructor(s,h){super(),(s instanceof HTMLElement||h)&&(s=i.l({element:s},h)),i.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:w="#3FB1CE",scale:S=1,draggable:P=!1,clickTolerance:M=0,rotation:D=Nl.rotation,rotationAlignment:j=Nl.rotationAlignment,pitchAlignment:W=Nl.pitchAlignment,occludedOpacity:K=Nl.occludedOpacity,altitude:Z=Nl.altitude}=s||{};this._anchor=g,this._color=w,this._scale=S,this._draggable=P,this._clickTolerance=M,this._rotation=D,this._rotationAlignment=j,this._pitchAlignment=W,this._occludedOpacity=K,this._altitude=Z,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",oe=>{oe.preventDefault()}),this._element.addEventListener("mousedown",oe=>{oe.preventDefault()});const ee=this._element.classList;for(const oe in Hx)ee.remove(`mapboxgl-marker-anchor-${oe}`);ee.add(`mapboxgl-marker-anchor-${this._anchor}`);const se=s&&s.className?s.className.trim().split(/\s+/):[];ee.add(...se),this._popup=null}_createDefaultMarker(){const s=N("div"),h=V("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const g=V("radialGradient",{id:"shadowGradient"},V("defs",{},h));V("stop",{offset:"10%","stop-opacity":.4},g),V("stop",{offset:"100%","stop-opacity":.05},g),V("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h)}return V("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),V("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),V("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.cd.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||Nl.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const h=s.code,g=s.charCode||s.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){const h=s.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,h=this._pos;if(!s||!h)return!1;const g=s.unproject(h,this._altitude),w=s.getFreeCameraOptions();if(!w.position)return!1;const S=w.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const h=this._pos;if(!h||h.x<0||h.x>s.transform.width||h.y<0||h.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(h,this._altitude);let w;s._showingGlobe()&&i.eK(s.transform,this._lngLat)?w=0:(w=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Hx[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const s=this._pos,h=this._map,g=this.getPitchAlignment();if(!h||!s||g!=="map")return"";if(!h._showingGlobe()){const D=h.getPitch();return D?`rotateX(${D}deg)`:""}const w=i.cJ(i.eL(h.transform,this._lngLat)),S=s.sub(i.eM(h.transform)),P=Math.abs(S.x)+Math.abs(S.y);if(P===0)return"";const M=w/P;return`rotateX(${-S.y*M}deg) rotateY(${S.x*M}deg)`}_calculateZTransform(){const s=this._pos,h=this._map;if(!h||!s)return"";let g=0;const w=this.getRotationAlignment();if(w==="map")if(h._showingGlobe()){const S=h.project(new i.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),P=h.project(new i.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(S);g=i.cJ(Math.atan2(P.y,P.x))-90}else g=-h.getBearing();else if(w==="horizon"){const S=i.af(4,6,h.getZoom()),P=i.eM(h.transform);P.y+=S*h.transform.height;const M=s.sub(P),D=i.cJ(Math.atan2(M.y,M.x));g=(D>90?D-270:D+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=IT(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const h=this._map;if(!h)return;const g=this._pointerdownPos,w=this._positionDelta;if(g&&w){if(!this._isDragging){const S=this._clickTolerance||h._clickTolerance;if(s.point.dist(g)<S)return;this._isDragging=!0}this._pos=s.point.sub(w),this._lngLat=h.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.A("dragstart"))),this.fire(new i.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.A("dragend")),this._state="inactive"}_addDragHandler(s){const h=this._map,g=this._pos;h&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const h=this._map;return h&&(s?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||Nl.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||Nl.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||Nl.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||Nl.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const dg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},rp={maxWidth:100,unit:"metric"},Ru={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},yc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},vc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Nh(m=new i.P(0,0),s="bottom"){if(typeof m=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(s){case"top":return new i.P(0,m);case"top-left":return new i.P(h,h);case"top-right":return new i.P(-h,h);case"bottom":return new i.P(0,-m);case"bottom-left":return new i.P(h,-h);case"bottom-right":return new i.P(-h,-h);case"left":return new i.P(m,0);case"right":return new i.P(-m,0)}return new i.P(0,0)}return m instanceof i.P||Array.isArray(m)?i.P.convert(m):i.P.convert(m[s]||[0,0])}return{version:_,supported:B.supported,setRTLTextPlugin:i.eN,getRTLTextPluginStatus:i.eO,Map:class extends PT{constructor(m){T.mark(b.create);const s=m;if((m=i.l({},CT,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&i.eI(window)&&(m.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new lc(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Wc,this._domRenderTaskQueue=new Wc,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.a$(),this._locale=i.l({},wo,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new vy(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new He(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){const h=document.getElementById(m.container);if(!h)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=h}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,i.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Ox),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new _M(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||i.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new vd(this),m.hash&&(this._hash=new Yf(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const h=m.bounds;h&&(this.resize(),this.fitBounds(h,i.l({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new yy({customAttribution:m.customAttribution})),this._logoControl=new lg,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new i.A(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new i.A(`${h.dataType}dataloading`,h))}),this._interactions=new cg(this)}_getMapId(){return this._mapId}addControl(m,s){if(s===void 0&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new i.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new i.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.A("movestart",m)).fire(new i.A("move",m)),this.fire(new i.A("resize",m)),s&&this.fire(new i.A("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(i.aG.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(s=>s==="auto"?navigator.language:s):m}setLanguage(m){const s=this._parseLanguage(m);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,s=m.projection.name;let h;s==="globe"&&m.zoom>=i.cx?(m.setMercatorFromTransition(),h=!0):s==="mercator"&&m.zoom<i.cx&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,s){return this._updateProjection(m||s||{name:"mercator"})}_updateProjection(m){let s;return s=m.name==="globe"&&this.transform.zoom>=i.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,s){return this.transform.locationPoint3D(i.cd.convert(m),s)}unproject(m,s){return this.transform.pointLocation3D(i.P.convert(m),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,s,h){const g=w=>{let S=[];if(Array.isArray(s)){const P=s.filter(M=>this.getLayer(M));S=P.length?this.queryRenderedFeatures(w,{layers:P}):[]}else S=this.queryRenderedFeatures(w,{target:s});return S};if(m==="mouseenter"||m==="mouseover"){let w=!1;return{listener:h,targets:s,delegates:{mousemove:P=>{const M=g(P.point);M.length?w||(w=!0,h.call(this,new zs(m,this,P.originalEvent,{features:M}))):w=!1},mouseout:()=>{w=!1}}}}if(m==="mouseleave"||m==="mouseout"){let w=!1;return{listener:h,targets:s,delegates:{mousemove:M=>{g(M.point).length?w=!0:w&&(w=!1,h.call(this,new zs(m,this,M.originalEvent)))},mouseout:M=>{w&&(w=!1,h.call(this,new zs(m,this,M.originalEvent)))}}}}{const w=S=>{const P=g(S.point);P.length&&(S.features=P,h.call(this,S),delete S.features)};return{listener:h,targets:s,delegates:{[m]:w}}}}on(m,s,h){if(typeof s=="function"||h===void 0)return super.on(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const w in g.delegates)this.on(w,g.delegates[w]);return this}once(m,s,h){if(typeof s=="function"||h===void 0)return super.once(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,h);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(m,s,h){if(typeof s=="function"||h===void 0)return super.off(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._delegatedListeners?this._delegatedListeners[m]:void 0;return g&&(w=>{for(let S=0;S<w.length;S++){const P=w[S];if(P.listener===h&&xy(P.targets,s)){for(const M in P.delegates)this.off(M,P.delegates[M]);return w.splice(S,1),this}}})(g),this}queryRenderedFeatures(m,s){if(!this.style)return[];if(m===void 0||m instanceof i.P||Array.isArray(m)||s!==void 0||(s=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!s){const S=this.style.queryRenderedFeatures(m,void 0,this.transform),P=this.style.queryRenderedFeatureset(m,void 0,this.transform);return S.concat(P)}let h=!0;if(s.target&&(h=this._isTargetValid(s.target),h&&!s.layers))return this.style.queryRenderedFeatureset(m,s,this.transform);let g=!0;if(s.layers&&Array.isArray(s.layers)){for(const S of s.layers)if(!this._isValidId(S)){g=!1;break}if(g&&!s.target)return this.style.queryRenderedFeatures(m,s,this.transform)}let w=[];return g&&(w=w.concat(this.style.queryRenderedFeatures(m,s,this.transform))),h&&(w=w.concat(this.style.queryRenderedFeatureset(m,s,this.transform))),w}querySourceFeatures(m,s){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,s)}isPointOnSurface(m){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(m))}addInteraction(m,s){return this._interactions.add(m,s),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,s){return s=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&m&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(m,(h,g)=>{if(h){const w=typeof h=="string"?h:h instanceof Error?h.message:h.error;i.w(`Unable to perform style diff: ${w}. Rebuilding the style from scratch.`),this._updateStyle(m,s)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(m,s))}_getUIString(m){const s=this._locale[m];if(s==null)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const h=i.l({},s);s&&s.config&&(h.initialConfig=s.config,delete h.config),this.style=new Uo(this,h).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Uo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new i.z(new Error("IDs can't be empty."))),!1):!i.d9(m)||(this.fire(new i.z(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const s of m)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(m)}addSource(m,s){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,s,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,h)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,s,{pixelRatio:h=1,sdf:g=!1,stretchX:w,stretchY:S,content:P}={}){this._lazyInitEmptyStyle();const M=i.I.from(m);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:D,height:j,data:W}=i.q.getImageData(s);this.style.addImage(M,{data:new i.r({width:D,height:j},W),pixelRatio:h,stretchX:w,stretchY:S,content:P,sdf:g,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:j}=s,W=s;this.style.addImage(M,{data:new i.r({width:D,height:j},new Uint8Array(W.data)),pixelRatio:h,stretchX:w,stretchY:S,content:P,sdf:g,usvg:!1,version:0,userImage:W}),W.onAdd&&W.onAdd(this,m)}}updateImage(m,s){this._lazyInitEmptyStyle();const h=i.I.from(m),g=this.style.getImage(h);if(!g)return void this.fire(new i.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.q.getImageData(s):s,{width:S,height:P,data:M}=w;if(S===void 0||P===void 0)return void this.fire(new i.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||P!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new i.z(new Error(`The width and height of the updated image (${S}, ${P})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const D=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let j=!1;g.usvg?(g.data=new i.r({width:S,height:P},new Uint8Array(M)),g.usvg=!1,g.icon=void 0,j=!0):g.data.replace(M,D),this.style.updateImage(h,g,j)}hasImage(m){return m?!!this.style&&!!this.style.getImage(i.I.from(m)):(this.fire(new i.z(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(i.I.from(m))}loadImage(m,s){i.o(this._requestManager.transformRequest(m,i.R.Image),(h,g)=>{s(h,g instanceof HTMLImageElement?i.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,s){this._lazyInitEmptyStyle(),this.style.addModel(m,s)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new i.z(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,s){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)):this}getSlot(m){const s=this.getLayer(m);return s&&s.slot||null}setSlot(m,s){return this.style.setSlot(m,s),this.style.mergeLayers(),this._update(!0)}addImport(m,s){return this.style.addImport(m,s).catch(h=>this.fire(new i.z(new Error("Failed to add import",h)))),this}updateImport(m,s){return typeof s!="string"&&s.id!==m?(this.removeImport(m),this.addImport(s)):(this.style.updateImport(m,s),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,s){return this.style.moveImport(m,s),this._update(!0)}moveLayer(m,s){return this._isValidId(m)?(this.style.moveLayer(m,s),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const s=this.style.getOwnLayer(m);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,s,h){return this._isValidId(m)?(this.style.setLayerZoomRange(m,s,h),this._update(!0)):this}setFilter(m,s,h={}){return this._isValidId(m)?(this.style.setFilter(m,s,h),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,s,h,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,s,h,g),this._update(!0)):this}getPaintProperty(m,s){return this._isValidId(m)?this.style.getPaintProperty(m,s):null}setLayoutProperty(m,s,h,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,s,h,g),this._update(!0)):this}getLayoutProperty(m,s){return this._isValidId(m)?this.style.getLayoutProperty(m,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,s){return this.style.setSchema(m,s),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,s){return this.style.setConfig(m,s),this._update(!0)}getConfigProperty(m,s){return this.style.getConfigProperty(m,s)}setConfigProperty(m,s,h){return this.style.setConfigProperty(m,s,h),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const s=m[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,s),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.cd.convert(m),this.transform):0}setFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,s),this._update())}removeFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,s),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let h,g,w,S=this._container;for(;S&&(!g||!w);){const P=window.getComputedStyle(S).transform;P&&P!=="none"&&(h=P.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(g=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(w=h[3])),S=S.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=w?Math.abs(s/w):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=N("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=N("div","mapboxgl-canvas-container",m);this._canvas=N("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=N("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(w=>{g[w]=N("div",`mapboxgl-ctrl-${w}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,s){const h=i.q.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(s),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const s=this._markers.indexOf(m);s!==-1&&this._markers.splice(s,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const s=this._popups.indexOf(m);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const m=i.l({},B.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",m);s?(yt(s,!0),this.painter=new hy(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(s)):this.fire(new i.z(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.A("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.A("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let s;this.fire(new i.A("renderstart")),++this._frameId;const h=this.painter.context.extTimerQuery,g=i.q.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=w.createQuery(),w.beginQuery(h.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,W=this.transform.pitch,K=i.q.now(),Z=new i.aa(j,{now:K,fadeDuration:S,pitch:W,transition:this.style.transition});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(g);const M=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),M&&(this._placementDirty=M.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,T.mark(b.load),this.fire(new i.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const j=i.q.now()-g;w.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const W=w.getQueryParameter(s,w.QUERY_RESULT)/1e6;w.deleteQuery(s),this.fire(new i.A("gpu-timing-frame",{cpuTime:j,gpuTime:W}))},50)}if(this.listens("gpu-timing-layer")){const j=this.painter.collectGpuTimers();setTimeout(()=>{const W=this.painter.queryGpuTimers(j);this.fire(new i.A("gpu-timing-layer",{layerTimes:W}))},50)}if(this.listens("gpu-timing-deferred-render")){const j=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const W=this.painter.queryGpuTimeDeferredRender(j);this.fire(new i.A("gpu-timing-deferred-render",{gpuTime:W}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(D||this._repaint)this.triggerRepaint();else{const j=this.idle();if(j&&(P=this._updateAverageElevation(g,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),j&&(this.fire(new i.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const W=this._calculateSpeedIndex();this.fire(new i.A("speedindexcompleted",{speedIndex:W})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,T.mark(b.fullLoad),this._performanceMetricsCollection&&$n(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const s of this._markers)m&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!m||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(m,s=!1){const h=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const w=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=m;const P=Math.abs(w-S);if(P>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(S),h(S);this._averageElevation.easeTo(S,m,300)}else if(P>1e-4)return this._averageElevation.jumpTo(S),h(S)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){Tn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===Ze||m.status===401)){const s=this.painter.context.gl;yt(s,!1),this._logoControl instanceof lg&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),un(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&sn(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const h=this.painter.context.gl,g=h.createFramebuffer();function w(S){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,S,0);const P=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,P),P}return h.bindFramebuffer(h.FRAMEBUFFER,g),this._canvasPixelComparison(w(m),s.canvasCopies.map(w),s.timeStamps)}_canvasPixelComparison(m,s,h){let g=h[1]-h[0];const w=m.length/4;for(let S=0;S<s.length;S++){const P=s[S];let M=0;for(let D=0;D<P.length;D+=4)P[D]===m[D]&&P[D+1]===m[D+1]&&P[D+2]===m[D+2]&&P[D+3]===m[D+3]&&(M+=1);g+=(h[S+2]-h[S+1])*(1-M/w)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),hn.delete(this.painter.context.gl),Gt.remove(),rn.remove(),this._removed=!0,this.fire(new i.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=i.q.frame(s=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(s)}))}_preloadTiles(m){const s=this.style?this.style.getSourceCaches():[];return i.bt(s,(h,g)=>h._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,s){i.eJ(m,s)}get version(){return _}},NavigationControl:class{constructor(m={}){this.options=i.l({},yM,m),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),N("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),N("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:s}):h.resetNorth({},{originalEvent:s}))}),this._compassIcon=N("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const s=m.getZoom(),h=s===m.getMaxZoom(),g=s===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ug(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,s){const h=N("button",m,this._container);return h.type="button",h.addEventListener("click",s),h}_setButtonTitle(m,s){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${s}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends i.E{constructor(m={}){super();const s=navigator.geolocation;this.options=i.l({geolocation:s},dg,m),i.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Rd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const s=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>s(h.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(m){const s=this._map.getMaxBounds(),h=m.coords;return!!s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new i.A("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("geolocate",m)),this._finish()}}_updateCamera(m){const s=new i.cd(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,g=this._map.getBearing(),w=i.l({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),w,{geolocateSource:!0})}_updateMarker(m){if(m){const s=new i.cd(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,s=i.c6(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=N("button","mapboxgl-ctrl-geolocate",this._container),N("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N("div","mapboxgl-user-location"),this._dotElement.appendChild(N("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(N("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new hg({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=N("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hg({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.A("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yy,ScaleControl:class{constructor(m={}){this.options=i.l({},rp,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,s=this._map,h=s._containerHeight/2,g=s._containerWidth/2-m/2,w=s.unproject([g,h]),S=s.unproject([g+m,h]),P=w.distanceTo(S);if(this.options.unit==="imperial"){const M=3.2808*P;M>5280?this._setScale(m,M/5280,"mile"):this._setScale(m,M,"foot")}else this.options.unit==="nautical"?this._setScale(m,P/1852,"nautical-mile"):P>=1e3?this._setScale(m,P/1e3,"kilometer"):this._setScale(m,P,"meter")}_setScale(m,s,h){this._map._requestDomTask(()=>{const g=function(S){const P=Math.pow(10,`${Math.floor(S)}`.length-1);let M=S/P;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(D){const j=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*j)/j}(M),P*M}(s),w=g/s;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(g):`${g}&nbsp;${Ru[h]}`,this._container.style.width=m*w+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:i.w("Full screen control 'container' must be a DOM element.")),i.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=N("button","mapboxgl-ctrl-fullscreen",this._controlContainer);N("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(m){super(),this.options=i.l(Object.create(yc),m),this._altitude=this.options.altitude,i.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new i.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new i.A("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=i.cd.convert(m),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const s=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=m;g=h.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=N("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(m),this.options.closeButton){const h=this._closeButton=N("button","mapboxgl-popup-close-button",s);h.type="button",h.setAttribute("aria-label","Close popup"),h.innerHTML='<span aria-hidden="true">&#215;</span>',h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let s;return this._classList.delete(m)?s=!1:(this._classList.add(m),s=!0),this._updateClassList(),s}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const s=this._map,h=this._container,g=this._pos;if(!s||!h||!g)return"bottom";const w=h.offsetWidth,S=h.offsetHeight,P=g.x<w/2,M=g.x>s.transform.width-w/2;if(g.y+m<S)return P?"top-left":M?"top-right":"top";if(g.y>s.transform.height-S){if(P)return"bottom-left";if(M)return"bottom-right"}return P?"left":M?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),m.className=s.join(" ")}_update(m){const s=this._map,h=this._content;if(!s||!this._lngLat&&!this._trackPointer||!h)return;let g=this._container;if(g||(g=this._container=N("div","mapboxgl-popup",s.getContainer()),this._tip=N("div","mapboxgl-popup-tip",g),g.appendChild(h)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=IT(this._lngLat,this._pos,s.transform)),!this._trackPointer||m){const w=this._pos=this._trackPointer&&m instanceof i.P?m:s.project(this._lngLat,this._altitude),S=Nh(this.options.offset),P=this._anchor=this._getAnchor(S.y),M=Nh(this.options.offset,P),D=w.add(M).round();s._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${Hx[P]} translate(${D.x}px,${D.y}px)`)})}if(!this._marker&&s._showingGlobe()){const w=i.eK(s.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(vc);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:hg,Style:Uo,LngLat:i.cd,LngLatBounds:i.aG,Point:i.P,MercatorCoordinate:i.ac,FreeCameraOptions:Tu,Evented:i.E,config:i.e,prewarm:i.eP,clearPrewarmedResources:i.eQ,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(m){i.e.ACCESS_TOKEN=m},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(m){i.e.API_URL=m},get workerCount(){return i.eR.workerCount},set workerCount(m){i.eR.workerCount=m},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){i.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){i.eS(m)},get workerUrl(){return i.eT.workerUrl},set workerUrl(m){i.eT.workerUrl=m},get workerClass(){return i.eT.workerClass},set workerClass(m){i.eT.workerClass=m},get workerParams(){return i.eT.workerParams},set workerParams(m){i.eT.workerParams=m},get dracoUrl(){return i.eU()},set dracoUrl(m){i.eV(m)},get meshoptUrl(){return i.eW()},set meshoptUrl(m){i.eX(m)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var d=a;return d})})(eie);var nie=eie.exports;const ZZe=lo(nie),YQe=VH({__proto__:null,default:ZZe},[nie]),JQe=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));async function XZe(e,t,n){let r;return Promise.race([e,new Promise((a,c)=>{r=setTimeout(()=>c(n),t)})]).finally(()=>clearTimeout(r))}class KZe extends DB{constructor(){super(...arguments),this.deviceMap=new Map,this.discoveredDevices=new Map,this.scan=null,this.DEFAULT_CONNECTION_TIMEOUT=1e4,this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this),this.onDisconnectedCallback=this.onDisconnected.bind(this),this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator>"u"||!navigator.bluetooth)throw this.unavailable("Web Bluetooth API not available in this browser.");if(!await navigator.bluetooth.getAvailability())throw this.unavailable("No Bluetooth radio available.")}async isEnabled(){return{value:!0}}async requestEnable(){throw this.unavailable("requestEnable is not available on web.")}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(t){const n=this.getFilters(t),r=await navigator.bluetooth.requestDevice({filters:n.length?n:void 0,optionalServices:t==null?void 0:t.optionalServices,acceptAllDevices:n.length===0});return this.deviceMap.set(r.id,r),this.getBleDevice(r)}async requestLEScan(t){this.requestBleDeviceOptions=t;const n=this.getFilters(t);await this.stopLEScan(),this.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),this.scan=await navigator.bluetooth.requestLEScan({filters:n.length?n:void 0,acceptAllAdvertisements:n.length===0,keepRepeatedDevices:t==null?void 0:t.allowDuplicates})}onAdvertisementReceived(t){var n,r;const a=t.device.id;if(this.deviceMap.set(a,t.device),!this.discoveredDevices.has(a)||!((n=this.requestBleDeviceOptions)===null||n===void 0)&&n.allowDuplicates){this.discoveredDevices.set(a,!0);const d=this.getBleDevice(t.device),i={device:d,localName:d.name,rssi:t.rssi,txPower:t.txPower,manufacturerData:UH(t.manufacturerData),serviceData:UH(t.serviceData),uuids:(r=t.uuids)===null||r===void 0?void 0:r.map(GZe)};this.notifyListeners("onScanResult",i)}}async stopLEScan(){var t;!((t=this.scan)===null||t===void 0)&&t.active&&this.scan.stop(),this.scan=null}async getDevices(t){return{devices:(await navigator.bluetooth.getDevices()).filter(a=>t.deviceIds.includes(a.id)).map(a=>(this.deviceMap.set(a.id,a),this.getBleDevice(a)))}}async getConnectedDevices(t){return{devices:(await navigator.bluetooth.getDevices()).filter(a=>{var c;return(c=a.gatt)===null||c===void 0?void 0:c.connected}).map(a=>(this.deviceMap.set(a.id,a),this.getBleDevice(a)))}}async getBondedDevices(){return{}}async connect(t){var n,r;const a=this.getDeviceFromMap(t.deviceId);a.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback),a.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);const c=Symbol();if(a.gatt===void 0)throw new Error("No gatt server available.");try{const d=(n=t.timeout)!==null&&n!==void 0?n:this.DEFAULT_CONNECTION_TIMEOUT;await XZe(a.gatt.connect(),d,c)}catch(d){throw await((r=a.gatt)===null||r===void 0?void 0:r.disconnect()),d===c?new Error("Connection timeout"):d}}onDisconnected(t){const r=`disconnected|${t.target.id}`;this.notifyListeners(r,null)}async createBond(t){throw this.unavailable("createBond is not available on web.")}async isBonded(t){throw this.unavailable("isBonded is not available on web.")}async disconnect(t){var n;(n=this.getDeviceFromMap(t.deviceId).gatt)===null||n===void 0||n.disconnect()}async getServices(t){var n,r;const a=(r=await((n=this.getDeviceFromMap(t.deviceId).gatt)===null||n===void 0?void 0:n.getPrimaryServices()))!==null&&r!==void 0?r:[],c=[];for(const d of a){const i=await d.getCharacteristics(),_=[];for(const b of i)_.push({uuid:b.uuid,properties:this.getProperties(b),descriptors:await this.getDescriptors(b)});c.push({uuid:d.uuid,characteristics:_})}return{services:c}}async getDescriptors(t){try{return(await t.getDescriptors()).map(r=>({uuid:r.uuid}))}catch{return[]}}getProperties(t){return{broadcast:t.properties.broadcast,read:t.properties.read,writeWithoutResponse:t.properties.writeWithoutResponse,write:t.properties.write,notify:t.properties.notify,indicate:t.properties.indicate,authenticatedSignedWrites:t.properties.authenticatedSignedWrites,reliableWrite:t.properties.reliableWrite,writableAuxiliaries:t.properties.writableAuxiliaries}}async getCharacteristic(t){var n;const r=await((n=this.getDeviceFromMap(t.deviceId).gatt)===null||n===void 0?void 0:n.getPrimaryService(t==null?void 0:t.service));return r==null?void 0:r.getCharacteristic(t==null?void 0:t.characteristic)}async getDescriptor(t){const n=await this.getCharacteristic(t);return n==null?void 0:n.getDescriptor(t==null?void 0:t.descriptor)}async discoverServices(t){throw this.unavailable("discoverServices is not available on web.")}async getMtu(t){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(t){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(t){throw this.unavailable("readRssi is not available on web.")}async read(t){const n=await this.getCharacteristic(t);return{value:await(n==null?void 0:n.readValue())}}async write(t){const n=await this.getCharacteristic(t);let r;typeof t.value=="string"?r=N2(t.value):r=t.value,await(n==null?void 0:n.writeValueWithResponse(r))}async writeWithoutResponse(t){const n=await this.getCharacteristic(t);let r;typeof t.value=="string"?r=N2(t.value):r=t.value,await(n==null?void 0:n.writeValueWithoutResponse(r))}async readDescriptor(t){const n=await this.getDescriptor(t);return{value:await(n==null?void 0:n.readValue())}}async writeDescriptor(t){const n=await this.getDescriptor(t);let r;typeof t.value=="string"?r=N2(t.value):r=t.value,await(n==null?void 0:n.writeValue(r))}async startNotifications(t){const n=await this.getCharacteristic(t);n==null||n.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),n==null||n.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),await(n==null?void 0:n.startNotifications())}onCharacteristicValueChanged(t){var n,r;const a=t.target,c=`notification|${(n=a.service)===null||n===void 0?void 0:n.device.id}|${(r=a.service)===null||r===void 0?void 0:r.uuid}|${a.uuid}`;this.notifyListeners(c,{value:a.value})}async stopNotifications(t){const n=await this.getCharacteristic(t);await(n==null?void 0:n.stopNotifications())}getFilters(t){var n,r;const a=[];for(const c of(n=t==null?void 0:t.services)!==null&&n!==void 0?n:[])a.push({services:[c],name:t==null?void 0:t.name,namePrefix:t==null?void 0:t.namePrefix});(t!=null&&t.name||t!=null&&t.namePrefix)&&a.length===0&&a.push({name:t.name,namePrefix:t.namePrefix});for(const c of(r=t==null?void 0:t.manufacturerData)!==null&&r!==void 0?r:[])a.push({manufacturerData:[c]});return a}getDeviceFromMap(t){const n=this.deviceMap.get(t);if(n===void 0)throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return n}getBleDevice(t){var n;return{deviceId:t.id,name:(n=t.name)!==null&&n!==void 0?n:void 0}}}const YZe=Object.freeze(Object.defineProperty({__proto__:null,BluetoothLeWeb:KZe},Symbol.toStringTag,{value:"Module"}));export{jXe as $,rJe as A,eJe as B,tKe as C,nJe as D,_S as E,SXe as F,CYe as G,tXe as H,wXe as I,BYe as J,NYe as K,MXe as L,QKe as M,JKe as N,FYe as O,CXe as P,NKe as Q,bXe as R,rm as S,PXe as T,WYe as U,oJe as V,qKe as W,uq as X,VYe as Y,yYe as Z,GKe as _,rXe as a,KJe as a$,XKe as a0,OYe as a1,mKe as a2,YKe as a3,lJe as a4,cJe as a5,uJe as a6,sJe as a7,gJe as a8,_Je as a9,eKe as aA,CKe as aB,mYe as aC,UKe as aD,zKe as aE,SYe as aF,GXe as aG,KKe as aH,gKe as aI,YXe as aJ,GYe as aK,tYe as aL,OJe as aM,kJe as aN,zYe as aO,kKe as aP,EYe as aQ,iKe as aR,DJe as aS,LJe as aT,zJe as aU,Abe as aV,kbe as aW,BJe as aX,$Je as aY,XJe as aZ,nKe as a_,xJe as aa,XYe as ab,yJe as ac,vJe as ad,mJe as ae,fJe as af,pJe as ag,bJe as ah,iYe as ai,lYe as aj,BKe as ak,MYe as al,XXe as am,vKe as an,wJe as ao,cKe as ap,HKe as aq,RYe as ar,jKe as as,TKe as at,$Xe as au,AJe as av,PJe as aw,TJe as ax,EJe as ay,IJe as az,gXe as b,AKe as b$,UJe as b0,VJe as b1,WJe as b2,GJe as b3,HJe as b4,ZJe as b5,qJe as b6,YJe as b7,FJe as b8,jJe as b9,tQe as bA,sQe as bB,uQe as bC,D8e as bD,cx as bE,ux as bF,Kd as bG,Ov as bH,sx as bI,hQe as bJ,Im as bK,fI as bL,cQe as bM,zI as bN,sKe as bO,HXe as bP,pQe as bQ,gQe as bR,xQe as bS,_Qe as bT,vQe as bU,rYe as bV,AQe as bW,SQe as bX,TQe as bY,EQe as bZ,oKe as b_,nYe as ba,qXe as bb,LKe as bc,HYe as bd,bYe as be,Ce as bf,KXe as bg,rKe as bh,fYe as bi,BXe as bj,SKe as bk,ZXe as bl,PYe as bm,nXe as bn,VXe as bo,AYe as bp,bKe as bq,$Ke as br,gYe as bs,PKe as bt,tF as bu,JJe as bv,QJe as bw,rQe as bx,iQe as by,eQe as bz,li as c,qQe as c$,vYe as c0,fQe as c1,k_ as c2,RKe as c3,uYe as c4,sYe as c5,OKe as c6,kYe as c7,hYe as c8,OQe as c9,yQe as cA,mQe as cB,UQe as cC,Dw as cD,iP as cE,X8 as cF,jQe as cG,$Qe as cH,IF as cI,VQe as cJ,aQe as cK,oQe as cL,lQe as cM,HJ as cN,UXe as cO,VKe as cP,WKe as cQ,KYe as cR,pKe as cS,Nre as cT,Rre as cU,dYe as cV,ZKe as cW,eYe as cX,_Ye as cY,dKe as cZ,HQe as c_,kQe as ca,LQe as cb,zQe as cc,RQe as cd,DQe as ce,MQe as cf,CQe as cg,IQe as ch,LYe as ci,z0 as cj,DYe as ck,_Ke as cl,EKe as cm,$Ye as cn,dQe as co,FI as cp,xYe as cq,FQe as cr,BQe as cs,wKe as ct,jYe as cu,fKe as cv,cYe as cw,IKe as cx,CJe as cy,yKe as cz,zXe as d,ZQe as d0,XQe as d1,GQe as d2,UYe as d3,pYe as d4,aKe as d5,FKe as d6,Lv as d7,KQe as d8,VZe as d9,UZe as da,WXe as db,qYe as dc,TYe as dd,DKe as de,aYe as df,uKe as dg,ZYe as dh,MKe as di,hKe as dj,wYe as dk,oYe as dl,FXe as dm,xKe as dn,eXe as dp,QZe as dq,Iue as dr,yXe as ds,Bce as dt,JQe as du,NXe as e,IXe as f,OXe as g,kXe as h,DXe as i,_e as j,JXe as k,RXe as l,YQe as m,lKe as n,LXe as o,AXe as p,IYe as q,X as r,JYe as s,iXe as t,_Xe as u,QYe as v,tJe as w,QXe as x,iJe as y,vXe as z};
